<!doctype html><html lang="en" data-framework="typescript"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=Edge"/><meta name="viewport" content="width=device-width,initial-scale=1"/><meta http-equiv="Content-Security-Policy" content="img-src services.bingapis.com data: blob: 'self' *.cdn.office.net *.df.onecdn.static.microsoft *.public.onecdn.static.microsoft *.bing.com bing.com res-dev.cdn.officeppe.net *.sharepoint-df.com *.sharepoint.com media.licdn.com spoprod-a.akamaihd.net prod.msocdn.com content.powerapps.com *.teams.microsoft.com *.s-microsoft.com *.sharepointonline.com connectoricons-df.azureedge.net connectoricons-prod.azureedge.net cpgeneralstore.blob.core.chinacloudapi.cn depservstorageussec.blob.core.microsoft.scloud depservstorageusnat.blob.core.eaglex.ic.gov tip1apiicons.cdn.powerappscdn.net tip2apiicons.cdn.powerappscdn.net prodapiicons.cdn.powerappscdn.net az787822.vo.msecnd.net cms-aiplugin.azureedge.net powerautomate.microsoft.com *.osi.office.net *.osi.officeppe.net designer.microsoft.com searchuxcdn.blob.core.windows.net *.loki.delve.office.com *.lifecycle.office.net;"/><script>if (typeof __prepareForDarkMode === "function") {
        __prepareForDarkMode();
      }</script><style>.mac-platform #defaultShimmer {
        display: none !important;
      }</style><script>// Detect Mac platform immediately and add class to body
      (function () {
        // Check user agent as a fallback for immediate detection
        const userAgent = navigator.userAgent.toLowerCase();
        const isMacUserAgent = userAgent.includes("mac");

        if (isMacUserAgent) {
          document.documentElement.classList.add("mac-platform");
        }
      })();</script><title>Excel Copilot Chat Add-in</title><link href="taskpane.css" rel="stylesheet"/><link href="officethemes.css" rel="stylesheet"/><link href="shimmer.css" rel="stylesheet"/><script>const excelTaskPaneStartTime = new Date().getTime().toString();
      window.excelTaskPaneStartTime = excelTaskPaneStartTime;

      try {
        if (
          typeof Microsoft !== "undefined" &&
          typeof Microsoft?.Office?.WebExtension?.Interactive === "function"
        ) {
          Microsoft.Office.WebExtension.Interactive(false);
        }
      } catch (error) {
        console.error("Interactive Error:", error);
      }</script><script defer="defer" src="chunk1jsfluent.js"></script><script defer="defer" src="chatcore.js"></script><script defer="defer" src="augloop-chunk.js"></script><script defer="defer" src="vendors~5.js"></script><script defer="defer" src="vendors~8.js"></script><script defer="defer" src="vendors~11.js"></script><script defer="defer" src="vendors~18.js"></script><script defer="defer" src="taskpane.js"></script></head><script src="https://appsforoffice.microsoft.com/lib/beta/hosted/excel.js"></script><script>Office.CoercionType.Image = "image";
    Office.CoercionType.XmlSvg = "xmlSvg";

    function isFlightEnabled(flightName) {
      if (OfficeRuntime && OfficeRuntime.experimentation) {
        return OfficeRuntime.experimentation.getBooleanFeatureGate(
          "Microsoft.Office.Excel.FA000000124." + flightName,
          false
        );
      }
      return false;
    }

    function parseBizChatHostContext(rawContext) {
      if (typeof rawContext !== "string") {
        return rawContext;
      }

      try {
        return JSON.parse(rawContext);
      } catch (error) {
        console.error("Invalid bizChatHostContext:", error.message);
        return undefined;
      }
    }

    window.setTimeout(() => {
      let isBizChatEnabledBasedOnCopilotExperience = false;
      try {
        const bizChatHostContextJson =
          Office.context.document.settings.get("BizChatHostContext");
        const bizChatHostContext = parseBizChatHostContext(
          bizChatHostContextJson
        );

        // Notify header loaded event and keep track of the time taken to load the static header
        if (
          Office &&
          Office.ExtensionLifeCycle &&
          Office.ExtensionLifeCycle.taskpane
        ) {
          Office.ExtensionLifeCycle.taskpane.notifyHeaderLoaded();
          window.StaticHeaderLoadTime = window.performance.now();
        }

        if (
          bizChatHostContext &&
          bizChatHostContext.PrimaryUserAccountInfo &&
          bizChatHostContext.PrimaryUserAccountInfo.CopilotExperience
        ) {
          const copilotExperience =
            bizChatHostContext.PrimaryUserAccountInfo.CopilotExperience;
          isBizChatEnabledBasedOnCopilotExperience =
            copilotExperience === "M365CopilotChat" ||
            copilotExperience === "Researcher" ||
            copilotExperience === "Analyst" ||
            copilotExperience === "DataShaping";
        }
      } catch (error) {
        console.error("Invalid bizChatHostContext:", error.message);
      }
      const isBizChatEntryEnabled = isBizChatEnabledBasedOnCopilotExperience
        ? false
        : Office.context.document &&
          Office.context.document.settings.get("BizChatEntry") === "true";

      // Define the necessary containers
      const defaultContainer = document.getElementById("defaultShimmer");
      const bizChatContainer = document.getElementById("bizChatShimmer");
      const appChatContainer = document.getElementById("appChatShimmer");

      if (
        isBizChatEnabledBasedOnCopilotExperience ||
        isFlightEnabled("EnableBizChat") ||
        (isFlightEnabled("EnableBizChatEntryFromRibbon") &&
          isBizChatEntryEnabled)
      ) {
        if (defaultContainer) {
          defaultContainer.style.display = "none";
        }
        if (bizChatContainer) {
          bizChatContainer.style.display = "flex";
        }
        if (appChatContainer) {
          appChatContainer.style.display = "none";
        }
        const bizChatShimmerHeader = document.querySelector(
          "#bizChatShimmer .header"
        );
        if (
          bizChatShimmerHeader &&
          Office.context?.officeTheme?.bodyForegroundColor
        ) {
          bizChatShimmerHeader.style.setProperty(
            "color",
            Office.context?.officeTheme?.bodyForegroundColor
          );
        }
      } else {
        if (defaultContainer) {
          defaultContainer.style.display = "none";
        }
        if (bizChatContainer) {
          bizChatContainer.style.display = "none";
        }
        if (appChatContainer) {
          appChatContainer.style.display = "block";
        }

        // Only update the header buttons container if in AppChat mode
        let headerButtonsContainer = document.getElementsByClassName(
          "headerButtonsContainer"
        );
        if (
          headerButtonsContainer &&
          headerButtonsContainer.length &&
          isFlightEnabled("CopilotSharedHeader")
        ) {
          headerButtonsContainer[0].style.setProperty("display", "flex");

          // Update paddings for Win32 platform
          if (
            Office &&
            Office.context &&
            Office.context.diagnostics &&
            Office.context.diagnostics.platform === "PC"
          ) {
            headerButtonsContainer[0].style.setProperty(
              "padding",
              "5px 0px 8px 0px"
            );
          }

          // update the foreground color of the header buttons based on the theme
          if (Office.context?.officeTheme?.bodyForegroundColor) {
            headerButtonsContainer[0].style.setProperty(
              "color",
              Office.context?.officeTheme?.bodyForegroundColor
            );
          }
        }
      }

      // irrespective of the mode, hide the close button for Mac
      const isMac =
        Office &&
        Office.context &&
        Office.context.platform.toString().toUpperCase() === "MAC";
      if (isMac) {
        const closeButtons = document.querySelectorAll(
          `[id^="TaskPaneCloseBtnStatic"]`
        );
        closeButtons.forEach((el) => {
          el.style.display = "none";
        });
      }
      // set the initial focus on the close button
      var visibilityMode;
      Office.onReady(function (hostAndPlatform) {
        if (hostAndPlatform?.addin?.visibilityMode) {
          visibilityMode = hostAndPlatform?.addin?.visibilityMode;
        }
      });

      // irrespective of the mode, set the initial focus on the close button if shown
      if (!isMac && (!visibilityMode || visibilityMode === "taskpane")) {
        let targetButtonId;

        // Use the same logic that determines which container is visible
        if (
          isBizChatEnabledBasedOnCopilotExperience ||
          isFlightEnabled("EnableBizChat") ||
          (isFlightEnabled("EnableBizChatEntryFromRibbon") &&
            isBizChatEntryEnabled)
        ) {
          var isAutoOpenScenario =
            Office.context.document &&
            Office.context.document.settings.get("AutoOpenChatPane") === true;
          if (!isAutoOpenScenario) {
            targetButtonId = "TaskPaneCloseBtnStatic2"; // bizChat button
          }
        } else {
          targetButtonId = "TaskPaneCloseBtnStatic3"; // appChat button
        }

        const closeButton = document.getElementById(targetButtonId);
        if (closeButton) {
          closeButton.focus();
        }
      }

      // Patch GetFilePropertiesAsync to use richapi path for iPad
      const isIOS =
        Office &&
        Office.context &&
        Office.context.platform.toString().toUpperCase() === "IOS";

      if (
        isIOS &&
        window.Excel &&
        window.Excel._V1APIMap &&
        window.Excel._V1APIMap["getFilePropertiesAsync"] === undefined
      ) {
        window.Excel._V1APIMap["getFilePropertiesAsync"] =
          window.Excel._V1APIMap["GetFilePropertiesAsync"];
      }
    }, 50);

    function closeTaskPane() {
      Office &&
        Office.ExtensionLifeCycle &&
        Office.ExtensionLifeCycle.taskpane &&
        Office.ExtensionLifeCycle.taskpane.close();
    }</script><body class="actionAI-pane"><div id="shimmer"><div id="defaultShimmer" style="display: flex;
          justify-content: flex-end;
          padding-inline-end: 20px;
          padding-top: 20px;"><button id="TaskPaneCloseBtnStatic1" onclick="closeTaskPane()" class="closeButton" aria-label="Close" title="Close"><svg fill="currentColor" width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L6 5.293L11.1464 0.146447C11.32 -0.0271197 11.5894 -0.046405 11.7843 0.0885911L11.8536 0.146447C12.0271 0.320013 12.0464 0.589437 11.9114 0.784306L11.8536 0.853553L6.707 6L11.8536 11.1464C12.0271 11.32 12.0464 11.5894 11.9114 11.7843L11.8536 11.8536C11.68 12.0271 11.4106 12.0464 11.2157 11.9114L11.1464 11.8536L6 6.707L0.853553 11.8536C0.679987 12.0271 0.410563 12.0464 0.215694 11.9114L0.146447 11.8536C-0.0271197 11.68 -0.046405 11.4106 0.0885911 11.2157L0.146447 11.1464L5.293 6L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z"/></svg></button></div><div id="bizChatShimmer" style="display: none; height: 100vh; flex-direction: column"><div class="header-actions" style="display: flex;
            justify-content: flex-end;
            padding-inline-end: 20px;
            padding-top: 20px;"><div class="shimmer-item icon-shimmer"></div><div class="shimmer-item icon-shimmer"></div><button id="TaskPaneCloseBtnStatic2" onclick="closeTaskPane()" class="closeButton" aria-label="Close" title="Close"><svg fill="currentColor" width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L6 5.293L11.1464 0.146447C11.32 -0.0271197 11.5894 -0.046405 11.7843 0.0885911L11.8536 0.146447C12.0271 0.320013 12.0464 0.589437 11.9114 0.784306L11.8536 0.853553L6.707 6L11.8536 11.1464C12.0271 11.32 12.0464 11.5894 11.9114 11.7843L11.8536 11.8536C11.68 12.0271 11.4106 12.0464 11.2157 11.9114L11.1464 11.8536L6 6.707L0.853553 11.8536C0.679987 12.0271 0.410563 12.0464 0.215694 11.9114L0.146447 11.8536C-0.0271197 11.68 -0.046405 11.4106 0.0885911 11.2157L0.146447 11.1464L5.293 6L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z"/></svg></button></div><div class="main-content" style="flex: 1"><div class="greeting-section"><div class="shimmer-item greeting-shimmer"></div></div><div class="input-section"><div class="shimmer-item input-shimmer"></div></div></div></div><div id="appChatShimmer" class="appChatContainer" style="display: none"><div class="headerButtonsContainer br"><div class="titleContainer"><svg fill="currentColor" class="hamburgerIcon" aria-hidden="true" width="1em" height="1em" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.25c0-.41.34-.75.75-.75h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 4.25Zm0 5c0-.41.34-.75.75-.75h14.5a.75.75 0 0 1 0 1.5H2.75A.75.75 0 0 1 2 9.25Zm.75 4.25a.75.75 0 0 0 0 1.5h14.5a.75.75 0 0 0 0-1.5H2.75Z" fill="currentColor"></path></svg> <svg fill="currentColor" width="20" class="copilotIcon" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M14.1441 3.34932C13.9105 2.54966 13.1773 2 12.3443 2L11.7431 2C10.847 2 10.0762 2.634 9.90333 3.51321L8.85388 8.85006L9.15131 7.89102C9.39467 7.1063 10.1206 6.57143 10.9421 6.57143L14.2355 6.57143L15.6356 7.74347L16.8822 6.57143H16.4908C15.6578 6.57143 14.9246 6.02177 14.6911 5.22211L14.1441 3.34932Z" fill="url(#paint0_radial_3283_6551)"/><path d="M6.0492 16.6427C6.28017 17.4462 7.01519 17.9997 7.85121 17.9997H9.07497C10.0844 17.9997 10.9126 17.2006 10.9488 16.1918L11.1295 11.1426L10.842 12.0951C10.6031 12.8867 9.87385 13.4283 9.04701 13.4283L5.73383 13.4283L4.34959 12.5431L3.32812 13.4283H3.71324C4.54926 13.4283 5.28427 13.9818 5.51524 14.7853L6.0492 16.6427Z" fill="url(#paint1_radial_3283_6551)"/><path d="M12.25 2H5.6876C3.81262 2 2.68763 4.39748 1.93763 6.79497C1.04909 9.63537 -0.113598 13.4342 3.25012 13.4342H6.11121C6.94326 13.4342 7.67523 12.8878 7.911 12.0899C8.40441 10.4199 9.26469 7.52162 9.94085 5.31373C10.2855 4.18837 10.5726 3.22188 11.0131 2.62001C11.2601 2.28258 11.6718 2 12.25 2Z" fill="url(#paint2_linear_3283_6551)"/><path d="M12.25 2H5.6876C3.81262 2 2.68763 4.39748 1.93763 6.79497C1.04909 9.63537 -0.113598 13.4342 3.25012 13.4342H6.11121C6.94326 13.4342 7.67523 12.8878 7.911 12.0899C8.40441 10.4199 9.26469 7.52162 9.94085 5.31373C10.2855 4.18837 10.5726 3.22188 11.0131 2.62001C11.2601 2.28258 11.6718 2 12.25 2Z" fill="url(#paint3_linear_3283_6551)"/><path d="M7.74872 17.9997H14.3112C16.1861 17.9997 17.3111 15.603 18.0611 13.2063C18.9497 10.3668 20.1124 6.56934 16.7486 6.56934H13.8874C13.0554 6.56934 12.3235 7.11559 12.0877 7.91346C11.5943 9.58288 10.734 12.48 10.0579 14.687C9.71328 15.812 9.4262 16.7782 8.98563 17.3799C8.73862 17.7172 8.32695 17.9997 7.74872 17.9997Z" fill="url(#paint4_radial_3283_6551)"/><path d="M7.74872 17.9997H14.3112C16.1861 17.9997 17.3111 15.603 18.0611 13.2063C18.9497 10.3668 20.1124 6.56934 16.7486 6.56934H13.8874C13.0554 6.56934 12.3235 7.11559 12.0877 7.91346C11.5943 9.58288 10.734 12.48 10.0579 14.687C9.71328 15.812 9.4262 16.7782 8.98563 17.3799C8.73862 17.7172 8.32695 17.9997 7.74872 17.9997Z" fill="url(#paint5_linear_3283_6551)"/><defs><radialGradient id="paint0_radial_3283_6551" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(15.7132 8.89484) rotate(-129.141) scale(7.20751 6.76953)"><stop offset="0.0955758" stop-color="#00AEFF"/><stop offset="0.773185" stop-color="#2253CE"/><stop offset="1" stop-color="#0736C4"/></radialGradient><radialGradient id="paint1_radial_3283_6551" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(4.74347 13.4005) rotate(51.7328) scale(6.58647 6.39483)"><stop stop-color="#FFB657"/><stop offset="0.633728" stop-color="#FF5F3D"/><stop offset="0.923392" stop-color="#C02B3C"/></radialGradient><linearGradient id="paint2_linear_3283_6551" x1="5.29483" y1="3.38547" x2="6.17167" y2="13.8705" gradientUnits="userSpaceOnUse"><stop offset="0.156162" stop-color="#0D91E1"/><stop offset="0.487484" stop-color="#52B471"/><stop offset="0.652394" stop-color="#98BD42"/><stop offset="0.937361" stop-color="#FFC800"/></linearGradient><linearGradient id="paint3_linear_3283_6551" x1="6.11312" y1="2" x2="6.59177" y2="13.4355" gradientUnits="userSpaceOnUse"><stop stop-color="#3DCBFF"/><stop offset="0.246674" stop-color="#0588F7" stop-opacity="0"/></linearGradient><radialGradient id="paint4_radial_3283_6551" cx="0" cy="0" r="1" gradientUnits="userSpaceOnUse" gradientTransform="translate(17.0857 5.45023) rotate(109.881) scale(15.2451 18.7446)"><stop offset="0.0661714" stop-color="#8C48FF"/><stop offset="0.5" stop-color="#F2598A"/><stop offset="0.895833" stop-color="#FFB152"/></radialGradient><linearGradient id="paint5_linear_3283_6551" x1="17.6042" y1="5.87149" x2="17.5979" y2="8.9847" gradientUnits="userSpaceOnUse"><stop offset="0.0581535" stop-color="#F8ADFA"/><stop offset="0.708063" stop-color="#A86EDD" stop-opacity="0"/></linearGradient></defs></svg><div class="label">Copilot</div></div><div class="spacer"></div><button id="TaskPaneCloseBtnStatic3" onclick="closeTaskPane()" class="closeButton" aria-label="Close" title="Close"><svg fill="currentColor" width="12" height="12" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M0.0885911 0.215694L0.146447 0.146447C0.320013 -0.0271197 0.589437 -0.046405 0.784306 0.0885911L0.853553 0.146447L6 5.293L11.1464 0.146447C11.32 -0.0271197 11.5894 -0.046405 11.7843 0.0885911L11.8536 0.146447C12.0271 0.320013 12.0464 0.589437 11.9114 0.784306L11.8536 0.853553L6.707 6L11.8536 11.1464C12.0271 11.32 12.0464 11.5894 11.9114 11.7843L11.8536 11.8536C11.68 12.0271 11.4106 12.0464 11.2157 11.9114L11.1464 11.8536L6 6.707L0.853553 11.8536C0.679987 12.0271 0.410563 12.0464 0.215694 11.9114L0.146447 11.8536C-0.0271197 11.68 -0.046405 11.4106 0.0885911 11.2157L0.146447 11.1464L5.293 6L0.146447 0.853553C-0.0271197 0.679987 -0.046405 0.410563 0.0885911 0.215694L0.146447 0.146447L0.0885911 0.215694Z"/></svg></button></div><div id="shimmerPage"><div class="incomingMessageCard br"><div class="wrapper"><div class="message animate"></div><div class="message animate w76"></div></div></div><div class="outgoingMessageCard br"><div class="wrapper"><div class="message animate"></div><div class="message animate w83"></div><div class="message animate"></div><div class="message animate w83"></div></div></div><div class="bottom-container"><div class="suggestionCard1 br"><div class="wrapper"><div class="suggestion br animate"></div></div></div><div class="suggestionCard2Container br"><div class="suggestionCard2 br"><div class="wrapper"><div class="suggestion br animate"></div></div></div><div class="refreshButtonContainer br"><div class="refreshButton br animate"></div></div></div><div class="chatInputCard br"><div class="wrapper"><div class="chatInputText animate"></div></div><div class="chatInputCardButtonsContainer br"><div class="sparcleIcon br animate"></div><div class="spacer"></div><div class="sendButton br animate"></div></div></div></div></div></div></div><div id="container"></div></body></html>