/*! For license information please see appchat.js.LICENSE.txt */
var TypeScriptModule;(()=>{var __webpack_modules__={4091:(e,t,a)=>{"use strict";a.d(t,{$U:()=>re,DD:()=>de,HE:()=>te,HO:()=>ge,K5:()=>ue,L4:()=>$,Nl:()=>z,PQ:()=>K,Q4:()=>me,RX:()=>ce,SW:()=>se,Vf:()=>J,Y4:()=>ae,YS:()=>H,Yx:()=>W,_Z:()=>M,dT:()=>Y,eB:()=>he,eM:()=>B,gp:()=>le,it:()=>Q,jc:()=>ne,nv:()=>oe,oh:()=>O,q9:()=>ie,qc:()=>ee,x4:()=>Z,yG:()=>j,zA:()=>D});var n=a(267324),o=a(881707),r=a(365319),i=a(742633),l=a(277718),s=a(74704),c=a(626128),d=a(357392),u=a(348065),m=a(9847),h=a(371623),g=a(707314),p=a(630079),b=a(937234),f=a(477543),C=a(476730),y=a(956258),v=a(235373),x=a(627603),T=a(412504),S=a(47262),w=a(797639),E=a(79458),I=a(750927),R=a(528804),A=a(935785),L=a(108869),k=a(804672),F=a(495501),_=a(940096);const P=y.M.getInstance(),N=C.E.getInstance(),M=e=>async()=>{if((0,R._bw)()){const t=(0,R.yw9)("OfficeVSO_9629324_ValidateLabel");(0,E.cY)("ODSL scenario success, updating document sensitivity");const a=o.n.getInstance().getInDocSensitiveLabelInfo(),n=await o.n.getInstance().upgradeSensitivityLabelUsingOfcJs(a,t);N?.updateTelemetryChatEventData({[m.h3.ChatEventType]:m.a5.DocumentClpUpgrade,[m.h3.ChatEventParameters]:`CallerData: ${JSON.stringify(e)}, result: ${JSON.stringify(n)}`},P)}},O=(e,t)=>async(a,o)=>{const{currentNLResult:i,currentNLResultVisualIndex:l}=o().chat,{activeRequestId:s}=o().selection;if(!i)return;const c=!1===i.fullyUnderstoodRewrittenQuery?(0,n.bUh)():(0,n.YTh)(),d=i.visualAnswer[l+1];if(!d)return;const u=(0,k.Yd)(d.visual.visualType)??"visual",m=c.replace("{0}",u),{message:h,telemetry:g}=F.n.getAnalyzeDataRecommendationResponse({visual:d,requestId:s[e],responseText:m,tableName:e,tableContext:t});r.$.getInstance().displayResponse(h,g);const p=(0,A.t)(d,m,i.textAnswer?.tokens.map((e=>e.text)).join(""));a(oe(p,b.Aw.success,g)),a(v.m.incrementCurrentNLResultVisualIndex())},D=(e,t)=>async(a,n)=>{const{currentRecos:o,currentRecoIndex:i,suggestionList:l}=n().chat,{activeRequestId:s}=n().selection;if(!o)return;const c=i+1,d=o[c],{message:u,telemetry:m}=F.n.getAnalyzeDataRecommendationResponse({visual:d,requestId:s[e],responseText:"",tableName:e,tableContext:t});r.$.getInstance().displayResponse(u,m),c===o.length-1&&(l.length<=1?a(z()):a(v.m.removeFirstSuggestionPill())),a(v.m.incrementRecoIndex())},B=(e,t)=>async a=>{w.CP.lockContextRefresh(e),a(v.m.startExecutingCommand({command:e,id:t}))},$=(e,t)=>async a=>{(0,d.z)()&&await d.g.getInstance().removeGridFoil(),void 0!==w.CP.getQueryIdShouldNotShowFluxResponse()&&w.CP.setQueryIdShouldNotShowFluxResponse(void 0),await w.CP.releaseContextLock(),t||a(v.m.hideLoadingUI()),a(v.m.stopExecuting({isSuccess:e,keepShowingLoadingUIIfAlreadyActive:t}))},H=()=>async(e,t)=>{e(v.m.setCurrentNLResultInvalid());const{currentNLResult:a}=t().chat;e(X(a))},U=()=>(e,t)=>{const a=w.CP.getActiveTable(),{nextSuggestionTypePriorities:n,recentlyShownPrompts:o}=t().chat,r=V(t,a?.name);let i={suggestionList:[]};if(n.length>0){const e=r.filter((e=>n.includes(e.suggestionType)));i=(0,h.g4)(a,e,o)}return 0===i.suggestionList.length&&(i=(0,h.g4)(a,r,o)),i},q=()=>async(e,t)=>{const a=e(U());a.shouldResetRecentPrompts&&e(v.m.setRecentlyShownPrompts([])),e(v.m.setSuggestionListDetails({...a,nextSuggestionTypePriorities:[]}))},V=(e,t="")=>{const a=(e().selection.suggestions[t]??[]).map((e=>({suggestionText:e,suggestionType:"AnalyzeData_SpecificSuggestion"}))),o=G(e);a.push(...o);const r=e().chat.latestRequestId,i=r&&e().dataAI.recommendations[r]||[],l=[],s=new Set;i.forEach((e=>{(0,c.iM)(e)&&e.calculatedFormulas.forEach((e=>{s.has(e.columnName.toLocaleLowerCase())||(s.add(e.columnName.toLocaleLowerCase()),l.push({suggestionText:(0,I.L)((0,n.ZKU)(),e.columnName),suggestionType:"CalculatedColumns_SpecificSuggestion"}))}))}));const{fillablePromptList:d}=e().chat,u=(0,R.H2A)()&&((0,L.gx)()||(0,R.ggM)()&&(0,R.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&(0,L.XT)()),m=t&&u?[{suggestionText:(0,n.Bzb)(),suggestionType:"Python_Suggestion_FromRefreshList"}]:[],h=[...d??[],...a,...l,...m];return(0,k.R3)(h)},G=e=>{const t=e().chat.currentNLResult?.relatedQuestions;if(t){return t.map((t=>({suggestionText:t.query.tokens.map((e=>e.token.text)).join(""),suggestionType:"AnalyzeData_RelatedQuestions",suggestionLanguage:e().chat.currentNLResult?.outputLanguage})))}return[]},W=(e=[])=>async t=>{t(v.m.setNextSuggestionTypePriorities(e)),t(q())},z=()=>async e=>{e(v.m.setRecentlyShownPrompts([])),e(v.m.setSuggestionListDetails({suggestionList:(0,h.XX)(),nextSuggestionTypePriorities:[]}))},j=()=>async(e,t)=>{N?.updateTelemetryChatEventData({[m.h3.ChatEventType]:m.a5.SuggestionPaneSuggestionClicked,[m.h3.ChatEventParameters]:"MorePrompts"},P),(0,T.K)(t().chat.suggestionList,"AnalyzeData_RelatedQuestions")?e(W(["AnalyzeData_RelatedQuestions"])):e(q())},Q=()=>async e=>{e(v.m.setZqmSuggestionList())},J=(e,t,a,o=1)=>async r=>{const i=[{suggestionText:a===c.VS.Column?t?(0,n.wzr)():(0,n._1n)():(0,n.jcG)(),suggestionType:"CalculatedColumns_ShowMore",calculatedFormulaSuggestionMessage:{requestId:e,requestIndex:o}}];r(v.m.setSuggestionListDetails({suggestionList:i,nextSuggestionTypePriorities:["CalculatedColumns_SpecificSuggestion"]}))},Y=e=>async t=>{const a=e.slice(0,2).map((e=>({suggestionText:e,suggestionType:"Python_Suggestion"})));t(v.m.setSuggestionListDetails({suggestionList:a,nextSuggestionTypePriorities:["Python_Suggestion"],isPythonSuggestion:!0}))},X=e=>async(t,a)=>{const o=a().chat.isCurrentNLResultValid;let r={suggestionList:[],nextSuggestionTypePriorities:["AnalyzeData_SpecificSuggestion"]},i=!1;if(e){if(e.visualAnswer?.length>1&&o){const e=`${(0,n.G5z)()[1]}`;r.suggestionList=[{suggestionText:(0,n.G5z)()[0],suggestionType:"AnalyzeData_ShowMore"},{suggestionText:e,suggestionType:"AnalyzeData_InsertAll"}]}else if(e.visualAnswer?.length>1)i=!0,r.suggestionList=[{suggestionText:(0,n.Tr2)(),suggestionType:"AnalyzeData_Suggestion"}];else if(e.relatedQuestions&&e.relatedQuestions.length>0){const t=e.relatedQuestions.map((e=>e.query.tokens.map((e=>e.token.text)).join(""))).slice(0,h.xP).map((e=>({suggestionText:e,suggestionType:"AnalyzeData_RelatedQuestions"})));r.suggestionList=t,r.nextSuggestionTypePriorities=["AnalyzeData_RelatedQuestions"]}else e.responseType!==g.WZ.Answered?r.suggestionList=[{suggestionText:(0,n.Dvy)(),suggestionType:"AnalyzeData_Suggestion"}]:(t(v.m.setNextSuggestionTypePriorities(["AnalyzeData_SpecificSuggestion"])),r=t(U()),r.shouldResetRecentPrompts&&t(v.m.setRecentlyShownPrompts([])));var l;i||(l=r.suggestionList,(0,R.H2A)()&&((0,L.gx)()||(0,R.ggM)()&&(0,R.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&(0,L.XT)())&&(l.unshift({suggestionText:(0,R.yw9)("OfficeVSO_10297193_changeAASuggestionPillFromAD")&&!(0,L.$)()?(0,n.fkZ)():(0,n.Bzb)(),suggestionType:"Python_Suggestion_FromAnalyzeData"}),l.splice(h.jc))),r.suggestionList.forEach((t=>{t.suggestionLanguage=e.outputLanguage})),t(v.m.setSuggestionListDetails(r))}else t(z())},Z=e=>async(t,a)=>{let n=(0,h.$c)(e);n&&0!==n.length&&(n=n.concat(a().chat.suggestionList),t(v.m.setSuggestionListDetails({suggestionList:n})))},K=(e,t,a)=>async n=>{e.discoverInsights?.length>0&&(e.visualAnswer=e.discoverInsights,e.responseType=g.WZ.Answered,e.answerForDiscoverInsights&&(e.textAnswer=e.answerForDiscoverInsights)),e.visualAnswer?.length>6&&(e.visualAnswer=e.visualAnswer.slice(0,6)),n(v.m.updateCurrentNLResult({isCurrentNLResultValid:!0,currentNLResult:e,currentNLResultVisualIndex:0,tableName:t,tableContext:a})),n(X(e))},ee=(e,t)=>async a=>{const o=e.length>6?e.slice(0,6):e;a(v.m.updateCurrentRecos(o)),a(((e,t)=>async a=>{if(e.length<=1)a(z());else if("ChartReco"===t){const e=`${(0,n.G5z)()[1]}`;a(v.m.setSuggestionListDetails({suggestionList:[{suggestionText:(0,n.YXQ)(),suggestionType:"AnalyzeData_ShowMoreCharts"},{suggestionText:e,suggestionType:"AnalyzeData_InsertAllCharts"}]}))}else a(v.m.setSuggestionListDetails({suggestionList:[{suggestionText:(0,n.Q40)(),suggestionType:"AnalyzeData_ShowMorePivotTables"}]}))})(o,t))},te=(0,u.YQ)(((e,t,a)=>t().chat.queryOriginByQueryId[a])),ae=(0,u.YQ)(((e,t,a)=>t().chat.onGridQueryCellAddressByQueryId[a])),ne=(0,u.YQ)(((e,t,a)=>t().chat.onGridQueryElseCategoryOverrideByQueryId[a])),oe=(e,t,a,o=!0,i=!0,l)=>async c=>{if(!r.$.getInstance().getIsSkillResponseRequired())return;s.Q.getInstance().recordFluxCopilotStep({operation:m.OP.FluxSkillEnd,featureName:a.featureName}),e||(e=t===b.Aw.success?(0,n.Twc)():(0,n._h7)()),await c(re(t,e,l));const d=t===b.Aw.success;d||await c((0,_.f1)()),i&&(c(v.m.stopExecuting({isSuccess:d,keepShowingLoadingUIIfAlreadyActive:o})),o&&c(v.m.startExecutingCommand({command:m.OP.FluxGenerateResponse,id:y.M.userQueryGuid})))},re=(e,t,a)=>async()=>{r.$.getInstance().setIsSkillResponseRequired(!1);const n=e===b.Aw.success||e===b.Aw.cancelled,o=new i.DE({queryId:y.M.userQueryGuid,status:e,message:n?t:void 0,error:n?void 0:t,isTextAnalysis:a}),s=new f.g0({parentPath:["Signal",i.DE.getTypeName()],items:[{id:p.r.generateId(),body:o}]});(0,E.cY)("Sending ExcelCopilotProgramResponseSignal to AL"),r.$.getInstance().submitOperation({operation:s,workflowAnnotationType:l.Yn.getTypeName()})},ie=()=>async(e,t)=>t().chat.executingCommand,le=()=>async(e,t)=>t().chat.isInsertingFormulaSuggestion,se=()=>(e,t)=>t().chat.dataShapingState,ce=e=>async t=>{await(0,x.UD)(t,e)},de=e=>async t=>{await(0,x.bs)(t,e)},ue=e=>async t=>{await(0,x.Kz)(t,e)},me=e=>async t=>{await(0,x.fo)(t,e)},he=e=>async(t,a)=>{const{feature:n}=a().chat.singleModeState;switch(n){case"off":throw new Error("Single mode is not enabled");case"python":throw new Error("Python single mode is not supported yet");case"dataShaping":t((o=e,async e=>{await(0,x.Nl)(e,o)}));break;default:(0,S.x)(n)}var o;t(v.m.exitSingleMode())},ge=()=>(e,t)=>t().chat.lastPythonQueryId},8745:(e,t,a)=>{"use strict";a.d(t,{H5:()=>l,IC:()=>i,iK:()=>r,rK:()=>s});var n=a(804672),o=a(208520);function r(e){const t=o.useRef(e);t.current=e,o.useEffect((()=>()=>t.current()),[])}function i(e,t){const a=o.useRef(!1),n=o.useRef(t);n.current=t,o.useEffect((()=>{!a.current&&e&&(a.current=!0,n.current())}),[e])}function l(e){i(!0,e)}function s(e,t,a,r){const i=(0,o.useRef)(performance.now()),[l,s]=(0,o.useState)((()=>t?"loaded":"loading")),c=function(e,t){const a=(0,o.useRef)(e);a.current=e;const n=(0,o.useRef)();return(0,o.useEffect)((()=>{const e=setTimeout((()=>{a.current?.()}),t);return n.current=()=>{clearTimeout(e),n.current=void 0},()=>n.current?.()}),[]),()=>n.current?.()}((()=>{(0,n.cY)(`useLoadingTimeout(${e}): timed out after ${a/1e3}s`),s("timeout"),r?.onTimeout?.()}),a);return(0,o.useEffect)((()=>{const a=performance.now()-i.current,o=`useLoadingTimeout(${e}, t=${(a/1e3).toFixed(2)}s)`;if(t)switch(l){case"loaded":r?.onLoaded?.(Math.round(a),!1),(0,n.cY)(`${o}: already loaded`),c();break;case"loading":(0,n.cY)(`${o}: loaded`),c(),s("loaded");break;case"timeout":(0,n.cY)(`${o}: loaded after timeout`),r?.onLoaded?.(Math.round(a),!0)}}),[t,l]),l}},9847:(e,t,a)=>{"use strict";a.d(t,{BC:()=>I,BJ:()=>L,CD:()=>ee,CT:()=>n,DD:()=>i,Dh:()=>r,EB:()=>v,IC:()=>c,Jr:()=>ae,KZ:()=>E,LP:()=>p,Mv:()=>l,OP:()=>o,P1:()=>$,Q6:()=>z,Qf:()=>q,RE:()=>Y,SV:()=>V,Sn:()=>C,W0:()=>y,Y9:()=>R,_4:()=>f,_R:()=>K,a5:()=>d,b6:()=>U,cc:()=>B,dA:()=>h,eQ:()=>Z,gY:()=>H,h3:()=>s,he:()=>S,ib:()=>m,iq:()=>b,j:()=>Q,nE:()=>G,pN:()=>X,q:()=>w,q0:()=>u,qJ:()=>te,r:()=>J,rI:()=>ne,tj:()=>T,uF:()=>A,un:()=>x,xJ:()=>D,xL:()=>g,zq:()=>j});var n,o,r,i,l,s,c,d,u,m,h,g,p,b,f,C,y,v,x,T,S,w,E,I,R,A,L,k=a(922873),F=a(83437),_=a(965634),P=a(956258),N=a(79458),M=a(528804),O=a(48093);!function(e){e.AugloopSessionGuid="AugloopSessionGuid",e.CheckPoints="CheckPoints",e.UserQueryGuid="UserQueryGuid",e.IsSuccessful="IsSuccessful",e.IsQuerySuccess="IsQuerySuccess",e.OperationName="OperationName",e.Duration="Duration",e.IsFluxEnabled="IsFluxEnabled",e.FeatureName="FeatureName",e.AugloopInitializationTime="AugloopInitializationTime",e.AnnotationActivationTime="AnnotationActivationTime",e.RequestSignalType="RequestSignalType",e.AnnotationType="AnnotationType",e.ChatHistoryLoadTime="ChatHistoryLoadTime",e.ChatPaneLoadTime="ChatPaneLoadTime",e.CopilotChatHistoryInfoJson="CopilotChatHistoryInfoJson",e.ContentOrigin="ContentOrigin",e.SDXResourcesLoadTime="SDXResourcesLoadTime",e.FirstServiceResponse="FirstServiceResponse",e.UserPerceivedLatency="UserPerceivedLatency",e.IsFromCache="IsFromCache",e.StopGeneratingTime="StopGeneratingTime",e.HandoffMessageResponseTime="HandoffMessageResponseTime",e.ContextTreeBuildTime="ContextTreeBuildTime",e.UserCopilotPaneLoadTime="UserCopilotPaneLoadTime",e.UserCopilotPaneLoadTime_PreloadTime="UserCopilotPaneLoadTime_PreloadTime",e.ExcelUserCopilotPaneLoadTime="ExcelUserCopilotPaneLoadTime",e.ExtensibilityInfo="ExtensibilityInfo"}(n||(n={})),function(e){e.AugloopInitialization="AugloopInitialization",e.AnnotationActivation="AnnotationActivation",e.ContextTreeBuild="ContextTreeBuild",e.AugloopResponse="AugloopResponse",e.QueryExecution="QueryExecution",e.ImageResponse="ImageResponse",e.AnalyzeData="AnalyzeData",e.InsertAnalyzeData="InsertAnalyzeData",e.Commanding="Commanding",e.ConditionalFormatting="ConditionalFormatting",e.CalculatedColumns="CalculatedColumns",e.CalculatedCells="CalculatedCells",e.ChatHistoryHydrateMessages="ChatHistoryHydrateMessages",e.DocumentContextCollection="DocumentContextCollection",e.ApplyDataShaping="ApplyDataShaping",e.DataShaping="DataShaping",e.EnterDataShapingMode="EnterDataShapingMode",e.ExitDataShapingMode="ExitDataShapingMode",e.InsertCalculatedColumn="InsertCalculatedColumn",e.InsertCalculatedColumns="InsertCalculatedColumns",e.InsertCalculatedCell="InsertCalculatedCell",e.InsertCalculatedCells="InsertCalculatedCells",e.UpdateCalculatedCell="UpdateCalculatedCell",e.UpdateCalculatedCells="UpdateCalculatedCells",e.InsertFormulaSuggestion="InsertFormulaSuggestion",e.InsertSampleData="InsertSampleData",e.InsertTable="InsertTable",e.InsertList="InsertList",e.ActionAI="ActionAI",e.Navigation="Navigation",e.FetchResource="FetchResource",e.OpenSdx="OpenSdx",e.ZeroQueryMessage="ZeroQueryMessage",e.FluxReasoning="FluxReasoning",e.FluxOverall="FluxOverall",e.FluxSkillCardShown="FluxSkillCardShown",e.FluxFirstStreamedToken="FluxFirstStreamedToken",e.FluxGenerateResponse="FluxGenerateResponse",e.FluxSkillStart="FluxSkillStart",e.FluxSkillEnd="FluxSkillEnd",e.LoadLocalizedStrings="LoadLocalizedStrings",e.ScheduleOfficeScriptsHiTLShown="ScheduleOfficeScriptsHiTLShown",e.SaveOfficeScripts="SaveOfficeScripts",e.CreateOfficeScripts="CreateOfficeScripts",e.Python="Python",e.PythonStartAnalysis="PythonStartAnalysis",e.PythonCellsCalculating="PythonCellsCalculating",e.PythonInsertingResultInNewSheet="PythonInsertingResultInNewSheet",e.PythonCalculatedColumn="PythonCalculatedColumn",e.InsertPythonCalculatedColumn="InsertPythonCalculatedColumn",e.ChatResponseFirstChunk="ChatResponseFirstChunk",e.ChatResponseLastChunk="ChatResponseLastChunk",e.FetchCitationFileMetadata="FetchCitationFileMetadata",e.RecognizeTable="RecognizeTable",e.Search="Search",e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.ElseSkillExecuting="ElseSkillExecuting",e.ImportDataGenerateSuggestion="ImportDataGenerateSuggestion",e.ImportDataRelevancyCheck="ImportDataRelevancyCheck",e.ImportDataLoadQuery="ImportDataLoadQuery",e.NoCurrentlyExecutingCommandSet="NoCurrentlyExecutingCommandSet",e.FormulaDescriptionAvailable="FormulaDescriptionAvailable",e.FormulaExplanationAvailable="FormulaExplanationAvailable",e.FormulaPreviewAvailable="FormulaPreviewAvailable",e.FirstChunkFinalResponse="FirstChunkFinalResponse",e.LastChunkFinalResponse="LastChunkFinalResponse",e.ApplyTLRAutoFix="ApplyTLRAutoFix",e.FetchTablesRelevancy="FetchTablesRelevancy",e.XLIMWorkflowDuration="XLIMWorkflowDuration",e.SubmitToXLIMWorkflowComplete="SubmitToXLIMWorkflowComplete",e.XLIMWorkflowCompleteToAnnotationsReceived="XLIMWorkflowCompleteToAnnotationsReceived",e.CommandScratchpadValidateOfficeJsCompleted="CommandScratchpadValidateOfficeJsCompleted",e.ChartDesignRecommendationsScratchpadValidateOfficeJsCompleted="ChartDesignRecommendationsScratchpadValidateOfficeJsCompleted",e.ChartDesignRecommendationsChartScenegraphGenerationCompleted="ChartDesignRecommendationsChartScenegraphGenerationCompleted",e.ChartDesignRecommendationsResponseCardShown="ChartDesignRecommendationsResponseCardShown",e.ExpandableListExpansion="ExpandableListExpansion",e.ChartDesignRecommendations="ChartDesignRecommendations"}(o||(o={})),function(e){e.UserQueryGuid="UserQueryGuid",e.EventState="EventState",e.OperationOrder="OperationOrder",e.OperationType="OperationType",e.TimeDurationInMs="TimeDurationInMs",e.OperationParameters="OperationParameters",e.UserQueryOrder="UserQueryOrder",e.StatementNames="StatementNames",e.CurrentStatement="CurrentStatement",e.ExecutableNames="ExecutableNames",e.ExecutableAgent="ExecutableAgent",e.CFRuleType="CFRuleType",e.ColumnCFRApplied="ColumnCFRApplied",e.SortFilterColorFound="SortFilterColorFound",e.SuccessMessageNumParameters="SuccessMessageNumParameters",e.SuccessMessageFormattingParameters="SuccessMessageFormattingParameters",e.UnsupportedConditionalFormatType="UnsupportedConditionalFormatType",e.ConditionalFormatType="ConditionalFormatType",e.FormattingTypes="FormattingTypes",e.EventType="EventType",e.IsFluxEnabled="IsFluxEnabled",e.SortRangeAddress="SortRangeAddress",e.SortColumnIndex="SortColumnIndex",e.ErrorMessage="ErrorMessage"}(r||(r={})),function(e){e.ConvertSucceeded="ConvertSucceeded",e.UnsupportedStatement="UnsupportedStatement",e.VariableCacheFailed="VariableCacheFailed",e.ConverterFailed="ConverterFailed",e.ExecutorSucceeded="ExecutorSucceeded",e.ExecutorFailed="ExecutorFailed",e.ExecutorNoneExecuted="ExecutorNoneExecuted"}(i||(i={})),function(e){e.ConditionalFormatEvent="ConditionalFormatEvent",e.GetFilterOrSortColor="GetFilterOrSortColor",e.LogSuccessMessageFormattingParameters="LogSuccessMessageFormattingParameters",e.LogMissingIntentString="LogMissingIntentString",e.LogUnsupportConditionalFormatType="LogUnsupportedConditionalFormatType",e.LogStatmentInformation="LogStatementInformation",e.LogSortRangeAddress="LogSortRangeAddress"}(l||(l={})),function(e){e.UserQueryGuid="UserQueryGuid",e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.UserQueryOrder="UserQueryOrder",e.IsFluxEnabled="IsFluxEnabled",e.IsTLR="IsTLR",e.IsTableContained="IsTableContained",e.isTableIntersected="IsTableIntersected",e.ChatErrorType="ChatErrorType",e.ChatErrorParameters="ChatErrorParameters",e.Cv="Cv",e.IsTable="IsTable",e.IsValidTLR="IsValidTLR",e.UnrecognizedTabularRangeError="UnsupportedTabularRangeError",e.IsChart="IsChart",e.IsPivotTable="IsPivotTable",e.TLRFeatures="TLRFeatures",e.TableLikeEntityDimensions="TableLikeEntityDimensions",e.SelectionError="SelectionError",e.DocumentContext="DocumentContext",e.Submitted="Submitted",e.ExtensibilityInfo="ExtensibilityInfo",e.IsTFCEnabled="IsTFCEnabled"}(s||(s={})),function(e){e.ErrorCategory="ErrorCategory",e.ErrorMessage="ErrorMessage",e.ExtensibilityInfo="ExtensibilityInfo"}(c||(c={})),function(e){e.ActionConfirmationMessage="Action_Confirmation_Message",e.ConversationMessage="Conversation_Message",e.EnterKeyPressed="Enter_Key_Pressed",e.ErrorMessage="Error_Message",e.HelpMessage="Help_Message",e.HumanInput="Human_Input",e.HumanSuggestionApplied="Human_Suggestion_Applied",e.StopButtonClicked="Stop_Button_Clicked",e.SubmitButtonClicked="Submit_Button_Clicked",e.UserUtteranceSubmitted="User_Utterance_Submitted",e.SuggestionPaneSuggestionClicked="SuggestionPane_Suggestion_Clicked",e.SuggestionPaneSuggestionShown="SuggestionPane_Suggestion_Shown",e.ZeroQueryMessageSuggestionClicked="ZeroQueryMessage_Suggestion_Clicked",e.SuggestionMessage="Suggestion_Message",e.QuerySubmittedToAL="Query_Submitted_To_Augloop",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ThumbsUpButtonClicked="Thumbs_Up_Button_Clicked",e.ThumbsDownButtonClicked="Thumbs_Down_Button_Clicked",e.AugLoopSessionClosed="AugLoop_Session_Closed",e.AugLoopSessionModelWorkflowUnsupported="AugLoop_Session_Model_Workflow_Unsupported",e.HowCanCopilotHelpSuggestionClicked="How_Can_Copilot_Help_Suggestion_Clicked",e.AddAllInsightsToGridClicked="Add_All_Insights_To_Grid_Clicked",e.AnnotationActivated="Annotation_Activated",e.ChatHistorySignal="Chat_History_Signal",e.ChatHistoryResponse="Chat_History_Response",e.ShowMeAnotherInsightClicked="Show_Me_Another_Insight_Clicked",e.CalculatedColumnsSignalSent="Calculated_Columns_Signal_Sent",e.LanguageNotAvailableMessage="Language_Not_Available_Message",e.BasicChatSuggestionClicked="BasicChat_Suggestion_Clicked",e.ChatHistoryLoaded="Chat_History_Loaded",e.ChatPaneLoaded="Chat_Pane_Loaded",e.SharedCopilotChatLogEvent="Shared_Copilot_Chat_Log_Event",e.CopyButtonClicked="Copy_Button_Clicked",e.CalculatedColumnsExplainButtonClicked="Calculated_Columns_Explain_Button_Clicked",e.PythonCalculatedColumnsExplainButtonClicked="Python_Calculated_Columns_Explain_Button_Clicked",e.LargeDataErrorMessage="Large_Data_Error_Message",e.ChangeTopicButtonClicked="Change_Topic_Button_Clicked",e.SaveScriptClicked="Save_Script_Clicked",e.DeleteScriptClicked="Delete_Script_Clicked",e.OfficeScriptsLinkClicked="Office_Scripts_Link_Clicked",e.DocumentClpUpgrade="DocumentClpUpgrade",e.ClpLabelUpdateFromChatHistory="ClpLabelUpdateFromChatHistory",e.ResponseStreamFinished="Response_Stream_Finished",e.InsertingTablesFromResponse="Inserting_Tables_From_Response",e.InsertingListsFromResponse="Inserting_Lists_From_Response",e.FormulaPreviewButtonAllowed="Formula_Preview_Button_Allowed",e.FormulaPreviewButtonDisabled="Formula_Preview_Button_Disabled",e.FormulaPreviewButtonVisible="Formula_Preview_Button_Visible",e.FormulaPreviewButtonClickShow="Formula_Preview_Button_Click_Show",e.FormulaPreviewButtonClickHide="Formula_Preview_Button_Click_Hide",e.PromptAuthPopup="Prompt_Auth_Popup",e.ChatHistoryImageResendEvent="Chat_History_Image_Resend_Event",e.SelfHelpContentShown="SelfHelp_Content_Shown",e.SelfHelpActionClicked="SelfHelp_Action_Clicked",e.CalculatedFormulaGetFormula="Calculated_Formula_Get_Formula",e.CalculatedFormulaGetDescription="Calculated_Formula_Get_Description",e.CalculatedFormulaGetExplanation="Calculated_Formula_Get_Explanation",e.CalculatedRowsSuggestionsReceived="Calculated_Rows_Suggestions_Received",e.DataShapingAddSteps="Data_Shaping_Add_Steps",e.DataShapingEndMode="Data_Shaping_End_Mode",e.DataShapingPreviewClosed="Data_Shaping_Preview_Closed",e.DataShapingQueryScriptChanged="Data_Shaping_Query_Script_Changed",e.DataShapingShowErrorCard="Data_Shaping_Show_Error_Card",e.DataShapingShowStartCard="Data_Shaping_Show_Start_Card",e.DataShapingStartMode="Data_Shaping_Start_Mode",e.DataShapingUndoSteps="Data_Shaping_Undo_Steps",e.DataShapingEditQuery="Data_Shaping_Edit_Query",e.DataShapingHydration="Data_Shaping_Hydration",e.DataShapingAgentChange="Data_Shaping_Agent_Change",e.DataShapingAgentStartMode="Data_Shaping_Agent_Start_Mode",e.DataShapingAgentEndMode="Data_Shaping_Agent_End_Mode",e.FormulaSuggestionDedupedContextTables="Formula_Suggestion_Deduped_Context_Tables",e.FormulaSuggestionInvalidated="Formula_Suggestion_Invalidated",e.FormulaSuggestionTrackedForInvalidation="Formula_Suggestion_Tracked_For_Invalidation",e.FormulaSuggestionInsertColumnTimings="Formula_Suggestion_Insert_Column_Timings",e.FormulaSuggestionInsertRowTimings="Formula_Suggestion_Insert_Row_Timings",e.FormulaSuggestionInvalidationTrackingData="Formula_Suggestion_Invalidation_Tracking_Data",e.FormulaSuggestionSkillData="Formula_Suggestion_Skill_Data",e.FormulaSnippetData="Formula_Snippet_Data",e.ScheduleScriptClicked="Schedule_Script_Clicked",e.FlowCreatedConfirmation="Flow_Created_Confirmation",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ALUserType="AL_User_Type",e.GroundingSourceUpdated="Grounding_Source_Updated",e.HumanInTheLoopMessage="Human_In_The_Loop_Message",e.EmptyMessageReceivedFromSydney="Empty_Message_Received_From_Sydney",e.SelectTableCard="Select_Table_Card",e.ImportDataCard="Import_Data_Card",e.ImportDataShowCard="Import_Data_Show_Card",e.ImportDataLoadQuery="Import_Data_Load_Query",e.ImportDataExplainButtonClicked="Import_Data_Explain_Button_Clicked",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.OfficeJSReady="OfficeJS_Ready",e.CopilotEnabledAfterAutoSave="Copilot_Enabled_After_AutoSave",e.ShowDisabledScreen="Show_Disabled_Screen",e.SignalWithSkillOverride="Signal_With_Skill_Override",e.SkillOverride="Skill_Override",e.HandoffMessageFromHostAppSettingsError="HandoffMessageFromHostAppSettingsError",e.HandoffMessageIdResponseError="Handoff_MessageIdResponse_Error",e.HandoffMessageIdGetOperationSubmitted="Handoff_Message_Id_Get_Operation_Submitted",e.HandoffMessageIdProcessedOperationSubmitted="Handoff_Message_Id_Processed_Operation_Submitted",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted",e.HandoffQuerySubmittedByUser="Handoff_Query_Submitted_By_User",e.HandoffComplete="Handoff_Complete",e.AnalyzeDataEmptyAnswer="Analyze_Data_Empty_Answer",e.AnalyzeDataMarkdownMessage="Analyze_Data_Markdown_Message",e.CSHScenarioRun="CSH_Scenario_Run",e.ContextManagerInitialized="Context_Manager_Initialized",e.DefaultInsertCalculatedColumnFailed="DefaultInsertCalculatedColumnFailed",e.CalculatedColumnExpandFailedNotEmptyColumn="CalculatedColumnExpandFailedNotEmptyColumn",e.CalculatedColumnExpandFailed="CalculatedColumnExpandFailed",e.CalculatedCellExpandFailedNotEmptyCell="CalculatedCellExpandFailedNotEmptyCell",e.CalculatedCellExpandFailed="CalculatedCellExpandFailed",e.CalculatedColumnPartialInsertFailed="CalculatedColumnPartialInsertFailed",e.DocumentGroundingShown="DocumentGroundingShown",e.TabularRangeAutoFixFailed="TabularRangeAutoFixFailed",e.TabularRangeNoAutoFixApplied="TabularRangeNoAutoFixApplied",e.PythonCodeAndPostViewCardShown="PythonCodeAndPostViewCardShown",e.PythonMergedCardShown="PythonMergedCardShown",e.PythonCodeAndPostViewCardUpdatedWithResult="PythonCodeAndPostViewCardUpdatedWithResult",e.PythonCodeAndPostViewCardUpdatedWithError="PythonCodeAndPostViewCardUpdatedWithError",e.PythonResultsAddedToNewSheetSuccess="PythonResultsAddedToNewSheetSuccess",e.PythonResultsAddedToNewSheetError="PythonResultsAddedToNewSheetError",e.TriggerImageChatOperation="Trigger_Image_Chat_Operation",e.ExternalQuery="External_Query",e.LoadingTableLikeRangesWarning="Loading_TableLikeRanges_Warning",e.InitializePrivateHostMessagingDuration="InitializePrivateHostMessagingDuration",e.DisplayExternalMessages="Display_External_Messages",e.CommandScratchpadExpandHitlListClicked="CommandScratchpadExpandHitlListClicked",e.CommandScratchpadHitlDescriptionTelemetry="CommandScratchpadHitlDescriptionTelemetry",e.CommandScratchpadValidateOfficeJsCalled="CommandScratchpadValidateOfficeJsCalled",e.CommandScratchpadFallbackDescriptionUsed="CommandScratchpadFallbackDescriptionUsed",e.CommandScratchpadPassiveTesting="CommandScratchpadPassiveTesting",e.ChartDesignRecommendationsAnnotionReceived="ChartDesignRecommendationsAnnotionReceived",e.ChartDesignRecommendationsCardShown="ChartDesignRecommendationsCardShown",e.ChartDesignRecommendationsValidateOfficeJSResultCalled="ChartDesignRecommendationsValidateOfficeJSResultCalled",e.ChartDesignRecommendationsScratchpadHitlDescriptionTelemetry="ChartDesignRecommendationsScratchpadHitlDescriptionTelemetry",e.ChartDesignRecommendationsChartRecommendationSignalTriggered="ChartDesignRecommendationsChartRecommendationSignalTriggered",e.ChartDesignRecommendationsChartRecommendationSignalCompleted="ChartDesignRecommendationsChartRecommendationSignalCompleted",e.ChartDesignRecommendationsSuggestionApplied="ChartDesignRecommendationsSuggestionApplied",e.ChartDesignRecommendationsActivated="ChartDesignRecommendationsActivated",e.ChartDesignRecommendationsOptOut="ChartDesignRecommendationsOptOut",e.ChartDesignRecommendationsPreviewButtonClicked="ChartDesignRecommendationsPreviewButtonClicked",e.ChartDesignRecommendationsAllPreviewsLoaded="ChartDesignRecommendationsAllPreviewsLoaded",e.ChartDesignRecommendationsInProgress="ChartDesignRecommendationsInProgress",e.DocumentContextFlags="DocumentContextFlags",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.TaskPaneVisibilityModeChanged="TaskPaneVisibilityModeChanged",e.PreloadCopilot="PreloadCopilot",e.GptIdForBranding="Gpt_Id_For_Branding",e.ExtensibilityConfig="Extensibility_Config",e.InterstitialMessageShown="Interstitial_Message_Shown",e.BizchatHostContext="BizChat_Host_Context"}(d||(d={})),function(e){e.AgentTimeout="Agent_Timeout",e.AugloopTimeout="Augloop_Timeout",e.BadToken="Bad_Token",e.ClientError="Client_Error",e.DashboardInsertFailed="Dashboard_Insert_Failed",e.DetectedJunkQuery="Junk_Query",e.DetectedMultipleIntents="Multiple_Intents_Detected",e.DetectedOffensiveContent="Offensive_Content",e.DetectedOutOfScope="Out_Of_Scope",e.DetectedOutOfScopeShort="Out_Of_Scope_Short",e.DetectedTooShort="Too_Short",e.DetectedUnsupportedLanguage="Unsupported_Language",e.NoTableLikeEntityFound="No_TableLikeEntity_Found",e.UnsupportedTabularRange="Unsupported_Tabular_Range",e.LicensingError="Licensing_Error",e.NetworkError="Network_Error",e.NoSuggestions="No_Suggestions",e.NotSingleColumn="Not_Single_Column",e.UserThrottled="User_Throttled",e.RaiError="RAI_Error",e.LLMServiceError="LLM_Service_Error",e.IrrelevantQuery="Irrelevant_Query",e.OdslExecutionFailed="Odsl_Execution_Failed",e.OfficeJsExecutionFailed="OfficeJs_Execution_Failed",e.OrchestratorDisengaged="OrchestratorDisengaged",e.ServiceError="Service_Error",e.TokenCount="Token_Count",e.UnsupportedCommand="UnsupportedCommand",e.LargeData="Large_Data",e.ChatHistoryHydrationFailed="Chat_History_Hydration_Failed",e.ChatHistoryImageResendFailed="Chat_History_Image_Resend_Failed",e.PythonCalculatedColumnsError="Python_Calculated_Columns_Error",e.PythonError="Python_Error",e.UnsupportedObjectDetected="Unsupported_Object_Detected",e.TlrAutofixError="Tlr_Autofix_Error",e.OutOfCreditsError="Out_Of_Credits_Error",e.TLRAutofixSuggestion="Tlr_Autofix_Suggestion",e.Unauthorized="Unauthorized"}(u||(u={})),function(e){e.ErrorMessage="ErrorMessage",e.OperationType="OperationType",e.RequestId="RequestId",e.ErrorType="ErrorType",e.LogLevel="LogLevel"}(m||(m={})),function(e){e.ErrorMessage="ErrorMesasge",e.LogLevel="LogLevel",e.TimeOut="TimeOut",e.Id="Id"}(h||(h={})),function(e){e.LogLevel="LogLevel",e.ErrorMessage="ErrorMessage",e.NumOfColumnHidden="NumOfColumnHidden"}(g||(g={})),function(e){e.FailedEventMethods="Executor_FailedMethods",e.Agent="Executor_ExecutableAgent"}(p||(p={})),function(e){e.Reason="Reason",e.CurrentStatement="CurrentStatement",e.ArgumentNames="ArgumentNames",e.UnsupportedArgumentTypes="UnsupportedArgumentTypes"}(b||(b={})),function(e){e.Reason="Reason",e.ArgumentType="ArgumentType",e.ExpectedType="ExpectedType"}(f||(f={})),function(e){e.ODSLProperty="ODSLProperty"}(C||(C={})),function(e){e.CorrelationId="CorrelationId",e.EventType="EventType",e.ExcelCorrelationId="ExcelCorrelationId",e.FetchRecommendationsCorrelationId="FetchRecommendationsCorrelationId",e.NumRows="NumRows",e.NumColumns="NumColumns",e.NumRowsSelected="NumRowsSelected",e.NumRowsReferenced="NumRowsReferenced",e.SelectionExpanded="SelectionExpanded",e.IsSmallSelection="IsSmallSelection",e.IsTable="IsTable",e.HasTableHeaders="HasTableHeaders",e.AreaCount="AreaCount",e.HasInvalidValues="HasInvalidValues",e.IsSuccessful="IsSuccessful",e.Method="Method",e.Api="Api",e.ResponseCode="ResponseCode",e.RetryCount="RetryCount",e.ResponseType="ResponseType",e.ServiceTime="ServiceTime",e.RangeId="RangeId",e.OperationId="OperationId",e.CompressionMethod="CompressionMethod",e.CompressionTime="CompressionTime",e.SerializationTime="SerializationTime",e.OperationStatus="OperationStatus",e.RequestSize="RequestSize",e.FailureReason="FailureReason",e.FailureLocation="FailureLocation",e.RecommendationData="RecommendationData",e.Duration="Duration",e.NumChunks="NumChunks",e.NumSyncs="NumSyncs",e.MinRowsInChunk="MinRowsInChunk",e.Type="Type",e.NLContextId="NLContextId",e.AllowRewrite="AllowRewrite",e.IsAnnaParserFallback="IsAnnaParserFallback",e.TraceId="TraceId",e.SpanId="SpanId",e.VisualType="VisualType",e.ReasonForError="ReasonForError",e.IsInvalidInsightsSession="IsInvalidInsightsSession",e.InvalidInsightsSessionSource="invalidInsightsSessionSource",e.QueryType="QueryType",e.RowOffset="RowOffset",e.Height="Height",e.Width="Width",e.Caveats="Caveats",e.TextAnalysisResultType="TextAnalysisResultType"}(y||(y={})),function(e){e.CorrelationId="CorrelationId",e.Duration="Duration",e.ExcelCorrelationId="ExcelCorrelationId",e.FetchRecommendationsCorrelationId="FetchRecommendationsCorrelationId",e.RequestId="RequestId",e.SuggestionId="SuggestionId",e.Type="Type"}(v||(v={})),function(e){e.CorrelationId="CorrelationId",e.ErrorCode="ErrorCode",e.ErrorLocation="ErrorLocation",e.EvaluateQueryCorrelationId="EvaluateQueryCorrelationId",e.ErrorType="EventType",e.ExcelCorrelationId="ExcelCorrelationId",e.FetchRecommendationsCorrelationId="FetchRecommendationsCorrelationId",e.Message="Message",e.Name="Name",e.OfficeErrorCode="OfficeErrorCode",e.Reason="Reason",e.RecommendationId="RecommendationId",e.Source="Source",e.Stack="Stack",e.InnerError="InnerError",e.SuggestionID="SuggestionID"}(x||(x={})),function(e){e.TimeoutAfter="TimeoutAfter",e.Source="Source",e.Message="Message",e.UserQueryGuid="UserQueryGuid"}(T||(T={})),function(e){e.NoResult="NoResult",e.SuggestionApplied="SuggestionApplied",e.SuggestionShown="SuggestionShown",e.Undo="Undo",e.Deleted="Deleted",e.GroundPickerSelected_DocMode="GroundPickerSelected_DocMode",e.GroundPickerSelected_EnterpriseMode="GroundPickerSelected_EnterpriseMode",e.InsertTableShowed="InsertTableShowed",e.InsertTableClicked="InsertTableClicked",e.InsertTableSuccess="InsertTableSuccess",e.InsertListShowed="InsertListShowed",e.InsertListClicked="InsertListClicked",e.InsertListSuccess="InsertListSuccess",e.CopyMessageClicked="CopyMessageClicked",e.ImportDataButtonShowed="ImportDataButtonShowed",e.ImportDataButtonClicked="ImportDataButtonClicked",e.ViewScript="ViewScriptClicked",e.SaveScript="SaveScriptClicked",e.DeleteScript="DeleteScriptClicked",e.FormulaCopyClicked="FormulaCopyClicked",e.OfficeScriptsFolderClicked="OfficeScriptsFolderClicked",e.ScheduleScriptClicked="ScheduleScriptClicked",e.Apply="Apply",e.ConditionalFormattingSuggestionPillClicked="ConditionalFormattingSuggestionPillClicked",e.ElseFallback="ElseFallback",e.TeachingCalloutShown="TeachingCalloutShown",e.PythonFallback="PythonFallback"}(S||(S={})),function(e){e.AnalyzeData="AnalyzeData",e.Answers="Answers",e.CalculatedColumns="CalculatedColumns",e.PythonCalculatedColumns="PythonCalculatedColumns",e.ChatPaneLoad="ChatPaneLoad",e.Commanding="Commanding",e.ConditionalFormatting="ConditionalFormatting",e.ConditionalFormattingSuggestion="ConditionalFormattingSuggestion",e.ConvertToTable="ConvertToTable",e.CopilotChat="CopilotChat",e.CopyMessage="CopyMessage",e.DataShaping="DataShaping",e.Else="Else",e.ExternalTriggeredQuery="ExternalTriggeredQuery",e.ImportDataFromSearch="ImportDataFromSearch",e.ImportDataSkill="ImportDataSkill",e.InsertTable="InsertTable",e.InsertList="InsertList",e.ImageChat="Image Chat",e.NLToFormula="NLToFormula",e.OfficeJsCommanding="OfficeJsCommanding",e.OfficeScripts="OfficeScripts",e.Python="Python",e.SampleData="SampleData",e.Search="Search",e.SelfHelp="Self-Help Search",e.ShowHeaders="ShowHeaders",e.SmartHelp="SmartHelp",e.UndoMessage="UndoMessage",e.HandOff="Hand-Off",e.ContextInference="ContextInference",e.CalculatedRows="CalculatedRows",e.PythonForms="PythonForms",e.ChartDesignRecommendations="ChartDesignRecommendations",e.Unset="",e.ExcelAgent="ExcelAgent"}(w||(w={})),function(e){e.AddButton="AddButton",e.DashboardSuggestionPill="DashboardSuggestionPill",e.GridAction="GridAction",e.InsightsApi="InsightsApi",e.UndoButton="UndoButton",e.NLChatRequest="NLChatRequest",e.FormulaGenerationSuggestionPill="FormulaGenerationSuggestionPill",e.SubmitPythonStartAnalysisQuery="SubmitPythonStartAnalysisQuery",e.SubmitPythonAdaQuery="SubmitPythonAdaQuery",e.InsertPythonCodeButton="InsertPythonCodeButton",e.PythonAdaCodeInserted="PythonAdaCodeInserted",e.CopyPythonCodeButton="CopyPythonCodeButton",e.ViewScriptButton="ViewScriptButon",e.SaveScriptButton="SaveScriptButton",e.DeleteScriptButton="DeleteScriptButton",e.CopyFormulaButton="CopyFormulaButton",e.ScheduleScriptButton="ScheduleScriptButton",e.ApplyButton="ApplyButton",e.ConditionalFormattingSuggestionPill="ConditionalFormattingSuggestionPill",e.SearchResponse="SearchResponse",e.ChatResponse="ChatResponse",e.Answers="Answers"}(E||(E={})),function(e){e.Default="Default",e.SuggestionPill="SuggestionPill",e.ZQM="ZQM",e.ExternalQuery="ExternalQuery",e.MenuItem="MenuItem",e.InternalTool="InternalTool",e.MsFormsSDX="MsFormsSDX",e.AAChartingRibbon="AAChartingRibbon"}(I||(I={})),function(e){e.Chat="Chat",e.Canvas="Canvas"}(R||(R={})),function(e){e.Analyze="Analyze",e.Ask="Ask",e.Command="Command",e.Create="Create",e.Share="Share",e.Summarize="Summarize",e.UnknownIntent="UnknownIntent"}(A||(A={})),function(e){e.AnalyzeData="AnalyzeData",e.Answers="Answers",e.FormulaGeneration="FormulaGeneration",e.ChatPaneLoad="ChatPaneLoad",e.Preload_ChatPaneLoad="Preload_ChatPaneLoad",e.ChatQnA="Chat QnA",e.Commanding="Commanding",e.ConditionalFormatting="ConditionalFormatting",e.ImportData="ImportData",e.CopilotChat="CopilotChat",e.OfficeScripts="OfficeScripts",e.ExcelChatHelper="ExcelChatHelper",e.Python="Python",e.Search="Search",e.Handoff="Handoff",e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.PrepareData="Prepare Data",e.ChartDesignRecommendations="ChartDesignRecommendations",e.Unset=""}(L||(L={}));const D=e=>(new Date).getTime()-e,B=e=>performance.now()-e,$=(e,t)=>({eventType:e,eventData:Object.keys(t).map((e=>({key:e,value:t[e]})))}),H=e=>(e.UserQueryGuid=P.M.userQueryGuid,e.UserQueryOrder=P.M.userQueryOrder,{eventType:_.S2.OfficeJsOperations,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}),U=()=>{const e={};return Object.keys(r).forEach((t=>{e[t]=""})),e};function q({actionType:e,featureName:t,source:a,suggestionId:n,userQueryGuid:o}){return V(e,t,a,n,o)}const V=(e,t,a,n,o,r,...i)=>{const l=[{key:_.tE.ActionType,value:e},{key:_.tE.FeatureName,value:t??"Commanding"},...i];return a&&l.push({key:_.tE.Source,value:a}),n&&l.push({key:_.tE.SuggestionId,value:n}),o&&l.push({key:_.tE.UserQueryGuid,value:o}),r&&l.push({key:_.tE.ActionVariant,value:r}),{eventType:_.S2.Usage,eventData:l}},G=e=>({eventType:_.S2.ZeroQueryMessageClicks,eventData:[{key:_.Qs.PromptDescription,value:e}]});var W;!function(e){e.CreatePresentation="Create Presentation",e.AddContent="Add Content",e.Organize="Organize",e.BasicCommand="Basic Command",e.Summarize="Summarize",e.DocumentQnA="Document QnA",e.ChatQnA="Chat QnA",e.Unset="",e.CopilotChat="Copilot Chat"}(W||(W={}));const z=()=>{if((0,M.vIj)()){let e="Workbook";return(0,O.pX)()&&(e+="+Work"),(0,O.gc)()&&(e+="+Web"),e}return(0,O.pX)()?"Enterprise":"Workbook"},j=e=>{let t={};try{t=JSON.parse(e)}catch(e){(0,N.cY)("Error parsing telemetry data ",e.message)}return t},Q=e=>{const t=e.getActiveTable(),a=t?.tableLikeRange?"true":"false",n=t?.tableLikeRange&&!t?.tableLikeRangeFeatures?"true":"false",o=t&&!t.tableLikeRange?"true":"false",r=t?.tableContained?"true":"false",i=t?.tableIntersected?"true":"false",l=e?.activeChart?"true":"false",s=e?.activePivotTable?"true":"false",c=`${t?.tableLikeRangeFeatures??0}`,d=(0,M.ZAR)()?"true":"false",u=(e=>{if(!e)return"";const t=e.sheetRange.range;return null===t.bottomRight.row||null===t.topLeft.row||null===t.bottomRight.column||null===t.topLeft.column?"":`${t.bottomRight.row-t.topLeft.row+1}x${t.bottomRight.column-t.topLeft.column+1}`})(t);return{IsTLR:a,IsValidTLR:n,IsTable:o,IsTableContained:r,IsTableIntersected:i,IsChart:l,IsPivotTable:s,TLRFeatures:c,TableLikeEntityDimensions:u,SelectionError:e.selectionError?e.selectionError:"",IsTFCEnabled:d}};function J(e){const t=[{key:"TableType",value:"TableContext"},{key:"HasTotalRow",value:e.totalRow},{key:"RowCount",value:e.numRows},{key:"ColumnCount",value:e.numColumns},{key:"HasHiddenColumns",value:e.visibleColumns.length<e.numColumns}];return null!=e.hasHiddenRows&&t.push({key:"HasHiddenRows",value:e.hasHiddenRows}),null!=e.tableLikeRangeFeatures&&t.push({key:"UnsupportedFeatures",value:e.tableLikeRangeFeatures}),null!=e.tableContained&&t.push({key:"TableContained",value:e.tableContained}),null!=e.tableIntersected&&t.push({key:"TableIntersected",value:e.tableIntersected}),null!=e.tableLikeRange&&t.push({key:"TableLikeRange",value:e.tableLikeRange}),t}const Y=e=>{try{const t=Q(e);return{key:"DocumentContext",value:JSON.stringify(t)}}catch(e){}return{key:"DocumentContext",value:""}},X=e=>Object.keys(e).map((t=>({key:t,value:e[t]}))),Z=e=>{let t;if(!e)return t;switch(e){case k.w.ElseSkillName:t="ExcelChatHelper";break;case k.w.GetInsightsName:case k.w.ExcelAnalysis:case k.w.ChartsAndPivotTablesName:case k.w.TextAnalysisName:t="AnalyzeData";break;case k.w.SelfHelpSkillName:t="Search";break;case k.w.FormulasName:case k.w.CalculatedColumnsName:case k.w.CreateCalculatedColumnsName:t="FormulaGeneration";break;case k.w.FormatDocumentName:case k.w.EditDocumentName:t="Commanding";break;case k.w.SearchEnterpriseName:case k.w.SearchToolsRequestInterstitialsPublisher:case k.w.SearchToolsResponseInterstitials:t="Search";break;case k.w.OfficeScriptsName:t="OfficeScripts";break;case k.w.PythonSkillName:case k.w.NewPythonSkillName:case k.w.PythonCalculatedColumnsName:t="Python";break;case k.w.GenerateResponseName:case k.w.ImageChatName:t="CopilotChat";break;case k.w.DataShapingName:t="Prepare Data";break;case k.w.AnswersName:t="Answers";break;case k.w.AugLoopEvalName:case k.w.AugLoopName:case k.w.GetContextName:case k.w.DeepLeo:case k.w.Workflow:break;default:P.M.getInstance().logError({eventType:_.S2.AssertionFailed,errorMessage:`AugLoop returned an unexpected skill: ${e}`,logLevel:F.$b.Error})}return t};var K,ee,te;function ae(e){if((0,M.yw9)("OfficeVSO_9389407_fixErrorLoggingV2"))return"string"==typeof e?new Error(e):e}function ne(e){switch(e){case"Copilot\\Commanding":return"Commanding";case"Copilot\\Commanding CF Suggestions":case"Copilot\\Commanding Conditional Formatting":return(0,M.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?"ConditionalFormatting":"Commanding";case"Copilot\\Analyze Data":return"AnalyzeData";case"Copilot\\Formula Generation":return"CalculatedColumns";case"Copilot\\Search":return"Search";case"Copilot\\Import Data":return"ImportDataFromSearch";case"Copilot\\Python":return"Python";case"Copilot\\PythonForms":return"PythonForms";case"Copilot\\Else":return"Else";case"Copilot\\Image Chat":return(0,M.yw9)("OfficeVSO_9565005_InsertImageOCV")?"Image Chat":"CopilotChat";case"Copilot\\Chart Design Recommendations":return"ChartDesignRecommendations";case"Copilot\\Answers":return"Answers";default:return"CopilotChat"}}!function(e){e.HandoffStart="Handoff_Start",e.AppStart="App_Start",e.CopilotPaneStart="Copilot_Pane_Start",e.TaskPaneStart="Task_Pane_Start",e.AppLoadStart="App_Load_Start",e.OfficeJSReady="OfficeJS_Ready",e.ChatPaneLoaded="Chat_Pane_Loaded",e.HandoffMessageIdSent="Handoff_Message_Id_Sent",e.HandoffMessageIdProcessed="Handoff_Message_Id_Processed",e.HandoffMessageReceived="Handoff_Message_Received",e.HandoffQueryPerceivedByUser="Handoff_Query_Perceived_By_User",e.HandoffQueryAutoSubmitted="Handoff_Query_Auto_Submitted",e.HandoffComplete="Handoff_Complete"}(K||(K={})),function(e){e.PromptType="promptType",e.SourceApp="sourceApp",e.IsModified="isModified",e.ScenarioName="scenarioName",e.FeatureName="featureName"}(ee||(ee={})),function(e){e.FeatureName="FeatureName",e.HasUndoScopeOpened="HasUndoScopeOpened"}(te||(te={}))},10021:(e,t,a)=>{"use strict";a.d(t,{F:()=>C,m:()=>f});var n=a(365319),o=a(88994),r=a(626128),i=a(644476),l=a(298925),s=a(9847),c=a(476730),d=a(956258),u=a(525463),m=a(79458),h=a(528804),g=a(495501);const p={recommendations:{},fetchRecommendationsState:{},tableName:{},isVisible:{},previewId:null,activeRequestId:null,currentShownSuggestionIndex:{},hasShownSuggestionPrompt:{},rawPreview:{},visibleRowPreviewValues:{},currentTotalRowValues:{},invalidatedSuggestions:[],shouldShowFormulaDevButton:!1},b=(0,i.Z0)({name:"dataAI",initialState:p,reducers:{startFetching:(e,t)=>{e.recommendations[t.payload]=[],e.fetchRecommendationsState[t.payload]="inProgress",e.isVisible[t.payload]=!1,e.activeRequestId=t.payload,e.currentShownSuggestionIndex[t.payload]=0},fetchRecommendationsSucceeded:(e,t)=>{const{requestId:a,recommendation:o}=t.payload;o.forEach((t=>{const o=e.recommendations[a],i=o.findIndex((e=>e.id===t.id)),u=t.calculatedFormulas.length,m=t.id;function h(e,t){c.E.getInstance().updateTelemetryChatEventData({[s.h3.ChatEventType]:e,[s.h3.ChatEventParameters]:JSON.stringify({time:performance.now(),requestId:a,suggestionId:m,calculatedFormulaLength:u,formulaIndex:t})},d.M.getInstance())}function p(e,t,a){return a[e]&&a[e]!==t[e]}if(-1===i)o.push(t),h(s.a5.CalculatedFormulaGetFormula);else{let c=!1,d=!1;if(t.calculatedFormulas.forEach((e=>{const t=o[i];if(t.preview&&(d=!0),t.calculatedFormulas){const a=t.calculatedFormulas.findIndex((t=>t.id===e.id));-1!==a&&((void 0===t.calculatedFormulas[a].description&&void 0!==e.description||void 0===t.calculatedFormulas[a].formulaExplanation&&void 0!==e.formulaExplanation)&&(p("description",t.calculatedFormulas[a],e)&&h(s.a5.CalculatedFormulaGetDescription,a),p("formulaExplanation",t.calculatedFormulas[a],e)&&h(s.a5.CalculatedFormulaGetExplanation,a),t.calculatedFormulas[a]=e),c=Boolean(e.description))}})),e.currentShownSuggestionIndex[a]>=i&&(c||d||(0,r.be)(t))){const{message:e,telemetry:t}=g.n.getFormulaSuggestionResponse(a,i,(0,l.ss)(o));setTimeout((()=>{n.$.getInstance().displayResponse(e,t,{replaceExistingMessage:!0})}))}}})),e.fetchRecommendationsState[a]="succeeded"},fetchRecommendationsFailed:(e,t)=>{e.fetchRecommendationsState[t.payload]="failed"},startPreviewing:(e,t)=>{e.previewId=t.payload},stopPreviewing:e=>{e.previewId=null},updateTableName:(e,t)=>{e.tableName[t.payload.requestId]=t.payload.table},updateFormulaRecommendationPreview:(e,t)=>{const{requestId:a,suggestionId:o,preview:i,visibleRowsPreviewValues:s,tableValues:c,rowCount:d,visibleRows:p}=t.payload,b=e.recommendations[a],f=b.find((e=>e.id===o));if(f){if("Failed"===i||"previewDisabled"===i)f.preview=i;else{const{previewValues:e,rowNumber:t,letters:a}=i;(0,r.iM)(f)?f.preview=(0,u.BG)(t,a,f.calculatedFormulas.map((e=>e.columnName)),e,s,p):(0,r.cY)(f)&&(f.preview=(0,u.LS)(t,a,e,c,d))}(0,m.cY)("updateFormulaRecommendationPreview",f.preview,f.calculatedFormulas.map((e=>e.description)));const t=b.findIndex((e=>e===f)),o=e.currentShownSuggestionIndex[a]===t;if((0,h.pRQ)()&&o){const{message:e,telemetry:o}=g.n.getFormulaSuggestionResponse(a,t,(0,l.ss)(b));setTimeout((()=>{(0,m.cY)("updateFormulaRecommendationPreview","displayResponse",e),n.$.getInstance().displayResponse(e,o,{replaceExistingMessage:!0})}))}}},markRecommendationInserted:(e,t)=>{const{suggestionId:a,requestId:n}=t.payload,o=e.recommendations[n].findIndex((e=>e.id===a));-1!==o&&(e.recommendations[n][o].isInserted=!0)},markRecommendationAsInvalidated:(e,t)=>{const{suggestionId:a,reason:n}=t.payload;e.invalidatedSuggestions.push(a),c.E.getInstance().updateTelemetryChatEventData({[s.h3.ChatEventType]:s.a5.FormulaSuggestionInvalidated,[s.h3.ChatEventParameters]:JSON.stringify({reason:n,suggestionId:a})},d.M.getInstance())},reset:()=>p,markVisible:(e,t)=>{e.isVisible[t.payload]=!0},setCurrentShownSuggestionIndex:(e,t)=>{e.currentShownSuggestionIndex[t.payload.requestId]=t.payload.suggestionIndex},setHasShownSuggestionPrompt:(e,t)=>{e.hasShownSuggestionPrompt[t.payload]=!0},setPreviewForSuggestionID:(e,t)=>{const{preview:a,suggestionId:n,visibleRowsPreview:o}=t.payload;e.rawPreview[n]=a,e.visibleRowPreviewValues[n]=o},setCurrentRowValuesForRequestId:(e,t)=>{const{requestId:a,currentTotalRowValues:n}=t.payload;e.currentTotalRowValues[a]=n},setShouldShowFormulaDevButton:(e,t)=>{const{shouldShowFormulaDevButton:a}=t.payload;e.shouldShowFormulaDevButton=a,o.s.getInstance().setShouldShowFormulaDevButton(a)}}}),{actions:f,reducer:C}=b},14086:(e,t,a)=>{"use strict";a.d(t,{r:()=>o,w:()=>r});var n=a(449650);function o(e){return-1===e.lastIndexOf("!")?e:n.ExcelCalc.stripSheetFromRange(e)}function r(e){return-1===e.lastIndexOf("!")?"":n.ExcelCalc.sheetNameFromSheetAddresses(e)}},23153:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(171755),o=a.n(n),r=a(982649),i=a.n(r)()(o());i.push([e.id,".fai-CopilotMessage__content{width:100%}","",{version:3,sources:["webpack://./src/frontend/styles/components/_adaptive-cards.scss"],names:[],mappings:"AAEA,6BACE,UAAA",sourcesContent:["// This is a workaround to fix an infinite resizing bug in swiper + adaptivecards\n// It ensures the parent container of the adaptive card has a fixed width\n.fai-CopilotMessage__content {\n  width: 100%;\n}\n"],sourceRoot:""}]);const l=i},31118:(e,t,a)=>{"use strict";a.d(t,{y:()=>u});var n=a(932367),o=a(754440),r=a(956258);var i=a(75440);var l=a(528804);var s=a(875136);var c=a(651537),d=a(413563);function u(e,t){const a=e.category,u=(0,d.D)(e),m=u.errorCode,h=u.errorReason;switch(a){case c.E.ClientProgramResponseError:!function(e,t){let a=o.W.Unclassified_Chat_Failure,i=n.c.Client_Program_Response_Error;e&&"timeout"===e&&(a=o.W.Response_Delayed_Or_Timed_Out,i=n.c.Service_Timeout);r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(m,t);break;case c.E.DisengagedError:(0,i.I)(m,t);break;case c.E.ExcelTabularSkillFailedError:break;case c.E.InferenceAPIError:!function(e,t){let a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.InferenceAPI;if(e)switch(e){case"user-throttled":a=o.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,i=n.c.User_Throttled;break;case"scenario-throttled":a=o.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,i=n.c.Scenario_Throttled;break;case"throttled":a=o.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,i=n.c.Throttled;break;case"not-available":i=n.c.InferenceAPI_Not_Available;break;case"timeout":a=o.W.Response_Delayed_Or_Timed_Out,i=n.c.InferenceAPI_Timeout}r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(m,t);break;case c.E.InputQueryError:!function(e,t){let a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Augloop_Failed_Input_Error;if(e)switch(e){case"unsupported-multi-agent":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Multiple_Intents_Detected;break;case"bad-token":a=o.W.User_Access_Issue_For_Copilot,i=n.c.Augloop_Failed_Token_Validation;break;case"too-short":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Too_Short;break;case"too-long":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Too_Long;break;case"invalid":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Query_Error_Invalid;break;case"out-of-scope":a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Query_Error_Out_Of_Scope}r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(m,t);break;case c.E.LicensingError:!function(e,t,a){const i=o.W.User_Access_Issue_For_Copilot;let s=n.c.Augloop_Failed_Entitlement_Validation;(0,l.yw9)("OfficeVSO_9748131_ASHAErrorLoggingForAugLoopLicensingErrors")&&e&&("missing-service-plan"===e?t&&(s="MissingServicePlanBYOA"===t?n.c.Augloop_Failed_License_Check_Due_To_Missing_Service_Plan_BYOA:n.c.Augloop_Failed_License_Check_Due_To_Uncategorized_Error_Reason):s=n.c.Augloop_Failed_License_Check_Due_To_Uncategorized_Error_Code);r.M.getInstance().logStandardizedAshaErrorEvent(i,s,a)}(m,h,t);break;case c.E.ODSLParseError:!function(e,t){let a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Failed_Parse_ODSL;if(e)switch(e){case"zero-parsed":i=n.c.Failed_Parse_ODSL_Zero;break;case"date-logic":a=o.W.Missing_Copilot_Functionality,i=n.c.Failed_Parse_ODSL_Date_Logic;break;case"no-op":i=n.c.Failed_Parse_ODSL_No_Op}r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(m,t);break;case c.E.ODSLSyntaxError:!function(e,t){const a=o.W.Unable_To_Complete_Task,i=n.c.Invalid_ODSL_Generated;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;case c.E.OffensiveContent:!function(e,t){let a=n.c.Input_Was_Offensive_So_No_Response;const i=o.W.Responsible_AI_Filter_Blocked_Response;if(e)switch(e){case"input-query:guardlist":a=n.c.Input_Blocked_Guardlist;break;case"input-query:content-safety-jailbreak-classifier":a=n.c.Input_Blocked_Prompt_Injection;break;case"generated-output:open-ai-moderation":a=n.c.Suggestion_Blocked_Due_To_Code_Generated_Being_Protected_By_Copyright_Licensing;break;default:e.indexOf("input-query")>-1?a=n.c.Input_Query_Error:e.indexOf("generated-output")>-1&&(a=n.c.Generated_Output_Error)}r.M.getInstance().logStandardizedAshaErrorEvent(i,a,t)}(m,t);break;case c.E.SkillFailedError:!function(e,t){const a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Failed_Due_To_Skill_Failure;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;case c.E.PythonSkillFailedError:!function(e,t){const a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Python_Skill_Failed;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t),(0,s.hb)(),(0,s.P_)(!0)}(0,t);break;case c.E.SydneyCancelledError:!function(e,t){const a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Sydney_Cancelled_Error;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;case c.E.IgnorableError:case c.E.SydneyError:!function(e,t){const a=o.W.LLM_Service_Side_Issue_Prevents_Output;let i=n.c.Orchestration_Failed_Sydney;if(e)switch(e){case"unknown":i=n.c.Sydney_Unknown_Error;break;case"bad-conversation-id":i=n.c.Sydney_Bad_Converstaion_Id;break;case"error-response":i=n.c.Sydney_Error;break;case"server-timeout":i=n.c.Sydney_Timeout;break;case"websocket-failed-to-connect":i=n.c.Sydney_Websocket_Failed;break;case"out-of-credits":i=n.c.Out_Of_Credits}r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(m,t);break;case c.E.TokenCountError:!function(e,t){const a=o.W.User_Input_Could_Not_Be_Processed,i=n.c.Input_Exceeded_Max_Length;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;case c.E.UnsupportedLanguageError:!function(e,t){const a=o.W.Missing_Copilot_Functionality,i=n.c.Input_Language_Unsupported;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}(0,t);break;default:r.M.getInstance().logStandardizedAshaErrorEvent(o.W.Unclassified_ASHA_Error,n.c.Augloop_Error,t)}}},36604:(e,t,a)=>{"use strict";a.d(t,{Ak:()=>y,Am:()=>r,BO:()=>b,C3:()=>o,Jh:()=>f,Lb:()=>v,NW:()=>T,Q4:()=>h,Ru:()=>p,W7:()=>c,YL:()=>m,dQ:()=>g,dc:()=>x,iA:()=>u,l$:()=>d,lI:()=>C,mT:()=>s,nZ:()=>S,wM:()=>i,zI:()=>l});var n=a(893763);function o(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="string"!==o.type;if(r||void 0===o.string)throw new n.Dd(r?`Argument ${t} type ${o.type} should be string on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"string");return o.string}function r(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="string"!==o.type;if(r||void 0===o.string)throw new n.Dd(r?`Argument ${t} type ${o.type} should be enum on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"enum");return o.string}function i(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="color"!==o.type;if(r||void 0===o.string)throw new n.Dd(r?`Argument ${t} type ${o.type} should be color on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"color");return o.string}function l(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="boolean"!==o.type;if(r||void 0===o.boolean)throw new n.Dd(r?`Argument ${t} type ${o.type} should be boolean on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"boolean");return o.boolean}function s(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="number"!==o.type;if(r||void 0===o.number)throw new n.Dd(r?`Argument ${t} type ${o.type} should be number on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"number");return o.number}function c(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="stringList"!==o.type;if(r||void 0===o.stringList)throw new n.Dd(r?`Argument ${t} type ${o.type} should be stringList on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"stringList");return o.stringList}function d(e){const t=T(e,"scope");if(!t)throw new n.Dd(`Argument scope not found on ${e.name}`,n.vb.ArgumentUndefined);return t}function u(e){try{return function(e){const t=e.arguments.scope;if(!t)throw new n.Dd(`Argument scope not found on ${e.name}`,n.vb.ArgumentUndefined);if("scope"!==t.type||"Selection"!==t.name)throw new n.Dd(`Argument scope not Selection type on ${e.name}`,n.vb.ArgumentTypeMismatch);return t}(e)}catch{return}}function m(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="var"!==o.type;if(r||void 0===o.name)throw new n.Dd(r?`Argument ${t} type ${o.type} should be var on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"var");return o.name}function h(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a;if(!o.type)throw new n.Dd(`Argument ${t} type is undefined on ${e.name}`,n.vb.ArgumentTypeUndefined);return o.type}function g(e,t){try{return h(e,t)}catch{return}}function p(e,t){try{return o(e,t)}catch{return}}function b(e,t){try{return r(e,t)}catch{return}}function f(e,t){try{return i(e,t)}catch{return}}function C(e,t){try{return s(e,t)}catch{return}}function y(e,t){try{return l(e,t)}catch{return}}function v(e,t){try{return c(e,t)}catch{return[]}}function x(e,t){try{return function(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="numberList"!==o.type;if(r||void 0===o.numberList)throw new n.Dd(r?`Argument ${t} type ${o.type} should be numberList on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"numberList");return o.numberList}(e,t)}catch{return[]}}function T(e,t){try{return function(e,t){const a=e.arguments[t];if(void 0===a)throw new n.Dd(`Argument ${t} not found on ${e.name}`,n.vb.ArgumentUndefined);const o=a,r="var"!==o.type;if(r||void 0===o.name)throw new n.Dd(r?`Argument ${t} type ${o.type} should be var on ${e.name}`:`Argument ${t} has no value on ${e.name}`,r?n.vb.ArgumentTypeMismatch:n.vb.ArgumentValueUndefined,o.type,"var");return o}(e,t)}catch{return}}function S(e){const t=e.returns;if(void 0===t)throw new n.tF(`Return variable not found on ${e.name}`,"getReturnVariable");return t}},39609:(e,t,a)=>{"use strict";a.d(t,{Z:()=>v});var n=a(293118),o=a(700853),r=a(830714),i=a(365319),l=a(88994),s=a(74704),c=a(644737),d=a(9847),u=a(689534),m=a(235373),h=a(874066),g=a(79458),p=a(528804),b=a(495501),f=a(4091),C=a(874873),y=a.n(C);class v{cleanupStreamHandler(){this.accessPath="",this.uniqueId="",this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1}resetStartQueryState(e){}isWaitingForStreamEnd(){return this.isStreaming}endUserPerceivedLatency(e,t,a){}getBasinObject(){return this.basin}setShowUndoButton(e){this.showUndoButton=e}setDisableUndoButton(e){this.disableUndoButton=e}getConversationId(){return this.conversationId}static getInstance(){return v._instance||(v._instance=l.s.getInstance()),v._instance}constructor(){this.basin=new n.Basin,this.accessPath="",this.uniqueId="",this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1,this.conversationId=void 0,this.getAdaptiveCardAccessPath=(e,t)=>e?e.slice(0,e.indexOf("]")+1):"adaptiveCards["+t+"]",this.isValidMessageForRendering=e=>{if(e.text)try{if(JSON.parse(e.text).publishPreference===u.f.Never)return!1}catch(e){}return!("bot"!==e.author||!e.adaptiveCards&&!e.text||void 0!==e.messageType&&"Chat"!==e.messageType||!e.messageId)},this.promiseFromStatus=(e,t,a)=>e===r.lC.Success?this.handleStreamEnd(t,a):this.isStreaming||""===this.uniqueId?Promise.resolve():this.handleStreamBegin(t),this.handleStreamBegin=e=>(this.isStreaming=!0,s.Q.getInstance().recordFluxCopilotStep({operation:d.OP.FluxFirstStreamedToken}),e(m.m.hideLoadingUI())),this.handleStreamEnd=async(e,t)=>{this.conversationId=t,await e(h.m.resetDoesFluxTurnRequireUndo()),this.cleanupStreamHandler(),s.Q.getInstance().stopRecordingFluxWorkflow(!0),await e((0,f.L4)(!0)),i.$.getInstance().handleEndOfQuery(void 0)},this.handleMessages=e=>{e.messages?.forEach((e=>{if(this.isValidMessageForRendering(e)){const t=e.text,a=[];if(this.showUndoButton&&(0,p.BAK)()&&a.push((0,c.FW)(d.q.CopilotChat)),(0,g.cY)("ExcelAppStreamHandler - handleMessages",t),i.$.getInstance().getHasMessageBeenShown(e.messageId))(0,p.yw9)("OfficeVSO_8923945_UpdateLastMessage")?i.$.getInstance().updateMessage({chatCardType:o._.Default,chatMessageBodyData:{actionButtonList:a,messageId:e.messageId},addCardToChatHistory:!1}):i.$.getInstance().updateLastMessage({chatCardType:o._.Default,chatMessageBodyData:{actionButtonList:a},addCardToChatHistory:!1});else{if((0,g.cY)("ExcelAppStreamHandler - handleMessages - displaying for the first time",t),!this.basin.items[e.messageId]){this.uniqueId=e.messageId;const a=this.getAdaptiveCardAccessPath(this.accessPath,0);this.accessPath||(this.accessPath=a),this.basin.items[this.uniqueId]={adaptiveCards:[{body:[{text:t,type:"TextBlock",wrap:!0}]}]}}if(!y()(this.basin.items[this.uniqueId],this.accessPath,null))return void(0,g.cY)("ExcelAppStreamHandler - handleMessages - no card data to show",t);const{message:n,telemetry:o}=b.n.getStreamingResponse({basin:this.basin,uniqueId:this.uniqueId,accessPath:this.accessPath,actionButtonList:a});i.$.getInstance().addMessageIfNeeded(this.uniqueId,n,o)}this.disableUndoButton&&(0,c.s_)(c.H0.DisableUndo)}}))},this.handleMessagesToDelete=e=>{e.messagesToDelete?.forEach((e=>{delete this.basin.items[e]}))},this.handleBasinCursor=e=>{const t=e.basinCursor;if(!(0,g.hX)(t)){const e=JSON.parse(t),a=e?.j||e?.jsonPath;this.uniqueId=a.slice(a.indexOf("[")+2,a.indexOf("]")-1),this.accessPath=this.getAdaptiveCardAccessPath(a.slice(a.indexOf("]")+2),0),this.basin.setCursor(e)}},this.handleMessagesToAddOrReplace=e=>{e.messagesToAddOrReplace?.forEach((e=>{if(this.isValidMessageForRendering(e)){if(!this.basin.items[e.messageId]){this.uniqueId=e.messageId;const t=this.getAdaptiveCardAccessPath(this.accessPath,0);this.accessPath||(this.accessPath=t),this.basin.items[this.uniqueId]={adaptiveCards:[{body:[{text:e.text,type:"TextBlock",wrap:!0}]}]}}if(!y()(this.basin.items[this.uniqueId],this.accessPath,null))return void(0,g.cY)("ExcelAppStreamHandler - handleMessagesToAddOrReplace - no card data to show");(0,g.cY)("ExcelAppStreamHandler - handleMessagesToAddOrReplace",e.text);const{message:t,telemetry:a}=b.n.getStreamingResponse({basin:this.basin,uniqueId:this.uniqueId,accessPath:this.accessPath});i.$.getInstance().addMessageIfNeeded(this.uniqueId,t,a)}}))},this.handleMessagesToUpdate=e=>{e.messagesToUpdate?.forEach((e=>{this.uniqueId=e.messageId;const t=e.acLoc;t?this.basin.items[this.uniqueId].adaptiveCards[t.cIdx].body[t.bIdx].text+=e.appendText:this.basin.items[this.uniqueId].text+=e.appendText;if(!y()(this.basin.items[this.uniqueId],this.accessPath,null))return void(0,g.cY)("ExcelAppStreamHandler - handleMessagesToUpdate - no card data to show");(0,g.cY)("ExcelAppStreamHandler - handleMessagesToUpdate",e.appendText);const{message:a,telemetry:n}=b.n.getStreamingResponse({basin:this.basin,uniqueId:this.uniqueId,accessPath:this.accessPath});i.$.getInstance().addMessageIfNeeded(this.uniqueId,a,n)}))},this.handleBasinWrite=e=>{const t=e.basinWrite;(0,g.hX)(t)||this.basin.write(JSON.parse(t))},this.handleChatResponse=async(e,t,a)=>(this.handleMessages(e),this.handleBasinCursor(e),this.handleMessagesToDelete(e),this.handleMessagesToAddOrReplace(e),this.handleMessagesToUpdate(e),this.handleBasinWrite(e),this.promiseFromStatus(e.status,t,a))}}},40395:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(171755),o=a.n(n),r=a(982649),i=a.n(r)()(o());i.push([e.id,'@media (forced-colors: active) {\n  svg > path.OfficeIconColors_HighContrast:not([class*="OfficeIconColors_m"]) {\n    forced-color-adjust: auto;\n    fill: currentColor;\n  }\n}\n\n@media (forced-colors: active) {\n  svg > path[class*="OfficeIconColors_m"]:not(.OfficeIconColors_HighContrast) {\n    forced-color-adjust: auto;\n    fill: none;\n  }\n}\n\n@media (forced-colors: active) {\n  div.conditional-formatting-response-card-sample-text {\n    display: none;\n  }\n}\n\n/* ConditionalFormatResponseCardSample.tsx */\n.conditional-formatting-response-card-icon {\n  height: 20px;\n  width: 20px;\n  margin-left: 1px;\n  margin-right: 10px;\n}\n\ndiv.conditional-formatting-response-card-icon-renderer {\n  display: flex;\n  border: none;\n  flex-basis: 100%;\n  direction: ltr;\n  height: 20px;\n  width: 110px;\n}\n\n/* commandingChatCard.tsx */\ndiv.conditional-formatting-response-card-swatch {\n  margin: auto;\n  width: 50%;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n\ndiv.conditional-formatting-response-card-formula {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n  margin-inline-start: -2rem;\n  width: auto;\n}\n',"",{version:3,sources:["webpack://./src/frontend/components/ConditionalFormatResponseCardSample/Styles/ConditionalFormatIcons.css"],names:[],mappings:"AAAA;EACE;IACE,yBAAyB;IACzB,kBAAkB;EACpB;AACF;;AAEA;EACE;IACE,yBAAyB;IACzB,UAAU;EACZ;AACF;;AAEA;EACE;IACE,aAAa;EACf;AACF;;AAEA,4CAA4C;AAC5C;EACE,YAAY;EACZ,WAAW;EACX,gBAAgB;EAChB,kBAAkB;AACpB;;AAEA;EACE,aAAa;EACb,YAAY;EACZ,gBAAgB;EAChB,cAAc;EACd,YAAY;EACZ,YAAY;AACd;;AAEA,2BAA2B;AAC3B;EACE,YAAY;EACZ,UAAU;EACV,mBAAmB;EACnB,sBAAsB;AACxB;;AAEA;EACE,iBAAiB;EACjB,oBAAoB;EACpB,0BAA0B;EAC1B,WAAW;AACb",sourcesContent:['@media (forced-colors: active) {\n  svg > path.OfficeIconColors_HighContrast:not([class*="OfficeIconColors_m"]) {\n    forced-color-adjust: auto;\n    fill: currentColor;\n  }\n}\n\n@media (forced-colors: active) {\n  svg > path[class*="OfficeIconColors_m"]:not(.OfficeIconColors_HighContrast) {\n    forced-color-adjust: auto;\n    fill: none;\n  }\n}\n\n@media (forced-colors: active) {\n  div.conditional-formatting-response-card-sample-text {\n    display: none;\n  }\n}\n\n/* ConditionalFormatResponseCardSample.tsx */\n.conditional-formatting-response-card-icon {\n  height: 20px;\n  width: 20px;\n  margin-left: 1px;\n  margin-right: 10px;\n}\n\ndiv.conditional-formatting-response-card-icon-renderer {\n  display: flex;\n  border: none;\n  flex-basis: 100%;\n  direction: ltr;\n  height: 20px;\n  width: 110px;\n}\n\n/* commandingChatCard.tsx */\ndiv.conditional-formatting-response-card-swatch {\n  margin: auto;\n  width: 50%;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n\ndiv.conditional-formatting-response-card-formula {\n  padding-top: 1rem;\n  padding-bottom: 1rem;\n  margin-inline-start: -2rem;\n  width: auto;\n}\n'],sourceRoot:""}]);const l=i},46445:(e,t,a)=>{"use strict";a.d(t,{m:()=>f,n:()=>y});var n=a(700853),o=a(63919),r=a(322466),i=a(267324),l=a(9847),s=a(476730),c=a(956258),d=a(644737);function u(e){if(e.fileUrl){const t=e.fileUrl.lastIndexOf("/");if(-1!==t)return e.fileUrl.slice(0,t)}}var m=a(949404),h=a(119202);const g=l.q.OfficeScripts,p="Copilot\\Office Scripts";var b,f;!function(e){e.SaveScriptHiTLCard="SaveScriptHiTLCard",e.CompletedSaveScriptCard="CompletedSaveScriptCard",e.SaveErrorCard="SaveErrorCard",e.DeleteScriptErrorCard="DeleteScriptErrorCard",e.DeleteScriptConfirmationCard="DeleteScriptCompletedCard",e.ScheduleScriptHiTLCard="ScheduleScriptHiTLCard",e.ScheduleScriptConfirmationCard="ScheduleScriptConfirmationCard",e.ScheduleErrorCard="ScheduleErrorCard"}(b||(b={})),function(e){e.SaveScript="SaveScript",e.ScheduleScript="ScheduleScript",e.RunScript="RunScript"}(f||(f={}));const C={SaveScript:"SaveErrorCard",ScheduleScript:"ScheduleErrorCard",RunScript:"RunErrorCard"};const y={getOfficeSaveScriptHiTL:function(e,t,a,s,c){const u=e.map((e=>({text:e}))),m=t.name;return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,embeddedLists:s?[]:[{listItems:u}],messageHeader:{text:s?(0,i.ak4)().replace("{0}",m):(0,i.gnM)().replace("{0}",m)}}},chatMessageBodyData:{actionButtonList:[(0,d.JE)(t,a,c)],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"SaveScriptHiTLCard"}),feedbackClientAppName:(0,h.f2)()}}}},telemetry:{featureName:g,eventType:l.a5.ActionConfirmationMessage}}},getSavedScriptCompletedResponse:function(e,t=!1){const a=e.name;return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.Y55)()},messageFooter:{text:(0,i.IH5)().replace("{0}",a)}}},chatMessageBodyData:{actionButtonList:t?[(0,d.zL)(e),(0,d.vu)(g,e)]:[(0,d.zL)(e)],feedbackSectionPosition:r.O.Footer,shouldShowAIGeneratedIndicator:!1,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"CompletedSaveScriptCard"}),feedbackClientAppName:(0,h.f2)()}}}},telemetry:{featureName:g,eventType:l.a5.ActionConfirmationMessage}}},getOfficeScriptErrorResponse:function(e,t,a){return(0,m.v)(e,{featureName:g,errorType:a??l.q0.ClientError},{},{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:C[t]}),feedbackClientAppName:(0,h.f2)()}}})},getOfficeScriptSimpleResponse:function(e,t,a=!1){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:a?o.Q9.Human:o.Q9.Chat,messageHeader:{text:e}}}},telemetry:{featureName:g,eventType:t}}},getOfficeScriptDeleteScriptErrorResponse:function(e){const t=u(e),a=(0,i.Hdt)().replace("{0}",e.name).split("{1}"),d={chatCardType:n._.Default,chatMessageBodyData:{feedbackSectionPosition:r.O.Footer,shouldShowAIGeneratedIndicator:!1,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"DeleteScriptErrorCard"}),feedbackClientAppName:(0,h.f2)()}}}},m={featureName:g,eventType:l.a5.ErrorMessage};if(t){return{message:{...d,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:a[0],linkText:{text:(0,i.Nfx)(),linkOnClick:()=>{const e=c.M.getInstance();s.E.getInstance().updateTelemetryChatEventData({[l.h3.ChatEventType]:l.a5.OfficeScriptsLinkClicked,[l.h3.ChatEventParameters]:JSON.stringify({featureName:l.q.OfficeScripts})},e)},linkUrl:u(e),linkSuffix:a[1]}}}}},telemetry:m}}return{message:{...d,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:a[0].concat((0,i.Nfx)(),a[1])}}}},telemetry:m}},getOfficeScriptDeleteScriptSuccessResponse:function(e){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.y9Z)().replace("{0}",e)}}},chatMessageBodyData:{feedbackSectionPosition:r.O.Footer,shouldShowAIGeneratedIndicator:!1,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"DeleteScriptCompletedCard"}),feedbackClientAppName:(0,h.f2)()}}}},telemetry:{featureName:g,eventType:l.a5.ActionConfirmationMessage}}},getOfficeScriptsScheduleScriptFluxResponse:function(){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.r8x)()}}},chatMessageBodyData:{feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"ScheduleScriptConfirmationCard"}),feedbackClientAppName:(0,h.f2)()}}}},telemetry:{featureName:g,eventType:l.a5.ActionConfirmationMessage}}},getOfficeScriptsScheduleScriptHiTLResponse:async function(e,t,a,s,c){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:(0,i.T5i)().replace("{0}",e.name)},embeddedLists:[{listItems:[{text:t}]}]}},chatMessageBodyData:{actionButtonList:[await(0,d.NQ)(e,a,s,c)],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:p,contextData:{cardMetaData:JSON.stringify({cardType:"ScheduleScriptHiTLCard"}),feedbackClientAppName:(0,h.f2)()}}}},telemetry:{featureName:g,eventType:l.a5.ActionConfirmationMessage}}}}},46566:(e,t,a)=>{"use strict";a.d(t,{O:()=>n});const n=(0,a(507628).A)()},47262:(e,t,a)=>{"use strict";function n(e){return e}function o(e,t){throw new Error(t)}a.d(t,{c:()=>o,x:()=>n})},48093:(e,t,a)=>{"use strict";a.d(t,{LA:()=>r,gc:()=>l,j0:()=>m,j3:()=>c,jc:()=>u,pX:()=>o,u$:()=>s});let n=!1;function o(){return n}function r(e){n=e}let i=!1;function l(){return i}function s(e){i=e}function c(e){e&&(i=e.webGroundingEnabled,n=e.enterpriseGroundingEnabled)}let d={onRefreshButtonClicked:()=>{},suggestionList:[],showRefreshButton:!1};function u(){return d}function m(e){d=e}},49236:(e,t,a)=>{"use strict";a.d(t,{IM:()=>d,np:()=>c,Av:()=>u});var n=a(83437),o=a(965634),r=a(956258),i=a(79458),l=a(202051);function s(e){return null==e||("string"==typeof e||"number"==typeof e||"boolean"==typeof e||(Array.isArray(e)?e.every(s):"object"==typeof e&&null!==e&&(Object.keys(e).every((e=>"string"==typeof e))&&Object.values(e).every(s))))}function c(e,t,a,o){switch(e){case"CodeAndPostView":case"PythonStartAnalysis_V1":case"PythonStartAnalysisButtonExperiment_V1":case"PythonAdaRecommendation_V1":case"PythonCalculatedColumn_V1":(0,l.$n)(a,!1,o);break;case"ModelessOutput":case"PythonMergedCard_V1":(0,l.$n)(a,!0,o);break;default:r.M.getInstance().logError({eventType:t,errorMessage:a,logLevel:n.$b.ASHA})}}function d(e,t){if((0,i.cY)(`customSerializableRenderer(${e})`,t),!s(t)){const a=`Props for ${e} are not serializable, therefore we cannot save them in the chat history and rehydrate the chat.`;c(e,o.S2.Error,a,t),(0,i.cY)(a)}return{component:e,props:t}}function u(e,t,a,n){if(!s(a)||!s(t)){c(e,n,`Props used to update ${e} are not serializable, therefore we cannot save them in the chat history and rehydrate the chat.`,t)}return{component:e,props:{...t,...a}}}},53113:(e,t,a)=>{"use strict";a.d(t,{CT:()=>D,E_:()=>O,OC:()=>N,Qo:()=>F,UN:()=>H,VI:()=>U,tb:()=>M,w2:()=>_,yT:()=>P});var n=a(932367),o=a(754440),r=a(549768),i=a(632512),l=a(523999),s=a(875042),c=a(626128),d=a(965634),u=a(9847),m=a(267324),h=a(83437),g=a(476730),p=a(956258),b=a(173339),f=a(47262),C=a(235373),y=a(797639),v=a(10021),x=a(79458),T=a(528804),S=a(906606),w=a(295767),E=a(389298);const I={logError(e,t,a=h.$b.Error){p.M.getInstance().logErrorCode(i.O.FormulaGenerationSkillError,(0,u.Jr)(t),d.S2.FormulaGeneration,a,{key:u.tj.UserQueryGuid,value:e??"undefined"})},logWarning(e,t){this.logError(e,t,h.$b.Warning)},logSkillData(e,t={}){g.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.FormulaSuggestionSkillData,[u.h3.ChatEventParameters]:JSON.stringify({event:e,...t})},p.M.getInstance())}},R=new Map;function A(e){return R.has(e)||R.set(e,{requestId:e,timeoutId:void 0,startTime:void 0,receivedFormulaAnnotation:!1,receivedSkillMetadata:!1}),R.get(e)}const L={[s.az.CellSuggestion]:u.OP.CalculatedCells,[s.az.NlToFormulaSuggestion]:u.OP.CalculatedCells,[s.az.ColumnSuggestion]:u.OP.CalculatedColumns};function k(){return(0,T.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.EnableFormulaContext",!1)}function F(e){return(0,T.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.EnableS2SFormulaSkill",!1)&&(k()||!e((0,S.MN)()))}async function _(e,t,a){if(k()){if(a)return p.M.getInstance().runTimedAsyncFunction("FormulaSkillContextCreation",(async()=>{try{const n=await e((0,S.CQ)(a.name,t)),o=e((0,S.cQ)(a.name)),r={visibleRows:await(0,c.e1)(o),cells:(0,c.Ys)(o,n),isHybrid:!e((0,S.MN)())};return I.logSkillData("FormulaSkillContext",{cells:r.cells.length,visibleRows:r.visibleRows?.length,contextSize:JSON.stringify(r).length}),r}catch(e){return void I.logError(t,e)}}),t??"");I.logError(t,"Error while getting formula context: activeTable is undefined")}}function P(e,t,a){F(e)&&I.logError(t,`Missing formula context: ${a}`)}function N(e,t,a){F(e)&&I.logError(t,`Unexpected formula ODSL flow: ${a}`)}function M(e){U(e)&&I.logSkillData("SkillAshaEvent",{formulaType:e.formulaType,chatResponseCode:e.chatResponseCode,result:e.suggestionMetadata?.result,shouldFallbackToElse:e.suggestionMetadata?.shouldFallbackToElse})}async function O(e,t,n){if(F(n))if(e)switch(A(e).receivedSkillMetadata=!0,t.chatResponseCode){case l.b.Started:I.logSkillData("SkillStarted",{formulaType:t.formulaType}),await async function(e,t,n,o){if(void 0===n)return void I.logWarning(e,"onSkillStarted: Metadata missing formulaType");if("inProgress"===t((0,w.iT)(e)))return void I.logWarning(e,"onSkillStarted: Already processing a request");A(e).startTime=performance.now(),t(C.m.setLatestRequestId(e));const r=o??y.CP.getActiveTable()?.name;r?((0,T.ZAR)()&&await y.CP.fetchAndSetActiveTableLikeEntity(r),t(v.m.updateTableName({requestId:e,table:r}))):I.logError(e,"onSkillStarted: No active table found");t(v.m.startFetching(e)),t(C.m.startExecutingCommand({id:e,command:L[n]})),A(e).timeoutId=window.setTimeout((()=>B(e,t,"SDX")),b.R.getFormulaAITimeout()),Promise.all([a.e("chunk1jsfluent","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81","high"),a.e("calc","high")]).then(a.bind(a,837051))}(e,n,t.formulaType,(0,T.ZAR)()?t.tableName:void 0);break;case l.b.OK:$(e),I.logSkillData("SkillCompleted"),A(e).receivedFormulaAnnotation||I.logWarning(e,"handleFormulaSuggestionMetadata: Received OK without a formula annotation");break;case l.b.ServiceTimeout:B(e,n,"AL");break;case l.b.Unsuccessful:case l.b.ServiceError:$(e),I.logSkillData("SkillFailed",{chatResponseCode:t.chatResponseCode,result:t.suggestionMetadata?.result}),A(e).receivedFormulaAnnotation||(I.logWarning(e,"handleFormulaSuggestionMetadata: Received unsuccessful without a formula annotation"),(0,w.aP)(e,n,void 0,void 0,!0));break;case l.b.FallbackToElse:$(e),I.logSkillData("SkillFallbackToElse",{formulaType:t.formulaType});break;default:I.logWarning(e,`Unexpected chatResponseCode: ${t.chatResponseCode}`),(0,f.x)(t.chatResponseCode)}else I.logError(e,"Metadata received without a queryId");else I.logWarning(e,"Metadata received when the skill is not enabled/supported")}function D(e,t,a,...r){(0,w.aP)(e,t,m.olU.CalculatedColumnsFailureGeneral,u.q0.AugloopTimeout),p.M.getInstance().logStandardizedAshaErrorEvent(o.W.Response_Delayed_Or_Timed_Out,n.c.Calculate_Suggestion_Timeout,u.BJ.FormulaGeneration),p.M.getInstance().logErrorCode(i.O.ShowSuggestionsTimeout,(0,u.Jr)(a),d.S2.FormulaGeneration,h.$b.Warning,{key:u.tj.Message,value:a},...r)}function B(e,t,a){$(e),(0,x.cY)(`onSkillTimeout: requestId: ${e}, source: ${a}`);const n=t((0,w.iT)(e));switch(I.logSkillData("SkillTimeout",{source:a,currentState:n}),n){case"inProgress":{const a=A(e);D(e,t,"Timeout while waiting for suggestions from AL",{key:u.tj.TimeoutAfter,value:void 0!==a.startTime?(performance.now()-a.startTime/1e3).toFixed(2):"unknown"});break}case"failed":I.logWarning(e,`onSkillTimeout: Timeout on ${a}, but already failed`);break;case"succeeded":case"notStarted":I.logWarning(e,`onSkillTimeout: Timeout on ${a}, unexpected state: ${n}`);break;default:(0,f.x)(n)}}function $(e){const t=A(e);t.timeoutId&&(clearTimeout(t.timeoutId),t.timeoutId=void 0)}async function H(e,t){if(!F(e))return void e((0,w.UN)(t,r.Dv.typeGuard(t)?c.VS.Cell:c.VS.Column));const{requestId:a}=t,n=A(a);n.receivedFormulaAnnotation=!0,n.receivedSkillMetadata||I.logWarning(a,"Received formula annotation without metadata"),e((0,w.P_)(a))?((0,T.cTR)()&&e(E.m.addQueryMetrics({queryId:a,metrics:t.telemetry?.metrics})),e((0,w.y1)(a)),e((0,w.uX)(t)),await e((0,w.GZ)(t,!0))):I.logWarning(a,"Received formula annotation of non-active or failed request")}function U(e){return e?.type===l.VF.FormulaResponseMeta}},54947:e=>{"use strict";e.exports=JSON.parse('{"G":{"O":"to whole table"}}')},56254:(e,t,a)=>{"use strict";function n(e){const t=e.visual.visualType;return"PivotChartVisual"===t||"PivotTableVisual"===t}function o(e){const{row:t,column:a,dataFieldIndex:n,value:o}=e;return void 0!==t&&void 0!==a&&void 0===n&&void 0===o}function r(e){const{row:t,column:a,dataFieldIndex:n,value:o}=e;return void 0===t&&void 0===a&&void 0===n&&void 0!==o}function i(e){const{row:t,column:a,dataFieldIndex:n,value:o}=e;return void 0===t&&void 0===a&&void 0!==n&&void 0===o}function l(e){const{row:t,column:a,dataFieldIndex:n,value:o}=e;return void 0!==t&&void 0!==a&&void 0!==n&&void 0===o}function s(e){return!e.some((e=>e.some((e=>!!e&&(void 0!==e.value||(void 0!==e.row||void 0!==e.column)&&void 0===e.dataFieldIndex)))))}var c;a.d(t,{Bs:()=>l,J:()=>c,MB:()=>r,RY:()=>s,ir:()=>o,tz:()=>n,vL:()=>i}),function(e){e.Self="self",e.EvaluateQuery="evaluate-query",e.AnalyzeTyping="analyze-typing",e.GenerateSuggestedQueries="generate-suggested-queries",e.GenerateResultForNLEvaluation="generate-result-for-nl-evaluation",e.NLEvaluationResult="nl-evaluation-result",e.Interpretations="interpretations"}(c||(c={}))},60398:(e,t,a)=>{"use strict";a.d(t,{H:()=>g});var n=a(932367),o=a(754440),r=a(632512),i=a(267324),l=a(965634),s=a(9847),c=a(750927),d=a(107295);const u=new Set([r.O.PythonTuiNotShownError,r.O.PythonGenericEditModeError,r.O.PythonStartAnalysisEditModeError,r.O.PythonProtectedSheetError,r.O.PythonProtectedSheetObjectInsertionError,r.O.PythonUnsupportedLanguage,r.O.PythonUnsupportedPlatform,r.O.PayloadSizeError,r.O.PythonCalcError,r.O.PythonNoActiveLicense,r.O.PythonAccessError,r.O.PythonDeletedSheetBeforeResponseGeneration,r.O.PythonDeletedSheetDuringResponseGeneration,r.O.PythonImageUnavailableAnalysisSheetDeletedError,r.O.PythonAugLoopCallsPerQueryMaximumHit,r.O.AnswersUnsupportedLanguageError,r.O.AnswersUnsupportedPlatformError]),m=new Set([r.O.PythonTuiNotShownError,r.O.PythonDeletedSheetBeforeResponseGeneration,r.O.PythonDeletedSheetDuringResponseGeneration,r.O.PythonImageUnavailableAnalysisSheetDeletedError,r.O.PythonAnalysisSheetMetadataError,r.O.PythonExitAnalysisError,r.O.PythonStartAnalysisFailed,r.O.PythonExecutionBlockedByAdmin,r.O.PythonAccessError,r.O.PythonCalcError,r.O.PythonStaleRuntimeError,r.O.PythonBusyStateError,r.O.PythonGeneralError,r.O.PrePythonModeError,r.O.GetPythonCellContextTimeoutRecoverable,r.O.GetAllPythonCellsUpToAnalysisSheetTimeout,r.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout,r.O.GetPythonCellContextTimeout,r.O.PythonContextExtractionAborted,r.O.PythonContextUndefinedParameter,r.O.GetPythonContextObjectFailed,r.O.PythonPayloadEmptyError,r.O.GetOfficePyServiceRuntimeUrlFailed,r.O.GetOfficePyServiceAccessTokenFailed,r.O.ConnectOfficePyServiceExecuteCodeTimeout,r.O.ConnectToOfficePySvcToExecutePythonCodeUnexpectedError,r.O.ExecutePythonCodeApiCallTimeout,r.O.PythonInvalidSelectedContext,r.O.PythonUnexpectedMissingSheetInContextExtraction,r.O.PythonObjectReferenceError,r.O.PayloadSizeError,r.O.PythonGeneralContextError,r.O.PythonInsertFailed,r.O.PythonDataFrameInsertFailed,r.O.PythonAutofitFailed,r.O.PythonStartAnalysisEditModeError,r.O.PythonProtectedSheetError,r.O.PythonProtectedSheetObjectInsertionError,r.O.PythonCodeRetryMaximumHit,r.O.PythonAddResultsToNewSheetError,r.O.PythonPostViewError,r.O.PythonCopyFailed,r.O.PythonGetDiagnosticsError,r.O.PythonPrintFormattedNumberError,r.O.PythonCodeAndPostViewPropsNotSerializable,r.O.PythonAugLoopCallsPerQueryMaximumHit,r.O.PythonNoActiveLicense]),h=new Set([r.O.AnswersPostViewError,r.O.AnswersInvalidImageResponse,r.O.AnswersMissingChunkProperty,r.O.AnswersParsingMetadataFailed,r.O.AnswersInsertImageError,r.O.AnswersInsertTableError,r.O.AnswersCollapsableCodeOnClickError,r.O.AnswersComponentPropsNotSerializable,r.O.AnswersInvalidChartImageResponse,r.O.AnswersInteractiveChartRenderingFailed,r.O.AnswersInteractiveChartRefFailed,r.O.AnswersInteractiveChartImageGenerationFailed,r.O.AnswersUnsupportedLanguageError,r.O.AnswersUnsupportedPlatformError]);class g extends Error{toString(){const e={eventType:this.eventType,errorCode:this.errorCode,ashaVeto:this.ashaVeto,ashaError:this.ashaError,isAceImpacting:this.isAceImpacting,telemetryStandardizedFeature:this.telemetryStandardizedFeature,errorDetails:this.errorDetailsNoPII};return JSON.stringify(e)}getErrorDisplayMessage(){let e;switch(this.errorCode){case r.O.PrePythonModeError:e=(0,i.y$1)();break;case r.O.GetPythonCellContextTimeoutRecoverable:case r.O.GetAllPythonCellsUpToAnalysisSheetTimeout:case r.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout:e=(0,i.kvH)();break;case r.O.PythonUnsupportedLanguage:case r.O.AnswersUnsupportedLanguageError:e=(0,i.V9X)();break;case r.O.PythonNoActiveLicense:{const t=`[${(0,i.g1k)()}](${i.jv5})`;e=(0,c.L)((0,i.GLO)(),t);break}case r.O.PythonUnsupportedPlatform:case r.O.AnswersUnsupportedPlatformError:{const t=`[${(0,i.g1k)()}](${i.jv5})`;e=(0,c.L)((0,i.S3X)(),t);break}case r.O.PythonStaleRuntimeError:e=(0,i.$L3)();break;case r.O.PythonBusyStateError:e=(0,i.Sk4)();break;case r.O.PythonGeneralError:case r.O.PythonCalcError:case r.O.PythonAccessError:{const t=`[${(0,i.A1r)()}](${i.O4H})`;e=(0,c.L)((0,i.jYw)(),t);break}case r.O.PythonProtectedSheetError:e=(0,i.FCw)();break;case r.O.PythonProtectedSheetObjectInsertionError:e=(0,i.lgi)();break;case r.O.PythonDeletedSheetBeforeResponseGeneration:e=(0,i.Rpx)();break;case r.O.PythonDeletedSheetDuringResponseGeneration:e=(0,i.Sl)();break;case r.O.PythonCodeRetryMaximumHit:e=(0,i.mq0)();break;case r.O.PythonAugLoopCallsPerQueryMaximumHit:e=(0,i.Gyx)();break;case r.O.PythonStartAnalysisEditModeError:e=(0,i.dvg)();break;case r.O.PythonGenericEditModeError:e=(0,i.xUh)();break;case r.O.PayloadSizeError:e=(0,i.OX0)();break;case r.O.PythonAddResultsToNewSheetError:e=(0,i.J9g)();break;case r.O.PythonMultipleOpenWorkbooks:e=(0,i.UvY)();break;case r.O.PythonExecutionBlockedByAdmin:e=(0,i.ABr)();break;default:e=(0,i.zOC)()}return e}getAshaVetoAndError(){let e,t=o.W.Unable_To_Complete_Task;switch(this.errorCode){case r.O.PythonStaleRuntimeError:e=n.c.Python_Runtime_In_Bad_State;break;case r.O.PythonObjectReferenceError:e=n.c.Python_Bad_Object_Reference;break;case r.O.PythonBusyStateError:e=n.c.Python_Runtime_Busy;break;case r.O.PythonUnknownError:e=n.c.Python_Unknown_Error;break;case r.O.PythonStartAnalysisFailed:e=n.c.Python_Start_Analysis_Failed;break;case r.O.PrePythonModeError:e=n.c.Pre_Python_Mode_Error;break;case r.O.PythonPostViewError:e=n.c.Python_PostView_Failed;break;case r.O.PythonMissingResponseValue:case r.O.PythonInvalidResponseOrder:case r.O.PythonUnsupportedResponseType:case r.O.PythonResponseAllDebugChunks:case r.O.PythonDisplayResponseError:e=n.c.Python_Missing_Or_Invalid_Response;break;case r.O.PythonCopyFailed:e=n.c.Failed_To_Copy_Code;break;case r.O.PythonInsertFailed:case r.O.PythonDataFrameInsertFailed:case r.O.PythonAutofitFailed:e=n.c.Python_Failed_To_Insert_Code;break;case r.O.PythonGeneralError:e=n.c.Python_General_Grid_Error;break;case r.O.PythonCodeRetryMaximumHit:e=n.c.Python_Code_Retry_Maximum_Hit;break;case r.O.PythonAugLoopCallsPerQueryMaximumHit:e=n.c.Python_AugLoop_Calls_Per_Query_Maximum_Hit;break;case r.O.PythonExitAnalysisError:e=n.c.Python_Exit_Analysis;break;case r.O.PythonGeneralContextError:case r.O.GetPythonCellContextTimeout:case r.O.GetPythonCellContextTimeoutRecoverable:case r.O.GetAllPythonCellsUpToAnalysisSheetTimeout:case r.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout:case r.O.PythonContextExtractionAborted:case r.O.PythonContextUndefinedParameter:case r.O.GetPythonContextObjectFailed:case r.O.GetOfficePyServiceRuntimeUrlFailed:case r.O.GetOfficePyServiceAccessTokenFailed:case r.O.ConnectOfficePyServiceExecuteCodeTimeout:case r.O.ConnectToOfficePySvcToExecutePythonCodeUnexpectedError:case r.O.ExecutePythonCodeApiCallTimeout:case r.O.PythonInvalidSelectedContext:case r.O.PythonUnexpectedMissingSheetInContextExtraction:e=n.c.Context_Extraction_Error;break;case r.O.PythonGetDiagnosticsError:e=n.c.Python_Failed_To_Get_Diagnostics;break;case r.O.PythonPrintFormattedNumberError:e=n.c.Python_Failed_To_Print_Formatted_Number;break;case r.O.PythonAddResultsToNewSheetError:e=n.c.Python_Add_Results_To_New_Sheet;break;case r.O.PythonPayloadEmptyError:e=n.c.Python_Payload_Empty;break;case r.O.PythonCodeAndPostViewPropsNotSerializable:e=n.c.Python_Code_And_PostView_Props_Not_Serializable;break;case r.O.AnswersComponentPropsNotSerializable:e=n.c.Answers_Component_Props_Not_Serializable;break;case r.O.PythonMultipleOpenWorkbooks:e=n.c.Python_Multiple_Open_Workbooks;break;case r.O.RichAPIGeneralException:e=n.c.RichAPI_General_Exception;break;case r.O.PythonTuiNotShownError:e=n.c.Python_Teaching_Callout_Not_Shown;break;case r.O.PythonStartAnalysisEditModeError:case r.O.PythonGenericEditModeError:e=n.c.Python_Cell_Edit_Mode;break;case r.O.PythonProtectedSheetError:case r.O.PythonProtectedSheetObjectInsertionError:e=n.c.Python_Failed_Due_To_Protected_Sheet;break;case r.O.AnswersPostViewError:e=n.c.Answers_PostView_Failed;break;case r.O.AnswersInvalidImageResponse:case r.O.AnswersMissingChunkProperty:e=n.c.Answers_Bad_Response;break;case r.O.AnswersParsingMetadataFailed:e=n.c.Answers_Processing_Failed;break;case r.O.AnswersInsertImageError:case r.O.AnswersInsertTableError:e=n.c.Answers_Insert_Failed;break;case r.O.AnswersCollapsableCodeOnClickError:e=n.c.Answers_Collapsable_Code_On_Click_Failed;break;case r.O.AnswersInvalidChartImageResponse:case r.O.AnswersInteractiveChartRenderingFailed:case r.O.AnswersInteractiveChartRefFailed:case r.O.AnswersInteractiveChartImageGenerationFailed:e=n.c.Answers_Interactive_Chart_Failed;break;case r.O.PythonAnalysisSheetMetadataError:e=n.c.Python_Analysis_Sheet_Metadata_Error;break;case r.O.PythonUnsupportedLanguage:case r.O.AnswersUnsupportedLanguageError:t=o.W.Missing_Copilot_Functionality,e=n.c.Input_Language_Unsupported;break;case r.O.PythonUnsupportedPlatform:case r.O.AnswersUnsupportedPlatformError:t=o.W.Missing_Copilot_Functionality,e=n.c.Unsupported_Platform_For_Python_In_Excel;break;case r.O.PayloadSizeError:t=o.W.Missing_Copilot_Functionality,e=n.c.Payload_Too_Large;break;case r.O.PythonCalcError:t=o.W.Missing_Copilot_Functionality,e=n.c.Python_Calc_Error;break;case r.O.PythonNoActiveLicense:t=o.W.User_Access_Issue_For_Copilot,e=n.c.Users_Python_License_Could_Not_Be_Validated;break;case r.O.PythonAccessError:t=o.W.User_Access_Issue_For_Copilot,e=n.c.Python_Access_Error;break;case r.O.PythonExecutionBlockedByAdmin:t=o.W.User_Access_Issue_For_Copilot,e=n.c.Python_Execution_Blocked_By_Admin;break;case r.O.PythonDeletedSheetBeforeResponseGeneration:case r.O.PythonDeletedSheetDuringResponseGeneration:t=o.W.User_Rejected_Or_Cancelled_Response,e=n.c.Python_Analysis_Sheet_Deleted;break;case r.O.PythonImageUnavailableAnalysisSheetDeletedError:t=o.W.UI_Failed_To_Update_Or_Load,e=n.c.Python_Image_Unavailable_Due_To_Analysis_Sheet_Deleted;break;default:e=n.c.Python_Unknown_Error}return{ashaVeto:t,ashaError:e}}getACEImpact(){return!u.has(this.errorCode)}getUpdatedPythonErrorCode(e,t){if(!(e instanceof OfficeExtension.Error))return t;switch(e.code){case Excel.ErrorCodes.inactiveWorkbook:return r.O.PythonMultipleOpenWorkbooks;case Excel.ErrorCodes.responsePayloadSizeLimitExceeded:return r.O.PayloadSizeError;case Excel.ErrorCodes.invalidOperationInCellEditMode:return r.O.PythonGenericEditModeError;case Excel.ErrorCodes.generalException:return r.O.RichAPIGeneralException;default:return t}}getTelemetryStandardizedFeatureForASHA(){return m.has(this.errorCode)?s.BJ.Python:h.has(this.errorCode)||(0,d.i)()?s.BJ.Answers:s.BJ.Python}getContextSyncErrorDebugInfo(e){return`context.sync() failed. errorLocation: ${e.debugInfo?.errorLocation}, statement: ${e.debugInfo?.statement}, innerErrorCode: ${e.debugInfo?.code}`}getDetailedErrorMessageWithInnerErrorDetails(e,t){if(!(t&&t instanceof Error))return e;const a=t;return`${e}\ninnerError: ${a instanceof OfficeExtension.Error?`${a.name}\n${this.getContextSyncErrorDebugInfo(a)}`:a.name}`}constructor({errorCode:e,innerError:t,errorDetailsNoPII:a,errorDetailsOCVOnly:n,customDisplayMessage:o}){super(e),this.eventType=l.S2.PythonError,this.errorCode=this.getUpdatedPythonErrorCode(t,e);const r=this.getAshaVetoAndError();this.ashaVeto=r.ashaVeto,this.ashaError=r.ashaError,this.isAceImpacting=this.getACEImpact(),this.telemetryStandardizedFeature=this.getTelemetryStandardizedFeatureForASHA(),this.errorDisplayMessage=o??this.getErrorDisplayMessage(),this.errorDetailsNoPII=this.getDetailedErrorMessageWithInnerErrorDetails(a,t),this.errorDetailsOCVOnly=n}}},64292:(e,t,a)=>{"use strict";a.d(t,{d:()=>c,x:()=>d});var n=a(267324),o=a(71475),r=a(750927),i=a(507628);let l,s;function c(e){const t=e.workbook.worksheets.load("items");return()=>async e=>{const a=function(e){if(void 0===l)return null;let t,a=l;do{a++,t=(0,r.L)(n.olU.InsertedWorksheetName,a)}while(e.some((e=>e.name===t)));return s(a),t}(t.items),c=t.getActiveWorksheet().load("id");await e.sync();const d=a?t.add(a):t.add(),u=(0,i.A)();e.trace(u);const m=(0,o.U)((()=>d.delete()),u);try{await e.sync()}catch(e){await m(e)}d.load(["id","name"]);const h=(0,i.A)();e.trace(h);const g=(0,o.U)((()=>d.delete()),h);try{await e.sync()}catch(e){await g(e)}const p=c.id;return{result:d,undo:e=>(e.workbook.worksheets.getItem(p).activate(),e.sync())}}}function d(e,t){const a=e.workbook.worksheets.getActiveWorksheet();return a.load("name"),()=>e=>(t.activate(),Promise.resolve({result:t,undo:t=>(e.workbook.worksheets.getItem(a.name).activate(),t.sync())}))}},69284:(e,t,a)=>{"use strict";a.d(t,{D4:()=>g,tN:()=>p,HF:()=>f,M7:()=>m,Hf:()=>h,Pe:()=>b,y3:()=>s,m6:()=>c,mz:()=>d,tT:()=>u});var n=a(267324),o=a(78160),r=a(750927),i=a(880496);var l=a(351779);const s=15,c=30,d=1,u=2;function m(e,t){switch(typeof e){case"string":return e;case"boolean":return t.trim();default:return t}}async function h(e,t,a){const{name:o,nameReferences:s}=t;if(o)return o;if(null==s)throw new Error("V3.PivotTableField is missing nameReferences.");if(s.length>1){return async function(e,t,a){const o=Promise.all((0,l.O)(t,e.getValue.bind(e))),s=Promise.all((0,l.O)(t,e.getText.bind(e))),[c,d]=await Promise.all([o,s]);return function(e,t,a){if(null==e)return null;const o=e.map(((e,a)=>m(e,t[a])));return o.every(i.So)?(0,r.L)((0,n.m1B)(),a):o.map((e=>(0,i.So)(e)?(0,n.Atw)():e)).join(" ")}(c,d,a)}(e,s,"columnMajor"===a.table.orientation?s[s.length-1].column-a.table.tableLocation.left+1:s[s.length-1].row-a.table.tableLocation.top+1)}const{row:c,column:d}=s[0];if(void 0===c&&void 0===d)throw new Error("V3.SourceCellReference is missing both row and column references.");if(void 0===c)return(0,r.L)((0,n.m1B)(),d-a.table.tableLocation.left+1);if(void 0===d)return(0,r.L)((0,n.m1B)(),c-a.table.tableLocation.top+1);const u=e.getValue(c,d),h=e.getText(c,d),[g,p]=await Promise.all([u,h]),b=m(g,p);return(0,i.So)(b)?(0,n.Atw)():b}const g="m/d/yyyy",p={key:g,currency:!1,dateTime:!0,dateTimeHasDayOfWeek:!0,dateTimeHasMonth:!0,dateTimeHasYear:!0,numeric:!1,percent:!1,text:!1};async function b(e,t,a){const r=e.getValue(t,a),i=e.getText(t,a),l=e.getFormatLocal(t,a),s=e.formatSourceDate(t,a),[c,d,u,m]=await Promise.all([r,i,l,s]);if(m&&o.P.getNumberFormatCache().isDateTime(u))return m;{const e=function(e,t,a){return"string"==typeof e?e:"number"!=typeof e||o.P.getNumberFormatCache().isDateTime(a)?t:e.toString()}(c,d,u);return null==c?(0,n.Atw)():e}}function f(e){const t=(e.columnFields||[]).length,a=(e.dataFields||[]).length;return t+(t>0&&a>1?1:0)+1}},69336:(e,t,a)=>{"use strict";e.exports=a.p+"assets/like-icon.svg"},71475:(e,t,a)=>{"use strict";function n(e){const t=async a=>{if(0===e.length)return Promise.resolve();await e.pop()(a),await t(a)};return Excel.run((e=>t(e)))}function o(e,t){return a=>(a instanceof OfficeExtension.Error&&a.traceMessages.includes(t)&&e(),Promise.reject(a))}a.d(t,{U:()=>o,q:()=>n})},74704:(e,t,a)=>{"use strict";a.d(t,{Q:()=>c});var n=a(9847),o=a(83437),r=a(476730),i=a(965634);const l=a(956258).M.getInstance(),s=r.E.getInstance();class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}recordFluxCopilotStep({operation:e,featureName:t}){this.fluxExecutionStartTime?this.logChatLatency(e,this.fluxExecutionStartTime,!0,t):l.logError({eventType:i.S2.Latency,errorMessage:`Flux workflow was not running before starting ${e}`,logLevel:o.$b.Warning})}startRecordingFluxWorkflow(){this.fluxExecutionStartTime&&(l.logError({eventType:i.S2.Latency,errorMessage:`Command ${n.OP.FluxOverall} was not stopped before starting another Flux workflow`,logLevel:o.$b.Warning}),this.logChatLatency(n.OP.FluxOverall,this.fluxExecutionStartTime)),this.fluxExecutionStartTime=(new Date).getTime()}stopRecordingFluxWorkflow(e=!1){this.fluxExecutionStartTime&&this.logChatLatency(n.OP.FluxOverall,this.fluxExecutionStartTime,e),this.fluxExecutionStartTime=void 0}constructor(){this.logChatLatency=(e,t,a,o)=>{s.logLatency((0,n.xJ)(t),e,a,o)}}}},75440:(e,t,a)=>{"use strict";a.d(t,{I:()=>i});var n=a(932367),o=a(754440),r=a(956258);function i(e,t){const a=o.W.LLM_Service_Side_Issue_Prevents_Output,i=n.c.Disengaged_Error;r.M.getInstance().logStandardizedAshaErrorEvent(a,i,t)}},78160:(e,t,a)=>{"use strict";a.d(t,{P:()=>r});var n=a(965634),o=a(956258);class r{static getNumberFormatCache(){return this.numberFormatCache}addFormat(e){this._data[e]||(this._data[e]=r.createInvalidCacheEntry())}static async getFormatMetadata(e){const t=performance.now(),a=await Excel.run((async t=>{const a=Excel.NumberFormattingService.newObject(t),n=e.map((e=>a.getFormatter(e).load("*")));return await t.sync(),n.map((e=>e.toJSON()))}));return o.M.getInstance().logDuration("GetNumberFormatMetadata",performance.now()-t),a}async ensureFormats(){const e=Object.keys(this._data).filter((e=>!this._data[e].isValid));if(0===e.length)return;const t=await r.getFormatMetadata(e);if(e.length!==t.length)throw new Error("getFormatMetadata returned unexpected results.");e.forEach(((e,a)=>{this._data[e]=r.createValidCacheEntryFromFormatterData(t[a])}))}isDateTime(e){if(this._data[e]){if(this._data[e].isValid)return this._data[e].metadata.isDateTime;throw new Error("Format not valid. Ensure formats before accessing metadata.")}throw new Error("Format not added.")}addNumberFormatPropertiesToCache(e){e.forEach((e=>{this._data[e.key]=r.createValidCacheEntryFromFormatProperty(e)}))}get data(){return JSON.parse(JSON.stringify(this._data))}async addFormatPropertiesAsync(e){const t=e.filter((e=>!this._data[e]));t.length>0&&(o.M.getInstance().logEvent({eventType:n.S2.FormatMetadataFallback,eventData:[]}),t.forEach(this.addFormat.bind(this)),await this.ensureFormats())}static createInvalidCacheEntry(){return{isValid:!1,metadata:{hasDayOfWeek:!1,hasMonth:!1,hasYear:!1,isCurrency:!1,isDateTime:!1,isNumeric:!1,isPercent:!1,isText:!1}}}static createValidCacheEntryFromFormatterData(e){return{isValid:!0,metadata:{hasDayOfWeek:e.hasDayOfWeek,hasMonth:e.hasMonth,hasYear:e.hasYear,isCurrency:e.isCurrency,isDateTime:e.isDateTime,isNumeric:e.isNumeric,isPercent:e.isPercent,isText:e.isText}}}static createValidCacheEntryFromFormatProperty(e){return{isValid:!0,metadata:{hasDayOfWeek:e.dateTimeHasDayOfWeek,hasMonth:e.dateTimeHasMonth,hasYear:e.dateTimeHasYear,isCurrency:e.currency,isDateTime:e.dateTime,isNumeric:e.numeric,isPercent:e.percent,isText:e.text}}}constructor(e={}){this._data=JSON.parse(JSON.stringify(e))}}r.numberFormatCache=new r},79458:(e,t,a)=>{"use strict";a.d(t,{K_:()=>h,Pk:()=>d,SA:()=>g,cY:()=>p,g5:()=>b,gZ:()=>f,hX:()=>c,kc:()=>u,qw:()=>m,uk:()=>s});var n=a(551499),o=a(207545),r=a(267022),i=a.n(r),l=a(758651);function s(e){return new Promise(((t,a)=>{setTimeout((()=>{t()}),e)}))}function c(e){return null==e}function d(e){return void 0===e||0===e.length}function u(e){return 0!==e.length&&!e.every((t=>e[0].agent===n.w2.OfficeScripts||e[0].agent===n.w2.OfficeJS||e[0].agent===n.w2.UnsupportedEvent?t.agent===n.w2.OfficeScripts||t.agent===n.w2.OfficeJS||t.agent===n.w2.UnsupportedEvent:t.agent===e[0].agent))}function m(e){return e.every((e=>e.agent===n.w2.OfficeScripts))}const h=()=>(0,o.I_)()||(0,o.B2)();var g;function p(e,...t){if(!h())return;let a="info";e&&Object.values(g).includes(e)?a=e:e&&t.unshift(e);const n="Excel Copilot Chat";switch(a){case"verbose":l.debug(`${n}`,...t);break;case"warning":l.warn(`${n}`,...t);break;case"error":l.error(`${n}`,...t);break;default:l.log(`${n}:`,...t)}}function b(e,t,a){const n=i()(e,t,a);return async(...e)=>{const t=n(...e);return void 0===t?Promise.resolve():t}}function f(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}!function(e){e.Verbose="verbose",e.Info="info",e.Warning="warning",e.Error="error"}(g||(g={}))},81051:(e,t,a)=>{"use strict";a.d(t,{x:()=>h,L:()=>m});var n=a(725556),o=a(255065),r=a(9847),i=a(476730),l=a(956258),s=a(546762),c=a(576583),d=a(215592);const u=(0,c.n)({mainContainer:{display:"flex",flexDirection:"column",...d.shorthands.gap("8px")},hitlDescriptionContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",...d.shorthands.gap("4px"),alignSelf:"stretch"},callToActionTextContainer:{...d.shorthands.margin("4px","0px","8px")},postExpandableListTextContainer:{...d.shorthands.margin("8px","0px")}});function m(e){return{commandingHitlDescription:e,summary:"",expandableListItems:[],isLoading:!0,isNotAvailable:!1}}function h(e){const t=u();return(0,n.jsxs)("div",{className:t.mainContainer,children:[(0,n.jsx)("div",{className:t.hitlDescriptionContainer,children:(0,n.jsx)(s.E,{children:e.isNotAvailable?ExcelCopilotCommandingHitlStrings.ValidateOfficeJsErrorMessage:e.commandingHitlDescription[0]})}),!e.isNotAvailable&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:t.callToActionTextContainer,children:(0,n.jsx)(s.E,{children:ExcelCopilotCommandingHitlStrings.CallToActionLabel})}),(0,n.jsx)(o.h,{summary:e.summary,collapsedButtonLabel:ExcelCopilotCommandingHitlStrings.ChangeListCollapsedButtonLabel,expandedButtonLabel:ExcelCopilotCommandingHitlStrings.ChangeListExpandedButtonLabel,loadingLabel:ExcelCopilotCommandingHitlStrings.ChangeListLoadingLabel,expandableListItems:e.expandableListItems,isLoading:e.isLoading,isNotAvailable:e.isNotAvailable,onFirstTimeListExpanded:()=>{i.E.getInstance().updateTelemetryChatEventData({[r.h3.ChatEventType]:r.a5.CommandScratchpadExpandHitlListClicked},l.M.getInstance())}}),(0,n.jsx)("div",{className:t.postExpandableListTextContainer,children:(0,n.jsx)(s.E,{children:ExcelCopilotCommandingHitlStrings.PostChangeListLabel})})]})]})}},83437:(e,t,a)=>{"use strict";var n,o,r,i,l,s,c,d,u,m,h,g,p;a.d(t,{$b:()=>p,CC:()=>s,CT:()=>n,Ff:()=>d,G8:()=>u,IC:()=>l,S2:()=>o,T_:()=>c,a5:()=>i,av:()=>g,h3:()=>r,kD:()=>h}),function(e){e.UserContextAnnotationActivationTime="UserContextAnnotationActivationTime",e.UserContextResponseTime="UserContextResponseTime",e.AnnotationType="AnnotationType",e.FeatureName="FeatureName",e.SubFeatureName="SubFeatureName",e.UserProfileResponseTime="UserProfileResponseTime",e.PersonalizationCardUserInteractionTime="PersonalizationCardUserInteractionTime",e.UserPerceivedLatency="UserPerceivedLatency",e.IsQuerySuccess="IsQuerySuccess",e.ErrorType="ErrorType",e.ErrorParameter="ErrorParameter",e.ErrorChatEventType="ErrorChatEventType",e.ErrorChatEventParameter="ErrorChatEventParameter",e.IsPersonalizedResponse="IsPersonalizedResponse",e.CIPEvaluationResponseTime="CIPEvaluationResponseTime"}(n||(n={})),function(e){e.CLP="CLP",e.Personalization="Personalization",e.MSAL="MSAL",e.ExtensibilityDialog="ExtensibilityDialog",e.LocalAddinActionExecution="LocalAddinActionExecution"}(o||(o={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.ChatErrorType="ChatErrorType",e.ChatErrorKey="ChatErrorKey",e.Cv="Cv",e.UserQueryGuid="UserQueryGuid",e.IsPersonalizedResponse="IsPersonalizedResponse"}(r||(r={})),function(e){e.OfficeJsApiCallForCLP="OfficeJs_Api_Call_For_CLP",e.OfficeJsApiCallForCLPError="OfficeJs_Api_Call_For_CLP_Error",e.IsDocumentProtected="IsDocumentProtected",e.ALUserType="AL_User_Type",e.PrimaryUserType="Primary_User_Type",e.EnterpriseGroundingDisabled="Enterprise_Grounding_Disabled",e.CopilotConfig="Copilot_Config",e.UserContextSignalSubmitted="User_Context_Signal_Submitted",e.ContentIntelligencePlatformEvaluationSignalSubmitted="ContentIntelligence_Platform_Evaluation_Signal_Submitted",e.SummaryFromNudgeTriggered="Summary_From_Nudge_Triggered",e.PodcastFromNudgeTriggered="Podcast_From_Nudge_Triggered",e.DescribeImageFromNudgeTriggered="Describe_Image_From_Nudge_Triggered",e.ErrorBoundaryCaughtError="Error_Boundary_Caught_Error",e.ResponseReceivedFromAL="Response_Received_From_Augloop",e.ApiPluginDataReceived="ApiPlugin_Data_Received",e.MsgExtDataReceived="MsgExt_Data_Received",e.QuerySuccessful="Query_Successful",e.UserProfileOperationSubmitted="UserProfile_Operation_Submitted",e.PersonalizationHITLCardShown="Personalization_HITL_Card_Shown",e.UserOverridedPersonalizationHITL="User_Overrided_Personalization_HITL",e.UndefinedQueryIDInHITLCard="Undefined_QueryID_In_HITL_Card",e.IncompleteUserProfileResponse="Incomplete_User_Profile_Response",e.PersonalizationIndicatorShown="Personalization_Indicator_Shown",e.CLPErrorShown="CLP_Error_Shown",e.CLPErrorIgnored="CLP_Error_Ignored",e.MSALTokenRequested="MSAL_Token_Requested",e.TaskModuleServiceRequest="Task_Module_Service_Request",e.TaskModuleServiceResponse="Task_Module_Service_Response",e.TaskModuleServiceError="Task_Module_Service_Error",e.ExtensibilityDialogLoad="Extensibility_Dialog_Load",e.CloudFilesDialogOpened="Cloud_Files_Dialog_Opened",e.OpenMOSDialog="Open_MOS_Store_To_Get_Agents",e.MOSStoreDialogResponse="MOS_Store_Dialog_Response",e.VoiceCopilotZQMSubmitted="Voice_Copilot_ZQM_Submitted",e.VoiceCopilotZQMResponseRendered="Voice_Copilot_ZQM_Response_Rendered",e.VoiceCopilotZQMResponseClicked="Voice_Copilot_ZQM_Response_Clicked",e.VoiceCopilotZQMAutoStarted="Voice_Copilot_ZQM_Auto_Started",e.ChatHistorySignalSubmitted="Chat_History_Signal_Submitted",e.ConversationIdUndefined="Conversation_Id_Undefined",e.UpdateChatSessionId="Update_Chat_Session_Id",e.CannotUpdateChatSessionId="Cannot_Update_Chat_Session_Id",e.SubmitOperationUndefined="Submit_Operation_Undefined",e.ConnectionHealth="Connection_Health",e.InsightsCardRelatedFilesResponse="Insights_Card_RelatedFiles_Response",e.AugLoopOfficeCopilotOrchestrationCopilotRelatedFilesError="AugLoop_OfficeCopilotOrchestration_CopilotRelatedFiles_Error",e.InsightsCardRelatedFilesSignalSent="Insights_Card_RelatedFiles_Signal_Sent",e.InsightsCardCocoaSkillResponse="Insights_Card_CocoaSkill_{Skill}_Response",e.InsightsCardCocoaSkillResponseUpdating="Insights_Card_CocoaSkill_{Skill}_Response_Updating",e.InsightsCardCocoaSkillResponseLoaded="Insights_Card_CocoaSkill_{Skill}_Response_Loaded",e.InsightsCardCocoaSkillResponseError="Insights_Card_CocoaSkill_{Skill}_Response_Error",e.InsightsCardCocoaSkillResponseTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_TimedOut",e.InsightsCardCocoaSkillResponseRetryTimedOut="Insights_Card_CocoaSkill_{Skill}_Response_Retry_TimedOut",e.InsightsCardCocoaSkillCardClicked="Insights_Card_CocoaSkill_{Skill}_CardClicked",e.InsightsCardCocoaSkillCardNavigatedTo="Insights_Card_CocoaSkill_{Skill}_CardNavigatedTo",e.LocalAddinActionInvoked="Local_Addin_Action_Invoked",e.LocalAddinExecutionCompletedFromHost="Local_Addin_Action_Completed_From_Host",e.LocalAddinExecutionFailedFromHost="Local_Addin_Action_Failed_From_Host",e.LocalAddinExecutionReceivedMultipleRequests="Local_Addin_Action_Received_Multiple_Requests",e.LocalAddinExecutionReceivedSingleRequest="Local_Addin_Action_Received_Single_Request",e.LocalAddinExecutionStarted="Local_Addin_Action_Started",e.StopGeneratingButtonClickedDuringAddinExecution="Stop_Generating_Button_Clicked_During_Addin_Execution",e.UndoButtonClickedAfterAddinSuccess="Undo_Button_Clicked_After_Addin_Success",e.UndoButtonHiddenOnSubmittingQueryAfterAddinSuccess="Undo_Button_Hidden_On_Submitting_Query_After_Addin_Success",e.UndoButtonShownAfterAddinSuccess="Undo_Button_Shown_After_Addin_Success"}(i||(i={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCategory="ErrorCategory",e.ErrorCode="ErrorCode",e.ErrorStack="ErrorStack"}(l||(l={})),function(e){e.Customize="Customize",e.CopilotChat="CopilotChat",e.Extensibility="Extensibility"}(s||(s={})),function(e){e.Client="Client",e.Server="Server",e.SubstrateService="SubstrateService",e.UnsupportedAction="UnsupportedAction"}(c||(c={})),function(e){e.PersonalizationHITL="Personalization HITL",e.PersonalizationUserProfile="Personalization User Profile",e.AddInActionsForAgents="Add-in Actions for Agents"}(d||(d={})),function(e){e.UnsupportedFunctionality="Unsupported Copilot Functionality",e.TimedOut="Response Delayed or Timed Out",e.UnableToCompleteTask="Unable to Complete Task",e.UnclassifiedError="Unclassified ASHA Error",e.UserAccessIssue="User Access Issue for Copilot",e.RAIError="Responsible AI Filter Blocked Response",e.CapacityIssue="Unable to Generate Response Due to Capacity Issue",e.ReferencingFileIssue="Referencing a File Failed",e.LLMIssue="LLM Service Side Issue Prevents Output",e.UserInputIssue="User Input Could Not Be Processed",e.UserRejectedResponse="User Rejected or Cancelled Response "}(u||(u={})),function(e){e.Unknown="Error is unknown",e.MissingProfileId="Error occurred because profileId in signal is invalid",e.StaleProfileId="Error occurred because user input is stale",e.NotSupportedProfileOperation="Error occurred because operation requested by user is not supported",e.InvalidUserQuery="Error occurred because input query is invalid",e.FailedToRead="Error occurred because service failed to read from roaming service",e.FailedToWrite="Error occurred because service failed to write to roaming service",e.UninitializedUserStoreEntities="Error occurred because the roaming setting was uninitialized",e.UndefinedUserStoreEntities="Error occurred because the roaming setting was not found",e.BadResponse="Error occurred because of bad response",e.Timeout="Error occurred timeout waiting for LLM",e.Throttled="Error occurred because number of requests per hour limit exceeded",e.UserThrottled="Error occurred because user has issued too many requests",e.ScenarioThrottled="Error occurred because scenario has issued too many requests",e.Token="Error occurred because of token",e.NotAvailable="Error occurred because server is unavailable",e.SkillFailed="Error occurred because skill failed",e.IncorrectServiceResponse="Error occurred due  to incorrect service response",e.EmptyResponse="Error occurred because of empty response"}(m||(m={})),function(e){e.Customize="Customize Customize",e.Summarize="Summarize Summarize",e.Command="Command Command",e.UnclearIntent="Unclear Intent CopilotChat",e.AddContent="Create Add Content",e.ChatQnA="Ask ChatQnA"}(h||(h={})),function(e){e.ExecutionStatusFailed="Error occurred because execution on client side has failed",e.SensitivityExecutionFailed="Error occurred because execution for sensitivity API failed",e.UnexpectedFailure="Error occurred because of unexpected failure caught on client side"}(g||(g={})),function(e){e[e.Warning=400]="Warning",e[e.ASHA=450]="ASHA",e[e.Error=500]="Error",e[e.Critical=600]="Critical"}(p||(p={})),function(e){e.Error="Error",e.UncaughtException="UncaughtException",e.ChatEvents="ChatEvents",e.AssertionFailed="AssertionFailed"}(o||(o={}))},84668:(e,t,a)=>{"use strict";a.d(t,{v:()=>s});var n=a(654845),o=a(964747),r=a(361292),i=a(89477);const l={resource:"https://officepyservice.office.net"};class s{async authorizeOfficePyService(e){const t=s.getOfficepyScope();return this.authorizeScope(t,e)}async authorizeScope(e,t){const a=this.tokenCache;if(a){if(!(Date.now()>a.expirationTime))return a.token;this.clearStorageToken()}return this.pendingPromise||(this.pendingPromise=this.auth.authorize(e,t,s.fallbackFn).then((e=>(this.pendingPromise=void 0,this.cacheStorageToken(e,Date.now()+s.getExpirationTime()),e))).catch((e=>{throw this.pendingPromise=void 0,e}))),this.pendingPromise}static putFallbackFn(e){s.fallbackFn=e}static getOfficepyScope(){return l}cacheStorageToken(e,t){Number.isInteger(t)&&(this.tokenCache={token:e,expirationTime:t})}getCachedStorageToken(){return this.tokenCache}static getExpirationTime(){return 3e6}clearStorageToken(){this.tokenCache=void 0}static getAuthProviders(){return[new i.f]}static instance(){const e=s.getAuthProviders();return s._instance||(s._instance=new s(new r.W(new n.N(new o.f(e))))),s._instance}constructor(e){this.auth=e}}},88994:(e,t,a)=>{"use strict";a.d(t,{s:()=>Se});var n=a(267324),o=a(638753),r=function(e,t,a){var n,r,i,l;return!!(null===(r=null===(n=null==e?void 0:e.chatResponse)||void 0===n?void 0:n.messages)||void 0===r?void 0:r.find((function(e){return(0,o._H)(e)})))&&(!!t&&(!!a||(null===(l=null===(i=null==e?void 0:e.chatResponse)||void 0===i?void 0:i.messages)||void 0===l?void 0:l.find((function(e){return((null==e?void 0:e.gptIdentifiers)||[]).length>0})))))},i=a(956933),l=a(83437),s=a(702864),c=a(660606),d=a(423905);function u(e,t){var a,n;void 0===t&&(t=!1);var o=(e||[]).filter((function(e){return!(!e.cardJson||e.sourceType&&"CITATION"!==e.sourceType)})),r=null!==(a=null==o?void 0:o.length)&&void 0!==a?a:0;return r>0?((0,c.cY)("Getting msgExtProp for MsgExtCard here.."),n={attributions:o},t&&(0,d.d_)(r)):(0,c.cY)("No data(cardJson) found for MsgExtCard."),n}function m(e,t){var a,n;void 0===t&&(t=!1);var o=(e||[]).filter((function(e){return!(!e.adaptiveCardJson||e.sourceType&&"CITATION"!==e.sourceType)})),r=null!==(a=null==o?void 0:o.length)&&void 0!==a?a:0;return r>0?((0,c.cY)("Getting apiPluginProp for ApiPluginCard here.."),n={attributions:o},t&&(0,d.ys)(r)):(0,c.cY)("No data(adaptiveCardJson) found for ApiPluginCard."),n}var h=a(480591),g=a(932367),p=a(754440),b=a(293118),f=a(63919),C=a(700853),y=a(322466),v=a(73915),x=a(104450),T=a(79458);class S{static getInstance(){return S.instance||(S.instance=new S),S.instance}getUrlForCitation(e){return(0,T.hX)(e.path)?e.seeMoreUrl:void 0}getReferenceSourceType(e){return e.sourceType===n.YgX?v.GH.Annotation:v.GH.Citation}constructor(){this.CitationFileTypeMap=new Map([[x.YA.PowerPoint,v._R.PowerPoint],[x.YA.Excel,v._R.Excel],[x.YA.Word,v._R.Word],[x.YA.OneNote,v._R.OneNote],[x.YA.Outlook,v._R.Outlook],[x.YA.Teams,v._R.Teams],[x.YA.Event,v._R.Event],[x.YA.Meeting,v._R.Meeting],[x.YA.TeamsMeeting,v._R.Meeting],[x.YA.SharePoint,v._R.SharePoint],[x.YA.PDF,v._R.Pdf],[x.YA.Zip,v._R.Pdf],[x.YA.Visio,v._R.Visio],[x.YA.Fluid,v._R.Loop],[x.YA.Txt,v._R.Txt]]),this.lastBuilderCitationsTypes=[],this.getLastBuildCitationsTypes=()=>this.lastBuilderCitationsTypes,this.getSnippetFromCitationContent=e=>e?'"'+(e.length>n.T1Y?e.slice(0,n.T1Y)+"...":e)+'"':null,this.getChatReferenceType=(e,t,a)=>e===x.YA.Web||void 0===e?v._2.External:void 0!==e&&Object.values(v._R).includes(e)?v._2.CrossApp:void 0===t?v._2.External:a?.path?((0,T.cY)("CitationBuilder: internal citation is not supported in excel: ",a.path),v._2.Internal):this.CitationFileTypeMap.has(t)?v._2.CrossApp:v._2.External,this.getCrossAppCitationFileType=e=>{if(void 0!==e)return this.CitationFileTypeMap.has(e)?this.CitationFileTypeMap.get(e):void 0},this.getSupportedIconType=e=>{if(void 0!==e)return Object.values(v._R).includes(e)?e:void 0},this.getTitleFromSnippet=e=>e?('"'===e[0]&&(e=e.substring(1,e.length-1)),'"'+(e.length>n.cGI?e.slice(0,n.cGI).trim()+"...":e)+'"'):null,this.getFileExtensionFromName=e=>e?.includes(".")?e.split(".").pop():"",this.getChatReferenceFromSourceAttributions=(e,t,a)=>(a&&(this.lastBuilderCitationsTypes=[]),e.filter((e=>t?e.sourceType===n.YgX:e.sourceType!==n.YgX)).map(((e,t)=>{let a;e.referenceMetadata&&(a=JSON.parse(e.referenceMetadata));const o=this.getChatReferenceType(a?.type,a?.referenceType,e);this.lastBuilderCitationsTypes.push(`${o}:${a?.type}:${a?.referenceType}:${this.getFileExtensionFromName(a?.fileName)}`);const r=this.getTitleFromSnippet(e.providerDisplayName)??o,i=a?.typeDescription??n.u1i,l=a?.iconUrl?.replace(/\/$/,""),s=this.getReferenceSourceType(e);return{referenceIndex:t+1,referenceProps:{title:r??n.u1i,primarySubtitle:i,secondarySubtitle:a?.context??this.getUrlForCitation(e),snippet:this.getSnippetFromCitationContent(a?.snippet)??n.u1i,referenceType:o,iconAppName:o===v._2.CrossApp?this.getSupportedIconType(a?.type):this.getCrossAppCitationFileType(a?.referenceType),url:this.getUrlForCitation(e),path:[e.path],sensitivityLabel:a?.sensitivityLabel?.displayName,iconUrl:l,linkType:s},isFlux:!0}})))}}var w=a(881707),E=a(103806),I=a(830714),R=a(922873),A=a(365319),L=a(965634),k=a(277718),F=a(74704),_=a(722307),P=a(644737),N=a(9847),M=a(31118),O=a(75440),D=a(113033),B=a(903430),$=a(4091),H=a(689534),U=a(697705),q=a(553373),V=a(476730),G=a(956258),W=a(379490),z=a(984691),j=a(831253),Q=a(95151),J=a(119202),Y=a(528804);const X=V.E.getInstance(),Z=G.M.getInstance();function K(e){return!!Y.v1l&&("bot"===e.author&&(void 0===e.messageType||"Chat"===e.messageType)&&e.contentOrigin===R.w.SelfHelpSkillName)}function ee(e,t){const a=e.adaptiveCards&&e.adaptiveCards.length>0,o=[];let r="";if(a&&e.hiddenText===R.x.QuickAnswer){r=R.x.QuickAnswer;const t=(0,n.sj0)(),a=e.adaptiveCards?e.adaptiveCards[0]:{},i=te(a,t,e.messageId);o.push(i)}else if(a&&e.hiddenText===R.x.HelpArticle)if(r=R.x.HelpArticle,1===e.adaptiveCards?.length){const t=(0,n.Vgn)(),a=e.adaptiveCards[0],r=te(a,t,e.messageId);o.push(r)}else{const t={chatCardType:C._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,n.sj0)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:y.O.None,isFailure:!1,messageId:e.messageId},addCardToChatHistory:!0},a=e.adaptiveCards.map((t=>te(t,e.messageId)));o.push(t,...a)}else{r="N/A";const t={chatCardType:C._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:(0,n.ZAw)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:y.O.None,isFailure:!0,messageId:e.messageId},addCardToChatHistory:!0};o.push(t)}ie(r);for(const e of o)t.displayResponse(e)}const te=(e,t,a)=>({chatCardType:C._.SelfHelpAdaptiveCard,chatMessageData:{selfHelpAdaptiveCardProps:{user:"chat",headerText:t,sourceLabel:{iconName:"unknown",text:(0,n.Ovt)()},cardData:e,customActions:{[ae.JsonTypeName]:ae,[oe.JsonTypeName]:oe,[re.JsonTypeName]:re,[ne.JsonTypeName]:ne}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:y.O.Footer,feedbackData:(0,J.M5)("Copilot\\SelfHelpSearch"),isFailure:!1,messageId:a},addCardToChatHistory:!0});class ae extends Q.TelemetryEnabledActionBase{getJsonTypeName(){return ae.JsonTypeName}executeWithTelemetry(e){le("ExecuteTCID",e),this.tcid&&Office.context.ui.executeFeature(this.tcid)}}ae.JsonTypeName="SelfHelpAction.ExecuteTCID",ae.tcidProperty=new j.Uy(j.uq.v1_0,"tcid"),(0,W.__decorate)([(0,j.MZ)(ae.tcidProperty)],ae.prototype,"tcid",void 0);class ne extends Q.TelemetryEnabledActionBase{getJsonTypeName(){return ne.JsonTypeName}executeWithTelemetry(e){le("ShowTeachingCallout",e),this.tabId&&this.anchorId&&this.calloutTitle&&this.calloutText&&OfficeFirstParty.Notification.addNotification(OfficeFirstParty.Notification.callout({target:this.tabId,title:this.calloutTitle,content:this.calloutText,useTeachingStyles:!0}),{navigationalOptions:{controlToFind:this.anchorId}})}}ne.JsonTypeName="SelfHelpAction.ShowTeachingCallout",ne.tabIdProperty=new j.Uy(j.uq.v1_0,"tabId"),ne.anchorIdProperty=new j.Uy(j.uq.v1_0,"anchorId"),ne.calloutTitleProperty=new j.XB(j.uq.v1_0,"calloutTitle"),ne.calloutTextProperty=new j.XB(j.uq.v1_0,"calloutText"),ne.delayProperty=new j.Uy(j.uq.v1_0,"delay"),(0,W.__decorate)([(0,j.MZ)(ne.tabIdProperty)],ne.prototype,"tabId",void 0),(0,W.__decorate)([(0,j.MZ)(ne.anchorIdProperty)],ne.prototype,"anchorId",void 0),(0,W.__decorate)([(0,j.MZ)(ne.calloutTitleProperty)],ne.prototype,"calloutTitle",void 0),(0,W.__decorate)([(0,j.MZ)(ne.calloutTextProperty)],ne.prototype,"calloutText",void 0),(0,W.__decorate)([(0,j.MZ)(ne.delayProperty)],ne.prototype,"delay",void 0);class oe extends Q.TelemetryEnabledActionBase{getJsonTypeName(){return oe.JsonTypeName}executeWithTelemetry(e){le("OpenUrl",e),this.url&&window?.open(this.url)}}oe.JsonTypeName="SelfHelpAction.OpenUrl",oe.urlProperty=new j.XB(j.uq.v1_0,"url"),(0,W.__decorate)([(0,j.MZ)(oe.urlProperty)],oe.prototype,"url",void 0);class re extends Q.TelemetryEnabledActionBase{getJsonTypeName(){return re.JsonTypeName}executeWithTelemetry(e){le("ShowHelpPane",e),this.articleId&&OfficeFirstParty.Copilot.launchHelpPaneByArticleIdString(this.articleId)}}re.JsonTypeName="SelfHelpAction.ShowHelpPane",re.articleIdProperty=new j.XB(j.uq.v1_0,"articleId"),(0,W.__decorate)([(0,j.MZ)(re.articleIdProperty)],re.prototype,"articleId",void 0);const ie=e=>{X.updateTelemetryChatEventData({[N.h3.ChatEventType]:N.a5.SelfHelpContentShown,[N.h3.ChatEventParameters]:JSON.stringify({ContentType:e})},Z),Z.endTriedActivitySuccess(N.q.SelfHelp)},le=(e,t)=>{const a=G.M.userQueryGuid;if(t){const{correlationId:e}=(0,N.zq)(t);void 0!==e&&(G.M.userQueryGuid=e,U.B.userQueryGuid=e)}X.updateTelemetryChatEventData({[N.h3.ChatEventType]:N.a5.SelfHelpActionClicked,[N.h3.ChatEventParameters]:JSON.stringify({ActionType:e})},Z),U.B.getInstance().logKeptEvent(N.BJ.ChatQnA,N.q.SelfHelp,z.RX.Ask),t&&(G.M.userQueryGuid=a,U.B.userQueryGuid=a)};var se=a(874066),ce=a(235373),de=a(797639),ue=a(544707),me=a(48093),he=a(472500),ge=a(940096),pe=a(463345),be=a(804672),fe=a(962614),Ce=a.n(fe);function ye(e){if(!e)return"None";const t=(new(Ce())).parse(e,{});if(t.some((e=>"table_close"===e.type)))return A.$.getInstance().doesLastResponseHaveTable=!0,"Table";return t.some((e=>"ordered_list_close"===e.type||"bullet_list_close"===e.type))?"List":"None"}var ve=a(348065),xe=a(495501);const Te=()=>(0,Y.yw9)("OfficeVSO_9262753_InternalLoadingMessageSupportEnabled")||(0,Y.vIj)();class Se{static getInstance(){return Se._instance||(Se._instance=new Se),Se._instance}getCustomMarkdownComponents(e,t){const a=this.getMarkdownCardOptionsByMessageOrigin(e,t);return(0,D.X)(a)}cleanupStreamHandler(){this.messageId="",this.contentOrigin=void 0,this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1,this.isFirstStreamChunk=!0,this.paragraphChunks="",this.chunksCount=0,this.lastFormulaRequestDebugInfo=void 0,this.isDisengagedError=!1,this.codePreviewProps=void 0}resetStartQueryState(e){this.isMessageRendered=!1,this.augloopSignalSentTime=e}isWaitingForStreamEnd(){return this.isStreaming}endUserPerceivedLatency(e,t,a){!this.isMessageRendered&&this.augloopSignalSentTime&&(t&&a&&G.M.getInstance().assertFeatureIsActive(t,"displayResponse: Feature from telemetry.featureName does not match active feature."),this.telemetryEventHandler.logUserPerceivedLatencyTelemetry(!0,e,!1,this.augloopSignalSentTime,this.telemetryLogger,t),this.isMessageRendered=!0,this.augloopSignalSentTime=void 0)}getBasinObject(){return this.basin}setShowUndoButton(e){this.showUndoButton=e}setDisableUndoButton(e){this.disableUndoButton=e}getConversationId(){return this.conversationId}getSydneyEndpoint(){return this.sydneyEndpoint}getResponseLocale(){return this.locale}isHandledResponseMessage(e){return(0,Y.yw9)("OfficeVSO_9318370_DontIgnoreInternalLoaderMessage")&&this.isInternalLoadingMessage(e)?Te():!!this.isDisengagedMessage(e)||this.isValidMessageForRendering(e)}setLastFormulaRequestDebugInfo(e){this.lastFormulaRequestDebugInfo=e}setShouldShowFormulaDevButton(e){this.shouldShowFormulaDevButton=e}shouldStopLoadingUi(e){if(!e.messages)return!0;let t=!0;for(const a of e.messages)try{const e=JSON.parse(a.text);if(void 0!==e?.stopLoadingUi){t=e.stopLoadingUi;break}}catch(e){(0,T.cY)(`parse stop loading ui error: ${e}`)}return t}isInternalLoadingMessage(e){return e.messageType===B.n3.InternalSearchQuery||e.messageType===B.n3.InternalLoaderMessage}isDisengagedMessage(e){return e.messageType===B.n3.Disengaged}hasSeenDisengagedError(){return this.isDisengagedError}getFullAdaptiveCardText(e){const t=e.adaptiveCards?e.adaptiveCards[0]:null;let a="";if(t){const e=t.body;for(const t of e)"TextBlock"===t.type&&(a+=t.text)}return a}handleStreamEndInternal(e){(0,T.cY)("ExcelAppSharedStreamHandler: Excel App Copilot streaming ended."),this.logDiagnostics();const t=e.messages?.find((e=>this.isValidMessageForRendering(e)));return t}async handleStreamEndForSharedCopilot(e,t,a,c,d,u,m){!this.conversationId?.length&&a&&(this.conversationId=a,G.M.conversationId=a,U.B.conversationId=a),this.sydneyEndpoint?.length||(this.sydneyEndpoint=d);const h=this.handleStreamEndInternal(e);if(h&&(0,q.JK)(h)&&(this.streamingCitationHandler?.processCitations(h,m),this.streamingCitationHandler?.setMessageMetadata(h,e)),(0,Y.iPS)("Microsoft.Office.Excel.FA000000124.EnableExcelAnalysisWorkflow",!1)&&h&&h.adaptiveCards&&this.shouldRenderAdaptiveCard(h)){const e=h.adaptiveCards[0],t=xe.n.getChartAdaptiveCardResponse({requestId:h.requestId,adaptiveCardDefinition:e});A.$.getInstance().displayResponse(t.message,t.telemetry)}let b={};if(this.telemetryEventHandler.updateTelemetryLatencyData({[N.CT.ContentOrigin]:h?.contentOrigin??R.w.Unknown},this.telemetryLogger),this.messageId){if(h&&h.messageId===this.messageId&&!K(h)){(0,T.cY)("ExcelAppSharedStreamHandler: Message id was set. Updating final message rendered");const a=r({chatResponse:e},(0,Y.LSW)(),(0,Y.DtK)()),n={allowImages:a,enableLinkDataDownload:a,disableLinksProcessing:!1},o=(0,me.pX)()?e.conversationSensitivityLabel:void 0;if(o){(0,T.cY)("ExcelAppSharedStreamHandler: Enterprise search"),(0,i.Yw)();const e=(0,ue.oR)(o);try{const t=await w.n.getInstance().getInDocSensitiveLabelUsingOfcJs(),a=await w.n.getInstance().getHighestDocumentSensitivityInfo([t,e]);a.isDke=t.isDke,a.hasExtractForUser=t.hasExtractForUser,(0,T.cY)("Highest label: "+JSON.stringify(a)),w.n.getInstance().setInDocSensitivityLabelInfo(a)}catch(e){(0,T.cY)("Enterprise search: Office JS sensitivity api failed: "+e.message),this.telemetryLogger.logError({eventType:L.S2.OfficeJsOperations,errorMessage:"Exception while calling Office JS sensitivity api in Flux Copilot Workflow: "+e.message,logLevel:l.$b.Error},void 0,[{key:L.Wg.UserQueryGuid_,value:G.M.userQueryGuid}]),G.M.getInstance().logStandardizedAshaErrorEvent(p.W.LLM_Service_Side_Issue_Prevents_Output,g.c.Orchestration_Failed_When_Calling_OfficeJS_Sensitivity_API,N.BJ.CopilotChat)}}const s=(0,Y._bw)()?(0,ue.yu)():void 0,c=this.shouldStopLoadingUi(e);b=await this.updateLastRenderedMessage(h,t,s,c,n)}}else{const t=A.$.getInstance().getLastMessage(!1);if(t&&t.body.user===f.Q9.Chat){const a=t?.messageType??C._.MarkdownCard;(0,T.cY)("ExcelAppSharedStreamHandler: Message id was not set. Stopping loading ui for last message"),(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?A.$.getInstance().updateMessage({chatCardType:a,stopLoadingUi:this.shouldStopLoadingUi(e),addCardToChatHistory:!1,chatMessageBodyData:{messageId:t?.messageId}}):A.$.getInstance().updateLastMessage({chatCardType:a,stopLoadingUi:this.shouldStopLoadingUi(e),addCardToChatHistory:!1})}}const y=A.$.getInstance().getLastMessage(!1),v=await t((0,$.gp)());if(y&&y.body.user===f.Q9.Human&&!v||de.CP.pythonContextManager.isPythonMode&&h){if(!(de.CP.pythonContextManager.isPythonMode&&(!h||"bot"===e?.messages?.slice(-1)[0]?.author)&&y?.body?.user===f.Q9.Human)){h||G.M.getInstance().logError({eventType:L.S2.StreamHandler,errorMessage:"ExcelAppSharedStreamHandler: finalMessage is undefined",logLevel:l.$b.Warning});const t=h?.text??(0,n.BFD)();if((0,T.cY)("ExcelAppSharedStreamHandler: No chat message has been rendered. If we need to display, we will use either the finalMessage.text or the Whoops! string: ",t),(0,Y.yw9)("OfficeVSO_9939503_AnalyzeDataStreamingAdaptiveCard")&&h&&h.adaptiveCards&&this.shouldRenderAdaptiveCard(h)){const e=h.adaptiveCards[0],t=xe.n.getChartAdaptiveCardResponse({requestId:h.requestId,adaptiveCardDefinition:e});A.$.getInstance().displayResponse(t.message,t.telemetry)}else{const a=this.shouldStopLoadingUi(e);this.addResponseMarkdownMessageCard(t,h?.messageId,a,h?.contentOrigin)}}}if(b.conversationId=this.conversationId,b.messageId=h?.messageId,b.userQueryGuid=G.M.userQueryGuid,b.chunkCount=this.chunksCount,b.groundingMode=(0,N.Q6)(),this.telemetryEventHandler.updateTelemetryChatEventData({[N.h3.ChatEventType]:N.a5.ResponseStreamFinished,[N.h3.ChatEventParameters]:JSON.stringify({lastMessageMetadata:b})},this.telemetryLogger),t(se.m.resetDoesFluxTurnRequireUndo()),this.cleanupStreamHandler(),F.Q.getInstance().stopRecordingFluxWorkflow(!0),(0,Y.yw9)("OfficeVSO_10021705_SendTelemetryForMultipleCardsOnError")&&A.$.getInstance().handleEndOfQuery(e.messages?.[0]?.requestId??""),this.shouldStopLoadingUi(e)&&(await t((0,$.L4)(!0)),(0,Y.vIj)()&&t(ce.m.setLoadingStrings([]))),!(0,Y.k64)()||(0,Y.IU1)()&&(0,Y.geU)()||(0,P.s_)(P.H0.EnableApply),c){if(!this.isMessageRendered){let e=(0,N.eQ)(h?.contentOrigin);this.telemetryLogger.getActiveFeature()!==N.BJ.CopilotChat&&(e=this.telemetryLogger.getActiveFeature()),this.telemetryLogger.assertFeatureIsActive(e,"handleStreamEndForSharedCopilot: Feature from finalMessage?.contentOrigin does not match active feature."),this.telemetryEventHandler.logUserPerceivedLatencyTelemetry(!1,!0,u??!1,c,this.telemetryLogger,e),this.isMessageRendered=!0,this.augloopSignalSentTime=void 0}const e=(0,N.xJ)(c);this.telemetryEventHandler.logLatency(e,N.OP.ChatResponseLastChunk)}(0,Y.UxI)()&&s.xP.setIsAddinFlow(!1,(()=>{(0,o.An)(A.$.getInstance().getCopilotRef(),!1)}))}async getExcelActionButtons(e,t,a,o,r,i){const c=[];A.$.getInstance().doesLastResponseHaveTable=!1;const d=(0,Y.UxI)()&&s.xP.getCurrentAddinState()===s.aB.HasAction;if(d&&(s.xP.transitionAddinState(s.aB.ShowButton),U.B.getInstance().sendChatEventTelemetry((0,N.pN)({[N.h3.ChatEventType]:l.a5.UndoButtonShownAfterAddinSuccess}))),this.showUndoButton&&(0,Y.BAK)()||d){const e=()=>{U.B.getInstance().sendChatEventTelemetry((0,N.pN)({[N.h3.ChatEventType]:l.a5.UndoButtonClickedAfterAddinSuccess})),A.$.getInstance().displayResponse({chatCardType:C._.Default,chatMessageData:{defaultMessageProps:{user:f.Q9.Chat,messageHeader:{text:(0,n.W1n)()}}},chatMessageBodyData:{messageAttributionProps:(0,J.qN)()}}),(0,P.s_)(P.H0.RemoveUndo)};c.push((0,P.FW)(N.q.CopilotChat,void 0,e))}this.disableUndoButton&&(0,P.s_)(P.H0.DisableUndo);const u=a===R.w.ElseSkillName;if(u){const e=(0,he.J)(this.shouldShowFormulaDevButton,this.lastFormulaRequestDebugInfo);e&&c.push(e)}const m=this.streamingCitationHandler?.doMessageContainsExcelCitation(e),h=!_.iJ.isIOSPlatform()&&(0,Y.iPS)("Microsoft.Office.Excel.FA000000124.ImportDataShowImportButton",!0)&&i&&m;if(h){let t=w.n.getInstance().getInDocSensitiveLabelInfo();""===t.labelId&&(await w.n.getInstance().setInDocSensitiveLabelInfoUsingOfcJs(),t=w.n.getInstance().getInDocSensitiveLabelInfo()),c.push((0,P.E_)(e,G.M.userQueryGuid,t,o))}const g=!h&&(0,Y.vIj)();if(u&&(0,Y.yw9)("OfficeVSO_9211113_InsertTablesFromElseCard")||g){const e=ye(t),n=g&&(0,Y.iPS)("Microsoft.Office.Excel.FA000000124.AllowInsertListFromSearch",!0)&&!u&&a!==R.w.GetInsightsName&&a!==R.w.ChartsAndPivotTablesName&&a!==R.w.TextAnalysisName;"Table"===e?c.push((0,P.AU)(o,i)):n&&"List"===e&&c.push((0,P.A6)(o,i))}if(r){const e=0===c.length;c.push((0,P.z3)(e))}return(0,Y.jHv)()&&c.push((0,P.yo)(e)),c}getSuggestionItems(e){const t=e.filter((e=>e.messageType===B.n3.Suggestion)).map((e=>({suggestionText:e.text,suggestionType:"SydneySuggestion"})));if((0,Y.yw9)("OfficeVSO_9922143_ShowPythonSuggestionPill")){const e=E.p.getInstance();if(!1===e.getPythonMode()&&!0===e.shouldShowPythonAASuggestions()){return[{suggestionText:(0,n.Bzb)(),suggestionType:"Python_Suggestion_FromSkittle"},...t]}}return t}async updateLastRenderedMessage(e,t,a,n=!0,o){const r=!(e.contentOrigin===R.w.ElseSkillName||(0,me.pX)()&&function(e){if(!e)return!1;const t=/=\S+\(.*\)/,a=/[+\-@]\S+\(.*\)/,n=/[=+\-@]\S*[!|]/,o=new RegExp(`${t.source}|${a.source}|${n.source}`).test(e);if(o){(0,be.cY)("NOTICE!: Potential formula found: "+e);const o=t.test(e),r=a.test(e),i=n.test(e);G.M.getInstance().logError({eventType:L.S2.StreamHandler,errorMessage:`messageCouldHaveFormulas: Potential formula found. First pattern hit: ${o}, Second pattern hit: ${r}, Third pattern hit: ${i}`,logLevel:l.$b.Warning},void 0,[{key:L.Wg.UserQueryGuid_,value:G.M.userQueryGuid}]),(0,Y.yw9)("OfficeVSO_9707150_demoteMessageCouldHaveFormulas")||G.M.getInstance().logStandardizedAshaErrorEvent(p.W.Missing_Copilot_Functionality,g.c.Input_Resulted_In_Unsupported_Command,N.BJ.CopilotChat)}return o}(e.text));let i=[],s=[];if((0,Y.vIj)()&&((e.sourceAttributions||[]).length>0?((0,T.cY)("ExcelAppSharedStreamHandler: Getting external citations here.."),i=S.getInstance().getChatReferenceFromSourceAttributions(e.sourceAttributions,!1,!0),s=S.getInstance().getChatReferenceFromSourceAttributions(e.sourceAttributions,!0)):(e.citations||[]).length>0&&(0,T.cY)("ExcelAppSharedStreamHandler: Getting in-doc citations which is not supported in Excel"),(0,me.pX)()||(0,me.gc)())){const{suggestedResponses:a}=e;if((0,T.cY)("ExcelAppSharedStreamHandler: suggestedResponses ",a),a&&a.length>0&&e.contentOrigin!==R.w.GetInsightsName&&e.contentOrigin!==R.w.ChartsAndPivotTablesName&&e.contentOrigin!==R.w.TextAnalysisName){const e=this.getSuggestionItems(a);t(ce.m.setSuggestionListDetails({suggestionList:e}))}}const c=e;if((c.gptIdentifiers||[]).length>0){const e=c.gptIdentifiers[0].id;e&&((0,T.cY)(`Rendering branding header for response received with GPT ID: ${e}`),U.B.getInstance().sendChatEventTelemetry((0,N.pN)({[N.h3.ChatEventType]:N.a5.GptIdForBranding,[N.h3.ChatEventParameters]:e})))}const d=i.length>0;d&&(this.telemetryLogger.startTriedActivity(N.q.Search),this.telemetryLogger.endTriedActivitySuccess(N.q.Search));const h=await this.getExcelActionButtons(e.messageId,e.text,e.contentOrigin,t,r,d),b=(0,Y.kkU)()&&e.sourceAttributions?u(e.sourceAttributions??[],!0):void 0,f=(0,Y.l6e)()&&e.sourceAttributions?m(e.sourceAttributions,!0):void 0,v=this.codePreviewProps;if(e.adaptiveCards&&this.shouldRenderAdaptiveCard(e)){const t=e.adaptiveCards[0],a=xe.n.getChartAdaptiveCardResponse({requestId:e.requestId,adaptiveCardDefinition:t});(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?A.$.getInstance().updateMessage(a.message):A.$.getInstance().updateLastMessage(a.message)}else{const t=this.getMarkdownCardOptionsByMessageOrigin(e.contentOrigin,e.messageId).feedbackData?.feedbackArea,l=A.$.getInstance().getLastMessage(),c={chatCardType:C._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e.text,horizontalTableScroll:!0,componentsOverride:this.getCustomMarkdownComponents(e.contentOrigin,e.messageId),allowImages:o?.allowImages,enableLinkDataDownload:o?.enableLinkDataDownload,disableLinksProcessing:o?.disableLinksProcessing}},chatMessageBodyData:{...(0,J.Cn)({showAIGenerated:!0,showAnimation:!0,footerPosition:y.O.Footer,actionButtonList:h,isFailure:!1,references:i&&i.length>0?i:void 0,annotationReferences:s&&s.length>0?s:void 0,clpLabel:a?(0,ue.Q9)(a):void 0,msgExtCardProps:1===b?.attributions.length?void 0:b,apiPluginCardProps:f,feedbackArea:t,shouldShowCopyButton:r,shouldShowHandoffButton:!0,shouldShowReadAloudButton:!0,codePreviewProps:v}),messageId:(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?l?.messageId:void 0},stopLoadingUi:n,addCardToChatHistory:!0};(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?A.$.getInstance().updateMessage(c):A.$.getInstance().updateLastMessage(c)}return{suggestionsCount:e.suggestedResponses?.length,referencesCount:i?.length,annotationReferencesCount:s?.length,isSearchResponse:d,citationsTypes:S.getInstance().getLastBuildCitationsTypes(),actionButtonsCount:h.length,responseHasTable:A.$.getInstance().doesLastResponseHaveTable}}handleChatResponseForSharedCopilot(e,t,a,n,o,r,i,l,s){const c=this.telemetryLogger.getActiveFeature();(0,Y.thH)()&&l&&(0,M.y)(l,c),n?.length&&(this.conversationId=n,G.M.conversationId=n,U.B.conversationId=n),o?.length&&(this.sydneyEndpoint=o);const d=t.basinCursor,h=t.basinWrite,g=t.messagesToAddOrReplace,p=t.messagesToDelete,b=t.messagesToUpdate;if(!(0,T.hX)(p))for(const e of p)(0,T.cY)("ExcelAppSharedStreamHandler: Deleting message id: ",e),A.$.getInstance().deleteMessage({chatCardType:C._.MarkdownCard,messageIdToDelete:e}),delete this.basin.items[e];if(!(0,T.hX)(d)){const e=JSON.parse(d);this.basin.setCursor(e),(0,T.cY)("ExcelAppSharedStreamHandler: Setting basin cursor: ",e)}if((0,T.cY)("ExcelAppSharedStreamHandler: Initial/previous annotation message id is "+this.messageId),!(0,T.hX)(g)&&g.length>0)for(const t of g){if(this.isDisengagedError)break;if(this.isDisengagedMessage(t)){this.isDisengagedError=!0;const{message:e,telemetry:t}=xe.n.getDisengagedErrorResponse(c);A.$.getInstance().displayResponse(e,t),(0,O.I)(void 0,c);break}if(t.isTextAnalysis){(0,T.cY)("Returning early due to isTextAnalysis.");break}if(this.shouldNotShowFluxResponseForInsights(s)){(0,T.cY)("ExcelAppSharedStreamHandler: Returning early to skip the flux response since it should not be shown.");break}if((0,q.JK)(t)&&this.streamingCitationHandler?.processCitations(t,i),this.isValidMessageForRendering(t)){if((0,T.cY)("ExcelAppSharedStreamHandler: MessageId for this annotation is : "+t.messageId),t.messageId!==this.messageId){if(this.messageId=t.messageId,this.isFirstStreamChunk){if(a){if(!this.isMessageRendered){let e=(0,N.eQ)(t?.contentOrigin);this.telemetryLogger.getActiveFeature()!==N.BJ.CopilotChat&&(e=this.telemetryLogger.getActiveFeature()),this.telemetryLogger.assertFeatureIsActive(e,"handleChatResponseForSharedCopilot: Feature from message?.contentOrigin does not match active feature."),this.telemetryEventHandler.logUserPerceivedLatencyTelemetry(!0,!0,r??!1,a,this.telemetryLogger,e),this.augloopSignalSentTime=void 0}const e=(0,N.xJ)(a);this.telemetryEventHandler.logLatency(e,N.OP.ChatResponseFirstChunk)}this.isFirstStreamChunk=!1}if((0,J.D9)(t.offense),(0,T.cY)("ExcelAppSharedStreamHandler: Adding Response Card for messagesToAddOrReplace 1:",t),K(t))ee(t,A.$.getInstance());else if(t.adaptiveCards&&this.shouldRenderAdaptiveCard(t)){e(ce.m.setLatestRequestId(G.M.userQueryGuid));const a=t.adaptiveCards[0],n=xe.n.getChartAdaptiveCardResponse({requestId:t.requestId,adaptiveCardDefinition:a});A.$.getInstance().displayResponse(n.message,n.telemetry)}else{this.basin.items[this.messageId]={adaptiveCards:[{body:[{text:t.text,type:"TextBlock",wrap:!0}]}]};const e=this.getFullAdaptiveCardText(t);(0,T.cY)("ExcelAppSharedStreamHandler: Full text from Adaptive Card: ",e);((0,Y.yw9)("OfficeVSO_10429342_AddResponseMarkdownMessageConditionsRefactor")?!((0,Y.IU1)()&&(0,Y.geU)()):!(0,Y.IU1)())&&this.addResponseMarkdownMessageCard(e||t.text,t.messageId,void 0,t.contentOrigin)}}else if(!K(t)){(0,T.cY)("ExcelAppSharedStreamHandler: Adding Response Card for messagesToAddOrReplace 2:",t);const e=this.getFullAdaptiveCardText(t);(0,T.cY)("ExcelAppSharedStreamHandler: Full text from Adaptive Card: ",e);const a=t.sourceAttributions,n=a?S.getInstance().getChatReferenceFromSourceAttributions(a):[],o=a?S.getInstance().getChatReferenceFromSourceAttributions(a,!0):[],r=(0,Y.kkU)()&&a?u(a):void 0,i=(0,Y.l6e)()&&a?m(a):void 0;this.updateResponseMarkdownMessageCard(e||t.text,!0,n,o,r,i)}}else Te()&&this.isInternalLoadingMessage(t)&&e(ce.m.setLoadingStrings([t.text]))}else{if(!(0,T.hX)(b)&&b.length>0)for(const e of b)if((0,T.cY)("ExcelAppSharedStreamHandler: MessageId for this annotation is : "+e.messageId),e.messageId===this.messageId){(0,T.cY)("ExcelAppSharedStreamHandler: Updating Response Card to messagesToUpdate:",e);const t=e.sourceAttributions,a=t?S.getInstance().getChatReferenceFromSourceAttributions(t):[],n=t?S.getInstance().getChatReferenceFromSourceAttributions(t,!0):[],o=(0,Y.kkU)()&&t?u(t):void 0,r=(0,Y.l6e)()&&t?m(t):void 0;this.updateResponseMarkdownMessageCard(e.appendText,void 0,a,n,o,r),(0,q.JK)(e)&&this.streamingCitationHandler?.processCitations(e,i)}if(!(0,T.hX)(h)){const e=JSON.parse(h);(0,T.cY)("ExcelAppSharedStreamHandler: Basin write received: ",e),this.basin.write(e);const t=this.getFullAdaptiveCardText(this.basin.items[this.messageId]);(0,T.cY)("ExcelAppSharedStreamHandler: Full text from Adaptive Card: ",t),this.updateResponseMarkdownMessageCard(t||e,!0)}}}async handleChatResponse(e,t,a,n,i,l,s,c){(0,T.cY)("ExcelAppSharedStreamHandler: Excel Copilot chatResponse received for Shared Copilot");const d=t((0,ge.Z)())?.dataLocale;if(!((0,Y.yw9)("OfficeVSO_9176144_DontProcessInternalLoaderMessages")&&this.chatResponseIsInternalLoaderMessage(e))){if(e.status===I.lC.Success){if(r({chatResponse:e},(0,Y.LSW)(),(0,Y.DtK)())&&(0,Y.jxV)()){const t=e.messages?.find((e=>(0,o._H)(e))),a=(t?.text?.length||0)>0;t&&!(0,T.hX)(t)&&(this.codePreviewProps=(0,o.QH)(t,a))}return await(0,h.BI)(e,A.$.getInstance().getCopilotRef(),{enableAddinLocalPluginActions:(0,Y.UxI)(),passAllMessages:!0})?void this.cleanupStreamHandler():(await this.handleStreamEndForSharedCopilot(e,t,a,n,i,l,d),void(this.codePreviewProps=void 0))}this.isStreaming||""===this.messageId||this.handleStreamBegin(t),this.chunksCount++}this.handleChatResponseForSharedCopilot(t,e,n,a,i,l,d,s,c)}chatResponseIsInternalLoaderMessage(e){const t=e.messagesToAddOrReplace?.[0];return!!t&&this.isInternalLoadingMessage(t)}logDiagnostics(){this.conversationId&&(0,T.cY)("ExcelAppSharedStreamHandler: conversation id from Excel App Copilot: "+this.conversationId)}shouldRenderAdaptiveCard(e){return((0,Y.yw9)("OfficeVSO_9118479_AnalyzeDataAdaptiveCard")&&e.adaptiveCards&&e.adaptiveCards?.length>0&&(e.contentOrigin===R.w.GetInsightsName||e.contentOrigin===R.w.ExcelAnalysis||e.contentOrigin===R.w.ChartsAndPivotTablesName||e.contentOrigin===R.w.TextAnalysisName))??!1}shouldNotShowFluxResponseForInsights(e){const t=de.CP.getQueryIdShouldNotShowFluxResponse();return!(!t||!e||t!==e)}constructor(e=()=>q.qx.getInstance()){this.basin=new b.Basin,this.messageId="",this.showUndoButton=!1,this.disableUndoButton=!1,this.isStreaming=!1,this.isFirstStreamChunk=!0,this.isMessageRendered=!1,this.augloopSignalSentTime=void 0,this.paragraphChunks="",this.contentOrigin=void 0,this.chunksCount=0,this.isDisengagedError=!1,this.conversationId=void 0,this.sydneyEndpoint=void 0,this.locale=void 0,this.telemetryLogger=G.M.getInstance(),this.telemetryEventHandler=V.E.getInstance(),this.lastFormulaRequestDebugInfo=void 0,this.shouldShowFormulaDevButton=!1,this.getMarkdownCardOptionsByMessageOrigin=(e,t)=>{const a=t??this.messageId,n=this.streamingCitationHandler?.doMessageContainsCitation(a)??!1;return(0,D.u)(e,n)},this.isValidMessageForRendering=e=>{if(e.locale&&(this.locale=e.locale),e.text)try{if(JSON.parse(e.text).publishPreference===H.f.Never)return!1}catch(e){}return!(e.author!==B.nC.Bot||!this.getFullAdaptiveCardText(e)&&!e.text||void 0!==e.messageType&&e.messageType!==B.n3.Chat||!e.messageId)},this.addResponseMarkdownMessageCard=(e,t,a,n)=>{if((0,T.hX)(e))return void(0,T.cY)("ExcelAppSharedStreamHandler: Returning as message is undefined");(0,T.cY)("ExcelAppSharedStreamHandler: Adding Response Card:",e),this.paragraphChunks=e,this.contentOrigin=n,this.messageId=t??"";const o=this.codePreviewProps,r=this.getMarkdownCardOptionsByMessageOrigin(n,t),i={featureName:r.telemetryFeatureName,eventType:N.a5.ConversationMessage},l=r.shouldShowDevDiagnosticsButton&&(0,Y.jHv)()&&t?[(0,P.yo)(t)]:[];if((0,Y.iPS)("Microsoft.Office.Excel.FA000000124.EnableExcelAnalysisWorkflow",!1)&&n===R.w.ExcelAnalysis){const t=ye(e);"Table"===t?l.push((0,P.AU)((0,ve.KA)().dispatch,!1)):"List"===t?l.push((0,P.A6)((0,ve.KA)().dispatch,!1)):l.push((0,P.z3)(!0))}A.$.getInstance().displayResponse({chatCardType:C._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks,horizontalTableScroll:!0,componentsOverride:r.useExcelMDComponents?(0,pe.i)(i.featureName):void 0,disableLinksProcessing:n?.toLowerCase()===R.w.CannedResponse}},chatMessageBodyData:{...(0,J.Cn)({showAIGenerated:r.showAiGenerated,showAnimation:!1,footerPosition:r.feedbackPosition,actionButtonList:l,shouldShowReadAloudButton:r.shouldShowReadAloudButton,codePreviewProps:o}),messageId:t,feedbackData:r.feedbackData},stopLoadingUi:!!a,startAugloopTimerForStreaming:!a,workflowAnnotationTypeForAugloopTimer:k.Yn.getTypeName(),addCardToChatHistory:r.addCardToChatHistory},i)},this.updateResponseMarkdownMessageCard=(e,t,a,n,o,r)=>{if((0,T.hX)(e))return(0,T.cY)("ExcelAppSharedStreamHandler: Returning as message is undefined"),void U.B.getInstance().sendChatEventTelemetry((0,N.pN)({[N.h3.ChatEventType]:N.a5.EmptyMessageReceivedFromSydney,[N.h3.ChatEventParameters]:"Empty Markdown message card"}));(0,T.cY)("ExcelAppSharedStreamHandler: Updating Response Card:",e);let i=e;i=i.replace("\\n","\n"),this.paragraphChunks=t?i:this.paragraphChunks+i;const l=A.$.getInstance().getLastMessage(),s=l?.actionBarButtons?.slice()??void 0,c=this.codePreviewProps,d=this.getCustomMarkdownComponents(this.contentOrigin,this.messageId),u=A.$.getInstance().getLastMessage(),m={chatCardType:C._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:this.paragraphChunks,horizontalTableScroll:!0,componentsOverride:d}},chatMessageBodyData:{...(0,J.Cn)({showAIGenerated:!1,showAnimation:!1,footerPosition:y.O.None,references:a&&a.length>0?a:void 0,annotationReferences:n&&n.length>0?n:void 0,actionButtonList:s,msgExtCardProps:o,apiPluginCardProps:r,codePreviewProps:c}),messageId:(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?u?.messageId:void 0},stopLoadingUi:!1,startAugloopTimerForStreaming:!0,workflowAnnotationTypeForAugloopTimer:k.Yn.getTypeName(),addCardToChatHistory:!1};(0,Y.yw9)("OfficeVSO_8923945_UpdateLastMessage")?A.$.getInstance().updateMessage(m):A.$.getInstance().updateLastMessage(m)},this.handleStreamBegin=e=>{(0,T.cY)("ExcelAppSharedStreamHandler: handleStreamBegin"),F.Q.getInstance().recordFluxCopilotStep({operation:N.OP.FluxFirstStreamedToken}),((0,me.pX)()||(0,me.gc)())&&this.contentOrigin!==R.w.GetInsightsName&&this.contentOrigin!==R.w.ChartsAndPivotTablesName&&this.contentOrigin!==R.w.TextAnalysisName&&e(ce.m.clearSuggestionList())},this.streamingCitationHandler=(0,Y.UDM)()?e():void 0}}},89477:(e,t,a)=>{"use strict";a.d(t,{f:()=>i});var n=a(173491),o=a(173339),r=a(516999);class i{getName(){return"WebSSOApiProvider"}async getToken(e,t){return(0,r.Y)((()=>Excel.run({delayForCellEdit:!0},(async()=>(await OfficeFirstPartyAuth.getAccessToken(e,{popup:t})).accessToken))),o.R.getLoadAuthLibraryTimeout())}async getPrimaryIdentityEmail(){return await this.load(),(await OfficeFirstPartyAuth.getPrimaryIdentityInfo()).email}isLoaded(){return this.loaded}async load(){OfficeFirstPartyAuth.authFlow="authcode",0===this.delayMs&&0===OfficeFirstPartyAuth.delay&&(this.delayMs=12e3,OfficeFirstPartyAuth.delay=this.delayMs,OfficeFirstPartyAuth.delayMsal=this.delayMs),await OfficeFirstPartyAuth.load(n.dS),this.loaded=!0}getLoadProps(){return{delayAllowed:this.delayMs}}constructor(){this.delayMs=0,this.loaded=!1}}},94186:(e,t,a)=>{"use strict";a.d(t,{e:()=>p});var n=a(725556),o=a(84206),r=a(678211),i=a(670802),l=a(79458),s=a(267324),c=a(632512),d=a(202051),u=a(977055),m=a(469069),h=a(887648),g=a(208520);function p(e){const{dispatch:t}=(0,h.wA)();return(0,n.jsx)(b,{onError:e=>{e.name=e.message;const a=(0,d.Ix)(c.O.AnswersInteractiveChartRenderingFailed,"Unable to render interactive chart",e);(0,d.QX)(t,a,!1)},onRenderSuccess:()=>{const t=JSON.parse(e.inputChartSchema).data[0].type||"InteractiveChart";(0,u._T)(t)},children:(0,n.jsx)(f,{...e})})}class b extends g.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e){(0,l.cY)("ErrorBoundary caught an error ",e),this.props.onError&&this.props.onError(e)}componentDidMount(){!this.state.hasError&&this.props.onRenderSuccess&&this.props.onRenderSuccess()}render(){return this.state.hasError?this.props.fallback??(0,n.jsx)("p",{children:(0,s.t9X)()}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:void 0}}}function f(e){const{inputChartSchema:t,chartId:a}=e,l=(0,m.j)();let s;if(l){const{registerChartRef:e}=l;s=e(a)}return(0,n.jsx)(r.q,{theme:i.o,style:{backgroundColor:i.o.colorNeutralBackground1},children:(0,n.jsx)(o.X,{chartSchema:{plotlySchema:JSON.parse(t)},componentRef:s})})}},99394:(e,t,a)=>{"use strict";a.d(t,{V:()=>r,z:()=>o});var n=a(207545);const o={...n.zj,CopilotStartPromptCellRow:"CopilotStartPromptCellRow",CopilotStartPromptCellCol:"CopilotStartPromptCellCol",InsightsEndpoint:"InsightsEndpoint",HasActivePythonLicense:"HasActivePythonLicense",CopilotAgentToLoadAfterLaunch:"agentId",CopilotAgentToLoadAfterLaunchLegacy:"AgentId",IsPythonExecutionBlockedByAdmin:"IsPythonExecutionBlockedByAdmin",AutoOpenChatPane:"AutoOpenChatPane",ButtonEnabledForLocalFiles:"ButtonEnabledForLocalFiles",ShouldUseEnvSpecificALUrl:"ShouldUseEnvSpecificALUrl",ExcelSdxPrivateApiEnabled:"ExcelSdxPrivateApiEnabled",CopilotLicenseStatus:"CopilotLicenseStatus"};class r extends n.kH{}},103806:(e,t,a)=>{"use strict";a.d(t,{p:()=>Wt});var n,o=a(267324),r=a(702864),i=a(83437),l=a(328831),s=a(660606);!function(e){e.AutoOpenTTVR="visuallyReady",e.AutoOpenTTFR="functionallyReady"}(n||(n={}));var c="[BizChat Perf]:";function d(e,t,a,o,r){var i=a;(0,s.cY)("".concat(c,": chat load event triggered at ").concat(performance.now()),a);var l=function(e){var t=void 0;switch(null==e?void 0:e.measureType){case"TTVR":t=n.AutoOpenTTVR;break;case"TTFR":t=n.AutoOpenTTFR}return t}(i);if(l)if(u())l===(r?n.AutoOpenTTFR:n.AutoOpenTTVR)&&(Microsoft.Office.WebExtension.Interactive(!0),(0,s.cY)("".concat(c,": Interactive API called with true param")));else if(t){var d=function(e,t,a){var n={MessageId:e,SendTime:void 0!==a?a:Date.now(),Values:{Payload:{type:"CopilotAutoOpen",CopilotTTVRCheckpoint:{ttvrCheckpoint:t},fromBizChat:!0}}};return JSON.stringify(n)}(e,l,i.eventTime);o({type:"CopilotChatTTVRMessage",message:d}),(0,s.cY)("".concat(c,": Perf PostMessage Sent"),d)}else(0,s.cY)("".concat(c,": Skipping post message for non-auto open"));else(0,s.cY)("".concat(c,": Invalid event arg"),i)}function u(){var e,t;return"undefined"!=typeof Microsoft&&"function"==typeof(null===(t=null===(e=null===Microsoft||void 0===Microsoft?void 0:Microsoft.Office)||void 0===e?void 0:e.WebExtension)||void 0===t?void 0:t.Interactive)}var m=a(822606),h=a(241273),g=a(423905),p=a(883),b=a(426689),f=a(480591);function C(e){if(!e)throw new Error("Method name is missing in the invocation");var t=e.indexOf("_");if(-1===t)throw new Error("Namespace is missing in the invocation method name");return e.substring(t+1)}var y,v=a(425903),x=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},T=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},S=function(e){return x(void 0,void 0,void 0,(function(){var t,a,n,o;return T(this,(function(r){return!(t=null===(o=e.localEndpoint)||void 0===o?void 0:o.split("/"))||t.length<3?(a="Invalid localEndpoint format received during local addin execution",(0,v.Xh)(a),[2,{result:a,isSuccess:!1}]):(n=t[2],[2,w(e.payload,n)])}))}))},w=function(e,t){return x(void 0,void 0,void 0,(function(){var a,n,o,r,l,c,d,u,m,h;return T(this,(function(b){switch(b.label){case 0:try{o=function(e){var t;try{t=JSON.parse(e)}catch(e){throw new Error("Failed to parse payload into a IPluginRequest object. \n"+e)}return{id:t.id,method:C(t.method),params:t.params,jsonrpc:t.jsonrpc}}(e),a=o.method,n=o.params}catch(e){return d=e.message,(0,v.Xh)(d),[2,{result:d,isSuccess:!1}]}(null==n?void 0:n["x-metadata"])&&delete n["x-metadata"],r=JSON.stringify(n),s.EG.sendChatEventTelemetry((0,g.pN)(((u={})[i.h3.ChatEventType]=i.a5.LocalAddinExecutionStarted,u[i.h3.ChatEventParameters]=JSON.stringify({titleId:t,methodName:a,stringifiedParams:r}),u))),b.label=1;case 1:return b.trys.push([1,3,,4]),[4,OfficeFirstParty.AddinSkillAction.InvokeAction(t,a,r)];case 2:return l=b.sent(),s.EG.sendChatEventTelemetry((0,g.pN)(((m={})[i.h3.ChatEventType]=i.a5.LocalAddinExecutionCompletedFromHost,m[i.h3.ChatEventParameters]=l,m))),(0,s.cY)("Successfully invoked local add-in plugin action",l),[2,{result:null!=l?l:"",isSuccess:!0}];case 3:return c=b.sent(),d="Failed to invoke local add-in plugin action. Error code is: \n"+(null==c?void 0:c.code)+"\nwith error message: \n"+(null==c?void 0:c.message),(0,p.debuglog)(d),s.EG.sendChatEventTelemetry((0,g.pN)(((h={})[i.h3.ChatEventType]=i.a5.LocalAddinExecutionFailedFromHost,h[i.h3.ChatEventParameters]=d,h))),(0,v.Xh)(d),[2,{result:d,isSuccess:!1}];case 4:return[2]}}))}))},E=a(448514),I=a(308849),R=a(951903),A=a(638753),L=a(755657),k=a(207545),F=a(764081),_=a(448526),P=a(606364),N=a(63919),M=a(477543),O=a(801609),D=a(932367),B=a(754440),$=a(40413),H=a(549768);!function(e){e.getInsights="getInsights",e.getColumnsFromNL="getColumnsFromNL",e.getColumnsGeneral="getColumnsGeneral",e.getConditionalFormatSuggestion="getConditionalFormatSuggestion",e.transformTableFromNL="transformTableFromNL",e.getTableSummary="getTableSummary",e.getCellsFromNL="getCellsFromNL"}(y||(y={}));const U={getInsights:'[\n    {\n        "name": "selectTables",\n        "returns": "activeTables",\n        "arguments": {}\n    },\n    {\n        "name": "getInsights",\n        "returns": null,\n        "arguments": {\n            "tables": {\n                "type": "var",\n                "name": "activeTables"\n            },\n            "instruction": {\n              "type": "string",\n              "string": "{{messageText}}"\n            }\n        }\n    }\n]',getColumnsFromNL:'[\n{\n    "name": "selectTables",\n    "returns": "activeTables",\n    "arguments": {}\n},\n{\n    "name": "addCalculatedColumns",\n    "returns": null,\n    "arguments": {\n        "tables": {\n            "type": "var",\n            "name": "activeTables"\n        },\n        "instruction": {\n            "type": "string",\n            "string": "{{messageText}}"\n        }\n    }\n}\n]',getCellsFromNL:'[\n  {\n      "name": "selectTables",\n      "returns": "activeTables",\n      "arguments": {}\n  },\n  {\n      "name": "aggregateColumns",\n      "returns": null,\n      "arguments": {\n          "tables": {\n              "type": "var",\n              "name": "activeTables"\n          },\n          "instruction": {\n              "type": "string",\n              "string": "{{messageText}}"\n          },\n          "cell": {},\n      }\n  }\n  ]',getColumnsGeneral:'[\n{\n  "name": "selectTables",\n  "returns": "activeTables",\n  "arguments": {}\n},\n{\n  "name": "addCalculatedColumns",\n  "returns": null,\n  "arguments": {\n      "tables": {\n          "type": "var",\n          "name": "activeTables"\n      }\n  }\n}\n]',transformTableFromNL:'[\n{\n  "name": "selectTables",\n  "returns": "activeTables",\n  "arguments": {}\n},\n{\n  "name": "transformTable",\n  "returns": null,\n  "arguments": {\n    "tables": {\n        "type": "var",\n        "name": "activeTables"\n    },\n    "instruction": {\n        "type": "string",\n        "string": "{{messageText}}"\n    }\n}\n}\n]',getTableSummary:'[\n{\n    "name": "selectTables",\n    "returns": "activeTables",\n    "arguments": {}\n},\n{\n    "name": "summarizeTable",\n    "returns": null,\n    "arguments": {\n        "tables": {\n            "type": "var",\n            "name": "activeTables"\n        }\n    }\n}\n]',getConditionalFormatSuggestion:'[\n{\n    "name": "selectTables",\n    "returns": "activeTables",\n    "arguments": {}\n},\n{\n    "name": "conditionalFormatSuggestionPill",\n    "returns": null,\n    "arguments": {\n        "tables": {\n            "type": "var",\n            "name": "activeTables"\n        }\n    }\n}\n]'};var q=a(277718),V=a(742633),G=a(255448),W=a(193920),z=a(881707),j=a(477595),Q=a(365319),J=a(95151),Y=a(97790),X=a(757457),Z=a(965634),K=a(561220),ee=a(54788),te=a(353033),ae=a(632512),ne=a(88994),oe=a(39609),re=a(403025),ie=a(460913),le=a(674940),se=a(507481),ce=a(663280),de=a(832343),ue=a(608899),me=a(791106),he=a(916344),ge=a(680873),pe=a(112134),be=a(262452),fe=a(774370),Ce=a(74704),ye=a(722307),ve=a(998781),xe=a(647347),Te=a(99394),Se=a(737617),we=a(348065),Ee=a(644737),Ie=a(9847),Re=a(4091),Ae=a(84668),Le=a(877825),ke=a(630079),Fe=a(937234),_e=a(875136),Pe=a(167447),Ne=a(198784),Me=a(979155),Oe=a(380049),De=a(697705),Be=a(476730),$e=a(956258),He=a(622807),Ue=a(79458),qe=a(954758),Ve=a(173339),Ge=a(290786),We=a(528804);const ze=[de.yZ.getTypeName(),re.qS.getTypeName(),le.g_.getTypeName(),le.PM.getTypeName(),le.B3.getTypeName(),le.NL.getTypeName(),le.oj.getTypeName(),Ge.Yc.getTypeName()];function je(){const e=[],t={staticStrings:[{key:"formulaError",value:(0,o.Obq)()},{key:"externalWorkbookFormulaError",value:o.olU.ElseExternalWorkbookFormulaError},{key:"securityBlockedFormulaError",value:o.olU.ElseSecurityBlockedFormulaError},{key:"raiError",value:(0,o.KC)()},{key:"fallbackLatencyMessage",value:(0,o.I3c)()},{key:"raiErrorSuccessfulActionBlockedResponse",value:(0,o.b4o)()},{key:"generalError",value:(0,o.UuN)()},...(0,We.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SearchAndActionErrorImproved",!1)?[{key:"searchChainingError",value:(0,o.AUM)()}]:[{key:"searchChainingError",value:(0,o.RVs)()}],{key:"noTableError",value:(0,o.SCL)()},{key:"imageChatChainingError",value:(0,o.sWz)()}]},a=!1;return e.push({workflowAnnotationType:q.Yn.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout(),config:t}),(0,We.KV_)()&&!(0,We.Jym)()&&e.push({workflowAnnotationType:ue.l.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:qe.w.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:Me.Pd.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!0,augloopResponseTimeout:Ve.R.getChatHistoryWorkflowTimeout()}),e.push({workflowAnnotationType:de.yZ.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout(),forceReturnCachedAnnotations:!0,activateAnnotationInALRequestResponse:!!(0,We.NT7)()||void 0}),(0,We.Y$0)()&&e.push({workflowAnnotationType:re.qS.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout(),forceReturnCachedAnnotations:!0,activateAnnotationInALRequestResponse:!!(0,We.NT7)()||void 0}),e.push({workflowAnnotationType:H.lL.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:H.Dv.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),(0,We.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)&&e.push({workflowAnnotationType:H.sG.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),(0,We.eFk)()&&e.push({workflowAnnotationType:le.PM.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()},{workflowAnnotationType:le.B3.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),(0,We.lht)()&&e.push({workflowAnnotationType:le.g_.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()},{workflowAnnotationType:le.NL.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()},{workflowAnnotationType:le.oj.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),((0,We.eFk)()||(0,We.lht)())&&e.push({workflowAnnotationType:le.NU.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),(0,We.UDM)()&&(e.push({workflowAnnotationType:ce.bV.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),(0,We.iPS)("Microsoft.Office.Excel.FA000000124.ImportDataEnableRelevancyCheck",!0)&&e.push({workflowAnnotationType:ce.Dd.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:a,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()})),e.push({workflowAnnotationType:j.b.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!0,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),(0,We.WFw)()&&e.push({workflowAnnotationType:ve.uC.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),e.push({workflowAnnotationType:X.d.getTypeName(),shouldHandleResponse:!0,augloopResponseTimerRequired:!1}),(0,We.jGm)()&&e.push({workflowAnnotationType:ie.f.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1,augloopResponseTimeout:Ve.R.getAugloopWorkflowTimeout()}),(0,We.JZX)()&&e.push({workflowAnnotationType:Ge.Yc.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),((0,We.IU1)()||(0,We.GBi)())&&(e.push({workflowAnnotationType:ge.j5.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:ge.hM.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:ge.OE.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:ge.Ex.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e.push({workflowAnnotationType:ge.Ww.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1})),(0,We.jGm)()&&(0,We.IU1)()&&e.push({workflowAnnotationType:ge.fm.getTypeName(),shouldHandleResponse:!1,augloopResponseTimerRequired:!1}),e}var Qe=a(734e3),Je=a(274483);class Ye{async handleSharedLoggingEvent({event:e,args:t}){switch((0,Ue.cY)("client logging event received\n\tevent - ",e,"\n\targs: ",t),e){case P.Yk.ALSessionInitialized:return this.onALSessionInitialized(t);case P.Yk.AnnotationActivated:return this.onAnnotationActivated(t);case P.Yk.AugloopErrorReceived:return this.onAugloopErrorReceived(t);case P.Yk.ChatHistorySignalSent:return this.onChatHistorySignalSent(t);case P.Yk.ChatHistoryResponseReceived:return this.onChatHistoryResponseReceived(t);case P.Yk.ChatPaneInitalized:return this.onChatPaneInitialized(t);case P.Yk.ChatPaneLoaded:return this.onChatPaneLoaded(t);case P.Yk.CopyButtonClicked:return this.onCopyButtonClicked(t);case P.Yk.SubmitButtonClicked:return this.onSubmitButtonClicked(t);case P.Yk.MenuButtonItemClicked:return this.onMenuButtonItemClicked({event:e,args:t});case P.Yk.SuggestionPillClicked:return this.onSuggestionPillClicked(t);case P.Yk.ZQMLoaded:return this.onZQMLoaded({event:e,args:t});case P.Yk.ZQMButtonItemClicked:return this.onZQMButtonItemClicked({event:e,args:t});default:return this.defaultCallback({event:e,args:t})}}defaultCallback(e){this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.SharedCopilotChatLogEvent,[Ie.h3.ChatEventParameters]:JSON.stringify(e)},this.telemetryLogger)}onChatPaneInitialized(e){this.copilotChatBootStartTime=e?.timestamp??Date.now()}onAugloopErrorReceived(e){const t=JSON.parse(e?.chatEventParams??"{}");this.telemetryLogger.logError({eventType:Z.S2.Augloop,logLevel:i.$b.Warning,errorMessage:`Augloop Error: code - ${t?.errorCode}`},this.telemetryLogger.getDefaultEventFlags())}onALSessionInitialized(e){const t=this.getDurationInSeconds(this.copilotChatBootStartTime,void 0,e?.timeInMs);this.telemetryEventHandler.updateTelemetryLatencyData({[Ie.CT.AugloopInitializationTime]:t},this.telemetryLogger)}onAnnotationActivated(e){const t=this.getDurationInSeconds(this.copilotChatBootStartTime,void 0,e?.timeInMs);this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.AnnotationActivated,[Ie.h3.ChatEventParameters]:JSON.stringify({activeAnnotations:this.getActiveAnnotationTypes()})},this.telemetryLogger),this.telemetryEventHandler.updateTelemetryLatencyData({[Ie.CT.AnnotationActivationTime]:t},this.telemetryLogger)}onChatHistorySignalSent(e){e&&e.operationType===Oe.S5.GetCurrentChatOperation&&(this.chatHistorySignalTime=e.timestamp??Date.now())}onChatHistoryResponseReceived(e){if(!e||e.operationType!==Oe.S5.GetCurrentChatOperation)return;const t=this.getDurationInSeconds(this.chatHistorySignalTime,void 0,e?.timeInMs);this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.ChatHistoryLoaded},this.telemetryLogger),this.telemetryEventHandler.updateTelemetryLatencyData({[Ie.CT.ChatHistoryLoadTime]:t},this.telemetryLogger)}onChatPaneLoaded(e){const t=this.getDurationInSeconds(this.copilotChatBootStartTime,e?.timestamp);this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.ChatPaneLoaded,[Ie.h3.ChatEventParameters]:JSON.stringify({copilotEntryPoint:Te.V.getSettingAsString(Te.z.CopilotEntryPoint)})},this.telemetryLogger),this.telemetryEventHandler.updateTelemetryLatencyData({[Ie.CT.ChatPaneLoadTime]:t},this.telemetryLogger)}onCopyButtonClicked(e){this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.CopyButtonClicked},this.telemetryLogger)}onSubmitButtonClicked(e){this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.SubmitButtonClicked},this.telemetryLogger)}static handleZqmLoadedLoggingEvent(e){const t=(0,Qe.dW)(),a=(0,Qe.eD)();for(const n of e?.promptSuggestionList??[])switch(n.suggestionText){case t[He.fM.Search]:De.B.getInstance().logSeenEvent(Ie.q.Search);break;case t[He.fM.FormulaAction]:case a[He.X6.SuggestColumn]:case a[He.X6.WriteFormula]:case a[He.X6.AddFormulaColumn]:case a[He.X6.SplitColumns]:case a[He.X6.LookupFormula]:De.B.getInstance().logSeenEvent(Ie.q.CalculatedColumns);break;case a[He.X6.TotalRow]:De.B.getInstance().logSeenEvent(Ie.q.CalculatedRows);break;case t[He.fM.HowToSum]:case a[He.X6.ExplainFormula]:case a[He.X6.InvestigateError]:case a[He.X6.CreateTable]:case a[He.X6.KeyboardShortcuts]:case a[He.X6.TipsAndTricks]:case a[He.X6.FreezeColumn]:case a[He.X6.HowToCreateDropdown]:(0,Je.mN)();break;case a[He.X6.GetDataInsights]:case a[He.X6.PerformForecasting]:case a[He.X6.CreateBoxplot]:case a[He.X6.SetOfCharts]:case a[He.X6.GenerateWordCloud]:De.B.getInstance().logSeenEvent(Ie.q.Answers);break;case t[He.fM.Python]:case a[He.X6.AdvancedAnalysis]:{let e=Ie.q.Python;if((0,We.ggM)()&&(e=Ie.q.Answers),(0,We.yw9)("OfficeVSO_10385590_addSubFeatureNameForAnswers")){let t=Ie.BJ.Python;(0,We.ggM)()&&(t=Ie.BJ.Answers),De.B.getInstance().logSeenEvent(t,e)}else De.B.getInstance().logSeenEvent(e);break}case a[He.X6.DataPreparation]:De.B.getInstance().logSeenEvent(Ie.q.DataShaping);break;case t[He.fM.Insights]:case a[He.X6.SummarizeColumn]:case a[He.X6.ShowDataInsights]:case a[He.X6.CreatePivotTable]:case a[He.X6.CreatePieChart]:case a[He.X6.GenerateGraph]:De.B.getInstance().logSeenEvent(Ie.q.AnalyzeData);break;case t[He.fM.HighlightAction]:case a[He.X6.HighlightCells]:case a[He.X6.ApplyColorCoding]:De.B.getInstance().logSeenEvent((0,We.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?Ie.q.ConditionalFormatting:Ie.q.Commanding);break;case a[He.X6.WebSearchCreateTable]:case a[He.X6.WebSearchLearn]:case a[He.X6.ImportTable]:case a[He.X6.PrepareForMeetings]:De.B.getInstance().logSeenEvent(Ie.q.Search);break;default:De.B.getInstance().logSeenEvent(Ie.q.CopilotChat)}}sendLoggingEventToPane(e,t){switch(this.telemetryLogger||(this.telemetryLogger=$e.M.getInstance()),e){case P.Yk.ZQMLoaded:(0,Ue.cY)("ZQM Loaded: ${loggingEventArgs}"),Ye.handleZqmLoadedLoggingEvent(this.zeroQueryMessageProps);break;case P.Yk.MenuButtonItemClicked:(0,Ue.cY)(`Menu Button Item Clicked: ${t}`)}}onZQMButtonItemClicked({event:e,args:t}){this.telemetryLogger.setQuerySource(Ie.BC.ZQM),De.B.getInstance().setQuerySource(Ie.BC.ZQM),this.defaultCallback({event:e,args:t})}onZQMLoaded({event:e,args:t}){this.sendLoggingEventToPane(e,t)}onMenuButtonItemClicked({event:e,args:t}){this.telemetryLogger.setQuerySource(Ie.BC.MenuItem),De.B.getInstance().setQuerySource(Ie.BC.MenuItem),this.sendLoggingEventToPane(e,t)}onSuggestionPillClicked(e){this.telemetryLogger.setQuerySource(Ie.BC.SuggestionPill),De.B.getInstance().setQuerySource(Ie.BC.SuggestionPill),this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.BasicChatSuggestionClicked},this.telemetryLogger)}getDurationInSeconds(e,t,a){return a?this.toSeconds(a):this.toSeconds((t??Date.now())-e)}toSeconds(e){return e/1e3}getActiveAnnotationTypes(){return je().map((e=>e.workflowAnnotationType))}constructor(e){this.telemetryLogger=$e.M.getInstance(),this.telemetryEventHandler=Be.E.getInstance(),this.copilotChatBootStartTime=0,this.chatHistorySignalTime=0,this.zeroQueryMessageProps={promptSuggestionList:[]},this.zeroQueryMessageProps=(0,Qe.uC)(e)}}var Xe=a(888405),Ze=a(553373),Ke=a(200828),et=a(797639);class tt{getIsWorkflowInProgress(){return void 0!==this.workflowStartTime}getShouldAlertUser(){return this.getIsWorkflowInProgress()&&!this.hasAlertedUserForThisWorkflowRun&&!et.CP.pythonContextManager.isPythonMode}setWorkflowStarted(){this.workflowStartTime=(new Date).getTime()}setWorkflowEnded(){this.workflowEndTime=(new Date).getTime(),this.workflowStartTime&&this.telemetryEventHandler.logLatency((0,E.x)(this.workflowStartTime),Ie.OP.XLIMWorkflowDuration),this.lastUserSubmitWhileWorkflowRunningTime&&this.telemetryEventHandler.logLatency((0,E.x)(this.lastUserSubmitWhileWorkflowRunningTime),Ie.OP.SubmitToXLIMWorkflowComplete),this.reset()}handleQuerySubmittedWhileWorkflowRunning(){this.lastUserSubmitWhileWorkflowRunningTime=(new Date).getTime(),this.hasAlertedUserForThisWorkflowRun=!0}handleRecognizedTableAnnotationsReceived(){this.workflowEndTime&&this.telemetryEventHandler.logLatency((0,E.x)(this.workflowEndTime),Ie.OP.XLIMWorkflowCompleteToAnnotationsReceived)}reset(){this.workflowStartTime=void 0,this.lastUserSubmitWhileWorkflowRunningTime=void 0,this.hasAlertedUserForThisWorkflowRun=!1}constructor(){this.telemetryEventHandler=Be.E.getInstance(),this.workflowStartTime=void 0,this.workflowEndTime=void 0,this.lastUserSubmitWhileWorkflowRunningTime=void 0,this.hasAlertedUserForThisWorkflowRun=!1}}tt.XLIMProgressFlowId="XLIMProgressFlow";var at=a(235373),nt=a(47262),ot=a(912477),rt=a(108869),it=a(202051),lt=a(119202),st=a(185610),ct=a(804672),dt=a(370477),ut=a(322271),mt=a(627603),ht=a(39251),gt=a(495501),pt=a(507628);async function bt(e,t){const a=(0,pt.A)(),n=(0,pt.A)();if(!t)return await async function(e,t,a,n){const r={success:!1,sessionId:n,errorSource:t,errorCode:a};try{let t=e((0,Re.SW)()).started?(0,o.$oZ)():(0,o.A99)();switch(a){case"QueryTable":t=(0,o.bLM)();break;case"StepFromNLFailure":case"QueryFromNLFailure":case"QueryFromNLGiveup":t=(0,o.kSh)();break;case"NoRange":case"TableNotFound":t=(0,o.eMD)();break;case"PowerQueryApiFailure":case"ExplanationFailure":case"BaseQueryFailure":case"UnexpectedError":break;default:(0,ht.x)(a)}(0,Ue.cY)(`showDataShapingErrorMessage: ${t}`),await be.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.showErrorMessage(t),r.success=!0}finally{Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.DataShapingShowErrorCard,[Ie.h3.ChatEventParameters]:JSON.stringify(r)},$e.M.getInstance())}}(e,"EnterMode","TableNotFound"),void(0,lt.vo)();const r={success:!1,requestId:n,sessionId:a},l=be.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value;try{(0,Ue.cY)("enterShapingModeForDA called with tableName:",t);const i=await Wt.getInstance().getALSession();if((0,We.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ExcelDataShapingWorkflowContext",!1)){const e=new M.g0({parentPath:["Signal",ut.Lg.getTypeName()],items:[{id:n,body:new ut.Lg({requestId:n,conversationId:(0,pt.A)(),tableId:t,dataShapingSessionId:a,enableDebugging:(0,Ue.K_)()})}]});i.submitOperation(e)}const s={annotationType:[le.oj.getTypeName(),le.NL.getTypeName()],transientItems:[{parentPath:["Signal",ut.Lg.getTypeName()],id:ke.r.generateId(),body:new ut.Lg({requestId:n,conversationId:(0,pt.A)(),tableId:t,dataShapingSessionId:a,enableDebugging:(0,Ue.K_)()})}],maxDelayMs:3e4,sourceInfo:{}},c=i.getAnnotations(s),d=await async function(e){for await(const t of e){if(t.error?.clientError||t.error?.workflowError||t.error?.serviceError||t.error?.serverError)throw new Error(`getFirstShapingStartAnnotation: Client error: ${t.error.clientError}, Workflow error: ${t.error.workflowError}, Service error: ${t.error.serviceError}, Server error: ${t.error.serverError}`);if(!(t.content.length<=0)&&t.content[0].body&&(le.NL.typeGuard(t.content[0].body)||le.oj.typeGuard(t.content[0].body)))return t.content[0].body}throw new Error("getFirstShapingStartAnnotation: No annotations found.")}(c);if(le.NL.typeGuard(d))throw new Error("Failed to start data shaping mode.");{const t={requestId:n,sessionId:d.dataShapingSessionId,queryName:d.queryName,mashupDocument:d.mashupDocument,tableName:d.tableId,queryScript:d.queryScript};e(at.m.enterDataShapingMode(t)),async function(e,t){const a=be.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,n=a.onQueryScriptChanged.subscribe((async a=>{const n={started:!1,disableQueryScriptUpdates:!1,requestId:t.requestId,sessionId:t.sessionId};try{const o=e((0,Re.SW)());if(n.started=o.started,!o.started)return;const r=new M.g0({parentPath:["Signal",ut.U$.getTypeName()],items:[{id:t.requestId,body:new ut.U$({requestId:t.requestId,conversationId:t.requestId,queryScript:a,enableDebugging:(0,Ue.K_)()})}]});(await Wt.getInstance().getALSession()).submitOperation(r),(0,Ee.s_)(Ee.H0.DisableUndo)}finally{Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.DataShapingQueryScriptChanged,[Ie.h3.ChatEventParameters]:JSON.stringify(n)},$e.M.getInstance())}})),r=a.onPreviewClosed.subscribe((async i=>{const l={reason:i,requestId:t.requestId,sessionId:t.sessionId};try{"FAILURE"!==i&&"ERROR"!==i||(await Ct(e,i,!0,"Discard"),a.showErrorMessage((0,o.y3x)()))}finally{try{n.unsubscribe(),r.unsubscribe()}catch{}Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.DataShapingPreviewClosed,[Ie.h3.ChatEventParameters]:JSON.stringify(l)},$e.M.getInstance())}}));await a.startPreview(t.queryName,t.mashupDocument,t.tableName);const i=JSON.stringify({queryScript:t.queryScript});gt.n.displayDataShapingIntroResponse(i,t.requestId)}(e,t),(0,We.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ExcelDataShapingClientStore",!1)||await i.activateServerRequestResponse(le.ik.getTypeName(),{onAnnotationCallback:async(t,a)=>{let n;const o={success:!1,started:!1,sessionId:""};try{try{const a=e((0,Re.SW)());o.started=a.started,a.started&&(o.sessionId=a.sessionId),await l.updateQueryScript(t.queryScript);const r=await l.getQueryScript();n={dataShapingSessionId:t.dataShapingSessionId,success:!0,actualQueryScriptOrError:r},o.success=!0}catch(e){n={dataShapingSessionId:t.dataShapingSessionId,success:!1,actualQueryScriptOrError:e.message}}await a(new le.vH(n))}finally{Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.DataShapingEditQuery,[Ie.h3.ChatEventParameters]:JSON.stringify(o)},$e.M.getInstance())}}}),r.success=!0}}catch(t){$e.M.getInstance().logError({eventType:Z.S2.DataShaping,errorMessage:`got error during handling start mode: ${t} (${JSON.stringify(t)})`,logLevel:i.$b.Error}),await l.showErrorMessage((0,o.A99)()),await Ct(e,"ERROR",!0,"Discard")}finally{Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.DataShapingAgentStartMode,[Ie.h3.ChatEventParameters]:JSON.stringify(r)},$e.M.getInstance())}}async function ft(e,t,a){let n="DECLINE";const r={success:!1,exitModeError:!1,started:!1,sessionId:"",exitReason:a};try{const l=e((0,Re.SW)());let s;switch(r.started=l.started,l.started&&(r.sessionId=l.sessionId),a){case"ReplaceTable":s="replace";break;case"NewSheet":s="newSheet";break;default:s="discard"}const c=be.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value;try{n=(await(0,mt.ci)(e,s)).reason,r.success=!0}catch(e){r.exitModeError=!0,await c.showErrorMessage((0,o.qmi)()),n="ERROR",$e.M.getInstance().logError({eventType:Z.S2.DataShaping,errorMessage:`Failed to apply exit mode action: ${s}, ${e} (${JSON.stringify(e)})`,logLevel:i.$b.Error})}finally{await Ct(e,n,t,a)}}catch(e){r.exitModeError=!0,$e.M.getInstance().logError({eventType:Z.S2.DataShaping,errorMessage:`got error during handling exit mode: ${e} (${JSON.stringify(e)})`,logLevel:i.$b.Error})}finally{Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.DataShapingAgentEndMode,[Ie.h3.ChatEventParameters]:JSON.stringify(r)},$e.M.getInstance())}}async function Ct(e,t,a,n){(0,Ue.cY)("exitMode called with kind:",n," and reason:",t),e(at.m.exitDataShapingMode()),a&&(0,lt.vo)();const o=be.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value;await o.endPreview("FAILURE"===t?"ERROR":t);const r=(0,pt.A)(),i=new M.g0({parentPath:["Signal",ut.h2.getTypeName()],items:[{id:r,body:new ut.h2({requestId:r,conversationId:r,kind:n??"Discard",enableDebugging:(0,Ue.K_)()})}]});(await Wt.getInstance().getALSession()).submitOperation(i)}var yt=a(565874),vt=a(449650);function xt(e,t){return new de.pW({worksheetId:t,left:e.topLeft.column??0,top:e.topLeft.row??0,right:e.bottomRight.column??0,bottom:e.bottomRight.row??0})}var Tt=a(494554);var St=a(272487),wt=a(940096);var Et=a(906606);var It=a(522667),Rt=a(991869),At=a(371623),Lt=a(295767);var kt=a(512238),Ft=a(479504);var _t=a(53113),Pt=a(233488),Nt=a(977055),Mt=a(936044),Ot=a(547131),Dt=a(48093),Bt=a(15536),$t=a(389298);const Ht=JSON.parse('{"UU":"sdx_copilotchatexcel","rE":"9.58.16"}');var Ut=a(837542).hp;function qt(e){return void 0!==e?.eventName&&void 0!==e?.promptProperties}const Vt="externalDisplayMessages";const Gt={"flux-chartsAndPivotTables":"charts_and_pivot_tables","flux-textAnalysis":"text_analysis","flux-createCalculatedColumns":"calculated_columns;create_columns","flux-editDocument":"edit_document","flux-dataShaping":"data_shaping","flux-createCalculatedCell":"calculated_columns;aggregate","flux-pythonAda":"get_python_code","flux-pythonCalculatedColumns":"python_calculated_columns","flux-importData":"import_data","flux-else":"excel_else","flux-startAnalysisMode":"start_analysis_mode","flux-answers":"answers"};class Wt extends J.CopilotCommunicationHandler{get isModelWorkflowSupported(){return!this.sessionRestartedDueToModelWorkflowNotSupported}static init(e,t,a){Wt.instance=new Wt(e,t,a)}static getInstance(){return Wt.instance}getQueryOriginValue(){return this.queryOrigin}shouldShowPythonAASuggestions(){return this.showPythonAASuggestions}setSuggestionList(e){e.forEach((e=>{const t=(0,Ke.e)(e.suggestionType);t&&(De.B.getInstance().logSeenEvent(t),this.suggestionPillShown.has(e.suggestionType)||(this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.SuggestionPaneSuggestionShown,[Ie.h3.ChatEventParameters]:e.suggestionType},this.telemetryLogger),this.suggestionPillShown.add(e.suggestionType)))})),this.suggestionList=e}setZqmSuggestionList(e){const t=(0,Qe.uC)(e);Ye.handleZqmLoadedLoggingEvent(t)}set cannedOption(e){Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.SkillOverride,[Ie.h3.ChatEventParameters]:`[{"skillOverride": ${e}]`},this.telemetryLogger),this._cannedOption=e}get cannedOption(){return this._cannedOption}setZeroQueryMessageTitles(e){this.zeroQueryMessageTitles=e}sendResponseToClient(e,t,a){if(e.body?.H_){switch(e.body.H_.T_){case q.jR.getTypeName():case q.Yn.getTypeName():this.responseHandler.handleResponse(e);break;case de.yZ.getTypeName():this.onExcelTableRecognitionAnnotationResult(e,a);break;case re.qS.getTypeName():this.onExcelBlobRangeAnnotationResult(e,a);break;case Ge.Yc.getTypeName():this.onWorkflowProgressAnnotationResult(e);break;case Me.tP.getTypeName():(0,Ue.cY)("Received SharedCopilotChatHistoryAnnotation, not handled yet");break;case H.lL.getTypeName():case H.Dv.getTypeName():case H.sG.getTypeName():(H.lL.typeGuard(e.body)||H.Dv.typeGuard(e.body)||H.sG.typeGuard(e.body))&&(0,_t.UN)(this.store.dispatch,e.body);break;case le.NU.getTypeName():(0,Mt.o)(e,e.body.requestId);break;case ce.bV.getTypeName():(0,We.yw9)("OfficeVSO_9523129_refactorCitationSignalAwait")?(0,Mt.o)(e,e.body.requestId):(0,Ze.bn)(e);break;case ce.Dd.getTypeName():(0,We.yw9)("OfficeVSO_9523129_refactorCitationSignalAwait")?(0,Mt.o)(e,e.body.requestId):(0,Ze.RD)(e);break;case j.b.getTypeName():this.onConditionalFormattingSuggestionAnnotationResult(e);break;case ie.f.getTypeName():this.onExcelChartStylesAnnotationResult(e);break;case ve.uC.getTypeName():se.Y.getInstance().handleHandoffMessage(e,t,!1,this.copilotChatUIHelper?.getCopilotRef());break;case ge.j5.getTypeName():((0,We.IU1)()||(0,We.GBi)())&&(0,Mt.o)(e,e.body.requestId);break;case ge.hM.getTypeName():(0,We.t9T)()||(0,Mt.o)(e,e.body.requestId);break;case ue.l.getTypeName():(0,We.KV_)()&&!(0,We.Jym)()&&this.onExcelRunScriptAnnotation(e);break;case ge.fm.getTypeName():(0,We.jGm)()&&(0,We.IU1)()&&(0,Mt.o)(e,e.body.requestId);break;case ge.OE.getTypeName():(0,We.t9T)()||this.onExcelScratchpadStartSnapshotAnnotation(e);break;case ge.Ex.getTypeName():(0,We.t9T)()||this.onExcelScratchpadExecuteScriptInClientAnnotation(e);break;default:(0,Ue.cY)("sendResponseToClient: No matching annotation found")}if(e.body.H_.T_!==q.Yn.getTypeName()&&e.body.H_.T_!==q.jR.getTypeName()){const t=e.body,a=t?.queryId,n=t?.contentOriginInformationalOnly;ot.MK.augloopResponseReceived(a,n,t)}}}updateCopilotState(e){(0,Ue.cY)(`updateCopilotState: ${e}`),e===P.SG.QUERY_SUBMITTED&&((0,We.UxI)()&&r.xP.getCurrentAddinState()===r.aB.ShowButton&&((0,Ee.s_)(Ee.H0.RemoveUndo),De.B.getInstance().sendChatEventTelemetry((0,Ie.pN)({[Ie.h3.ChatEventType]:i.a5.UndoButtonHiddenOnSubmittingQueryAfterAddinSuccess})),r.xP.transitionAddinState(r.aB.Idle)),(0,We.yw9)("OfficeVSO_10216180_logTriedWhenQueryIsEntered")||this.telemetryLogger.startTriedActivity()),(0,We.yw9)("OfficeVSO_10216180_logTriedWhenQueryIsEntered")&&e===P.SG.QUERY_ENTERED&&this.telemetryLogger.startTriedActivity()}sendLoggingEventToClient(e,t){this.loggingEventHelper.handleSharedLoggingEvent({event:e,args:t}).catch((t=>{$e.M.getInstance().logError({eventType:Z.S2.ChatEvents,logLevel:i.$b.Warning,errorMessage:`Failed to log share copilot logging event; ${{event:e,error:t?.message}}`},this.telemetryLogger.getDefaultEventFlags())}))}isFeatureGateEnabledFromClient(e){switch(e){case N.WT.SkipHydrateEnabled:return!(0,We.yw9)("OfficeVSO_8996286_reenablingRehydration");case N.WT.HydratedMessagesSquashingEnabled:return(0,We.yw9)("OfficeVSO_8996286_reenablingRehydration");case N.WT.IsApplyClpFromHydratedMessagedEnabled:return(0,We._bw)();case N.WT.EnableRestrictiveSearchBanner:case N.WT.IsPersistanceInPhase2UxEnabled:return(0,We.vIj)()&&(0,We.Dl1)();case N.WT.IsSharedCopilotLabEnabled:return!0;case N.WT.IsWebSearchDefaultOn:return(0,We.iPS)("Microsoft.Office.Excel.FA000000124.IsWebSearchDefaultOn",!0)&&(0,We.vIj)();case N.WT.EnableSendTenantFeedback:return(0,We.REo)();case N.WT.ExtractContentFromCardForFeedback:return!(0,Ft.OK)()||(0,We.iPS)(`Microsoft.Office.Excel.FA000000124.${e}`,!1);default:return(0,We.iPS)(`Microsoft.Office.Excel.FA000000124.${e}`,!1)}}getWorkflowsToRegister(){(0,Ue.cY)("registering workflows"),(0,Ue.cY)(`session restarted due to model workflows not supported: ${this.sessionRestartedDueToModelWorkflowNotSupported}`),(0,We.yw9)("OfficeVSO_8772262_updateAugloopModelStatusOnAppState2")&&(this.responseHandler.setAugloopModelWorkflowUnsupported(this.sessionRestartedDueToModelWorkflowNotSupported),this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.AugLoopSessionModelWorkflowUnsupported,[Ie.h3.ChatEventParameters]:JSON.stringify({modelWorkflowNotSupported:this.sessionRestartedDueToModelWorkflowNotSupported})},this.telemetryLogger));const e=function(e){const t=je();return e?t.filter((e=>!ze.includes(e.workflowAnnotationType))):t}(this.sessionRestartedDueToModelWorkflowNotSupported);return e}async sendEventToClient(e,t){switch((0,Ue.cY)(`sendEventToClient - event: ${e}`,{eventArgs:t}),t&&this.debugEvents.dispatchEvent(new CustomEvent(String(e),{detail:t})),e){case P.PV.AugloopResponseTimeout:(0,Ue.cY)("AUGLOOP_RESPONSE_TIMEOUT:",{eventArgs:t}),this.handleAugloopResponseTimeout(t.workflowAnnotationType);break;case P.PV.AnnotationActivated:if((0,Ue.cY)(`Annotation Activated: ${t.workflowAnnotationType}`),t.workflowAnnotationType===ve.uC.getTypeName()){const e=se.Y.getInstance().getDocumentHandoffMessageId();se.Y.getInstance().sendHandoffMessageId(xe.Q.GET,e)}break;case P.PV.StopGeneratingButtonClicked:(0,Ue.cY)("Stop Generating Button Clicked:",{eventArgs:t}),this.handleStopButtonOnClick();break;case P.PV.CopilotChatLoaded:if(t&&t){const e=t.gptId;(0,Ue.cY)(`Current Selected Copilot Extension Id: ${e}`),(0,l.P7)(e??"")}if(Q.$.getInstance().clearLoadingPaneTimeout(),(0,Ue.cY)("Copilot Chat Loaded:",{eventArgs:t}),(0,ct.sZ)(),De.B.getInstance().logTelemetryForSharedChatPaneLoad(),(0,Ne.J)("CopilotChatLoaded"),u()&&(Microsoft.Office.WebExtension.Interactive(!0),(0,s.cY)("".concat(c,": Interactive API called with true param"))),this.resetExternalQuerySubmitted(),await this.handleStartQuery(),this.logExternalQuerySubmitted(),(0,We.yw9)("OfficeVSO_9113126_copilotchatrefnulltimeoutfix")&&(0,Rt.C6)()){const{message:e,telemetry:t}=gt.n.getLanguageUnavailableResponse();Q.$.getInstance().displayResponse(e,t)}if(!(0,We.UW0)()&&Te.V.IsSettingTrue(Te.z.ExcelSdxPrivateApiEnabled)&&(void 0===(0,St.getPreloadCopilot)()||(0,St.getPreloadCopilot)()&&((0,St.getHasPreloadedCopilotBeenShown)()||!(0,We.K5)()))&&this.attachPrivateApiHandlers(),(0,We.yw9)("OfficeVSO_10152794_CopilotCanvasHandoffEnabled")&&await se.Y.getInstance().handleHandoffMessageHostAppSettings(),(0,We.afi)()){let e=Te.V.getSetting(Te.z.CopilotAgentToLoadAfterLaunch);e||(e=Te.V.getSetting(Te.z.CopilotAgentToLoadAfterLaunchLegacy)),(0,Ue.cY)("Chat Loaded: Switch to Agent Post Load with AgentId: ",e),e&&e!==m.u1&&(Te.V.set(Te.z.CopilotAgentToLoadAfterLaunch,m.u1),Te.V.set(Te.z.CopilotAgentToLoadAfterLaunchLegacy,m.u1),this.handleCopilotAgentFromHostRequest({actionType:h.At.Activated,titleId:e}))}this.setCopilotChatLoadedState(!0);break;case P.PV.BizChatNativeLoaded:{const e=t;d("ExcelCopilotMessage",Te.V.IsSettingTrue(Te.z.AutoOpenChatPane),e,(e=>(0,Ne.J)(e.type,e.message)),(0,We.Qq4)()),(0,We.Ak0)()&&"TTVR"===e?.measureType&&De.B.getInstance().logTelemetryForSharedChatPaneLoad();break}case P.PV.CopilotChatOnAppRenderSuccess:if(!(0,We.P5X)())break;a=e=>(0,Ne.J)(e.type,e.message),n={MessageId:"ExcelCopilotMessage",SendTime:Date.now(),Values:{Payload:{mark:"dismiss"}}},r=JSON.stringify(n),a({type:"CopilotChatShimmerMessage",message:r}),(0,s.cY)("".concat(c,": Hide Shimmer PostMessage Sent"),r);break;case P.PV.BasicChatSuggestionPills:(0,Ue.cY)("SuggestionPills event triggered:",{eventArgs:t});break;case P.PV.CitationLinkClicked:(0,Ue.cY)("Citation Link Clicked:",{eventArgs:t});break;case P.PV.ChatTopicChanged:(0,Ue.cY)("Chat Topic Changed:",{eventArgs:t}),this.handleChangeTopicButtonOnClick();break;case P.PV.ChatHistoryHydrationFailed:(0,Ue.cY)("Chat History Hydration Failed:",{eventArgs:t});break;case P.PV.BasicChatStatus:(0,Ue.cY)("Basic Chat Status:",{eventArgs:t});break;case P.PV.QuerySubmitted:(0,Ue.cY)("Query Submitted:",{eventArgs:t});break;case P.PV.ResetContextId:(0,Ue.cY)("Reset Context Id:",{eventArgs:t});break;case P.PV.PluginsStateUpdated:{(0,Ue.cY)("Plugin state updated",{eventArgs:t});let e;if((0,We.vIj)()&&!(0,We.oJj)()&&((0,We.HSC)()||!(0,We.ULj)())){const a=t;e=a.pluginsInfo.findIndex((e=>e&&e.id===o.VMi&&e.state===o.hiv))>=0,e&&((0,Dt.LA)(!0),this.setEnterpriseSearchIsEnabled&&this.setEnterpriseSearchIsEnabled(!0),(0,Ue.cY)("ExcelCopilotChat: Enterprise search is enabled by default"));const n=a.pluginsInfo.findIndex((e=>e&&e.id===o.AF5&&e.state===o.hiv&&e.isEnabled))>=0;(0,Dt.u$)(n)}this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.GroundingSourceUpdated,[Ie.h3.ChatEventParameters]:"Work:Auto"+(e?"On":"Off")});break}case P.PV.UpdateChatClpFromChatHistory:{(0,Ue.cY)("Update Chat Clp From Chat History:",{eventArgs:t});const e=t?.messagesClpLabels,a=await z.n.getInstance().updateSdxSensitiveLabelFromChatHistory(e);this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.ClpLabelUpdateFromChatHistory,[Ie.h3.ChatEventParameters]:"result: "+a},this.telemetryLogger);break}case P.PV.PythonExitAnalysisButtonClicked:(0,Ue.cY)("Python Exit Analysis:",{eventArgs:t}),(0,rt.Tk)();break;case P.PV.SharedHeaderRendered:window.StaticHeaderLoadTime||(0,lt.hC)(),(0,Ue.cY)("Shared Header Rendered:",{eventArgs:t});break;case P.PV.QueryEndOnGptSwitch:(0,Ue.cY)("Query End On Gpt Switch:",{eventArgs:t}),this.handleStopQueryWhenGptSwitched();break;case P.PV.NewChatButtonClicked:(0,Ue.cY)("New Chat Button Clicked:",{eventArgs:t}),(0,We.yw9)("OfficeVSO_9717706_ExitPythonModeOnNewChat")&&et.CP.pythonContextManager.isPythonMode&&(0,rt.Tk)();break;case P.PV.DifferentChatOpened:(0,Ue.cY)("Different Chat Opened:",{eventArgs:t}),(0,We.yw9)("OfficeVSO_9717706_ExitPythonModeOnNewChat")&&et.CP.pythonContextManager.isPythonMode&&(0,rt.Tk)();break;case P.PV.CreateNewConversationButtonClicked:(0,Ue.cY)("Create New Conversation Button Clicked:",{eventArgs:t});break;case P.PV.LowOnCredits:(0,Ue.cY)("Low on credits:",{eventArgs:t});break;case P.PV.OutOfCredits:(0,Ue.cY)("Out of credits:",{eventArgs:t});break;case P.PV.CreditsNotAvailable:(0,Ue.cY)("Credits not available:",{eventArgs:t});break;case P.PV.StartNewChatCalled:(0,Ue.cY)("Start New Chat Called:",{eventArgs:t});break;case P.PV.AddInLocalPluginActionInvoked:case P.PV.AddInLocalPluginActionsInvoked:(0,Ue.cY)("AddInLocalPluginActionInvoked:",{eventArgs:t});!function(e,t,a,n){x(void 0,void 0,void 0,(function(){var o,r,l,c,d,u,m,h,C,y,x,w,E,I,R,A,L,k;return T(this,(function(T){switch(T.label){case 0:return[4,null==t?void 0:t()];case 1:T.sent(),o=[],r=!0,l=null!==f.jX&&void 0!==f.jX?f.jX:0,T.label=2;case 2:return T.trys.push([2,16,,19]),e.skillRequest?((0,g.pN)(((R={})[i.h3.ChatEventType]=i.a5.LocalAddinExecutionReceivedSingleRequest,R)),[4,S(e.skillRequest)]):[3,4];case 3:return c=T.sent(),C=c.result,y=c.isSuccess,o=[(0,v.SL)(C)],r=y,[3,12];case 4:if(!(e.skillRequests&&e.skillRequests.length>0))return[3,9];(0,g.pN)(((A={})[i.h3.ChatEventType]=i.a5.LocalAddinExecutionReceivedMultipleRequests,A)),d=0,u=e.skillRequests,T.label=5;case 5:return d<u.length?(m=u[d],[4,S(m)]):[3,8];case 6:if(h=T.sent(),C=h.result,y=h.isSuccess,o.push((0,v.SL)(C)),!y)return r=!1,[3,8];T.label=7;case 7:return d++,[3,5];case 8:return[3,12];case 9:return E="No skillRequest or skillRequests provided for local addin execution",(0,v.Xh)(E),[4,null==a?void 0:a()];case 10:return T.sent(),[4,(0,v.q1)(n)];case 11:return T.sent(),x={result:[(0,v.SL)(E)]},e.callback(x),[2];case 12:return[4,null==a?void 0:a()];case 13:return T.sent(),r?[3,15]:[4,(0,v.q1)(n)];case 14:T.sent(),T.label=15;case 15:return(0,s.cY)("Results from TriggerPlugin messages:",o),I={result:o},e.callback(I),s.EG.sendLatencyTelemetry((0,g.pN)(((L={})[i.CT.FeatureName]=i.CC.Extensibility,L[i.CT.SubFeatureName]=i.Ff.AddInActionsForAgents,L[i.CT.UserPerceivedLatency]=(0,b.x)(l),L[i.CT.IsQuerySuccess]=r,L)),!0),[3,19];case 16:return w=T.sent(),E="Unexpected error during local addin execution: ".concat(null==w?void 0:w.message),(0,p.debuglog)(E),[4,null==a?void 0:a()];case 17:return T.sent(),[4,(0,v.q1)(n)];case 18:return T.sent(),(0,v.Xh)(E),s.EG.sendLatencyTelemetry((0,g.pN)(((k={})[i.CT.FeatureName]=i.CC.Extensibility,k[i.CT.SubFeatureName]=i.Ff.AddInActionsForAgents,k[i.CT.UserPerceivedLatency]=(0,b.x)(l),k[i.CT.IsQuerySuccess]=!1,k[i.CT.ErrorChatEventType]=i.S2.LocalAddinActionExecution,k[i.CT.ErrorChatEventParameter]=E,k)),!0),I={result:[(0,v.SL)(E)]},e.callback(I),[3,19];case 19:return[2]}}))}))}(t,ye.iJ.startUndoScope,ye.iJ.endUndoScope,ye.iJ.performUndo);break;case P.PV.ALConnectedWithSameALSessionKey:case P.PV.ALConnectedWithNewALSessionKey:case P.PV.ALDisconnected:case P.PV.ALReconnected:case P.PV.ALClosed:case P.PV.ALSeedingStatusChanged:case P.PV.HandleSubmitForDQGCLicked:(0,Ue.cY)(`AL callback event: ${e}`,{eventArgs:t});break;case P.PV.NewSuggestionPills:(0,Ue.cY)("NewSuggestionPills:",{eventArgs:t});break;case P.PV.FluxResponseHandlingCompleted:(0,Ue.cY)("FluxResponseHandlingCompleted:",{eventArgs:t});break;case P.PV.FluxResponseHandlingErroredOut:(0,Ue.cY)("FluxResponseHandlingErroredOut:",{eventArgs:t});break;case P.PV.QueryExecutionCompleted:(0,Ue.cY)("QueryExecutionCompleted:",{eventArgs:t});break;case P.PV.QueryExecutionStarted:(0,Ue.cY)("QueryExecutionStarted:",{eventArgs:t});break;case P.PV.GenericMessageEvent:{const e=t;switch(e.type){case"CloseSessionPane":this.handleCloseSessionPane(this.store.dispatch);break;case"AgentChanged":await this.handleAgentChangedEvent(e.args,this.store.dispatch);break;case"ExitDataShapingMode":await ft(this.store.dispatch,!0,e.args?.action);break;default:(0,Ue.cY)("GenericMessageEvent:",{eventArgs:t})}break}default:(0,Ue.cY)(`Unhandled event: ${e}`,{eventArgs:t}),(0,nt.x)(e)}var a,n,r}handleCloseSessionPane(e){(0,Ue.cY)("Close Session Pane event triggered"),(0,lt.vo)();e((0,Re.SW)()).started&&ft(e,!1)}async handleAgentChangedEvent(e,t){(0,Ue.cY)("Agent Changed Event:",{agentChangedEventArgs:e});const a=(0,We.beW)("Microsoft.Office.Excel.FA000000124.DataShapingAgentId","T_33851110-0645-e53b-50ab-a31ccd8044cc.declarativeCopilot");if(!a||a===m.u1||!(0,We.lht)())return;const n=e?.gptId===a,o={isDataShapingAgent:n};this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.DataShapingAgentChange,[Ie.h3.ChatEventParameters]:JSON.stringify(o)},this.telemetryLogger);const r=t((0,Re.SW)());if(n){const e=et.CP.getActiveTable()?.name||et.CP.getSelectedTableName();await bt(t,e)}else r.started&&await ft(t,!1)}async handleChangeTopicButtonOnClick(){const{message:e,telemetry:t}=gt.n.getChangeTopicResponse();this.copilotChatUIHelper.displayResponse(e,t),this.store.dispatch((0,Re.Nl)()),Le.y.getInstance().clearODSLCache()}async handleCommandExecutionStart(e,t,a,n){(0,Ue.cY)(e),(0,We.geU)()&&await et.CP.releaseContextLock(),$e.M.userQueryGuid=t,$e.M.userQueryOrder++,this.telemetryLogger?.resetActiveFeature(),De.B.userQueryGuid=t,De.B.getInstance().resetActiveFeature(),(0,We.yw9)("OfficeVSO_9260844_FixContextTreeBuildTime")?this.store.dispatch((0,Re.eM)(Ie.OP.FluxReasoning,t)):(et.CP.lockContextRefresh(),this.store.dispatch(at.m.startExecutingCommand({command:Ie.OP.FluxReasoning,id:t}))),this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:a,...(0,Ie.j)(et.CP)},this.telemetryLogger);const o=(new Date).getTime();this.copilotChatUIHelper.setLastUserUtterance(e),this.copilotChatUIHelper.setLastUserImage(n||[]),this.responseHandler.setAugloopSignalSentTime(o),(0,We.cTR)()&&((0,Ue.cY)(`Setting User Utterance for ${t} to "${e}"`),this.store.dispatch($t.m.setQueryUserUtterance({queryId:t,userUtterance:e})));const r=(0,Ie.xJ)(o);this.telemetryEventHandler.updateTelemetryLatencyData({[Ie.CT.ContextTreeBuildTime]:(0,E.W)(o),[Ie.CT.Duration]:r,[Ie.CT.OperationName]:Ie.OP.ContextTreeBuild,[Ie.CT.IsSuccessful]:!0},this.telemetryLogger),(0,We.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)&&(0,We.yw9)("OfficeVSO_10375249_PassRawQueryToInsights")&&this.store.dispatch(Ot.m.setRawQuery({userQueryGuid:t,messageText:e})),(0,Ue.cY)(`Context Tree Build. Time Taken ${r/1e3} sec`)}getQueryAnnotationsTypes(e){return e?e.map((e=>e.QueryAnnotationType)):[]}async getDefaultSignalOperation(e,t,a,n,r,i,s,c,d,u,h,g,p,b,f,C,y,v){(0,Dt.j3)(C),this.showPythonAASuggestions=v,await this.handleCommandExecutionStart(e,t,Ie.a5.UserUtteranceSubmitted,s);const x=(0,I.TR)(d,c,J.defaultCopilotChatMenuItemId);if((0,l.P7)(x??m.u1),(0,We.JZX)()&&this.xlimWorkflowProgressHandler.getShouldAlertUser()){const{message:e,telemetry:t}=gt.n.getTableLikeRangesLoadingResponse();this.copilotChatUIHelper.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!0}),this.xlimWorkflowProgressHandler.handleQuerySubmittedWhileWorkflowRunning()}const T=s?.map(R.pi)[0],S=s?.length??0;void 0===T&&s&&S>0&&((0,Ue.cY)(`Invalid image data URI in image chat: ${s[0]}`),De.B.getInstance().sendErrorTelemetry((0,Ie.pN)({[Ie.IC.ErrorMessage]:"Image chat bad image data URI in getFluxInputSignal",[Ie.IC.ErrorCategory]:Z.S2.ImageChat}))),S>0&&((0,Ue.cY)(`image chat image count: ${S}`),De.B.getInstance().sendChatEventTelemetry((0,Ie.pN)({[Ie.h3.ChatEventType]:Ie.a5.TriggerImageChatOperation,[Ie.h3.ChatEventParameters]:`image chat image count: ${S}`,[Ie.h3.UserQueryGuid]:t})));const w=((0,We.yw9)("OfficeVSO_9483632_fluxOverrideForMessage")?this.getFluxSkillOverrideForMessage(e):void 0)??this.getFluxSkillOverride(e,y);w&&De.B.getInstance().sendChatEventTelemetry((0,Ie.pN)({[Ie.h3.ChatEventType]:Ie.a5.SignalWithSkillOverride,[Ie.h3.ChatEventParameters]:w,[Ie.h3.UserQueryGuid]:t})),Ce.Q.getInstance().startRecordingFluxWorkflow();const E=await(0,ct.mm)(et.CP,e,t,a,w,r,i,T,(0,We.Pz_)()?c:void 0,d,h,g,this.getUserQueryLanguageIfSkippingLanguageDetection(e),this.getClientCapabilities());(0,We.geU)()&&this.store.dispatch($t.m.setCommandingResponseUtterance({queryId:t,userUtterance:e,context:E.context??""}));const A=new M.g0({parentPath:["Signal",V.qO.getTypeName()],items:[{id:ke.r.generateId(),body:E}]}),L=Ut.byteLength(JSON.stringify(A));if(L>o.dKK)throw Q.$.getInstance().stopLoadingUi(),et.CP.pythonContextManager.isPythonMode&&(0,Nt.fU)(L,Ut.byteLength(JSON.stringify(et.CP)),Ut.byteLength(JSON.stringify(e)),Ut.byteLength(JSON.stringify(r)),Ut.byteLength(JSON.stringify(T))),new Error(`Message size exceeds AugLoop limit.  Size: ${L}`);const k={userQueryGuid:t,GroundingMode:(0,Ie.Q6)(),queryAnnotations:this.getQueryAnnotationsTypes(r)};this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.QuerySubmittedToAL,[Ie.h3.ChatEventParameters]:JSON.stringify(k)},this.telemetryLogger);const F={operation:A,workflowAnnotationType:q.Yn.getTypeName()};return(0,Ue.cY)(`getDefaultSignalOperation: ${JSON.stringify(F,void 0,4)}`),F}getUserQueryLanguageIfSkippingLanguageDetection(e){if((0,At.XX)().some((t=>t.suggestionText.toLowerCase()===e.toLowerCase())))return(0,Rt.gl)()}deductCopilotCredit(e){const t=new Y.vW({scenarioGuid:G.ss,interactionId:e,interactionSessionId:ne.s.getInstance().getConversationId()??""}),a={operation:new M.g0({parentPath:["Signal",Y.vW.getTypeName()],items:[{id:ke.r.generateId(),body:t}]}),workflowAnnotationType:X.d.getTypeName()};Q.$.getInstance().submitOperation(a)}anyHandledMessage(e){return(!ne.s.getInstance().hasSeenDisengagedError()||0===e.status)&&(!(void 0!==e.messagesToAddOrReplace&&(0,Ue.Pk)(e.messages)&&(0,Ue.Pk)(e.messagesToUpdate)&&(0,Ue.Pk)(e.messagesToDelete))||e.messagesToAddOrReplace.some((e=>ne.s.getInstance().isHandledResponseMessage(e))))}async shouldIgnoreResponse(e){if(e.body?.H_)switch(e.body.H_.T_){case q.jR.getTypeName():case H.lL.getTypeName():case H.Dv.getTypeName():case H.sG.getTypeName():case le.sA.getTypeName():case Me.tP.getTypeName():case de.yZ.getTypeName():case ce.bV.getTypeName():case j.b.getTypeName():case ie.f.getTypeName():case ve.uC.getTypeName():return!1;case q.Yn.getTypeName():{if(!q.Yn.typeGuard(e.body))return!1;const t=e.body.queryId;return t&&function(e){if(36!==e.length)return!1;const t=e.charAt(19);return!(8&parseInt(t,16))&&"0"===e.charAt(0)&&"4"===e.charAt(14)}(t)?((0,Ue.cY)(`shouldIgnoreResponse: Ignoring response for CopilotOnGrid queryId: ${t}`),!0):void 0!==e.body.chatResponse&&void 0===e.body.odslResponse&&!this.anyHandledMessage(e.body.chatResponse)}default:return(0,Ue.cY)("shouldIgnoreResponse: No matching annotation found"),$e.M.getInstance().logError({eventType:Z.S2.Augloop,errorMessage:`No matching annotation found for type: ${e.body.H_.T_}`,logLevel:i.$b.Warning}),!0}return!0}async getALSession(){return(0,yt.qD)()}initializeExcelAgentPluginCallbacks(e){if(e.activateServerRequestResponse(ue.l.getTypeName(),{onAnnotationCallback:async(e,t)=>t(await this.runExcelAgentOfficeJSScript(e),!0)}),(0,We.t9T)()){const t=async(e,t)=>(this.responseHandler.startChangeCollector(e.caller),t({},!0));e.activateServerRequestResponse(ge.OE.getTypeName(),{onAnnotationCallback:t});const a=async(e,t)=>{const a=await this.responseHandler.applyAllBatches(e.caller);return t(new pe.Zk({success:a.success,caller:e.caller,requestId:(0,pt.A)(),errorMessage:a.errorMessage}),!0)};e.activateServerRequestResponse(ge.TM.getTypeName(),{onAnnotationCallback:a});const n=async(e,t)=>{Pe.p.sendResponseCallback=t;const a=await this.onExecuteScratchpadScriptInClientAnnotation(e),n=Pe.p.sendResponseCallback(a,!0);if(!Wt.scriptExecutionDeferredPromise){const e="CommunicationHandler.scriptExecutionDeferredPromise not created in continueRichApiBatchCallback.";throw this.telemetryLogger.logError({eventType:Z.S2.ChatEvents,errorMessage:e,logLevel:i.$b.Error}),new Error(e)}return Wt.scriptExecutionDeferredPromise.resolve(n),Wt.scriptExecutionDeferredPromise=void 0,n};e.activateServerRequestResponse(ge.Ex.getTypeName(),{onAnnotationCallback:n});const o=async(e,t)=>{Pe.p.resolveAnnotationPromise(e,t),Wt.scriptExecutionDeferredPromise=(0,te.p)();const a=setTimeout((()=>{if(Wt.scriptExecutionDeferredPromise){const e="Timeout waiting for annotation response";Wt.scriptExecutionDeferredPromise.reject(new Error(e)),this.telemetryLogger.logError({eventType:Z.S2.ChatEvents,errorMessage:e,logLevel:i.$b.Error}),Wt.scriptExecutionDeferredPromise=void 0}}),12e4);try{const e=await Wt.scriptExecutionDeferredPromise.promise;return clearTimeout(a),e}finally{Wt.scriptExecutionDeferredPromise=void 0}};e.activateServerRequestResponse(ge.hM.getTypeName(),{onAnnotationCallback:o}),async function(e,t){(0,We.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ExcelDataShapingClientStore",!1)&&(await t.activateServerRequestResponse(le.ik.getTypeName(),{onAnnotationCallback:async(t,a)=>{let n;const o={success:!1,started:!1,sessionId:""};try{try{const a=be.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,r=e((0,Re.SW)());if(o.started=r.started,!r.started)throw new Error("Data shaping not started");if(r.sessionId!==t.dataShapingSessionId)throw new Error("Data shaping session ID mismatch");o.sessionId=r.sessionId,await a.updateQueryScript(t.queryScript);const i=await a.getQueryScript();n={dataShapingSessionId:t.dataShapingSessionId,success:!0,actualQueryScriptOrError:i},o.success=!0}catch(e){n={dataShapingSessionId:t.dataShapingSessionId,success:!1,actualQueryScriptOrError:e.message}}await a(new le.vH(n))}finally{Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.DataShapingEditQuery,[Ie.h3.ChatEventParameters]:JSON.stringify(o)},$e.M.getInstance())}}}),await t.activateServerRequestResponse(le.eg.getTypeName(),{onAnnotationCallback:async(t,a)=>{const n={success:!1,started:!1,sessionId:""};try{const t=[],o=e((0,Re.SW)());n.started=o.started,o.started?(n.sessionId=o.sessionId,t.push({key:dt.y.DataShapingSessionId,value:o.sessionId}),t.push({key:dt.y.DataShapingTableName,value:o.tableName}),t.push({key:dt.y.DataShapingBaseQueryScript,value:o.baseScript}),t.push({key:dt.y.DataShapingCurrentQueryScript,value:o.queryScript})):t.push({key:dt.y.DataShapingSessionId,value:void 0});const r={items:t};await a(new le.zr(r)),n.success=!0}finally{Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.DataShapingHydration,[Ie.h3.ChatEventParameters]:JSON.stringify(n)},$e.M.getInstance())}}}))}(this.store.dispatch,e)}}initializeAlCallbacks(){(0,yt.UC)((async e=>{((0,We.Jym)()||(0,We.t9T)())&&this.initializeExcelAgentPluginCallbacks(e)})),(0,yt.jl)((async(e,t)=>{this.sessionRestartedDueToModelWorkflowNotSupported=t,Q.$.getInstance().startReinitializeALSession(),(0,We.yw9)("OfficeVSO_8772262_updateAugloopModelStatusOnAppState")&&this.responseHandler.setAugloopModelWorkflowUnsupported(t),$e.M.getInstance().logError({eventType:Z.S2.Augloop,errorMessage:"Augloop session restarted",logLevel:i.$b.Warning},void 0,[{key:Z.Wg.UnsupportedWorkflow,value:t}])})),(0,yt.s6)((()=>{(0,Ue.cY)("AugLoop session closed on permanent error."),this.store.dispatch(Ot.m.setIsPermanentError(!0));const e=(0,We.yw9)("OfficeVSO_9792561_AttributionForAugLoopFailure")&&this.telemetryLogger?this.telemetryLogger.getActiveFeature():Ie.BJ.CopilotChat;$e.M.getInstance().logStandardizedAshaErrorEvent(B.W.User_Input_Could_Not_Be_Processed,D.c.Input_Failed_Due_To_Augloop_Session_Close,e),$e.M.getInstance().logError({eventType:Z.S2.Augloop,errorMessage:"AugLoop connection closed on permanent error.",logLevel:i.$b.ASHA})}))}stringToQueryOrigin(e){if(void 0!==e)return G.Rk[e]}getHostSettings(){const e={appName:Office.context.diagnostics.host.toString(),appPlatform:(0,ye.vI)().toString().toUpperCase(),devBuild:(0,Ue.K_)(),environment:this.getAppEnvironment(),sessionId:"",augloopUrl:"https://augloop-dogfood.officeppe.com",m365ChatConfiguration:{environment:this.getM365ChatEnvironment(),host:Se.vb.Excel,clientPlatform:(0,ye.ET)()},substrateScenarioName:o.rGh[(0,ye.vI)().toString().toUpperCase()],language:(0,Rt.gl)(),sessionStorageKey:this.getSessionStorageKey(),enterpriseUser:(0,We.Dl1)(),feedbackSettings:(0,st.f)(),getDocumentUrlAsync:(0,We.uPG)()?ye.H5:void 0};return(0,We.etf)()&&(e.m365ChatDevBuild=!1),e}getSessionStorageKey(){const e=window.Office.context,t=e?.platform;let a;const n=e?.hostSettings?._settings?.IsCopilotPreloaded;if(t===window.Office.PlatformType.OfficeOnline)a=e?.hostSettings?.get("AppStartTimestamp");else if(n){const t=e?.document?.settings?._clientSettingsManager?._osfClientContext;let n=t?.GetCorrelationId();const o=t?.GetDocUrl();n&&(n=n.replace(/[{}]/g,"")),o&&n&&(a=`${n}${"string"==typeof o?(0,A.if)((new TextEncoder).encode(o)):""}`)}return a}async setPythonContext(e,t){let a=!0;return et.CP.pythonContextManager.lastPythonUserRequestId=(0,pt.A)(),this.store.dispatch(at.m.startNewPythonQuery()),t&&($e.M.userQueryGuid=t,De.B.userQueryGuid=t),(0,_e.F5)(),(0,We.H2A)()&&(a=await et.CP.pythonContextManager.setPythonAdaContext(et.CP.isPythonCellSelected,e,et.CP.selectedPythonSheetId,et.CP.selectedPythonAddress,this.stringToQueryOrigin(this.getQueryOriginValue()))),a}async shouldSendRequestToAugloop(e,t,a,n){if(this.onNewUserUtterance(),(0,We.WFw)()&&De.B.getInstance().sendHandoffQuerySubmittedEvent(e),"python"===this.cannedOption)return await this.setPythonContext(e,n),(0,Ue.cY)("Canned option set - Showing Python card"),(0,We.H2A)()&&(this.updateCopilotState(P.SG.QUERY_SUBMITTED),this.responseHandler.showPythonStartAnalysisCard((0,pt.A)(),!1)),!1;const r=((e,t)=>{if((0,ct.jZ)(e)){(0,ct.cY)("Help query detected:"+e);const{message:a,telemetry:n}=gt.n.getHelpQueryResponse();return Q.$.getInstance().displayResponse(a,n),t((0,Re.Nl)()),!1}if(e===(0,o.vMn)()){const{message:e,telemetry:a}=gt.n.getLearnMoreResponse();return Q.$.getInstance().displayResponse(e,a),t((0,Re.Nl)()),!1}return!0})(e,this.store.dispatch);if(!r)return this.telemetryLogger.endTriedActivityFailure(),!1;const i=this.suggestionList.find((t=>t.suggestionText.toLowerCase()===e.toLowerCase()));if((0,We.yw9)("OfficeVSO_9205086_LogSuggestionPillExecutes")&&i){const e=n??(0,pt.A)();$e.M.userQueryGuid=e,De.B.userQueryGuid=e,this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.SuggestionPaneSuggestionClicked,[Ie.h3.ChatEventParameters]:i.suggestionType},this.telemetryLogger),n=e}const l=this.getShouldHandleSuggestionClientSide(i);if(i&&l)return this.handleSuggestionPillClick(i,n),!1;i&&this.resetUnsupportedTlrPromptSuggestions(i);const s=Object.values(this.zeroQueryMessageTitles).find((t=>t.toLowerCase()===e.toLowerCase()));if(n){const t=this.getQueryOrigin(e);t&&this.store.dispatch(at.m.setQueryOriginByQueryId({queryId:n,queryOrigin:t}))}if((0,We.H2A)()){et.CP.pythonContextManager.shouldGenerate=!0;const e=await(0,rt.J7)(et.CP);et.CP.pythonContextManager.pythonAnalysisSheetExistsOnUserQuerySubmit=e}if((0,We.H2A)()){if(!await this.setPythonContext(e,n))return this.telemetryLogger.endTriedActivityFailure(Ie.q.Python),!1;if((0,We.ggM)()){if((0,We.B8x)()){if(!et.CP.pythonContextManager.isPythonMode&&s&&s===(0,o.fkZ)()){this.updateCopilotState(P.SG.QUERY_SUBMITTED);try{(0,it.iY)("en-us")}catch(e){return this.telemetryLogger.endTriedActivityFailure(Ie.q.Python),(0,it.Kx)(this.store.dispatch,e,"shouldSendRequestToAugloop",!1),!1}return this.responseHandler.showPythonStartAnalysisCard((0,pt.A)(),!0),!1}(0,_e.lu)()}}else{if(!et.CP.pythonContextManager.isPythonMode&&s&&s===(0,o.ONP)()){this.updateCopilotState(P.SG.QUERY_SUBMITTED);try{(0,it.iY)("en-us")}catch(e){return this.telemetryLogger.endTriedActivityFailure(Ie.q.Python),(0,it.Kx)(this.store.dispatch,e,"shouldSendRequestToAugloop",!1),!1}return this.responseHandler.showPythonStartAnalysisCard((0,pt.A)(),!0),!1}(0,_e.lu)()}}if((0,We.vom)()&&await(et.CP.pythonCalculatedColumnContextManager?.updatePythonColumns()),(0,We._bw)()){if(!await(0,L.aW)())return(0,Ue.cY)("Sensitivity Label APIs failed, not sending request to AL"),Promise.resolve(!1)}return!0}getFluxSkillOverrideForMessage(e){if((0,We.eFk)()&&Office.context.platform===Office.PlatformType.OfficeOnline&&!this.store.dispatch((0,Re.SW)()).started&&(0,o.fEB)().find((t=>t.toLowerCase()===e.toLowerCase().trim())))return Gt["flux-dataShaping"]}getShouldHandleSuggestionClientSide(e){return!!e&&("Commanding_Suggestion"!==e.suggestionType&&((!(0,We.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)||"AnalyzeData_ShowCharts"!==e.suggestionType&&"AnalyzeData_ShowPivotTables"!==e.suggestionType)&&("AnalyzeData_InsertAll"===e.suggestionType||"GiveMeMorePrompts"===e.suggestionType||"Commanding_TellMe"===e.suggestionType||"AnalyzeData_ShowMore"===e.suggestionType||"CalculatedColumns_ShowMore"===e.suggestionType||"AnalyzeData_ShowCharts"===e.suggestionType||"AnalyzeData_ShowMoreCharts"===e.suggestionType||"AnalyzeData_ShowPivotTables"===e.suggestionType||"AnalyzeData_ShowMorePivotTables"===e.suggestionType||"AnalyzeData_InsertAllCharts"===e.suggestionType||"ConditionalFormat_Suggestion"===e.suggestionType||"ImportDataFromFile"===e.suggestionType)))}getFeedbackData(){return(0,lt.M5)()}async getCanvasSelection(){Pt.isPublicApiInitialized&&((0,We.wQA)()||Pt.isPublicApiInitialized||!(0,We.yw9)("OfficeVSO_10475169_InitContextManager"))||await et.CP.initPublic((0,we.KA)().dispatch);const e=JSON.parse(await et.CP.getContextString("")),t=Object.fromEntries(["activeWorksheet","activeRangeAreas","activeCell","activeChart","activePivotTable"].filter((t=>null!=e[t])).map((t=>[t,e[t]])));return{selection:JSON.stringify(t),isValid:!0,objects:[]}}async getDocumentContext(){const{spoId:e,fileName:t}=await this.getDocumentContextFromDocumentUrlAsync(),a={spoId:e,fileName:t};if((0,We.VKb)()){const e=await this.getPopulateCellCount();a.count=e}return a}feedbackButtonClicked(e,t){(0,Ue.cY)("Feedback clicked");let a=t?.feedbackArea??"Copilot";if("Copilot\\Python"===a&&this.getQueryOriginValue()===G.Rk.MsFormsSDX&&(a="Copilot\\PythonForms"),(0,We.yw9)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")){const n=JSON.parse(t?.contextData?.cardMetaData??"{}");e===P.Gb.LIKE?this.telemetryLogger?.logThumbsUpEvent(a,n?.suggestionId,n?.promptId,n?.groundingMode):this.telemetryLogger?.logThumbsDownEvent(a,n?.suggestionId,n?.promptId,n?.groundingMode)}}async copyButtonClicked(e,t,a){(0,Ue.cY)("Copy button clicked called"),(0,Ee.Kv)(e,t,a)}async handleAugloopResponseTimeout(e){if(this.responseHandler.markRequestCanceled(),Q.$.getInstance().handleEndOfQuery(void 0),oe.Z.getInstance().isWaitingForStreamEnd())return Ce.Q.getInstance().stopRecordingFluxWorkflow(!1),void oe.Z.getInstance().cleanupStreamHandler();(0,Ue.cY)("Augloop Response Timed Out");const{message:t,telemetry:a}=gt.n.getAugloopTimeoutResponse(this.telemetryLogger.getActiveFeature());this.copilotChatUIHelper.displayResponse(t,a,{shouldShowWhenFluxSkillResponseRequired:!0,logAshaError:!(e=>{switch($e.M.getInstance().getStandardizedFeatureForSubFeature(e.featureName)){case Ie.BJ.CopilotChat:case Ie.BJ.ExcelChatHelper:return!0;default:return!1}})(a)}),et.CP.pythonContextManager.isPythonMode&&((0,_e.hb)(),(0,_e.P_)(!0)),Ce.Q.getInstance().stopRecordingFluxWorkflow(!1),Q.$.getInstance().handleEndOfQuery(void 0),this.store.dispatch((0,Re.Nl)());const n=await this.store.dispatch((0,Re.q9)());this.logAugloopTimeoutAshaError(n),this.telemetryLogger.logError({eventType:Z.S2.ChatEvents,errorMessage:`"Augloop Response Timed Out: workflowAnnotationType ${e}, executingCommand: ${n}`,logLevel:i.$b.Error})}logAugloopTimeoutAshaError(e){if(!e)return;const t=this.getFeatureNameFromLatencyOperation(e)??Ie.BJ.CopilotChat;this.telemetryLogger.assertFeatureIsActive(t,"logAugloopTimeoutAshaError: Feature from executing command does not match active feature."),$e.M.getInstance().logStandardizedAshaErrorEvent(B.W.Response_Delayed_Or_Timed_Out,D.c.Augloop_Response_Timed_Out,t,!1)}async handleStopAlGeneration(e){et.CP.pythonContextManager.shouldGenerate=!1,Ze.qx.getInstance().stopGeneratingCurrentMessageId();const t=await this.store.dispatch((0,Re.q9)());this.logUserStopGeneratingAshaError(t),this.logIsTriedFailedDueToUserStopGenerating(t);const a=this.getFeatureNameFromLatencyOperation(t)??Ie.BJ.CopilotChat;if(this.telemetryLogger.assertFeatureIsActive(a,"handleStopButtonClick: Feature from executing command does not match active feature."),this.telemetryEventHandler.logStopGeneratingLatencyTelemetry(J.querySubmitTime,this.telemetryLogger,a),(0,We.yw9)("OfficeVSO_8531310_UndoForStopGenerating")&&this.store.dispatch((0,wt.f1)()),e){const{message:e,telemetry:a}=gt.n.getStopGeneratingResponse(t);this.copilotChatUIHelper.displayResponse(e,a);const n=(0,Tt.N)(e);this.store.dispatch((0,Re.nv)(n,Fe.Aw.cancelled,a,!1))}ne.s.getInstance().isWaitingForStreamEnd()&&ne.s.getInstance().cleanupStreamHandler(),this.responseHandler.markRequestCanceled()}async handleStopButtonOnClick(){const e=(0,We.UxI)()&&r.xP.isAddinFlow(),t=e&&r.xP.getCurrentAddinState()===r.aB.HasAction;this.endAddinOperationsAndTriggerUndo(t),e&&De.B.getInstance().sendChatEventTelemetry((0,Ie.pN)({[Ie.h3.ChatEventType]:i.a5.StopGeneratingButtonClickedDuringAddinExecution})),this.handleStopAlGeneration(!0),e&&r.xP.setIsAddinFlow(!1,(()=>{(0,A.An)(Q.$.getInstance().getCopilotRef(),!1)}))}async endAddinOperationsAndTriggerUndo(e){await ye.iJ.endUndoScope(),e&&await ye.iJ.performUndo()}async handleStopQueryWhenGptSwitched(){(0,We.Pz_)()&&this.handleStopAlGeneration(!1)}logIsTriedFailedDueToUserStopGenerating(e){if(e&&e===Ie.OP.ElseSkillExecuting)(0,Je.Or)($e.M.getInstance())}getFeatureNameFromLatencyOperation(e){switch(e){case Ie.OP.CalculatedColumns:case Ie.OP.CalculatedCells:return Ie.BJ.FormulaGeneration;case Ie.OP.AnalyzeData:return Ie.BJ.AnalyzeData;case Ie.OP.ChartDesignRecommendations:return Ie.BJ.ChartDesignRecommendations;case Ie.OP.Commanding:return Ie.BJ.Commanding;case Ie.OP.ConditionalFormatting:return Ie.BJ.ConditionalFormatting;case Ie.OP.Search:return Ie.BJ.Search;case Ie.OP.ElseSkillExecuting:return Ie.BJ.ExcelChatHelper;case Ie.OP.PythonStartAnalysis:case Ie.OP.Python:return Ie.BJ.Python;default:return void $e.M.getInstance().logError({eventType:Z.S2.ChatEvents,errorMessage:`Error mapping TelemetryStandardizedFeature for operation: ${e}`,logLevel:i.$b.Error})}}logUserStopGeneratingAshaError(e){if(!e)return;const t=this.getFeatureNameFromLatencyOperation(e)??Ie.BJ.CopilotChat;this.telemetryLogger.assertFeatureIsActive(t,"logUserStopGeneratingAshaError: Feature from executing command does not match active feature.");const a=(0,Ie.xJ)(J.querySubmitTime)<=(0,We.Z8j)("Microsoft.Office.Excel.FA000000124.UserCanceledVetoThresholdMs",5e3)?D.c.User_Stopped_Execution_Short:D.c.User_Stopped_Execution;a&&t&&$e.M.getInstance().logStandardizedAshaErrorEvent(B.W.User_Rejected_Or_Cancelled_Response,a,t)}onExcelTableRecognitionAnnotationResult(e,t){const a=e.body;a&&((0,We.JZX)()&&this.xlimWorkflowProgressHandler.handleRecognizedTableAnnotationsReceived(),this.store.dispatch((0,Et.tP)(a,t?.parentRevId)))}onExcelBlobRangeAnnotationResult(e,t){const a=e.body;a&&this.store.dispatch((0,Et.Nn)(a,t?.parentRevId))}onWorkflowProgressAnnotationResult(e){const t=e.body;t.flowId===tt.XLIMProgressFlowId&&((0,Ue.cY)("XLIMProgressFlow running:",t.running),t.running?this.xlimWorkflowProgressHandler.setWorkflowStarted():this.xlimWorkflowProgressHandler.setWorkflowEnded())}onExcelScratchpadStartSnapshotAnnotation(e){if(e.body&&ge.OE.typeGuard(e.body)){const t=e.body;this.responseHandler.startChangeCollector(t.caller)}}async onExecuteScratchpadScriptInClientAnnotation(e){const t=await this.responseHandler.executeScript(e.script,e.caller);return new pe.ft({requestId:(0,pt.A)(),success:t.success,result:JSON.stringify(t.result),documentChanges:t.documentChanges,apiDescriptionHeader:t.apiDescriptionHeader,apiDescriptions:t.apiDescriptions,caller:e.caller,useVisibleObserver:!0})}async onExcelScratchpadExecuteScriptInClientAnnotation(e){if(e.body&&ge.Ex.typeGuard(e.body)){const t=e.body,a=await this.responseHandler.executeScript(t.script,t.caller),n=new pe.ft({requestId:(0,pt.A)(),success:a.success,result:JSON.stringify(a.result),documentChanges:a.documentChanges,apiDescriptionHeader:a.apiDescriptionHeader,apiDescriptions:a.apiDescriptions,caller:t.caller,useVisibleObserver:!0}),o=new M.g0({parentPath:["Signal",pe.ft.getTypeName()],items:[{id:ke.r.generateId(),body:n}]});Q.$.getInstance().submitOperation({operation:o,workflowAnnotationType:ge.Ww.getTypeName()})}}async runExcelAgentOfficeJSScript(e){let t={documentChanges:[]};try{if(e.scriptRequest.scriptType!==me.e.OfficeJs){const t="Unsupported script type: "+e.scriptRequest.scriptType;throw $e.M.getInstance().logError({eventType:Z.S2.ChatEvents,errorMessage:t,logLevel:i.$b.Error}),new fe.f(t)}const{returnResult:a,documentChanges:n,excelDocumentContext:o}=await this.responseHandler.executeOfficeJsFromScriptRunner(e.scriptRequest.script);t={documentChanges:n,returnResult:a,updatedWorkbookContextJson:o}}catch(e){t={documentChanges:[],errorResult:e instanceof fe.f?e.message:"runExcelAgentOfficeJSScript: Unknown error"},$e.M.getInstance().logError({eventType:Z.S2.ChatEvents,errorMessage:t.errorResult??"runExcelAgentOfficeJSScript: Unknown error",logLevel:i.$b.Error})}return new he.r({requestId:e.requestId,scriptResponse:t})}async onExcelRunScriptAnnotation(e){if(e.body&&ue.l.typeGuard(e.body)){const t=e.body,a=await this.runExcelAgentOfficeJSScript(t),n=new M.g0({parentPath:["Signal",he.r.getTypeName()],items:[{id:ke.r.generateId(),body:a}]});Q.$.getInstance().submitOperation({operation:n,workflowAnnotationType:ue.l.getTypeName()})}}async onConditionalFormattingSuggestionAnnotationResult(e){if(e.body&&j.b.typeGuard(e.body)){const t=e.body,{message:a,telemetry:n}=gt.n.getConditionalFormattingSuggestionsResponseMessage(t.Suggestions,t.errorMessage,t.headerMessage,t.guid);this.copilotChatUIHelper.displayResponse(a,n);const o=void 0===t.errorMessage;await this.store.dispatch((0,Re.L4)(o))}}async onExcelChartStylesAnnotationResult(e){if((0,We.jGm)())if(e.body&&ie.f.typeGuard(e.body)){const t=e.body,a=t.requestId;if(a&&this.chartDesignActiveQueryId!==a)return $e.M.getInstance().logError({eventType:Z.S2.ChartDesignRecommendations,errorMessage:`[ChartDesignRecommendations]: Ignoring late response for timed out chart operation: ${a}`,logLevel:i.$b.Warning}),void this.clearChartDesignTimeout();this.clearChartDesignTimeout();const n=a??(0,pt.A)();this.store.dispatch(at.m.setLatestRequestId(n));let r=!0;if(t.ExcelChartStylesSuggestions.length>0&&t.chartId&&t.chartName&&t.sheetId)Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.ChartDesignRecommendationsAnnotionReceived,[Ie.h3.ChatEventParameters]:JSON.stringify({chartId:t.chartId})},$e.M.getInstance()),await this.responseHandler.handleChartDesignRecommendationResult(n,t.ExcelChartStylesSuggestions,t.chartId,t.chartName,t.sheetId);else{$e.M.getInstance().logStandardizedAshaErrorEvent(B.W.Unable_To_Complete_Task,D.c.ChartDesignRecommendationsWorkflowFailed,Ie.BJ.ChartDesignRecommendations),$e.M.getInstance().logError({eventType:Z.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: No suggestions received from Augloop",logLevel:i.$b.Error});const{message:e,telemetry:t}=gt.n.getChartDesignRecommendationsFailedResponse((0,o.Hum)(),Ie.q0.NoSuggestions);Q.$.getInstance().displayResponse(e,t),await this.responseHandler.handleChartDesignNoRecommendationResult(),r=!1}await this.store.dispatch((0,Re.L4)(r))}else{$e.M.getInstance().logError({eventType:Z.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: Did not receive ExcelChartStylesAnnotation object",logLevel:i.$b.Error});const{message:e,telemetry:t}=gt.n.getChartDesignRecommendationsFailedResponse((0,o.Hum)(),Ie.q0.NoSuggestions);Q.$.getInstance().displayResponse(e,t),await this.responseHandler.handleChartDesignNoRecommendationResult()}else $e.M.getInstance().logError({eventType:Z.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: We should not have received ExcelChartStylesAnnotation when the flight is off",logLevel:i.$b.Error})}handleSuggestionPillClick(e,t=(0,pt.A)()){let a,n;if((0,We.ZAR)()){const e=this.store.getState().chat;a=e.currentNLResultTableContext,n=e.currentNLResultTableName}else a=et.CP.getActiveTable(),n=a?.name;switch((0,We.yw9)("OfficeVSO_9205086_LogSuggestionPillExecutes")||($e.M.userQueryGuid=t,this.telemetryLogger.setQuerySource(Ie.BC.SuggestionPill),this.telemetryLogger?.resetActiveFeature(),De.B.userQueryGuid=t,De.B.getInstance().setQuerySource(Ie.BC.SuggestionPill),De.B.getInstance().resetActiveFeature(),this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.SuggestionPaneSuggestionClicked,[Ie.h3.ChatEventParameters]:e.suggestionType},this.telemetryLogger)),e.suggestionType){case"AnalyzeData_ShowMore":case"AnalyzeData_ShowMoreCharts":case"AnalyzeData_ShowMorePivotTables":case"AnalyzeData_ShowCharts":case"AnalyzeData_ShowPivotTables":this.handleTableSuggestionPillClick(e.suggestionType,a,n);break;case"AnalyzeData_InsertAllCharts":this.store.dispatch((0,Et.AR)());break;case"GiveMeMorePrompts":this.store.dispatch((0,Re.Nl)());break;case"AnalyzeData_InsertAll":this.store.dispatch((0,Et.eS)());break;case"AnalyzeData_Suggestion":case"AnalyzeData_SpecificSuggestion":case"AnalyzeData_RelatedQuestions":this.handleSuggestionODSL(e.suggestionText,y.getInsights,t);break;case"Commanding_TellMe":!function(e){e((0,Re.Yx)(["Commanding_Suggestion"]));const{message:t,telemetry:a}=gt.n.getCommandingTellMeResponse();Q.$.getInstance().displayResponse(t,a)}(this.store.dispatch);break;case"CalculatedColumns_ShowMore":if(void 0===e.calculatedFormulaSuggestionMessage)return void(0,Ue.cY)("No calculatedFormulaSuggestionMessage found, not enough info to show the CC suggestion");this.store.dispatch((0,Lt.ph)(e.calculatedFormulaSuggestionMessage.requestId,e.calculatedFormulaSuggestionMessage.requestIndex));break;case"CalculatedColumns_GeneralSuggestion":this.handleSuggestionODSL(e.suggestionText,y.getColumnsGeneral,t);break;case"CalculatedColumns_SpecificSuggestion":this.handleSuggestionODSL(e.suggestionText,y.getColumnsFromNL,t);break;case"CalculatedCell_Suggestion":this.handleSuggestionODSL(e.suggestionText,y.getCellsFromNL,t);break;case"ConditionalFormat_Suggestion":this.handleSuggestionODSL(e.suggestionText,y.getConditionalFormatSuggestion,t);break;case"ImportDataFromFile":if(e.properties){const a=e.properties.messageId;(0,kt.yU)(a,t,this.store.dispatch,e.itemClp)}}}handleTableSuggestionPillClick(e,t,a){if(t&&a)switch(e){case"AnalyzeData_ShowMore":this.store.dispatch((0,Re.oh)(a,t));break;case"AnalyzeData_ShowMoreCharts":case"AnalyzeData_ShowMorePivotTables":this.store.dispatch((0,Re.zA)(a,t));break;case"AnalyzeData_ShowCharts":this.store.dispatch(at.m.setLatestRequestId($e.M.userQueryGuid)),this.store.dispatch((0,Et.Dz)(a,t,$e.M.userQueryGuid,"ChartReco"));break;case"AnalyzeData_ShowPivotTables":this.store.dispatch(at.m.setLatestRequestId($e.M.userQueryGuid)),this.store.dispatch((0,Et.Dz)(a,t,$e.M.userQueryGuid,"PivotTableReco"))}else $e.M.getInstance().logError({eventType:Z.S2.SuggestionEvents,errorMessage:"handleSuggestionPill failed. No active table found",logLevel:i.$b.Error})}async handleSuggestionODSL(e,t,a){this.telemetryLogger.startTriedActivity(),await this.handleCommandExecutionStart(e,a,Ie.a5.SuggestionPaneSuggestionClicked);let n=U[t];n=n.replace("{{messageText}}",e);const o=JSON.parse(n);try{await this.responseHandler.executeOdsl(o,a)}catch(e){throw e}}resetUnsupportedTlrPromptSuggestions(e){switch(e.suggestionType){case"Tlr_ExplainHeaders":case"Tlr_ExplainTables":case"Tlr_ExplainUnmergingCells":this.store.dispatch(at.m.clearSuggestionList())}}async getPromptById(e,t){const a=await this.getContextSensitiveHelpPrompt(e,t);if(void 0!==a){const t={promptId:e.toLowerCase()};return De.B.getInstance().sendChatEventTelemetry((0,Ie.pN)({[Ie.h3.ChatEventType]:Ie.a5.CSHScenarioRun,[Ie.h3.ChatEventParameters]:JSON.stringify(t)})),a}}async getPromptWithFormulaPlaceholer(e,t,a){if(void 0!==a.cellRow&&void 0!==a.cellCol){const t=await async function(e,t){let a="";return await Excel.run((async n=>{const o=n.workbook.worksheets.getActiveWorksheet().getCell(e,t);o.load("formulas"),await n.sync(),1===o.formulas.length&&(a=o.formulas[0].toString())})),a}(a.cellRow,a.cellCol);if(t)return(0,ct.VY)(e,{formula:t})}return t}async getContextSensitiveHelpPrompt(e,t){switch(e.toLowerCase()){case"dd656fbd-fc5b-4e21-88bb-2b6ce622cc2e":if(void 0!==t.cellRow&&void 0!==t.cellCol){const e=await async function(e,t){let a="";return await Excel.run((async n=>{const o=n.workbook.worksheets.getActiveWorksheet().getCell(e,t);if(o.load(["valuesAsJsonLocal"]),await n.sync(),1===o.valuesAsJsonLocal.length){const e=o.valuesAsJsonLocal[0][0];e.errorMessage&&e.errorName?a=`${e.errorName}: ${e.errorMessage}`:e.errorMessage&&(a=e.errorMessage)}})),a}(t.cellRow,t.cellCol);if(e)return(0,ct.VY)((0,o.P82)(),{error:e})}return;case"f9ad6e18-f3c7-4346-8e1a-896849997b0d":return this.getPromptWithFormulaPlaceholer((0,o.ENk)(),(0,o.fRc)(),t);case"606f60ec-8401-418d-9f19-3c133e933ab1":return this.getPromptWithFormulaPlaceholer((0,o.mk8)(),(0,o.nhC)(),t);case"fd986fa8-18fa-47e6-bd6c-5278924c4fe3":return this.getPromptWithFormulaPlaceholer((0,o.EW5)(),(0,o.fu2)(),t);case"f4d3aafb-8190-46a9-bc20-cafe606dfd2d":return this.getPromptWithFormulaPlaceholer((0,o.IpP)(),(0,o.TTT)(),t);case"a49c05e9-ca3b-4a32-ac67-c56bd16a583b":return this.getPromptWithFormulaPlaceholer((0,o.B3O)(),(0,o.qbB)(),t);case"60baa1dd-aecf-42b2-9f89-a0be53a05a5a":return this.getPromptWithFormulaPlaceholer((0,o.gNJ)(),(0,o.JAc)(),t);case"8e05d9ff-5505-4c7d-925d-2cdbc7555da9":return this.getPromptWithFormulaPlaceholer((0,o.t8C)(),(0,o.I$d)(),t);case"117a47c2-8673-4631-af47-ab87bd8db3d3":return this.getPromptWithFormulaPlaceholer((0,o.I$I)(),(0,o.fzU)(),t);case"520eb606-caea-4c4d-9ebb-7da8aa8a76e5":return this.getPromptWithFormulaPlaceholer((0,o.J$y)(),(0,o.irK)(),t);case"4caf9f84-2dcd-4018-a8b1-8d3ea494eb5d":return this.getPromptWithFormulaPlaceholer((0,o.pDo)(),(0,o.I64)(),t);case"cfa8a08b-607b-435e-96b7-fa3c171da97b":return this.getPromptWithFormulaPlaceholer((0,o.ijW)(),(0,o.LC$)(),t);case"e8cd5204-4fe3-4564-82b1-cf17942c0da6":return(0,o.hEI)();case"73dba87b-93cd-4d77-92a7-f0eec75c3a3f":return(0,o.v3q)();case"c78d7f1e-3542-4463-b844-5eb8b5d53cdf":return(0,o.uVJ)();case"58fb1fe7-479e-42bd-a5e4-d270934a39d1":return(0,o.j0F)();case"b52dc308-99ca-48b2-9611-9f108902bf48":return(0,o.NSY)();case"a6b2d8eb-8c55-4d1f-81ae-be3e8f21122c":return(0,o.wUB)();case"de300c60-54c6-49f8-b049-418fdfc14bda":return(0,o.Q0)();case"a229a616-09dc-4f98-ab74-ef5e6ecb72e3":return(0,o.RT6)();case"12f792d7-c735-469e-8ef3-15fd1031e776":return(0,o.kDR)();case"e90809a8-1c84-4f53-bbcf-b1dccf36c528":return(0,o.Y2N)();case"c5900890-e61e-43ce-a549-03915cc3310c":return(0,o.qU2)();case"c0917abf-f982-4435-9b1b-37cad3f3d104":return(0,o.RV_)()}}async handleStartQuery(){let e=Te.V.getSetting(Te.z.CopilotInitialPrompt);if((0,We.wQA)()||Pt.isPublicApiInitialized||await et.CP.initPublic((0,we.KA)().dispatch),(0,We.yw9)("OfficeVSO_9601910_ExcelSdxUnifiedSendPrompt")&&e){(0,Ue.cY)("Handling CopilotInitialPrompt: "+e.toString());try{e=JSON.parse(e)}catch(e){}if(qt(e))return void await this.handleUnifiedPrivateApiExternalTriggeredPrompt(e);(0,Ue.cY)("CopilotInitialPrompt not recognized as correct type")}let t=Te.V.getSettingAsString(Te.z.CopilotStartQuery);if(t){try{t=JSON.parse(t)}catch(e){}return(0,Ue.cY)("Handling legacy CopilotStartQuery: "+t),void await this.submitExternalQuery(t,Ie.BC.ExternalQuery)}const a=Te.V.getSettingAsString(Te.z.CopilotStartPromptId);if(a){const e=JSON.parse(a),t={cellRow:Te.V.getSetting(Te.z.CopilotStartPromptCellRow),cellCol:Te.V.getSetting(Te.z.CopilotStartPromptCellCol)},n=await this.getPromptById(e,t);n&&await this.submitExternalQuery(n,Ie.BC.ExternalQuery)}}async submitExternalQuery(e,t,a,n,o,r,l,s,c,d,u,m,h){const{message:g,telemetry:p}=gt.n.getExternalTriggeredQueryResponse(e,!!n),b="PythonAASuggestion"===u;if((0,We.jGm)()&&"ExcelChartStyles"===u){if(this.ignoreExcelChartStylesWorkflow){const{message:e,telemetry:t}=gt.n.getChartRecommendationsInProgressResponse();return void Q.$.getInstance().displayResponse(e,t)}this.ignoreExcelChartStylesWorkflow=!0,Be.E.getInstance().updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.ChartDesignRecommendationsActivated,[Ie.h3.ChatEventParameters]:JSON.stringify({chartId:c})},$e.M.getInstance())}else this.copilotChatUIHelper.displayResponse(g,p);if(this.updateCopilotState(P.SG.QUERY_ENTERED),(0,We.yw9)("OfficeVSO_9579802_ContextMenuPromptDelay")){const a=o??(0,pt.A)();let n;if((0,We.xLF)()&&(r&&this.store.dispatch(at.m.setQueryOriginByQueryId({queryId:a,queryOrigin:r})),l&&this.store.dispatch(at.m.setOnGridQueryCellAddressByQueryId({queryId:a,onGridQueryCellAddress:l})),h&&this.store.dispatch(at.m.setOnGridQueryElseCategoryOverrideByQueryId({queryId:a,elseCategoryOverride:h}))),this.telemetryLogger.setQuerySource(t),De.B.getInstance().setQuerySource(t),(0,We.jGm)()&&"ExcelChartStyles"===u&&c){const e=r===G.Rk.GridSkittleMenu||"ViaOOUI"===r?.toString(),t=new ie.w;try{[t.chartProperties,t.sheetId]=await async function(e,t,a){return Excel.run((async n=>{const o=t?n.workbook.worksheets.getItemOrNullObject(t):n.workbook.worksheets.getActiveWorksheet(),r=o.charts.getItem(e);r.load(["chartType","name","id"]),o.load(["name"]);const i=r.getDataRange();if(await n.sync(),t&&o.isNullObject)throw new Error("Worksheet sent from the prompt does not exist.");const l=r.chartType,s=vt.ExcelCalc.sheetAddressToExcelSheetRange(i.value);let c=xt(s.range,o.id);if(a&&s){const e=n.workbook.worksheets.getItemOrNullObject(s.sheet);if(await n.sync(),!e.isNullObject){const t=await et.CP.getClosestTableInfo(e.id,i.value);if(!t)throw new Error("No closest table found for snowball chart");if(t.tabularRange)c=xt(t.tabularRange.range,e.id);else{if(!t.name)throw new Error("No range found for snowball chart");const a=e.tables.getItemOrNullObject(t.name);if(await n.sync(),a.isNullObject)throw new Error("No table found for snowball chart");const r=a.getRange();await n.sync(),r.load(["address"]),await n.sync();const i=r.address;if(!i)throw new Error("No table address found for snowball chart");c=xt(vt.ExcelCalc.sheetAddressToExcelSheetRange(i).range,o.id)}}}return[{chartType:l.toString(),chartSourceDataRange:c,seriesSourceDataRange:[],chartId:r.id,chartName:r.name},o.name]}))}(c,s,d)}catch(t){if($e.M.getInstance().logError({eventType:Z.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: Error fetching chart properties",logLevel:i.$b.Error}),d){const{message:t,telemetry:a}=gt.n.getChartDesignRecommendationsSnowballChartResponseMessage(o||(0,pt.A)(),e);this.copilotChatUIHelper.displayResponse(t,a)}return void(this.ignoreExcelChartStylesWorkflow=!1)}this.copilotChatUIHelper.displayChartStylesResponse(o||(0,pt.A)(),e,(()=>{this.ignoreExcelChartStylesWorkflow=!1})),t.guid=a,t.uiLocale=(0,ye.Yd)(),t.outputLanguage="English";const l=await Excel.run((async e=>(0,It.A7)(e)));t.themeColors=l();n={operation:new M.g0({parentPath:["Signal",ie.w.getTypeName()],items:[{id:ke.r.generateId(),body:t}]}),workflowAnnotationType:ie.f.getTypeName()},setTimeout((()=>{(0,Xe.qK)("OfficeJsChartDesignRecommendations",this.store.dispatch((0,wt.Z)()).dataLocale||"en-us",!0)}),6e3),this.startChartDesignTimeout(a)}else n=await this.getDefaultSignalOperation(e,a,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,m,b);if(await et.CP.initMemo.promise(),!await this.shouldSendRequestToAugloop(e))return;(0,We.xLF)()||(r&&this.store.dispatch(at.m.setQueryOriginByQueryId({queryId:a,queryOrigin:r})),l&&this.store.dispatch(at.m.setOnGridQueryCellAddressByQueryId({queryId:a,onGridQueryCellAddress:l}))),this.copilotChatUIHelper.submitOperation(n)}else{if(await et.CP.initMemo.promise(),!await this.shouldSendRequestToAugloop(e))return;const a=o??(0,pt.A)();this.telemetryLogger.setQuerySource(t),De.B.getInstance().setQuerySource(t),r&&this.store.dispatch(at.m.setQueryOriginByQueryId({queryId:a,queryOrigin:r})),l&&this.store.dispatch(at.m.setOnGridQueryCellAddressByQueryId({queryId:a,onGridQueryCellAddress:l})),(0,We.xLF)()&&h&&this.store.dispatch(at.m.setOnGridQueryElseCategoryOverrideByQueryId({queryId:a,elseCategoryOverride:h}));const n=await this.getDefaultSignalOperation(e,a,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,m,b);this.copilotChatUIHelper.submitOperation(n)}a||this.updateCopilotState(P.SG.QUERY_SUBMITTED)}async handlePrivateApiExternalTriggeredQuery(e){if(!e.query)return void(0,Ue.cY)("externalTriggeredQuery query is missing");if(e.deprecated&&(0,We.yw9)("OfficeVSO_9601910_ExcelSdxUnifiedSendPrompt"))return void(0,Ue.cY)("Ignoring deprecated PrivateApiExternalTriggeredQuery");const t=await this.store.dispatch((0,Re.q9)());if(t)return void(0,Ue.cY)("Cannot handle externalTriggeredQuery, busy executing: "+t);const a=e.query;await this.submitExternalQuery(a,Ie.BC.ExternalQuery)}async handleUnifiedPrivateApiExternalTriggeredPrompt(e){if(!(0,We.yw9)("OfficeVSO_9601910_ExcelSdxUnifiedSendPrompt"))return;if(!e.promptProperties)return void(0,Ue.cY)("promptProperties is missing");const t=e.promptProperties,a=await this.store.dispatch((0,Re.q9)());if(a)return void(0,Ue.cY)("Cannot handle externalTriggeredQuery, busy executing: "+a);if(!t.sendPromptText)return void(0,Ue.cY)("sendPromptText is missing");const n=t.sendPromptText;this.userQueryGuid=t.userQueryGuid,this.isExternalQuerySubmitted=!0,this.queryOrigin=t.queryOrigin;let o=Ie.BC.ExternalQuery;t.queryOrigin===G.Rk.MsFormsSDX?o=Ie.BC.MsFormsSDX:t.queryOrigin===G.Rk.AAChartingRibbon&&(o=Ie.BC.AAChartingRibbon),await this.submitExternalQuery(n,o,t.isAutomaticPrompt,t.isMarkdownText,t.userQueryGuid,t.queryOrigin,t.queryOriginCellAddress,t.sheetName,t.chartId,t.isSnowballChart,t.activateWorkflow,t.fluxSkillOverride,t.elseCategoryOverride)}async handlePrivateApiExternalTriggeredPromptId(e){if(!e.promptId)return void(0,Ue.cY)("externalTriggeredPromptId, promptId is missing");const t=await this.store.dispatch((0,Re.q9)());if(t)return void(0,Ue.cY)("Cannot handle externalTriggeredPromptId, busy executing: "+t);const a={cellRow:e.cellRow,cellCol:e.cellCol},n=await this.getPromptById(e.promptId,a);n?await this.submitExternalQuery(n,Ie.BC.ExternalQuery):(0,Ue.cY)("No prompt found for promptId",e.promptId)}handlePrivateApiExternalDisplayMessages(e){(0,Ue.cY)("Received externalDisplayMessages",e);const t=e.messages;for(const e of t){if(this.copilotChatUIHelper.getHasMessageBeenShown(e.messageId,!0))continue;const{message:t,telemetry:a}=gt.n.getExternalMessageResponse(e);if(this.copilotChatUIHelper.displayResponse(t,a),e.suggestions){const t=e.suggestions.map((e=>({suggestionText:e,suggestionType:"SydneySuggestion"})));t.length>0&&this.store.dispatch(at.m.setSuggestionListDetails({suggestionList:t}))}}t.length>0&&this.copilotChatUIHelper.scrollToBottom()}resetExternalQuerySubmitted(){this.isExternalQuerySubmitted=!1,this.userQueryGuid=void 0}logExternalQuerySubmitted(){this.userQueryGuid&&this.telemetryEventHandler.updateTelemetryChatEventData({[Ie.h3.ChatEventType]:Ie.a5.ExternalQuery,[Ie.h3.Submitted]:this.isExternalQuerySubmitted?"true":"false",[Ie.h3.UserQueryGuid]:this.userQueryGuid},this.telemetryLogger)}attachPrivateApiHandlers(){be.s.getInstance().attachPrivateEventHandler("externalTriggeredQuery",(e=>{var t;t=e,void 0!==t?.eventName&&void 0!==t?.query&&this.handlePrivateApiExternalTriggeredQuery(e)})),be.s.getInstance().attachPrivateEventHandler("externalTriggeredPromptId",(e=>{var t;t=e,void 0!==t?.eventName&&void 0!==t?.promptId&&this.handlePrivateApiExternalTriggeredPromptId(e)})),be.s.getInstance().attachPrivateEventHandler(Vt,(e=>{var t;t=e,t?.eventName===Vt&&void 0!==t?.messages&&this.handlePrivateApiExternalDisplayMessages(e)})),be.s.getInstance().sendOnReadyEvent("copilotMessageHandlerAttached")}preloadAcceessTokenForOfficePySvc(){if((0,We.Ap6)()){(0,Bt.J)(Ht.UU,Ht.rE);const e=(new Date).getTime();Ae.v.instance().authorizeOfficePyService((0,pt.A)()).then((()=>{(0,_e.l5)(_e.xk.PreloadOfficePyServiceAccessToken,e,0)})).catch((t=>{(0,_e.l5)(_e.xk.GetOfficePyServiceAccessToken,e,0,!0);const a=(0,it.MQ)(t,"preloadAcceessTokenForOfficePySvc"),n=(0,it.Uc)(ae.O.GetOfficePyServiceAccessTokenFailed,a,void 0);(0,it.QX)(this.store.dispatch,n,!1)}))}}async handlePythonStartAnalysis(e){const t=(new Date).getTime();try{this.store.dispatch(at.m.setPythonStartAnalysisButtonDisabled(!0)),et.CP.pythonContextManager.shouldGenerate=!0,this.updateCopilotState(P.SG.QUERY_ENTERED);const a=(0,pt.A)();$e.M.userQueryGuid=a,De.B.userQueryGuid=a,e&&(this.telemetryLogger.setQuerySource(e),De.B.getInstance().setQuerySource(e)),this.preloadAcceessTokenForOfficePySvc(),(0,_e.F5)();const n=et.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextSheetId(),o=et.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextAddress(),r=await et.CP.pythonContextManager.pythonContextBuilder.getAllPythonCellsUptoAnalysisSheetWithTimeout(this.store.dispatch,n,o);if(await et.CP.pythonContextManager.pythonTrimmedContext.insertDataFrameIfNecessaryForStartAnalysis(r,this.store.dispatch),!et.CP.pythonContextManager.shouldGenerate)return;await et.CP.pythonContextManager.pythonTrimmedContext.setPythonStartAnalysisContext(r),(0,_e.Cc)(_e.xk.StartAnalysisContextExtraction,t,!1);const i=et.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextQuery();if(!i){const e="Undefined Item: query, Function: handleStartPythonAnalysis";throw(0,it.Uc)(ae.O.PythonContextUndefinedParameter,e,void 0)}this.store.dispatch(at.m.stopExecuting({isSuccess:!0,keepShowingLoadingUIIfAlreadyActive:!0}));const l=await this.getDefaultSignalOperation(i,a);(0,_e.lu)(),this.copilotChatUIHelper.submitOperation(l),this.updateCopilotState(P.SG.QUERY_SUBMITTED),this.store.dispatch(at.m.setSuggestionListDetails({suggestionList:[],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0})),et.CP.pythonContextManager.lastStartAnalysisQueryGuid=a}catch(e){throw(0,_e.Cc)(_e.xk.StartAnalysisContextExtraction,t,!0),e}}async handlePythonAdaExecutionResult(){this.updateCopilotState(P.SG.QUERY_ENTERED);const e=(0,pt.A)();$e.M.userQueryGuid=e,De.B.userQueryGuid=e;const t=et.CP.pythonContextManager.pythonTrimmedContext.getTrimmedContextQuery();if(!t){const e="Undefined Item: query, Function: handlePythonAdaExecutionResult";throw(0,it.Uc)(ae.O.PythonContextUndefinedParameter,e,void 0)}this.store.dispatch(at.m.stopExecuting({isSuccess:!0,keepShowingLoadingUIIfAlreadyActive:!0}));const a=await this.getDefaultSignalOperation(t,e);(0,Ue.cY)(`signalOperationData: ${a}`),(0,_e.lu)(),this.copilotChatUIHelper.submitOperation(a),this.updateCopilotState(P.SG.QUERY_SUBMITTED)}async handleTextAnalysisSuggestionQuerySubmission(e){await this.submitExternalQuery(e,Ie.BC.MenuItem)}getPythonMode(){return et.CP.pythonContextManager.isPythonMode}getIsAutoScrollingEnabled(){return et.CP.pythonContextManager.isAutoScrollingEnabled}onNewUserUtterance(){(0,Ee.s_)(Ee.H0.RemoveAll)}getFluxSkillOverride(e,t){const a=!!(0,We.eFk)()&&this.store.dispatch((0,Re.SW)()).started;if((0,We.EJJ)()&&!et.CP.pythonContextManager.isPythonMode&&this.isZQMForAnswers(e))return Gt["flux-answers"];if((0,We.H2A)()&&et.CP.pythonContextManager.isPythonMode)return(0,We.EJJ)()?Gt["flux-startAnalysisMode"]:Gt["flux-pythonAda"];if(a)return Gt["flux-dataShaping"];if(this.cannedOption)return Gt[this.cannedOption];if((0,We.geU)()){return(0,We.wyh)()??void 0}return t&&(0,We.xLF)()&&(0,We.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FluxSkillOverrideFromGrid",!1)?t:void 0}isZQMForAnswers(e){const t=e.trim().toLowerCase(),a=t===(0,o.N_T)().toLowerCase().trim(),n=t===(0,o.xf7)().toLowerCase().trim(),r=t===(0,o.pKA)().toLowerCase().trim(),i=t===(0,o.YYh)().toLowerCase().trim(),l=t===(0,o.Coj)().toLowerCase().trim(),s=(0,We.ggM)()&&t===(0,o.Bzb)().toLowerCase().trim();return a||n||r||i||l||s}getQueryOrigin(e){function t(t){return t.map((e=>e.toLowerCase())).includes(e.toLowerCase())}return t(Object.values(this.zeroQueryMessageTitles))?G.Rk.ChatZQM:t(this.suggestionList.map((({suggestionText:e})=>e)))?G.Rk.ChatPill:void 0}getClientCapabilities(){const e=[];return(0,_t.Qo)(this.store.dispatch)&&e.push(W.m.NonODSLFormulaGenerationSkill),(0,We.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)&&e.push(W.m.UnifiedNLToFormulaGenerationSkill),e.length>0?e:void 0}getAppEnvironment(){switch(Te.V.getSettingAsString(Te.z.AudienceGroup)){case k.Bv.Automation:case k.Bv.Test:case k.Bv.Dogfood:return O.D.DOGFOOD;case k.Bv.MSIT:case k.Bv.Microsoft:return O.D.PRODUCTION;case k.Bv.GCC:return O.D.GCC;default:return O.D.PRODUCTION}}getM365ChatEnvironmentFromSDXUrl(e=window.location.href){const t=e.toLowerCase();if(""===t)return Se.RD.Unknown;if(t.indexOf("dod.cdn")>=0)return Se.RD.DoD;if(t.indexOf("gcch.cdn")>=0)return Se.RD.GCCHigh;if(t.indexOf("gcc.cdn")>=0)return Se.RD.GCCModerate;return(t.indexOf("public.cdn")>=0||t.indexOf("public.onecdn")>=0||t.indexOf(".resources.office")>=0)&&t.indexOf("033f92d3-bc6d-439a-858a-a17acf70360a")>=0?Se.RD.Production:Se.RD.Unknown}getM365ChatEnvironment(){if((0,We.iPS)("Microsoft.Office.Excel.FA000000124.MapEnvironmentFromSDXUrl",!0)){const e=this.getM365ChatEnvironmentFromSDXUrl();if(e!==Se.RD.Unknown)return e}switch(Te.V.getSettingAsString(Te.z.AudienceGroup)){case k.Bv.Automation:case k.Bv.Test:case k.Bv.Dogfood:return Se.RD.Dogfood;case k.Bv.MSIT:case k.Bv.Microsoft:return Se.RD.MSIT;case k.Bv.Prod:case k.Bv.Production:return Se.RD.Production;case k.Bv.GCC:return Se.RD.GCCModerate;default:return Se.RD.Unknown}}setBizChatHostContext(e){this.bizChatHostContext=e}setBizChatHostContextSetter(e){this.setBizChatHostContextState=e}setCopilotChatLoadedSetter(e){this.setCopilotChatLoadedState=e}getPopulateCellCount(){return Excel.run((e=>{const t=e.workbook.worksheets.getActiveWorksheet().getUsedRange();return t.load("values"),e.sync().then((()=>{let e=0;return t.values.forEach((t=>{t.forEach((t=>{null!=t&&""!==t&&e++}))})),e}))}))}async getDocumentContextFromDocumentUrlAsync(){const e=await(0,ye.H5)(),t=$.Kj.init({authProvider:async e=>{const t=await(0,ct.m4)(),a=t.preferredAuthenticationStrategy??"Default";let n;n=(0,We.AJD)()&&t.nestedAppAuthRedirectUri&&"NestedAppAuth"===a?new K.G({userPrincipalName:t.userPrincipalName,redirectUri:t.nestedAppAuthRedirectUri,clientId:F.pL}):new ee.a({userPrincipalName:t.userPrincipalName,redirectUri:t.redirectUri,clientId:F.pL});e(null,(await(0,_.v)(n,"https://graph.microsoft.com")).accessToken)},baseUrl:"https://graph.microsoft.com"}),a=await t.api(`/shares/u!${btoa(e)}/root?$select=sharepointIds,id,name`).get(),n=a?.sharepointIds?.siteId,o=a?.sharepointIds?.webId,r=a?.sharepointIds?.listId,i=a?.id;return{spoId:`SPO_${btoa(`${n},${o},${r}`)}_${i}`.replace(/=/g,""),fileName:a.name}}shouldHandoffToBizChat(){return this.isCopilotChatLicensedUser()&&(0,We.UIZ)()}isCopilotChatLicensedUser(){if(!this.bizChatHostContext?.PrimaryUserAccountInfo)return!1;const e=this.bizChatHostContext.PrimaryUserAccountInfo.AggregatedLicensedFeatures??this.bizChatHostContext.PrimaryUserAccountInfo.LicensedFeatures??void 0;return!!e&&(!e.includes("Copilot")&&(e.includes("CopilotStarter")||e.includes("CopilotChat")))}startChartDesignTimeout(e){const t=(0,We.kRR)();this.chartDesignActiveQueryId=e,this.chartDesignActiveQueryTimeoutId=setTimeout((async()=>{(0,Ue.cY)(`Chart design operation timed out: ${e}`),this.chartDesignActiveQueryId=void 0,$e.M.getInstance().logError({eventType:Z.S2.ChartDesignRecommendations,errorMessage:`[ChartDesignRecommendations]: Chart operation timed out after ${t}ms: ${e}`,logLevel:i.$b.Error});try{const{message:e,telemetry:t}=gt.n.getChartDesignRecommendationsFailedResponse((0,o.Hum)(),Ie.q0.NoSuggestions);Q.$.getInstance().displayResponse(e,t),await this.responseHandler.handleChartDesignNoRecommendationResult()}catch(e){$e.M.getInstance().logError({eventType:Z.S2.ChartDesignRecommendations,errorMessage:`[ChartDesignRecommendations]: Error handling timeout: ${e}`,logLevel:i.$b.Error})}}),t)}clearChartDesignTimeout(){this.chartDesignActiveQueryTimeoutId&&(clearTimeout(this.chartDesignActiveQueryTimeoutId),this.chartDesignActiveQueryTimeoutId=void 0),this.chartDesignActiveQueryId=void 0}handleHandoffMessageHostAppSettingsIfNeeded(){this.shouldHandoffToBizChat()&&se.Y.getInstance().handleHandoffMessageHostAppSettings(this.setBizChatHostContextState,this.bizChatHostContext,this.handleStartQuery.bind(this))}constructor(e,t,a){super(),this.telemetryLogger=$e.M.getInstance(),this.telemetryEventHandler=Be.E.getInstance(),this.copilotChatUIHelper=Q.$.getInstance(),this.suggestionList=[],this.zeroQueryMessageTitles={},this.loggingEventHelper=new Ye([]),this._cannedOption=void 0,this.sessionRestartedDueToModelWorkflowNotSupported=(0,yt.$q)(),this.xlimWorkflowProgressHandler=new tt,this.isExternalQuerySubmitted=!1,this.ignoreExcelChartStylesWorkflow=!1,this.suggestionPillShown=new Set,this.debugEvents=new EventTarget,this.bizChatHostContext=void 0,this.setBizChatHostContextState=()=>{},this.setCopilotChatLoadedState=()=>{},this.unifiedPromptHandler=async e=>{qt(e)&&(this.resetExternalQuerySubmitted(),await this.handleUnifiedPrivateApiExternalTriggeredPrompt(e),this.logExternalQuerySubmitted())},this.store=e,this.responseHandler=t,this.handleCopilotAgentFromHostRequest=a,this.initializeAlCallbacks()}}},107295:(e,t,a)=>{"use strict";a.d(t,{i:()=>i,z:()=>r});var n=a(528804);const o={isPythonMode:!1};function r(e){o.isPythonMode=e}function i(){return(0,n.yw9)("OfficeVSO_10340818_Add_ModelessAAFeatureGateCheck")?!o.isPythonMode&&(0,n.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAAFallback",!1):!o.isPythonMode}},108869:(e,t,a)=>{"use strict";a.d(t,{MA:()=>Ue,t2:()=>$e,e1:()=>ze,nC:()=>Re,J7:()=>Le,Yp:()=>ie,jC:()=>We,bf:()=>Ve,lE:()=>Ge,ec:()=>He,UH:()=>re,OU:()=>O,vv:()=>de,Jy:()=>le,VF:()=>ke,$e:()=>be,u1:()=>he,eU:()=>Ce,dd:()=>Te,WH:()=>ye,RW:()=>we,yK:()=>ge,ZK:()=>ue,B4:()=>se,cx:()=>ae,WM:()=>oe,gQ:()=>ne,c3:()=>fe,EA:()=>Qe,Tk:()=>je,Gd:()=>k,XT:()=>N,gx:()=>P,IY:()=>xe,i_:()=>et,C6:()=>_,Hq:()=>qe,$:()=>F,U6:()=>tt,PV:()=>De,mx:()=>Me,FN:()=>Be,bh:()=>Oe,Xn:()=>D,sy:()=>M,o7:()=>ce,AJ:()=>me,ZD:()=>Se,Dh:()=>Ae,LX:()=>Ke,LC:()=>pe});var n=a(797639),o=a(79458),r=a(632512),i=a(755005),l=a(449650),s=a(262452),c=a(722307),d=a(99394),u=a(9847),m=a(267324),h=a(60398),g=a(965634),p=a(235373),b=a(202051),f=a(910480),C=a(750927),y=a(528804),v=a(4091),x=a(348065),T=a(991869),S=a(977055);class w{getNextAvailableSheetName(e){const t=this.getSheetName(),a=ae(t),n=e.map((e=>{const t=a.exec(e);return t?Number(t[1]):null})),o=n.filter((e=>null!==e&&e>=this.currentSheetNumber));o.sort(((e,t)=>e-t));for(const e of o){if(e!==this.currentSheetNumber)break;this.currentSheetNumber++}const r=t+this.currentSheetNumber;return this.currentSheetNumber++,r}constructor(e){this.currentSheetNumber=1,this.getSheetName=e}}const E=new w(m.I_l),I=new w(m.r5N);var R=a(131778),A=a(495501),L=a(516999);function k(){let e=d.V.getSettingAsString(d.z.HasActivePythonLicense)??"false";const t=d.V.getSettingAsString(d.z.AudienceGroup);return(0,y.$0$)()&&"Production"!==t&&(e="true"),"true"===e}function F(){return"true"===(d.V.getSettingAsString(d.z.IsPythonExecutionBlockedByAdmin)??"false")}function _(){const e=[Office.PlatformType.PC];return(0,y.$0$)()&&e.push(Office.PlatformType.OfficeOnline),(0,y.G7K)()&&e.push(Office.PlatformType.Mac),e.includes(Office.context.platform)}function P(){try{(0,b.iY)((0,T.gl)())}catch(e){return!1}return!0}function N(){try{(0,b.lB)((0,T.gl)())}catch(e){return!1}return!0}const M=/^=[ ]*PY\(/,O=/.*['"],\s*0\)/,D=/^<class.*>$/,B=/["'\s]/g,$=RegExp("=[ ]*PY\\(['\"](.*)['\"],\\s*[01]\\s*\\)","s"),H=/[^a-zA-Z0-9_]/g,U=/^[^a-zA-Z_].*$/,q=/([A-Z]+|[0-9]+)/g,V=/[a-zA-Z0-9]/,G=/\}/g,W=/\{/g,z=/\^/g,j=/\$/g,Q=/\(/g,J=/\)/g,Y=/\./g,X=/\+/g,Z=/\|/g,K=/"/g,ee=/'/g,te=/''/g;function ae(e){return new RegExp(`^${e}([0-9]+)$`)}function ne(e,t,a){const n=t.replace(q,"\\$?$1");return new RegExp(`.+\\s*=\\s*xl\\s*\\(\\s*\\"${a?`'?${e}'?!`:""}${n}".*\\)\\s*`)}function oe(e,t){if(e.includes("\\")){return new RegExp(`.+\\s*=\\s*xl\\s*\\(\\s*(?:r|R)\\"${(0,f.escapeRegExp)(e)}\\[${(0,f.escapeRegExp)(t)}]".*\\)\\s*`)}return new RegExp(`.+\\s*=\\s*xl\\s*\\(\\s*\\"${e}\\[${(0,f.escapeRegExp)(t)}]".*\\)\\s*`)}function re(e){return e.replaceAll(ee,"''").replaceAll(K,'\\\\"').replaceAll(G,"\\}").replaceAll(W,"\\{").replaceAll(z,"\\^").replaceAll(j,"\\$").replaceAll(J,"\\)").replaceAll(Q,"\\(").replaceAll(Y,"\\.").replaceAll(X,"\\+").replaceAll(Z,"\\|")}function ie(e,t,a){let n="";const[o,r]=le(t);n=V.test(e)?e.replaceAll(H,"_")+"_df":V.test(o)?o.replaceAll(H,"_")+"_df":(a+r).replaceAll(H,"_")+"_df";return n.match(U)?"_"+n:n}function le(e){return[l.ExcelCalc.sheetNameFromSheetAddresses(e).replaceAll(te,"'"),l.ExcelCalc.localAddressesFromSheetAddresses(e)]}function se(e,t){const[a,n]=le(e),o=t.get(e)?.sheetId;if(!o){const e="getSheetAndAddress: sheet deleted";throw(0,b.Uc)(r.O.PythonUnexpectedMissingSheetInContextExtraction,e,void 0)}return{sheet:o,address:n}}function ce(e){return e.replace(B,"")}function de(e){const t=$.exec(e);return(null!=t?t[1]:"").replace(/""/g,'"')}function ue(e,t,a){let n;return e=e.replace(/"/g,'""'),n=t?`=PY("${e}", ${a})`:`"=PY(""${e=e.replace(/"/g,'""')}"",${a})"`,n}async function me(e,t,a,n,o,l,s){const c=performance.now();let d;try{if(s?.signal.aborted)throw(0,b.Uc)(r.O.PythonContextExtractionAborted,"retryForPythonScenario was aborted.",void 0);return o&&(d=await l((0,v.q9)()),d!==u.OP.PythonCellsCalculating&&l(p.m.startExecutingCommand({command:u.OP.PythonCellsCalculating}))),await(0,L.U)(e,t,(()=>!1),a,void 0,!0,n,s)}catch(e){if(!e){let e="";throw e=`Empty response from retryIf, Total Wait Time (ms): ${performance.now()-c}, Retry Interval (ms): ${n}, Max Attempts: ${a}`,(0,b.BH)(e)}if(e instanceof Error&&e.name===i.UW.AbortError)throw(0,b.Uc)(r.O.PythonContextExtractionAborted,"retryForPythonScenario was aborted.",e);throw e}finally{d&&d!==u.OP.PythonCellsCalculating&&l(p.m.startExecutingCommand({command:d}))}}function he(e,t){const a=new Map([[Excel.ErrorCellValueType.python,"#PYTHON"],[Excel.ErrorCellValueType.timeout,"#TIMEOUT"]]),n=(0,m.YCq)(),o=a.get(e);return o?(0,C.L)((0,m.IiW)(),o,t):n}function ge(e){return`from excel import xl_ref as xl\nimport excel\n\n_ref_context = excel.get_ref_context()\n_ref_context.clear()\n_ref_context["stored_value"] = excel.ObjectReference("${e}")\n\nprimitives = (bool, str, int, float, type(None))\nvalue = None\nvalue_type = type(xl("stored_value"))\nis_data_frame = value_type == pd.DataFrame\nis_primitive = value_type in primitives\nif is_data_frame:\n  numRows = xl("stored_value").shape[0]\n  value = {\n    "columnNames": xl("stored_value").columns.values.tolist(),\n    "dataTypes": xl("stored_value").dtypes.tolist(),\n    "firstRowValues": xl("stored_value").iloc[0].values.tolist() if numRows > 0 else [],\n    "secondRowValues": xl("stored_value").iloc[1].values.tolist() if numRows > 1 else [],\n    "sampleRows": xl("stored_value").head(20).values.tolist() if numRows > 0 else [],\n    "numRows": numRows,\n    "numColumns": xl("stored_value").shape[1],\n  }\nelif is_primitive:\n  value = xl("stored_value")\nreturnValue = {\n  "value": value,\n  "value_type": value_type,\n  "is_data_frame": is_data_frame,\n  "is_primitive": is_primitive,\n}\nreturnValue`}function pe(e){return e.map((e=>void 0===e?.value?e:e.value))}function be(e){const t=e.valuesAsJson[0][0];return{errorName:t.errorName,errorType:t.errorType??"",errorSubType:t.errorSubType,errorMessage:t.errorMessage}}function fe(e){if(e.includes("!")){return`'${l.ExcelCalc.sheetNameFromSheetAddresses(e)}'!${l.ExcelCalc.localAddressesFromSheetAddresses(e)}`}return e}async function Ce(){return Excel.run((async e=>(e.application.load("calculationMode"),await e.sync(),e.application.calculationMode)))}async function ye(e,t){const a=e.workbook.worksheets.getItemOrNullObject(t);if(!a){const{sheet:t}=await Ie(e,n.CP);return t}return a}async function ve(e,t){const a=e.workbook.worksheets.load("items/name");await e.sync();const n=a.items.map((e=>e.name)),o=t(n);return a.add(o)}async function xe(e){const t=await ve(e,I.getNextAvailableSheetName.bind(I));return await e.sync(),t}async function Te(e,t){try{const a=e.customProperties.getItemOrNullObject("lastPythonCell");if(a.load("value,isNullObject"),await t.sync(),!a.isNullObject)return JSON.parse(a.value)}catch(e){const t=(0,b.pX)(e,"getLastPythonCellCustomProperty: Failed to retrieve last Python cell custom property.");(0,b.QX)((0,x.KA)().dispatch,t,!1)}return null}async function Se(e,t,a){try{e.customProperties.add("lastPythonCell",JSON.stringify(a)),await t.sync()}catch(e){const t=(0,b.pX)(e,"setLastPythonCellCustomProperty: Failed to set last Python cell custom property.");(0,b.QX)((0,x.KA)().dispatch,t,!1)}}async function we(){let e="";try{(0,y.EeR)()&&await Excel.run((async t=>{const a=t.workbook.worksheets.getActiveWorksheet();await Ee(a,t)&&((0,S.PB)(g.L3.AdvancedAnalysisStartedFromAnalysisSheet,[]),a.load("name"),await t.sync(),e=a.name)}))}catch(t){const a=(0,b.pX)(t,"getPythonAnalysisSheetName: Failed to retrieve Python analysis sheet name.");(0,b.QX)((0,x.KA)().dispatch,a,!1),e=""}return e}async function Ee(e,t){try{const a=e.customProperties.getItemOrNullObject("isPythonAnalysisSheet");return a.load("value"),await t.sync(),!!a&&"true"===a.value}catch(e){const t=(0,b.pX)(e,"getPythonAnalysisCustomProperty: Failed to retrieve custom metadata for the Python analysis sheet.");return(0,b.QX)((0,x.KA)().dispatch,t,!1),!1}}async function Ie(e,t){const a=await ve(e,E.getNextAvailableSheetName.bind(E));a.load("id");const n=a.getRange("A1");return n.values=[[(0,m.Efv)()]],n.format.font.bold=!0,n.format.font.size=24,n.format.font.color=R.e,a.getRange("A2").values=[[(0,m.LAW)()]],function(e){e.customProperties.add("isPythonAnalysisSheet","true")}(a),await e.sync(),a.activate(),t.pythonContextManager.pythonAnalysisSheetId=a.id,{id:a.id,sheet:a}}async function Re(e,t){let a="";return await Excel.run({delayForCellEdit:!1},(async n=>{const o=t.pythonContextManager.pythonAnalysisSheetId;if(o){const i=n.workbook.worksheets.getItemOrNullObject(o);if(i.load("isNullObject"),await n.sync(),i.isNullObject){if(t.pythonContextManager.pythonAnalysisSheetExistsOnUserQuerySubmit)throw(0,b.Vp)(r.O.PythonDeletedSheetDuringResponseGeneration,"",void 0);{const o=(0,b.Vp)(r.O.PythonDeletedSheetBeforeResponseGeneration,"",void 0);(0,b.QX)(e,o,!0);const{id:i}=await Ie(n,t);a=i}}else i.activate(),a=o}else{const{id:e}=await Ie(n,t);a=e}})),a}async function Ae(e,t){if((0,y.EeR)()){!n.CP.pythonContextManager.pythonAnalysisSheetId&&await Ee(e,t)&&(e.load("id"),await t.sync(),n.CP.pythonContextManager.pythonAnalysisSheetId=e.id)}}async function Le(e){const t=e.pythonContextManager.pythonAnalysisSheetId;if(t){let e=!1;return await Excel.run((async a=>{const n=a.workbook.worksheets.getItemOrNullObject(t);n.load("isNullObject"),await a.sync(),e=!n.isNullObject})),e}return!1}function ke(e,t){const a=function(e){return e.replaceAll(ee,"''").replaceAll(K,'\\"')}(l.ExcelCalc.sheetNameFromSheetAddresses(e)),n=l.ExcelCalc.addressToExcelRange(l.ExcelCalc.localAddressesFromSheetAddresses(e));return n.bottomRight.row&&(n.bottomRight.row-=t?1:0),`'${a}'!${l.ExcelCalc.IExcelRangeToAddress(n)}`}function Fe(e,t){return"sampleRows"===e||"columnNames"===e||"dataTypes"===e?JSON.stringify(t):t}function _e(e,t){(0,o.cY)(o.SA.Verbose,`%cPython Ada ${e}`,`\n      font-size: 1em;\n      padding: 0.5em 2em;\n      margin: 1em 0;\n      color: white;\n      background-color: ${t};\n      border-radius: 10%;\n      `)}function Pe(e){(0,o.cY)(o.SA.Verbose,"Python Ada: "+e)}function Ne(e){return JSON.stringify(e,Fe,4).replace(/\\n/g,"\n").replace(/\\/g,"").replace(/"\[/g,"[").replace(/\]"/g,"]").replace(/"\{/g,"{").replace(/\}"/g,"}")}function Me(e){if((0,o.K_)()){_e("Context","blue");Pe(Ne(e))}}function Oe(e){(0,o.K_)()&&(_e("Prompt","blue"),Pe(e||"Prompt is empty."))}function De(e){if((0,o.K_)()){_e("Response Chunks","blue");const t=e.filter((e=>"debugText"!==e.type));0===t.length?Pe("Response Chunks are empty."):t.forEach((e=>{Pe(Ne(e))})),_e("Debug Chunks","blue");const a=e.filter((e=>"debugText"===e.type));0===t.length?Pe("Debug Chunks are empty."):a.forEach((e=>{Pe(Ne(e))}))}}function Be(e){_e("Python Error","red");Pe(e.toString())}async function $e(e,t,a){try{t.format.autofitRows(),await e.sync(),t.untrack()}catch(e){const t=(0,b.zj)(r.O.PythonAutofitFailed,"",e);(0,b.QX)(a,t,!1)}}function He(e,t){return!e.some((e=>e.type===t))}function Ue(e,t){return(t?.trim()?"#"+t+"\n":"")+e}function qe(e){return e===i.qf.PngImageFile||e===i.qf.ImageFile||tt()&&(e===i.qf.PythonPlot||e===i.qf.MatplotlibPlot)}async function Ve(e,t){try{if((0,y.yw9)("OfficeVSO_10425729_TurnOffTeachingCalloutForMAA")&&et())return;n.CP.pythonContextManager.alreadyShownTui||await async function(e){await Excel.run({delayForCellEdit:!1},(async t=>{await e(t)}))}((async a=>{const n=a.workbook.worksheets.getItem(e).getRange(t);await We(n,"ShowPythonAdvancedAnalysisWave1A2")}))}catch(e){(0,b.RA)(e)}}async function Ge(e){try{if((0,y.yw9)("OfficeVSO_10425729_TurnOffTeachingCalloutForMAA")&&et())return;n.CP.pythonContextManager.alreadyShownTui||(n.CP.pythonContextManager.disableAutoScroll=!0,await async function(e){(0,c.vI)()===Office.PlatformType.OfficeOnline?s.s.getInstance().NativeServices.IPythonAAPrivateSdxApiService.value.showTeachingCalloutScenario(e):await OfficeFirstParty.PrivateApi.execute(e)}(e),n.CP.pythonContextManager.alreadyShownTui=!0,(0,S.Rj)(e))}catch(e){(0,b.RA)(e),n.CP.pythonContextManager.alreadyShownTui=!1}}async function We(e,t){try{if((0,y.yw9)("OfficeVSO_10425729_TurnOffTeachingCalloutForMAA")&&et())return;n.CP.pythonContextManager.alreadyShownTui||(n.CP.pythonContextManager.disableAutoScroll=!0,e.showTeachingCallout((0,m.g$5)(),(0,m.Toc)()),await e.context.sync(),n.CP.pythonContextManager.alreadyShownTui=!0,(0,S.Rj)(t))}catch(e){(0,b.RA)(e)}}async function ze(e){return await Excel.run({delayForCellEdit:!0},(async t=>{try{const a=t.workbook.worksheets.getActiveWorksheet().load(["protection/protected","protection/isPaused"]);return await t.sync(),!(a.protection.protected&&!a.protection.isPaused)||((0,b.Kx)(e,new h.H({errorCode:r.O.PythonProtectedSheetObjectInsertionError}),"canEditCurrentWorksheet",!1),!1)}catch(t){return(0,b.Kx)(e,new h.H({errorCode:r.O.PythonProtectedSheetObjectInsertionError,innerError:t}),"canEditCurrentWorksheet",!1),!1}}))}async function je(e){try{n.CP.pythonContextManager.exitAdvancedAnalysisMode()}catch(e){n.CP.pythonContextManager.setIsPythonMode(!1),n.CP.pythonContextManager.unregisterOnNewEntry();const t=e instanceof Error?`Function: pythonContextManager.exitAdvancedAnalysisMode, Stack: ${e.stack}`:"Function: pythonContextManager.exitAdvancedAnalysisMode",a=(0,b.$C)(t,e);(0,b.QX)((0,x.KA)().dispatch,a,!1)}finally{(0,S.PB)(g.L3.ExitAnalysisClicked,[]),(0,x.KA)().dispatch((0,v.Nl)()),await(0,x.KA)().dispatch((0,v.L4)(e)),A.n.displayPythonTextResponse((0,x.KA)().dispatch,(0,m.Lby)(),!1)}}function Qe(e,t){Excel.run((async a=>{try{const n=a.workbook.worksheets.getItemOrNullObject(e);if(await a.sync(),n.isNullObject)return;n.activate(),n.getRange(t).select(),await a.sync()}catch{(0,S.PB)(g.L3.GoBackToAnalysisSheetFailed,[])}}))}const Je=["int","int8","int16","int32","int64","pandas.core.dtypes.Int64Dtype","numpy.intp","numpy.uintp","numpy.int8","numpy.uint8","numpy.int16","numpy.uint16","numpy.int32","numpy.uint32","numpy.int64","numpy.uint64","numpy.byte","numpy.ubyte","numpy.short","numpy.ushort","numpy.intc","numpy.uintc","numpy.long","numpy.ulong","numpy.longlong","numpy.ulonglong","float","float16","float32","float64","float96","float128","Float","numpy.float16","numpy.float32","numpy.float64","numpy.float96","numpy.float128","numpy.half","numpy.single","numpy.double","numpy.longdouble","bool","bool_","numpy.bool","numpy.bool_","BoolDtype","str","string","str_","ellipsis","function","module","NoneType","type","undefined"],Ye=["scipy.","sklearn.","pandas.core.","pandas.io.","networkx."],Xe=["pandas.core.frame.DataFrame","pandas.core.series.Series","PIL.PngImagePlugin.PngImageFile"],Ze=Je.map((e=>"<class '"+e+"'>"));function Ke(e){return"Error"!==e.outputType&&(t=e.outputType,!Ze.includes(t)&&!function(e){const t=Ye.map((t=>e.includes(t))).some((e=>e));if(t){return!Xe.map((t=>e.includes(t))).some((e=>e))}return t}(e.outputType));var t}function et(){return(0,y.EJJ)()&&!n.CP.pythonContextManager.isPythonMode}function tt(){return(0,y.tMD)()&&!et()}},111570:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(171755),o=a.n(n),r=a(982649),i=a.n(r)()(o());i.push([e.id,'.chart>svg{overflow:hidden}.pivot-table-light16{font-size:12px;font-size:15px;line-height:21px;overflow:hidden;width:100%}.pivot-table-light16 thead tr:first-child{border-top:1px solid rgba(0,0,0,0);border-bottom:1px solid #dce6f1}.pivot-table-light16 thead tr:last-child{border-bottom:1px solid #7ca6d5}.pivot-table-light16__ellipsis{font-size:20px;line-height:21px;overflow:hidden;width:100%}.pivot-table-light16__table{border:none;border-collapse:collapse}.pivot-table-light16__text{height:21px;overflow:hidden;padding:0 4px;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .pivot-table-light16__text{text-align:left}html[dir=rtl] .pivot-table-light16__text{text-align:right}.pivot-table-light16__header{font-weight:bold}.pivot-table-light16__body{border-bottom:1px solid rgba(0,0,0,0)}html[dir=ltr] .pivot-table-light16__right-aligned{text-align:right}html[dir=rtl] .pivot-table-light16__right-aligned{text-align:left}.pivot-table-light16__grand-total{font-weight:bold}.pivot-table-light16__subtotal{font-weight:bold}.pivot-table-light16__highlight-cell{color:#ed7331}.pivot-table-light16__subtotal-row{border-bottom:1px solid #7ca6d5}.pivot-table-light16__grand-total{border-top:1px solid #7ca6d5;border-bottom:1px solid rgba(0,0,0,0)}.pivot-table-light16__subtotal{border-bottom:1px solid #7ca6d5}.query-result{font-size:15px;line-height:21px;overflow:hidden;width:100%}.query-result thead tr:first-child{border-top:1px solid rgba(0,0,0,0);border-bottom:1px solid #dce6f1}.query-result thead tr:last-child{border-bottom:1px solid #7ca6d5}.query-result__ellipsis{font-size:20px;line-height:21px;overflow:hidden;width:100%}.query-result__table{border:none;border-collapse:collapse}.query-result__text{height:21px;overflow:hidden;padding:0 4px;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .query-result__text{text-align:left}html[dir=rtl] .query-result__text{text-align:right}.query-result__header{font-weight:bold}.query-result__body{border-bottom:1px solid rgba(0,0,0,0)}html[dir=ltr] .query-result__right-aligned{text-align:right}html[dir=rtl] .query-result__right-aligned{text-align:left}.query-result__grand-total{font-weight:bold}.query-result__subtotal{font-weight:bold}.query-result__highlight-cell{color:#ed7331}.query-result__no-headers{padding:0 4px}.recommendation{list-style:none;margin-left:20px;margin-right:20px;border:1px solid #e0e0e0;position:relative;outline:none;border-style:none}.theme-colorful .recommendation{background-color:#fff}.theme-dark-gray .recommendation{background-color:#fff}.theme-black .recommendation{background-color:#fff}.theme-white .recommendation{background-color:#fff}.theme-colorful .recommendation{color:#262626}.theme-dark-gray .recommendation{color:#262626}.theme-black .recommendation{color:#262626}.theme-white .recommendation{color:#262626}.recommendation::after{-webkit-pointer-events:none;-o-pointer-events:none;-moz-pointer-events:none;-ms-pointer-events:none;pointer-events:none;content:"";position:absolute;left:0;top:0;bottom:0;right:0;border-radius:2px;border-width:2px}.theme-colorful .recommendation::after{border-color:#c6c6c6}.theme-dark-gray .recommendation::after{border-color:#444}.theme-black .recommendation::after{border-color:#505050}.theme-white .recommendation::after{border-color:#c6c6c6}html[dir=ltr] .recommendation::after{box-shadow:0 2px 4px -0.75px rgba(0,0,0,.1)}html[dir=rtl] .recommendation::after{box-shadow:0 2px 4px -0.75px rgba(0,0,0,.1)}.theme-colorful.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#107c41}.theme-dark-gray.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#4e9668}.theme-black.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#4e9668}.theme-white.ms-Fabric--isFocusVisible .recommendation:focus::after{border-color:#107c41}@media screen and (-ms-high-contrast: active),screen and (forced-colors: active){.recommendation:focus::after{border-style:dashed}}.theme-colorful .recommendation:hover::after{border-color:#107c41}.theme-dark-gray .recommendation:hover::after{border-color:#4e9668}.theme-black .recommendation:hover::after{border-color:#4e9668}.theme-white .recommendation:hover::after{border-color:#107c41}@media screen and (-ms-high-contrast: active),screen and (forced-colors: active){.recommendation:hover::after{border-style:dashed}}.recommendation__chart,.recommendation__pivot-table,.recommendation__empty-pivot-table,.recommendation__query-result,.recommendation__text-analysis-tagging{margin:8px 0 0}.recommendation__chart{padding-top:50%;position:relative;border:1px solid #e0e0e0;border-radius:2px}.recommendation__chart .chart{position:absolute;top:0;left:0;right:0;bottom:0}.recommendation__pivot-table{border:1px solid #e0e0e0;border-radius:2px}.recommendation__empty-pivot-table,.recommendation__query-result,.recommendation__text-analysis-tagging{padding:12px;border:1px solid #e0e0e0;border-radius:2px}.recommendation__invalid{background-color:#edebe9;opacity:.5}.recommendation__title{display:flex}.recommendation__title button{margin-top:13px;width:16px;height:16px;top:0;z-index:1}html[dir=ltr] .recommendation__title button{margin-left:10px}html[dir=rtl] .recommendation__title button{margin-right:10px}.recommendation__title button i{font-size:12px}.recommendation__title-group:last-child{padding-bottom:8px}.recommendation__collapsed{cursor:pointer}.recommendation__footer{font-family:"Segoe UI";font-style:normal;font-weight:400;font-size:12px;line-height:16px;display:flex;align-items:center;color:#242424}.recommendation__footer-insert-explain{margin:0px 8px 8px 8px;border:1px solid #d1d1d1;border-radius:4px}.recommendation-title{font-size:14px;font-weight:700;line-height:20px;margin:0;vertical-align:top;text-overflow:ellipsis;overflow:hidden}.recommendation-title__rich-text__0{color:rgb(187.975,85.775,16.425)}.recommendation-title__rich-text__1{color:blue}.recommendation-subtitle{color:#323130;font-size:12px;margin:0;padding:2px 0 4px;vertical-align:top;word-wrap:break-word;overflow-wrap:break-word}.explanation-dropdown{color:#107c41;font-size:12px}.explanation-dropdown:hover{color:#0f703b}.explanation-dropdown:active{color:#094624}.explanation-dropdown:disabled{color:#bdbdbd}.explanation-dropdown i{color:inherit}.explanation-content{margin:0px 8px}.column-recommendation .formula-description{padding:0;box-sizing:border-box}.column-recommendation .formula-description p{all:inherit}.python-recommendation__title{font-weight:600;margin-top:12px;color:#242424}.python-recommendation .monaco-read-only{width:auto}.python-recommendation .monaco-read-only .monaco-editor .cursors-layer>.cursor{display:none !important}.python-recommendation .python-description{margin:8px 0px 0px;padding:0;box-sizing:border-box}.python-recommendation .python-description p{all:inherit}.recommendation__text-analysis__bullet-header{font-weight:bold}.AugloopDiganosticsPaneContainer{overflow:auto;padding-left:"2%";margin:0;width:"96%"}.hideOverflow{width:90%;text-overflow:ellipsis}.tree{--spacing: 1rem;--radius: 7px;padding-left:0;padding-inline-start:0}.tree li{display:block;position:relative;padding-inline-start:0;padding-left:calc(2*var(--spacing) - var(--radius) - 2px)}.tree ul{margin-left:calc(var(--radius) - var(--spacing));padding-left:0;padding-inline-start:0}.tree ul li{border-left:2px solid #ddd}.tree ul li:last-child{border-color:rgba(0,0,0,0)}.tree ul li::before{content:"";display:block;position:absolute;top:calc(var(--spacing)/-2);left:-2px;width:calc(var(--spacing) + 2px);height:calc(var(--spacing) + 1px);border:solid #ddd;border-width:0 0 2px 2px}.tree summary{display:block;cursor:pointer}.tree summary::marker,.tree summary::-webkit-details-marker{display:none}.tree summary:focus{outline:none}.tree summary:focus-visible{outline:1px dotted #000}.tree li::after,.tree summary::before{content:"";display:block;position:absolute;top:calc(var(--spacing)/2 - var(--radius));left:calc(var(--spacing) - var(--radius) - 1px);width:calc(2*var(--radius));height:calc(2*var(--radius));border-radius:50%;background:#ddd}.tree summary::before{z-index:1;background:#7196c7 0 0}.tree details[open]>summary::before{background-position:calc(-2*var(--radius)) 0}.text-analysis-tagging{font-size:15px;line-height:21px;overflow:hidden;width:100%}.text-analysis-tagging thead tr:first-child{border-top:1px solid rgba(0,0,0,0);border-bottom:1px solid #dce6f1}.text-analysis-tagging thead tr:last-child{border-bottom:1px solid #7ca6d5}.text-analysis-tagging__ellipsis{font-size:20px;line-height:21px;overflow:hidden;width:100%}.text-analysis-tagging__table{border:none;border-collapse:collapse}.text-analysis-tagging__text{height:21px;overflow:hidden;padding:0 4px;text-overflow:ellipsis;white-space:nowrap}html[dir=ltr] .text-analysis-tagging__text{text-align:left}html[dir=rtl] .text-analysis-tagging__text{text-align:right}.text-analysis-tagging__header{font-weight:bold}.text-analysis-tagging__body{border-bottom:1px solid rgba(0,0,0,0)}html[dir=ltr] .text-analysis-tagging__right-aligned{text-align:right}html[dir=rtl] .text-analysis-tagging__right-aligned{text-align:left}.text-analysis-tagging__grand-total{font-weight:bold}.text-analysis-tagging__subtotal{font-weight:bold}.text-analysis-tagging__highlight-cell{color:#ed7331}.text-analysis-tagging__no-headers{padding:0 4px}',"",{version:3,sources:["webpack://./src/frontend/styles/components/_chart.scss","webpack://./src/frontend/styles/components/_pivot-table.scss","webpack://./src/frontend/styles/components/_preview-table.scss","webpack://./../../../../npm/.store/sdx_officecopilot/@fluentui-common-styles@1.2.58-938c4d7a801cd37a7015/node_modules/@fluentui/common-styles/dist/sass/_i18n.scss","webpack://./src/frontend/styles/components/_query-result.scss","webpack://./src/frontend/styles/components/_recommendation.scss","webpack://./src/frontend/styles/abstracts/_mixins.scss","webpack://./src/frontend/styles/abstracts/_theming.scss","webpack://./src/frontend/styles/abstracts/_palette.scss","webpack://./src/frontend/styles/components/_recommendation-title.scss","webpack://./src/frontend/styles/components/_explanation.scss","webpack://./src/frontend/styles/components/_column-recommendation.scss","webpack://./src/frontend/styles/components/_python-recommendation.scss","webpack://./src/frontend/styles/components/_text-analysis.scss","webpack://./src/frontend/styles/components/augloop-diagnostics.scss","webpack://./src/frontend/styles/components/_text-analysis-tagging.scss"],names:[],mappings:"AAGE,WACE,eAAA,CAAA,qBCCF,cAAA,CCFA,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAEA,0CACE,kCAAA,CACA,+BAAA,CAGF,yCACE,+BAAA,CAGF,+BACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAGF,4BACE,WAAA,CACA,wBAAA,CAGF,2BACE,WAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,kBAAA,CC7BA,yCA8NQ,eAAA,CAvNR,yCA0NQ,gBAAA,CDhMV,6BACE,gBAAA,CAGF,2BACE,qCAAA,CCtCA,kDAqOQ,gBAAA,CA9NR,kDAiOQ,eAAA,CD3LV,kCACE,gBAAA,CAGF,+BACE,gBAAA,CAGF,qCACE,aAAA,CDlDF,mCACE,+BAAA,CAGF,kCACE,4BAAA,CACA,qCAAA,CAGF,+BACE,+BAAA,CGfJ,cFDE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAEA,mCACE,kCAAA,CACA,+BAAA,CAGF,kCACE,+BAAA,CAGF,wBACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAGF,qBACE,WAAA,CACA,wBAAA,CAGF,oBACE,WAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,kBAAA,CC7BA,kCA8NQ,eAAA,CAvNR,kCA0NQ,gBAAA,CDhMV,sBACE,gBAAA,CAGF,oBACE,qCAAA,CCtCA,2CAqOQ,gBAAA,CA9NR,2CAiOQ,eAAA,CD3LV,2BACE,gBAAA,CAGF,wBACE,gBAAA,CAGF,8BACE,aAAA,CEpDF,0BACE,aAAA,CCJJ,gBACE,eAAA,CAEA,gBAAA,CACA,iBAAA,CACA,wBAAA,CCsHA,iBAAA,CACA,YAAA,CACA,iBAAA,CCsLE,gCACE,qBAAA,CADF,iCACE,qBAAA,CADF,6BACE,qBAAA,CADF,6BACE,qBAAA,CADF,gCACE,aAAA,CADF,iCACE,aAAA,CADF,6BACE,aAAA,CADF,6BACE,aAAA,CDtMJ,uBA5DA,2BAAA,CACA,sBAAA,CACA,wBAAA,CACA,uBAAA,CACA,mBAAA,CA2DE,UAAA,CACA,iBAAA,CACA,MAAA,CACA,KAAA,CACA,QAAA,CACA,OAAA,CACA,iBAAA,CAEA,gBAAA,CC0LA,uCACE,oBAAA,CADF,wCACE,iBAAA,CADF,oCACE,oBAAA,CADF,oCACE,oBAAA,CJnTF,qCA+OI,2CAAA,CAxOJ,qCA4OI,2CAAA,CI+EJ,uEACE,oBAAA,CADF,wEACE,oBAAA,CADF,oEACE,oBAAA,CADF,oEACE,oBAAA,CDnMJ,iFA3CA,6BAiBE,mBAAA,CAAA,CC4MA,6CACE,oBAAA,CADF,8CACE,oBAAA,CADF,0CACE,oBAAA,CADF,0CACE,oBAAA,CDnLJ,iFAxCA,6BAGI,mBAAA,CAAA,CDnFJ,4JAKE,cAAA,CAIF,uBACE,eAAA,CACA,iBAAA,CACA,wBAAA,CACA,iBAAA,CAGA,8BACE,iBAAA,CACA,KAAA,CACA,MAAA,CACA,OAAA,CACA,QAAA,CAIJ,6BACE,wBAAA,CACA,iBAAA,CAGF,wGAGE,YAAA,CACA,wBAAA,CACA,iBAAA,CAGF,yBACE,wBG3CK,CH4CL,UAAA,CAGF,uBAGE,YAAA,CACA,8BAEE,eAAA,CACA,UAAA,CACA,WAAA,CACA,KAAA,CACA,SAAA,CF7DF,4CAyKI,gBEjHwB,CFjD5B,4CAqKI,iBEpHwB,CAO1B,gCACE,cAAA,CAKN,wCACE,kBAAA,CAGF,2BACE,cAAA,CAGF,wBACE,sBAAA,CACA,iBAAA,CACA,eAAA,CACA,cAAA,CACA,gBAAA,CACA,YAAA,CACA,kBAAA,CACA,aAAA,CAGF,uCACE,sBAAA,CACA,wBAAA,CACA,iBAAA,CI1FJ,sBACE,cAAA,CACA,eAAA,CACA,gBAAA,CACA,QAAA,CACA,kBAAA,CACA,sBAAA,CACA,eAAA,CAGE,oCACE,gCAAA,CAEF,oCACE,UD6BU,CCxBhB,yBACE,aDpBQ,CCqBR,cAAA,CACA,QAAA,CACA,iBAAA,CACA,kBAAA,CHgIA,oBAAA,CAEA,wBAAA,CIhKF,sBACE,aAAA,CACA,cAAA,CAEA,4BACE,aAAA,CAEF,6BACE,aAAA,CAEF,+BACE,aAAA,CAGF,wBACE,aAAA,CAIJ,qBACE,cAAA,CCnBA,4CACE,SAAA,CACA,qBAAA,CAEA,8CACE,WAAA,CCLJ,8BACE,eAAA,CACA,eAAA,CACA,aAAA,CAGF,yCACE,UAAA,CAEA,+EACE,uBAAA,CAIJ,2CACE,kBAAA,CACA,SAAA,CACA,qBAAA,CAEA,6CACE,WAAA,CCnBN,8CACE,gBAAA,CCDF,iCACE,aAAA,CACA,iBAAA,CACA,QAAA,CACA,WAAA,CAGF,cACE,SAAA,CACA,sBAAA,CAMF,MACE,eAAA,CACA,aAAA,CACA,cAAA,CACA,sBAAA,CAGF,SACE,aAAA,CACA,iBAAA,CACA,sBAAA,CACA,yDAAA,CAGF,SACE,gDAAA,CACA,cAAA,CACA,sBAAA,CAGF,YACE,0BAAA,CAGF,uBACE,0BAAA,CAGF,oBACE,UAAA,CACA,aAAA,CACA,iBAAA,CACA,2BAAA,CACA,SAAA,CACA,gCAAA,CACA,iCAAA,CACA,iBAAA,CACA,wBAAA,CAGF,cACE,aAAA,CACA,cAAA,CAGF,4DAEE,YAAA,CAGF,oBACE,YAAA,CAGF,4BACE,uBAAA,CAGF,sCAEE,UAAA,CACA,aAAA,CACA,iBAAA,CACA,0CAAA,CACA,+CAAA,CACA,2BAAA,CACA,4BAAA,CACA,iBAAA,CACA,eAAA,CAGF,sBACE,SAAA,CACA,sBAAA,CAGF,oCACE,4CAAA,CC1FF,uBbDE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAEA,4CACE,kCAAA,CACA,+BAAA,CAGF,2CACE,+BAAA,CAGF,iCACE,cAAA,CACA,gBAAA,CACA,eAAA,CACA,UAAA,CAGF,8BACE,WAAA,CACA,wBAAA,CAGF,6BACE,WAAA,CACA,eAAA,CACA,aAAA,CACA,sBAAA,CACA,kBAAA,CC7BA,2CA8NQ,eAAA,CAvNR,2CA0NQ,gBAAA,CDhMV,+BACE,gBAAA,CAGF,6BACE,qCAAA,CCtCA,oDAqOQ,gBAAA,CA9NR,oDAiOQ,eAAA,CD3LV,oCACE,gBAAA,CAGF,iCACE,gBAAA,CAGF,uCACE,aAAA,CapDF,mCACE,aAAA",sourcesContent:['\ufeff@use "../abstracts/mixins";\n\n.chart {\n  > svg {\n    overflow: hidden;\n  }\n}\n','@use "preview-table";\n\n// Matches the default PivotTabyle style, which is "Light Blue, Pivot Style Light 16"\n// For use in clients that don\'t support the TableStyle API\n.pivot-table-light16 {\n  font-size: 12px;\n\n  @include preview-table.preview-table;\n\n  &__subtotal-row {\n    border-bottom: 1px solid #7ca6d5;\n  }\n\n  &__grand-total {\n    border-top: 1px solid #7ca6d5;\n    border-bottom: 1px solid transparent;\n  }\n\n  &__subtotal {\n    border-bottom: 1px solid #7ca6d5;\n  }\n}\n','@use "~@fluentui/common-styles/dist/sass/_i18n";\n\n@mixin preview-table {\n  font-size: 15px;\n  line-height: 21px;\n  overflow: hidden;\n  width: 100%;\n\n  & thead tr:first-child {\n    border-top: 1px solid transparent;\n    border-bottom: 1px solid #dce6f1;\n  }\n\n  & thead tr:last-child {\n    border-bottom: 1px solid #7ca6d5;\n  }\n\n  &__ellipsis {\n    font-size: 20px;\n    line-height: 21px;\n    overflow: hidden;\n    width: 100%;\n  }\n\n  &__table {\n    border: none;\n    border-collapse: collapse;\n  }\n\n  &__text {\n    height: 21px;\n    overflow: hidden;\n    padding: 0 4px;\n    text-overflow: ellipsis;\n    white-space: nowrap;\n    @include i18n.text-align(left);\n  }\n\n  &__header {\n    font-weight: bold;\n  }\n\n  &__body {\n    border-bottom: 1px solid transparent;\n  }\n\n  &__right-aligned {\n    @include i18n.text-align(right);\n  }\n\n  &__grand-total {\n    font-weight: bold;\n  }\n\n  &__subtotal {\n    font-weight: bold;\n  }\n\n  &__highlight-cell {\n    color: #ed7331;\n  }\n}\n',"// Some things copied from WinJS with <3\n\n\n// LTR mixin definition\n@mixin LTR {\n    html[dir='ltr'] & {\n        @content;\n    }\n}\n\n// RTL mixin definition\n@mixin RTL {\n    html[dir='rtl'] & {\n        @content;\n    }\n}\n\n// Use baseRTL for a root element of a control that needs rtl support\n@mixin baseRtl {\n    @include RTL {\n        direction: rtl;\n        unicode-bidi: bidi-override;\n    }\n}\n\n/*\n    Common CSS property mixins with support for RTL.\n    Use these mixins when you want to automatically create RTL versions of your properties.\n    They are in alphabetical order (a-z).\n*/\n\n@mixin border-color($top, $right, $bottom, $left) {\n    border-color: $top $right $bottom $left;\n    @include RTL {\n        border-color: $top $left $bottom $right;\n    }\n}\n\n@mixin border-left($width, $style, $color) {\n    @include LTR {\n        border-left: $width $style $color;\n    }\n    @include RTL {\n        border-right: $width $style $color;\n    }\n}\n\n@mixin border-left-color($color) {\n    @include LTR {\n        border-left-color: $color;\n    }\n    @include RTL {\n        border-right-color: $color;\n    }\n}\n\n@mixin border-left-style($style) {\n    @include LTR {\n        border-left-style: $style;\n    }\n    @include RTL {\n        border-right-style: $style;\n    }\n}\n\n@mixin border-left-width($width) {\n    @include LTR {\n        border-left-width: $width;\n    }\n    @include RTL {\n        border-right-width: $width;\n    }\n}\n\n@mixin border-radius($topLeft, $topRight, $bottomRight, $bottomLeft) {\n    border-radius: $topLeft $topRight $bottomRight $bottomLeft;\n    @include RTL {\n        border-radius: $topRight $topLeft $bottomLeft $bottomRight;\n    }\n}\n\n@mixin border-right($width, $style, $color) {\n    @include LTR {\n        border-right: $width $style $color;\n    }\n    @include RTL {\n        border-left: $width $style $color;\n    }\n}\n\n@mixin border-right-color($color) {\n    @include LTR {\n        border-right-color: $color;\n    }\n    @include RTL {\n        border-left-color: $color;\n    }\n}\n\n@mixin border-right-style($style) {\n    @include LTR {\n         border-right-style: $style;\n    }\n    @include RTL {\n        border-left-style: $style;\n    }\n}\n\n@mixin border-right-width($width) {\n    @include LTR {\n        border-right-width: $width;\n    }\n    @include RTL {\n        border-left-width: $width;\n    }\n}\n\n@mixin clear($side) {\n    @if $side == left {\n        @include LTR {\n            clear: $side;\n        }\n        @include RTL {\n            clear: right;\n        }\n    } @else if $side == right {\n        @include LTR {\n            clear: $side;\n        }\n\n        @include RTL {\n            clear: left;\n        }\n    } @else {\n        clear: $side;\n    }\n}\n\n@mixin float($direction) {\n    @if $direction == left {\n        @include LTR {\n            float: left;\n        }\n        @include RTL {\n            float: right;\n        }\n    } @else {\n        @include LTR {\n            float: right;\n        }\n        @include RTL {\n            float: left;\n        }\n    }\n}\n\n@mixin left($distance) {\n    @include LTR {\n        left: $distance;\n    }\n    @include RTL {\n        right: $distance;\n    }\n}\n\n@mixin margin($top, $right, $bottom, $left) {\n    margin: $top $right $bottom $left;\n    @include RTL {\n        margin: $top $left $bottom $right;\n    }\n}\n\n@mixin margin-left($distance) {\n    @include LTR {\n        margin-left: $distance;\n    }\n    @include RTL {\n        margin-right: $distance;\n    }\n}\n\n@mixin margin-right($distance) {\n    @include LTR {\n        margin-right: $distance;\n    }\n    @include RTL {\n        margin-left: $distance;\n    }\n}\n\n@mixin padding($top, $right, $bottom, $left) {\n    padding: $top $right $bottom $left;\n    @include RTL {\n        padding: $top $left $bottom $right;\n    }\n}\n\n@mixin padding-left($distance) {\n    @include LTR {\n        padding-left: $distance;\n    }\n    @include RTL {\n        padding-right: $distance;\n    }\n}\n\n@mixin padding-right($distance) {\n    @include LTR {\n        padding-right: $distance;\n    }\n    @include RTL {\n        padding-left: $distance;\n    }\n}\n\n@mixin right($distance) {\n    @include LTR {\n        right: $distance;\n    }\n    @include RTL {\n        left: $distance;\n    }\n}\n\n@mixin text-align($direction) {\n    @if $direction == left {\n        @include LTR {\n            text-align: left;\n        }\n        @include RTL {\n            text-align: right;\n        }\n    } @else {\n        @include LTR {\n            text-align: right;\n        }\n        @include RTL {\n            text-align: left;\n        }\n    }\n}\n\n@mixin box-shadow($left, $etc) {\n    @include LTR {\n        box-shadow: $left $etc;\n    }\n\n    @include RTL {\n        box-shadow: -$left $etc;\n    }\n}\n\n@mixin transform-scaleX($scaleX: 1) {\n    @include LTR {\n        transform: scaleX($scaleX);\n    }\n    @include RTL {\n        transform: scaleX(-$scaleX);\n    }\n}\n\n@mixin transform-translateX($distance) {\n    @include LTR {\n        transform: translateX($distance);\n    }\n    @include RTL {\n        transform: translateX(-$distance);\n    }\n}\n\n// only supported when ONLY left/right are declared\n@mixin transition-property($direction) {\n    @if $direction == left {\n        @include LTR {\n            transition-property: left;\n        }\n        @include RTL {\n            transition-property: right;\n        }\n    } @else {\n        @include LTR {\n            transition-property: right;\n        }\n        @include RTL {\n            transition-property: left;\n        }\n    }\n}\n\n// Disables high contrast color adjusts for Edge/IE11\n@mixin highContrastAdjust {\n  @media screen and (-ms-high-contrast: active), screen and (forced-colors: active) {\n    -ms-high-contrast-adjust: none;\n    forced-color-adjust: none;\n  }\n}\n",'@use "../abstracts/mixins";\n@use "../abstracts/variables";\n@use "preview-table";\n\n.query-result {\n  @include preview-table.preview-table;\n\n  &__no-headers {\n    padding: 0 4px;\n  }\n}\n','@use "../abstracts/mixins";\n@use "~@fluentui/common-styles/dist/sass/_i18n";\n@use "../abstracts/palette";\n\n.recommendation {\n  list-style: none;\n  // margin in copilot\n  margin-left: 20px;\n  margin-right: 20px;\n  border: 1px solid #e0e0e0;\n\n  @include mixins.card;\n\n  &__chart,\n  &__pivot-table,\n  &__empty-pivot-table,\n  &__query-result,\n  &__text-analysis-tagging {\n    margin: 8px 0 0;\n  }\n\n  // Maintain a 2:1 aspect ratio for the chart\n  &__chart {\n    padding-top: 50%;\n    position: relative;\n    border: 1px solid #e0e0e0;\n    border-radius: 2px;\n\n    // Fill the entire available area\n    .chart {\n      position: absolute;\n      top: 0;\n      left: 0;\n      right: 0;\n      bottom: 0;\n    }\n  }\n\n  &__pivot-table {\n    border: 1px solid #e0e0e0;\n    border-radius: 2px;\n  }\n\n  &__empty-pivot-table,\n  &__query-result,\n  &__text-analysis-tagging {\n    padding: 12px;\n    border: 1px solid #e0e0e0;\n    border-radius: 2px;\n  }\n\n  &__invalid {\n    background-color: palette.$Gray30;\n    opacity: 0.5;\n  }\n\n  &__title {\n    // @include expandable-card-button;\n    /* stylelint-disable-next-line plugin/no-unsupported-browser-features */\n    display: flex;\n    button {\n      @include i18n.margin-left(10px);\n      margin-top: 13px;\n      width: 16px;\n      height: 16px;\n      top: 0;\n      z-index: 1;\n\n      i {\n        font-size: 12px;\n      }\n    }\n  }\n\n  &__title-group:last-child {\n    padding-bottom: 8px;\n  }\n\n  &__collapsed {\n    cursor: pointer;\n  }\n\n  &__footer {\n    font-family: "Segoe UI";\n    font-style: normal;\n    font-weight: 400;\n    font-size: 12px;\n    line-height: 16px;\n    display: flex;\n    align-items: center;\n    color: #242424;\n  }\n\n  &__footer-insert-explain {\n    margin: 0px 8px 8px 8px;\n    border: 1px solid #d1d1d1;\n    border-radius: 4px;\n  }\n}\n','@use "~@fluentui/common-styles/dist/sass/_i18n";\n@use "_theming";\n\n@mixin box-shadow-inset($left, $top, $blur, $spread, $color, $inset: false) {\n  @if $inset {\n    @include i18n.LTR {\n      -webkit-box-shadow: inset $left $top $blur $spread $color;\n      -moz-box-shadow: inset $left $top $blur $spread $color;\n      box-shadow: inset $left $top $blur $spread $color;\n    }\n    // @include RTL {\n    //     -webkit-box-shadow: inset -$left $top $blur $spread $color;\n    //     -moz-box-shadow: inset -$left $top $blur $spread $color;\n    //     box-shadow: inset -$left $top $blur $spread $color;\n    // }\n  } @else {\n    @include i18n.LTR {\n      -webkit-box-shadow: $left $top $blur $spread $color;\n      -moz-box-shadow: $left $top $blur $spread $color;\n      box-shadow: $left $top $blur $spread $color;\n    }\n    @include i18n.RTL {\n      -webkit-box-shadow: -$left $top $blur $spread $color;\n      -moz-box-shadow: -$left $top $blur $spread $color;\n      box-shadow: -$left $top $blur $spread $color;\n    }\n  }\n}\n\n@mixin user-select($value: none) {\n  -webkit-touch-callout: $value;\n  -webkit-user-select: $value;\n  -khtml-user-select: $value;\n  -moz-user-select: $value;\n  -ms-user-select: $value;\n  user-select: $value;\n}\n\n@mixin transform($transforms) {\n  -moz-transform: $transforms;\n  -o-transform: $transforms;\n  -ms-transform: $transforms;\n  -webkit-transform: $transforms;\n  transform: $transforms;\n}\n\n@mixin no-transitions {\n  -webkit-transition-property: none;\n  -moz-transition-property: none;\n  -o-transition-property: none;\n  transition-property: none;\n}\n\n@mixin no-pointer-events {\n  -webkit-pointer-events: none;\n  -o-pointer-events: none;\n  -moz-pointer-events: none;\n  -ms-pointer-events: none;\n  pointer-events: none;\n}\n\n@mixin shimmer-table {\n  padding: 14px;\n\n  .ms-Shimmer-container {\n    margin: 10px 0;\n  }\n\n  &__top {\n    margin: 8px 0;\n  }\n\n  &__first-row {\n    margin-bottom: 13px;\n  }\n\n  &__main-row {\n    margin: 5px 0;\n  }\n\n  &__bottom-row {\n    margin-top: 18px;\n  }\n}\n\n@mixin card {\n  @include card-without-focus;\n\n  // This mirrors how Office UI Fabric does keyboard focus indicators. Use ::after pseudo-element\n  // with z-index so that no part of the focus outline is hidden.\n  &:focus::after {\n    @include card-focus-after-pseudo;\n  }\n  &:hover::after {\n    @include theming.themify("border-color", "InsightsCardKeyboardStroke");\n    @include high-contrast {\n      border-style: dashed;\n    }\n  }\n}\n\n@mixin card-focus-after-pseudo {\n  @include theming.themifyForFocus(\n    "border-color",\n    "InsightsCardKeyboardStroke"\n  );\n  @include high-contrast {\n    border-style: dashed;\n  }\n}\n\n@mixin card-without-focus {\n  @include theming.themify("background-color", "InsightsCardBkg");\n  @include theming.themify("color", "InsightsCardText");\n  &::after {\n    @include theming.themify("border-color", "InsightsCardStroke");\n    @include no-pointer-events;\n    content: "";\n    position: absolute;\n    left: 0;\n    top: 0;\n    bottom: 0;\n    right: 0;\n    border-radius: 2px;\n    @include i18n.box-shadow(0, 2px 4px -0.75px rgba(0, 0, 0, 0.1));\n    border-width: 2px;\n  }\n  position: relative;\n  outline: none;\n  border-style: none;\n}\n\n@mixin high-contrast {\n  @media screen and (-ms-high-contrast: active),\n    screen and (forced-colors: active) {\n    @content;\n  }\n}\n\n@mixin not-high-contrast {\n  @media screen and (-ms-high-contrast: none),\n    screen and (forced-colors: none) {\n    @content;\n  }\n}\n\n@mixin highlighted-option {\n  -ms-high-contrast-adjust: none;\n  forced-color-adjust: none;\n\n  @include high-contrast {\n    color: HighlightText;\n    background-color: Highlight;\n  }\n}\n\n@mixin overflow-wrap-break-word {\n  /* IE11 implementation of overflow-wrap */\n  word-wrap: break-word;\n  /* stylelint-disable-next-line plugin/no-unsupported-browser-features */\n  overflow-wrap: break-word;\n}\n','@use "sass:map";\n@use "../abstracts/palette";\n\n/**\n * Each theme is divided into \'Taskpane\', \'Callout\', and \'Custom\' sections.  Theme names for \'Taskpane\' and \'Callout\'\n * are based upon real components in Excel.  Theme names for \'Custom\' are Insights-specific components that have no\n * Excel equivalent. We try to use the \'Taskpane\' and \'Callout\' theme names wherever possible, as they have actual\n * semantic meaning in Excel.\n */\n\n$themes: (\n  "colorful": (\n    // Taskpane\n    "Bkg": palette.$GrayB,\n    "BkgSVFluentRefresh": palette.$Gray94,\n    "Text": palette.$GrayI,\n    "TextSecondary": palette.$GrayE2,\n    "TextEmphasis": palette.$XL7,\n    "TextEmphasisHover": palette.$XL8,\n    "TextEmphasisPressed": palette.$XL7,\n    "TextEmphasisSelected": palette.$XL8,\n    "BkgCtlDisabled": palette.$GrayA,\n    "TextCtlDisabled": palette.$GrayC3,\n    "StrokeCtl": palette.$GrayD,\n    "StrokeCtlDisabled": palette.$GrayC,\n    "TextHyperlink": palette.$XL6,\n    "TextHyperlinkHover": palette.$XL5,\n    "TextHyperlinkPressed": palette.$XL7,\n    "TextHyperlinkFocusRectangle": palette.$GrayE2,\n    // Callout\n    "CalloutBkg": palette.$White,\n    "CalloutText": palette.$GrayI,\n    "CalloutTextSecondary": palette.$GrayI,\n    "CalloutBkgCtl": palette.$White,\n    "CalloutBkgCtlHover": palette.$GrayA,\n    "CalloutBkgCtlPressed": palette.$GrayB,\n    "CalloutTextCtl": palette.$GrayI,\n    "CalloutTextCtlHover": palette.$GrayI,\n    "CalloutTextCtlPressed": palette.$GrayI,\n    "CalloutStrokeCtl": palette.$GrayD,\n    "CalloutStrokeCtlHover": palette.$GrayD,\n    "CalloutStrokeCtlPressed": palette.$GrayD,\n    "CalloutTextHyperlink": palette.$XL6,\n    "CalloutTextHyperlinkHover": palette.$XL4,\n    "CalloutTextHyperlinkPressed": palette.$XL7,\n    // Custom\n    "InsightsCardBkg": palette.$White,\n    "InsightsCardText": palette.$GrayI,\n    "InsightsCardStroke": palette.$GrayC2,\n    "InsightsCardKeyboardStroke": palette.$XLPrimary,\n    "InsightsChartBorder": palette.$GrayB,\n    "InsightsDefaultKeyboardStroke": palette.$GrayI,\n    "InsightsDialogKeyboardStroke": palette.$GrayI,\n    "InsightsScrollBkg": palette.$GrayC2,\n    "InsightsScrollSeparatorStroke": palette.$GrayC2,\n    "InsightsSpinnerBkg": palette.$XL6 palette.$GrayC2 palette.$GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": palette.$GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": palette.$GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": palette.$GrayI,\n    "InsightsPreferencesCheckbox": palette.$GrayI,\n    "InsightsPreferencesFieldListBkg": palette.$White,\n    "InsightsPreferencesFieldListBorder": palette.$GrayC2,\n    "InsightsPreferencesFieldBkgHover": palette.$XL2,\n    "InsightsPreferencesFieldText": palette.$GrayI,\n    "InsightsPreferencesDropdownBkgHover": palette.$XL2,\n    "InsightsPreferencesDropdownBkg": palette.$White,\n    "InsightsPreferencesDropdownBorder": palette.$GrayC2,\n    "InsightsPreferencesFocusOutline": palette.$GrayE2,\n    "InsightsSecondaryBkgCtl": palette.$GrayB,\n    "InsightsSecondaryBkgCtlHover": palette.$GrayC,\n    "InsightsSecondaryBkgCtlPressed": palette.$GrayC2,\n    "InsightsSecondaryTextCtl": palette.$GrayI,\n    "InsightsSecondaryTextCtlHover": palette.$GrayI,\n    "InsightsSecondaryTextCtlPressed": palette.$GrayI,\n    "InsightsSecondaryStrokeCtl": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlHover": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlPressed": palette.$GrayD,\n  ),\n  "dark-gray": (\n    // Taskpane\n    "Bkg": palette.$GrayE2,\n    "BkgSVFluentRefresh": palette.$Gray18,\n    "Text": palette.$White,\n    "TextSecondary": palette.$White,\n    "TextEmphasis": palette.$White,\n    "TextEmphasisHover": palette.$White,\n    "TextEmphasisPressed": palette.$White,\n    "TextEmphasisSelected": palette.$White,\n    "BkgCtlDisabled": palette.$GrayG,\n    "TextCtlDisabled": palette.$GrayE2,\n    "StrokeCtl": palette.$GrayE,\n    "StrokeCtlDisabled": palette.$GrayF,\n    "TextHyperlink": palette.$HyperlinkA,\n    "TextHyperlinkHover": palette.$White,\n    "TextHyperlinkPressed": palette.$HyperlinkB,\n    "TextHyperlinkFocusRectangle": palette.$Gray18,\n    // Callout\n    "CalloutBkg": palette.$GrayE2,\n    "CalloutText": palette.$White,\n    "CalloutTextSecondary": palette.$White,\n    "CalloutBkgCtl": palette.$GrayE2,\n    "CalloutBkgCtlHover": palette.$GrayE,\n    "CalloutBkgCtlPressed": palette.$GrayD2,\n    "CalloutTextCtl": palette.$White,\n    "CalloutTextCtlHover": palette.$White,\n    "CalloutTextCtlPressed": palette.$White,\n    "CalloutStrokeCtl": palette.$GrayD,\n    "CalloutStrokeCtlHover": palette.$GrayD,\n    "CalloutStrokeCtlPressed": palette.$GrayD,\n    "CalloutTextHyperlink": palette.$XL6,\n    "CalloutTextHyperlinkHover": palette.$XL4,\n    "CalloutTextHyperlinkPressed": palette.$XL7,\n    // Custom\n    "InsightsCardBkg": palette.$White,\n    "InsightsCardText": palette.$GrayI,\n    "InsightsCardStroke": palette.$GrayG,\n    "InsightsCardKeyboardStroke": palette.$XL4,\n    "InsightsChartBorder": palette.$GrayB,\n    "InsightsDefaultKeyboardStroke": palette.$White,\n    "InsightsDialogKeyboardStroke": palette.$GrayI,\n    "InsightsScrollBkg": palette.$GrayC2,\n    "InsightsScrollSeparatorStroke": palette.$GrayG,\n    "InsightsSpinnerBkg": palette.$XL6 palette.$GrayC2 palette.$GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": palette.$GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": palette.$GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": palette.$GrayI,\n    "InsightsPreferencesCheckbox": palette.$White,\n    "InsightsPreferencesFieldListBkg": palette.$GrayK,\n    "InsightsPreferencesFieldListBorder": palette.$GrayD,\n    "InsightsPreferencesFieldBkgHover": palette.$Grey36,\n    "InsightsPreferencesFieldText": palette.$White,\n    "InsightsPreferencesDropdownBkgHover": palette.$Grey36,\n    "InsightsPreferencesDropdownBkg": palette.$GrayK,\n    "InsightsPreferencesDropdownBorder": palette.$GrayD,\n    "InsightsPreferencesFocusOutline": palette.$White,\n    "InsightsSecondaryBkgCtl": palette.$GrayE2,\n    "InsightsSecondaryBkgCtlHover": palette.$GrayE,\n    "InsightsSecondaryBkgCtlPressed": palette.$GrayD2,\n    "InsightsSecondaryTextCtl": palette.$White,\n    "InsightsSecondaryTextCtlHover": palette.$White,\n    "InsightsSecondaryTextCtlPressed": palette.$White,\n    "InsightsSecondaryStrokeCtl": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlHover": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlPressed": palette.$GrayD,\n  ),\n  "black": (\n    // Taskpane\n    "Bkg": palette.$GrayI,\n    "BkgSVFluentRefresh": palette.$GrayJ,\n    "Text": palette.$White,\n    "TextSecondary": palette.$GrayC3,\n    "TextEmphasis": palette.$XL2,\n    "TextEmphasisHover": palette.$XL2,\n    "TextEmphasisPressed": palette.$XL2,\n    "TextEmphasisSelected": palette.$White,\n    "BkgCtlDisabled": palette.$GrayG,\n    "TextCtlDisabled": palette.$GrayE2,\n    "StrokeCtl": palette.$GrayD,\n    "StrokeCtlDisabled": palette.$GrayF,\n    "TextHyperlink": palette.$HyperlinkD,\n    "TextHyperlinkHover": palette.$HyperlinkB,\n    "TextHyperlinkPressed": palette.$White,\n    "TextHyperlinkFocusRectangle": palette.$Gray20,\n    // Callout\n    "CalloutBkg": palette.$GrayI,\n    "CalloutText": palette.$White,\n    "CalloutTextSecondary": palette.$White,\n    "CalloutBkgCtl": palette.$GrayI,\n    "CalloutBkgCtlHover": palette.$GrayH,\n    "CalloutBkgCtlPressed": palette.$GrayG,\n    "CalloutTextCtl": palette.$White,\n    "CalloutTextCtlHover": palette.$White,\n    "CalloutTextCtlPressed": palette.$White,\n    "CalloutStrokeCtl": palette.$GrayE2,\n    "CalloutStrokeCtlHover": palette.$GrayE2,\n    "CalloutStrokeCtlPressed": palette.$GrayE2,\n    "CalloutTextHyperlink": palette.$HyperlinkC,\n    "CalloutTextHyperlinkHover": palette.$HyperlinkA,\n    "CalloutTextHyperlinkPressed": palette.$White,\n    // Custom\n    "InsightsCardBkg": palette.$White,\n    "InsightsCardText": palette.$GrayI,\n    "InsightsCardStroke": palette.$GrayF,\n    "InsightsCardKeyboardStroke": palette.$XL4,\n    "InsightsChartBorder": palette.$GrayB,\n    "InsightsDefaultKeyboardStroke": palette.$White,\n    "InsightsDialogKeyboardStroke": palette.$White,\n    "InsightsScrollBkg": palette.$GrayF,\n    "InsightsScrollSeparatorStroke": palette.$GrayF,\n    "InsightsSpinnerBkg": palette.$XL6 palette.$GrayC2 palette.$GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": palette.$GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": palette.$GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": palette.$GrayI,\n    "InsightsPreferencesCheckbox": palette.$White,\n    "InsightsPreferencesFieldListBkg": palette.$GrayH,\n    "InsightsPreferencesFieldListBorder": palette.$GrayE,\n    "InsightsPreferencesFieldBkgHover": palette.$XL7,\n    "InsightsPreferencesFieldText": palette.$White,\n    "InsightsPreferencesDropdownBkgHover": palette.$XL7,\n    "InsightsPreferencesDropdownBkg": palette.$GrayH,\n    "InsightsPreferencesDropdownBorder": palette.$GrayE,\n    "InsightsPreferencesFocusOutline": palette.$Gray20,\n    "InsightsSecondaryBkgCtl": palette.$GrayI,\n    "InsightsSecondaryBkgCtlHover": palette.$GrayH,\n    "InsightsSecondaryBkgCtlPressed": palette.$GrayG,\n    "InsightsSecondaryTextCtl": palette.$White,\n    "InsightsSecondaryTextCtlHover": palette.$White,\n    "InsightsSecondaryTextCtlPressed": palette.$White,\n    "InsightsSecondaryStrokeCtl": palette.$GrayE2,\n    "InsightsSecondaryStrokeCtlHover": palette.$GrayE2,\n    "InsightsSecondaryStrokeCtlPressed": palette.$GrayE2,\n  ),\n  "white": (\n    // Taskpane\n    "Bkg": palette.$White,\n    "BkgSVFluentRefresh": palette.$Gray94,\n    // Override $GrayA with $White\n    "Text": palette.$GrayI,\n    "TextSecondary": palette.$GrayE2,\n    "TextEmphasis": palette.$XL6,\n    "TextEmphasisHover": palette.$XL5,\n    "TextEmphasisPressed": palette.$XL7,\n    "TextEmphasisSelected": palette.$XL6,\n    "BkgCtlDisabled": palette.$GrayA,\n    "TextCtlDisabled": palette.$GrayC3,\n    "StrokeCtl": palette.$GrayD,\n    "StrokeCtlDisabled": palette.$GrayC,\n    "TextHyperlink": palette.$XL6,\n    "TextHyperlinkHover": palette.$XL4,\n    "TextHyperlinkPressed": palette.$XL7,\n    "TextHyperlinkFocusRectangle": palette.$GrayE2,\n    // Callout\n    "CalloutBkg": palette.$White,\n    "CalloutText": palette.$GrayI,\n    "CalloutTextSecondary": palette.$GrayI,\n    "CalloutBkgCtl": palette.$White,\n    "CalloutBkgCtlHover": palette.$GrayA,\n    "CalloutBkgCtlPressed": palette.$GrayB,\n    "CalloutTextCtl": palette.$GrayI,\n    "CalloutTextCtlHover": palette.$GrayI,\n    "CalloutTextCtlPressed": palette.$GrayI,\n    "CalloutStrokeCtl": palette.$GrayD,\n    "CalloutStrokeCtlHover": palette.$GrayD,\n    "CalloutStrokeCtlPressed": palette.$GrayD,\n    "CalloutTextHyperlink": palette.$XL6,\n    "CalloutTextHyperlinkHover": palette.$XL5,\n    "CalloutTextHyperlinkPressed": palette.$XL7,\n    // Custom\n    "InsightsCardBkg": palette.$White,\n    "InsightsCardText": palette.$GrayI,\n    "InsightsCardStroke": palette.$GrayC2,\n    "InsightsCardKeyboardStroke": palette.$XLPrimary,\n    "InsightsChartBorder": palette.$GrayB,\n    "InsightsDefaultKeyboardStroke": palette.$GrayI,\n    "InsightsDialogKeyboardStroke": palette.$GrayI,\n    "InsightsScrollBkg": palette.$GrayC2,\n    "InsightsScrollSeparatorStroke": palette.$GrayC2,\n    "InsightsSpinnerBkg": palette.$XL6 palette.$GrayC2 palette.$GrayC2,\n    "InsightsRecommendationFeedbackTextCtl": palette.$GrayE,\n    "InsightsRecommendationFeedbackTextCtlHover": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutTextCtl": palette.$GrayI,\n    "InsightsRecommendationFeedbackCalloutBkg": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtl": palette.$White,\n    "InsightsRecommendationFeedbackCalloutBkgCtlHover": palette.$GrayB,\n    "InsightsRecommendationFeedbackCalloutBkgCtlPressed": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutStroke": palette.$GrayC,\n    "InsightsRecommendationFeedbackCalloutMessageText": palette.$GrayI,\n    "InsightsPreferencesCheckbox": palette.$GrayI,\n    "InsightsPreferencesFieldListBkg": palette.$White,\n    "InsightsPreferencesFieldListBorder": palette.$GrayC,\n    "InsightsPreferencesFieldBkgHover": palette.$XL2,\n    "InsightsPreferencesFieldText": palette.$GrayI,\n    "InsightsPreferencesDropdownBkgHover": palette.$XL2,\n    "InsightsPreferencesDropdownBkg": palette.$White,\n    "InsightsPreferencesDropdownBorder": palette.$GrayC,\n    "InsightsPreferencesFocusOutline": palette.$GrayE2,\n    "InsightsSecondaryBkgCtl": palette.$White,\n    "InsightsSecondaryBkgCtlHover": palette.$GrayA,\n    "InsightsSecondaryBkgCtlPressed": palette.$GrayB,\n    "InsightsSecondaryTextCtl": palette.$GrayI,\n    "InsightsSecondaryTextCtlHover": palette.$GrayI,\n    "InsightsSecondaryTextCtlPressed": palette.$GrayI,\n    "InsightsSecondaryStrokeCtl": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlHover": palette.$GrayD,\n    "InsightsSecondaryStrokeCtlPressed": palette.$GrayD,\n  ),\n) !default;\n\n// Themify mixin\n// Source: https://www.sitepoint.com/sass-theming-neverending-story/\n// Extended to allow overriding themes.\n@mixin themify($property, $key, $themes: $themes) {\n  @each $theme, $colors in $themes {\n    .theme-#{$theme} & {\n      #{$property}: map.get($colors, $key);\n    }\n  }\n}\n\n// Themify mixin for styles which apply when focus is visible.\n// .ms-Fabric--isFocusVisible and .theme-* class names are both on body element.\n// It does not work properly to use the mixin themify() in the way below.\n// .ms-Fabric--isFocusVisible &.ms-Button--default:focus::after {\n//      @include themify(\'border-color\', \'InsightsCardKeyboardStroke\');\n// }\n// because there will be a space between .theme-* and .ms-Fabric--isFocusVisible in generated css.\n// Please use this mixin to thimfy the style which applied when focus is visible.\n@mixin themifyForFocus($property, $key, $themes: $themes) {\n  @each $theme, $colors in $themes {\n    .theme-#{$theme}.ms-Fabric--isFocusVisible & {\n      #{$property}: map.get($colors, $key);\n    }\n  }\n}\n',"// Office Palette\n\n$White: #ffffff;\n$Gray110: #8a8886;\n$Gray130: #605e5c;\n$Gray140: #484644;\n$Gray160: #323130;\n$Gray18: #2e2e2e;\n$Gray20: #f3f2f1;\n$Gray30: #edebe9;\n$Gray40: #e1dfdd;\n$Gray60: #c8c6c4;\n$Gray94: #f0f0f0;\n$GrayA: #f3f3f3;\n$GrayB: #e6e6e6;\n$GrayC: #d2d2d2;\n$GrayC2: #c6c6c6;\n$GrayC3: #b1b1b1;\n$GrayD: #969696;\n$GrayD2: #808080;\n$GrayE: #737373;\n$GrayE2: #666666;\n$GrayF: #505050;\n$GrayG: #444444;\n$GrayH: #363636;\n$GrayI: #262626;\n$GrayJ: #0a0a0a;\n$GrayK: #4d4d4d;\n$Black: #000000;\n$Grey36: #5c5c5c;\n\n$HyperlinkA: #c5e9fe;\n$HyperlinkB: #79cdfe;\n$HyperlinkC: #56bdfc;\n$HyperlinkD: #23a6e8;\n\n$XL1: #e9f5ee;\n$XL2: #9fcdb3;\n$XL3: #6eb38a;\n$XL4: #4e9668;\n$XL5: #3f8159;\n$XL6: #217346;\n$XL7: #0e5c2f;\n$XL8: #004b1c;\n$XLPrimary: #107c41;\n\n// Insights Palette\n\n$insights-orange: #ed7d31;\n$insights-blue: #0000ff;\n$ErrorRed: #a80000;\n\n// XLO\n$xlo-headergray: #f5f5f5;\n",'@use "sass:color";\n@use "../abstracts/theming";\n@use "../abstracts/palette";\n@use "../abstracts/mixins";\n@use "../abstracts/variables";\n\n.recommendation-title {\n  font-size: 14px;\n  font-weight: 700;\n  line-height: 20px;\n  margin: 0;\n  vertical-align: top;\n  text-overflow: ellipsis;\n  overflow: hidden;\n\n  &__rich-text {\n    &__0 {\n      color: color.adjust($color: palette.$insights-orange, $lightness: -16%);\n    }\n    &__1 {\n      color: palette.$insights-blue;\n    }\n  }\n}\n\n.recommendation-subtitle {\n  color: palette.$Gray160;\n  font-size: 12px;\n  margin: 0;\n  padding: variables.$default-pt * 0.5 0 variables.$default-pt;\n  vertical-align: top;\n  @include mixins.overflow-wrap-break-word;\n}\n',".explanation-dropdown {\n  color: #107c41;\n  font-size: 12px;\n\n  &:hover {\n    color: #0f703b;\n  }\n  &:active {\n    color: #094624;\n  }\n  &:disabled {\n    color: #bdbdbd;\n  }\n\n  i {\n    color: inherit;\n  }\n}\n\n.explanation-content {\n  margin: 0px 8px;\n}\n",".column-recommendation {\n  .formula-description {\n    padding: 0;\n    box-sizing: border-box;\n\n    p {\n      all: inherit;\n    }\n  }\n}\n",".python-recommendation {\n  &__title {\n    font-weight: 600;\n    margin-top: 12px;\n    color: #242424;\n  }\n\n  .monaco-read-only {\n    width: auto;\n\n    .monaco-editor .cursors-layer > .cursor {\n      display: none !important;\n    }\n  }\n\n  .python-description {\n    margin: 8px 0px 0px;\n    padding: 0;\n    box-sizing: border-box;\n\n    p {\n      all: inherit;\n    }\n  }\n}\n",'@use "../abstracts/mixins";\n\n.recommendation__text-analysis__bullet-header {\n  font-weight: bold;\n}\n','@use "../abstracts/mixins";\n\n.AugloopDiganosticsPaneContainer {\n  overflow: auto;\n  padding-left: "2%";\n  margin: 0;\n  width: "96%";\n}\n\n.hideOverflow {\n  width: 90%;\n  text-overflow: ellipsis;\n}\n\n// ----------------------------------------\n// tree view styles\n\n.tree {\n  --spacing: 1rem;\n  --radius: 7px;\n  padding-left: 0;\n  padding-inline-start: 0;\n}\n\n.tree li {\n  display: block;\n  position: relative;\n  padding-inline-start: 0;\n  padding-left: calc(2 * var(--spacing) - var(--radius) - 2px);\n}\n\n.tree ul {\n  margin-left: calc(var(--radius) - var(--spacing));\n  padding-left: 0;\n  padding-inline-start: 0;\n}\n\n.tree ul li {\n  border-left: 2px solid #ddd;\n}\n\n.tree ul li:last-child {\n  border-color: transparent;\n}\n\n.tree ul li::before {\n  content: "";\n  display: block;\n  position: absolute;\n  top: calc(var(--spacing) / -2);\n  left: -2px;\n  width: calc(var(--spacing) + 2px);\n  height: calc(var(--spacing) + 1px);\n  border: solid #ddd;\n  border-width: 0 0 2px 2px;\n}\n\n.tree summary {\n  display: block;\n  cursor: pointer;\n}\n\n.tree summary::marker,\n.tree summary::-webkit-details-marker {\n  display: none;\n}\n\n.tree summary:focus {\n  outline: none;\n}\n\n.tree summary:focus-visible {\n  outline: 1px dotted #000;\n}\n\n.tree li::after,\n.tree summary::before {\n  content: "";\n  display: block;\n  position: absolute;\n  top: calc(var(--spacing) / 2 - var(--radius));\n  left: calc(var(--spacing) - var(--radius) - 1px);\n  width: calc(2 * var(--radius));\n  height: calc(2 * var(--radius));\n  border-radius: 50%;\n  background: #ddd;\n}\n\n.tree summary::before {\n  z-index: 1;\n  background: rgb(113, 150, 199) 0 0;\n}\n\n.tree details[open] > summary::before {\n  background-position: calc(-2 * var(--radius)) 0;\n}\n','@use "../abstracts/mixins";\n@use "../abstracts/variables";\n@use "preview-table";\n\n.text-analysis-tagging {\n  @include preview-table.preview-table;\n\n  &__no-headers {\n    padding: 0 4px;\n  }\n}\n'],sourceRoot:""}]);const l=i},113033:(e,t,a)=>{"use strict";a.d(t,{X:()=>c,u:()=>d});var n=a(922873),o=a(322466),r=a(9847),i=a(528804),l=a(463345);const s=()=>(0,i.yw9)("OfficeVSO_9565005_InsertImageOCV");function c(e){return e.useExcelMDComponents?(0,l.i)(e.telemetryFeatureName):void 0}function d(e,t){switch(e){case n.w.ElseSkillName:return{showAiGenerated:!1,feedbackPosition:o.O.None,useExcelMDComponents:!0,telemetryFeatureName:r.q.Else,feedbackData:{feedbackArea:"Copilot\\Else"},shouldShowDevDiagnosticsButton:!1,addCardToChatHistory:!1};case n.w.GetInsightsName:case n.w.ExcelAnalysis:case n.w.ChartsAndPivotTablesName:case n.w.TextAnalysisName:return{showAiGenerated:!0,feedbackPosition:o.O.Footer,useExcelMDComponents:!0,telemetryFeatureName:r.q.AnalyzeData,feedbackData:{feedbackArea:"Copilot\\Analyze Data"},shouldShowDevDiagnosticsButton:!0,addCardToChatHistory:!1};case n.w.ImageChatName:return s()?{showAiGenerated:!0,feedbackPosition:o.O.Footer,useExcelMDComponents:!0,telemetryFeatureName:r.q.ImageChat,feedbackData:{feedbackArea:"Copilot\\Image Chat"},shouldShowDevDiagnosticsButton:!0,addCardToChatHistory:!1}:{showAiGenerated:!1,feedbackPosition:o.O.Footer,useExcelMDComponents:!1,telemetryFeatureName:t?r.q.Search:r.q.CopilotChat,feedbackData:{feedbackArea:t?"Copilot\\Search":"Copilot"},shouldShowDevDiagnosticsButton:!1,addCardToChatHistory:!1};default:return{showAiGenerated:!1,feedbackPosition:o.O.Footer,useExcelMDComponents:!1,telemetryFeatureName:t?r.q.Search:r.q.CopilotChat,feedbackData:{feedbackArea:t?"Copilot\\Search":"Copilot"},shouldShowDevDiagnosticsButton:!1,addCardToChatHistory:!1}}}},116510:(e,t,a)=>{"use strict";var n,o;a.d(t,{T:()=>n,q:()=>o}),function(e){e[e.None=0]="None",e[e.IRMTemplate=1]="IRMTemplate",e[e.IRMUserDefinedPermission=2]="IRMUserDefinedPermission",e[e.IRMEncryptOnly=3]="IRMEncryptOnly",e[e.IRMDoNotForward=4]="IRMDoNotForward"}(n||(n={})),function(e){e[e.S_APPLYLABEL_OK=0]="S_APPLYLABEL_OK",e[e.E_APPLYLABEL_FAIL=2147467259]="E_APPLYLABEL_FAIL",e[e.E_APPLYLABEL_UNSUPPORTED_CROSSTENANT=2147205120]="E_APPLYLABEL_UNSUPPORTED_CROSSTENANT",e[e.E_APPLYLABEL_DOCUMENT_READONLY=2147205119]="E_APPLYLABEL_DOCUMENT_READONLY",e[e.E_APPLYLABEL_INSUFFICIENTPERMISSION=2147205118]="E_APPLYLABEL_INSUFFICIENTPERMISSION",e[e.E_APPLYLABEL_LABELDISABLED=2147205117]="E_APPLYLABEL_LABELDISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_UDP=2147205116]="E_APPLYLABEL_UNSUPPORTED_UDP",e[e.E_APPLYLABEL_LABELING_DISABLED=2147205115]="E_APPLYLABEL_LABELING_DISABLED",e[e.E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE=2147205114]="E_APPLYLABEL_UNSUPPORTED_CONTENTTYPE",e[e.E_APPLYLABEL_UNSUPPORTED_DKE=2147205113]="E_APPLYLABEL_UNSUPPORTED_DKE",e[e.E_APPLYLABEL_LABELNOTFOUND=2147205112]="E_APPLYLABEL_LABELNOTFOUND",e[e.E_APPLYLABEL_USERNOTFOUND=2147220727]="E_APPLYLABEL_USERNOTFOUND",e[e.E_APPLYLABEL_NEWLABELSENSITIVITYORDER=2147205105]="E_APPLYLABEL_NEWLABELSENSITIVITYORDER"}(o||(o={}))},117463:(e,t,a)=>{"use strict";var n=a(374522),o=a.n(n),r=a(83643),i=a.n(r),l=a(964185),s=a.n(l),c=a(612290),d=a.n(c),u=a(462478),m=a.n(u),h=a(101971),g=a.n(h),p=a(111570),b={};b.styleTagTransform=g(),b.setAttributes=d(),b.insert=s().bind(null,"head"),b.domAPI=i(),b.insertStyleElement=m();o()(p.A,b),p.A&&p.A.locals&&p.A.locals},119202:(e,t,a)=>{"use strict";a.d(t,{Cn:()=>x,D9:()=>E,JA:()=>k,M5:()=>w,f2:()=>T,hC:()=>L,qN:()=>_,qP:()=>F,vo:()=>R});var n=a(932367),o=a(754440),r=a(365319),i=a(722307),l=a(964792),s=a(104450),c=a(9847),d=a(476730),u=a(956258),m=a(47262),h=a(797639),g=a(638753),p=a(951903),b=a(79458),f=a(528804),C=a(348065);let y,v;function x({showAIGenerated:e,showAnimation:t,footerPosition:a,actionButtonList:n,isFailure:o,references:r,annotationReferences:i,clpLabel:l,msgExtCardProps:s,apiPluginCardProps:c,confirmationCardProps:d,pluginAuthError:u,feedbackArea:m,telemetryData:h,chatMessageHeader:p,gptId:f,shouldShowCopyButton:C,shouldShowHandoffButton:y,shouldShowReadAloudButton:v,codePreviewProps:x}){let T;(0,b.cY)(`Showing footer with showAnimation as ${t} and AIGenerated as ${e}`);try{T=h?JSON.stringify(h):void 0}catch(e){(0,b.cY)("Error in stringifying telemetry data",e)}const S={shouldShowAIGeneratedIndicator:e,feedbackSectionPosition:a,feedbackData:w(m),isFailure:o||!1,showAnimation:t,actionButtonList:n,references:r,annotationReferences:i,clpSensitivityIndicatorData:l,msgExtCardProps:s,apiPluginCardProps:c,confirmationCardProps:d,pluginAuthError:u,telemetryData:T,messageAttributionProps:_(f),shouldShowCopyButton:C,shouldShowHandoffButton:y,shouldShowReadAloudButton:v,codePreviewProps:x};return p?{...S,chatMessageHeaderData:(0,g.Ne)(p)}:S}function T(){let e="XLWeb";switch((0,i.vI)()){case Office.PlatformType.PC:e="XLWin32";break;case Office.PlatformType.Mac:e="XLMac";break;case Office.PlatformType.iOS:e="XLiOS"}return`${e}CopilotOCV`}function S(e){const t=r.$.getInstance();let a=JSON.stringify({prompt:t.getLastUserUtterance(),promptId:u.M.userQueryGuid});try{const n=JSON.parse(a??"{}");let o,r;(0,f.yw9)("OfficeVSO_8854181_SimplifyChatHistoryForOCV")&&"Copilot\\Python"===e&&(o=h.CP.pythonContextManager.getPythonAdaContext(),r=h.CP.pythonContextManager.pythonContextBuilder.getPythonPrompt());let i,l={};"Copilot\\Python"===e&&(l=h.CP.pythonContextManager.ocvErrorDetails),(0,f.yw9)("OfficeVSO_9544730_CommunicationHandlerSingleton")&&"Copilot\\Analyze Data"===e&&(i=function(e){const t=Object.entries((0,C.KA)().getState().selection.recommendations).map((([e,t])=>t.map((t=>({...t,tableName:e}))))).flat().filter((t=>t.queryId===e)),a=t.map((e=>{const{visual:t,interpretationId:a}=e;let n;switch(t.visualType){case"ChartVisual":{const{chart:e,visualType:o}=t;n={visualType:o,interpretationId:a,axes:e.axes.length>0?e.axes.map((e=>{const t=e.title?.runs.map((e=>e.text)).join("");return t})):void 0};break}case"PivotChartVisual":case"PivotTableVisual":{const{pivotTable:e,visualType:o}=t;n={visualType:o,interpretationId:a,columnFields:0===e.columnFields.length?void 0:e.columnFields.map((e=>e.name)),rowFields:0===e.rowFields.length?void 0:e.rowFields.map((e=>e.name)),dataFields:0===e.dataFields.length?void 0:e.dataFields.map((e=>e.name)),dateFilters:0===e.dateFilters.length?void 0:e.dateFilters.map((e=>({fieldIndex:e.fieldIndex,fieldType:e.fieldType}))),filterFields:0===e.filterFields.length?void 0:e.filterFields.map((e=>e.name)),valueFilters:0===e.valueFilters.length?void 0:e.valueFilters.map((e=>({labelFieldIndex:e.labelFieldIndex,labelFieldType:e.labelFieldType,dataFieldIndex:e.dataFieldIndex}))),labelFilters:0===e.labelFilters.length?void 0:e.labelFilters.map((e=>({labelFieldIndex:e.labelFieldIndex,labelFieldType:e.labelFieldType}))),axes:"PivotChartVisual"===t.visualType&&t.chart.axes.length>0?t.chart.axes.map((e=>{const t=e.title?.runs.map((e=>e.text)).join("");return t})):void 0};break}case"ForecastVisual":n={visualType:t.visualType,interpretationId:a,data:t.chart.data,series:t.chart.series.map((e=>({title:e.title?.runs.map((e=>e.text)).join(""),dataBindings:e.dataBindings}))),previewFieldHeaders:t.previewTable.fieldHeaders,formulasFieldHeaders:t.formulasTable.fieldHeaders};break;case"QueryResultVisual":n={visualType:t.visualType,interpretationId:a,fieldHeaders:t.result.fieldHeaders.map((e=>e.runs.map((e=>e.text)).join("")))};break;case"QueryChartVisual":{const{result:e,chart:o}=t;n={visualType:t.visualType,interpretationId:a,fieldHeaders:e.fieldHeaders.map((e=>e.runs.map((e=>e.text)).join(""))),axes:o.axes.length>0?o.axes.map((e=>{const t=e.title?.runs.map((e=>e.text)).join("");return t})):void 0};break}case"TextAnalysisVisual":n={visualType:t.visualType,interpretationId:a,columnName:t.textAnalysisResult.columnName};break;default:(0,m.x)(t)}return n})),n=Object.values((0,C.KA)().getState().selection.interpretations).flat(),o=n.filter((e=>t.some((t=>t.interpretationId===e.id)))).map((e=>({id:e.id,headerRowCount:e.table.headerRowCount,headerColumnCount:e.table.headerColumnCount,orientation:e.table.orientation,fields:e.fields?.map((e=>({headerValue:e.headerValue,classification:e.classification})))??"Fields not logged for non-CMF table"})));return a.length>0?{recommendations:a,interpretation:o}:void 0}(n.promptId)),a=JSON.stringify({...n,chatHistory:(0,f.yw9)("OfficeVSO_8854181_SimplifyChatHistoryForOCV")?t.getChatHistory():t.getChatLog(),pythonContext:o,pythonPrompt:r,pythonOCVErrorDetails:l,recommendationsData:i})}catch(e){a="Error while creating CardMetaData"}return a}function w(e="Copilot"){const t=r.$.getInstance();return{feedbackArea:e,contextData:{cardMetaData:S(e),feedbackClientAppName:T(),featureName:(0,c.rI)(e),contextScreenshots:(0,f.yw9)("OfficeVSO_9902661_EnableInputImageInOCV")?(0,p.LQ)(t.getLastUserImage()):void 0}}}const E=e=>{y&&v||(y=d.E.getInstance(),v=u.M.getInstance()),e!==s.h2.None&&e!==s.h2.Unknown&&y&&(u.M.getInstance().logStandardizedAshaErrorEvent(o.W.Responsible_AI_Filter_Blocked_Response,n.c.RAI_Validation_Failed,c.BJ.CopilotChat),y.updateTelemetryChatEventData({[c.h3.ChatEventType]:"RAIOffense",[c.h3.ChatEventParameters]:JSON.stringify({offense:e,groundingMode:(0,c.Q6)()})},v))},I=()=>Office&&"ExtensionLifeCycle"in Office&&"taskpane"in Office.ExtensionLifeCycle;async function R(){(0,b.cY)("Closing Shared Header"),I()&&await Office.ExtensionLifeCycle.taskpane.close()}async function A(){(0,b.cY)("Moving Shared Header"),I()&&await Office.ExtensionLifeCycle.taskpane.move()}async function L(){(0,b.cY)("Shared Header Loaded"),I()&&await Office.ExtensionLifeCycle.taskpane.notifyHeaderLoaded()}function k(){if(!i.iJ.isMacPlatform()&&!i.iJ.isIOSPlatform())return{type:l.y.Close,clickHandler:R}}function F(){if(i.iJ.isWin32Platform()){return{buttons:[{type:l.y.Move,clickHandler:A},{type:l.y.Close,clickHandler:R}]}}}const _=e=>{let t=u.M?.userQueryGuid?{promptId:u.M.userQueryGuid}:void 0;return e&&(t={...t,id:e,name:""}),t}},131778:(e,t,a)=>{"use strict";a.d(t,{e:()=>n});const n="#156082"},136609:(e,t,a)=>{"use strict";a.d(t,{e:()=>c});var n=a(965634),o=a(9847),r=a(83437),i=a(956258),l=a(947621);class s{constructor(e,t){this.finished=!1,this.reject=e=>{this.finished||(this.rejectFn(e),this.finished=!0)},this.resolve=e=>{this.finished||(this.resolveFn(e),this.finished=!0)},this.resolveFn=e,this.rejectFn=t}}class c{release(e){if(e!==this.outstandingToken)throw new Error("Release attempted by non-owner");this.outstandingToken=void 0,this.operation=void 0,this.processQueue()}processQueue(){if(this.waitQueue.length>0){const e=this.tryAcquire();if(e){this.waitQueue.shift().resolveFn(e)}}}tryAcquire(e){if(this.outstandingToken)return;const t=new d(this.release.bind(this));return this.outstandingToken=t,this.operation=e,t}async waitFor(){let e;const t=new Promise(((t,a)=>{e=new s(t,a),this.waitQueue.push(e)}));return this.processQueue(),t}logMutexTokenError(e,t,a=o.OP.ActionAI){const l=e,s={eventType:n.S2.ContextManager,errorMessage:l,logLevel:r.$b.Warning},c=i.M.getInstance(),d=[{key:n.fQ.Source,value:t}],u={prev:this.operation,current:a};d.push({key:n.fQ.Operations,value:JSON.stringify(u)}),c.logError(s,void 0,d)}constructor(){this.waitQueue=[]}}class d{release(){this.relFn(this)}logSelectionChangeEvent(){if(!this.selectionChanged){this.selectionChanged=!0;const e={key:n.Wg.SelectionChange,value:!0};(0,l.j)([e])}}constructor(e){this.relFn=e,this.selectionChanged=!1}}},140280:(e,t,a)=>{"use strict";a.d(t,{I:()=>c,O:()=>o});var n=a(805027);function o(e){const{valueRows:t,formatRows:a,textRows:n,formulas:o}=e;return{values:t,numberFormats:a,texts:n,formulas:o}}function r(e,t,a){return e.values[t][a]}function i(e,t,a){return e.texts[t][a]}function l(e,t,a){return e.formulas?.[t][a]}function s(e,t,a){return(0,n.gV)(e.numberFormats,t,a)}function c(e,t,a,n,o){return{row:t+n,column:a+o,displayText:i(e,t,a),rawValueJson:JSON.stringify(r(e,t,a)),numberFormat:s(e,t,a),formulaJson:JSON.stringify(l(e,t,a))}}},156085:e=>{"use strict";e.exports="data:application/font-woff;charset=utf-8;base64, d09GRgABAAAAAAZgABAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABGRlRNAAAGRAAAABoAAAAci6qHkUdERUYAAAWgAAAAIwAAACQAYABXR1BPUwAABhQAAAAuAAAANuAY7+xHU1VCAAAFxAAAAFAAAABm2fPczU9TLzIAAAHcAAAASgAAAGBP9V5RY21hcAAAAkQAAACIAAABYt6F0cBjdnQgAAACzAAAAAQAAAAEABEBRGdhc3AAAAWYAAAACAAAAAj//wADZ2x5ZgAAAywAAADMAAAD2MHtryVoZWFkAAABbAAAADAAAAA2E2+eoWhoZWEAAAGcAAAAHwAAACQC9gDzaG10eAAAAigAAAAZAAAArgJkABFsb2NhAAAC0AAAAFoAAABaFQAUGG1heHAAAAG8AAAAHwAAACAAcABAbmFtZQAAA/gAAAE5AAACXvFdBwlwb3N0AAAFNAAAAGIAAACE5s74hXjaY2BkYGAAYpf5Hu/j+W2+MnAzMYDAzaX6QjD6/4//Bxj5GA8AuRwMYGkAPywL13jaY2BkYGA88P8Agx4j+/8fQDYfA1AEBWgDAIB2BOoAeNpjYGRgYNBh4GdgYgABEMnIABJzYNADCQAACWgAsQB42mNgYfzCOIGBlYGB0YcxjYGBwR1Kf2WQZGhhYGBiYGVmgAFGBiQQkOaawtDAoMBQxXjg/wEGPcYDDA4wNUA2CCgwsAAAO4EL6gAAeNpj2M0gyAACqxgGNWBkZ2D4/wMA+xkDdgAAAHjaY2BgYGaAYBkGRgYQiAHyGMF8FgYHIM3DwMHABGQrMOgyWDLEM1T9/w8UBfEMgLzE////P/5//f/V/xv+r4eaAAeMbAxwIUYmIMHEgKYAYjUcsDAwsLKxc3BycfPw8jEQA/gZBASFhEVExcQlJKWkZWTl5BUUlZRVVNXUNTQZBgMAAMR+E+gAEQFEAAAAKgAqACoANAA+AEgAUgBcAGYAcAB6AIQAjgCYAKIArAC2AMAAygDUAN4A6ADyAPwBBgEQARoBJAEuATgBQgFMAVYBYAFqAXQBfgGIAZIBnAGmAbIBzgHsAAB42u2NMQ6CUAyGW568x9AneYYgm4MJbhKFaExIOAVX8ApewSt4Bic4AfeAid3VOBixDxfPYEza5O+Xfi04YADggiUIULCuEJK8VhO4bSvpdnktHI5QCYtdi2sl8ZnXaHlqUrNKzdKcT8cjlq+rwZSvIVczNiezsfnP/uznmfPFBNODM2K7MTQ45YEAZqGP81AmGGcF3iPqOop0r1SPTaTbVkfUe4HXj97wYE+yNwWYxwWu4v1ugWHgo3S1XdZEVqWM7ET0cfnLGxWfkgR42o2PvWrDMBSFj/IHLaF0zKjRgdiVMwScNRAoWUoH78Y2icB/yIY09An6AH2Bdu/UB+yxopYshQiEvnvu0dURgDt8QeC8PDw7Fpji3fEA4z/PEJ6YOB5hKh4dj3EvXhxPqH/SKUY3rJ7srZ4FZnh1PMAtPhwP6fl2PMJMPDgeQ4rY8YT6Gzao0eAEA409DuggmTnFnOcSCiEiLMgxCiTI6Cq5DZUd3Qmp10vO0LaLTd2cjN4fOumlc7lUYbSQcZFkutRG7g6JKZKy0RmdLY680CDnEJ+UMkpFFe1RN7nxdVpXrC4aTtnaurOnYercZg2YVmLN/d/gczfEimrE/fs/bOuq29Zmn8tloORaXgZgGa78yO9/cnXm2BpaGvq25Dv9S4E9+5SIc9PqupJKhYFSSl47+Qcr1mYNAAAAeNptw0cKwkAAAMDZJA8Q7OUJvkLsPfZ6zFVERPy8qHh2YER+3i/BP83vIBLLySsoKimrqKqpa2hp6+jq6RsYGhmbmJqZSy0sraxtbO3sHRydnEMU4uR6yx7JJXveP7WrDycAAAAAAAH//wACeNpjYGRgYOABYhkgZgJCZgZNBkYGLQZtIJsFLMYAAAw3ALgAeNolizEKgDAQBCchRbC2sFER0YD6qVQiBCv/H9ezGI6Z5XBAw8CBK/m5iQQVauVbXLnOrMZv2oLdKFa8Pjuru2hJzGabmOSLzNMzvutpB3N42mNgZGBg4GKQYzBhYMxJLMlj4GBgAYow/P/PAJJhLM6sSoWKfWCAAwDAjgbRAAB42mNgYGBkAIIbCZo5IPrmUn0hGA0AO8EFTQAA"},157669:(e,t,a)=>{"use strict";a.d(t,{V:()=>u});var n=a(449650),o=a(893763),r=a(454826),i=a(530495);function l(){const e={variant:i.MH,variantVersion:2};return JSON.stringify(e)}var s=a(507628);const c=e=>{const t={...d(),...e};return{storageScript:t,localUpdates:{dateLastModified:Date.now(),body:t.body,parameterInfo:t.parameterInfo}}},d=()=>({id:(0,s.A)(),name:"TempScript",body:r.newScriptBody,description:"",apiInfo:l(),isCreator:!0,creatorId:"0a088C17MOCKPUID",creatorDisplayName:"Name",creatorEmail:"name@contoso.com",mruItemId:(0,s.A)()});async function u(e,t,a,r,i){try{const o=await async function(){return Excel.run(n.getStartingContext)}();if(r){const e=(0,n.getParameterAliasesTableByName)({tableAliasId:r,tableAliasDisplayName:"inputTable"});o.parameterAliasInfo=e}const l=function(){const e=new n.ExcelLocalCodeGenerator([]);return new n.GeneralExtendedRangeCodeGenerator(e)}(),s=function(e){const t=e?new n.OfficeScriptsRelativeRangeExpressionGenerator(e):new n.OfficeScriptsAbsoluteRangeExpressionGenerator;return new n.OfficeScriptCodeBlockGenerator(t)}();await l.startNewRecording(o),e.forEach((e=>l.addEvent(e)));let d=await l.getCode(s,!1);return i&&(d=`// ${i}\n${d}`),c({name:t,description:a,body:d})}catch{throw new o.WD("Failed to generate Office Scripts script.")}}},162134:(e,t,a)=>{"use strict";a.d(t,{Pg:()=>l,iZ:()=>u,ip:()=>c,oe:()=>s,z6:()=>d});var n=a(267324);const o=[];function r(){if(o.length>0)return;const e=Office.context.requirements.isSetSupported("ExcelApi","1.9");o.push({excelType:Excel.ChartType.area,insightsType:"area",ivyLayout:"Area",localizedName:(0,n.Wuy)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.areaStacked,insightsType:"areaStacked",ivyLayout:"Area Stacked",localizedName:(0,n.CDV)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.areaStacked100,insightsType:"areaStacked100",ivyLayout:"Area Stacked (100%)",localizedName:(0,n.QKr)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.barClustered,insightsType:"barClustered",ivyLayout:"Bar Clustered",localizedName:(0,n.AUu)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.barStacked,insightsType:"barStacked",ivyLayout:"Bar Stacked",localizedName:(0,n.wnp)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.barStacked100,insightsType:"barStacked100",ivyLayout:"Bar Stacked (100%)",localizedName:(0,n.yid)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.columnClustered,insightsType:"columnClustered",ivyLayout:"Column Clustered",localizedName:(0,n.bo$)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.columnStacked,insightsType:"columnStacked",ivyLayout:"Column Stacked",localizedName:(0,n.H1r)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.columnStacked100,insightsType:"columnStacked100",ivyLayout:"Column Stacked (100%)",localizedName:(0,n.N0H)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.line,insightsType:"line",ivyLayout:"Line",localizedName:(0,n.PKs)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.lineStacked,insightsType:"lineStacked",ivyLayout:"Line Stacked",localizedName:(0,n.Dt7)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.lineStacked100,insightsType:"lineStacked100",ivyLayout:"Line Stacked (100%)",localizedName:(0,n.dcf)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!0},{excelType:Excel.ChartType.doughnut,insightsType:"doughnut",ivyLayout:"Doughnut",localizedName:(0,n.$c5)(),isSupported:!0,hasCategoryLegend:!0,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.pie,insightsType:"pie",ivyLayout:"Pie",localizedName:(0,n.DXl)(),isSupported:!0,hasCategoryLegend:!0,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.xyscatter,insightsType:"scatter",ivyLayout:"Scatter",localizedName:(0,n.HPY)(),isSupported:!0,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.histogram,insightsType:"histogram",ivyLayout:"Column Clustered",localizedName:(0,n.paF)(),isSupported:e,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1},{excelType:Excel.ChartType.bubble,insightsType:"bubble",ivyLayout:"Scatter",localizedName:(0,n.nsJ)(),isSupported:!1,hasCategoryLegend:!1,datapointLimit:-1,positionAxisOnTick:!1})}const i=["columnClustered","columnStacked","columnStacked100","line","lineStacked","lineStacked100"];function l(e){r();const t=o.find((t=>t.insightsType===e));if(!t)throw new Error("Invalid chart type.");return t}function s(e){r();const t=o.find((t=>t.ivyLayout===e));if(!t)throw new Error("Invalid chart type.");return t}function c(e){const t=e.series;if(0===t.length)throw new Error("Chart contains no series.");if(t.map((e=>e.layout)).filter(((e,t,a)=>t===a.findIndex((t=>t===e)))).length>2)throw new Error("Currently we only support maximum 2 chart types");const a=t.find((e=>"primary"===e.valueAxisGroup));if(void 0===a)throw new Error("All series are in the Secondary axis group");if(t.some((e=>"primary"===e.valueAxisGroup&&e.layout!==a.layout)))throw new Error("All the series in the primary axis group should have same chart layout");const n=t.find((e=>"secondary"===e.valueAxisGroup));if(n){if(t.some((e=>"secondary"===e.valueAxisGroup&&e.layout!==n.layout)))throw new Error("All the series in the secondary axis group should have same chart layout");if(!i.some((e=>e===a.layout))||!i.some((e=>e===n.layout)))throw new Error("Unsupported chart layout for combo chart")}return{primary:l(a.layout),secondary:void 0===n?void 0:l(n.layout)}}function d(){return r(),o.filter((e=>e.isSupported)).map((e=>e.insightsType))}function u(e){return e===Excel.ChartType.histogram}},162800:(e,t,a)=>{"use strict";a.d(t,{UO:()=>d,Vq:()=>c,q9:()=>s,uR:()=>l});var n=a(79458),o=a(507628);const r=new Map,i={id:"",resolve:()=>{},reject:()=>{}};async function l(){await Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.tables.load("items/name");await e.sync();for(const a of t.items)await u(e,a)}))}function s(e){m(e,void 0,`Table ${e} was deleted.`)}async function c(e){await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.tables.getItem(e).load("name");await t.sync(),r.has(a.name)||await u(t,a)}))}async function d(e){const t=r.get(e.tableId);if(!t)throw new Error(`Table ${e.tableId} was not registered for applyPowerQueryTableUpdatePlan.`);if(!e.planJson)throw new Error("planJson is missing in the annotation.");if(t!==i)throw new Error(`Table ${e.tableId} is busy.`);return await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.tables.getItem(e.tableId),i=(0,o.A)(),l=function(e,t){return new Promise(((a,n)=>{r.set(e,{id:t,resolve:a,reject:n})}))}(e.tableId,i);try{a.applyPowerQueryTableUpdatePlan(i,e.planJson),await t.sync()}catch(t){(0,n.cY)(`applyPowerQueryTableUpdatePlan failed: ${t}`),t instanceof Error?m(e.tableId,i,t):m(e.tableId,i,`An unexpected error occurred during applyPowerQueryTableUpdatePlan: '${t}'`)}await l})),`I applied the following power query transformation on the table: '${e.queryScriptExplanation}'`}async function u(e,t){g(t.name),t.onApplyPowerQueryTableUpdatePlanCompleted.add((async e=>{var a,n;e.success?(a=t.name,n=e.id,h(a,n,(e=>e.resolve()))):m(t.name,e.id,e.error)})),await e.sync()}function m(e,t,a){h(e,t,(e=>{a instanceof Error?e.reject(a):e.reject(new Error(a))}))}function h(e,t,a){const n=r.get(e);if(n&&n!==i){if(t&&t!==n.id)return;try{a(n)}finally{g(e)}}}function g(e){r.set(e,i)}},167447:(e,t,a)=>{"use strict";a.d(t,{p:()=>C});var n=a(11856),o=a(353033),r=a(112134),i=a(680873),l=a(9847),s=a(83437),c=a(630079),d=a(237600),u=a(477543),m=a(965634),h=a(956258),g=a(79458),p=a(528804),b=a(936044),f=a(507628);class C{makeBatchHandler(){return async(e,t)=>{e[7]="FA000000124",this.richApiBatches.push(e);try{this.processor.processRequest(e,n.to.Original)}catch(e){throw(0,g.cY)(String(e)),e}const a=(0,f.A)(),d=(0,p.yw9)("OfficeVSO_10374536_useNewApiBatchSignal")&&"excelAgent"===this.caller,y=(0,p.yw9)("OfficeVSO_10396995_UseVisibleObserverForCharting"),v=d?r.MZ:r.Ix,x=d?i.hM:i.j5;if((0,p.t9T)()&&"excelAgent"===this.caller){const t=new r.MZ({caller:this.caller,requestId:a,dataLocale:this.dataLocale,batch:e,...y&&{useVisibleObserver:!0}});C.sendResponseCallback&&await C.sendResponseCallback(t,!0)}let T,S;try{if((0,p.t9T)()&&"excelAgent"===this.caller){C.currentDeferredPromise=(0,o.p)();const e=setTimeout((()=>{if(C.currentDeferredPromise){const e="Timeout waiting for ExcelScratchpadExecuteRichApiBatchAnnotation response";C.currentDeferredPromise.reject(new Error(e)),h.M.getInstance().logError({eventType:m.S2.ChatEvents,errorMessage:e,logLevel:s.$b.Error}),C.currentDeferredPromise=void 0}}),12e4);let t;({annotation:S,sendResponse:t}=await C.currentDeferredPromise.promise),clearTimeout(e),C.sendResponseCallback=t}else{const t=new u.g0({parentPath:["Signal",v.getTypeName()],items:[{id:c.r.generateId(),body:new v({caller:this.caller,requestId:a,dataLocale:this.dataLocale,batch:e,...y&&{useVisibleObserver:!0}})}]});S=await(0,b.T)(t,a,m.S2.CommandingScratchpad,l.OP.Commanding,x.getTypeName())}const t=JSON.parse(S.result);null!==t.ErrorMessage||200!==t.HttpStatusCode||null===t.Body?((0,g.cY)(t.ErrorMessage),t.ErrorCode&&(0,g.cY)(t.ErrorCode),T={status:Office.AsyncResultStatus.Failed,value:null,error:t.ErrorMessage,asyncContext:null}):(t.Body.Error&&h.M.getInstance().logError({eventType:m.S2.CommandingScratchpad,errorMessage:"Caller: "+this.caller+". Error in response body: "+JSON.stringify(t.Body.Error),logLevel:s.$b.ASHA}),T={status:Office.AsyncResultStatus.Succeeded,value:{data:[t.HttpStatusCode,t.Headers,JSON.stringify(t.Body)]},error:null,asyncContext:null},this.processor.processResponse(T,n.to.Original))}catch(e){T={status:Office.AsyncResultStatus.Failed,value:null,error:e,asyncContext:null},(0,g.cY)(String(e))}t(T)}}getApiCalls(){return this.processor.getApiCallRecords()}async applySingleBatch(e){e[6]&=~d.hl.OnlyAllowMakerSafeApi,await new Promise(((t,a)=>{this.processor.processRequest(e,n.to.Replay),OSF.DDA.RichApi.executeRichApiRequestAsync(e,(e=>{if((0,g.cY)(`Api result:\n${JSON.stringify(e)}`),"failed"===e.status)return this.logApplySingleBatchError("Status failed: ",e),void a(e);try{const o=JSON.parse(e.value.data[2]);if(void 0===o.Results){const e=o.Error||"Unknown error";return this.logApplySingleBatchError("ResponseMessage.Results undefined: ",e),void a(e)}this.processor.processResponse(e,n.to.Replay),t(e)}catch(e){(0,g.cY)(`Couldn't process response: ${e}`),this.logApplySingleBatchError("Couldn't process response: ",e),a(e)}}))}))}logApplySingleBatchError(e,t){h.M.getInstance().logError({eventType:m.S2.CommandingScratchpad,errorMessage:"Apply Single Batch - "+e+JSON.stringify(t),logLevel:s.$b.ASHA})}async applyBatches(){for(const e of this.richApiBatches)await this.applySingleBatch(e)}static resolveAnnotationPromise(e,t){if(!C.currentDeferredPromise){const e="RichApiBatchProcessor.currentDeferredPromise was not created in makeBatchHandler.";throw h.M.getInstance().logError({eventType:m.S2.ChatEvents,errorMessage:e,logLevel:s.$b.Error}),new Error(e)}C.currentDeferredPromise.resolve({annotation:e,sendResponse:t}),C.currentDeferredPromise=void 0}constructor(e,t){this.richApiBatches=[],this.dataLocale=e,this.caller=t;this.processor=n.Ai.create({Chart:{Properties:["Name"]},NamedItem:{Properties:["Name"]},PivotTable:{Properties:["Name","Worksheet/Name"]},Range:{Properties:["Address"]},RangeView:{Properties:["CellAddresses"]},Shape:{Properties:["Name"]},Table:{Properties:["Name","Worksheet/Name"]},TableColumn:{Properties:["Index","Name"]},TableRow:{Properties:["Index"]},Worksheet:{Properties:["Name"]},RangeFont:{Properties:["Name"]}})}}},173339:(e,t,a)=>{"use strict";a.d(t,{R:()=>r});var n=a(267324),o=a(528804);class r{static getAugloopWorkflowTimeout(){return(0,o.iPS)("Microsoft.Office.Excel.FA000000124.NeverTimeout",!1)?2**31-1:(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.AugloopWorkflowDefaultTimeout",65e3)}static getChatHistoryWorkflowTimeout(){return(0,o.yw9)("OfficeVSO_8996311_chatHistoryTimeout")?5e3:3e3}static getAnalyzeDataNetworkTimeout(){return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataNetworkTimeout",5e4)}static getAnalyzeDataTimeout(e){const t=i(e);return t||(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataTimeout",4e4)}static getOdslExecutionTimeout(e,t){if(e){const e=i(t);if(e)return e}return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.OdslExecutionTimeout",6e4)}static getFormulaAITimeout(){const e=(0,o.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)?9e4:4e4;return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.FormulaAITimeout",e)}static getInsertColumnTimeout(){return 1e4}static getFormulaSuggestionUiTimeouts(){const[e,t,a]=(0,o.xtK)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsUITimeouts",[2e4,2e4,3e4]);return{description:e,preview:t,explanation:a}}static getLoadPaneAshaTimeout(){return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.SDXLoadTimeout",1e4)}static getLoadAuthLibraryAshaTimeout(){return 1e4}static getLoadAuthLibraryAceTimeout(){return 3e4}static getLoadAuthLibraryTimeout(){return this.getLoadAuthLibraryAceTimeout()-3e3}static getScratchpadScriptExecutionTimeout(){return(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.ScratchpadScriptExecutionTimeout",6e4)}}function i(e){const t=e>n.xtr,a=(0,o.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1),r=(0,o.Z8j)("Microsoft.Office.Excel.FA000000124.AugLoop.DynamicPlannerTimeout",73e3);if(t||a)return Math.max(t?n.Yuw:0,a?r:0)}},173491:(e,t,a)=>{"use strict";a.d(t,{EH:()=>C,IN:()=>v,Nd:()=>h,dS:()=>c,js:()=>y,x3:()=>m});var n=a(965634),o=a(632512),r=a(83437),i=a(956258),l=a(528804);const s=9,c="https://fa000000124.resources.office.net/f7024bdc-7caf-4ca8-807d-2908f09640d6/1.2.2305.23018/en-us_web/login.html";let d;async function u(){const e=Office.context.document.settings.get("LicensedIdentities");if(e){const t=await OfficeFirstPartyAuth.getIdentities();if(d=t.find((({uniqueId:t})=>e.some((e=>e===t)))),!d)throw new Error(`No logged in licensed identities found. Licensed identities found: ${e?.length}. Logged in identities: ${t.length}`)}else d=await OfficeFirstPartyAuth.getPrimaryIdentityInfo()}Office.onReady((()=>{OfficeFirstPartyAuth.supportsOauthManager=!0}));const m=()=>{let e=c;return(0,l.Hvn)()&&window.location.hostname.toLowerCase().includes("officeapps.live.com")&&(e="https://fa000000124.officeapps.live.com/mro1cdnstorage/f7024bdc-7caf-4ca8-807d-2908f09640d6/sdx/fa000000124/1.2.2507.9016/en-us_web/login.html"),new URL(e).pathname};async function h(){try{await Promise.all([OfficeFirstPartyAuth.load(c),u()])}catch(e){throw i.M.getInstance().logErrorCode(o.O.LoadAuthError,e,n.S2.AuthError,r.$b.Error),e}}const g="79d1f229-c1e5-4bd5-b2fd-4764b025b103",p=`${g}/.default`,b="DELEGATED";async function f(e){let t,a;if(!d)throw i.M.getInstance().logError({eventType:n.S2.AuthError,errorMessage:"Attempted to authenticate with no logged in licensed identity",logLevel:r.$b.Error}),new Error("Attempted to authenticate with no logged in licensed identity");const l=d.identityType;if("Unsupported"===l)throw i.M.getInstance().logError({eventType:n.S2.AuthError,errorMessage:"Unsupported identity type",logLevel:r.$b.Error},void 0,[{key:n.Wg.FetchType,value:e}]),new Error("Unsupported identity type");for(let c=0;c<=s;c++)try{return(await OfficeFirstPartyAuth.getAccessToken({resource:g,scope:"MicrosoftAccount"===l?p:void 0,policy:"MicrosoftAccount"===l?b:void 0,identityUniqueId:d.uniqueId,appName:"OAuthManager"===e?"OfficeInsightsServices":void 0},{popup:"Popup"===e})).accessToken}catch(l){const s=l instanceof OfficeExtension.Error?l.code:void 0,c="login_required"===s?r.$b.ASHA:"invalid_resource"===s?r.$b.Error:r.$b.Warning;if(i.M.getInstance().logErrorCode(o.O.AuthError,l,n.S2.AuthError,c,{key:n.Wg.FetchType,value:e}),"invalid_resource"!==s)throw l;t=l,a=s}throw i.M.getInstance().logError({eventType:n.S2.AuthError,errorMessage:`Ran out of retries while authenticating. Last error encountered: ${a??"Unknown"}`,logLevel:r.$b.Error},void 0,[{key:n.Wg.FetchType,value:e}]),t}async function C(){try{return await f("OAuthManager")}catch{return!1}}async function y(){try{return await f("Silent")}catch(e){if("login_required"===e.code)return!1;throw e}}async function v(){try{return await f("Popup")}catch{return!1}}},177551:(e,t,a)=>{"use strict";var n=a(758651),o=a(208520),r=a(223401),i=a(340847);function l(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,a=1;a<arguments.length;a++)t+="&args[]="+encodeURIComponent(arguments[a]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!o)throw Error(l(227));var s=new Set,c={};function d(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(c[e]=t,e=0;e<t.length;e++)s.add(t[e])}var m=!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement),h=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,g=Object.prototype.hasOwnProperty,p={},b={};function f(e,t,a,n,o,r,i){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=n,this.attributeNamespace=o,this.mustUseProperty=a,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=i}var C={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){C[e]=new f(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];C[t]=new f(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){C[e]=new f(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){C[e]=new f(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){C[e]=new f(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){C[e]=new f(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){C[e]=new f(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){C[e]=new f(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){C[e]=new f(e,5,!1,e.toLowerCase(),null,!1,!1)}));var y=/[\-:]([a-z])/g;function v(e){return e[1].toUpperCase()}function x(e,t,a,n){var o=C.hasOwnProperty(t)?C[t]:null;(null!==o?0===o.type:!n&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,a,n){if(null==t||function(e,t,a,n){if(null!==a&&0===a.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!n&&(null!==a?!a.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,a,n))return!0;if(n)return!1;if(null!==a)switch(a.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,a,o,n)&&(a=null),n||null===o?function(e){return!!g.call(b,e)||!g.call(p,e)&&(h.test(e)?b[e]=!0:(p[e]=!0,!1))}(t)&&(null===a?e.removeAttribute(t):e.setAttribute(t,""+a)):o.mustUseProperty?e[o.propertyName]=null===a?3!==o.type&&"":a:(t=o.attributeName,n=o.attributeNamespace,null===a?e.removeAttribute(t):(a=3===(o=o.type)||4===o&&!0===a?"":""+a,n?e.setAttributeNS(n,t,a):e.setAttribute(t,a))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(y,v);C[t]=new f(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(y,v);C[t]=new f(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(y,v);C[t]=new f(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){C[e]=new f(e,1,!1,e.toLowerCase(),null,!1,!1)})),C.xlinkHref=new f("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){C[e]=new f(e,1,!1,e.toLowerCase(),null,!0,!0)}));var T=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,S=60103,w=60106,E=60107,I=60108,R=60114,A=60109,L=60110,k=60112,F=60113,_=60120,P=60115,N=60116,M=60121,O=60128,D=60129,B=60130,$=60131;if("function"==typeof Symbol&&Symbol.for){var H=Symbol.for;S=H("react.element"),w=H("react.portal"),E=H("react.fragment"),I=H("react.strict_mode"),R=H("react.profiler"),A=H("react.provider"),L=H("react.context"),k=H("react.forward_ref"),F=H("react.suspense"),_=H("react.suspense_list"),P=H("react.memo"),N=H("react.lazy"),M=H("react.block"),H("react.scope"),O=H("react.opaque.id"),D=H("react.debug_trace_mode"),B=H("react.offscreen"),$=H("react.legacy_hidden")}var U,q="function"==typeof Symbol&&Symbol.iterator;function V(e){return null===e||"object"!=typeof e?null:"function"==typeof(e=q&&e[q]||e["@@iterator"])?e:null}function G(e){if(void 0===U)try{throw Error()}catch(e){var t=e.stack.trim().match(/\n( *(at )?)/);U=t&&t[1]||""}return"\n"+U+e}var W=!1;function z(e,t){if(!e||W)return"";W=!0;var a=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(e){var n=e}Reflect.construct(e,[],t)}else{try{t.call()}catch(e){n=e}e.call(t.prototype)}else{try{throw Error()}catch(e){n=e}e()}}catch(e){if(e&&n&&"string"==typeof e.stack){for(var o=e.stack.split("\n"),r=n.stack.split("\n"),i=o.length-1,l=r.length-1;1<=i&&0<=l&&o[i]!==r[l];)l--;for(;1<=i&&0<=l;i--,l--)if(o[i]!==r[l]){if(1!==i||1!==l)do{if(i--,0>--l||o[i]!==r[l])return"\n"+o[i].replace(" at new "," at ")}while(1<=i&&0<=l);break}}}finally{W=!1,Error.prepareStackTrace=a}return(e=e?e.displayName||e.name:"")?G(e):""}function j(e){switch(e.tag){case 5:return G(e.type);case 16:return G("Lazy");case 13:return G("Suspense");case 19:return G("SuspenseList");case 0:case 2:case 15:return e=z(e.type,!1);case 11:return e=z(e.type.render,!1);case 22:return e=z(e.type._render,!1);case 1:return e=z(e.type,!0);default:return""}}function Q(e){if(null==e)return null;if("function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case E:return"Fragment";case w:return"Portal";case R:return"Profiler";case I:return"StrictMode";case F:return"Suspense";case _:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case L:return(e.displayName||"Context")+".Consumer";case A:return(e._context.displayName||"Context")+".Provider";case k:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case P:return Q(e.type);case M:return Q(e._render);case N:t=e._payload,e=e._init;try{return Q(e(t))}catch(e){}}return null}function J(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function Y(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function X(e){e._valueTracker||(e._valueTracker=function(e){var t=Y(e)?"checked":"value",a=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&void 0!==a&&"function"==typeof a.get&&"function"==typeof a.set){var o=a.get,r=a.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return o.call(this)},set:function(e){n=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:a.enumerable}),{getValue:function(){return n},setValue:function(e){n=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Z(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var a=t.getValue(),n="";return e&&(n=Y(e)?e.checked?"true":"false":e.value),(e=n)!==a&&(t.setValue(e),!0)}function K(e){if(void 0===(e=e||("undefined"!=typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function ee(e,t){var a=t.checked;return r({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=a?a:e._wrapperState.initialChecked})}function te(e,t){var a=null==t.defaultValue?"":t.defaultValue,n=null!=t.checked?t.checked:t.defaultChecked;a=J(null!=t.value?t.value:a),e._wrapperState={initialChecked:n,initialValue:a,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function ae(e,t){null!=(t=t.checked)&&x(e,"checked",t,!1)}function ne(e,t){ae(e,t);var a=J(t.value),n=t.type;if(null!=a)"number"===n?(0===a&&""===e.value||e.value!=a)&&(e.value=""+a):e.value!==""+a&&(e.value=""+a);else if("submit"===n||"reset"===n)return void e.removeAttribute("value");t.hasOwnProperty("value")?re(e,t.type,a):t.hasOwnProperty("defaultValue")&&re(e,t.type,J(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function oe(e,t,a){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!("submit"!==n&&"reset"!==n||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,a||t===e.value||(e.value=t),e.defaultValue=t}""!==(a=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==a&&(e.name=a)}function re(e,t,a){"number"===t&&K(e.ownerDocument)===e||(null==a?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+a&&(e.defaultValue=""+a))}function ie(e,t){return e=r({children:void 0},t),(t=function(e){var t="";return o.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function le(e,t,a,n){if(e=e.options,t){t={};for(var o=0;o<a.length;o++)t["$"+a[o]]=!0;for(a=0;a<e.length;a++)o=t.hasOwnProperty("$"+e[a].value),e[a].selected!==o&&(e[a].selected=o),o&&n&&(e[a].defaultSelected=!0)}else{for(a=""+J(a),t=null,o=0;o<e.length;o++){if(e[o].value===a)return e[o].selected=!0,void(n&&(e[o].defaultSelected=!0));null!==t||e[o].disabled||(t=e[o])}null!==t&&(t.selected=!0)}}function se(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(l(91));return r({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ce(e,t){var a=t.value;if(null==a){if(a=t.children,t=t.defaultValue,null!=a){if(null!=t)throw Error(l(92));if(Array.isArray(a)){if(!(1>=a.length))throw Error(l(93));a=a[0]}t=a}null==t&&(t=""),a=t}e._wrapperState={initialValue:J(a)}}function de(e,t){var a=J(t.value),n=J(t.defaultValue);null!=a&&((a=""+a)!==e.value&&(e.value=a),null==t.defaultValue&&e.defaultValue!==a&&(e.defaultValue=a)),null!=n&&(e.defaultValue=""+n)}function ue(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var me="http://www.w3.org/1999/xhtml",he="http://www.w3.org/2000/svg";function ge(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function pe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ge(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var be,fe,Ce=(fe=function(e,t){if(e.namespaceURI!==he||"innerHTML"in e)e.innerHTML=t;else{for((be=be||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=be.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!=typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,a,n){MSApp.execUnsafeLocalFunction((function(){return fe(e,t)}))}:fe);function ye(e,t){if(t){var a=e.firstChild;if(a&&a===e.lastChild&&3===a.nodeType)return void(a.nodeValue=t)}e.textContent=t}var ve={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xe=["Webkit","ms","Moz","O"];function Te(e,t,a){return null==t||"boolean"==typeof t||""===t?"":a||"number"!=typeof t||0===t||ve.hasOwnProperty(e)&&ve[e]?(""+t).trim():t+"px"}function Se(e,t){for(var a in e=e.style,t)if(t.hasOwnProperty(a)){var n=0===a.indexOf("--"),o=Te(a,t[a],n);"float"===a&&(a="cssFloat"),n?e.setProperty(a,o):e[a]=o}}Object.keys(ve).forEach((function(e){xe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),ve[t]=ve[e]}))}));var we=r({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Ee(e,t){if(t){if(we[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(l(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(l(60));if("object"!=typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(l(61))}if(null!=t.style&&"object"!=typeof t.style)throw Error(l(62))}}function Ie(e,t){if(-1===e.indexOf("-"))return"string"==typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function Re(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ae=null,Le=null,ke=null;function Fe(e){if(e=oo(e)){if("function"!=typeof Ae)throw Error(l(280));var t=e.stateNode;t&&(t=io(t),Ae(e.stateNode,e.type,t))}}function _e(e){Le?ke?ke.push(e):ke=[e]:Le=e}function Pe(){if(Le){var e=Le,t=ke;if(ke=Le=null,Fe(e),t)for(e=0;e<t.length;e++)Fe(t[e])}}function Ne(e,t){return e(t)}function Me(e,t,a,n,o){return e(t,a,n,o)}function Oe(){}var De=Ne,Be=!1,$e=!1;function He(){null===Le&&null===ke||(Oe(),Pe())}function Ue(e,t){var a=e.stateNode;if(null===a)return null;var n=io(a);if(null===n)return null;a=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(n=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!n;break e;default:e=!1}if(e)return null;if(a&&"function"!=typeof a)throw Error(l(231,t,typeof a));return a}var qe=!1;if(m)try{var Ve={};Object.defineProperty(Ve,"passive",{get:function(){qe=!0}}),window.addEventListener("test",Ve,Ve),window.removeEventListener("test",Ve,Ve)}catch(fe){qe=!1}function Ge(e,t,a,n,o,r,i,l,s){var c=Array.prototype.slice.call(arguments,3);try{t.apply(a,c)}catch(e){this.onError(e)}}var We=!1,ze=null,je=!1,Qe=null,Je={onError:function(e){We=!0,ze=e}};function Ye(e,t,a,n,o,r,i,l,s){We=!1,ze=null,Ge.apply(Je,arguments)}function Xe(e){var t=e,a=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{!!(1026&(t=e).flags)&&(a=t.return),e=t.return}while(e)}return 3===t.tag?a:null}function Ze(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function Ke(e){if(Xe(e)!==e)throw Error(l(188))}function et(e){if(e=function(e){var t=e.alternate;if(!t){if(null===(t=Xe(e)))throw Error(l(188));return t!==e?null:e}for(var a=e,n=t;;){var o=a.return;if(null===o)break;var r=o.alternate;if(null===r){if(null!==(n=o.return)){a=n;continue}break}if(o.child===r.child){for(r=o.child;r;){if(r===a)return Ke(o),e;if(r===n)return Ke(o),t;r=r.sibling}throw Error(l(188))}if(a.return!==n.return)a=o,n=r;else{for(var i=!1,s=o.child;s;){if(s===a){i=!0,a=o,n=r;break}if(s===n){i=!0,n=o,a=r;break}s=s.sibling}if(!i){for(s=r.child;s;){if(s===a){i=!0,a=r,n=o;break}if(s===n){i=!0,n=r,a=o;break}s=s.sibling}if(!i)throw Error(l(189))}}if(a.alternate!==n)throw Error(l(190))}if(3!==a.tag)throw Error(l(188));return a.stateNode.current===a?e:t}(e),!e)return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function tt(e,t){for(var a=e.alternate;null!==t;){if(t===e||t===a)return!0;t=t.return}return!1}var at,nt,ot,rt,it=!1,lt=[],st=null,ct=null,dt=null,ut=new Map,mt=new Map,ht=[],gt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function pt(e,t,a,n,o){return{blockedOn:e,domEventName:t,eventSystemFlags:16|a,nativeEvent:o,targetContainers:[n]}}function bt(e,t){switch(e){case"focusin":case"focusout":st=null;break;case"dragenter":case"dragleave":ct=null;break;case"mouseover":case"mouseout":dt=null;break;case"pointerover":case"pointerout":ut.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":mt.delete(t.pointerId)}}function ft(e,t,a,n,o,r){return null===e||e.nativeEvent!==r?(e=pt(t,a,n,o,r),null!==t&&(null!==(t=oo(t))&&nt(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,null!==o&&-1===t.indexOf(o)&&t.push(o),e)}function Ct(e){var t=no(e.target);if(null!==t){var a=Xe(t);if(null!==a)if(13===(t=a.tag)){if(null!==(t=Ze(a)))return e.blockedOn=t,void rt(e.lanePriority,(function(){i.unstable_runWithPriority(e.priority,(function(){ot(a)}))}))}else if(3===t&&a.stateNode.hydrate)return void(e.blockedOn=3===a.tag?a.stateNode.containerInfo:null)}e.blockedOn=null}function yt(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var a=ea(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==a)return null!==(t=oo(a))&&nt(t),e.blockedOn=a,!1;t.shift()}return!0}function vt(e,t,a){yt(e)&&a.delete(t)}function xt(){for(it=!1;0<lt.length;){var e=lt[0];if(null!==e.blockedOn){null!==(e=oo(e.blockedOn))&&at(e);break}for(var t=e.targetContainers;0<t.length;){var a=ea(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==a){e.blockedOn=a;break}t.shift()}null===e.blockedOn&&lt.shift()}null!==st&&yt(st)&&(st=null),null!==ct&&yt(ct)&&(ct=null),null!==dt&&yt(dt)&&(dt=null),ut.forEach(vt),mt.forEach(vt)}function Tt(e,t){e.blockedOn===t&&(e.blockedOn=null,it||(it=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,xt)))}function St(e){function t(t){return Tt(t,e)}if(0<lt.length){Tt(lt[0],e);for(var a=1;a<lt.length;a++){var n=lt[a];n.blockedOn===e&&(n.blockedOn=null)}}for(null!==st&&Tt(st,e),null!==ct&&Tt(ct,e),null!==dt&&Tt(dt,e),ut.forEach(t),mt.forEach(t),a=0;a<ht.length;a++)(n=ht[a]).blockedOn===e&&(n.blockedOn=null);for(;0<ht.length&&null===(a=ht[0]).blockedOn;)Ct(a),null===a.blockedOn&&ht.shift()}function wt(e,t){var a={};return a[e.toLowerCase()]=t.toLowerCase(),a["Webkit"+e]="webkit"+t,a["Moz"+e]="moz"+t,a}var Et={animationend:wt("Animation","AnimationEnd"),animationiteration:wt("Animation","AnimationIteration"),animationstart:wt("Animation","AnimationStart"),transitionend:wt("Transition","TransitionEnd")},It={},Rt={};function At(e){if(It[e])return It[e];if(!Et[e])return e;var t,a=Et[e];for(t in a)if(a.hasOwnProperty(t)&&t in Rt)return It[e]=a[t];return e}m&&(Rt=document.createElement("div").style,"AnimationEvent"in window||(delete Et.animationend.animation,delete Et.animationiteration.animation,delete Et.animationstart.animation),"TransitionEvent"in window||delete Et.transitionend.transition);var Lt=At("animationend"),kt=At("animationiteration"),Ft=At("animationstart"),_t=At("transitionend"),Pt=new Map,Nt=new Map,Mt=["abort","abort",Lt,"animationEnd",kt,"animationIteration",Ft,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",_t,"transitionEnd","waiting","waiting"];function Ot(e,t){for(var a=0;a<e.length;a+=2){var n=e[a],o=e[a+1];o="on"+(o[0].toUpperCase()+o.slice(1)),Nt.set(n,t),Pt.set(n,o),d(o,[n])}}(0,i.unstable_now)();var Dt=8;function Bt(e){if(1&e)return Dt=15,1;if(2&e)return Dt=14,2;if(4&e)return Dt=13,4;var t=24&e;return 0!==t?(Dt=12,t):32&e?(Dt=11,32):0!==(t=192&e)?(Dt=10,t):256&e?(Dt=9,256):0!==(t=3584&e)?(Dt=8,t):4096&e?(Dt=7,4096):0!==(t=4186112&e)?(Dt=6,t):0!==(t=62914560&e)?(Dt=5,t):67108864&e?(Dt=4,67108864):134217728&e?(Dt=3,134217728):0!==(t=805306368&e)?(Dt=2,t):1073741824&e?(Dt=1,1073741824):(Dt=8,e)}function $t(e,t){var a=e.pendingLanes;if(0===a)return Dt=0;var n=0,o=0,r=e.expiredLanes,i=e.suspendedLanes,l=e.pingedLanes;if(0!==r)n=r,o=Dt=15;else if(0!==(r=134217727&a)){var s=r&~i;0!==s?(n=Bt(s),o=Dt):0!==(l&=r)&&(n=Bt(l),o=Dt)}else 0!==(r=a&~i)?(n=Bt(r),o=Dt):0!==l&&(n=Bt(l),o=Dt);if(0===n)return 0;if(n=a&((0>(n=31-Wt(n))?0:1<<n)<<1)-1,0!==t&&t!==n&&0===(t&i)){if(Bt(t),o<=Dt)return t;Dt=o}if(0!==(t=e.entangledLanes))for(e=e.entanglements,t&=n;0<t;)o=1<<(a=31-Wt(t)),n|=e[a],t&=~o;return n}function Ht(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function Ut(e,t){switch(e){case 15:return 1;case 14:return 2;case 12:return 0===(e=qt(24&~t))?Ut(10,t):e;case 10:return 0===(e=qt(192&~t))?Ut(8,t):e;case 8:return 0===(e=qt(3584&~t))&&(0===(e=qt(4186112&~t))&&(e=512)),e;case 2:return 0===(t=qt(805306368&~t))&&(t=268435456),t}throw Error(l(358,e))}function qt(e){return e&-e}function Vt(e){for(var t=[],a=0;31>a;a++)t.push(e);return t}function Gt(e,t,a){e.pendingLanes|=t;var n=t-1;e.suspendedLanes&=n,e.pingedLanes&=n,(e=e.eventTimes)[t=31-Wt(t)]=a}var Wt=Math.clz32?Math.clz32:function(e){return 0===e?32:31-(zt(e)/jt|0)|0},zt=Math.log,jt=Math.LN2;var Qt=i.unstable_UserBlockingPriority,Jt=i.unstable_runWithPriority,Yt=!0;function Xt(e,t,a,n){Be||Oe();var o=Kt,r=Be;Be=!0;try{Me(o,e,t,a,n)}finally{(Be=r)||He()}}function Zt(e,t,a,n){Jt(Qt,Kt.bind(null,e,t,a,n))}function Kt(e,t,a,n){var o;if(Yt)if((o=!(4&t))&&0<lt.length&&-1<gt.indexOf(e))e=pt(null,e,t,a,n),lt.push(e);else{var r=ea(e,t,a,n);if(null===r)o&&bt(e,n);else{if(o){if(-1<gt.indexOf(e))return e=pt(r,e,t,a,n),void lt.push(e);if(function(e,t,a,n,o){switch(t){case"focusin":return st=ft(st,e,t,a,n,o),!0;case"dragenter":return ct=ft(ct,e,t,a,n,o),!0;case"mouseover":return dt=ft(dt,e,t,a,n,o),!0;case"pointerover":var r=o.pointerId;return ut.set(r,ft(ut.get(r)||null,e,t,a,n,o)),!0;case"gotpointercapture":return r=o.pointerId,mt.set(r,ft(mt.get(r)||null,e,t,a,n,o)),!0}return!1}(r,e,t,a,n))return;bt(e,n)}On(e,t,n,null,a)}}}function ea(e,t,a,n){var o=Re(n);if(null!==(o=no(o))){var r=Xe(o);if(null===r)o=null;else{var i=r.tag;if(13===i){if(null!==(o=Ze(r)))return o;o=null}else if(3===i){if(r.stateNode.hydrate)return 3===r.tag?r.stateNode.containerInfo:null;o=null}else r!==o&&(o=null)}}return On(e,t,n,o,a),null}var ta=null,aa=null,na=null;function oa(){if(na)return na;var e,t,a=aa,n=a.length,o="value"in ta?ta.value:ta.textContent,r=o.length;for(e=0;e<n&&a[e]===o[e];e++);var i=n-e;for(t=1;t<=i&&a[n-t]===o[r-t];t++);return na=o.slice(e,1<t?1-t:void 0)}function ra(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ia(){return!0}function la(){return!1}function sa(e){function t(t,a,n,o,r){for(var i in this._reactName=t,this._targetInst=n,this.type=a,this.nativeEvent=o,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(i)&&(t=e[i],this[i]=t?t(o):o[i]);return this.isDefaultPrevented=(null!=o.defaultPrevented?o.defaultPrevented:!1===o.returnValue)?ia:la,this.isPropagationStopped=la,this}return r(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!=typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ia)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!=typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ia)},persist:function(){},isPersistent:ia}),t}var ca,da,ua,ma={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ha=sa(ma),ga=r({},ma,{view:0,detail:0}),pa=sa(ga),ba=r({},ga,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Aa,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==ua&&(ua&&"mousemove"===e.type?(ca=e.screenX-ua.screenX,da=e.screenY-ua.screenY):da=ca=0,ua=e),ca)},movementY:function(e){return"movementY"in e?e.movementY:da}}),fa=sa(ba),Ca=sa(r({},ba,{dataTransfer:0})),ya=sa(r({},ga,{relatedTarget:0})),va=sa(r({},ma,{animationName:0,elapsedTime:0,pseudoElement:0})),xa=r({},ma,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),Ta=sa(xa),Sa=sa(r({},ma,{data:0})),wa={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Ea={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Ia={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ra(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Ia[e])&&!!t[e]}function Aa(){return Ra}var La=r({},ga,{key:function(e){if(e.key){var t=wa[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ra(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Ea[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Aa,charCode:function(e){return"keypress"===e.type?ra(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ra(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),ka=sa(La),Fa=sa(r({},ba,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),_a=sa(r({},ga,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Aa})),Pa=sa(r({},ma,{propertyName:0,elapsedTime:0,pseudoElement:0})),Na=r({},ba,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ma=sa(Na),Oa=[9,13,27,32],Da=m&&"CompositionEvent"in window,Ba=null;m&&"documentMode"in document&&(Ba=document.documentMode);var $a=m&&"TextEvent"in window&&!Ba,Ha=m&&(!Da||Ba&&8<Ba&&11>=Ba),Ua=String.fromCharCode(32),qa=!1;function Va(e,t){switch(e){case"keyup":return-1!==Oa.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Ga(e){return"object"==typeof(e=e.detail)&&"data"in e?e.data:null}var Wa=!1;var za={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function ja(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!za[e.type]:"textarea"===t}function Qa(e,t,a,n){_e(n),0<(t=Bn(t,"onChange")).length&&(a=new ha("onChange","change",null,a,n),e.push({event:a,listeners:t}))}var Ja=null,Ya=null;function Xa(e){kn(e,0)}function Za(e){if(Z(ro(e)))return e}function Ka(e,t){if("change"===e)return t}var en=!1;if(m){var tn;if(m){var an="oninput"in document;if(!an){var nn=document.createElement("div");nn.setAttribute("oninput","return;"),an="function"==typeof nn.oninput}tn=an}else tn=!1;en=tn&&(!document.documentMode||9<document.documentMode)}function on(){Ja&&(Ja.detachEvent("onpropertychange",rn),Ya=Ja=null)}function rn(e){if("value"===e.propertyName&&Za(Ya)){var t=[];if(Qa(t,Ya,e,Re(e)),e=Xa,Be)e(t);else{Be=!0;try{Ne(e,t)}finally{Be=!1,He()}}}}function ln(e,t,a){"focusin"===e?(on(),Ya=a,(Ja=t).attachEvent("onpropertychange",rn)):"focusout"===e&&on()}function sn(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Za(Ya)}function cn(e,t){if("click"===e)return Za(t)}function dn(e,t){if("input"===e||"change"===e)return Za(t)}var un="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},mn=Object.prototype.hasOwnProperty;function hn(e,t){if(un(e,t))return!0;if("object"!=typeof e||null===e||"object"!=typeof t||null===t)return!1;var a=Object.keys(e),n=Object.keys(t);if(a.length!==n.length)return!1;for(n=0;n<a.length;n++)if(!mn.call(t,a[n])||!un(e[a[n]],t[a[n]]))return!1;return!0}function gn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function pn(e,t){var a,n=gn(e);for(e=0;n;){if(3===n.nodeType){if(a=e+n.textContent.length,e<=t&&a>=t)return{node:n,offset:t-e};e=a}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=gn(n)}}function bn(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?bn(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function fn(){for(var e=window,t=K();t instanceof e.HTMLIFrameElement;){try{var a="string"==typeof t.contentWindow.location.href}catch(e){a=!1}if(!a)break;t=K((e=t.contentWindow).document)}return t}function Cn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var yn=m&&"documentMode"in document&&11>=document.documentMode,vn=null,xn=null,Tn=null,Sn=!1;function wn(e,t,a){var n=a.window===a?a.document:9===a.nodeType?a:a.ownerDocument;Sn||null==vn||vn!==K(n)||("selectionStart"in(n=vn)&&Cn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},Tn&&hn(Tn,n)||(Tn=n,0<(n=Bn(xn,"onSelect")).length&&(t=new ha("onSelect","select",null,t,a),e.push({event:t,listeners:n}),t.target=vn)))}Ot("cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focusin focus focusout blur input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Ot("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Ot(Mt,2);for(var En="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),In=0;In<En.length;In++)Nt.set(En[In],0);u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),d("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),d("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),d("onBeforeInput",["compositionend","keypress","textInput","paste"]),d("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),d("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Rn="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),An=new Set("cancel close invalid load scroll toggle".split(" ").concat(Rn));function Ln(e,t,a){var n=e.type||"unknown-event";e.currentTarget=a,function(e,t,a,n,o,r,i,s,c){if(Ye.apply(this,arguments),We){if(!We)throw Error(l(198));var d=ze;We=!1,ze=null,je||(je=!0,Qe=d)}}(n,t,void 0,e),e.currentTarget=null}function kn(e,t){t=!!(4&t);for(var a=0;a<e.length;a++){var n=e[a],o=n.event;n=n.listeners;e:{var r=void 0;if(t)for(var i=n.length-1;0<=i;i--){var l=n[i],s=l.instance,c=l.currentTarget;if(l=l.listener,s!==r&&o.isPropagationStopped())break e;Ln(o,l,c),r=s}else for(i=0;i<n.length;i++){if(s=(l=n[i]).instance,c=l.currentTarget,l=l.listener,s!==r&&o.isPropagationStopped())break e;Ln(o,l,c),r=s}}}if(je)throw e=Qe,je=!1,Qe=null,e}function Fn(e,t){var a=lo(t),n=e+"__bubble";a.has(n)||(Mn(t,e,2,!1),a.add(n))}var _n="_reactListening"+Math.random().toString(36).slice(2);function Pn(e){e[_n]||(e[_n]=!0,s.forEach((function(t){An.has(t)||Nn(t,!1,e,null),Nn(t,!0,e,null)})))}function Nn(e,t,a,n){var o=4<arguments.length&&void 0!==arguments[4]?arguments[4]:0,r=a;if("selectionchange"===e&&9!==a.nodeType&&(r=a.ownerDocument),null!==n&&!t&&An.has(e)){if("scroll"!==e)return;o|=2,r=n}var i=lo(r),l=e+"__"+(t?"capture":"bubble");i.has(l)||(t&&(o|=4),Mn(r,e,o,t),i.add(l))}function Mn(e,t,a,n){var o=Nt.get(t);switch(void 0===o?2:o){case 0:o=Xt;break;case 1:o=Zt;break;default:o=Kt}a=o.bind(null,t,a,e),o=void 0,!qe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(o=!0),n?void 0!==o?e.addEventListener(t,a,{capture:!0,passive:o}):e.addEventListener(t,a,!0):void 0!==o?e.addEventListener(t,a,{passive:o}):e.addEventListener(t,a,!1)}function On(e,t,a,n,o){var r=n;if(!(1&t||2&t||null===n))e:for(;;){if(null===n)return;var i=n.tag;if(3===i||4===i){var l=n.stateNode.containerInfo;if(l===o||8===l.nodeType&&l.parentNode===o)break;if(4===i)for(i=n.return;null!==i;){var s=i.tag;if((3===s||4===s)&&((s=i.stateNode.containerInfo)===o||8===s.nodeType&&s.parentNode===o))return;i=i.return}for(;null!==l;){if(null===(i=no(l)))return;if(5===(s=i.tag)||6===s){n=r=i;continue e}l=l.parentNode}}n=n.return}!function(e,t,a){if($e)return e(t,a);$e=!0;try{return De(e,t,a)}finally{$e=!1,He()}}((function(){var n=r,o=Re(a),i=[];e:{var l=Pt.get(e);if(void 0!==l){var s=ha,c=e;switch(e){case"keypress":if(0===ra(a))break e;case"keydown":case"keyup":s=ka;break;case"focusin":c="focus",s=ya;break;case"focusout":c="blur",s=ya;break;case"beforeblur":case"afterblur":s=ya;break;case"click":if(2===a.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":s=fa;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":s=Ca;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":s=_a;break;case Lt:case kt:case Ft:s=va;break;case _t:s=Pa;break;case"scroll":s=pa;break;case"wheel":s=Ma;break;case"copy":case"cut":case"paste":s=Ta;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":s=Fa}var d=!!(4&t),u=!d&&"scroll"===e,m=d?null!==l?l+"Capture":null:l;d=[];for(var h,g=n;null!==g;){var p=(h=g).stateNode;if(5===h.tag&&null!==p&&(h=p,null!==m&&(null!=(p=Ue(g,m))&&d.push(Dn(g,p,h)))),u)break;g=g.return}0<d.length&&(l=new s(l,c,null,a,o),i.push({event:l,listeners:d}))}}if(!(7&t)){if(s="mouseout"===e||"pointerout"===e,(!(l="mouseover"===e||"pointerover"===e)||16&t||!(c=a.relatedTarget||a.fromElement)||!no(c)&&!c[to])&&(s||l)&&(l=o.window===o?o:(l=o.ownerDocument)?l.defaultView||l.parentWindow:window,s?(s=n,null!==(c=(c=a.relatedTarget||a.toElement)?no(c):null)&&(c!==(u=Xe(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(s=null,c=n),s!==c)){if(d=fa,p="onMouseLeave",m="onMouseEnter",g="mouse","pointerout"!==e&&"pointerover"!==e||(d=Fa,p="onPointerLeave",m="onPointerEnter",g="pointer"),u=null==s?l:ro(s),h=null==c?l:ro(c),(l=new d(p,g+"leave",s,a,o)).target=u,l.relatedTarget=h,p=null,no(o)===n&&((d=new d(m,g+"enter",c,a,o)).target=h,d.relatedTarget=u,p=d),u=p,s&&c)e:{for(m=c,g=0,h=d=s;h;h=$n(h))g++;for(h=0,p=m;p;p=$n(p))h++;for(;0<g-h;)d=$n(d),g--;for(;0<h-g;)m=$n(m),h--;for(;g--;){if(d===m||null!==m&&d===m.alternate)break e;d=$n(d),m=$n(m)}d=null}else d=null;null!==s&&Hn(i,l,s,d,!1),null!==c&&null!==u&&Hn(i,u,c,d,!0)}if("select"===(s=(l=n?ro(n):window).nodeName&&l.nodeName.toLowerCase())||"input"===s&&"file"===l.type)var b=Ka;else if(ja(l))if(en)b=dn;else{b=sn;var f=ln}else(s=l.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===l.type||"radio"===l.type)&&(b=cn);switch(b&&(b=b(e,n))?Qa(i,b,a,o):(f&&f(e,l,n),"focusout"===e&&(f=l._wrapperState)&&f.controlled&&"number"===l.type&&re(l,"number",l.value)),f=n?ro(n):window,e){case"focusin":(ja(f)||"true"===f.contentEditable)&&(vn=f,xn=n,Tn=null);break;case"focusout":Tn=xn=vn=null;break;case"mousedown":Sn=!0;break;case"contextmenu":case"mouseup":case"dragend":Sn=!1,wn(i,a,o);break;case"selectionchange":if(yn)break;case"keydown":case"keyup":wn(i,a,o)}var C;if(Da)e:{switch(e){case"compositionstart":var y="onCompositionStart";break e;case"compositionend":y="onCompositionEnd";break e;case"compositionupdate":y="onCompositionUpdate";break e}y=void 0}else Wa?Va(e,a)&&(y="onCompositionEnd"):"keydown"===e&&229===a.keyCode&&(y="onCompositionStart");y&&(Ha&&"ko"!==a.locale&&(Wa||"onCompositionStart"!==y?"onCompositionEnd"===y&&Wa&&(C=oa()):(aa="value"in(ta=o)?ta.value:ta.textContent,Wa=!0)),0<(f=Bn(n,y)).length&&(y=new Sa(y,e,null,a,o),i.push({event:y,listeners:f}),C?y.data=C:null!==(C=Ga(a))&&(y.data=C))),(C=$a?function(e,t){switch(e){case"compositionend":return Ga(t);case"keypress":return 32!==t.which?null:(qa=!0,Ua);case"textInput":return(e=t.data)===Ua&&qa?null:e;default:return null}}(e,a):function(e,t){if(Wa)return"compositionend"===e||!Da&&Va(e,t)?(e=oa(),na=aa=ta=null,Wa=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ha&&"ko"!==t.locale?null:t.data}}(e,a))&&(0<(n=Bn(n,"onBeforeInput")).length&&(o=new Sa("onBeforeInput","beforeinput",null,a,o),i.push({event:o,listeners:n}),o.data=C))}kn(i,t)}))}function Dn(e,t,a){return{instance:e,listener:t,currentTarget:a}}function Bn(e,t){for(var a=t+"Capture",n=[];null!==e;){var o=e,r=o.stateNode;5===o.tag&&null!==r&&(o=r,null!=(r=Ue(e,a))&&n.unshift(Dn(e,r,o)),null!=(r=Ue(e,t))&&n.push(Dn(e,r,o))),e=e.return}return n}function $n(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Hn(e,t,a,n,o){for(var r=t._reactName,i=[];null!==a&&a!==n;){var l=a,s=l.alternate,c=l.stateNode;if(null!==s&&s===n)break;5===l.tag&&null!==c&&(l=c,o?null!=(s=Ue(a,r))&&i.unshift(Dn(a,s,l)):o||null!=(s=Ue(a,r))&&i.push(Dn(a,s,l))),a=a.return}0!==i.length&&e.push({event:t,listeners:i})}function Un(){}var qn=null,Vn=null;function Gn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function Wn(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"==typeof t.children||"number"==typeof t.children||"object"==typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var zn="function"==typeof setTimeout?setTimeout:void 0,jn="function"==typeof clearTimeout?clearTimeout:void 0;function Qn(e){1===e.nodeType?e.textContent="":9===e.nodeType&&(null!=(e=e.body)&&(e.textContent=""))}function Jn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function Yn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var a=e.data;if("$"===a||"$!"===a||"$?"===a){if(0===t)return e;t--}else"/$"===a&&t++}e=e.previousSibling}return null}var Xn=0;var Zn=Math.random().toString(36).slice(2),Kn="__reactFiber$"+Zn,eo="__reactProps$"+Zn,to="__reactContainer$"+Zn,ao="__reactEvents$"+Zn;function no(e){var t=e[Kn];if(t)return t;for(var a=e.parentNode;a;){if(t=a[to]||a[Kn]){if(a=t.alternate,null!==t.child||null!==a&&null!==a.child)for(e=Yn(e);null!==e;){if(a=e[Kn])return a;e=Yn(e)}return t}a=(e=a).parentNode}return null}function oo(e){return!(e=e[Kn]||e[to])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function ro(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(l(33))}function io(e){return e[eo]||null}function lo(e){var t=e[ao];return void 0===t&&(t=e[ao]=new Set),t}var so=[],co=-1;function uo(e){return{current:e}}function mo(e){0>co||(e.current=so[co],so[co]=null,co--)}function ho(e,t){co++,so[co]=e.current,e.current=t}var go={},po=uo(go),bo=uo(!1),fo=go;function Co(e,t){var a=e.type.contextTypes;if(!a)return go;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var o,r={};for(o in a)r[o]=t[o];return n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function yo(e){return null!=(e=e.childContextTypes)}function vo(){mo(bo),mo(po)}function xo(e,t,a){if(po.current!==go)throw Error(l(168));ho(po,t),ho(bo,a)}function To(e,t,a){var n=e.stateNode;if(e=t.childContextTypes,"function"!=typeof n.getChildContext)return a;for(var o in n=n.getChildContext())if(!(o in e))throw Error(l(108,Q(t)||"Unknown",o));return r({},a,n)}function So(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||go,fo=po.current,ho(po,e),ho(bo,bo.current),!0}function wo(e,t,a){var n=e.stateNode;if(!n)throw Error(l(169));a?(e=To(e,t,fo),n.__reactInternalMemoizedMergedChildContext=e,mo(bo),mo(po),ho(po,e)):mo(bo),ho(bo,a)}var Eo=null,Io=null,Ro=i.unstable_runWithPriority,Ao=i.unstable_scheduleCallback,Lo=i.unstable_cancelCallback,ko=i.unstable_shouldYield,Fo=i.unstable_requestPaint,_o=i.unstable_now,Po=i.unstable_getCurrentPriorityLevel,No=i.unstable_ImmediatePriority,Mo=i.unstable_UserBlockingPriority,Oo=i.unstable_NormalPriority,Do=i.unstable_LowPriority,Bo=i.unstable_IdlePriority,$o={},Ho=void 0!==Fo?Fo:function(){},Uo=null,qo=null,Vo=!1,Go=_o(),Wo=1e4>Go?_o:function(){return _o()-Go};function zo(){switch(Po()){case No:return 99;case Mo:return 98;case Oo:return 97;case Do:return 96;case Bo:return 95;default:throw Error(l(332))}}function jo(e){switch(e){case 99:return No;case 98:return Mo;case 97:return Oo;case 96:return Do;case 95:return Bo;default:throw Error(l(332))}}function Qo(e,t){return e=jo(e),Ro(e,t)}function Jo(e,t,a){return e=jo(e),Ao(e,t,a)}function Yo(){if(null!==qo){var e=qo;qo=null,Lo(e)}Xo()}function Xo(){if(!Vo&&null!==Uo){Vo=!0;var e=0;try{var t=Uo;Qo(99,(function(){for(;e<t.length;e++){var a=t[e];do{a=a(!0)}while(null!==a)}})),Uo=null}catch(t){throw null!==Uo&&(Uo=Uo.slice(e+1)),Ao(No,Yo),t}finally{Vo=!1}}}var Zo=T.ReactCurrentBatchConfig;function Ko(e,t){if(e&&e.defaultProps){for(var a in t=r({},t),e=e.defaultProps)void 0===t[a]&&(t[a]=e[a]);return t}return t}var er=uo(null),tr=null,ar=null,nr=null;function or(){nr=ar=tr=null}function rr(e){var t=er.current;mo(er),e.type._context._currentValue=t}function ir(e,t){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)===t){if(null===a||(a.childLanes&t)===t)break;a.childLanes|=t}else e.childLanes|=t,null!==a&&(a.childLanes|=t);e=e.return}}function lr(e,t){tr=e,nr=ar=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Bi=!0),e.firstContext=null)}function sr(e,t){if(nr!==e&&!1!==t&&0!==t)if("number"==typeof t&&1073741823!==t||(nr=e,t=1073741823),t={context:e,observedBits:t,next:null},null===ar){if(null===tr)throw Error(l(308));ar=t,tr.dependencies={lanes:0,firstContext:t,responders:null}}else ar=ar.next=t;return e._currentValue}var cr=!1;function dr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null},effects:null}}function ur(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function mr(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function hr(e,t){if(null!==(e=e.updateQueue)){var a=(e=e.shared).pending;null===a?t.next=t:(t.next=a.next,a.next=t),e.pending=t}}function gr(e,t){var a=e.updateQueue,n=e.alternate;if(null!==n&&a===(n=n.updateQueue)){var o=null,r=null;if(null!==(a=a.firstBaseUpdate)){do{var i={eventTime:a.eventTime,lane:a.lane,tag:a.tag,payload:a.payload,callback:a.callback,next:null};null===r?o=r=i:r=r.next=i,a=a.next}while(null!==a);null===r?o=r=t:r=r.next=t}else o=r=t;return a={baseState:n.baseState,firstBaseUpdate:o,lastBaseUpdate:r,shared:n.shared,effects:n.effects},void(e.updateQueue=a)}null===(e=a.lastBaseUpdate)?a.firstBaseUpdate=t:e.next=t,a.lastBaseUpdate=t}function pr(e,t,a,n){var o=e.updateQueue;cr=!1;var i=o.firstBaseUpdate,l=o.lastBaseUpdate,s=o.shared.pending;if(null!==s){o.shared.pending=null;var c=s,d=c.next;c.next=null,null===l?i=d:l.next=d,l=c;var u=e.alternate;if(null!==u){var m=(u=u.updateQueue).lastBaseUpdate;m!==l&&(null===m?u.firstBaseUpdate=d:m.next=d,u.lastBaseUpdate=c)}}if(null!==i){for(m=o.baseState,l=0,u=d=c=null;;){s=i.lane;var h=i.eventTime;if((n&s)===s){null!==u&&(u=u.next={eventTime:h,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var g=e,p=i;switch(s=t,h=a,p.tag){case 1:if("function"==typeof(g=p.payload)){m=g.call(h,m,s);break e}m=g;break e;case 3:g.flags=-4097&g.flags|64;case 0:if(null==(s="function"==typeof(g=p.payload)?g.call(h,m,s):g))break e;m=r({},m,s);break e;case 2:cr=!0}}null!==i.callback&&(e.flags|=32,null===(s=o.effects)?o.effects=[i]:s.push(i))}else h={eventTime:h,lane:s,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===u?(d=u=h,c=m):u=u.next=h,l|=s;if(null===(i=i.next)){if(null===(s=o.shared.pending))break;i=s.next,s.next=null,o.lastBaseUpdate=s,o.shared.pending=null}}null===u&&(c=m),o.baseState=c,o.firstBaseUpdate=d,o.lastBaseUpdate=u,Vl|=l,e.lanes=l,e.memoizedState=m}}function br(e,t,a){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var n=e[t],o=n.callback;if(null!==o){if(n.callback=null,n=a,"function"!=typeof o)throw Error(l(191,o));o.call(n)}}}var fr=(new o.Component).refs;function Cr(e,t,a,n){a=null==(a=a(n,t=e.memoizedState))?t:r({},t,a),e.memoizedState=a,0===e.lanes&&(e.updateQueue.baseState=a)}var yr={isMounted:function(e){return!!(e=e._reactInternals)&&Xe(e)===e},enqueueSetState:function(e,t,a){e=e._reactInternals;var n=gs(),o=ps(e),r=mr(n,o);r.payload=t,null!=a&&(r.callback=a),hr(e,r),bs(e,o,n)},enqueueReplaceState:function(e,t,a){e=e._reactInternals;var n=gs(),o=ps(e),r=mr(n,o);r.tag=1,r.payload=t,null!=a&&(r.callback=a),hr(e,r),bs(e,o,n)},enqueueForceUpdate:function(e,t){e=e._reactInternals;var a=gs(),n=ps(e),o=mr(a,n);o.tag=2,null!=t&&(o.callback=t),hr(e,o),bs(e,n,a)}};function vr(e,t,a,n,o,r,i){return"function"==typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(n,r,i):!t.prototype||!t.prototype.isPureReactComponent||(!hn(a,n)||!hn(o,r))}function xr(e,t,a){var n=!1,o=go,r=t.contextType;return"object"==typeof r&&null!==r?r=sr(r):(o=yo(t)?fo:po.current,r=(n=null!=(n=t.contextTypes))?Co(e,o):go),t=new t(a,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=yr,e.stateNode=t,t._reactInternals=e,n&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=o,e.__reactInternalMemoizedMaskedChildContext=r),t}function Tr(e,t,a,n){e=t.state,"function"==typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(a,n),"function"==typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(a,n),t.state!==e&&yr.enqueueReplaceState(t,t.state,null)}function Sr(e,t,a,n){var o=e.stateNode;o.props=a,o.state=e.memoizedState,o.refs=fr,dr(e);var r=t.contextType;"object"==typeof r&&null!==r?o.context=sr(r):(r=yo(t)?fo:po.current,o.context=Co(e,r)),pr(e,a,o,n),o.state=e.memoizedState,"function"==typeof(r=t.getDerivedStateFromProps)&&(Cr(e,t,r,a),o.state=e.memoizedState),"function"==typeof t.getDerivedStateFromProps||"function"==typeof o.getSnapshotBeforeUpdate||"function"!=typeof o.UNSAFE_componentWillMount&&"function"!=typeof o.componentWillMount||(t=o.state,"function"==typeof o.componentWillMount&&o.componentWillMount(),"function"==typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount(),t!==o.state&&yr.enqueueReplaceState(o,o.state,null),pr(e,a,o,n),o.state=e.memoizedState),"function"==typeof o.componentDidMount&&(e.flags|=4)}var wr=Array.isArray;function Er(e,t,a){if(null!==(e=a.ref)&&"function"!=typeof e&&"object"!=typeof e){if(a._owner){if(a=a._owner){if(1!==a.tag)throw Error(l(309));var n=a.stateNode}if(!n)throw Error(l(147,e));var o=""+e;return null!==t&&null!==t.ref&&"function"==typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=n.refs;t===fr&&(t=n.refs={}),null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!=typeof e)throw Error(l(284));if(!a._owner)throw Error(l(290,e))}return e}function Ir(e,t){if("textarea"!==e.type)throw Error(l(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t))}function Rr(e){function t(t,a){if(e){var n=t.lastEffect;null!==n?(n.nextEffect=a,t.lastEffect=a):t.firstEffect=t.lastEffect=a,a.nextEffect=null,a.flags=8}}function a(a,n){if(!e)return null;for(;null!==n;)t(a,n),n=n.sibling;return null}function n(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function o(e,t){return(e=Qs(e,t)).index=0,e.sibling=null,e}function r(t,a,n){return t.index=n,e?null!==(n=t.alternate)?(n=n.index)<a?(t.flags=2,a):n:(t.flags=2,a):a}function i(t){return e&&null===t.alternate&&(t.flags=2),t}function s(e,t,a,n){return null===t||6!==t.tag?((t=Zs(a,e.mode,n)).return=e,t):((t=o(t,a)).return=e,t)}function c(e,t,a,n){return null!==t&&t.elementType===a.type?((n=o(t,a.props)).ref=Er(e,t,a),n.return=e,n):((n=Js(a.type,a.key,a.props,null,e.mode,n)).ref=Er(e,t,a),n.return=e,n)}function d(e,t,a,n){return null===t||4!==t.tag||t.stateNode.containerInfo!==a.containerInfo||t.stateNode.implementation!==a.implementation?((t=Ks(a,e.mode,n)).return=e,t):((t=o(t,a.children||[])).return=e,t)}function u(e,t,a,n,r){return null===t||7!==t.tag?((t=Ys(a,e.mode,n,r)).return=e,t):((t=o(t,a)).return=e,t)}function m(e,t,a){if("string"==typeof t||"number"==typeof t)return(t=Zs(""+t,e.mode,a)).return=e,t;if("object"==typeof t&&null!==t){switch(t.$$typeof){case S:return(a=Js(t.type,t.key,t.props,null,e.mode,a)).ref=Er(e,null,t),a.return=e,a;case w:return(t=Ks(t,e.mode,a)).return=e,t}if(wr(t)||V(t))return(t=Ys(t,e.mode,a,null)).return=e,t;Ir(e,t)}return null}function h(e,t,a,n){var o=null!==t?t.key:null;if("string"==typeof a||"number"==typeof a)return null!==o?null:s(e,t,""+a,n);if("object"==typeof a&&null!==a){switch(a.$$typeof){case S:return a.key===o?a.type===E?u(e,t,a.props.children,n,o):c(e,t,a,n):null;case w:return a.key===o?d(e,t,a,n):null}if(wr(a)||V(a))return null!==o?null:u(e,t,a,n,null);Ir(e,a)}return null}function g(e,t,a,n,o){if("string"==typeof n||"number"==typeof n)return s(t,e=e.get(a)||null,""+n,o);if("object"==typeof n&&null!==n){switch(n.$$typeof){case S:return e=e.get(null===n.key?a:n.key)||null,n.type===E?u(t,e,n.props.children,o,n.key):c(t,e,n,o);case w:return d(t,e=e.get(null===n.key?a:n.key)||null,n,o)}if(wr(n)||V(n))return u(t,e=e.get(a)||null,n,o,null);Ir(t,n)}return null}function p(o,i,l,s){for(var c=null,d=null,u=i,p=i=0,b=null;null!==u&&p<l.length;p++){u.index>p?(b=u,u=null):b=u.sibling;var f=h(o,u,l[p],s);if(null===f){null===u&&(u=b);break}e&&u&&null===f.alternate&&t(o,u),i=r(f,i,p),null===d?c=f:d.sibling=f,d=f,u=b}if(p===l.length)return a(o,u),c;if(null===u){for(;p<l.length;p++)null!==(u=m(o,l[p],s))&&(i=r(u,i,p),null===d?c=u:d.sibling=u,d=u);return c}for(u=n(o,u);p<l.length;p++)null!==(b=g(u,o,p,l[p],s))&&(e&&null!==b.alternate&&u.delete(null===b.key?p:b.key),i=r(b,i,p),null===d?c=b:d.sibling=b,d=b);return e&&u.forEach((function(e){return t(o,e)})),c}function b(o,i,s,c){var d=V(s);if("function"!=typeof d)throw Error(l(150));if(null==(s=d.call(s)))throw Error(l(151));for(var u=d=null,p=i,b=i=0,f=null,C=s.next();null!==p&&!C.done;b++,C=s.next()){p.index>b?(f=p,p=null):f=p.sibling;var y=h(o,p,C.value,c);if(null===y){null===p&&(p=f);break}e&&p&&null===y.alternate&&t(o,p),i=r(y,i,b),null===u?d=y:u.sibling=y,u=y,p=f}if(C.done)return a(o,p),d;if(null===p){for(;!C.done;b++,C=s.next())null!==(C=m(o,C.value,c))&&(i=r(C,i,b),null===u?d=C:u.sibling=C,u=C);return d}for(p=n(o,p);!C.done;b++,C=s.next())null!==(C=g(p,o,b,C.value,c))&&(e&&null!==C.alternate&&p.delete(null===C.key?b:C.key),i=r(C,i,b),null===u?d=C:u.sibling=C,u=C);return e&&p.forEach((function(e){return t(o,e)})),d}return function(e,n,r,s){var c="object"==typeof r&&null!==r&&r.type===E&&null===r.key;c&&(r=r.props.children);var d="object"==typeof r&&null!==r;if(d)switch(r.$$typeof){case S:e:{for(d=r.key,c=n;null!==c;){if(c.key===d){if(7===c.tag){if(r.type===E){a(e,c.sibling),(n=o(c,r.props.children)).return=e,e=n;break e}}else if(c.elementType===r.type){a(e,c.sibling),(n=o(c,r.props)).ref=Er(e,c,r),n.return=e,e=n;break e}a(e,c);break}t(e,c),c=c.sibling}r.type===E?((n=Ys(r.props.children,e.mode,s,r.key)).return=e,e=n):((s=Js(r.type,r.key,r.props,null,e.mode,s)).ref=Er(e,n,r),s.return=e,e=s)}return i(e);case w:e:{for(c=r.key;null!==n;){if(n.key===c){if(4===n.tag&&n.stateNode.containerInfo===r.containerInfo&&n.stateNode.implementation===r.implementation){a(e,n.sibling),(n=o(n,r.children||[])).return=e,e=n;break e}a(e,n);break}t(e,n),n=n.sibling}(n=Ks(r,e.mode,s)).return=e,e=n}return i(e)}if("string"==typeof r||"number"==typeof r)return r=""+r,null!==n&&6===n.tag?(a(e,n.sibling),(n=o(n,r)).return=e,e=n):(a(e,n),(n=Zs(r,e.mode,s)).return=e,e=n),i(e);if(wr(r))return p(e,n,r,s);if(V(r))return b(e,n,r,s);if(d&&Ir(e,r),void 0===r&&!c)switch(e.tag){case 1:case 22:case 0:case 11:case 15:throw Error(l(152,Q(e.type)||"Component"))}return a(e,n)}}var Ar=Rr(!0),Lr=Rr(!1),kr={},Fr=uo(kr),_r=uo(kr),Pr=uo(kr);function Nr(e){if(e===kr)throw Error(l(174));return e}function Mr(e,t){switch(ho(Pr,t),ho(_r,e),ho(Fr,kr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:pe(null,"");break;default:t=pe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}mo(Fr),ho(Fr,t)}function Or(){mo(Fr),mo(_r),mo(Pr)}function Dr(e){Nr(Pr.current);var t=Nr(Fr.current),a=pe(t,e.type);t!==a&&(ho(_r,e),ho(Fr,a))}function Br(e){_r.current===e&&(mo(Fr),mo(_r))}var $r=uo(0);function Hr(e){for(var t=e;null!==t;){if(13===t.tag){var a=t.memoizedState;if(null!==a&&(null===(a=a.dehydrated)||"$?"===a.data||"$!"===a.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(64&t.flags)return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ur=null,qr=null,Vr=!1;function Gr(e,t){var a=zs(5,null,null,0);a.elementType="DELETED",a.type="DELETED",a.stateNode=t,a.return=e,a.flags=8,null!==e.lastEffect?(e.lastEffect.nextEffect=a,e.lastEffect=a):e.firstEffect=e.lastEffect=a}function Wr(e,t){switch(e.tag){case 5:var a=e.type;return null!==(t=1!==t.nodeType||a.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);default:return!1}}function zr(e){if(Vr){var t=qr;if(t){var a=t;if(!Wr(e,t)){if(!(t=Jn(a.nextSibling))||!Wr(e,t))return e.flags=-1025&e.flags|2,Vr=!1,void(Ur=e);Gr(Ur,a)}Ur=e,qr=Jn(t.firstChild)}else e.flags=-1025&e.flags|2,Vr=!1,Ur=e}}function jr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;Ur=e}function Qr(e){if(e!==Ur)return!1;if(!Vr)return jr(e),Vr=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!Wn(t,e.memoizedProps))for(t=qr;t;)Gr(e,t),t=Jn(t.nextSibling);if(jr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(l(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var a=e.data;if("/$"===a){if(0===t){qr=Jn(e.nextSibling);break e}t--}else"$"!==a&&"$!"!==a&&"$?"!==a||t++}e=e.nextSibling}qr=null}}else qr=Ur?Jn(e.stateNode.nextSibling):null;return!0}function Jr(){qr=Ur=null,Vr=!1}var Yr=[];function Xr(){for(var e=0;e<Yr.length;e++)Yr[e]._workInProgressVersionPrimary=null;Yr.length=0}var Zr=T.ReactCurrentDispatcher,Kr=T.ReactCurrentBatchConfig,ei=0,ti=null,ai=null,ni=null,oi=!1,ri=!1;function ii(){throw Error(l(321))}function li(e,t){if(null===t)return!1;for(var a=0;a<t.length&&a<e.length;a++)if(!un(e[a],t[a]))return!1;return!0}function si(e,t,a,n,o,r){if(ei=r,ti=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,Zr.current=null===e||null===e.memoizedState?Ni:Mi,e=a(n,o),ri){r=0;do{if(ri=!1,!(25>r))throw Error(l(301));r+=1,ni=ai=null,t.updateQueue=null,Zr.current=Oi,e=a(n,o)}while(ri)}if(Zr.current=Pi,t=null!==ai&&null!==ai.next,ei=0,ni=ai=ti=null,oi=!1,t)throw Error(l(300));return e}function ci(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ni?ti.memoizedState=ni=e:ni=ni.next=e,ni}function di(){if(null===ai){var e=ti.alternate;e=null!==e?e.memoizedState:null}else e=ai.next;var t=null===ni?ti.memoizedState:ni.next;if(null!==t)ni=t,ai=e;else{if(null===e)throw Error(l(310));e={memoizedState:(ai=e).memoizedState,baseState:ai.baseState,baseQueue:ai.baseQueue,queue:ai.queue,next:null},null===ni?ti.memoizedState=ni=e:ni=ni.next=e}return ni}function ui(e,t){return"function"==typeof t?t(e):t}function mi(e){var t=di(),a=t.queue;if(null===a)throw Error(l(311));a.lastRenderedReducer=e;var n=ai,o=n.baseQueue,r=a.pending;if(null!==r){if(null!==o){var i=o.next;o.next=r.next,r.next=i}n.baseQueue=o=r,a.pending=null}if(null!==o){o=o.next,n=n.baseState;var s=i=r=null,c=o;do{var d=c.lane;if((ei&d)===d)null!==s&&(s=s.next={lane:0,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),n=c.eagerReducer===e?c.eagerState:e(n,c.action);else{var u={lane:d,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===s?(i=s=u,r=n):s=s.next=u,ti.lanes|=d,Vl|=d}c=c.next}while(null!==c&&c!==o);null===s?r=n:s.next=i,un(n,t.memoizedState)||(Bi=!0),t.memoizedState=n,t.baseState=r,t.baseQueue=s,a.lastRenderedState=n}return[t.memoizedState,a.dispatch]}function hi(e){var t=di(),a=t.queue;if(null===a)throw Error(l(311));a.lastRenderedReducer=e;var n=a.dispatch,o=a.pending,r=t.memoizedState;if(null!==o){a.pending=null;var i=o=o.next;do{r=e(r,i.action),i=i.next}while(i!==o);un(r,t.memoizedState)||(Bi=!0),t.memoizedState=r,null===t.baseQueue&&(t.baseState=r),a.lastRenderedState=r}return[r,n]}function gi(e,t,a){var n=t._getVersion;n=n(t._source);var o=t._workInProgressVersionPrimary;if(null!==o?e=o===n:(e=e.mutableReadLanes,(e=(ei&e)===e)&&(t._workInProgressVersionPrimary=n,Yr.push(t))),e)return a(t._source);throw Yr.push(t),Error(l(350))}function pi(e,t,a,n){var o=Ml;if(null===o)throw Error(l(349));var r=t._getVersion,i=r(t._source),s=Zr.current,c=s.useState((function(){return gi(o,t,a)})),d=c[1],u=c[0];c=ni;var m=e.memoizedState,h=m.refs,g=h.getSnapshot,p=m.source;m=m.subscribe;var b=ti;return e.memoizedState={refs:h,source:t,subscribe:n},s.useEffect((function(){h.getSnapshot=a,h.setSnapshot=d;var e=r(t._source);if(!un(i,e)){e=a(t._source),un(u,e)||(d(e),e=ps(b),o.mutableReadLanes|=e&o.pendingLanes),e=o.mutableReadLanes,o.entangledLanes|=e;for(var n=o.entanglements,l=e;0<l;){var s=31-Wt(l),c=1<<s;n[s]|=e,l&=~c}}}),[a,t,n]),s.useEffect((function(){return n(t._source,(function(){var e=h.getSnapshot,a=h.setSnapshot;try{a(e(t._source));var n=ps(b);o.mutableReadLanes|=n&o.pendingLanes}catch(e){a((function(){throw e}))}}))}),[t,n]),un(g,a)&&un(p,t)&&un(m,n)||((e={pending:null,dispatch:null,lastRenderedReducer:ui,lastRenderedState:u}).dispatch=d=_i.bind(null,ti,e),c.queue=e,c.baseQueue=null,u=gi(o,t,a),c.memoizedState=c.baseState=u),u}function bi(e,t,a){return pi(di(),e,t,a)}function fi(e){var t=ci();return"function"==typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:ui,lastRenderedState:e}).dispatch=_i.bind(null,ti,e),[t.memoizedState,e]}function Ci(e,t,a,n){return e={tag:e,create:t,destroy:a,deps:n,next:null},null===(t=ti.updateQueue)?(t={lastEffect:null},ti.updateQueue=t,t.lastEffect=e.next=e):null===(a=t.lastEffect)?t.lastEffect=e.next=e:(n=a.next,a.next=e,e.next=n,t.lastEffect=e),e}function yi(e){return e={current:e},ci().memoizedState=e}function vi(){return di().memoizedState}function xi(e,t,a,n){var o=ci();ti.flags|=e,o.memoizedState=Ci(1|t,a,void 0,void 0===n?null:n)}function Ti(e,t,a,n){var o=di();n=void 0===n?null:n;var r=void 0;if(null!==ai){var i=ai.memoizedState;if(r=i.destroy,null!==n&&li(n,i.deps))return void Ci(t,a,r,n)}ti.flags|=e,o.memoizedState=Ci(1|t,a,r,n)}function Si(e,t){return xi(516,4,e,t)}function wi(e,t){return Ti(516,4,e,t)}function Ei(e,t){return Ti(4,2,e,t)}function Ii(e,t){return"function"==typeof t?(e=e(),t(e),function(){t(null)}):null!=t?(e=e(),t.current=e,function(){t.current=null}):void 0}function Ri(e,t,a){return a=null!=a?a.concat([e]):null,Ti(4,2,Ii.bind(null,t,e),a)}function Ai(){}function Li(e,t){var a=di();t=void 0===t?null:t;var n=a.memoizedState;return null!==n&&null!==t&&li(t,n[1])?n[0]:(a.memoizedState=[e,t],e)}function ki(e,t){var a=di();t=void 0===t?null:t;var n=a.memoizedState;return null!==n&&null!==t&&li(t,n[1])?n[0]:(e=e(),a.memoizedState=[e,t],e)}function Fi(e,t){var a=zo();Qo(98>a?98:a,(function(){e(!0)})),Qo(97<a?97:a,(function(){var a=Kr.transition;Kr.transition=1;try{e(!1),t()}finally{Kr.transition=a}}))}function _i(e,t,a){var n=gs(),o=ps(e),r={lane:o,action:a,eagerReducer:null,eagerState:null,next:null},i=t.pending;if(null===i?r.next=r:(r.next=i.next,i.next=r),t.pending=r,i=e.alternate,e===ti||null!==i&&i===ti)ri=oi=!0;else{if(0===e.lanes&&(null===i||0===i.lanes)&&null!==(i=t.lastRenderedReducer))try{var l=t.lastRenderedState,s=i(l,a);if(r.eagerReducer=i,r.eagerState=s,un(s,l))return}catch(e){}bs(e,o,n)}}var Pi={readContext:sr,useCallback:ii,useContext:ii,useEffect:ii,useImperativeHandle:ii,useLayoutEffect:ii,useMemo:ii,useReducer:ii,useRef:ii,useState:ii,useDebugValue:ii,useDeferredValue:ii,useTransition:ii,useMutableSource:ii,useOpaqueIdentifier:ii,unstable_isNewReconciler:!1},Ni={readContext:sr,useCallback:function(e,t){return ci().memoizedState=[e,void 0===t?null:t],e},useContext:sr,useEffect:Si,useImperativeHandle:function(e,t,a){return a=null!=a?a.concat([e]):null,xi(4,2,Ii.bind(null,t,e),a)},useLayoutEffect:function(e,t){return xi(4,2,e,t)},useMemo:function(e,t){var a=ci();return t=void 0===t?null:t,e=e(),a.memoizedState=[e,t],e},useReducer:function(e,t,a){var n=ci();return t=void 0!==a?a(t):t,n.memoizedState=n.baseState=t,e=(e=n.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=_i.bind(null,ti,e),[n.memoizedState,e]},useRef:yi,useState:fi,useDebugValue:Ai,useDeferredValue:function(e){var t=fi(e),a=t[0],n=t[1];return Si((function(){var t=Kr.transition;Kr.transition=1;try{n(e)}finally{Kr.transition=t}}),[e]),a},useTransition:function(){var e=fi(!1),t=e[0];return yi(e=Fi.bind(null,e[1])),[e,t]},useMutableSource:function(e,t,a){var n=ci();return n.memoizedState={refs:{getSnapshot:t,setSnapshot:null},source:e,subscribe:a},pi(n,e,t,a)},useOpaqueIdentifier:function(){if(Vr){var e=!1,t=function(e){return{$$typeof:O,toString:e,valueOf:e}}((function(){throw e||(e=!0,a("r:"+(Xn++).toString(36))),Error(l(355))})),a=fi(t)[1];return!(2&ti.mode)&&(ti.flags|=516,Ci(5,(function(){a("r:"+(Xn++).toString(36))}),void 0,null)),t}return fi(t="r:"+(Xn++).toString(36)),t},unstable_isNewReconciler:!1},Mi={readContext:sr,useCallback:Li,useContext:sr,useEffect:wi,useImperativeHandle:Ri,useLayoutEffect:Ei,useMemo:ki,useReducer:mi,useRef:vi,useState:function(){return mi(ui)},useDebugValue:Ai,useDeferredValue:function(e){var t=mi(ui),a=t[0],n=t[1];return wi((function(){var t=Kr.transition;Kr.transition=1;try{n(e)}finally{Kr.transition=t}}),[e]),a},useTransition:function(){var e=mi(ui)[0];return[vi().current,e]},useMutableSource:bi,useOpaqueIdentifier:function(){return mi(ui)[0]},unstable_isNewReconciler:!1},Oi={readContext:sr,useCallback:Li,useContext:sr,useEffect:wi,useImperativeHandle:Ri,useLayoutEffect:Ei,useMemo:ki,useReducer:hi,useRef:vi,useState:function(){return hi(ui)},useDebugValue:Ai,useDeferredValue:function(e){var t=hi(ui),a=t[0],n=t[1];return wi((function(){var t=Kr.transition;Kr.transition=1;try{n(e)}finally{Kr.transition=t}}),[e]),a},useTransition:function(){var e=hi(ui)[0];return[vi().current,e]},useMutableSource:bi,useOpaqueIdentifier:function(){return hi(ui)[0]},unstable_isNewReconciler:!1},Di=T.ReactCurrentOwner,Bi=!1;function $i(e,t,a,n){t.child=null===e?Lr(t,null,a,n):Ar(t,e.child,a,n)}function Hi(e,t,a,n,o){a=a.render;var r=t.ref;return lr(t,o),n=si(e,t,a,n,r,o),null===e||Bi?(t.flags|=1,$i(e,t,n,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,ll(e,t,o))}function Ui(e,t,a,n,o,r){if(null===e){var i=a.type;return"function"!=typeof i||js(i)||void 0!==i.defaultProps||null!==a.compare||void 0!==a.defaultProps?((e=Js(a.type,null,n,t,t.mode,r)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=i,qi(e,t,i,n,o,r))}return i=e.child,0===(o&r)&&(o=i.memoizedProps,(a=null!==(a=a.compare)?a:hn)(o,n)&&e.ref===t.ref)?ll(e,t,r):(t.flags|=1,(e=Qs(i,n)).ref=t.ref,e.return=t,t.child=e)}function qi(e,t,a,n,o,r){if(null!==e&&hn(e.memoizedProps,n)&&e.ref===t.ref){if(Bi=!1,0===(r&o))return t.lanes=e.lanes,ll(e,t,r);16384&e.flags&&(Bi=!0)}return Wi(e,t,a,n,r)}function Vi(e,t,a){var n=t.pendingProps,o=n.children,r=null!==e?e.memoizedState:null;if("hidden"===n.mode||"unstable-defer-without-hiding"===n.mode)if(4&t.mode){if(!(1073741824&a))return e=null!==r?r.baseLanes|a:a,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e},ws(t,e),null;t.memoizedState={baseLanes:0},ws(t,null!==r?r.baseLanes:a)}else t.memoizedState={baseLanes:0},ws(t,a);else null!==r?(n=r.baseLanes|a,t.memoizedState=null):n=a,ws(t,n);return $i(e,t,o,a),t.child}function Gi(e,t){var a=t.ref;(null===e&&null!==a||null!==e&&e.ref!==a)&&(t.flags|=128)}function Wi(e,t,a,n,o){var r=yo(a)?fo:po.current;return r=Co(t,r),lr(t,o),a=si(e,t,a,n,r,o),null===e||Bi?(t.flags|=1,$i(e,t,a,o),t.child):(t.updateQueue=e.updateQueue,t.flags&=-517,e.lanes&=~o,ll(e,t,o))}function zi(e,t,a,n,o){if(yo(a)){var r=!0;So(t)}else r=!1;if(lr(t,o),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),xr(t,a,n),Sr(t,a,n,o),n=!0;else if(null===e){var i=t.stateNode,l=t.memoizedProps;i.props=l;var s=i.context,c=a.contextType;"object"==typeof c&&null!==c?c=sr(c):c=Co(t,c=yo(a)?fo:po.current);var d=a.getDerivedStateFromProps,u="function"==typeof d||"function"==typeof i.getSnapshotBeforeUpdate;u||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(l!==n||s!==c)&&Tr(t,i,n,c),cr=!1;var m=t.memoizedState;i.state=m,pr(t,n,i,o),s=t.memoizedState,l!==n||m!==s||bo.current||cr?("function"==typeof d&&(Cr(t,a,d,n),s=t.memoizedState),(l=cr||vr(t,a,l,n,m,s,c))?(u||"function"!=typeof i.UNSAFE_componentWillMount&&"function"!=typeof i.componentWillMount||("function"==typeof i.componentWillMount&&i.componentWillMount(),"function"==typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount()),"function"==typeof i.componentDidMount&&(t.flags|=4)):("function"==typeof i.componentDidMount&&(t.flags|=4),t.memoizedProps=n,t.memoizedState=s),i.props=n,i.state=s,i.context=c,n=l):("function"==typeof i.componentDidMount&&(t.flags|=4),n=!1)}else{i=t.stateNode,ur(e,t),l=t.memoizedProps,c=t.type===t.elementType?l:Ko(t.type,l),i.props=c,u=t.pendingProps,m=i.context,"object"==typeof(s=a.contextType)&&null!==s?s=sr(s):s=Co(t,s=yo(a)?fo:po.current);var h=a.getDerivedStateFromProps;(d="function"==typeof h||"function"==typeof i.getSnapshotBeforeUpdate)||"function"!=typeof i.UNSAFE_componentWillReceiveProps&&"function"!=typeof i.componentWillReceiveProps||(l!==u||m!==s)&&Tr(t,i,n,s),cr=!1,m=t.memoizedState,i.state=m,pr(t,n,i,o);var g=t.memoizedState;l!==u||m!==g||bo.current||cr?("function"==typeof h&&(Cr(t,a,h,n),g=t.memoizedState),(c=cr||vr(t,a,c,n,m,g,s))?(d||"function"!=typeof i.UNSAFE_componentWillUpdate&&"function"!=typeof i.componentWillUpdate||("function"==typeof i.componentWillUpdate&&i.componentWillUpdate(n,g,s),"function"==typeof i.UNSAFE_componentWillUpdate&&i.UNSAFE_componentWillUpdate(n,g,s)),"function"==typeof i.componentDidUpdate&&(t.flags|=4),"function"==typeof i.getSnapshotBeforeUpdate&&(t.flags|=256)):("function"!=typeof i.componentDidUpdate||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=256),t.memoizedProps=n,t.memoizedState=g),i.props=n,i.state=g,i.context=s,n=c):("function"!=typeof i.componentDidUpdate||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!=typeof i.getSnapshotBeforeUpdate||l===e.memoizedProps&&m===e.memoizedState||(t.flags|=256),n=!1)}return ji(e,t,a,n,r,o)}function ji(e,t,a,n,o,r){Gi(e,t);var i=!!(64&t.flags);if(!n&&!i)return o&&wo(t,a,!1),ll(e,t,r);n=t.stateNode,Di.current=t;var l=i&&"function"!=typeof a.getDerivedStateFromError?null:n.render();return t.flags|=1,null!==e&&i?(t.child=Ar(t,e.child,null,r),t.child=Ar(t,null,l,r)):$i(e,t,l,r),t.memoizedState=n.state,o&&wo(t,a,!0),t.child}function Qi(e){var t=e.stateNode;t.pendingContext?xo(0,t.pendingContext,t.pendingContext!==t.context):t.context&&xo(0,t.context,!1),Mr(e,t.containerInfo)}var Ji,Yi,Xi,Zi,Ki={dehydrated:null,retryLane:0};function el(e,t,a){var n,o=t.pendingProps,r=$r.current,i=!1;return(n=!!(64&t.flags))||(n=(null===e||null!==e.memoizedState)&&!!(2&r)),n?(i=!0,t.flags&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(r|=1),ho($r,1&r),null===e?(void 0!==o.fallback&&zr(t),e=o.children,r=o.fallback,i?(e=tl(t,e,r,a),t.child.memoizedState={baseLanes:a},t.memoizedState=Ki,e):"number"==typeof o.unstable_expectedLoadTime?(e=tl(t,e,r,a),t.child.memoizedState={baseLanes:a},t.memoizedState=Ki,t.lanes=33554432,e):((a=Xs({mode:"visible",children:e},t.mode,a,null)).return=t,t.child=a)):(e.memoizedState,i?(o=nl(e,t,o.children,o.fallback,a),i=t.child,r=e.child.memoizedState,i.memoizedState=null===r?{baseLanes:a}:{baseLanes:r.baseLanes|a},i.childLanes=e.childLanes&~a,t.memoizedState=Ki,o):(a=al(e,t,o.children,a),t.memoizedState=null,a))}function tl(e,t,a,n){var o=e.mode,r=e.child;return t={mode:"hidden",children:t},2&o||null===r?r=Xs(t,o,0,null):(r.childLanes=0,r.pendingProps=t),a=Ys(a,o,n,null),r.return=e,a.return=e,r.sibling=a,e.child=r,a}function al(e,t,a,n){var o=e.child;return e=o.sibling,a=Qs(o,{mode:"visible",children:a}),!(2&t.mode)&&(a.lanes=n),a.return=t,a.sibling=null,null!==e&&(e.nextEffect=null,e.flags=8,t.firstEffect=t.lastEffect=e),t.child=a}function nl(e,t,a,n,o){var r=t.mode,i=e.child;e=i.sibling;var l={mode:"hidden",children:a};return 2&r||t.child===i?a=Qs(i,l):((a=t.child).childLanes=0,a.pendingProps=l,null!==(i=a.lastEffect)?(t.firstEffect=a.firstEffect,t.lastEffect=i,i.nextEffect=null):t.firstEffect=t.lastEffect=null),null!==e?n=Qs(e,n):(n=Ys(n,r,o,null)).flags|=2,n.return=t,a.return=t,a.sibling=n,t.child=a,n}function ol(e,t){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),ir(e.return,t)}function rl(e,t,a,n,o,r){var i=e.memoizedState;null===i?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:a,tailMode:o,lastEffect:r}:(i.isBackwards=t,i.rendering=null,i.renderingStartTime=0,i.last=n,i.tail=a,i.tailMode=o,i.lastEffect=r)}function il(e,t,a){var n=t.pendingProps,o=n.revealOrder,r=n.tail;if($i(e,t,n.children,a),2&(n=$r.current))n=1&n|2,t.flags|=64;else{if(null!==e&&64&e.flags)e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&ol(e,a);else if(19===e.tag)ol(e,a);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(ho($r,n),2&t.mode)switch(o){case"forwards":for(a=t.child,o=null;null!==a;)null!==(e=a.alternate)&&null===Hr(e)&&(o=a),a=a.sibling;null===(a=o)?(o=t.child,t.child=null):(o=a.sibling,a.sibling=null),rl(t,!1,o,a,r,t.lastEffect);break;case"backwards":for(a=null,o=t.child,t.child=null;null!==o;){if(null!==(e=o.alternate)&&null===Hr(e)){t.child=o;break}e=o.sibling,o.sibling=a,a=o,o=e}rl(t,!0,a,null,r,t.lastEffect);break;case"together":rl(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}else t.memoizedState=null;return t.child}function ll(e,t,a){if(null!==e&&(t.dependencies=e.dependencies),Vl|=t.lanes,0!==(a&t.childLanes)){if(null!==e&&t.child!==e.child)throw Error(l(153));if(null!==t.child){for(a=Qs(e=t.child,e.pendingProps),t.child=a,a.return=t;null!==e.sibling;)e=e.sibling,(a=a.sibling=Qs(e,e.pendingProps)).return=t;a.sibling=null}return t.child}return null}function sl(e,t){if(!Vr)switch(e.tailMode){case"hidden":t=e.tail;for(var a=null;null!==t;)null!==t.alternate&&(a=t),t=t.sibling;null===a?e.tail=null:a.sibling=null;break;case"collapsed":a=e.tail;for(var n=null;null!==a;)null!==a.alternate&&(n=a),a=a.sibling;null===n?t||null===e.tail?e.tail=null:e.tail.sibling=null:n.sibling=null}}function cl(e,t,a){var n=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:case 17:return yo(t.type)&&vo(),null;case 3:return Or(),mo(bo),mo(po),Xr(),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||(Qr(t)?t.flags|=4:n.hydrate||(t.flags|=256)),Yi(t),null;case 5:Br(t);var o=Nr(Pr.current);if(a=t.type,null!==e&&null!=t.stateNode)Xi(e,t,a,n,o),e.ref!==t.ref&&(t.flags|=128);else{if(!n){if(null===t.stateNode)throw Error(l(166));return null}if(e=Nr(Fr.current),Qr(t)){n=t.stateNode,a=t.type;var i=t.memoizedProps;switch(n[Kn]=t,n[eo]=i,a){case"dialog":Fn("cancel",n),Fn("close",n);break;case"iframe":case"object":case"embed":Fn("load",n);break;case"video":case"audio":for(e=0;e<Rn.length;e++)Fn(Rn[e],n);break;case"source":Fn("error",n);break;case"img":case"image":case"link":Fn("error",n),Fn("load",n);break;case"details":Fn("toggle",n);break;case"input":te(n,i),Fn("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!i.multiple},Fn("invalid",n);break;case"textarea":ce(n,i),Fn("invalid",n)}for(var s in Ee(a,i),e=null,i)i.hasOwnProperty(s)&&(o=i[s],"children"===s?"string"==typeof o?n.textContent!==o&&(e=["children",o]):"number"==typeof o&&n.textContent!==""+o&&(e=["children",""+o]):c.hasOwnProperty(s)&&null!=o&&"onScroll"===s&&Fn("scroll",n));switch(a){case"input":X(n),oe(n,i,!0);break;case"textarea":X(n),ue(n);break;case"select":case"option":break;default:"function"==typeof i.onClick&&(n.onclick=Un)}n=e,t.updateQueue=n,null!==n&&(t.flags|=4)}else{switch(s=9===o.nodeType?o:o.ownerDocument,e===me&&(e=ge(a)),e===me?"script"===a?((e=s.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"==typeof n.is?e=s.createElement(a,{is:n.is}):(e=s.createElement(a),"select"===a&&(s=e,n.multiple?s.multiple=!0:n.size&&(s.size=n.size))):e=s.createElementNS(e,a),e[Kn]=t,e[eo]=n,Ji(e,t,!1,!1),t.stateNode=e,s=Ie(a,n),a){case"dialog":Fn("cancel",e),Fn("close",e),o=n;break;case"iframe":case"object":case"embed":Fn("load",e),o=n;break;case"video":case"audio":for(o=0;o<Rn.length;o++)Fn(Rn[o],e);o=n;break;case"source":Fn("error",e),o=n;break;case"img":case"image":case"link":Fn("error",e),Fn("load",e),o=n;break;case"details":Fn("toggle",e),o=n;break;case"input":te(e,n),o=ee(e,n),Fn("invalid",e);break;case"option":o=ie(e,n);break;case"select":e._wrapperState={wasMultiple:!!n.multiple},o=r({},n,{value:void 0}),Fn("invalid",e);break;case"textarea":ce(e,n),o=se(e,n),Fn("invalid",e);break;default:o=n}Ee(a,o);var d=o;for(i in d)if(d.hasOwnProperty(i)){var u=d[i];"style"===i?Se(e,u):"dangerouslySetInnerHTML"===i?null!=(u=u?u.__html:void 0)&&Ce(e,u):"children"===i?"string"==typeof u?("textarea"!==a||""!==u)&&ye(e,u):"number"==typeof u&&ye(e,""+u):"suppressContentEditableWarning"!==i&&"suppressHydrationWarning"!==i&&"autoFocus"!==i&&(c.hasOwnProperty(i)?null!=u&&"onScroll"===i&&Fn("scroll",e):null!=u&&x(e,i,u,s))}switch(a){case"input":X(e),oe(e,n,!1);break;case"textarea":X(e),ue(e);break;case"option":null!=n.value&&e.setAttribute("value",""+J(n.value));break;case"select":e.multiple=!!n.multiple,null!=(i=n.value)?le(e,!!n.multiple,i,!1):null!=n.defaultValue&&le(e,!!n.multiple,n.defaultValue,!0);break;default:"function"==typeof o.onClick&&(e.onclick=Un)}Gn(a,n)&&(t.flags|=4)}null!==t.ref&&(t.flags|=128)}return null;case 6:if(e&&null!=t.stateNode)Zi(e,t,e.memoizedProps,n);else{if("string"!=typeof n&&null===t.stateNode)throw Error(l(166));a=Nr(Pr.current),Nr(Fr.current),Qr(t)?(n=t.stateNode,a=t.memoizedProps,n[Kn]=t,n.nodeValue!==a&&(t.flags|=4)):((n=(9===a.nodeType?a:a.ownerDocument).createTextNode(n))[Kn]=t,t.stateNode=n)}return null;case 13:return mo($r),n=t.memoizedState,64&t.flags?(t.lanes=a,t):(n=null!==n,a=!1,null===e?void 0!==t.memoizedProps.fallback&&Qr(t):a=null!==e.memoizedState,n&&!a&&2&t.mode&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||1&$r.current?0===Hl&&(Hl=3):(0!==Hl&&3!==Hl||(Hl=4),null===Ml||!(134217727&Vl)&&!(134217727&Gl)||vs(Ml,Dl))),(n||a)&&(t.flags|=4),null);case 4:return Or(),Yi(t),null===e&&Pn(t.stateNode.containerInfo),null;case 10:return rr(t),null;case 19:if(mo($r),null===(n=t.memoizedState))return null;if(i=!!(64&t.flags),null===(s=n.rendering))if(i)sl(n,!1);else{if(0!==Hl||null!==e&&64&e.flags)for(e=t.child;null!==e;){if(null!==(s=Hr(e))){for(t.flags|=64,sl(n,!1),null!==(i=s.updateQueue)&&(t.updateQueue=i,t.flags|=4),null===n.lastEffect&&(t.firstEffect=null),t.lastEffect=n.lastEffect,n=a,a=t.child;null!==a;)e=n,(i=a).flags&=2,i.nextEffect=null,i.firstEffect=null,i.lastEffect=null,null===(s=i.alternate)?(i.childLanes=0,i.lanes=e,i.child=null,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,e=s.dependencies,i.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),a=a.sibling;return ho($r,1&$r.current|2),t.child}e=e.sibling}null!==n.tail&&Wo()>Ql&&(t.flags|=64,i=!0,sl(n,!1),t.lanes=33554432)}else{if(!i)if(null!==(e=Hr(s))){if(t.flags|=64,i=!0,null!==(a=e.updateQueue)&&(t.updateQueue=a,t.flags|=4),sl(n,!0),null===n.tail&&"hidden"===n.tailMode&&!s.alternate&&!Vr)return null!==(t=t.lastEffect=n.lastEffect)&&(t.nextEffect=null),null}else 2*Wo()-n.renderingStartTime>Ql&&1073741824!==a&&(t.flags|=64,i=!0,sl(n,!1),t.lanes=33554432);n.isBackwards?(s.sibling=t.child,t.child=s):(null!==(a=n.last)?a.sibling=s:t.child=s,n.last=s)}return null!==n.tail?(a=n.tail,n.rendering=a,n.tail=a.sibling,n.lastEffect=t.lastEffect,n.renderingStartTime=Wo(),a.sibling=null,t=$r.current,ho($r,i?1&t|2:1&t),a):null;case 23:case 24:return Es(),null!==e&&null!==e.memoizedState!=(null!==t.memoizedState)&&"unstable-defer-without-hiding"!==n.mode&&(t.flags|=4),null}throw Error(l(156,t.tag))}function dl(e){switch(e.tag){case 1:yo(e.type)&&vo();var t=e.flags;return 4096&t?(e.flags=-4097&t|64,e):null;case 3:if(Or(),mo(bo),mo(po),Xr(),64&(t=e.flags))throw Error(l(285));return e.flags=-4097&t|64,e;case 5:return Br(e),null;case 13:return mo($r),4096&(t=e.flags)?(e.flags=-4097&t|64,e):null;case 19:return mo($r),null;case 4:return Or(),null;case 10:return rr(e),null;case 23:case 24:return Es(),null;default:return null}}function ul(e,t){try{var a="",n=t;do{a+=j(n),n=n.return}while(n);var o=a}catch(e){o="\nError generating stack: "+e.message+"\n"+e.stack}return{value:e,source:t,stack:o}}function ml(e,t){try{n.error(t.value)}catch(e){setTimeout((function(){throw e}))}}Ji=function(e,t){for(var a=t.child;null!==a;){if(5===a.tag||6===a.tag)e.appendChild(a.stateNode);else if(4!==a.tag&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===t)break;for(;null===a.sibling;){if(null===a.return||a.return===t)return;a=a.return}a.sibling.return=a.return,a=a.sibling}},Yi=function(){},Xi=function(e,t,a,n){var o=e.memoizedProps;if(o!==n){e=t.stateNode,Nr(Fr.current);var i,l=null;switch(a){case"input":o=ee(e,o),n=ee(e,n),l=[];break;case"option":o=ie(e,o),n=ie(e,n),l=[];break;case"select":o=r({},o,{value:void 0}),n=r({},n,{value:void 0}),l=[];break;case"textarea":o=se(e,o),n=se(e,n),l=[];break;default:"function"!=typeof o.onClick&&"function"==typeof n.onClick&&(e.onclick=Un)}for(u in Ee(a,n),a=null,o)if(!n.hasOwnProperty(u)&&o.hasOwnProperty(u)&&null!=o[u])if("style"===u){var s=o[u];for(i in s)s.hasOwnProperty(i)&&(a||(a={}),a[i]="")}else"dangerouslySetInnerHTML"!==u&&"children"!==u&&"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&"autoFocus"!==u&&(c.hasOwnProperty(u)?l||(l=[]):(l=l||[]).push(u,null));for(u in n){var d=n[u];if(s=null!=o?o[u]:void 0,n.hasOwnProperty(u)&&d!==s&&(null!=d||null!=s))if("style"===u)if(s){for(i in s)!s.hasOwnProperty(i)||d&&d.hasOwnProperty(i)||(a||(a={}),a[i]="");for(i in d)d.hasOwnProperty(i)&&s[i]!==d[i]&&(a||(a={}),a[i]=d[i])}else a||(l||(l=[]),l.push(u,a)),a=d;else"dangerouslySetInnerHTML"===u?(d=d?d.__html:void 0,s=s?s.__html:void 0,null!=d&&s!==d&&(l=l||[]).push(u,d)):"children"===u?"string"!=typeof d&&"number"!=typeof d||(l=l||[]).push(u,""+d):"suppressContentEditableWarning"!==u&&"suppressHydrationWarning"!==u&&(c.hasOwnProperty(u)?(null!=d&&"onScroll"===u&&Fn("scroll",e),l||s===d||(l=[])):"object"==typeof d&&null!==d&&d.$$typeof===O?d.toString():(l=l||[]).push(u,d))}a&&(l=l||[]).push("style",a);var u=l;(t.updateQueue=u)&&(t.flags|=4)}},Zi=function(e,t,a,n){a!==n&&(t.flags|=4)};var hl="function"==typeof WeakMap?WeakMap:Map;function gl(e,t,a){(a=mr(-1,a)).tag=3,a.payload={element:null};var n=t.value;return a.callback=function(){Zl||(Zl=!0,Kl=n),ml(0,t)},a}function pl(e,t,a){(a=mr(-1,a)).tag=3;var n=e.type.getDerivedStateFromError;if("function"==typeof n){var o=t.value;a.payload=function(){return ml(0,t),n(o)}}var r=e.stateNode;return null!==r&&"function"==typeof r.componentDidCatch&&(a.callback=function(){"function"!=typeof n&&(null===es?es=new Set([this]):es.add(this),ml(0,t));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),a}var bl="function"==typeof WeakSet?WeakSet:Set;function fl(e){var t=e.ref;if(null!==t)if("function"==typeof t)try{t(null)}catch(t){qs(e,t)}else t.current=null}function Cl(e,t){switch(t.tag){case 0:case 11:case 15:case 22:case 5:case 6:case 4:case 17:return;case 1:if(256&t.flags&&null!==e){var a=e.memoizedProps,n=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?a:Ko(t.type,a),n),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:return void(256&t.flags&&Qn(t.stateNode.containerInfo))}throw Error(l(163))}function yl(e,t,a){switch(a.tag){case 0:case 11:case 15:case 22:if(null!==(t=null!==(t=a.updateQueue)?t.lastEffect:null)){e=t=t.next;do{if(!(3&~e.tag)){var n=e.create;e.destroy=n()}e=e.next}while(e!==t)}if(null!==(t=null!==(t=a.updateQueue)?t.lastEffect:null)){e=t=t.next;do{var o=e;n=o.next,4&(o=o.tag)&&1&o&&($s(a,e),Bs(a,e)),e=n}while(e!==t)}return;case 1:return e=a.stateNode,4&a.flags&&(null===t?e.componentDidMount():(n=a.elementType===a.type?t.memoizedProps:Ko(a.type,t.memoizedProps),e.componentDidUpdate(n,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate))),void(null!==(t=a.updateQueue)&&br(a,t,e));case 3:if(null!==(t=a.updateQueue)){if(e=null,null!==a.child)switch(a.child.tag){case 5:case 1:e=a.child.stateNode}br(a,t,e)}return;case 5:return e=a.stateNode,void(null===t&&4&a.flags&&Gn(a.type,a.memoizedProps)&&e.focus());case 6:case 4:case 12:case 19:case 17:case 20:case 21:case 23:case 24:return;case 13:return void(null===a.memoizedState&&(a=a.alternate,null!==a&&(a=a.memoizedState,null!==a&&(a=a.dehydrated,null!==a&&St(a)))))}throw Error(l(163))}function vl(e,t){for(var a=e;;){if(5===a.tag){var n=a.stateNode;if(t)"function"==typeof(n=n.style).setProperty?n.setProperty("display","none","important"):n.display="none";else{n=a.stateNode;var o=a.memoizedProps.style;o=null!=o&&o.hasOwnProperty("display")?o.display:null,n.style.display=Te("display",o)}}else if(6===a.tag)a.stateNode.nodeValue=t?"":a.memoizedProps;else if((23!==a.tag&&24!==a.tag||null===a.memoizedState||a===e)&&null!==a.child){a.child.return=a,a=a.child;continue}if(a===e)break;for(;null===a.sibling;){if(null===a.return||a.return===e)return;a=a.return}a.sibling.return=a.return,a=a.sibling}}function xl(e,t){if(Io&&"function"==typeof Io.onCommitFiberUnmount)try{Io.onCommitFiberUnmount(Eo,t)}catch(e){}switch(t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var a=e=e.next;do{var n=a,o=n.destroy;if(n=n.tag,void 0!==o)if(4&n)$s(t,a);else{n=t;try{o()}catch(e){qs(n,e)}}a=a.next}while(a!==e)}break;case 1:if(fl(t),"function"==typeof(e=t.stateNode).componentWillUnmount)try{e.props=t.memoizedProps,e.state=t.memoizedState,e.componentWillUnmount()}catch(e){qs(t,e)}break;case 5:fl(t);break;case 4:Rl(e,t)}}function Tl(e){e.alternate=null,e.child=null,e.dependencies=null,e.firstEffect=null,e.lastEffect=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.return=null,e.updateQueue=null}function Sl(e){return 5===e.tag||3===e.tag||4===e.tag}function wl(e){e:{for(var t=e.return;null!==t;){if(Sl(t))break e;t=t.return}throw Error(l(160))}var a=t;switch(t=a.stateNode,a.tag){case 5:var n=!1;break;case 3:case 4:t=t.containerInfo,n=!0;break;default:throw Error(l(161))}16&a.flags&&(ye(t,""),a.flags&=-17);e:t:for(a=e;;){for(;null===a.sibling;){if(null===a.return||Sl(a.return)){a=null;break e}a=a.return}for(a.sibling.return=a.return,a=a.sibling;5!==a.tag&&6!==a.tag&&18!==a.tag;){if(2&a.flags)continue t;if(null===a.child||4===a.tag)continue t;a.child.return=a,a=a.child}if(!(2&a.flags)){a=a.stateNode;break e}}n?El(e,a,t):Il(e,a,t)}function El(e,t,a){var n=e.tag,o=5===n||6===n;if(o)e=o?e.stateNode:e.stateNode.instance,t?8===a.nodeType?a.parentNode.insertBefore(e,t):a.insertBefore(e,t):(8===a.nodeType?(t=a.parentNode).insertBefore(e,a):(t=a).appendChild(e),null!=(a=a._reactRootContainer)||null!==t.onclick||(t.onclick=Un));else if(4!==n&&null!==(e=e.child))for(El(e,t,a),e=e.sibling;null!==e;)El(e,t,a),e=e.sibling}function Il(e,t,a){var n=e.tag,o=5===n||6===n;if(o)e=o?e.stateNode:e.stateNode.instance,t?a.insertBefore(e,t):a.appendChild(e);else if(4!==n&&null!==(e=e.child))for(Il(e,t,a),e=e.sibling;null!==e;)Il(e,t,a),e=e.sibling}function Rl(e,t){for(var a,n,o=t,r=!1;;){if(!r){r=o.return;e:for(;;){if(null===r)throw Error(l(160));switch(a=r.stateNode,r.tag){case 5:n=!1;break e;case 3:case 4:a=a.containerInfo,n=!0;break e}r=r.return}r=!0}if(5===o.tag||6===o.tag){e:for(var i=e,s=o,c=s;;)if(xl(i,c),null!==c.child&&4!==c.tag)c.child.return=c,c=c.child;else{if(c===s)break e;for(;null===c.sibling;){if(null===c.return||c.return===s)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}n?(i=a,s=o.stateNode,8===i.nodeType?i.parentNode.removeChild(s):i.removeChild(s)):a.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){a=o.stateNode.containerInfo,n=!0,o.child.return=o,o=o.child;continue}}else if(xl(e,o),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(r=!1)}o.sibling.return=o.return,o=o.sibling}}function Al(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var n=a=a.next;do{!(3&~n.tag)&&(e=n.destroy,n.destroy=void 0,void 0!==e&&e()),n=n.next}while(n!==a)}return;case 1:case 12:case 17:return;case 5:if(null!=(a=t.stateNode)){n=t.memoizedProps;var o=null!==e?e.memoizedProps:n;e=t.type;var r=t.updateQueue;if(t.updateQueue=null,null!==r){for(a[eo]=n,"input"===e&&"radio"===n.type&&null!=n.name&&ae(a,n),Ie(e,o),t=Ie(e,n),o=0;o<r.length;o+=2){var i=r[o],s=r[o+1];"style"===i?Se(a,s):"dangerouslySetInnerHTML"===i?Ce(a,s):"children"===i?ye(a,s):x(a,i,s,t)}switch(e){case"input":ne(a,n);break;case"textarea":de(a,n);break;case"select":e=a._wrapperState.wasMultiple,a._wrapperState.wasMultiple=!!n.multiple,null!=(r=n.value)?le(a,!!n.multiple,r,!1):e!==!!n.multiple&&(null!=n.defaultValue?le(a,!!n.multiple,n.defaultValue,!0):le(a,!!n.multiple,n.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(l(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((a=t.stateNode).hydrate&&(a.hydrate=!1,St(a.containerInfo)));case 13:return null!==t.memoizedState&&(jl=Wo(),vl(t.child,!0)),void Ll(t);case 19:return void Ll(t);case 23:case 24:return void vl(t,null!==t.memoizedState)}throw Error(l(163))}function Ll(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var a=e.stateNode;null===a&&(a=e.stateNode=new bl),t.forEach((function(t){var n=Gs.bind(null,e,t);a.has(t)||(a.add(t),t.then(n,n))}))}}function kl(e,t){return null!==e&&(null===(e=e.memoizedState)||null!==e.dehydrated)&&(null!==(t=t.memoizedState)&&null===t.dehydrated)}var Fl=Math.ceil,_l=T.ReactCurrentDispatcher,Pl=T.ReactCurrentOwner,Nl=0,Ml=null,Ol=null,Dl=0,Bl=0,$l=uo(0),Hl=0,Ul=null,ql=0,Vl=0,Gl=0,Wl=0,zl=null,jl=0,Ql=1/0;function Jl(){Ql=Wo()+500}var Yl,Xl=null,Zl=!1,Kl=null,es=null,ts=!1,as=null,ns=90,os=[],rs=[],is=null,ls=0,ss=null,cs=-1,ds=0,us=0,ms=null,hs=!1;function gs(){return 48&Nl?Wo():-1!==cs?cs:cs=Wo()}function ps(e){if(!(2&(e=e.mode)))return 1;if(!(4&e))return 99===zo()?1:2;if(0===ds&&(ds=ql),0!==Zo.transition){0!==us&&(us=null!==zl?zl.pendingLanes:0),e=ds;var t=4186112&~us;return 0===(t&=-t)&&(0===(t=(e=4186112&~e)&-e)&&(t=8192)),t}return e=zo(),4&Nl&&98===e?e=Ut(12,ds):e=Ut(e=function(e){switch(e){case 99:return 15;case 98:return 10;case 97:case 96:return 8;case 95:return 2;default:return 0}}(e),ds),e}function bs(e,t,a){if(50<ls)throw ls=0,ss=null,Error(l(185));if(null===(e=fs(e,t)))return null;Gt(e,t,a),e===Ml&&(Gl|=t,4===Hl&&vs(e,Dl));var n=zo();1===t?8&Nl&&!(48&Nl)?xs(e):(Cs(e,a),0===Nl&&(Jl(),Yo())):(!(4&Nl)||98!==n&&99!==n||(null===is?is=new Set([e]):is.add(e)),Cs(e,a)),zl=e}function fs(e,t){e.lanes|=t;var a=e.alternate;for(null!==a&&(a.lanes|=t),a=e,e=e.return;null!==e;)e.childLanes|=t,null!==(a=e.alternate)&&(a.childLanes|=t),a=e,e=e.return;return 3===a.tag?a.stateNode:null}function Cs(e,t){for(var a=e.callbackNode,n=e.suspendedLanes,o=e.pingedLanes,r=e.expirationTimes,i=e.pendingLanes;0<i;){var s=31-Wt(i),c=1<<s,d=r[s];if(-1===d){if(0===(c&n)||0!==(c&o)){d=t,Bt(c);var u=Dt;r[s]=10<=u?d+250:6<=u?d+5e3:-1}}else d<=t&&(e.expiredLanes|=c);i&=~c}if(n=$t(e,e===Ml?Dl:0),t=Dt,0===n)null!==a&&(a!==$o&&Lo(a),e.callbackNode=null,e.callbackPriority=0);else{if(null!==a){if(e.callbackPriority===t)return;a!==$o&&Lo(a)}15===t?(a=xs.bind(null,e),null===Uo?(Uo=[a],qo=Ao(No,Xo)):Uo.push(a),a=$o):14===t?a=Jo(99,xs.bind(null,e)):(a=function(e){switch(e){case 15:case 14:return 99;case 13:case 12:case 11:case 10:return 98;case 9:case 8:case 7:case 6:case 4:case 5:return 97;case 3:case 2:case 1:return 95;case 0:return 90;default:throw Error(l(358,e))}}(t),a=Jo(a,ys.bind(null,e))),e.callbackPriority=t,e.callbackNode=a}}function ys(e){if(cs=-1,us=ds=0,48&Nl)throw Error(l(327));var t=e.callbackNode;if(Ds()&&e.callbackNode!==t)return null;var a=$t(e,e===Ml?Dl:0);if(0===a)return null;var n=a,o=Nl;Nl|=16;var r=As();for(Ml===e&&Dl===n||(Jl(),Is(e,n));;)try{Fs();break}catch(t){Rs(e,t)}if(or(),_l.current=r,Nl=o,null!==Ol?n=0:(Ml=null,Dl=0,n=Hl),0!==(ql&Gl))Is(e,0);else if(0!==n){if(2===n&&(Nl|=64,e.hydrate&&(e.hydrate=!1,Qn(e.containerInfo)),0!==(a=Ht(e))&&(n=Ls(e,a))),1===n)throw t=Ul,Is(e,0),vs(e,a),Cs(e,Wo()),t;switch(e.finishedWork=e.current.alternate,e.finishedLanes=a,n){case 0:case 1:throw Error(l(345));case 2:case 5:Ns(e);break;case 3:if(vs(e,a),(62914560&a)===a&&10<(n=jl+500-Wo())){if(0!==$t(e,0))break;if(((o=e.suspendedLanes)&a)!==a){gs(),e.pingedLanes|=e.suspendedLanes&o;break}e.timeoutHandle=zn(Ns.bind(null,e),n);break}Ns(e);break;case 4:if(vs(e,a),(4186112&a)===a)break;for(n=e.eventTimes,o=-1;0<a;){var i=31-Wt(a);r=1<<i,(i=n[i])>o&&(o=i),a&=~r}if(a=o,10<(a=(120>(a=Wo()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*Fl(a/1960))-a)){e.timeoutHandle=zn(Ns.bind(null,e),a);break}Ns(e);break;default:throw Error(l(329))}}return Cs(e,Wo()),e.callbackNode===t?ys.bind(null,e):null}function vs(e,t){for(t&=~Wl,t&=~Gl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var a=31-Wt(t),n=1<<a;e[a]=-1,t&=~n}}function xs(e){if(48&Nl)throw Error(l(327));if(Ds(),e===Ml&&0!==(e.expiredLanes&Dl)){var t=Dl,a=Ls(e,t);0!==(ql&Gl)&&(a=Ls(e,t=$t(e,t)))}else a=Ls(e,t=$t(e,0));if(0!==e.tag&&2===a&&(Nl|=64,e.hydrate&&(e.hydrate=!1,Qn(e.containerInfo)),0!==(t=Ht(e))&&(a=Ls(e,t))),1===a)throw a=Ul,Is(e,0),vs(e,t),Cs(e,Wo()),a;return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ns(e),Cs(e,Wo()),null}function Ts(e,t){var a=Nl;Nl|=1;try{return e(t)}finally{0===(Nl=a)&&(Jl(),Yo())}}function Ss(e,t){var a=Nl;Nl&=-2,Nl|=8;try{return e(t)}finally{0===(Nl=a)&&(Jl(),Yo())}}function ws(e,t){ho($l,Bl),Bl|=t,ql|=t}function Es(){Bl=$l.current,mo($l)}function Is(e,t){e.finishedWork=null,e.finishedLanes=0;var a=e.timeoutHandle;if(-1!==a&&(e.timeoutHandle=-1,jn(a)),null!==Ol)for(a=Ol.return;null!==a;){var n=a;switch(n.tag){case 1:null!=(n=n.type.childContextTypes)&&vo();break;case 3:Or(),mo(bo),mo(po),Xr();break;case 5:Br(n);break;case 4:Or();break;case 13:case 19:mo($r);break;case 10:rr(n);break;case 23:case 24:Es()}a=a.return}Ml=e,Ol=Qs(e.current,null),Dl=Bl=ql=t,Hl=0,Ul=null,Wl=Gl=Vl=0}function Rs(e,t){for(;;){var a=Ol;try{if(or(),Zr.current=Pi,oi){for(var n=ti.memoizedState;null!==n;){var o=n.queue;null!==o&&(o.pending=null),n=n.next}oi=!1}if(ei=0,ni=ai=ti=null,ri=!1,Pl.current=null,null===a||null===a.return){Hl=1,Ul=t,Ol=null;break}e:{var r=e,i=a.return,l=a,s=t;if(t=Dl,l.flags|=2048,l.firstEffect=l.lastEffect=null,null!==s&&"object"==typeof s&&"function"==typeof s.then){var c=s;if(!(2&l.mode)){var d=l.alternate;d?(l.updateQueue=d.updateQueue,l.memoizedState=d.memoizedState,l.lanes=d.lanes):(l.updateQueue=null,l.memoizedState=null)}var u=!!(1&$r.current),m=i;do{var h;if(h=13===m.tag){var g=m.memoizedState;if(null!==g)h=null!==g.dehydrated;else{var p=m.memoizedProps;h=void 0!==p.fallback&&(!0!==p.unstable_avoidThisFallback||!u)}}if(h){var b=m.updateQueue;if(null===b){var f=new Set;f.add(c),m.updateQueue=f}else b.add(c);if(!(2&m.mode)){if(m.flags|=64,l.flags|=16384,l.flags&=-2981,1===l.tag)if(null===l.alternate)l.tag=17;else{var C=mr(-1,1);C.tag=2,hr(l,C)}l.lanes|=1;break e}s=void 0,l=t;var y=r.pingCache;if(null===y?(y=r.pingCache=new hl,s=new Set,y.set(c,s)):void 0===(s=y.get(c))&&(s=new Set,y.set(c,s)),!s.has(l)){s.add(l);var v=Vs.bind(null,r,c,l);c.then(v,v)}m.flags|=4096,m.lanes=t;break e}m=m.return}while(null!==m);s=Error((Q(l.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display.")}5!==Hl&&(Hl=2),s=ul(s,l),m=i;do{switch(m.tag){case 3:r=s,m.flags|=4096,t&=-t,m.lanes|=t,gr(m,gl(0,r,t));break e;case 1:r=s;var x=m.type,T=m.stateNode;if(!(64&m.flags||"function"!=typeof x.getDerivedStateFromError&&(null===T||"function"!=typeof T.componentDidCatch||null!==es&&es.has(T)))){m.flags|=4096,t&=-t,m.lanes|=t,gr(m,pl(m,r,t));break e}}m=m.return}while(null!==m)}Ps(a)}catch(e){t=e,Ol===a&&null!==a&&(Ol=a=a.return);continue}break}}function As(){var e=_l.current;return _l.current=Pi,null===e?Pi:e}function Ls(e,t){var a=Nl;Nl|=16;var n=As();for(Ml===e&&Dl===t||Is(e,t);;)try{ks();break}catch(t){Rs(e,t)}if(or(),Nl=a,_l.current=n,null!==Ol)throw Error(l(261));return Ml=null,Dl=0,Hl}function ks(){for(;null!==Ol;)_s(Ol)}function Fs(){for(;null!==Ol&&!ko();)_s(Ol)}function _s(e){var t=Yl(e.alternate,e,Bl);e.memoizedProps=e.pendingProps,null===t?Ps(e):Ol=t,Pl.current=null}function Ps(e){var t=e;do{var a=t.alternate;if(e=t.return,2048&t.flags){if(null!==(a=dl(t)))return a.flags&=2047,void(Ol=a);null!==e&&(e.firstEffect=e.lastEffect=null,e.flags|=2048)}else{if(null!==(a=cl(a,t,Bl)))return void(Ol=a);if(24!==(a=t).tag&&23!==a.tag||null===a.memoizedState||1073741824&Bl||!(4&a.mode)){for(var n=0,o=a.child;null!==o;)n|=o.lanes|o.childLanes,o=o.sibling;a.childLanes=n}null!==e&&!(2048&e.flags)&&(null===e.firstEffect&&(e.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=t.firstEffect),e.lastEffect=t.lastEffect),1<t.flags&&(null!==e.lastEffect?e.lastEffect.nextEffect=t:e.firstEffect=t,e.lastEffect=t))}if(null!==(t=t.sibling))return void(Ol=t);Ol=t=e}while(null!==t);0===Hl&&(Hl=5)}function Ns(e){var t=zo();return Qo(99,Ms.bind(null,e,t)),null}function Ms(e,t){do{Ds()}while(null!==as);if(48&Nl)throw Error(l(327));var a=e.finishedWork;if(null===a)return null;if(e.finishedWork=null,e.finishedLanes=0,a===e.current)throw Error(l(177));e.callbackNode=null;var n=a.lanes|a.childLanes,o=n,r=e.pendingLanes&~o;e.pendingLanes=o,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=o,e.mutableReadLanes&=o,e.entangledLanes&=o,o=e.entanglements;for(var i=e.eventTimes,s=e.expirationTimes;0<r;){var c=31-Wt(r),d=1<<c;o[c]=0,i[c]=-1,s[c]=-1,r&=~d}if(null!==is&&!(24&n)&&is.has(e)&&is.delete(e),e===Ml&&(Ol=Ml=null,Dl=0),1<a.flags?null!==a.lastEffect?(a.lastEffect.nextEffect=a,n=a.firstEffect):n=a:n=a.firstEffect,null!==n){if(o=Nl,Nl|=32,Pl.current=null,qn=Yt,Cn(i=fn())){if("selectionStart"in i)s={start:i.selectionStart,end:i.selectionEnd};else e:if(s=(s=i.ownerDocument)&&s.defaultView||window,(d=s.getSelection&&s.getSelection())&&0!==d.rangeCount){s=d.anchorNode,r=d.anchorOffset,c=d.focusNode,d=d.focusOffset;try{s.nodeType,c.nodeType}catch(e){s=null;break e}var u=0,m=-1,h=-1,g=0,p=0,b=i,f=null;t:for(;;){for(var C;b!==s||0!==r&&3!==b.nodeType||(m=u+r),b!==c||0!==d&&3!==b.nodeType||(h=u+d),3===b.nodeType&&(u+=b.nodeValue.length),null!==(C=b.firstChild);)f=b,b=C;for(;;){if(b===i)break t;if(f===s&&++g===r&&(m=u),f===c&&++p===d&&(h=u),null!==(C=b.nextSibling))break;f=(b=f).parentNode}b=C}s=-1===m||-1===h?null:{start:m,end:h}}else s=null;s=s||{start:0,end:0}}else s=null;Vn={focusedElem:i,selectionRange:s},Yt=!1,ms=null,hs=!1,Xl=n;do{try{Os()}catch(e){if(null===Xl)throw Error(l(330));qs(Xl,e),Xl=Xl.nextEffect}}while(null!==Xl);ms=null,Xl=n;do{try{for(i=e;null!==Xl;){var y=Xl.flags;if(16&y&&ye(Xl.stateNode,""),128&y){var v=Xl.alternate;if(null!==v){var x=v.ref;null!==x&&("function"==typeof x?x(null):x.current=null)}}switch(1038&y){case 2:wl(Xl),Xl.flags&=-3;break;case 6:wl(Xl),Xl.flags&=-3,Al(Xl.alternate,Xl);break;case 1024:Xl.flags&=-1025;break;case 1028:Xl.flags&=-1025,Al(Xl.alternate,Xl);break;case 4:Al(Xl.alternate,Xl);break;case 8:Rl(i,s=Xl);var T=s.alternate;Tl(s),null!==T&&Tl(T)}Xl=Xl.nextEffect}}catch(e){if(null===Xl)throw Error(l(330));qs(Xl,e),Xl=Xl.nextEffect}}while(null!==Xl);if(x=Vn,v=fn(),y=x.focusedElem,i=x.selectionRange,v!==y&&y&&y.ownerDocument&&bn(y.ownerDocument.documentElement,y)){null!==i&&Cn(y)&&(v=i.start,void 0===(x=i.end)&&(x=v),"selectionStart"in y?(y.selectionStart=v,y.selectionEnd=Math.min(x,y.value.length)):(x=(v=y.ownerDocument||document)&&v.defaultView||window).getSelection&&(x=x.getSelection(),s=y.textContent.length,T=Math.min(i.start,s),i=void 0===i.end?T:Math.min(i.end,s),!x.extend&&T>i&&(s=i,i=T,T=s),s=pn(y,T),r=pn(y,i),s&&r&&(1!==x.rangeCount||x.anchorNode!==s.node||x.anchorOffset!==s.offset||x.focusNode!==r.node||x.focusOffset!==r.offset)&&((v=v.createRange()).setStart(s.node,s.offset),x.removeAllRanges(),T>i?(x.addRange(v),x.extend(r.node,r.offset)):(v.setEnd(r.node,r.offset),x.addRange(v))))),v=[];for(x=y;x=x.parentNode;)1===x.nodeType&&v.push({element:x,left:x.scrollLeft,top:x.scrollTop});for("function"==typeof y.focus&&y.focus(),y=0;y<v.length;y++)(x=v[y]).element.scrollLeft=x.left,x.element.scrollTop=x.top}Yt=!!qn,Vn=qn=null,e.current=a,Xl=n;do{try{for(y=e;null!==Xl;){var S=Xl.flags;if(36&S&&yl(y,Xl.alternate,Xl),128&S){v=void 0;var w=Xl.ref;if(null!==w){var E=Xl.stateNode;Xl.tag,v=E,"function"==typeof w?w(v):w.current=v}}Xl=Xl.nextEffect}}catch(e){if(null===Xl)throw Error(l(330));qs(Xl,e),Xl=Xl.nextEffect}}while(null!==Xl);Xl=null,Ho(),Nl=o}else e.current=a;if(ts)ts=!1,as=e,ns=t;else for(Xl=n;null!==Xl;)t=Xl.nextEffect,Xl.nextEffect=null,8&Xl.flags&&((S=Xl).sibling=null,S.stateNode=null),Xl=t;if(0===(n=e.pendingLanes)&&(es=null),1===n?e===ss?ls++:(ls=0,ss=e):ls=0,a=a.stateNode,Io&&"function"==typeof Io.onCommitFiberRoot)try{Io.onCommitFiberRoot(Eo,a,void 0,!(64&~a.current.flags))}catch(e){}if(Cs(e,Wo()),Zl)throw Zl=!1,e=Kl,Kl=null,e;return 8&Nl||Yo(),null}function Os(){for(;null!==Xl;){var e=Xl.alternate;hs||null===ms||(8&Xl.flags?tt(Xl,ms)&&(hs=!0):13===Xl.tag&&kl(e,Xl)&&tt(Xl,ms)&&(hs=!0));var t=Xl.flags;256&t&&Cl(e,Xl),!(512&t)||ts||(ts=!0,Jo(97,(function(){return Ds(),null}))),Xl=Xl.nextEffect}}function Ds(){if(90!==ns){var e=97<ns?97:ns;return ns=90,Qo(e,Hs)}return!1}function Bs(e,t){os.push(t,e),ts||(ts=!0,Jo(97,(function(){return Ds(),null})))}function $s(e,t){rs.push(t,e),ts||(ts=!0,Jo(97,(function(){return Ds(),null})))}function Hs(){if(null===as)return!1;var e=as;if(as=null,48&Nl)throw Error(l(331));var t=Nl;Nl|=32;var a=rs;rs=[];for(var n=0;n<a.length;n+=2){var o=a[n],r=a[n+1],i=o.destroy;if(o.destroy=void 0,"function"==typeof i)try{i()}catch(e){if(null===r)throw Error(l(330));qs(r,e)}}for(a=os,os=[],n=0;n<a.length;n+=2){o=a[n],r=a[n+1];try{var s=o.create;o.destroy=s()}catch(e){if(null===r)throw Error(l(330));qs(r,e)}}for(s=e.current.firstEffect;null!==s;)e=s.nextEffect,s.nextEffect=null,8&s.flags&&(s.sibling=null,s.stateNode=null),s=e;return Nl=t,Yo(),!0}function Us(e,t,a){hr(e,t=gl(0,t=ul(a,t),1)),t=gs(),null!==(e=fs(e,1))&&(Gt(e,1,t),Cs(e,t))}function qs(e,t){if(3===e.tag)Us(e,e,t);else for(var a=e.return;null!==a;){if(3===a.tag){Us(a,e,t);break}if(1===a.tag){var n=a.stateNode;if("function"==typeof a.type.getDerivedStateFromError||"function"==typeof n.componentDidCatch&&(null===es||!es.has(n))){var o=pl(a,e=ul(t,e),1);if(hr(a,o),o=gs(),null!==(a=fs(a,1)))Gt(a,1,o),Cs(a,o);else if("function"==typeof n.componentDidCatch&&(null===es||!es.has(n)))try{n.componentDidCatch(t,e)}catch(e){}break}}a=a.return}}function Vs(e,t,a){var n=e.pingCache;null!==n&&n.delete(t),t=gs(),e.pingedLanes|=e.suspendedLanes&a,Ml===e&&(Dl&a)===a&&(4===Hl||3===Hl&&(62914560&Dl)===Dl&&500>Wo()-jl?Is(e,0):Wl|=a),Cs(e,t)}function Gs(e,t){var a=e.stateNode;null!==a&&a.delete(t),0===(t=0)&&(2&(t=e.mode)?4&t?(0===ds&&(ds=ql),0===(t=qt(62914560&~ds))&&(t=4194304)):t=99===zo()?1:2:t=1),a=gs(),null!==(e=fs(e,t))&&(Gt(e,t,a),Cs(e,a))}function Ws(e,t,a,n){this.tag=e,this.key=a,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.flags=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childLanes=this.lanes=0,this.alternate=null}function zs(e,t,a,n){return new Ws(e,t,a,n)}function js(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Qs(e,t){var a=e.alternate;return null===a?((a=zs(e.tag,t,e.key,e.mode)).elementType=e.elementType,a.type=e.type,a.stateNode=e.stateNode,a.alternate=e,e.alternate=a):(a.pendingProps=t,a.type=e.type,a.flags=0,a.nextEffect=null,a.firstEffect=null,a.lastEffect=null),a.childLanes=e.childLanes,a.lanes=e.lanes,a.child=e.child,a.memoizedProps=e.memoizedProps,a.memoizedState=e.memoizedState,a.updateQueue=e.updateQueue,t=e.dependencies,a.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},a.sibling=e.sibling,a.index=e.index,a.ref=e.ref,a}function Js(e,t,a,n,o,r){var i=2;if(n=e,"function"==typeof e)js(e)&&(i=1);else if("string"==typeof e)i=5;else e:switch(e){case E:return Ys(a.children,o,r,t);case D:i=8,o|=16;break;case I:i=8,o|=1;break;case R:return(e=zs(12,a,t,8|o)).elementType=R,e.type=R,e.lanes=r,e;case F:return(e=zs(13,a,t,o)).type=F,e.elementType=F,e.lanes=r,e;case _:return(e=zs(19,a,t,o)).elementType=_,e.lanes=r,e;case B:return Xs(a,o,r,t);case $:return(e=zs(24,a,t,o)).elementType=$,e.lanes=r,e;default:if("object"==typeof e&&null!==e)switch(e.$$typeof){case A:i=10;break e;case L:i=9;break e;case k:i=11;break e;case P:i=14;break e;case N:i=16,n=null;break e;case M:i=22;break e}throw Error(l(130,null==e?e:typeof e,""))}return(t=zs(i,a,t,o)).elementType=e,t.type=n,t.lanes=r,t}function Ys(e,t,a,n){return(e=zs(7,e,n,t)).lanes=a,e}function Xs(e,t,a,n){return(e=zs(23,e,n,t)).elementType=B,e.lanes=a,e}function Zs(e,t,a){return(e=zs(6,e,null,t)).lanes=a,e}function Ks(e,t,a){return(t=zs(4,null!==e.children?e.children:[],e.key,t)).lanes=a,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function ec(e,t,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=a,this.callbackNode=null,this.callbackPriority=0,this.eventTimes=Vt(0),this.expirationTimes=Vt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Vt(0),this.mutableSourceEagerHydrationData=null}function tc(e,t,a,n){var o=t.current,r=gs(),i=ps(o);e:if(a){t:{if(Xe(a=a._reactInternals)!==a||1!==a.tag)throw Error(l(170));var s=a;do{switch(s.tag){case 3:s=s.stateNode.context;break t;case 1:if(yo(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break t}}s=s.return}while(null!==s);throw Error(l(171))}if(1===a.tag){var c=a.type;if(yo(c)){a=To(a,c,s);break e}}a=s}else a=go;return null===t.context?t.context=a:t.pendingContext=a,(t=mr(r,i)).payload={element:e},null!==(n=void 0===n?null:n)&&(t.callback=n),hr(o,t),bs(o,i,r),i}function ac(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function nc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var a=e.retryLane;e.retryLane=0!==a&&a<t?a:t}}function oc(e,t){nc(e,t),(e=e.alternate)&&nc(e,t)}function rc(e,t,a){var n=null!=a&&null!=a.hydrationOptions&&a.hydrationOptions.mutableSources||null;if(a=new ec(e,t,null!=a&&!0===a.hydrate),t=zs(3,null,null,2===t?7:1===t?3:0),a.current=t,t.stateNode=a,dr(t),e[to]=a.current,Pn(8===e.nodeType?e.parentNode:e),n)for(e=0;e<n.length;e++){var o=(t=n[e])._getVersion;o=o(t._source),null==a.mutableSourceEagerHydrationData?a.mutableSourceEagerHydrationData=[t,o]:a.mutableSourceEagerHydrationData.push(t,o)}this._internalRoot=a}function ic(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function lc(e,t,a,n,o){var r=a._reactRootContainer;if(r){var i=r._internalRoot;if("function"==typeof o){var l=o;o=function(){var e=ac(i);l.call(e)}}tc(t,i,e,o)}else{if(r=a._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var a;a=e.lastChild;)e.removeChild(a);return new rc(e,0,t?{hydrate:!0}:void 0)}(a,n),i=r._internalRoot,"function"==typeof o){var s=o;o=function(){var e=ac(i);s.call(e)}}Ss((function(){tc(t,i,e,o)}))}return ac(i)}function sc(e,t){var a=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!ic(t))throw Error(l(200));return function(e,t,a){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==n?null:""+n,children:e,containerInfo:t,implementation:a}}(e,t,null,a)}Yl=function(e,t,a){var n=t.lanes;if(null!==e)if(e.memoizedProps!==t.pendingProps||bo.current)Bi=!0;else{if(0===(a&n)){switch(Bi=!1,t.tag){case 3:Qi(t),Jr();break;case 5:Dr(t);break;case 1:yo(t.type)&&So(t);break;case 4:Mr(t,t.stateNode.containerInfo);break;case 10:n=t.memoizedProps.value;var o=t.type._context;ho(er,o._currentValue),o._currentValue=n;break;case 13:if(null!==t.memoizedState)return 0!==(a&t.child.childLanes)?el(e,t,a):(ho($r,1&$r.current),null!==(t=ll(e,t,a))?t.sibling:null);ho($r,1&$r.current);break;case 19:if(n=0!==(a&t.childLanes),64&e.flags){if(n)return il(e,t,a);t.flags|=64}if(null!==(o=t.memoizedState)&&(o.rendering=null,o.tail=null,o.lastEffect=null),ho($r,$r.current),n)break;return null;case 23:case 24:return t.lanes=0,Vi(e,t,a)}return ll(e,t,a)}Bi=!!(16384&e.flags)}else Bi=!1;switch(t.lanes=0,t.tag){case 2:if(n=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=Co(t,po.current),lr(t,a),o=si(null,t,n,e,o,a),t.flags|=1,"object"==typeof o&&null!==o&&"function"==typeof o.render&&void 0===o.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,yo(n)){var r=!0;So(t)}else r=!1;t.memoizedState=null!==o.state&&void 0!==o.state?o.state:null,dr(t);var i=n.getDerivedStateFromProps;"function"==typeof i&&Cr(t,n,i,e),o.updater=yr,t.stateNode=o,o._reactInternals=t,Sr(t,n,e,a),t=ji(null,t,n,!0,r,a)}else t.tag=0,$i(null,t,o,a),t=t.child;return t;case 16:o=t.elementType;e:{switch(null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),e=t.pendingProps,o=(r=o._init)(o._payload),t.type=o,r=t.tag=function(e){if("function"==typeof e)return js(e)?1:0;if(null!=e){if((e=e.$$typeof)===k)return 11;if(e===P)return 14}return 2}(o),e=Ko(o,e),r){case 0:t=Wi(null,t,o,e,a);break e;case 1:t=zi(null,t,o,e,a);break e;case 11:t=Hi(null,t,o,e,a);break e;case 14:t=Ui(null,t,o,Ko(o.type,e),n,a);break e}throw Error(l(306,o,""))}return t;case 0:return n=t.type,o=t.pendingProps,Wi(e,t,n,o=t.elementType===n?o:Ko(n,o),a);case 1:return n=t.type,o=t.pendingProps,zi(e,t,n,o=t.elementType===n?o:Ko(n,o),a);case 3:if(Qi(t),n=t.updateQueue,null===e||null===n)throw Error(l(282));if(n=t.pendingProps,o=null!==(o=t.memoizedState)?o.element:null,ur(e,t),pr(t,n,null,a),(n=t.memoizedState.element)===o)Jr(),t=ll(e,t,a);else{if((r=(o=t.stateNode).hydrate)&&(qr=Jn(t.stateNode.containerInfo.firstChild),Ur=t,r=Vr=!0),r){if(null!=(e=o.mutableSourceEagerHydrationData))for(o=0;o<e.length;o+=2)(r=e[o])._workInProgressVersionPrimary=e[o+1],Yr.push(r);for(a=Lr(t,null,n,a),t.child=a;a;)a.flags=-3&a.flags|1024,a=a.sibling}else $i(e,t,n,a),Jr();t=t.child}return t;case 5:return Dr(t),null===e&&zr(t),n=t.type,o=t.pendingProps,r=null!==e?e.memoizedProps:null,i=o.children,Wn(n,o)?i=null:null!==r&&Wn(n,r)&&(t.flags|=16),Gi(e,t),$i(e,t,i,a),t.child;case 6:return null===e&&zr(t),null;case 13:return el(e,t,a);case 4:return Mr(t,t.stateNode.containerInfo),n=t.pendingProps,null===e?t.child=Ar(t,null,n,a):$i(e,t,n,a),t.child;case 11:return n=t.type,o=t.pendingProps,Hi(e,t,n,o=t.elementType===n?o:Ko(n,o),a);case 7:return $i(e,t,t.pendingProps,a),t.child;case 8:case 12:return $i(e,t,t.pendingProps.children,a),t.child;case 10:e:{n=t.type._context,o=t.pendingProps,i=t.memoizedProps,r=o.value;var s=t.type._context;if(ho(er,s._currentValue),s._currentValue=r,null!==i)if(s=i.value,0===(r=un(s,r)?0:0|("function"==typeof n._calculateChangedBits?n._calculateChangedBits(s,r):1073741823))){if(i.children===o.children&&!bo.current){t=ll(e,t,a);break e}}else for(null!==(s=t.child)&&(s.return=t);null!==s;){var c=s.dependencies;if(null!==c){i=s.child;for(var d=c.firstContext;null!==d;){if(d.context===n&&0!==(d.observedBits&r)){1===s.tag&&((d=mr(-1,a&-a)).tag=2,hr(s,d)),s.lanes|=a,null!==(d=s.alternate)&&(d.lanes|=a),ir(s.return,a),c.lanes|=a;break}d=d.next}}else i=10===s.tag&&s.type===t.type?null:s.child;if(null!==i)i.return=s;else for(i=s;null!==i;){if(i===t){i=null;break}if(null!==(s=i.sibling)){s.return=i.return,i=s;break}i=i.return}s=i}$i(e,t,o.children,a),t=t.child}return t;case 9:return o=t.type,n=(r=t.pendingProps).children,lr(t,a),n=n(o=sr(o,r.unstable_observedBits)),t.flags|=1,$i(e,t,n,a),t.child;case 14:return r=Ko(o=t.type,t.pendingProps),Ui(e,t,o,r=Ko(o.type,r),n,a);case 15:return qi(e,t,t.type,t.pendingProps,n,a);case 17:return n=t.type,o=t.pendingProps,o=t.elementType===n?o:Ko(n,o),null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2),t.tag=1,yo(n)?(e=!0,So(t)):e=!1,lr(t,a),xr(t,n,o),Sr(t,n,o,a),ji(null,t,n,!0,e,a);case 19:return il(e,t,a);case 23:case 24:return Vi(e,t,a)}throw Error(l(156,t.tag))},rc.prototype.render=function(e){tc(e,this._internalRoot,null,null)},rc.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;tc(null,e,null,(function(){t[to]=null}))},at=function(e){13===e.tag&&(bs(e,4,gs()),oc(e,4))},nt=function(e){13===e.tag&&(bs(e,67108864,gs()),oc(e,67108864))},ot=function(e){if(13===e.tag){var t=gs(),a=ps(e);bs(e,a,t),oc(e,a)}},rt=function(e,t){return t()},Ae=function(e,t,a){switch(t){case"input":if(ne(e,a),t=a.name,"radio"===a.type&&null!=t){for(a=e;a.parentNode;)a=a.parentNode;for(a=a.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<a.length;t++){var n=a[t];if(n!==e&&n.form===e.form){var o=io(n);if(!o)throw Error(l(90));Z(n),ne(n,o)}}}break;case"textarea":de(e,a);break;case"select":null!=(t=a.value)&&le(e,!!a.multiple,t,!1)}},Ne=Ts,Me=function(e,t,a,n,o){var r=Nl;Nl|=4;try{return Qo(98,e.bind(null,t,a,n,o))}finally{0===(Nl=r)&&(Jl(),Yo())}},Oe=function(){!(49&Nl)&&(function(){if(null!==is){var e=is;is=null,e.forEach((function(e){e.expiredLanes|=24&e.pendingLanes,Cs(e,Wo())}))}Yo()}(),Ds())},De=function(e,t){var a=Nl;Nl|=2;try{return e(t)}finally{0===(Nl=a)&&(Jl(),Yo())}};var cc={Events:[oo,ro,io,_e,Pe,Ds,{current:!1}]},dc={findFiberByHostInstance:no,bundleType:0,version:"17.0.2",rendererPackageName:"react-dom"},uc={bundleType:dc.bundleType,version:dc.version,rendererPackageName:dc.rendererPackageName,rendererConfig:dc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:T.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=et(e))?null:e.stateNode},findFiberByHostInstance:dc.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null};if("undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mc.isDisabled&&mc.supportsFiber)try{Eo=mc.inject(uc),Io=mc}catch(fe){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cc,t.createPortal=sc,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"==typeof e.render)throw Error(l(188));throw Error(l(268,Object.keys(e)))}return e=null===(e=et(t))?null:e.stateNode},t.flushSync=function(e,t){var a=Nl;if(48&a)return e(t);Nl|=1;try{if(e)return Qo(99,e.bind(null,t))}finally{Nl=a,Yo()}},t.hydrate=function(e,t,a){if(!ic(t))throw Error(l(200));return lc(null,e,t,!0,a)},t.render=function(e,t,a){if(!ic(t))throw Error(l(200));return lc(null,e,t,!1,a)},t.unmountComponentAtNode=function(e){if(!ic(e))throw Error(l(40));return!!e._reactRootContainer&&(Ss((function(){lc(null,null,e,!1,(function(){e._reactRootContainer=null,e[to]=null}))})),!0)},t.unstable_batchedUpdates=Ts,t.unstable_createPortal=function(e,t){return sc(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,a,n){if(!ic(a))throw Error(l(200));if(null==e||void 0===e._reactInternals)throw Error(l(38));return lc(e,t,a,!1,n)},t.version="17.0.2"},181704:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});const n=/([\s\S]*)\$\{(.*)\}([\s\S]*)/;const o=function e(t,a,o){const r=n.exec(t);if(!r)return t;const[i,l,s,c]=r,d=a[s];if(void 0===d)throw new Error(`Could not find a substitution for the placeholder "${s}" within "${t}" with substitutions \`${JSON.stringify(a)}\``);return e(l,a,o)+(o?"<b>":"")+d+(o?"</b>":"")+e(c,a,o)}},185610:(e,t,a)=>{"use strict";a.d(t,{f:()=>w,y:()=>v});var n=a(83437),o=a(329739),r=a(660606),i=a(217425),l=a(632197),s=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},c=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},d=a(267324),u=a(632512),m=a(936997),h=a(173491),g=a(965634),p=a(956258),b=a(79458),f=a(528804),C=a(371616),y=a(479504);async function v(){let e=d.u1i;try{e=await OfficeFirstParty.UserFeedback.GetInitializationData()}catch(e){p.M.getInstance().logErrorCode(u.O.FeedbackApiError,e,g.S2.Error,n.$b.Warning),(0,b.cY)("Error in OfficeFirstParty UserFeedback GetInitializationData ",e)}return e}async function x(){let e={};try{e=await OfficeFirstParty.UserFeedback.GetHostScreenshot()}catch(e){p.M.getInstance().logErrorCode(u.O.FeedbackApiError,e,g.S2.Error,n.$b.Warning),(0,b.cY)("Error in OfficeFirstParty UserFeedback GetHostScreenshot ",e)}return e}async function T(e,t){if(e===m.$G.TenantFeedback)try{const e=new o.j({userPrincipalName:t,redirectUri:new URL(h.dS).pathname}),n=await(a=e,d="https://substrate.office.com/tenantfeedback",s(void 0,void 0,void 0,(function(){var e,t;return c(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,a.getToken(null!=d?d:i.w8.substrate)];case 1:return e=n.sent(),[2,(0,l.t)(e)];case 2:throw t=n.sent(),(0,r.cY)("Error fetching Substrate token:",t),t;case 3:return[2]}}))})));return{token:`Bearer ${n.accessToken}`}}catch(e){throw p.M.getInstance().logErrorCode(u.O.FeedbackGetUserAccessTokenError,e,g.S2.Error,n.$b.Warning),(0,b.cY)("Error in OfficeFirstParty UserFeedback GetUserAccessToken ",e),e}var a,d;(0,b.cY)(`Invalid audience to fetch user access token: ${e}`)}const S=(e,t)=>{try{OfficeFirstParty.UserFeedback.InvokeDiagnosticsLogsUpload(e)}catch(e){p.M.getInstance().logErrorCode(u.O.FeedbackApiError,e,g.S2.Error,n.$b.Warning),(0,b.cY)("Error in OfficeFirstParty UserFeedback InvokeDiagnosticsLogsUpload ",e)}},w=()=>{const e=(0,C.Ul)();if(e)try{let t,a=JSON.parse(e);return a&&(a={...a,callbackFunctions:{...a.callbackFunctions,provideDynamicScreenshot:x,getUserAccessToken:T},feedbackConfig:{...a.feedbackConfig,diagnosticsConfig:{...a.feedbackConfig.diagnosticsConfig,attachDiagnostics:S},isScreenshotEnabled:!0,isEmailCollectionEnabled:!0},telemetry:{...a.telemetry,uiHost:"Excel",platform:(0,y.mw)()}}),t=(0,f.yw9)("OfficeVSO_9249582_IsFeedbackAppChatThemingEnabled")?{feedbackInitOptions:a,lightTheme:{baseTheme:"ExcelLightTheme"},darkTheme:{baseTheme:"ExcelDarkTheme"}}:{feedbackInitOptions:a},t}catch(e){return p.M.getInstance().logErrorCode(u.O.FeedbackApiError,e,g.S2.Error,n.$b.Warning),void(0,b.cY)("Error in parsing feedbackInitializationData to JSON ",e)}}},186998:(e,t,a)=>{"use strict";a.d(t,{b7:()=>S,ge:()=>w,iT:()=>I});var n=a(479592),o=a(700853),r=a(322466),i=a(63919),l=a(365319),s=a(965634),c=a(449650),d=a(267324),u=a(9847),m=a(83437),h=a(956258),g=a(797639),p=a(644737),b=a(299512),f=a(14086),C=a(703227),y=a(528804),v=a(507628),x=a(79458);const T=1e3;function S(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:(0,d.FA0)()}}}},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.HumanInput}}}async function w(e,t){const a=(0,b.kw)(t),n=(await Promise.all(a.map((async e=>await(0,b.xl)(e))))).filter((e=>!!e.header&&!!e.description));0===n.length&&h.M.getInstance().logError({eventType:s.S2.AutoFixTLR,errorMessage:"Missing data for AutoFixMarkdownResponse",logLevel:m.$b.Warning},void 0,[{key:s.Wg.Source,value:JSON.stringify(a)}]);return function(e,t,a,n,l){const s=(0,v.A)(),d=e.map((e=>`- **${e.header}**: ${e.description}`)).join("\n");let u=l;return u&&c.ExcelCalc.isSheetAddress(l)||(u=g.CP.getActiveTable()?.address||u),g.CP.setHumanInTheLoopRange((0,f.r)(u)),{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{message:`${t}\n\n${d}\n\n${a}`,user:i.Q9.Chat}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:s,actionButtonList:(0,p.Oy)([(0,p.J3)(n,u)],s)},addCardToChatHistory:!0}}(n,(1===n.length?(0,d.$TB)():(0,d.S7l)()).replace("{range}",(0,C.G2)(e)),(0,d.VH3)(),t,e)}function E(e,t){const a=(0,b.kw)(e);switch(t){case n.Xs.Success:return function(e){const t=(0,v.A)();return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,p.Oy)([(0,p.FW)(u.q.ContextInference)],t)},addCardToChatHistory:!0},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.ActionConfirmationMessage}}}((0,b.TF)(a));case n.Xs.Unsuccessful:return function(e){const t=(0,v.A)();return{message:{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:i.Q9.Chat,message:e}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,y.jHv)()?[(0,p.yo)(t)]:void 0},addCardToChatHistory:!0},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.TabularRangeAutoFixFailed,errorType:u.q0.TlrAutofixError}}}((0,b.ie)(a));case n.Xs.NoChangeMade:default:return function(){const e=(0,v.A)();return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,d.GRk)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:e,actionButtonList:(0,y.jHv)()?[(0,p.yo)(e)]:void 0},addCardToChatHistory:!0},telemetry:{featureName:u.q.ContextInference,eventType:u.a5.TabularRangeNoAutoFixApplied}}}()}}async function I(e,t){await g.CP.runWithContextRefreshAndLoader((async()=>{const a=performance.now(),o=await(0,n.Be)(t),r=performance.now()-a,i=T-r;i>0&&await(0,x.uk)(i);const{message:s,telemetry:c}=E(e,o);l.$.getInstance().displayResponse(s,c),g.CP.setHumanInTheLoopRange(void 0)}),u.OP.ApplyTLRAutoFix)}},198784:(e,t,a)=>{"use strict";a.d(t,{J:()=>o});var n=a(79458);function o(e,t=void 0){try{let a="";if(!document?.referrer)return void(0,n.cY)("SendMessageToHost failed. document object is null!");a=document.referrer;const o={Origin:"OfficeCopilotExcelTaskPane",Event:e,Payload:t};window.parent.postMessage(o,a)}catch(t){(0,n.cY)("SendMessageToHost failed with exception: ",t," for event: ",e)}}},200828:(e,t,a)=>{"use strict";a.d(t,{e:()=>m,n:()=>u});var n=a(255448),o=a(9847),r=a(47262),i=a(797639),l=a(528804),s=a(48093),c=a(910480);const d=["Commanding_TellMe","MorePrompts","GiveMeMorePrompts","SydneySuggestion","ImportDataFromFile","Tlr_ExplainHeaders","Tlr_ExplainTables","Tlr_ExplainUnmergingCells","Python_Suggestion_FromSkittle"];function u(e,t=!1,a=()=>{},o,r){const u=r?.tableLikeRangeFeatures&&r.tableLikeRangeFeatures&n.ye.All,m=(0,l.tgf)()&&u;if(o||m){if(!i.CP.pythonContextManager.isPythonMode)if("CHART_SELECTED"===o||"PIVOT_TABLE_SELECTED"===o)e=[],t=!1;else{if("BLANK_WORKSHEET"===o&&(0,l.vIj)()){e.every((e=>"SydneySuggestion"===e.suggestionType))&&(t=!1)}e=e.filter((e=>d.includes(e.suggestionType)))}}else if(!u&&(0,l.yw9)("OfficeVSO_9413795_updateUnsupportedTLRSuggestionPills")){const t=["Tlr_ExplainHeaders","Tlr_ExplainTables","Tlr_ExplainUnmergingCells"];e=e.filter((e=>!t.includes(e.suggestionType)))}const h={onRefreshButtonClicked:a,suggestionList:e.map((e=>e.suggestionText)),showRefreshButton:t};return(0,c.isEqual)(h.suggestionList,(0,s.jc)().suggestionList)&&h.showRefreshButton===(0,s.jc)().showRefreshButton?(0,s.jc)():((0,s.j0)(h),h)}function m(e){switch(e){case"AnalyzeData_InsertAll":case"AnalyzeData_InsertAllCharts":case"AnalyzeData_ShowMore":case"AnalyzeData_SpecificSuggestion":case"AnalyzeData_Suggestion":case"AnalyzeData_ShowCharts":case"AnalyzeData_ShowMoreCharts":case"AnalyzeData_ShowPivotTables":case"AnalyzeData_ShowMorePivotTables":case"AnalyzeData_RelatedQuestions":return o.q.AnalyzeData;case"CalculatedColumns_GeneralSuggestion":case"CalculatedColumns_ShowMore":case"CalculatedColumns_SpecificSuggestion":return o.q.CalculatedColumns;case"CalculatedCell_Suggestion":return o.q.CalculatedRows;case"Commanding_Suggestion":case"Commanding_TellMe":return o.q.Commanding;case"ConditionalFormat_Suggestion":return(0,l.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?o.q.ConditionalFormatting:o.q.Commanding;case"Python_Suggestion":case"Python_Suggestion_FromAnalyzeData":case"Python_Suggestion_FromRefreshList":case"Python_Suggestion_FromSkittle":return o.q.Python;case"Tlr_ExplainTables":case"Tlr_ExplainHeaders":case"Tlr_ExplainUnmergingCells":return o.q.ContextInference;case"GiveMeMorePrompts":case"ImportDataFromFile":case"MorePrompts":case"SydneySuggestion":case"TryAgain":return;default:(0,r.x)(e)}}},202051:(e,t,a)=>{"use strict";a.d(t,{lB:()=>C,iY:()=>f,GI:()=>oe,Wx:()=>ee,dL:()=>ne,Ix:()=>ce,au:()=>te,kh:()=>ae,Qi:()=>K,MQ:()=>v,iq:()=>J,Vp:()=>me,pX:()=>Z,x6:()=>G,jv:()=>D,Y8:()=>N,R_:()=>y,BH:()=>Y,Jk:()=>V,Uc:()=>z,LH:()=>U,pJ:()=>j,i_:()=>X,En:()=>_,L7:()=>F,fB:()=>ue,$C:()=>W,j9:()=>ie,KG:()=>he,zj:()=>q,MF:()=>P,xp:()=>H,XO:()=>de,Pi:()=>O,_s:()=>se,pz:()=>$,bb:()=>Q,Eu:()=>le,w5:()=>M,h3:()=>re,Kx:()=>w,$n:()=>A,QX:()=>I,RA:()=>R,HH:()=>x,U6:()=>k,s$:()=>L,CS:()=>S,OE:()=>E});var n=a(755005),o=a(632512),r=a(267324),i=a(60398),l=a(956258),s=a(235373),c=a(108869),d=a(797639),u=a(528804),m=a(977055),h=a(107295);function g(e){if(!e)return!1;let t=["de","en","es","fr","it","ja","pt","zh"];if((0,u.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SupportT2Languages",!1)){const e=["ar","cs","da","fi","he","hu","ko","nb","nl","pl","pt","ru","sv","th","tr","uk","zh"];t=t.concat(e)}if((0,u.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SupportT25Languages",!1)){const e=["ca","cy"];t=t.concat(e)}if((0,u.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SupportT3Languages",!1)){const e=["bg","de","el","et","hr","id","lt","lv","nl","ro","sl","sk","sr","vi"];t=t.concat(e)}if((0,u.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.SupportT4Languages",!1)){const e=["fil","is","kk","ms","mt","sq","sr-Cyrl"];t=t.concat(e)}return t.some((t=>e.startsWith(t)))}var p=a(495501),b=a(875136);function f(e){if(!(0,c.C6)())throw new i.H({errorCode:o.O.PythonUnsupportedPlatform});if(!(0,c.Gd)())throw de();if(!g(e)){throw function(e){return new i.H({errorCode:o.O.PythonUnsupportedLanguage,errorDetailsNoPII:e})}(e?"Unsupported Language Detected":"OutputLanguage Undefined")}if((0,c.$)()&&!(0,h.i)()&&(0,u.yw9)("OfficeVSO_10271339_BlockPythonAAMode"))throw ue()}function C(e){if(!(0,c.C6)())throw new i.H({errorCode:o.O.AnswersUnsupportedPlatformError});if(!g(e)){const t=e?"Unsupported Language Detected":"OutputLanguage Undefined";throw new i.H({errorCode:o.O.AnswersUnsupportedLanguageError,errorDetailsNoPII:t})}}function y(e){if(e instanceof OfficeExtension.Error){if(e.code===Excel.ErrorCodes.itemNotFound){const t="getPythonCellsFromWorksheet: sheet deleted";return z(o.O.PythonUnexpectedMissingSheetInContextExtraction,t,e)}if(e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded)return se("payload size limit reached.",e)}return e}function v(e,t){const a=`Catching Function: ${t}: `;return e instanceof Error?a+`${e.stack?e.stack:"Unknown Type"}: `:a+"Unknown Type"}function x(e){return e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode}function T(e){return function(e){return"object"==typeof e&&null!==e&&"name"in e}(e)&&"RichApi.Error"===e.name}function S(e,t){const a=t?.signal.aborted,n=e instanceof i.H,r=e.errorCode===o.O.PythonContextExtractionAborted||e.errorCode===o.O.GetPythonCellContextTimeout||e.errorCode===o.O.GetPythonCellContextTimeoutRecoverable||e.errorCode===o.O.GetAllPythonCellsUpToAnalysisSheetTimeout||e.errorCode===o.O.ExecutePythonCodeApiCallTimeout||e.errorCode===o.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout;return a||n&&r}async function w(e,t,a,n,r=!1,s=[],u=!1){const h=(0,m.SG)();l.M.getInstance().endTriedActivityFailure(h);const g=v(t,a);let f;var C,y;t instanceof i.H?f=t:t instanceof Error?x(t)?f=ie(o.O.PythonGenericEditModeError,g,t):r?(C=g,y=t,f=new i.H({errorCode:o.O.PrePythonModeError,innerError:y,errorDetailsNoPII:C})):f=function(e){return T(e)&&e.code===Excel.ErrorCodes.inactiveWorkbook}(t)?function(e,t){return new i.H({errorCode:o.O.PythonMultipleOpenWorkbooks,innerError:t,errorDetailsNoPII:e})}(g,t):d.CP.pythonContextManager.isPythonMode&&!u&&await async function(){try{return!await(0,c.J7)(d.CP)}catch{return!1}}()?me(o.O.PythonDeletedSheetDuringResponseGeneration,"",t):B(g,t):f=B(g,t),p.n.displayPythonErrorResponse(e,f,s),(0,m.Lv)(f),(0,m.yQ)(f),(0,b.P_)(),!u&&n&&E(e)}function E(e){e(s.m.setSuggestionListDetails({suggestionList:[{suggestionText:(0,r.Yzk)(),suggestionType:"TryAgain"}],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0}))}function I(e,t,a,n){a&&p.n.displayPythonTextResponse(e,t.errorDisplayMessage,!1,!1,!0),(0,m.Lv)(t,n),(0,m.yQ)(t)}function R(e){d.CP.pythonContextManager.disableAutoScroll=!1;I(void 0,re(o.O.PythonTuiNotShownError,(e instanceof Error?e.stack:"No stack trace available")??"",e),!1)}function A(e,t,a){let n=e;a&&(n+=` Props keys: ${Object.keys(a).join(", ")}`);const r=function(e,t){const a=e?o.O.AnswersComponentPropsNotSerializable:o.O.PythonCodeAndPostViewPropsNotSerializable;return new i.H({errorCode:a,errorDetailsNoPII:t})}(t,n);I(void 0,r,!1)}function L(e){return e.outputType===n.qf.Error&&e.output&&!e.output.errorType}function k(e){return e.output?.errorType===Excel.ErrorCellValueType.busy}function F(e){if(e.outputType!==n.qf.Error)return;const t=e.output.errorType,a=`Python execution failed with error type: ${t}`;return t===Excel.ErrorCellValueType.python||t===Excel.ErrorCellValueType.timeout?q(o.O.PythonDataFrameInsertFailed,a,void 0):_(e)}function _(e){if(e.outputType!==n.qf.Error)return;const t=e.output.errorType,a=`Python execution failed with error type: ${t}`;return t===Excel.ErrorCellValueType.busy?D(a,void 0):t===Excel.ErrorCellValueType.connect?M(a):t===Excel.ErrorCellValueType.name||t===Excel.ErrorCellValueType.blocked?function(e){return new i.H({errorCode:o.O.PythonAccessError,errorDetailsNoPII:e})}(a):t===Excel.ErrorCellValueType.calc?function(e){return new i.H({errorCode:o.O.PythonCalcError,errorDetailsNoPII:e})}(a):function(e){return new i.H({errorCode:o.O.PythonGeneralError,errorDetailsNoPII:e})}(a)}function P(e,t,a,n,r,l){if(e instanceof i.H)return e;if(x(e))return ie(o.O.PythonGenericEditModeError,"",e);if(e instanceof i.H&&(e.errorCode===o.O.PythonProtectedSheetError||e.errorCode===o.O.PythonProtectedSheetObjectInsertionError))return e;const s=`Class ${t}, Method: ${a}, Stack: ${e instanceof Error?e.stack:"No stack trace available"} + Details: ${r}`;return q(n?o.O.PythonDataFrameInsertFailed:o.O.PythonInsertFailed,s,e,l)}function N(e){const t=v(e,"getAllPythonCellsUptoAnalysisSheet");return T(e)?z(o.O.PythonGeneralContextError,t,e,(0,r.kvH)()):e instanceof i.H?new i.H({errorCode:e.errorCode,errorDetailsNoPII:e.errorDetailsNoPII,errorDetailsOCVOnly:e.errorDetailsOCVOnly,customDisplayMessage:(0,r.kvH)()}):B(t,e,(0,r.kvH)())}function M(e){return new i.H({errorCode:o.O.PythonStaleRuntimeError,errorDetailsNoPII:e})}function O(e){return new i.H({errorCode:o.O.PythonObjectReferenceError,errorDetailsNoPII:e})}function D(e,t){return new i.H({errorCode:o.O.PythonBusyStateError,innerError:t,errorDetailsNoPII:e})}function B(e,t,a){return new i.H({errorCode:o.O.PythonUnknownError,innerError:t,errorDetailsNoPII:e,customDisplayMessage:a})}function $(e,t){return new i.H({errorCode:o.O.PythonPostViewError,innerError:t,errorDetailsNoPII:e})}function H(e,t){return new i.H({errorCode:e,errorDetailsNoPII:t})}function U(e){return new i.H({errorCode:o.O.PythonCopyFailed,innerError:e})}function q(e,t,a,n){return new i.H({errorCode:e,errorDetailsNoPII:t,innerError:a,errorDetailsOCVOnly:n})}function V(e){return new i.H({errorCode:o.O.PythonCodeRetryMaximumHit,errorDetailsNoPII:e})}function G(e){return new i.H({errorCode:o.O.PythonAugLoopCallsPerQueryMaximumHit,errorDetailsNoPII:e})}function W(e,t){return new i.H({errorCode:o.O.PythonExitAnalysisError,innerError:t,errorDetailsNoPII:e})}function z(e,t,a,n){return new i.H({errorCode:e,innerError:a,errorDetailsNoPII:t,customDisplayMessage:n})}function j(e){return new i.H({errorCode:o.O.PythonGetDiagnosticsError,innerError:e})}function Q(){return new i.H({errorCode:o.O.PythonPrintFormattedNumberError})}function J(e,t){return new i.H({errorCode:o.O.PythonAddResultsToNewSheetError,innerError:t,errorDetailsNoPII:e})}function Y(e){return new i.H({errorCode:o.O.PythonCodeAndPostViewPropsNotSerializable,errorDetailsNoPII:e})}function X(e){return new i.H({errorCode:o.O.PythonDisplayResponseError,errorDetailsNoPII:e})}function Z(e,t){return new i.H({errorCode:o.O.PythonAnalysisSheetMetadataError,innerError:e,errorDetailsNoPII:t})}function K(e,t){return new i.H({errorCode:o.O.AnswersPostViewError,innerError:t,errorDetailsNoPII:e})}function ee(e,t){return new i.H({errorCode:o.O.AnswersInvalidImageResponse,innerError:t,errorDetailsNoPII:e})}function te(e){return new i.H({errorCode:o.O.AnswersMissingChunkProperty,errorDetailsNoPII:e})}function ae(e){return new i.H({errorCode:o.O.AnswersParsingMetadataFailed,errorDetailsNoPII:e})}function ne(e,t){return new i.H({errorCode:e,errorDetailsNoPII:void 0,innerError:t})}function oe(e){return new i.H({errorCode:o.O.AnswersCollapsableCodeOnClickError,errorDetailsNoPII:void 0,innerError:e})}function re(e,t,a){return new i.H({errorCode:e,innerError:a,errorDetailsNoPII:t})}function ie(e,t,a){return new i.H({errorCode:e,innerError:a,errorDetailsNoPII:t})}function le(){return new i.H({errorCode:o.O.PythonProtectedSheetError})}function se(e,t){return new i.H({errorCode:o.O.PayloadSizeError,innerError:t,errorDetailsNoPII:e})}function ce(e,t,a){return new i.H({errorCode:e,innerError:a,errorDetailsNoPII:t})}function de(){return new i.H({errorCode:o.O.PythonNoActiveLicense})}function ue(){return new i.H({errorCode:o.O.PythonExecutionBlockedByAdmin})}function me(e,t,a){return new i.H({errorCode:e,innerError:a,errorDetailsNoPII:t})}function he(e){return new i.H({errorCode:o.O.PythonImageUnavailableAnalysisSheetDeletedError,errorDetailsNoPII:e})}},207545:(e,t,a)=>{"use strict";a.d(t,{B2:()=>c,Bv:()=>i,I_:()=>s,TB:()=>u,kH:()=>l,xC:()=>d,zj:()=>r});var n=a(212018),o=a(638753),r={AugloopSharedSessionID:"AugloopSharedSessionID",HandoffMessageId:"HandoffMessageId",HandoffMessage:"HandoffMessage",AugLoopCloudALServiceUrl:"AugloopClouldALServiceUrl",CopilotEntryPoint:"CopilotEntryPoint",CopilotStartResponse:"copilotStartResponse",CopilotStartQuery:"CopilotStartQuery",CopilotInitialPrompt:"CopilotInitialPrompt",CopilotStartPromptId:"CopilotStartPromptId",AugloopEverHadModelError:"AugloopEverHadModelError",AudienceGroup:"AudienceGroup",AppStartTimestamp:"AppStartTimestamp",CopilotPaneStartTimestamp:"StartTimeMs",AutoOpenChatPane:"AutoOpenChatPane",BizChatHostContext:"BizChatHostContext"},i={Dogfood:"Dogfood",GCC:"GCC",MSIT:"MSIT",Prod:"Prod",Test:"Test",Microsoft:"Microsoft",Production:"Production",Automation:"Automation"},l=function(){function e(){}return e.getSettingsArray=function(e){return e?"undefined"!=typeof Office&&Office.context&&Office.context.document?Office.context.document.settings:void 0:"undefined"!=typeof Office&&Office.context?Office.context.hostSettings:void 0},e.getSettingAsString=function(e,t){var a;if((0,n.isTest)())return"TestSetting";var r=null===(a=this.getSettingsArray(t))||void 0===a?void 0:a.get(e);return(0,o.hX)(r)?r:r.toString()},e.getSetting=function(e,t){var a;return null===(a=this.getSettingsArray(t))||void 0===a?void 0:a.get(e.toString())},e.removeSetting=function(e,t){var a;null===(a=this.getSettingsArray(t))||void 0===a||a.remove(e)},e.set=function(e,t,a){var n;null===(n=this.getSettingsArray(a))||void 0===n||n.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setByKey=function(e,t,a){var n;null===(n=this.getSettingsArray(a))||void 0===n||n.set(e,"string"==typeof t?t:JSON.stringify(t))},e.setHostSettings=function(e,t){var a=this;Object.keys(e).forEach((function(n){var r=(0,o.gZ)(e[n]);a.setByKey(n,r,t)}))},e.IsSettingTrue=function(e,t){var a=this.getSettingAsString(e,t);return!!a&&"true"===a.toLowerCase()},e}();function s(){var e=l.getSettingAsString(r.AudienceGroup);return e===i.Automation||e===i.Dogfood}function c(){var e=l.getSettingAsString(r.AudienceGroup);return e===i.Microsoft||e===i.MSIT}function d(){var e=l.getSettingAsString(r.AudienceGroup);return e===i.Production||e===i.Prod}function u(){var e=l.getSettingAsString(r.AugLoopCloudALServiceUrl);return!!(null==e?void 0:e.toLowerCase().includes("augloop-gcc"))}},208442:(e,t,a)=>{"use strict";a.d(t,{i:()=>E,v:()=>I});var n=a(725556),o=(a(117463),a(856656)),r=a(6862),i=a(824088),l=a(626128),s=a(267324),c=a(644737),d=a(9847),u=a(944032),m=a(369169),h=a(804672),g=a(528804),p=a(472500),b=a(295767),f=a(880496),C=a(479504),y=a(923971),v=a(988013),x=a(8745),T=a(887648),S=a(208520);function w(e){if((0,l.iM)(e))return(0,f.hU)(e)?(0,s.aVz)():(0,s.BqH)();if((0,l.cY)(e))return(0,f.Z)(e)?e.allowReplacementOfExistingValue?(0,s.KeO)():(0,s.E$x)():e.allowReplacementOfExistingValue?(0,s.ooE)():(0,s.EWN)();if((0,l.be)(e))return(0,s.E$x)();throw new Error("getInsertText: Invalid recommendation type")}function E(e,t){const a=(0,T.d4)((e=>e.dataAI.invalidatedSuggestions.includes(t.id)))&&(0,g.Jhm)(),[o,i]=(0,S.useState)((()=>!t||!t.isInserted)),c=(0,g.iPS)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsPreviewButton",!1),C=o&&!a,E=function(e,t,a,o){(0,x.H5)((()=>{(0,y.u)(t.id,a?d.a5.FormulaPreviewButtonAllowed:d.a5.FormulaPreviewButtonDisabled)}));const i=(0,v.j)(),l=(0,T.Pj)(),c=(0,T.d4)((e=>e.dataAI.previewId)),u=(0,T.d4)((e=>e.chat.latestRequestId)),g=S.useMemo((()=>{const n=l.getState();return Boolean(t&&a&&(0,m.c5)(e,t,n)&&n.dataAI.rawPreview[t.id]?.length)}),[e,t,l]),p=t?.id,f=u===e,C=c===p;(0,S.useEffect)((()=>{g&&p&&C&&!f&&((0,h.cY)("FormulaSuggestion: not in latest request, hiding preview"),i((0,b.QI)(e,p)))}),[C,f,p,g]),(0,x.iK)((()=>{g&&p&&C&&((0,h.cY)("FormulaSuggestion: unmounting, hiding preview"),i((0,b.QI)(e,p)))}));const w=Boolean(o&&g&&p);if((0,x.IC)(w,(()=>{(0,y.u)(p,d.a5.FormulaPreviewButtonVisible)})),!w)return;const E=C?s.XBr.PreviewOnGridButton_HidePreview():s.XBr.PreviewOnGridButton_ShowPreview(),I={buttonText:E,buttonTitle:E,icon:C?(0,n.jsx)(r.sTx,{}):(0,n.jsx)(r.tRH,{}),handleButtonOnClick:async()=>{if(t)return(0,y.u)(t.id,C?d.a5.FormulaPreviewButtonClickHide:d.a5.FormulaPreviewButtonClickShow),i((0,b.wK)(e,t,{hidePreviewOnChange:!0,moveViewportToPreview:!0}))}};return I}(e,t,c,C),I=function(e,t,a,n,o){const r=(0,v.j)();function i(t){if(o(),r((0,b.QI)(e,t.id)),(0,l.iM)(t))r((0,b.iM)(e,t));else{if(!(0,l.cY)(t))throw new Error("handleInsert: Invalid recommendation type");r((0,b.Sf)(e,t))}}return!t.isInserted&&n?{...(0,l.cY)(t)&&t.allowReplacementOfExistingValue?(0,u.x8)(w(t)):(0,u.r1)(w(t)),handleButtonOnClick:async()=>i(t),...a&&{handleOnMouseEnter:async()=>r((0,b.jv)(e,t)),handleOnMouseLeave:async()=>r((0,b.QI)(e,t.id))}}:void 0}(e,t,!c,C,(()=>i(!1))),R=(0,p.D)(t.debugInfo);return(0,h.cY)("useSuggestionsButtons",{requestId:e,recommendation:t,canInsert:o,canInsertSuggestion:C,canShowPreviewButton:c,previewButton:E,insertButton:I}),[I,E,R].filter(f.O9)}function I(e,t,a,n){const r=(0,p.J)(e,t.debugInfo),l=[{type:o.jA.Default,title:(0,s.oOI)(),text:(0,C.dD)()?void 0:(0,s.oOI)(),iconRegular:i.rz9,handleButtonOnClick:async(e,o,r)=>{(0,c.s_)(c.H0.InsertFormulaSuggestion),a((0,b.Kr)(t,n))},handleOnMouseEnter:async()=>a((0,b.jv)(n,t)),handleOnMouseLeave:async()=>a((0,b.QI)(n,t.id))}];return r&&l.push(r),l}},209980:(e,t,a)=>{"use strict";a.d(t,{E:()=>i});var n=a(944563),o=a(576583);const r={pythonRecommendation:{backgroundColor:n.k1.neutralLight,color:n.k1.neutralDark}},i=(0,o.n)(r)},214289:(e,t,a)=>{"use strict";a.d(t,{L:()=>A,f:()=>L});var n=a(83437),o=a(451373),r=a(956258);var i=a(855391),l=a(691097),s=a(516999);function c(e){return e instanceof i.Je&&e.errorCode===i.F4.PlatformDisabled}function d(e){return e instanceof i.Je&&e.errorCode===i.F4.ItemNotFound}function u(e){return e instanceof i.Je&&e.errorCode===i.F4.AccessDenied}function m(e){return e instanceof i.Je&&e.errorCode===i.F4.InvalidRequest}function h(e){return e instanceof i.Je&&e.errorCode===i.F4.MaxItemCountExceeded}const g=["Failed to fetch","NetworkError when attempting to fetch resource.","Network request failed"];const p=(0,s.or)(c,(function(e){return e instanceof i.Je&&e.errorCode===i.F4.NotAllowed})),b=(0,s.or)(p,m),f=(0,s.or)(p,d),C=(0,s.or)((function(e){return e instanceof i.Je&&e.errorCode===i.F4.NameAlreadyExists}),d),y=(0,s.or)(p,d,(function(e){return e instanceof i.Je&&e.errorCode===i.F4.InvalidFileName}),h),v=(0,s.or)((function(e){return!(e instanceof i.Je)&&e.message&&g.indexOf(e.message)>=0||e instanceof i.Je&&"Server returned non-json response"===e.message}),(function(e){return"Authorization Error"===e.message&&e.isExpectedError}),h);var x=a(596618);const T={token:null},S=e=>{const t=T;var a;t.token=e,a=t,(0,i.sA)({currentUserToken:a.token,currentUserMlapiToken:null})},w=()=>!0;async function E(e,t,a){const n=async t=>(await async function(e){const t=await o.P1.instance().authorizeStorageService(e);S(t),(0,i.HR)(L()),(0,i.mY)((0,x.u)())}(t),e(t));return(0,s.U)((async()=>async function(e,t){try{return await e(t.id)}catch(e){throw e instanceof i.Je&&401===e.status&&((0,i.ki)(null),o.P1.instance().clearStorageToken()),e}}(n,t)),w,(0,s.or)(y,a),3)}var I=a(375485),R=a(888810);class A{async getScript(e,t){const a=new I.A("getScript");try{const n=await E((t=>(0,i.IT)(e,t,!0)),a,f);return a.succeed({storageId:e.id,parentCallId:t}),n}catch(o){const r=f(o)||v(o)||u(o)?n.$b.Warning:n.$b.Error;throw a.fail(r,{parentCallId:t,storageId:e.id,writeMRU:!0},o),o}}async getCopilotScripts(e){const t=new I.A("getCopilotScripts"),a=await this.getRecentScripts(e);return t.succeed({copilotScriptCount:a.length,parentCallId:e}),a}async saveCopilotScript(e,t){const a=new I.A("saveCopilotScript");let o;try{return o=await E((t=>(0,i.FB)(e,t,!0)),a,(0,s.or)(C,p)),a.succeed({storageId:o.id,parentCallId:t}),o}catch(r){throw a.fail(n.$b.Error,{parentCallId:t,storageId:e.id},r),o&&this.removeScriptShim(o),r}}async removeRecentScriptShim(e,t){const a=new I.A("RemoveRecentScript");try{await E((e=>(0,i.zb)(t,e)),a,(0,s.or)(y,v)),a.succeed({storageId:e,parentCallId:r.M.userQueryGuid})}catch(t){a.fail(n.$b.Warning,{storageId:e,parentCallId:r.M.userQueryGuid},t)}}async removeScriptShim(e){const t=new I.A("DeleteScript");try{await E((t=>(0,i.Wb)(e,t)),t,(0,s.or)(d,c)),t.succeed({storageId:e.id,parentCallId:r.M.userQueryGuid,...e.driveType?{driveType:e.driveType}:{}})}catch(a){if(d(a)&&e.mruItemId&&await this.removeRecentScriptShim(e.id,e.mruItemId),d(a))return void t.succeed({storageId:e.id,parentCallId:r.M.userQueryGuid,...e.driveType?{driveType:e.driveType}:{}});const o=c(a)||v(a)||u(a)?n.$b.Warning:n.$b.Error;throw t.fail(o,{storageId:e.id,parentCallId:r.M.userQueryGuid,...e.driveType?{driveType:e.driveType}:{}},a),a}}async getRecentScripts(e){const t=new I.A("getRecentScripts");try{const a=await E((e=>(0,i.g5)("undefined"!=typeof Office&&Office.context&&Office.context.host?Office.context.displayLanguage:"en-US",e)),t,b);return t.succeed({scriptCount:a.length,parentCallId:e}),a}catch(a){const o=(0,s.or)(p,u)(a),r=m(a);throw t.fail(o||v(a)?n.$b.Warning:r?n.$b.ASHA:n.$b.Error,{parentCallId:e},a),new Error("Failed getRecentScripts call")}}}function L(){const e=(0,l.P)("StorageModePreference");if(e)return e===o.XT.makerserviceint?"int":"prodNew";return"Dogfood"===(0,R.A)()?"int":"prodNew"}},217425:(e,t,a)=>{"use strict";a.d(t,{L6:()=>c,MA:()=>i,Ss:()=>l,dX:()=>s,ky:()=>o,mr:()=>r,w8:()=>n});var n={augloop:"https://augloop.office.com/v2/AugLoop.All",loki:"https://loki.delve.office.com",graph:"https://graph.microsoft.com",sharepoint:"https://microsoft-my.sharepoint-df.com",onenote:"https://onenote.com",substrate:"https://substrate.office.com/search",ic3:"https://ic3.teams.office.com",cognitive:"https://cognitiveservices.azure.com"},o="6d8f24e8-a97e-4bb5-bbee-a1949aba8fb4",r="https://login.microsoftonline.com/common",i="https://login.microsoftonline.us/common",l="https://titles.prod.mos.microsoft.com",s="https://safelinks.protection.office365.com",c="https://dataservice.o365filtering.com"},223887:(e,t,a)=>{"use strict";a.d(t,{AU:()=>ot,uS:()=>rt,YV:()=>it,g$:()=>st,yT:()=>at});var n=a(725556),o=a(374522),r=a.n(o),i=a(83643),l=a.n(i),s=a(964185),c=a.n(s),d=a(612290),u=a.n(d),m=a(462478),h=a.n(m),g=a(101971),p=a.n(g),b=a(40395),f={};f.styleTagTransform=p(),f.setAttributes=u(),f.insert=c().bind(null,"head"),f.domAPI=l(),f.insertStyleElement=h();r()(b.A,f);b.A&&b.A.locals&&b.A.locals;var C=a(245307),y={};y.styleTagTransform=p(),y.setAttributes=u(),y.insert=c().bind(null,"head"),y.domAPI=l(),y.insertStyleElement=h();r()(C.A,y);C.A&&C.A.locals&&C.A.locals;var v=a(546762),x=a(86240),T=a(944563),S=a(576583);const w={swatch:{stroke:T.k1.black}},E=(0,S.n)(w);var I=a(885930),R=a(884499),A=a(267324),L=a(654417),k=a(9847),F=a(818977),_=a(173353);const P={width:"90px",height:"20px",border:"1px solid rgb(210, 208, 206)",borderRadius:"1px",borderWidth:"medium",fontSize:"12px",textAlign:"center",verticalAlign:"middle",fontWeight:"normal",fontStyle:"normal",textDecorationLine:"none",textDecorationStyle:"solid",backgroundColor:"white"},N={width:"72px",height:"16px",border:"1px solid rgb(210, 208, 206)",borderRadius:"1px",display:"flex",padding:"0.5px",flexDirection:"row"},M={background:"linear-gradient(to right, rgb(99, 142, 198), white)",width:"80%",border:"0.7px solid rgb(99, 142, 198)"},O=e=>{const t=e.IsTextDoubleUnderlined||e.IsTextUnderlined,a=e.BorderFormat.LineStyle,n=e.BorderFormat.Color;let o="rgb(210, 208, 206)",r="solid",i="medium";if(void 0!==a[0]){const e=(0,F.Cn)(n[0]);o=(0,F.S)(e),r=H(a[0]),i=$(a[0])}return{...P,backgroundColor:e.BackgroundColor?e.BackgroundColor:"white",color:e.TextColor,fontWeight:e.IsTextBold?"bold":"normal",fontStyle:e.IsTextItalic?"italic":"normal",textDecorationLine:`${e.IsTextStrikethrough?"line-through":""} ${t?"underline":""}`.trim(),textDecorationStyle:e.IsTextDoubleUnderlined?"double":void 0,border:`1px ${r} ${o}`,borderWidth:i}},D=(e,t,a)=>{let n;return n=null!=a?`linear-gradient(90deg, ${e} 0%, ${a} 50%, ${t} 100%)`:`linear-gradient(90deg, ${e} 0%, ${t} 100%)`,{...P,background:n}},B=(e,t)=>{let a;return a=t?`linear-gradient(to right, ${e}, white)`:`${e}`,{...M,background:a}},$=e=>{switch(e){case _.BorderLineStyle.Thin:return"thin";case _.BorderLineStyle.Thick:return"thick";case _.BorderLineStyle.Medium:return"medium";default:return"thin"}},H=e=>{switch(e){case _.BorderLineStyle.None:return"";case _.BorderLineStyle.Thin:case _.BorderLineStyle.Medium:case _.BorderLineStyle.Thick:case _.BorderLineStyle.Double:case _.BorderLineStyle.Hair:return"solid";case _.BorderLineStyle.Dotted:return"dotted";case _.BorderLineStyle.Dashed:case _.BorderLineStyle.DashDot:case _.BorderLineStyle.DashDotDot:case _.BorderLineStyle.MediumDashed:case _.BorderLineStyle.MediumDashDot:case _.BorderLineStyle.MediumDashDotDot:case _.BorderLineStyle.SlantDashDot:return"dashed";default:return"solid"}};var U=a(883),q=a(528804),V=a(57980),G=a(863890),W=a(208520);a(805844);const z=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1865 954 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m21",d:"M 832 1856 v -1227 l -506 506 l -181 -181 l 815 -815 l 815 815 l -181 181 l -506 -506 v 1227 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m23",d:"M 236 954 l 90 90 l 570 -569 v 1317 h 128 v -1317 l 570 569 l 90 -90 l -724 -724 m 905 724 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"})]}),j=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 2048 2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 966 1865 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m21",d:"M 64 832 h 1227 l -506 -506 l 181 -181 l 815 815 l -815 815 l -181 -181 l 506 -506 h -1227 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m23",d:"M 966 236 l -90 90 l 569 570 h -1317 v 128 h 1317 l -569 570 l 90 90 l 724 -724 m -724 905 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"})]}),Q=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 2048 2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 55 966 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m21",d:"M 1088 64 v 1227 l 506 -506 l 181 181 l -815 815 l -815 -815 l 181 -181 l 506 506 v -1227 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m23",d:"M 1684 966 l -90 -90 l -570 569 v -1317 h -128 v 1317 l -570 -569 l -90 90 l 724 724 m -905 -724 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"})]}),J=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 512 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 l 848 848 v -619 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m21",d:"M 576 1728 v -256 h 710 l -912 -912 l 186 -186 l 912 912 v -710 h 256 v 1152 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m23",d:"M 464 560 l 976 976 h -800 v 128 h 1024 v -1024 h -128 v 800 l -976 -976 m 848 667 v -619 h 384 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 z"})]}),Y=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 256 v 1280 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m21",d:"M 374 1488 l 912 -912 h -710 v -256 h 1152 v 1152 h -256 v -710 l -912 912 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m23",d:"M 640 384 v 128 h 800 l -976 976 l 96 96 l 976 -976 v 800 h 128 v -1024 m 128 1152 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 h 1280 z"})]}),X=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 236 954 l 90 90 l 570 -569 v 1317 h 128 v -1317 l 570 569 l 90 -90 l -724 -724 m 905 724 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m29",d:"M 832 1856 v -1227 l -506 506 l -181 -181 l 815 -815 l 815 815 l -181 181 l -506 -506 v 1227 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m28",d:"M 236 954 l 90 90 l 570 -569 v 1317 h 128 v -1317 l 570 569 l 90 -90 l -724 -724 m 905 724 l -271 271 l -442 -441 v 1136 h -384 v -1136 l -442 441 l -271 -271 l 905 -905 z"})]}),Z=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 966 236 l -90 90 l 569 570 h -1317 v 128 h 1317 l -569 570 l 90 90 l 724 -724 m -724 905 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 64 832 h 1227 l -506 -506 l 181 -181 l 815 815 l -815 815 l -181 -181 l 506 -506 h -1227 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 966 236 l -90 90 l 569 570 h -1317 v 128 h 1317 l -569 570 l 90 90 l 724 -724 m -724 905 l -271 -271 l 441 -442 h -1136 v -384 h 1136 l -441 -442 l 271 -271 l 905 905 z"})]}),K=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1684 966 l -90 -90 l -570 569 v -1317 h -128 v 1317 l -570 -569 l -90 90 l 724 724 m -905 -724 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m215",d:"M 1088 64 v 1227 l 506 -506 l 181 181 l -815 815 l -815 -815 l 181 -181 l 506 506 v -1227 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m214",d:"M 1684 966 l -90 -90 l -570 569 v -1317 h -128 v 1317 l -570 -569 l -90 90 l 724 724 m -905 -724 l 271 -271 l 442 441 v -1136 h 384 v 1136 l 442 -441 l 271 271 l -905 905 z"})]}),ee=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 464 560 l 976 976 h -800 v 128 h 1024 v -1024 h -128 v 800 l -976 -976 m 848 667 v -619 h 384 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 576 1728 v -256 h 710 l -912 -912 l 186 -186 l 912 912 v -710 h 256 v 1152 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 464 560 l 976 976 h -800 v 128 h 1024 v -1024 h -128 v 800 l -976 -976 m 848 667 v -619 h 384 v 1280 h -1280 v -384 h 619 l -848 -848 l 277 -277 z"})]}),te=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 640 384 v 128 h 800 l -976 976 l 96 96 l 976 -976 v 800 h 128 v -1024 m 128 1152 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 h 1280 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 374 1488 l 912 -912 h -710 v -256 h 1152 v 1152 h -256 v -710 l -912 912 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 640 384 v 128 h 800 l -976 976 l 96 96 l 976 -976 v 800 h 128 v -1024 m 128 1152 h -384 v -619 l -848 848 l -277 -277 l 848 -848 h -619 v -384 h 1280 z"})]}),ae=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 1664 h -1920 l 960 -1280 m -704 1152 h 1408 l -704 -939 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m29",d:"M 128 1600 l 832 -1109 l 832 1109 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m28",d:"M 1920 1664 h -1920 l 960 -1280 m -704 1152 h 1408 l -704 -939 z"})]}),ne=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 640 v 640 h -1920 v -640 m 1792 128 h -1664 v 384 h 1664 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 64 1216 v -512 h 1792 v 512 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 1920 640 v 640 h -1920 v -640 m 1792 128 h -1664 v 384 h 1664 z"})]}),oe=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 0 384 h 1920 l -960 1280 m 704 -1152 h -1408 l 704 939 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m215",d:"M 1792 448 l -832 1109 l -832 -1109 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m214",d:"M 0 384 h 1920 l -960 1280 m 704 -1152 h -1408 l 704 939 z"})]}),re=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m29",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m28",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),ie=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -39 4 -77 q 3 -38 9 -76 v -4 q 19 -123 66 -235 q 46 -112 116 -208 q 70 -96 160 -175 q 90 -78 196 -134 q 106 -55 226 -85 q 119 -30 247 -30 m 896 1024 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -9 0 -18 0 q -9 1 -18 2 l 930 930 q 1 -9 2 -18 q 0 -9 0 -18 m -1572 -586 q -72 83 -122 181 q -51 98 -76 209 l 1070 1070 q 111 -25 209 -76 q 98 -50 181 -122 m -1482 -676 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 9 0 18 -1 q 9 0 18 -1 l -930 -930 q -1 9 -1 18 q -1 9 -1 18 m 1572 586 q 72 -83 123 -181 q 50 -98 75 -209 l -1070 -1070 q -111 25 -209 75 q -98 51 -181 123 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),le=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m215",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m214",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),se=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m215",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m214",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),ce=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -512 0 q 0 80 -30 149 q -30 70 -82 122 q -53 53 -123 83 q -70 30 -149 30 q -80 0 -149 -30 q -70 -30 -122 -83 q -53 -52 -83 -122 q -30 -69 -30 -149 q 0 -79 30 -149 q 30 -70 83 -123 q 52 -52 122 -82 q 69 -30 149 -30 q 79 0 149 30 q 70 30 123 82 q 52 53 82 123 q 30 70 30 149 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m221",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m220",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),de=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -384 0 q 0 106 -40 199 q -41 93 -110 162 q -70 70 -163 110 q -93 41 -199 41 q -106 0 -199 -41 q -93 -40 -162 -110 q -70 -69 -110 -162 q -41 -93 -41 -199 q 0 -106 41 -199 q 40 -93 110 -163 q 69 -69 162 -110 q 93 -40 199 -40 q 106 0 199 40 q 93 41 163 110 q 69 70 110 163 q 40 93 40 199 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m21",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),ue=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -256 0 q 0 88 -23 170 q -23 82 -64 153 q -42 71 -100 129 q -59 59 -130 100 q -71 42 -153 65 q -82 23 -170 23 q -88 0 -170 -23 q -82 -23 -153 -65 q -71 -41 -129 -100 q -59 -58 -100 -129 q -42 -71 -65 -153 q -23 -82 -23 -170 q 0 -88 23 -170 q 23 -82 65 -153 q 41 -71 100 -130 q 58 -58 129 -100 q 71 -41 153 -64 q 82 -23 170 -23 q 88 0 170 23 q 82 23 153 64 q 71 42 130 100 q 58 59 100 130 q 41 71 64 153 q 23 82 23 170 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 z"})]}),me=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 m -896 -1664 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m29",d:"M 1024 1728 q -97 0 -187 -25 q -90 -25 -168 -71 q -78 -46 -142 -111 q -65 -64 -111 -142 q -46 -78 -71 -168 q -25 -90 -25 -187 q 0 -97 25 -187 q 25 -90 71 -168 q 46 -78 111 -143 q 64 -64 142 -110 q 78 -46 168 -71 q 90 -25 187 -25 q 97 0 187 25 q 90 25 168 71 q 78 46 143 110 q 64 65 110 143 q 46 78 71 168 q 25 90 25 187 q 0 97 -25 187 q -25 90 -71 168 q -46 78 -110 142 q -65 65 -143 111 q -78 46 -168 71 q -90 25 -187 25 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m28",d:"M 1024 256 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 z"})]}),he=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -2048 v -2048 m 128 1920 h 1792 v -1792 h -1792 m 896 128 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 640 768 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -9 0 -18 0 q -9 0 -18 1 l 675 675 q 1 -9 1 -18 q 0 -9 0 -18 m -1280 0 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 q 130 0 245 -49 l -836 -836 q -49 115 -49 245 m 1002 528 q 88 -61 153 -147 q 64 -86 96 -191 l -801 -801 q -104 32 -190 96 q -87 65 -148 153 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 1024 1728 q -97 0 -187 -25 q -90 -25 -168 -71 q -78 -46 -142 -111 q -65 -64 -111 -142 q -46 -78 -71 -168 q -25 -90 -25 -187 q 0 -97 25 -187 q 25 -90 71 -168 q 46 -78 111 -143 q 64 -64 142 -110 q 78 -46 168 -71 q 90 -25 187 -25 q 97 0 187 25 q 90 25 168 71 q 78 46 143 110 q 64 65 110 143 q 46 78 71 168 q 25 90 25 187 q 0 97 -25 187 q -25 90 -71 168 q -46 78 -110 142 q -65 65 -143 111 q -78 46 -168 71 q -90 25 -187 25 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 1024 256 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 z"})]}),ge=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 m -896 -1664 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m215",d:"M 1024 1728 q -97 0 -187 -25 q -90 -25 -168 -71 q -78 -46 -142 -111 q -65 -64 -111 -142 q -46 -78 -71 -168 q -25 -90 -25 -187 q 0 -97 25 -187 q 25 -90 71 -168 q 46 -78 111 -143 q 64 -64 142 -110 q 78 -46 168 -71 q 90 -25 187 -25 q 97 0 187 25 q 90 25 168 71 q 78 46 143 110 q 64 65 110 143 q 46 78 71 168 q 25 90 25 187 q 0 97 -25 187 q -25 90 -71 168 q -46 78 -110 142 q -65 65 -143 111 q -78 46 -168 71 q -90 25 -187 25 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m214",d:"M 1024 256 q 106 0 204 27 q 98 28 184 78 q 85 50 155 120 q 70 70 120 155 q 50 86 78 184 q 27 98 27 204 q 0 106 -27 204 q -28 98 -78 183 q -50 86 -120 156 q -70 70 -155 120 q -86 50 -184 77 q -98 28 -204 28 q -106 0 -204 -28 q -98 -27 -183 -77 q -86 -50 -156 -120 q -70 -70 -120 -156 q -50 -85 -77 -183 q -28 -98 -28 -204 q 0 -106 28 -204 q 27 -98 77 -184 q 50 -85 120 -155 q 70 -70 156 -120 q 85 -50 183 -78 q 98 -27 204 -27 m 0 1408 q 88 0 170 -23 q 82 -23 153 -65 q 71 -41 130 -100 q 58 -58 100 -129 q 41 -71 64 -153 q 23 -82 23 -170 q 0 -88 -23 -170 q -23 -82 -64 -153 q -42 -71 -100 -130 q -59 -58 -130 -100 q -71 -41 -153 -64 q -82 -23 -170 -23 q -88 0 -170 23 q -82 23 -153 64 q -71 42 -129 100 q -59 59 -100 130 q -42 71 -65 153 q -23 82 -23 170 q 0 88 23 170 q 23 82 65 153 q 41 71 100 129 q 58 59 129 100 q 71 42 153 65 q 82 23 170 23 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 2048 0 v 2048 h -2048 v -2048 m 1920 128 h -1792 v 1792 h 1792 z"})]}),pe=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 1920 h -1920 l 960 -1920 m -753 1792 h 1506 l -753 -1506 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 104 1856 l 856 -1713 l 856 1713 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 1920 1920 h -1920 l 960 -1920 m -753 1792 h 1506 l -753 -1506 z"})]}),be=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2020 1024 l -996 996 l -996 -996 l 996 -996 m 0 1810 l 815 -814 l -815 -814 l -815 814 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m215",d:"M 119 1024 l 905 -905 l 905 905 l -905 905 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m214",d:"M 2020 1024 l -996 996 l -996 -996 l 996 -996 m 0 1810 l 815 -814 l -815 -814 l -815 814 z"})]}),fe=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2019 558 l -1315 1313 l -674 -674 l 271 -271 l 403 403 l 1043 -1043 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m29",d:"M 120 1197 l 181 -181 l 403 403 l 1043 -1043 l 181 181 l -1224 1224 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m28",d:"M 704 1510 l -403 -403 l -90 90 l 493 493 l 1133 -1133 l -90 -90 m 271 90 l -1314 1314 l -674 -674 l 271 -271 l 403 403 l 1043 -1043 z"})]}),Ce=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1280 0 v 1408 h -512 v -1408 m 0 1536 h 512 v 512 h -512 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 832 1984 v -384 h 384 v 384 m -384 -640 v -1280 h 384 v 1280 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 1280 0 v 1408 h -512 v -1408 m 384 128 h -256 v 1152 h 256 m 128 256 v 512 h -512 v -512 m 384 128 h -256 v 256 h 256 z"})]}),ye=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1984 348 l -676 676 l 676 676 l -284 284 l -676 -676 l -676 676 l -284 -284 l 676 -676 l -676 -676 l 284 -284 l 676 676 l 676 -676 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m215",d:"M 154 1700 l 677 -676 l -677 -676 l 194 -194 l 676 677 l 676 -677 l 194 194 l -677 676 l 677 676 l -194 194 l -676 -677 l -676 677 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m214",d:"M 1024 921 l -676 -676 l -103 103 l 676 676 l -676 676 l 103 103 l 676 -676 l 676 676 l 103 -103 l -676 -676 l 676 -676 l -103 -103 m 284 103 l -676 676 l 676 676 l -284 284 l -676 -676 l -676 676 l -284 -284 l 676 -676 l -676 -676 l 284 -284 l 676 676 l 676 -676 z"})]}),ve=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 142 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -66 -207 -160 q -94 -93 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -114 161 -208 q 93 -93 207 -160 q 113 -66 244 -103 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 m 544 -1312 l 128 128 l -864 864 l -480 -480 l 128 -128 l 352 352 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m29",d:"M 1024 64 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 m 762 672 l -218 -218 l -736 736 l -352 -352 l -218 218 l 570 570 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m28",d:"M 1024 0 q 141 0 272 36 q 131 37 245 103 q 113 67 207 160 q 93 94 160 208 q 67 114 104 245 q 36 131 36 272 q 0 142 -36 272 q -37 131 -104 245 q -67 114 -160 207 q -94 94 -207 160 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -66 -207 -160 q -94 -93 -161 -207 q -67 -114 -103 -245 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -114 161 -208 q 93 -93 207 -160 q 113 -66 244 -103 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -75 -12 -146 q -12 -71 -35 -138 l -1041 1041 l -661 -661 l 309 -309 l 352 352 l 736 -736 l 301 301 q -46 -131 -129 -241 q -83 -110 -193 -190 q -111 -80 -244 -125 q -133 -44 -279 -44 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 m 672 -1184 l -128 -128 l -736 736 l -352 -352 l -128 128 l 480 480 z"})]}),xe=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 m 0 -102 q -40 0 -75 -12 q -35 -12 -61 -33 q -26 -21 -41 -49 q -15 -28 -15 -60 q 0 -32 15 -60 q 15 -28 41 -49 q 26 -21 61 -33 q 35 -12 75 -12 q 40 0 75 12 q 35 12 61 33 q 26 21 41 49 q 15 28 15 60 q 0 32 -15 60 q -15 28 -41 49 q -26 21 -61 33 q -35 12 -75 12 m 128 -538 h -256 v -1024 h 256 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 832 1344 v -1152 h 384 v 1152 m -192 538 q -53 0 -99 -17 q -47 -17 -82 -47 q -35 -30 -55 -70 q -20 -39 -20 -84 q 0 -45 20 -85 q 20 -39 55 -69 q 35 -30 82 -47 q 46 -17 99 -17 q 53 0 100 17 q 46 17 81 47 q 35 30 55 69 q 20 40 20 85 q 0 45 -20 84 q -20 40 -55 70 q -35 30 -81 47 q -47 17 -100 17 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1818 q 40 0 75 -12 q 35 -12 61 -33 q 26 -21 41 -49 q 15 -28 15 -60 q 0 -32 -15 -60 q -15 -28 -41 -49 q -26 -21 -61 -33 q -35 -12 -75 -12 q -40 0 -75 12 q -35 12 -61 33 q -26 21 -41 49 q -15 28 -15 60 q 0 32 15 60 q 15 28 41 49 q 26 21 61 33 q 35 12 75 12 m 128 -1562 h -256 v 1024 h 256 m -1024 -256 q 0 164 56 311 q 56 147 154 264 q 98 117 232 196 q 133 80 289 109 q -70 -37 -112 -100 q -43 -62 -43 -140 q 0 -43 14 -82 q 14 -39 39 -72 q 24 -33 59 -59 q 34 -26 76 -43 h -124 v -1242 q -139 41 -256 123 q -117 83 -202 195 q -86 113 -134 251 q -48 138 -48 289 m 1061 880 q 156 -29 290 -109 q 133 -79 231 -196 q 98 -117 154 -264 q 56 -147 56 -311 q 0 -151 -48 -289 q -48 -138 -133 -251 q -86 -112 -203 -195 q -117 -82 -256 -123 v 1242 h -124 q 42 17 77 43 q 34 26 59 59 q 24 33 38 72 q 14 39 14 82 q 0 78 -42 140 q -43 63 -113 100 z"})]}),Te=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 m -715 0 l 422 421 l -182 182 l -421 -422 l -421 422 l -182 -182 l 422 -421 l -422 -421 l 182 -182 l 421 422 l 421 -422 l 182 182 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m215",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1024 1296 l -421 421 l -272 -272 l 421 -421 l -421 -421 l 272 -272 l 421 421 l 421 -421 l 272 272 l -421 421 l 421 421 l -272 272 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m214",d:"M 1024 843 l -421 -422 l -182 182 l 422 421 l -422 421 l 182 182 l 421 -422 l 421 422 l 182 -182 l -422 -421 l 422 -421 l -182 -182 m 363 182 l -422 421 l 422 421 l -363 363 l -421 -422 l -421 422 l -363 -363 l 422 -421 l -422 -421 l 363 -363 l 421 422 l 421 -422 m 603 784 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),Se=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1664 256 v 1024 h -768 v -256 h -512 v 1024 h -128 v -2048 h 768 v 256 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m29",d:"M 1600 320 v 896 h -640 v -256 h -640 v -896 h 640 v 256 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m28",d:"M 1664 256 v 1024 h -768 v -256 h -576 v -128 h 576 v -768 h -576 v -128 h 704 v 256 m 512 128 h -512 v 768 h 512 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 384 2048 h -128 v -2048 h 128 z"})]}),we=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1664 256 v 1024 h -768 v -256 h -512 v 1024 h -128 v -2048 h 768 v 256 m 512 128 h -293 l 293 293 m -640 -549 h -293 l 293 293 m -512 475 h 165 l -165 -165 m 512 165 v -293 l -475 -475 h -37 v 421 l 347 347 m 293 256 h 165 l -165 -165 m 512 165 v -293 l -475 -475 h -37 v 421 l 347 347 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 1600 320 v 896 h -640 v -256 h -640 v -896 h 640 v 256 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 1664 256 v 1024 h -768 v -256 h -576 v -128 h 576 v -768 h -576 v -128 h 704 v 256 m 512 128 h -512 v 768 h 512 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 384 2048 h -128 v -2048 h 128 z"})]}),Ee=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1664 256 v 1024 h -768 v -256 h -512 v 1024 h -128 v -2048 h 768 v 256 m -128 -128 h -512 v 768 h 512 m 640 -512 h -512 v 768 h 512 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m215",d:"M 1600 320 v 896 h -640 v -256 h -640 v -896 h 640 v 256 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m214",d:"M 1664 256 v 1024 h -768 v -256 h -576 v -128 h 576 v -768 h -576 v -128 h 704 v 256 m 512 128 h -512 v 768 h 512 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 384 2048 h -128 v -2048 h 128 z"})]}),Ie=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1027 0 l 253 640 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 1026 1537 l -574 360 l 233 -666 l -530 -527 h 650 l 221 -533 l 211 533 h 657 l -526 528 l 263 665 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 1025 1466 l 478 285 l -210 -531 l 448 -452 h -548 l -169 -426 l -176 426 h -539 l 450 450 l -187 532 m 708 -1110 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"})]}),Re=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 1467 l 479 284 l -210 -530 l 448 -453 h -548 l -169 -426 m 256 298 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1035 1530 l -575 361 l 234 -668 l -531 -530 h 651 l 221 -533 l 210 533 h 658 l -526 532 l 263 666 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m212",d:"M 460 1891 l 234 -668 l -531 -530 h 651 l 210 -507 v 1351 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1025 0 l 255 640 h 768 l -605 608 l 317 800 l -735 -434 v -148 l 478 285 l -210 -530 l 448 -453 h -548 l -168 -424 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m211",d:"M 1024 343 l -176 425 h -539 l 450 450 l -187 532 l 452 -283 v 147 l -693 434 l 281 -800 l -612 -608 h 763 l 261 -632 z"})]}),Ae=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 572 1750 l 453 -284 l 478 285 l -210 -530 l 448 -453 h -548 l -169 -426 l -176 426 h -539 l 462 457 m 509 -585 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1026 1537 l -574 360 l 233 -666 l -530 -527 h 650 l 221 -533 l 211 533 h 657 l -526 528 l 263 665 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m210",d:"M 572 1750 l 453 -284 l 478 285 l -210 -530 l 448 -453 h -548 l -169 -426 l -176 426 h -539 l 462 457 m 509 -585 h 768 l -605 608 l 317 800 l -733 -436 l -696 436 l 281 -800 l -612 -608 h 763 l 264 -640 z"})]}),Le=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -640 1280 h -128 v 640 h 128 m 384 -1024 h -128 v 1024 h 128 m 384 -1408 h -128 v 1408 h 128 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m26",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})]}),ke=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -640 1280 h -128 v 640 h 128 m 384 -1024 h -128 v 1024 h 128 m 640 -1792 h -256 v 1792 h 256 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m26",d:"M 1344 1984 h -1152 v -768 h 384 v -384 h 384 v -384 h 384 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})]}),Fe=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -640 1280 h -128 v 640 h 128 m 640 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m26",d:"M 960 1984 h -768 v -768 h 384 v -384 h 384 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})]}),_e=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -384 896 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m26",d:"M 576 1984 h -384 v -768 h 384 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})]}),Pe=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 192 1984 v -768 h 384 v -384 h 384 v -384 h 384 v -384 h 384 v 1920 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1792 0 v 2048 h -1664 v -896 h 384 v -384 h 384 v -384 h 384 v -384 m -768 1280 h -256 v 640 h 256 m 384 -1024 h -256 v 1024 h 256 m 384 -1408 h -256 v 1408 h 256 m 384 -1792 h -256 v 1792 h 256 z"})]}),Ne=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m23",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),Me=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 128 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 h 896 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m23",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 h 960 v -960 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 0 1024 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 m 128 0 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 z"})]}),Oe=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m -896 1024 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 v -1792 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m23",d:"M 1984 1024 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 v -1920 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),De=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 h -896 v -896 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m23",d:"M 1024 64 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 h -960 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1024 0 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 m 0 1920 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 z"})]}),Be=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1024 1984 q -132 0 -254 -35 q -123 -34 -230 -97 q -107 -62 -194 -150 q -88 -87 -150 -194 q -63 -107 -97 -230 q -35 -122 -35 -254 q 0 -132 35 -255 q 34 -122 97 -229 q 62 -107 150 -195 q 87 -87 194 -150 q 107 -62 230 -97 q 122 -34 254 -34 q 132 0 255 34 q 122 35 229 97 q 107 63 195 150 q 87 88 150 195 q 62 107 97 229 q 34 123 34 255 q 0 132 -34 254 q -35 123 -97 230 q -63 107 -150 194 q -88 88 -195 150 q -107 63 -229 97 q -123 35 -255 35 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 2048 1024 q 0 141 -36 272 q -37 131 -104 244 q -67 114 -160 207 q -94 94 -207 161 q -114 67 -245 103 q -131 37 -272 37 q -141 0 -272 -37 q -131 -36 -244 -103 q -114 -67 -207 -161 q -94 -93 -161 -207 q -67 -113 -103 -244 q -37 -131 -37 -272 q 0 -141 37 -272 q 36 -131 103 -245 q 67 -113 161 -207 q 93 -93 207 -160 q 113 -67 244 -104 q 131 -36 272 -36 q 141 0 272 36 q 131 37 245 104 q 113 67 207 160 q 93 94 160 207 q 67 114 104 245 q 36 131 36 272 m -128 0 q 0 -123 -32 -238 q -32 -114 -90 -214 q -59 -99 -141 -181 q -82 -82 -181 -141 q -100 -58 -214 -90 q -115 -32 -238 -32 q -124 0 -238 32 q -114 32 -213 90 q -100 59 -182 141 q -82 82 -140 181 q -59 100 -91 214 q -32 115 -32 238 q 0 124 32 238 q 32 114 91 213 q 58 100 140 182 q 82 82 182 140 q 99 59 214 91 q 114 32 237 32 q 123 0 238 -32 q 114 -32 214 -91 q 99 -58 181 -140 q 82 -82 141 -182 q 58 -99 90 -214 q 32 -114 32 -237 z"})]}),$e=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 896 h -768 v -768 h -128 v 768 h -768 v 128 h 768 v 768 h 128 v -768 h 768 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m26",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 896 1024 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 m 896 128 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})]}),He=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -896 v 768 h -768 v 128 h 768 v 768 h 128 v -768 h 768 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m26",d:"M 1860 956 v 903 h -1801 v -1794 h 903 v 891 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 128 896 h 768 v -768 h -768 m 768 896 h -768 v 768 h 768 m 896 -768 h -768 v 768 h 768 m 0 -896 v -768 h -768 v 768 z"})]}),Ue=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -768 v 768 h -128 v -768 h -768 v 896 h 768 v 768 h 128 v -768 h 768 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m26",d:"M 1856 1856 h -1792 v -896 h 1792 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 896 1024 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 m 896 128 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})]}),qe=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 1792 128 h -768 v 768 h -128 v -768 h -768 v 896 h 768 v 768 h 896 v -768 h -768 v -126 h 768 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m26",d:"M 64 960 h 896 v 896 h -896 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 896 1024 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 m 896 128 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})]}),Ve=()=>(0,n.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0,0,2048,2048",children:[(0,n.jsx)("path",{className:"OfficeIconColors_HighContrast",d:"M 1920 0 v 1920 h -1920 v -1920 m 128 896 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 -768 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m20",d:"M 1856 1856 h -1792 v -1792 h 1792 z"}),(0,n.jsx)("path",{className:"OfficeIconColors_m22",d:"M 1920 0 v 1920 h -1920 v -1920 m 128 896 h 768 v -768 h -768 m 768 1664 v -768 h -768 v 768 m 1664 -768 h -768 v 768 h 768 m 0 -1664 h -768 v 768 h 768 z"})]}),Ge=()=>{(0,V.K1)({icons:{conditional_format_grey_arrow_up_icon:(0,n.jsx)(z,{}),conditional_format_grey_arrow_right_icon:(0,n.jsx)(j,{}),conditional_format_grey_arrow_down_icon:(0,n.jsx)(Q,{}),conditional_format_grey_arrow_down_right_icon:(0,n.jsx)(J,{}),conditional_format_grey_arrow_up_right_icon:(0,n.jsx)(Y,{}),conditional_format_colored_arrow_up_icon:(0,n.jsx)(X,{}),conditional_format_colored_arrow_right_icon:(0,n.jsx)(Z,{}),conditional_format_colored_arrow_down_icon:(0,n.jsx)(K,{}),conditional_format_colored_arrow_down_right_icon:(0,n.jsx)(ee,{}),conditional_format_colored_arrow_up_right_icon:(0,n.jsx)(te,{}),conditional_format_triangle_high_icon:(0,n.jsx)(ae,{}),conditional_format_triangle_medium_icon:(0,n.jsx)(ne,{}),conditional_format_triangle_low_icon:(0,n.jsx)(oe,{}),conditional_format_circle_high_icon:(0,n.jsx)(re,{}),conditional_format_circle_medium_icon:(0,n.jsx)(ie,{}),conditional_format_circle_low_icon:(0,n.jsx)(le,{}),conditional_format_4circle_high_icon:(0,n.jsx)(se,{}),conditional_format_4circle_medium2_icon:(0,n.jsx)(ce,{}),conditional_format_4circle_medium1_icon:(0,n.jsx)(de,{}),conditional_format_4circle_low_icon:(0,n.jsx)(ue,{}),conditional_format_traffic_high_icon:(0,n.jsx)(me,{}),conditional_format_traffic_medium_icon:(0,n.jsx)(he,{}),conditional_format_traffic_low_icon:(0,n.jsx)(ge,{}),conditional_format_sign_medium_icon:(0,n.jsx)(pe,{}),conditional_format_sign_low_icon:(0,n.jsx)(be,{}),conditional_format_symbol_high_icon:(0,n.jsx)(fe,{}),conditional_format_symbol_medium_icon:(0,n.jsx)(Ce,{}),conditional_format_symbol_low_icon:(0,n.jsx)(ye,{}),conditional_format_circle_symbol_high_icon:(0,n.jsx)(ve,{}),conditional_format_circle_symbol_medium_icon:(0,n.jsx)(xe,{}),conditional_format_circle_symbol_low_icon:(0,n.jsx)(Te,{}),conditional_format_flag_high_icon:(0,n.jsx)(Se,{}),conditional_format_flag_medium_icon:(0,n.jsx)(we,{}),conditional_format_flag_low_icon:(0,n.jsx)(Ee,{}),conditional_format_star_high_icon:(0,n.jsx)(Ie,{}),conditional_format_star_medium_icon:(0,n.jsx)(Re,{}),conditional_format_star_low_icon:(0,n.jsx)(Ae,{}),conditional_format_signal_high_icon:(0,n.jsx)(Le,{}),conditional_format_signal_medium2_icon:(0,n.jsx)(ke,{}),conditional_format_signal_medium1_icon:(0,n.jsx)(Fe,{}),conditional_format_signal_low_icon:(0,n.jsx)(_e,{}),conditional_format_signal_empty_icon:(0,n.jsx)(Pe,{}),conditional_format_circle_filled_icon:(0,n.jsx)(Ne,{}),conditional_format_circle_75_icon:(0,n.jsx)(Me,{}),conditional_format_circle_half_icon:(0,n.jsx)(Oe,{}),conditional_format_circle_25_icon:(0,n.jsx)(De,{}),conditional_format_circle_empty_icon:(0,n.jsx)(Be,{}),conditional_format_quadrant_full_icon:(0,n.jsx)($e,{}),conditional_format_quadrant_75_icon:(0,n.jsx)(He,{}),conditional_format_quadrant_50_icon:(0,n.jsx)(Ue,{}),conditional_format_quadrant_25_icon:(0,n.jsx)(qe,{}),conditional_format_quadrant_empty_icon:(0,n.jsx)(Ve,{})}})};const We={[G.default.Nil]:[],[G.default.IconSet3Arrows]:["conditional_format_colored_arrow_up_icon","conditional_format_colored_arrow_right_icon","conditional_format_colored_arrow_down_icon"],[G.default.IconSet3ArrowsGray]:["conditional_format_grey_arrow_up_icon","conditional_format_grey_arrow_right_icon","conditional_format_grey_arrow_down_icon"],[G.default.IconSet4Arrows]:["conditional_format_colored_arrow_up_icon","conditional_format_colored_arrow_up_right_icon","conditional_format_colored_arrow_down_right_icon","conditional_format_colored_arrow_down_icon"],[G.default.IconSet4ArrowsGray]:["conditional_format_grey_arrow_up_icon","conditional_format_grey_arrow_up_right_icon","conditional_format_grey_arrow_down_right_icon","conditional_format_grey_arrow_down_icon"],[G.default.IconSet5Arrows]:["conditional_format_colored_arrow_up_icon","conditional_format_colored_arrow_up_right_icon","conditional_format_colored_arrow_right_icon","conditional_format_colored_arrow_down_right_icon","conditional_format_colored_arrow_down_icon"],[G.default.IconSet5ArrowsGray]:["conditional_format_grey_arrow_up_icon","conditional_format_grey_arrow_up_right_icon","conditional_format_grey_arrow_right_icon","conditional_format_grey_arrow_down_right_icon","conditional_format_grey_arrow_down_icon"],[G.default.IconSet3Triangles]:["conditional_format_triangle_high_icon","conditional_format_triangle_medium_icon","conditional_format_triangle_low_icon"],[G.default.IconSet3TrafficLights1]:["conditional_format_circle_high_icon","conditional_format_circle_medium_icon","conditional_format_circle_low_icon"],[G.default.IconSet3TrafficLights2]:["conditional_format_traffic_high_icon","conditional_format_traffic_medium_icon","conditional_format_traffic_low_icon"],[G.default.IconSet4TrafficLights]:["conditional_format_circle_high_icon","conditional_format_circle_medium_icon","conditional_format_circle_low_icon","conditional_format_4circle_low_icon"],[G.default.IconSet3Signs]:["conditional_format_circle_high_icon","conditional_format_sign_medium_icon","conditional_format_sign_low_icon"],[G.default.IconSet4RedToBlack]:["conditional_format_4circle_high_icon","conditional_format_4circle_medium2_icon","conditional_format_4circle_medium1_icon","conditional_format_4circle_low_icon"],[G.default.IconSet3Symbols]:["conditional_format_circle_symbol_high_icon","conditional_format_circle_symbol_medium_icon","conditional_format_circle_symbol_low_icon"],[G.default.IconSet3Symbols2]:["conditional_format_symbol_high_icon","conditional_format_symbol_medium_icon","conditional_format_symbol_low_icon"],[G.default.IconSet3Flags]:["conditional_format_flag_high_icon","conditional_format_flag_medium_icon","conditional_format_flag_low_icon"],[G.default.IconSet3Stars]:["conditional_format_star_high_icon","conditional_format_star_medium_icon","conditional_format_star_low_icon"],[G.default.IconSet4Rating]:["conditional_format_signal_low_icon","conditional_format_signal_medium1_icon","conditional_format_signal_medium2_icon","conditional_format_signal_high_icon"],[G.default.IconSet5Rating]:["conditional_format_signal_empty_icon","conditional_format_signal_low_icon","conditional_format_signal_medium1_icon","conditional_format_signal_medium2_icon","conditional_format_signal_high_icon"],[G.default.IconSet5Quarters]:["conditional_format_circle_filled_icon","conditional_format_circle_75_icon","conditional_format_circle_half_icon","conditional_format_circle_25_icon","conditional_format_circle_empty_icon"],[G.default.IconSet5Boxes]:["conditional_format_quadrant_full_icon","conditional_format_quadrant_75_icon","conditional_format_quadrant_50_icon","conditional_format_quadrant_25_icon","conditional_format_quadrant_empty_icon"]};let ze=!1;function je(e){let t,a;const o={},r=e.cfHitlItem.conditionalFormatResponseCardData.originalHexColors;null!=r&&(null!=r.minimumColor&&(o.minimumColor=r.minimumColor),null!=r.midpointColor&&(o.midpointColor=r.midpointColor),null!=r.maximumColor&&(o.maximumColor=r.maximumColor));const i=Object.keys(o).length,l=e.cfHitlItem.conditionalFormatResponseCardData.cardTitle,s=e.cfHitlItem.conditionalFormatResponseCardData.customFormat;switch(l){case I.D.CellValue:case I.D.Preset:case I.D.TopBottom:case I.D.TextComparison:case I.D.Dates:case I.D.UniqueValue:case I.D.CustomCreated:s&&(t=O(s));break;case I.D.ColorScale:2===i?t=D(o.minimumColor,o.maximumColor):3===i&&(t=D(o.minimumColor,o.maximumColor,o.midpointColor));break;case I.D.DataBar:{t=N;const n=e.cfHitlItem.conditionalFormatResponseCardData.dataBarFormat;if(n){const e=n.isGradientFill;a=B(n.fillColor,e)}break}case I.D.IconSet:ze||(Ge(),ze=!0);return function(e){const t=(o=We,r=e,i=[],r in o?o[r]:i),a=e=>(0,n.jsx)("div",{className:"conditional-formatting-response-card-icon-renderer","aria-label":ExcelCopilotCommandingHitlStrings.ConditionalFormattingSwatchAriaLabel,role:"img",children:e.map((e=>(0,n.jsx)(R.I,{iconName:e,className:"conditional-formatting-response-card-icon"},e)))});var o,r,i;if(t.length>0)return(0,n.jsx)("div",{children:a(t)});return(0,n.jsx)("div",{})}(e.cfHitlItem.conditionalFormatResponseCardData.iconSetNumber);default:(0,U.debuglog)("unknown ConditionalFormatResponseCardType while forming style")}const c=function(e){switch(e){case I.D.ColorScale:case I.D.DataBar:case I.D.IconSet:return!1;default:return!0}}(l);return(0,n.jsxs)("div",{className:"conditional-formatting-response-card-sample-text",style:t,"aria-label":ExcelCopilotCommandingHitlStrings.ConditionalFormattingSwatchAriaLabel,role:"img",children:[(0,n.jsx)("span",{hidden:!c,children:"AaBbCc"}),(0,n.jsx)("div",{hidden:c,style:a})]})}var Qe=a(365319),Je=a(984691),Ye=a(697705),Xe=a(95151),Ze=a(956258),Ke=a(797639),et=a(320378),tt=a.n(et);const at=/(#[a-fA-F0-9]{6})(?![a-zA-Z0-9])/g;function nt(e,t){const a=e.split(t);return(0,n.jsx)(v.E,{children:a.map(((e,o)=>(0,n.jsxs)(W.Fragment,{children:[e,o!==a.length-1&&(0,n.jsx)("b",{children:t})]},o)))})}function ot(e){return(0,n.jsxs)(Xe.StackV9,{children:[Ke.CP.getHumanInTheLoopRange()?nt(e.header,Ke.CP.getHumanInTheLoopRange()):(0,n.jsx)(v.E,{children:e.header}),(0,n.jsx)(Xe.StackV9,{children:(0,n.jsx)("ul",{children:e.events.map(((e,t)=>(0,n.jsx)(v.E,{block:!0,children:(0,n.jsx)("li",{children:e})},t)))})})]})}function rt(e){const t=e=>tt()(e,at,((e,t)=>function(e){const t=E();return(0,n.jsxs)("span",{children:[(0,n.jsx)("svg",{width:"10",height:"10",children:(0,n.jsx)("rect",{className:t.swatch,width:"10",height:"10",rx:4,style:{fill:e.fillColor,strokeWidth:1}})}),"",e.fillColor]},e.key)}({key:t,fillColor:e})));return(0,n.jsxs)(Xe.StackV9,{children:[(0,q.yw9)("OfficeVSO_8976811_BoldRangeHiTLCard")&&Ke.CP.getHumanInTheLoopRange()?nt(e.header,Ke.CP.getHumanInTheLoopRange()):(0,n.jsx)(v.E,{children:e.header}),(0,n.jsx)(Xe.StackV9,{children:(0,n.jsx)("ul",{children:e.listItems.map(((e,a)=>(0,n.jsx)(v.E,{block:!0,children:(0,n.jsxs)("li",{children:[e.title&&(0,n.jsx)("span",{style:{fontWeight:600},children:e.title}),t(e.text)]})},a)))})}),e.footer&&(0,n.jsx)(Xe.StackV9,{children:(0,n.jsx)(v.E,{children:e.footer})})]})}function it(e){const t=e=>{const t={cfHitlItem:e};if((0,q.GIC)())return je(t)},a=e=>{const t={cfHitlItem:e};if((0,q.ID5)())return function(e){const t=e.cfHitlItem.conditionalFormatResponseCardData.customFormula,a=e.cfHitlItem.conditionalFormatResponseCardData.formulaExplanation,o={isLoading:!a,isNotAvailable:!a,explanation:a,onFirstTimeExplanationShown:()=>{}},r=(0,q.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?k.q.ConditionalFormatting:k.q.Commanding;return(0,n.jsx)(L.$,{icon:"math",content:t,explanation:(0,q._NB)()?o:void 0,telemetryUsageFeatureName:r,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})}),ariaAttributes:{"aria-label":A.olU.FormulaSuggestion_FormulaSnippet_AriaLabel}})}(t)};return(0,n.jsxs)(Xe.StackV9,{children:[(0,q.yw9)("OfficeVSO_8976811_BoldRangeHiTLCard")&&Ke.CP.getHumanInTheLoopRange()?nt(e.header,Ke.CP.getHumanInTheLoopRange()):(0,n.jsx)(v.E,{children:e.header}),(0,n.jsx)(Xe.StackV9,{children:(0,n.jsxs)("ul",{children:[e.eventIntents.map((e=>(0,n.jsx)("li",{children:e},e))),e.cfHitlItems.map((e=>(0,n.jsxs)("li",{children:[(0,n.jsx)(v.E,{style:{fontWeight:"bold"},children:e.title}),e.explanation,(0,n.jsx)("ul",{children:e.subExplanations?.map((e=>(0,n.jsx)("li",{children:e},e)))}),(0,n.jsx)("div",{hidden:!(0,q.GIC)(),className:"conditional-formatting-response-card-swatch",children:t(e)}),(0,n.jsx)("div",{hidden:!(0,q.ID5)()||void 0===e.conditionalFormatResponseCardData.customFormula,className:"conditional-formatting-response-card-formula",children:a(e)})]},e.explanation)))]})})]})}const lt=(e,t)=>{if(Ke.CP.isContextLocked())return;const a=Ze.M.getInstance();Ye.B.getInstance().logKeptEvent(k.BJ.Commanding,k.q.ConditionalFormattingSuggestion,Je.RX.Command),a.logEvent((0,k.SV)(k.he.ConditionalFormattingSuggestionPillClicked,k.q.ConditionalFormattingSuggestion,k.KZ.ConditionalFormattingSuggestionPill,e.Key,t)),Qe.$.getInstance().submitUserQuery(e.Description)};function st(e){return(0,n.jsxs)(Xe.StackV9,{children:[(0,n.jsx)(v.E,{style:{paddingBottom:"8px"},children:e.header}),e.suggestions&&e.suggestions.length>0&&(0,n.jsx)("div",{style:{alignItems:"flex-start"},children:e.suggestions.map(((t,a)=>(0,n.jsx)(x.$,{className:"chat-conditional-formatting-suggestion-pill",onClick:()=>{lt(t,e.guid)},children:t.Description},a)))})]})}},231160:(e,t,a)=>{"use strict";a.d(t,{Q1:()=>p,gY:()=>b,i$:()=>s,oz:()=>c});var n=a(47262),o=a(944563),r=a(576583),i=a(215592),l=a(376116);const s=38,c=50;function d(e){return(0,r.n)({tablePreview:{marginTop:"12px",display:"flex"},numberRowColumn:{display:"flex",flexDirection:"column","& > :first-child":{...i.shorthands.borderTop("1px","solid",e.borderColor),borderStartStartRadius:"4px"},"& > :last-child":{borderEndStartRadius:"4px",...i.shorthands.borderBottom("1px","solid",e.borderColor)}},dataColumn:{display:"flex",flexDirection:"column",...i.shorthands.flex(1),...i.shorthands.borderTop("1px","solid",e.borderColor),...i.shorthands.borderBottom("1px","solid",e.borderColor),"& > :nth-child(2n+3)":{backgroundColor:e.dataBackgroundOdd},"&:last-child > *":{borderInlineEndWidth:"1px",borderInlineEndStyle:"solid",borderInlineEndColor:e.borderColor},"&:last-child":{borderStartEndRadius:"4px",borderEndEndRadius:"4px"}},numberRowCell:{display:"flex",alignItems:"center",justifyContent:"center",height:"20px",...i.shorthands.border("1px","solid",e.borderColor),...i.shorthands.borderTop(0),backgroundColor:e.rowColCellBackground,"& > *":{...i.shorthands.overflow("hidden"),whiteSpace:"nowrap",textOverflow:"ellipsis",...i.shorthands.padding("2px","4px"),...l.g.caption1,color:o.k1.colorNeutralForeground3}},dataColumnsContainer:{display:"flex",flexGrow:1,overflowX:"auto",overflowY:"hidden"},lastDataColumn:{"& > :first-child":{borderStartEndRadius:"4px"},"& > :last-child":{borderEndEndRadius:"4px"}},dataCell:{height:"20px",display:"flex",alignItems:"center",...i.shorthands.borderBottom("1px","solid",e.dataBorderHorizontalColor),borderInlineEndWidth:"1px",borderInlineEndStyle:"solid",borderInlineEndColor:e.dataBorderVerticalColor,backgroundColor:e.dataBackgroundEven,"&:last-child":{...i.shorthands.borderBottom("0px")}},dataCellTotal:{boxShadow:`0 0px 0 0 ${e.dataBorderHorizontalColor} inset, 0 1px 0 0 ${e.rowColCellBackground} inset, 0 2px 0 0 ${e.dataBorderHorizontalColor} inset`,"&:last-child":{backgroundColor:e.totalRowBackground}},contentDataCellTotal:{...l.g.caption1Strong},contentDataCell:{whiteSpace:"nowrap",textOverflow:"ellipsis",color:o.k1.colorNeutralForeground1,...i.shorthands.padding("2px","4px"),...i.shorthands.overflow("hidden"),...l.g.caption1},headerCell:{...i.shorthands.borderColor(e.borderColor),borderInlineEndWidth:"1px",borderInlineEndStyle:"solid",borderInlineEndColor:e.borderColor,backgroundColor:e.rowColCellBackground,justifyContent:"center",color:o.k1.colorNeutralForeground3,"& > *":{color:o.k1.colorNeutralForeground3}},headerCellBeforeSkip:{marginInlineEnd:"1px"},headerCellAfterSkip:{borderInlineStartStyle:"solid",borderInlineStartWidth:"1px"},columnTitleCell:{backgroundColor:e.titleBackground,"& > *":{color:e.titleForeground,...l.g.caption1Strong}}})}const u=d({rowColCellBackground:o.k1.colorNeutralBackground2,titleBackground:o.k1.colorCompoundBrandBackground,titleForeground:o.k1.colorNeutralForegroundInverted,dataBackgroundOdd:o.k1.colorBrandBackground2,dataBackgroundEven:o.k1.colorNeutralBackground1,totalRowBackground:o.k1.colorNeutralBackground1,borderColor:o.k1.colorNeutralStroke2,dataBorderVerticalColor:o.k1.colorBrandStroke2,dataBorderHorizontalColor:o.k1.colorBrandStroke2}),m=d({rowColCellBackground:o.k1.colorNeutralBackground4,titleBackground:o.k1.colorNeutralBackground6,titleForeground:o.k1.colorNeutralForeground1,dataBackgroundOdd:"unset",dataBackgroundEven:"unset",totalRowBackground:"unset",borderColor:o.k1.colorNeutralStroke1Selected,dataBorderVerticalColor:o.k1.colorNeutralStroke1,dataBorderHorizontalColor:o.k1.colorNeutralStroke1}),h=d({rowColCellBackground:o.k1.colorNeutralBackground3,titleBackground:o.k1.colorNeutralBackground6,titleForeground:o.k1.colorNeutralForeground1,dataBackgroundOdd:o.k1.colorNeutralBackground1,dataBackgroundEven:o.k1.colorNeutralBackground1,totalRowBackground:o.k1.colorNeutralBackground1,borderColor:o.k1.colorNeutralStroke1Selected,dataBorderVerticalColor:o.k1.colorNeutralStroke1,dataBorderHorizontalColor:o.k1.colorNeutralStroke1}),g=d({rowColCellBackground:"lightgreen",titleBackground:o.k1.colorCompoundBrandBackground,titleForeground:o.k1.colorNeutralForegroundInverted,dataBackgroundOdd:"lightblue",dataBackgroundEven:"deepskyblue",totalRowBackground:"green",borderColor:"red",dataBorderVerticalColor:"yellow",dataBorderHorizontalColor:"pink"});var p;function b(e){const t=h(),a=u(),o=(g(),m());switch(e){case 1:case 3:return t;case 2:return o;case 0:return a;default:return(0,n.x)(e)}}!function(e){e[e.grid=0]="grid",e[e.neutral=1]="neutral",e[e.neutralV2=2]="neutralV2",e[e.crazy=3]="crazy"}(p||(p={}))},233488:(e,t,a)=>{"use strict";a.r(t),a.d(t,{EntryPoint:()=>V,appLoadStartTime:()=>O,copilotPaneStartTimestamp:()=>B,copilotStringsLoaded:()=>$,isPublicApiInitialized:()=>H,officeOnReadyTime:()=>D});var n=a(725556),o=a(932367),r=a(754440),i=a(365319),l=a(267324),s=a(70100),c=a(688889),d=a(730953),u=a(528804),m=a(991869),h=a(208520);const g={root:{height:"100vh",width:"100vw",justifyContent:"center",alignItems:"center"}},p=()=>{let e;return(0,u.yw9)("OfficeVSO_9227275_RtlErrorScreen")&&(e=(0,m.xt)()?"rtl":"ltr"),(0,n.jsxs)(s.B,{styles:g,dir:e,children:[(0,n.jsx)(c.E,{variant:"large",children:(0,l.Oj_)()}),(0,n.jsx)(c.E,{variant:"medium",children:(0,l.RCr)()}),(0,n.jsx)("br",{}),(0,n.jsx)(d.j,{onClick:()=>{window.location.reload()},text:(0,l.BVL)()}),(0,n.jsx)("br",{})]})};var b=a(956258),f=a(758651);class C extends h.Component{static getDerivedStateFromError(e){return b.M.getInstance().logUncaughtException(e),{hasError:!0,error:e}}componentDidCatch(e,t){f.error(e,t)}render(){return this.state.hasError?(0,n.jsx)(p,{}):this.props.children}constructor(e){super(e),this.state={hasError:!1,error:void 0}}}var y=a(99394),v=a(911443),x=a(9847),T=a(887648),S=a(697705),w=a(476730),E=a(272487),I=a(797639),R=a(79458),A=a(371616),L=a(820633),k=a(348065),F=a(691097),_=a(804672),P=a(794329),N=a(479504),M=a(247967);const O=(new Date).getTime().toString();let D,B,$=!1,H=!1;const U=async()=>{Office.onReady((async e=>{e.addin?("Hidden"===e.addin.visibilityMode&&!(0,u.wQA)()&&(0,u.lSN)()&&q(),(0,u.At2)()&&(await L.u$.promise(),(0,E.getPreloadCopilot)()||(await A.So.promise(),I.CP.initPublic((0,k.KA)().dispatch),H=!0)),Office.addin.onVisibilityModeChanged((function(e){if((0,R.cY)(`Visibility_mode changed to  ${e.visibilityMode}`),e.visibilityMode===l.DwS){if(E._fShowPreloadedCopilot){const e=y.V.getSetting(y.z.CopilotPaneStartTimestamp);e&&S.B.getInstance().logUserCopilotPaneLoadTelemetry(e.toString(),x.CT.UserCopilotPaneLoadTime_PreloadTime,x.BJ.ShowPreloadedCopilot)}b.M.getInstance().releaseHeldTelemetryEvents();const e=i.$.getInstance();e.shouldScrollToBottom()&&e.scrollToBottom()}}))):((0,R.cY)("hostAndPlatform.addin is null"),await async function(){try{if(D=(new Date).getTime(),(0,N.Ok)(),w.E.getInstance().logPerformanceEntries(performance.getEntriesByType("resource")),new PerformanceObserver((e=>{w.E.getInstance().logPerformanceEntries(e.getEntries())})).observe({entryTypes:["navigation","resource"]}),B=(0,F.P)("copilotPaneStartTimestamp"),B)w.E.getInstance().logLatency(performance.timeOrigin-B,x.OP.OpenSdx);else{const e=(0,F.P)("StartTimeMs");e&&w.E.getInstance().logLatency(performance.timeOrigin-e,x.OP.OpenSdx)}(0,u.H_5)()&&await q(),await L.u$.promise(),(0,E.getPreloadCopilot)()||(await A.So.promise(),I.CP.initPublic((0,k.KA)().dispatch),H=!0)}catch(e){e instanceof v.DY&&(0,R.cY)(e.message),b.M.getInstance().logUncaughtException(e),b.M.getInstance().logStandardizedAshaErrorEvent(r.W.Copilot_Chat_Pane_Failed_To_Load,o.c.Pane_Crashed,x.BJ.CopilotChat),(0,u.yw9)("OfficeVSO_9680233_ErrorScreenHideShimmer")&&(0,_.sZ)(),(0,P.render)((0,n.jsx)(p,{}),document.getElementById("container"))}}())}))};async function q(){if($)return void(0,R.cY)("preload Strings already loaded");const e=(new Date).getTime();await(0,m.XX)();const t=((new Date).getTime()-e)/1e3;w.E.getInstance().logLatency(t,x.OP.LoadLocalizedStrings),$=!0}const V=h.memo((e=>(h.useEffect((()=>{U()}),[]),(0,n.jsx)("div",{children:(0,n.jsx)(C,{children:(0,n.jsx)(T.Kq,{store:(0,k.KA)(),children:(0,n.jsx)(M.A,{...e})})})}))))},235373:(e,t,a)=>{"use strict";a.d(t,{F:()=>w,m:()=>S});var n=a(267324),o=a(365319),r=a(371623),i=a(9847),l=a(83437),s=a(644476),c=a(476730),d=a(965634),u=a(956258),m=a(622807),h=a(797639),g=a(528804),p=a(14086),b=a(734e3),f=a(108869),C=a(804672),y=a(507628);const v={isExecuting:!1,showLoadingUI:!1,loadingStrings:(0,g.yw9)("OfficeVSO_9592556_InitialLoadingStringsEmpty")?[]:(0,n.ZYo)(!0),currentNLResult:void 0,currentNLResultVisualIndex:0,currentNLResultTableName:void 0,currentNLResultTableContext:void 0,isCurrentNLResultValid:!1,currentRecos:void 0,currentRecoIndex:0,suggestionList:[],executionStartTime:void 0,executingCommand:void 0,executingId:void 0,latestRequestId:void 0,lastUserPrompt:void 0,fillablePromptList:void 0,recentlyShownPrompts:[],nextSuggestionTypePriorities:[],isSkillResponseRequired:!1,zeroQueryTimeout:void 0,fluxExecutionStartTime:void 0,isDarkModeEnabled:!1,queryOriginByQueryId:{},onGridQueryCellAddressByQueryId:{},onGridQueryElseCategoryOverrideByQueryId:{},isInsertingFormulaSuggestion:!1,isPythonStartAnalysisButtonDisabled:!1,dataShapingState:{enableDebugging:!1,started:!1},singleModeState:{feature:"off"},zqmSuggestionList:[],lastPythonQueryId:void 0,isPythonMode:!1,isPythonThinkDeeperMode:!1},x=(e,t,a,n)=>{c.E.getInstance().logLatency((0,i.xJ)(t),e,a,n)},T=(0,s.Z0)({name:"chat",initialState:v,reducers:{startExecutingCommand:(e,t)=>{let a,r;e.executionStartTime&&e.executingCommand&&(e.executingCommand===i.OP.FluxReasoning&&t.payload.command!==i.OP.FluxReasoning&&t.payload.command!==i.OP.Search||u.M.getInstance().logError({eventType:d.S2.Latency,errorMessage:`Command ${e.executingCommand} was not stopped before starting ${t.payload.command}`,logLevel:l.$b.Warning}),x(e.executingCommand,e.executionStartTime)),e.executingCommand=t.payload.command,e.executionStartTime=(new Date).getTime(),e.executingId=t.payload.id;const s=h.CP.getActiveTable();s&&(a=(0,p.r)(s.address),(0,g.yw9)("OfficeVSO_9851580_AddSheetNameToLatencyString")&&(r=s.sheetRange.sheet));const c=(0,g.yw9)("OfficeVSO_9851580_AddSheetNameToLatencyString")&&(0,g.ZAR)()&&void 0!==r;switch(t.payload.command){case i.OP.AnalyzeData:e.loadingStrings=a?c?(0,n.x4R)().map((e=>e.replace("{range}",a).replace("{sheet}",r))):(0,n.uo4)().map((e=>e.replace("{0}",a))):(0,n.zZj)();break;case i.OP.InsertAnalyzeData:e.loadingStrings=(0,n.SUe)();break;case i.OP.CalculatedColumns:e.loadingStrings=a?c?(0,n.CP3)().map((e=>e.replace("{range}",a).replace("{sheet}",r))):(0,n.BaS)().map((e=>e.replace("{0}",a))):(0,n.wvg)();break;case i.OP.CalculatedCells:e.loadingStrings=a?c?(0,n.aaC)().map((e=>e.replace("{range}",a).replace("{sheet}",r))):(0,n.tJt)().map((e=>e.replace("{0}",a))):(0,n._lL)();break;case i.OP.InsertCalculatedColumn:e.loadingStrings=(0,n.M_1)();break;case i.OP.InsertCalculatedColumns:e.loadingStrings=(0,n.tZV)();break;case i.OP.InsertFormulaSuggestion:e.loadingStrings=(0,n.j9u)();break;case i.OP.InsertCalculatedCell:{const t=h.CP.calculatedFormulaInsertLocation??"",a=n.olU.CalculatedRowsCellHeader;e.loadingStrings=c?[n.olU.LoadingUIAddingCellWithAddressStepWithSheet.replace("{range}",a).replace("{cellAddress}",t).replace("{sheet}",r)]:[n.olU.LoadingUIAddingCellWithAddressStep.replace("{0}",a).replace("{cellAddress}",t)];break}case i.OP.InsertCalculatedCells:{const t=h.CP.calculatedFormulaInsertLocation??"",a=n.olU.CalculatedRowsRowHeader;e.loadingStrings=c?[n.olU.LoadingUIAddingCellsWithAddressStepWithSheet.replace("{range}",a).replace("{rowNumber}",t).replace("{sheet}",r)]:[n.olU.LoadingUIAddingCellsWithAddressStep.replace("{0}",a).replace("{rowNumber}",t)];break}case i.OP.UpdateCalculatedCell:{const t=h.CP.calculatedFormulaInsertLocation??"",a=n.olU.CalculatedRowsCellHeader;e.loadingStrings=c?[n.olU.LoadingUIAddingCellUpdateWithAddressStepWithSheet.replace("{range}",a).replace("{cellAddress}",t).replace("{sheet}",r)]:[n.olU.LoadingUIAddingCellUpdateWithAddressStep.replace("{0}",a).replace("{cellAddress}",t)];break}case i.OP.UpdateCalculatedCells:{const t=h.CP.calculatedFormulaInsertLocation??"",a=n.olU.CalculatedRowsRowHeader;e.loadingStrings=c?[n.olU.LoadingUIAddingCellsUpdateWithAddressStepWithSheet.replace("{range}",a).replace("{rowNumber}",t).replace("{sheet}",r)]:[n.olU.LoadingUIAddingCellsUpdateWithAddressStep.replace("{0}",a).replace("{rowNumber}",t)];break}case i.OP.ApplyDataShaping:e.loadingStrings=(0,n.znb)();break;case i.OP.ChartDesignRecommendations:e.loadingStrings=(0,n.$LK)();break;case i.OP.ApplyTLRAutoFix:case i.OP.Commanding:case i.OP.ConditionalFormatting:{const t=h.CP.getHumanInTheLoopRange();(0,g.k64)()&&t?e.loadingStrings=c?(0,n.YB4)().map((e=>e.replace("{range}",a).replace("{sheet}",r))):(0,n.xJ7)().map((e=>e.replace("{range}",t))):e.loadingStrings=a&&s?.tableLikeRange?c?(0,n.Bpz)().map((e=>e.replace("{range}",a).replace("{sheet}",r))):(0,n._9M)().map((e=>e.replace("{0}",a))):(0,g.geU)()?(0,n._73)():(0,n.XQw)();break}case i.OP.FluxGenerateResponse:e.loadingStrings=(0,n.De1)();break;case i.OP.SaveOfficeScripts:e.loadingStrings=n.UOv;break;case i.OP.CreateOfficeScripts:e.loadingStrings=n.XFR;break;case i.OP.PythonStartAnalysis:e.loadingStrings=(0,n.EwU)();break;case i.OP.PythonCellsCalculating:e.loadingStrings=(0,n.aDI)();break;case i.OP.EnterDataShapingMode:e.loadingStrings=(0,n.CcC)();break;case i.OP.ExitDataShapingMode:e.loadingStrings=(0,n.aRL)();break;case i.OP.ImportDataLoadQuery:e.loadingStrings=(0,n.w$T)();break;case i.OP.ImportDataRelevancyCheck:e.loadingStrings=(0,n.NLG)();break;case i.OP.ImportDataGenerateSuggestion:e.loadingStrings=(0,n.zDx)();break;case i.OP.PythonInsertingResultInNewSheet:e.loadingStrings=(0,n.Huq)();break;case i.OP.FluxReasoning:case i.OP.ActionAI:case i.OP.Search:default:h.CP.pythonContextManager.isPythonMode?e.loadingStrings=(0,n.T8g)():!(0,g.ZAR)()&&a?e.loadingStrings=c?(0,n.ZU3)().map((e=>e.replace("{range}",a).replace("{sheet}",r))):(0,n.w7p)().map((e=>e.replace("{0}",a))):e.loadingStrings=(0,n.ZYo)()}e.isExecuting=!0,e.showLoadingUI=!0,o.$.getInstance().startLoadingUi()},stopExecuting:(e,t)=>{e.executionStartTime&&x(e.executingCommand??i.OP.NoCurrentlyExecutingCommandSet,e.executionStartTime,t.payload?.isSuccess),e.isExecuting=!1,e.showLoadingUI&&!t.payload?.keepShowingLoadingUIIfAlreadyActive&&(e.showLoadingUI=!1),e.executingCommand=void 0,e.executionStartTime=void 0,e.executingId=void 0,e.zeroQueryTimeout&&(window.clearTimeout(e.zeroQueryTimeout),e.zeroQueryTimeout=void 0)},startInsertingFormulaSuggestion:e=>{e.isInsertingFormulaSuggestion=!0},stopInsertingFormulaSuggestion:e=>{e.isInsertingFormulaSuggestion=!1},hideLoadingUI:e=>{!0===e.showLoadingUI&&o.$.getInstance().stopLoadingUi(),e.showLoadingUI=!1},setSuggestionListDetails:(e,t)=>{h.CP.pythonContextManager.isPythonMode&&!t.payload.isPythonSuggestion||e.dataShapingState.started||(e.suggestionList=t.payload.suggestionList,e.nextSuggestionTypePriorities=t.payload.nextSuggestionTypePriorities??[],e.recentlyShownPrompts=[...e.recentlyShownPrompts,...t.payload.suggestionList.map((e=>e.suggestionText))])},setZqmSuggestionList:e=>{const t=(0,g.Z8j)("Microsoft.Office.Excel.FA000000124.GuaranteePythonSuggestion",0),a=0!==t&&(0,g.H2A)()&&((0,f.gx)()||(0,g.ggM)()&&(0,g.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&(0,f.XT)()),n=2===t,o=(0,g.Z8j)("Microsoft.Office.Excel.FA000000124.PromptSuggestionsToShow",3);a?(e.zqmSuggestionList=[...(0,C.R3)(Object.keys(m.Oc).filter((t=>!e.zqmSuggestionList.includes(t)&&(0,b._2)(t)))).slice(0,1),...(0,C.R3)(Object.keys(m.jH).filter((t=>!e.zqmSuggestionList.includes(t)&&(0,b._2)(t)))).slice(0,o-1)],n||(e.zqmSuggestionList=(0,C.R3)(e.zqmSuggestionList))):e.zqmSuggestionList=(0,C.R3)(Object.keys(m.w_).filter((t=>!e.zqmSuggestionList.includes(t)&&(0,b._2)(t)))).slice(0,o)},setNextSuggestionTypePriorities:(e,t)=>{e.nextSuggestionTypePriorities=t.payload},setRecentlyShownPrompts:(e,t)=>{e.recentlyShownPrompts=t.payload},clearSuggestionList:e=>{e.suggestionList=[]},setCurrentNLResultInvalid:e=>{e.isCurrentNLResultValid=!1},setLoadingStrings:(e,t)=>{e.loadingStrings=t.payload},incrementCurrentNLResultVisualIndex:e=>{e.currentNLResultVisualIndex++,e.currentNLResult?.visualAnswer&&e.currentNLResultVisualIndex+1>=e.currentNLResult.visualAnswer.length&&(e.suggestionList=e.suggestionList.filter((e=>"AnalyzeData_ShowMore"!==e.suggestionType)))},updateCurrentNLResult:(e,t)=>{e.isCurrentNLResultValid=t.payload.isCurrentNLResultValid,e.currentNLResult=t.payload.currentNLResult,e.currentNLResultVisualIndex=t.payload.currentNLResultVisualIndex,e.currentNLResultTableName=t.payload.tableName,e.currentNLResultTableContext=t.payload.tableContext},updateCurrentRecos:(e,t)=>{e.currentRecos=t.payload,e.currentRecoIndex=0},incrementRecoIndex:e=>{e.currentRecoIndex++},removeFirstSuggestionPill:e=>{e.suggestionList.length>0&&(e.suggestionList=e.suggestionList.slice(1))},setLatestRequestId:(e,t)=>{e.latestRequestId=t.payload},setZeroQueryTimeout:(e,t)=>{e.zeroQueryTimeout=t.payload},initializeSuggestionList:e=>{e.fillablePromptList=(0,r.zH)()},setIsDarkModeEnabled:(e,t)=>{e.isDarkModeEnabled=t.payload},setPythonStartAnalysisButtonDisabled:(e,t)=>{e.isPythonStartAnalysisButtonDisabled=t.payload},setQueryOriginByQueryId:(e,t)=>{const{queryId:a,queryOrigin:n}=t.payload;e.queryOriginByQueryId[a]=n},setOnGridQueryCellAddressByQueryId:(e,t)=>{const{queryId:a,onGridQueryCellAddress:n}=t.payload;e.onGridQueryCellAddressByQueryId[a]=n},setOnGridQueryElseCategoryOverrideByQueryId:(e,t)=>{const{queryId:a,elseCategoryOverride:n}=t.payload;e.onGridQueryElseCategoryOverrideByQueryId[a]=n},addDataShapingChatEntry:(e,t)=>{if(!e.dataShapingState.started)throw new Error("Data shaping mode is not started");e.dataShapingState.chatHistory.push(t.payload)},enterDataShapingMode:(e,t)=>{e.dataShapingState={enableDebugging:e.dataShapingState.enableDebugging,started:!0,disableQueryScriptUpdates:!1,baseScript:t.payload.queryScript,chatHistory:[],...t.payload}},exitDataShapingMode:e=>{e.dataShapingState={enableDebugging:e.dataShapingState.enableDebugging,started:!1}},enterSingleMode:(e,t)=>{e.singleModeState=t.payload},exitSingleMode:e=>{e.singleModeState={feature:"off"}},setDataShapingDebugging:(e,t)=>{e.dataShapingState.enableDebugging=t.payload},updateDataShapingQueryScript:(e,t)=>{if(!e.dataShapingState.started)throw new Error("Data shaping mode is not started");e.dataShapingState.queryScript=t.payload},setDisableQueryScriptUpdates:(e,t)=>{if(!e.dataShapingState.started)throw new Error("Data shaping mode is not started");e.dataShapingState.disableQueryScriptUpdates=t.payload},startNewPythonQuery:e=>{e.lastPythonQueryId=(0,y.A)()},setIsPythonMode:(e,t)=>{e.isPythonMode=t.payload},setIsPythonThinkDeeperMode:(e,t)=>{e.isPythonThinkDeeperMode=t.payload}}}),{actions:S,reducer:w}=T},236348:(e,t,a)=>{"use strict";a.d(t,{$h:()=>u,We:()=>p,hf:()=>g,lx:()=>h});var n=a(533972),o=a(689534),r=a(528804),i=a(827508),l=a(413777),s=a.n(l),c=a(731137),d=a(181704);async function u(e){const{sheetName:t,rangeAddress:a,entityName:n,entityType:o,columnIndex:r,filteredDataDisplayName:i,filterCriteria:l}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const i=e.workbook.worksheets.getItem(t).getRange(a);e.workbook[o].getItem(n).autoFilter.apply(i,r,l),await e.sync()})),h(i,l)}const m=(0,r.k64)()&&(0,r.yw9)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS");function h(e,t){const{filterOn:a,criterion1:l,color:u}=t;let h=m?ExcelCopilotCommandingHitlStrings.WorksheetDefaultFilterLabel:c.Intents.WorksheetDefaultFilterLabel;switch(a){case"CellColor":h=m?ExcelCopilotCommandingHitlStrings.WorksheetCellColorFilterLabel:c.Intents.WorksheetCellColorFilterLabel;break;case"FontColor":h=m?ExcelCopilotCommandingHitlStrings.WorksheetFontColorFilterLabel:c.Intents.WorksheetFontColorFilterLabel;break;case"Values":h=m?ExcelCopilotCommandingHitlStrings.WorksheetValuesFilterAppliedLabel:c.Intents.WorksheetValuesFilterAppliedLabel;break;case"Dynamic":h=m?ExcelCopilotCommandingHitlStrings.WorksheetDynamicFilterAppliedLabel:c.Intents.WorksheetDynamicFilterAppliedLabel;break;case"TopItems":h=m?ExcelCopilotCommandingHitlStrings.WorksheetTopItemsFilterLabel:c.Intents.WorksheetTopItemsFilterLabel;break;case"TopPercent":h=m?ExcelCopilotCommandingHitlStrings.WorksheetTopPercentFilterLabel:c.Intents.WorksheetTopPercentFilterLabel;break;case"BottomItems":h=m?ExcelCopilotCommandingHitlStrings.WorksheetBottomItemsFilterLabel:c.Intents.WorksheetBottomItemsFilterLabel;break;case"BottomPercent":h=m?ExcelCopilotCommandingHitlStrings.WorksheetBottomPercentFilterLabel:c.Intents.WorksheetBottomPercentFilterLabel;break;case"Custom":return function(e,t){if(!t.criterion1)return(0,d.A)(m?ExcelCopilotCommandingHitlStrings.WorksheetCustomFilterAppliedLabel:c.Intents.WorksheetCustomFilterAppliedLabel,{columnName:e});let a,n=m?o.O.UnhandledIntent:c.Intents.WorksheetCustomFilterAppliedLabel,{valueCompareType:l,value:u}=s().getCustomFilterCompareType(t.criterion1);if(t.criterion2)if((0,r.yw9)("OfficeVSO_9126157_FixTLRFilterBetween")){const{valueCompareType:e,value:n}=s().getCustomFilterCompareType(t.criterion2);a=n,l===i.default.IsGreaterThenOrEqualTo&&e===i.default.IsLessThanOrEqualTo&&t.operator===Excel.FilterOperator.and?l=i.default.IsBetween:l===i.default.IsLessThen&&e===i.default.IsGreaterThan&&t.operator===Excel.FilterOperator.or&&(l=i.default.IsNotBetween)}else a=s().getCustomFilterCompareType(t.criterion2)?.value;switch(l){case i.default.Equals:n=m?ExcelCopilotCommandingHitlStrings.TableColumnEqualsFilterLabel:c.Intents.TableColumnEqualsFilterLabel;break;case i.default.DoesNotEqual:n=m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEqualFilterLabel:c.Intents.TableColumnDoesNotEqualFilterLabel;break;case i.default.BeginsWith:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel2:c.Intents.TableColumnBeginsWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel1:c.Intents.TableColumnBeginsWithFilterLabel1;break;case i.default.DoesNotBeginWith:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel2:c.Intents.TableColumnDoesNotBeginWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel1:c.Intents.TableColumnDoesNotBeginWithFilterLabel1;break;case i.default.EndsWith:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel2:c.Intents.TableColumnEndsWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel1:c.Intents.TableColumnEndsWithFilterLabel1;break;case i.default.DoesNotEndWith:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel2:c.Intents.TableColumnDoesNotEndWithFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel1:c.Intents.TableColumnDoesNotEndWithFilterLabel1;break;case i.default.Contains:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel2:c.Intents.TableColumnContainsFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel1:c.Intents.TableColumnContainsFilterLabel1;break;case i.default.DoesNotContain:n=void 0!==a?m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel2:c.Intents.TableColumnDoesNotContainFilterLabel2:m?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel1:c.Intents.TableColumnDoesNotContainFilterLabel1;break;case i.default.IsGreaterThan:n=m?ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanFilterLabel:c.Intents.TableColumnIsGreaterThanFilterLabel;break;case i.default.IsGreaterThenOrEqualTo:n=m?ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanOrEqualToFilterLabel:c.Intents.TableColumnIsGreaterThanOrEqualToFilterLabel;break;case i.default.IsLessThen:n=m?ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanFilterLabel:c.Intents.TableColumnIsLessThanFilterLabel;break;case i.default.IsLessThanOrEqualTo:n=m?ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanOrEqualToFilterLabel:c.Intents.TableColumnIsLessThanOrEqualToFilterLabel;break;case i.default.IsBetween:n=m?ExcelCopilotCommandingHitlStrings.TableColumnBetweenFilterLabel:c.Intents.TableColumnBetweenFilterLabel;break;case i.default.IsNotBetween:n=m?ExcelCopilotCommandingHitlStrings.TableColumnNotBetweenFilterLabel:c.Intents.TableColumnNotBetweenFilterLabel;break;default:n=m?o.O.UnhandledIntent:c.Intents.WorksheetCustomFilterAppliedLabel}return(0,d.A)(n,{columnName:e,value1:u,value2:a})}(e,t);default:h=m?o.O.UnhandledIntent:c.Intents.WorksheetDefaultFilterLabel}return(0,d.A)(h,{range:e,criterion:l,color:m&&u?n.g.colorNameFromHEX(u):u})}async function g(e){const{entityName:t,entityType:a,columnIndex:n,changedDataDisplayName:o}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{e.workbook[a].getItem(t).autoFilter.clearColumnCriteria(n),await e.sync()})),(0,d.A)(c.Intents.WorksheetRangeClearFiltersLabel,{range:o})}async function p(e){const{entityName:t,entityType:a,changedDataDisplayName:n}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{e.workbook[a].getItem(t).autoFilter.clearCriteria(),await e.sync()})),(0,d.A)(c.Intents.WorksheetRangeClearFiltersLabel,{range:n})}},241273:(e,t,a)=>{"use strict";var n,o,r,i,l,s,c,d,u,m,h,g,p,b,f;a.d(t,{At:()=>p,Gm:()=>i,OZ:()=>d,T7:()=>f,YY:()=>u,ut:()=>n,zg:()=>m}),function(e){e[e.Unknown=0]="Unknown",e[e.Consumer=1]="Consumer",e[e.Enterprise=2]="Enterprise"}(n||(n={})),function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(o||(o={})),function(e){e.web="web",e.win32="win32",e.mac="mac"}(r||(r={})),function(e){e.defaultWhite="defaultWhite",e.defaultBlack="defaultBlack",e.defaultDarkGrey="defaultDarkGrey",e.themeColorful="themeColorful"}(i||(i={})),function(e){e.IN_PROGRESS="IN_PROGRESS",e.COMPLETED="COMPLETED",e.FAILED="FAILED",e.STARTED="STARTED",e.NONE="NONE"}(l||(l={})),function(e){e.InvalidSignal="PersonalizationInvalidSignalError",e.InvalidInput="PersonalizationInvalidInputError",e.RoamingServiceError="PersonalizationRoamingServiceError",e.OpenAITextClientError="PersonalizationOpenAITextClientError",e.SkillExecutionError="PersonalizationSkillExecutionError",e.OpenAIChatClientError="PersonalizationOpenAIChatClientError"}(s||(s={})),function(e){e.InvalidUserQuery="invalid-user-query",e.MissingProfileId="missing-profile-id",e.StaleProfileId="stale-profile-id",e.NotSupportedProfileOperation="not-supported-profile-operation",e.FailedToRead="failed-to-read",e.FailedToWrite="failed-to-write",e.UninitializedUserStoreEntities="uninitialized-user-store-entities",e.UndefinedUserStoreEntities="undefined-user-store-entities",e.NotAvailable="not-available",e.Timeout="timeout",e.Throttled="throttled",e.Token="token",e.Unknown="unknown",e.BadResponse="bad-response",e.UserThrottled="user-throttled",e.ScenarioThrottled="scenario-throttled",e.EmptyResponse="empty-response"}(c||(c={})),function(e){e.CLP_Get="CLP_Get",e.CLP_Upgrade="CLP_Upgrade"}(d||(d={})),function(e){e.ApplyLabelUnsupportedCrossTenantErrorCode="2147205120",e.ApplyLabelDocumentReadOnlyErrorCode="2147205119",e.ApplyLabelInsufficientPermissionErrorCode="2147205118",e.ApplyLabelLabelDisabledErrorCode="2147205117",e.ApplyLabelUnsupportedUdpErrorCode="2147205116",e.ApplyLabelLabelingDisabledErrorCode="2147205115",e.ApplyLabelUnsupportedContentTypeErrorCode="2147205114",e.ApplyLabelUnsupportedDkeErrorCode="2147205113",e.ApplyLabelLabelNotFoundErrorCode="2147205112",e.OsfControlContainerErrorCode="2147205111",e.OfficeSolutionFrameworkHostErrorCode="2147205110",e.DocCookieErrorCode="2147205109",e.HostIntegrationManagerErrorCode="2147205108",e.MsoOLDocumentErrorCode="2147205107",e.ClpSessionErrorCode="2147205106",e.ApplyLabelNewLabelSensitivityOrderErrorCode="2147205105",e.OMWorkflowUserNotFoundErrorCode="2147220727",e.OMOfficePerpetualNotSupportedErrorCode="2147220726",e.LabelingDisabledProtectedViewErrorCode="2147205104",e.LabelingDisabledAppguardErrorCode="2147205103",e.LabelingDisabledPrivacySettingsErrorCode="2147205102",e.LabelingDisabledUnsupportedLabelClientErrorCode="2147205101",e.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode="2147205100",e.OMOfficeClientNotLicensedForLabelingErrorCode="2147220725",e.PolicyManagerUnavailableErrorCode="2147942488",e.ErrorCode2147647531="2147647531",e.ErrorCode2147500033="2147500033"}(u||(u={})),function(e){e.Ack="Ack",e.CloseEvent="CloseEvent",e.OnItemSelected="OnItemSelected",e.OnErrorInLoading="OnErrorInLoading"}(m||(m={})),function(e){e.Image="IMAGE",e.Video="VIDEO"}(h||(h={})),function(e){e.KeepIt="KeepIt",e.Undo="Undo",e.Insert="Insert",e.Copy="Copy",e.Custom="Custom",e.CustomiPad="CustomiPad",e.None="None"}(g||(g={})),function(e){e.Activated="Activated",e.Removed="Removed",e.ActivateCopilotAgent="activateCopilotAgent",e.RemoveCopilotAgent="removeCopilotAgent"}(p||(p={})),function(e){e.BizchatHostContextUpdate="BizChatHostContextUpdate"}(b||(b={})),function(e){e[e.LaunchMos=2001]="LaunchMos",e[e.GetFullDocumentHtml=2003]="GetFullDocumentHtml",e[e.InvokeCanvasTool=2004]="InvokeCanvasTool",e[e.ReadAloud=2005]="ReadAloud"}(f||(f={}))},245307:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(171755),o=a.n(n),r=a(982649),i=a.n(r)()(o());i.push([e.id,"/* Common properties */\nbutton.chat-conditional-formatting-suggestion-pill {\n  margin-bottom: 10px;\n  display: inline-block;\n  padding: 4px 8px; /* Shorthand for padding-top, padding-bottom, padding-left, and padding-right */\n  text-align: start;\n  background-color: var(--colorNeutralBackground1);\n  border-color: var(--colorNeutralStroke1);\n  color: var(--colorNeutralForeground1);\n}\n","",{version:3,sources:["webpack://./src/frontend/styles/CommandingChatCard.css"],names:[],mappings:"AAAA,sBAAsB;AACtB;EACE,mBAAmB;EACnB,qBAAqB;EACrB,gBAAgB,EAAE,+EAA+E;EACjG,iBAAiB;EACjB,gDAAgD;EAChD,wCAAwC;EACxC,qCAAqC;AACvC",sourcesContent:["/* Common properties */\nbutton.chat-conditional-formatting-suggestion-pill {\n  margin-bottom: 10px;\n  display: inline-block;\n  padding: 4px 8px; /* Shorthand for padding-top, padding-bottom, padding-left, and padding-right */\n  text-align: start;\n  background-color: var(--colorNeutralBackground1);\n  border-color: var(--colorNeutralStroke1);\n  color: var(--colorNeutralForeground1);\n}\n"],sourceRoot:""}]);const l=i},247967:(e,t,a)=>{"use strict";a.d(t,{D:()=>Ic,A:()=>Rc});var n=a(725556),o=a(79458),r=a(528804);class i{static getInstance(){return i.instance||(i.instance=new i),i.instance}async init(){this.awsAnthropicKeys=await this.calcAwsAnthropicKeys(),this.anthropicKey=await this.calcAnthropicKey()}getAwsAnthropicKeys(){return(0,r.u5T)()?this.awsAnthropicKeys:[]}getAnthropicKey(){return(0,r.u5T)()?"":this.anthropicKey}hexStringToArrayBuffer(e){if((e=e.replace(/[^a-fA-F0-9]/g,"")).length%2!=0)throw new Error("Invalid hex string");const t=new ArrayBuffer(e.length/2),a=new Uint8Array(t);for(let t=0;t<e.length;t+=2){const n=e.substring(t,t+2);a[t/2]=parseInt(n,16)}return t}async decryptData(e,t){const a=await window.crypto.subtle.decrypt({name:this.algorithmName},e,t);return(new TextDecoder).decode(a)}async decryptKeys(e,t){let a=(0,r.CyP)();if(0===a.length)return[];a+="f5c98a0709893c84e2c6478da1b4b0a05c015dbef47721255d0905e421ef836a9516b3bdb81171ef596b3920b9193f4a3e94c30b020301000102818021920186cd1efd522ba20d0cd6bcabff78769bc07fb8b0eb2daca4ca14317035af68c3981474a370d3be51af692c111bafb76d1d08b265550a9ff104c6fd2087c5a2184b2f4b7a3438ea4bd884a457b2436fab8efd384b088bc1e33d6817af08a112ef4cd3eb66b984183a2d6cb8f32c1f368ecd8bf8de40daa5783e6e004491024100f31181cf957fae6312dd443e6d8be4ceb296de33a4983c90fbd80fea6af6ba100e37ce3591562b82530338505290e5d3fd0a3f13a4711264f9c12938a57babf3024100dda50c399ebf308aecf04df55f920fca7c5522764810dd2ed819767cb4ccdabd5a3f37843dcdf8292c59544f6a997651d351c120b5be0fcdb94365a18568ca8902401d09695d77f981c69a194eaeba7d6cbef87ca75cb9fbe9b8542d9271298801e02b22a582a6b3098d8f0722720dfafb49a0bfd99b2a18cbdebe2b42165f466fdb0240379ddbc475a62a0b224b667484e7c4d89d7c4b6a7cc8e68783a8580810e23a9d3b1113e0361602086add7b7f76134e1258417281bfb912841fd1dea5ba31426902404a52f02643b685ff70b176f6ed340d3f7107bf1bf63b3588a57da21e44b5cee7143a5a9316eb1f3437abc844e54b7ab96326042a79de7f650614405145daadf8";try{const n=await window.crypto.subtle.importKey("pkcs8",this.hexStringToArrayBuffer(a),{name:this.algorithmName,hash:"SHA-256"},!0,["decrypt"]),o=await this.decryptData(n,this.hexStringToArrayBuffer(e)),r=await this.decryptData(n,this.hexStringToArrayBuffer(t));return[o.toString(),r.toString()]}catch(e){return(0,o.cY)("MCP: Error getting Anthropic keys - ",e),[]}}async calcAwsAnthropicKeys(){(0,o.cY)("MCP: Compute AWS Anthropic keys");return this.decryptKeys("4242967b086c40eba39e223560222a30b6e4282b6dad995c44a3fa96d37b99586304ee46ff95fb1b90c0b62217fcc6997ae6bb9f3c2abfe4b940ce3e240248ec7cb7023174e0e2af88ddc2b88c6ac6db17a22d9782186e47c862d78f880e4b83681665e618546faa4ce7b6c2b1eb1143513fb3e895acd02e48f6e900a6f781df","5941633fc38f8ea62958706f2c1143af60f6a54e7945b8dee7e61bad71bf67707aa0b4ab9ca3edefad8b945488d9ba61853d0b16f9d0bc5d4981b507b48446cb481b7c0f48a98663fe3dd49cdf3adddcdc7efde29a0e693a3b25ba9100551741baa849915bf4f9f2251b1f478bd5842756201c647c1d94048f622abbbc3680ad")}async calcAnthropicKey(){(0,o.cY)("MCP: Compute Anthropic key");const e=await this.decryptKeys("01725e534f0ba5169a126d8f44718b88690996d9b3bfba6f956e6c0d3f7d55f576485bd3d7e0b19643fc97c34d51e7684b4bd4b26db7088ce5dc0671d37a89c317828213a7a5bf94a67d638b879548ee72f3ef444a61c8344da8100bea48915e11b93f2bea31ea950a99f4a3390bdd5d64a27f75eec84fe3b21ccf96725c6bc0","1d06c4b96816a60143bf9776c2f7fa3fc5a92197f07e6ce0ecf433e6a0011f65298c4386b993350c34c2c2ba6399418cb7742b8b0bfa610cd70d2c2f197eeab639c7017405d3468ac159f89214e5052c40b24a89e138124a59ac53839f580402c3873642722f7cc0e0e4c63f2c621ffa8ed2ac798764e2ce25757465936ae6b8");return 2!==e.length?"":e[0]+e[1]}constructor(){this.algorithmName="RSA-OAEP",this.awsAnthropicKeys=[],this.anthropicKey=""}}var l,s=a(365319),c=a(637211);!function(e){e.Licensed="Licensed",e.MultiAccessDisabledByAdmin="MultiAccessDisabledByAdmin"}(l||(l={}));var d=a(267324),u=a(576583),m=a(546762),h=a(932111),g=a(241273),p=a(95151),b=a(609029),f=a(551134),C=a(944563),y=a(932367),v=a(754440),x=a(9847),T=a(476730),S=a(956258);async function w(e,t){const a=(new Date).getTime();await Excel.run({delayForCellEdit:e},(async e=>{e.workbook.settings.onSettingsChanged.add((()=>Excel.run({delayForCellEdit:(0,r.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit")},(async e=>{const a=function(e,t){const a=e.getItemOrNullObject(t);return a.load("isNullObject,value"),a}(e.workbook.settings,"setState");await e.sync(),a.isNullObject||((0,o.cY)("Setting changed: state: "+JSON.stringify(a.value)),t(Number(a.value.copilotState),a.value.augLoopId),a.delete())}))))})),await E("OnLoad"),(0,r.yw9)("OfficeVSO_9513283_getDurationOfPrivateHostMessaging")&&T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:x.a5.InitializePrivateHostMessagingDuration,[x.h3.ChatEventParameters]:((new Date).getTime()-a).toString()})}async function E(e){const t={cmdType:e};(0,o.cY)("Sending message to host: "+JSON.stringify(t)),await Excel.run({delayForCellEdit:(0,r.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit")},(async e=>{e.workbook.settings.add("msgToExcel",t)}))}var I=a(310681),R=a(208520);const A=(0,u.n)({chatUiStack:{position:"absolute",top:"5px",bottom:"5px",left:"0",right:"0",backgroundColor:"transparent"}});const L=({copilotState:e})=>e&c.$.DisabledThirdPartyHost?(0,n.jsx)(p.TipCard,{headerText:(0,d.DyN)(),descriptionTextList:[(0,d.gk_)()],icon:(0,b.A)(f.wrX,f.UhZ)}):(e&(c.$.DisabledNewWorkbook|c.$.DisabledAutoSaveOff|c.$.DisabledLocalFile))!==c.$.Enabled?(0,n.jsx)(p.TipCard,{headerText:(0,d.tDq)(),descriptionTextList:[(0,d.USL)()],buttonTitle:(0,d.mT9)(),onClick:()=>{E("EnableAutoSave")},icon:(0,b.A)(f.wrX,f.UhZ)}):(0,r.yw9)("OfficeVSO_9854459_UpdateErrorMessageForUnsupportedFileState")&&e&c.$.DisabledSharedLock?(0,n.jsx)(p.TipCard,{headerText:d.olU.FileStateUnsupportedTitle,descriptionTextList:[(0,n.jsxs)(m.E,{block:!0,children:[d.olU.FileStateUnsupportedMessage,(0,n.jsx)("div",{style:{marginTop:"16px"},children:(0,n.jsx)(h.N,{href:d.Fxc,target:"_blank",style:{textDecoration:"underline"},children:d.olU.FileStateUnsupportedLearnMoreLinkText})})]},"unsupported-file-state-message")],icon:(0,b.A)(f.wrX,f.UhZ)}):(0,r.yw9)("OfficeVSO_9185107_DisabledDialogSheetError")&&e&c.$.DisabledDialogSheetExists?(0,n.jsx)(p.TipCard,{headerText:(0,d.v01)(),descriptionTextList:[(0,d.UEB)()],icon:(0,b.A)(f.wrX,f.UhZ)}):!(0,r.yw9)("OfficeVSO_9854459_UpdateErrorMessageForUnsupportedFileState")&&e&c.$.DisabledSharedLock||e&c.$.DisabledAugLoopPermanentError?(0,n.jsx)(p.TipCard,{headerText:(0,d.Vx2)(),descriptionTextList:[(0,d.HTR)()],icon:(0,b.A)(f.wrX,f.UhZ)}):(window.document.getElementById(d.OsU)?.style.removeProperty("display"),(0,n.jsx)("div",{})),k=({copilotState:e,theme:t,isHighContrast:a})=>{const[o,r]=R.useState((0,C.eS)(t,a)),i=A();return R.useEffect((()=>{t!==g.Gm.defaultWhite?(0,p.setClientThemeType)(g.Gm.defaultBlack):(0,p.setClientThemeType)(g.Gm.defaultWhite),(0,p.setIsHighContrastEnabled)(a),r((0,C.eS)(t,a))}),[t,a]),R.useEffect((()=>(s.$.getInstance().clearLoadingPaneTimeout(),(0,I.oO)((new Date).getTime().toString()),()=>{s.$.getInstance().startLoadingPaneTimeout(!0),(0,I.Gr)((new Date).getTime().toString())})),[]),(0,n.jsx)(p.ThemeProvider,{theme:o,children:(0,n.jsx)(p.StackV9,{reverse:!0,style:i.chatUiStack,children:(0,n.jsx)(L,{copilotState:e})})})};var F=a(374522),_=a.n(F),P=a(83643),N=a.n(P),M=a(964185),O=a.n(M),D=a(612290),B=a.n(D),$=a(462478),H=a.n($),U=a(101971),q=a.n(U),V=a(817560),G={};G.styleTagTransform=q(),G.setAttributes=B(),G.insert=O().bind(null,"head"),G.domAPI=N(),G.insertStyleElement=H();_()(V.A,G);V.A&&V.A.locals&&V.A.locals;var W,z,j,Q=new(function(){function e(e){this.value=e,this.listeners=new Set}return e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){return t.listeners.delete(e)}},e.prototype.setValue=function(e){this.value!==e&&(this.value=e,this.listeners.forEach((function(t){return t(e)})))},e.prototype.getValue=function(){return this.value},e}())({iteration:0}),J=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Y=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},X=a(207545),Z=a(702864),K=a(464363),ee=a(618384),te=a(265167),ae=a(477543),ne=a(426689),oe=a(83437),re=a(660606),ie=a(329416),le=a(423905),se=a(638753),ce=a(822606),de=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},ue=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function me(e){return de(this,void 0,void 0,(function(){var t;return ue(this,(function(a){switch(a.label){case 0:return(0,re.cY)("Activating User Context Annotation"),function(){(0,re.cY)("Fetching AL Session");var e=X.kH.getSettingAsString(X.zj.AugloopSharedSessionID);z=(0,ie.wB)((0,se.hX)(e)?"ALDummySession":e)}(),[4,z.activateAnnotation(K.i.getTypeName(),{callback:function(t){return function(e,t){(0,re.cY)("Entering user Context Annotation handler"),re.EG.updateTelemetryOnAnnotationReceived(K.i.getTypeName(),void 0,oe.CT.UserContextResponseTime,ce.u1,void 0,j);for(var a=0,n=e.items;a<n.length;a++){var o=n[a];o.body&&K.i.typeGuard(o.body)&&ge(o,t)}}(t,e)}})];case 1:return t=a.sent(),W=t.token,(0,re.cY)("User Context Annotation activated with token: "+W),[2]}}))}))}function he(){return de(this,void 0,void 0,(function(){var e;return ue(this,(function(t){switch(t.label){case 0:(0,re.cY)("Releasing User Context Annotation with token: "+W),t.label=1;case 1:return t.trys.push([1,3,,4]),[4,z.releaseAnnotation(W)];case 2:return t.sent(),[3,4];case 3:return e=t.sent(),(0,re.cY)("Error while releasing User Context Annotation: "+e),[3,4];case 4:return(0,re.cY)("User Context Released"),[2]}}))}))}function ge(e,t){return de(this,void 0,void 0,(function(){var a,n,o,r,i;return ue(this,(function(l){switch(l.label){case 0:return(0,re.cY)("Entering user Context Annotation item handler"),e.body?(a=e.body.userType,(0,re.cY)("User Type returned is: ",a),n=null===(i=e.body)||void 0===i?void 0:i.isEUDBUser,(0,re.cY)("isEUDBUser returned is: ",n),a?(re.EG.sendChatEventTelemetry((0,le.pN)(((o={})[oe.h3.ChatEventType]=oe.a5.ALUserType,o[oe.h3.ChatEventParameters]=(0,se.nh)(a),o))),t(a,n),[4,he()]):[3,2]):[2];case 1:return l.sent(),(0,re.cY)("User Context Annotation Released"),[3,3];case 2:re.EG.sendChatEventTelemetry((0,le.pN)(((r={})[oe.h3.ChatEventType]=oe.a5.ALUserType,r[oe.h3.ChatEventParameters]="UserTypeNotFound",r))),l.label=3;case 3:return[2]}}))}))}var pe=a(350005),be=a(429721),fe=a(764081),Ce=function(){var e=new URL(window.location.href),t=e.pathname.split("/"),a=t.length-1;return t[a].endsWith(".html")&&(t[a]="msgExtDialog.html"),e.pathname=t.join("/"),e.toString()},ye=function(e){var t;if("number"==typeof e)return e;if("string"==typeof e){var a=parseInt(e,10);if(!isNaN(a))return a;return null!==(t={large:-3,medium:-2,small:-1}[e.toLowerCase()])&&void 0!==t?t:-2}return-2},ve=function(e,t){return Math.floor(e/t*100)},xe=function(e){var t,a;return null!==(a=((t={})[-1]=fe.yT,t[-2]=fe.ag,t[-3]=fe.Nz,t)[e])&&void 0!==a?a:fe.ag},Te=function(e){var t,a;return null!==(a=((t={})[-1]=fe.fH,t[-2]=fe.$H,t[-3]=fe.qj,t)[e])&&void 0!==a?a:fe.$H},Se=function(e){var t={appId:"",botId:"",cardId:""};if(!(null==e?void 0:e.cardData))return(0,re.cY)("msgExtension Utils: cardData is not present in taskModuleProps"),t;try{var a=JSON.parse(e.cardData);t={appId:a.appId,botId:a.botId,cardId:a.cardId}}catch(e){(0,re.cY)("msgExtension Utils: Failed to extract cardId from cardData")}return t},we=function(){return we=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},we.apply(this,arguments)},Ee=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Ie=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},Re=function(){function e(){var t=this;if(this.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},this.taskModuleProps=void 0,this.shouldDisplayDismissIcon=!0,this.startTime=0,this.setProxyOperator=function(e){t.executePluginOperation=e},this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:null,cardId:"",triggeringActionTitle:""},(0,re.cY)("MsgExtDialogLauncher : Task Module dialog closed")},this.logDialogTelemetry=function(e,a){var n=Date.now();(0,le.js)(n-t.startTime,e,null!=a?a:""),e||(0,le.jC)(null!=a?a:"")},this.onMessageCallback=function(a){return Ee(t,void 0,void 0,(function(){var t,n,o,r,i,l,s,c,d,u,m,h,g,p;return Ie(this,(function(b){switch(b.label){case 0:return this.openedDialog.dialog?(t=JSON.parse(a)).type!==pe.o.Ack?[3,1]:(n=Se(this.taskModuleProps),r={dialogContent:null===(u=this.taskModuleProps)||void 0===u?void 0:u.dialogContent,appDefinition:null===(m=this.taskModuleProps)||void 0===m?void 0:m.appDefinition,clientInfo:null===(h=this.taskModuleProps)||void 0===h?void 0:h.clientInfo,shouldDisplayDismissIcon:this.shouldDisplayDismissIcon,cardInfo:n,hostConfigFlags:null===(g=this.taskModuleProps)||void 0===g?void 0:g.hostConfigFlags,copilotChatThemev2:e.theme,source:"AppChat"},this.openedDialog.dialog.messageChild(JSON.stringify(r),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0),[3,6]):(this.logDialogTelemetry(!1,"MsgExtDialogLauncher.onMessageCallback : No active dialog found"),[2]);case 1:return t.type!==pe.o.CloseEvent?[3,2]:(this.closeActiveDialog(),[3,6]);case 2:if(t.type!==pe.o.onServiceRequest)return[3,6];null===(p=re.EG.setQueryGuid)||void 0===p||p.call(re.EG,t.requestId),(0,re.cY)("MsgExtDialogLauncher : Received service request from dialog",t),o={requestId:t.requestId,serviceName:t.serviceName,apiName:t.apiName},re.EG.sendChatEventTelemetry((0,le.pN)(((s={})[oe.h3.ChatEventType]=oe.a5.TaskModuleServiceRequest,s[oe.h3.ChatEventParameters]=JSON.stringify(o),s))),r={requestId:t.requestId,messageType:pe.o.onServiceResponse,serviceName:t.serviceName,apiName:t.apiName,result:void 0},b.label=3;case 3:return b.trys.push([3,5,,6]),[4,this.executePluginOperation(t.serviceName,t.apiName,t.requestData)];case 4:return(i=b.sent())&&(r.result=i),(0,re.cY)("MsgExtDialogLauncher: Received response from ".concat(t.serviceName,"-").concat(t.apiName," for requestId ").concat(t.requestId)),re.EG.sendChatEventTelemetry((0,le.pN)(((c={})[oe.h3.ChatEventType]=oe.a5.TaskModuleServiceResponse,c[oe.h3.ChatEventParameters]=JSON.stringify(o),c))),this.openedDialog.dialog.messageChild(JSON.stringify(r),{targetOrigin:window.location.origin}),[3,6];case 5:return l=b.sent(),(0,re.cY)("MsgExtDialogLauncher : Error executing plugin operation",l),re.EG.sendErrorTelemetry((0,le.pN)(((d={})[oe.IC.ErrorMessage]=JSON.stringify(we(we({},o),{error:l})),d[oe.IC.ErrorCategory]=oe.S2.ExtensibilityDialog,d[oe.IC.ErrorCode]="".concat(t.serviceName,"-").concat(t.apiName),d))),[3,6];case 6:return[2]}}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return null!==t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var a;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(!(null===(a=t.taskModuleProps)||void 0===a?void 0:a.triggeringActionTitle)||t.openedDialog.triggeringActionTitle===t.taskModuleProps.triggeringActionTitle))},this.onDialogError=function(e){var a="Error opening dialog";if(e)try{a=JSON.stringify(e)}catch(e){(0,re.cY)("MsgExtDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"MsgExtDialogLauncher : ".concat(a))},this.openDialogForWebPlatformAsNewWindow=function(e,a){return Ee(t,void 0,void 0,(function(){var t,n,o=this;return Ie(this,(function(r){switch(r.label){case 0:if(this.shouldDisplayDismissIcon=!1,t=Se(this.taskModuleProps).cardId,this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return n=Ce(),[4,Office.context.ui.displayDialogAsync(n,{displayInIframe:!1,hideTitle:!0,height:e,width:a,promptBeforeOpen:!1},(function(e){return Ee(o,void 0,void 0,(function(){var a,n,o=this;return Ie(this,(function(r){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(n=null===(a=this.taskModuleProps)||void 0===a?void 0:a.triggeringActionTitle)&&void 0!==n?n:""},this.openedDialog.dialog.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return Ee(o,void 0,void 0,(function(){return Ie(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),this.openedDialog.dialog.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return Ee(o,void 0,void 0,(function(){return Ie(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return r.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,a){return Ee(t,void 0,void 0,(function(){var t,n,o,r=this;return Ie(this,(function(i){return this.shouldDisplayDismissIcon=!1,t=Ce(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(o=null===(n=this.taskModuleProps)||void 0===n?void 0:n.dialogTitle)&&void 0!==o?o:ce.$9,hideTitle:!0,height:e,width:a,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){r.openedDialog.dialog=e})).catch((function(e){r.onDialogError(e),(0,re.cY)("MsgExtDialogLauncher : Error displaying  Task Module dialog",e)})),[2]}))}))},this.launchTaskModule=function(e){return Ee(t,void 0,void 0,(function(){var t,a,n,o;return Ie(this,(function(r){return this.startTime=Date.now(),this.taskModuleProps=e,0,0,n=function(e){var t,a;if(e.viewMode!==fe.oY)return{dialogHeight:fe.Qt,dialogWidth:fe.Qt};var n=ye(null===(t=e.dialogContent)||void 0===t?void 0:t.height),o=ye(null===(a=e.dialogContent)||void 0===a?void 0:a.width),r=!0,i=!0,l=fe.t9,s=fe.OY;n<=0&&(i=!1,l=Te(n)),o<=0&&(r=!1,s=xe(o));var c=screen.width,d=screen.height;return i&&(l=ve(n,d)),r&&(s=ve(o,c)),{dialogHeight:l,dialogWidth:s}}(e),t=n.dialogHeight,a=n.dialogWidth,(null===(o=e.clientInfo)||void 0===o?void 0:o.clientType)===be.WK.web?this.openDialogForWebPlatformAsNewWindow(t,a):this.openDialogForNativePlatform(t,a),[2,Promise.resolve({status:"Success"})]}))}))},e.instance)return e.instance;e.instance=this}return e.getInstance=function(){return e.instance||new e},e.setTheme=function(t){e.theme=t},e}(),Ae=a(329739),Le=a(325251),ke=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Fe=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},_e=function(){function e(){var t=this;this.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},this.dialogProps=void 0,this.startTime=0,this.msalAccountInfo=null,this.closeActiveDialog=function(){t.openedDialog.dialog&&t.openedDialog.dialog.close(),t.openedDialog={dialog:void 0,cardId:"",triggeringActionTitle:""},(0,re.cY)("ExtensibilityDialogLauncher : Extensibility Dialog closed")},this.logDialogTelemetry=function(e,a){var n=Date.now();(0,le.js)(n-t.startTime,e,null!=a?a:""),e||(0,le.jC)(null!=a?a:"")},this.onMessageCallback=function(a){return ke(t,void 0,void 0,(function(){var t,n,o,r,i,l,s;return Fe(this,(function(c){return this.openedDialog.dialog?((t=JSON.parse(a)).type===pe.o.Ack?(n={dialogContent:null===(o=this.dialogProps)||void 0===o?void 0:o.dialogContent,appDefinition:null===(r=this.dialogProps)||void 0===r?void 0:r.appDefinition,clientInfo:null===(i=this.dialogProps)||void 0===i?void 0:i.clientInfo,cardInfo:null===(l=this.dialogProps)||void 0===l?void 0:l.card,hostConfigFlags:null===(s=this.dialogProps)||void 0===s?void 0:s.hostConfigFlags,copilotChatThemev2:e.theme,source:"BizChat",msalAccountInfo:this.msalAccountInfo},this.openedDialog.dialog.messageChild(JSON.stringify(n),{targetOrigin:window.location.origin}),this.logDialogTelemetry(!0)):t.type===pe.o.CloseEvent&&this.closeActiveDialog(),[2]):(this.logDialogTelemetry(!1,"ExtensibilityDialogLauncher.onMessageCallback : No active dialog found"),[2])}))}))},this.onCloseCallback=function(){t.closeActiveDialog()},this.isDialogActive=function(){return!!t.openedDialog.dialog},this.shouldCloseActiveDialog=function(e){var a,n;return!(t.openedDialog.cardId&&t.openedDialog.cardId===e&&(null===(n=null===(a=t.dialogProps)||void 0===a?void 0:a.action)||void 0===n?void 0:n.title)&&t.openedDialog.triggeringActionTitle&&t.openedDialog.triggeringActionTitle===t.dialogProps.action.title)},this.onDialogError=function(e){var a="Error opening dialog";if(e)try{a=JSON.stringify(e)}catch(e){(0,re.cY)("ExtensibilityDialogLauncher.onDialogError : Error parsing error object",e)}t.logDialogTelemetry(!1,"ExtensibilityDialogLauncher : ".concat(a))},this.openDialogForWebPlatformAsNewWindow=function(e,a){return ke(t,void 0,void 0,(function(){var t,n,o,r,i,l=this;return Fe(this,(function(s){switch(s.label){case 0:if(t=null!==(i=null===(r=null===(o=this.dialogProps)||void 0===o?void 0:o.card)||void 0===r?void 0:r.id)&&void 0!==i?i:"",this.isDialogActive()){if(!this.shouldCloseActiveDialog(t))return[2];this.closeActiveDialog()}return n=Ce(),[4,Office.context.ui.displayDialogAsync(n,{displayInIframe:!1,hideTitle:!0,height:e,width:a,promptBeforeOpen:!1},(function(e){return ke(l,void 0,void 0,(function(){var a,n,o,r,i,l=this;return Fe(this,(function(s){return e.error||!e.value?(this.onDialogError(e.error),[2]):(this.openedDialog={dialog:e.value,cardId:t,triggeringActionTitle:null!==(o=null===(n=null===(a=this.dialogProps)||void 0===a?void 0:a.action)||void 0===n?void 0:n.title)&&void 0!==o?o:""},null===(r=this.openedDialog.dialog)||void 0===r||r.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){return ke(l,void 0,void 0,(function(){return Fe(this,(function(t){switch(t.label){case 0:return[4,this.onMessageCallback(e.message)];case 1:return t.sent(),[2]}}))}))})),null===(i=this.openedDialog.dialog)||void 0===i||i.addEventHandler(Office.EventType.DialogEventReceived,(function(e){return ke(l,void 0,void 0,(function(){return Fe(this,(function(t){return 12006===e.error&&this.closeActiveDialog(),[2]}))}))})),[2])}))}))}))];case 1:return s.sent(),[2]}}))}))},this.openDialogForNativePlatform=function(e,a){return ke(t,void 0,void 0,(function(){var t,n,o,r,i=this;return Fe(this,(function(l){return t=Ce(),OfficeFirstPartyDialog.displayWebDialog(t,{displayInIframe:!0,dialogTitle:null!==(r=null===(o=null===(n=this.dialogProps)||void 0===n?void 0:n.dialogContent)||void 0===o?void 0:o.title)&&void 0!==r?r:ce.$9,hideTitle:!0,height:e,width:a,onMessage:this.onMessageCallback,onClose:this.onCloseCallback}).then((function(e){i.openedDialog.dialog=e})).catch((function(e){i.onDialogError(e),(0,re.cY)("ExtensibilityDialogLauncher : Error displaying  Extensibility Dialog",e)})),[2]}))}))},this.launchExtensibilityDialog=function(e){return ke(t,void 0,void 0,(function(){var t,a,n,o,r,i,l,s,c,d,u,m;return Fe(this,(function(h){switch(h.label){case 0:return(null==e?void 0:e.clientInfo)?(this.startTime=Date.now(),t=!this.msalAccountInfo||(null===(s=null===(l=this.dialogProps)||void 0===l?void 0:l.clientInfo)||void 0===s?void 0:s.userPrincipalName)!==e.clientInfo.userPrincipalName,this.dialogProps=e,t?(a=new Ae.j({userPrincipalName:null===(c=null==e?void 0:e.clientInfo)||void 0===c?void 0:c.userPrincipalName,redirectUri:new URL(null!==(u=null===(d=null==e?void 0:e.clientInfo)||void 0===d?void 0:d.redirectUri)&&void 0!==u?u:"",window.location.origin).toString(),clientId:fe.pL}),n=this,[4,a.getAccountInfoFromCache()]):[3,2]):((0,re.cY)("ExtensibilityDialogLauncher : Invalid dialog properties provided"),[2]);case 1:n.msalAccountInfo=h.sent(),h.label=2;case 2:return o=function(e){var t,a;if(e.viewMode!==Le.hs.TaskModule)return{dialogHeight:fe.Qt,dialogWidth:fe.Qt};var n=ye(null===(t=e.dialogContent)||void 0===t?void 0:t.height),o=ye(null===(a=e.dialogContent)||void 0===a?void 0:a.width),r=!0,i=!0,l=fe.t9,s=fe.OY;n<=0&&(i=!1,l=Te(n)),o<=0&&(r=!1,s=xe(o));var c=screen.width,d=screen.height;return i&&(l=ve(n,d)),r&&(s=ve(o,c)),{dialogHeight:l,dialogWidth:s}}(e),r=o.dialogHeight,i=o.dialogWidth,(null===(m=e.clientInfo)||void 0===m?void 0:m.clientType)===be.WK.web?this.openDialogForWebPlatformAsNewWindow(r,i):this.openDialogForNativePlatform(r,i),[2]}}))}))}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.setTheme=function(t){e.theme=t},e}(),Pe=a(308849),Ne=a(328831),Me=a(993821),Oe=a(747377),De=function(e){var t,a=e.clientInfoRef,n=e.theme,o=e.locale,r=e.clientId,i=e.redirectUri,l=e.isWebPlatform,s=R.useRef(void 0),c=function(){t&&t.close(),t=void 0},d=R.useCallback((function(e){s.current=e;var d=window.location.href.replace("taskpane.html","CloudFilePickerDialog.html"),u=n===Oe.G.defaultBlack,m=function(e){var n,d,m,h,p,b,f=JSON.parse(e);switch(f.type){case g.zg.Ack:var C={userPrincipalName:null!==(m=null===(d=a.current)||void 0===d?void 0:d.userPrincipalName)&&void 0!==m?m:"",clientId:r,redirectUri:i,locale:o,isDarkMode:u};re.EG.sendChatEventTelemetry((0,le.pN)(((n={})[oe.h3.ChatEventType]=oe.a5.CloudFilesDialogOpened,n))),t&&t.messageChild(JSON.stringify(C),{targetOrigin:"*"});break;case g.zg.CloseEvent:c(),l?setTimeout((function(){var e;null===(e=s.current)||void 0===e||e.closeCiqCallback()}),700):null===(h=s.current)||void 0===h||h.closeCiqCallback();break;case g.zg.OnItemSelected:c();var y=f.files;l?setTimeout((function(){var e;null===(e=s.current)||void 0===e||e.onItemSelected(y)}),700):null===(p=s.current)||void 0===p||p.onItemSelected(y);break;case g.zg.OnErrorInLoading:c(),l?setTimeout((function(){var e;null===(e=s.current)||void 0===e||e.onErrorInLoading()}),700):null===(b=s.current)||void 0===b||b.onErrorInLoading()}};l?Office.context.ui.displayDialogAsync(d,{displayInIframe:!0,hideTitle:!0,height:65,width:60},(function(e){null==(t=e.value)||t.addEventHandler(Office.EventType.DialogMessageReceived,(function(e){var t;m(null!==(t=null==e?void 0:e.message)&&void 0!==t?t:"")}))})):OfficeFirstPartyDialog.displayWebDialog(d,{displayInIframe:!0,dialogTitle:"",hideTitle:!0,height:65,width:60,onMessage:m,onClose:function(){var e;null===(e=s.current)||void 0===e||e.closeCiqCallback()}}).then((function(e){t=e}))}),[a,n,s]);return{onAttachCloudFiles:d}},Be=a(217425),$e=a(632197),He=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Ue=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},qe=a(448526),Ve=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Ge=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},We=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},ze=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},je=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},Qe=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},Je=function(){return Je=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Je.apply(this,arguments)},Ye="Microsoft.Office.SharedOnline",Xe={M365ChatMode:"dev",cspoff:"true",flight:"!cspheaders.enabled",auth:"2"};function Ze(e){for(var t=new URL(window.location.href),a=0,n=Object.entries(e);a<n.length;a++){var o=n[a],r=o[0],i=o[1];t.searchParams.set(r,i)}window.history.replaceState({},"",t.toString())}var Ke=a(988013),et=a(166391),tt=a(984691),at=a(380766),nt=a(881707),ot=a(103806),rt=a(39609),it=a(507481),lt=a(99394),st=a(722307),ct=a(644737),dt=a(381277),ut=a(340267),mt=a(11248),ht=a(96994),gt=a(852853);const pt={fontSize:gt.L.fontSizeBase200,fontWeight:gt.L.fontWeightRegular,borderRadius:"12px",border:"none",padding:`${gt.L.spacingVerticalXXS} ${gt.L.spacingHorizontalS} ${gt.L.spacingVerticalXXS} ${gt.L.spacingHorizontalSNudge}`,cursor:"pointer",height:"24px",gap:gt.L.spacingHorizontalXS,marginRight:gt.L.spacingHorizontalXS,whiteSpace:"nowrap"},bt={...pt,color:gt.L.colorNeutralForeground2,backgroundColor:gt.L.colorTransparentBackground,"&:hover":{color:gt.L.colorNeutralForeground2BrandHover,backgroundColor:gt.L.colorTransparentBackground}},ft={...pt,color:gt.L.colorNeutralForegroundInverted,backgroundColor:gt.L.colorBrandBackground,"&:hover":{color:gt.L.colorNeutralForegroundInverted,backgroundColor:gt.L.colorBrandBackgroundHover}},Ct={...bt,border:`1px solid ${gt.L.colorNeutralBackground1}`},yt={...ft,border:`1px solid ${gt.L.colorNeutralBackground1}`},vt={marginRight:"0px"},xt=(0,u.n)({root:bt,checked:ft,rootHighContrast:Ct,checkedHighContrast:yt,icon:{...vt,fill:gt.L.colorNeutralForeground1,"&:hover":{fill:gt.L.colorNeutralForeground2BrandHover}},iconChecked:{...vt,fill:gt.L.colorNeutralForegroundInverted,"&:hover":{fill:gt.L.colorNeutralForegroundInverted}}}),Tt={borderRadius:"12px",height:"24px",width:"24px",minWidth:"24px",border:"none",cursor:"pointer",whiteSpace:"nowrap"},St={...Tt,color:gt.L.colorNeutralForeground2,backgroundColor:gt.L.colorTransparentBackground,"&:hover":{color:gt.L.colorNeutralForeground2BrandHover,backgroundColor:gt.L.colorTransparentBackground}},wt={...Tt,color:gt.L.colorNeutralForegroundInverted,backgroundColor:gt.L.colorBrandBackground,"&:hover":{color:gt.L.colorNeutralForegroundInverted,backgroundColor:gt.L.colorBrandBackgroundHover}},Et={...St,border:`1px solid ${gt.L.colorNeutralBackground1}`},It={...wt,border:`1px solid ${gt.L.colorNeutralBackground1}`},Rt=(0,u.n)({root:St,checked:wt,rootHighContrast:Et,checkedHighContrast:It,icon:{...vt,fill:gt.L.colorNeutralForeground1,"&:hover":{fill:gt.L.colorNeutralForeground2BrandHover}},iconChecked:{...vt,fill:gt.L.colorNeutralForegroundInverted,"&:hover":{fill:gt.L.colorNeutralForegroundInverted}}}),At=({text:e,tooltipText:t,handleClick:a,isDisabled:o,isToggleOn:r,isIconOnly:i})=>{const{highContrastClientMode:l}=(0,R.useContext)(Ic),s=l!==C.QJ.disabled,[c,d]=(0,R.useState)(!1),u=(0,ut.Bi)(),m=(0,ut.Bi)(),h=xt(),g=Rt(),p=i?g:h;return(0,n.jsx)(mt.m,{content:(0,n.jsx)("span",{id:u,children:t}),relationship:"label",positioning:"above",withArrow:!0,children:(0,n.jsx)(ht.f,{className:s?r?p.checkedHighContrast:p.rootHighContrast:r?p.checked:p.root,size:"medium",disabled:o,"aria-label":e,"aria-labelledby":m,"aria-describedby":u,"aria-pressed":r,onClick:a,checked:r,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),icon:c&&!r?{children:(0,n.jsx)(dt.AzQ,{}),className:p.icon}:{children:(0,n.jsx)(dt.W66,{}),className:r?p.iconChecked:p.icon},iconPosition:"before",children:i?null:(0,n.jsx)("span",{id:m,children:e})})})};var Lt=a(830714),kt=a(893763),Ft=a(523999),_t=a(277718),Pt=a(255448),Nt=a(518826),Mt=a(888405),Ot=a(74704),Dt=a(551499),Bt=a(689534),$t=a(937234),Ht=a(167447),Ut=a(715540),qt=a(697705),Vt=a(830166),Gt=a(965634),Wt=a(235373),zt=a(874066),jt=a(4091),Qt=a(390624),Jt=a(439720),Yt=a(797639),Xt=a(810646),Zt=a(999963),Kt=a(512238);const ea=async(e,t,a)=>{if(0===e.length)return!1;for(const n of e)await ta(n,t,a);return!0},ta=async(e,t,a)=>{try{const n=e?.args?.[0],o=JSON.parse(n),r=JSON.parse(e?.args?.[1]);return await(0,Kt.Nl)(t,S.M.userQueryGuid,a,r,o)}catch(e){S.M.getInstance().logError({eventType:Gt.S2.ImportData,errorMessage:`got error during handling import data suggestion pill: ${e} ${JSON.stringify(e)}`,logLevel:oe.$b.Error})}};var aa=a(39251),na=a(494554),oa=a(495501);const ra=async(e,t,a)=>{e.length;for(const n of e)switch(n.kind){case"addDataShapingTransformationSteps":await la(n.args,t,a);break;case"dataShapingFailure":sa(n.args,t,a);break;case"enterDataShapingMode":da(n.args,t,a);break;case"editDataShapingQuery":await ca(n.args,t,a);break;default:(0,aa.x)(n)}return!0};let ia=0;const la=async(e,t,a)=>{a(Wt.m.setLatestRequestId(t));const n=JSON.parse(e.transformationStepsJson).map((e=>({name:`${e.stepName}_${++ia}`,script:e.stepScript})));await a((0,jt.DD)(n));const o=(0,d.wzs)().replace("{0}",e.transformationStepsExplanation),r=a((0,jt.SW)());if(!r.started)throw new Error("Data shaping is not started");const i=JSON.stringify({queryScript:r.queryScript,transformationStepsJson:e.transformationStepsJson,requestJson:r.enableDebugging?e.requestJson:void 0}),{message:l,telemetry:c}=oa.n.getDataShapingSuccessResponse(o,i,(async()=>{await a((0,jt.K5)(n))}));s.$.getInstance().displayResponse(l,c);const u=(0,na.N)(l);a((0,jt.nv)(u,$t.Aw.success,c,!1)),a((0,jt.L4)())},sa=(e,t,a)=>{dn.getInstance(a).showDataShapingErrorCard(t,e.sessionId,e.errorSource,e.errorCode,e.requestJson)},ca=async(e,t,a)=>{a(Wt.m.setLatestRequestId(t));const n=a((0,jt.SW)());if(!n.started)throw new Error("Data shaping is not started");const o=n.queryScript,r=JSON.stringify({queryScript:e.queryScript,originalQueryScript:o,requestJson:e.requestJson});let i,l,c;e.queryScript?(l=e.queryScript,await a((0,jt.Q4)(e.queryScript)),i=(0,d.fYt)().replace("{0}",e.explanation),c=async()=>{a(Wt.m.addDataShapingChatEntry({kind:"Undo"})),await a((0,jt.Q4)(o))}):(i=e.explanation,l=e.explanation),a(Wt.m.addDataShapingChatEntry({kind:"Instruction",instruction:e.instruction,response:l}));const{message:u,telemetry:m}=oa.n.getDataShapingSuccessResponse(i,r,c);s.$.getInstance().displayResponse(u,m);const h=(0,na.N)(u);a((0,jt.nv)(h,$t.Aw.success,m,!1)),a((0,jt.L4)())},da=(e,t,a)=>{a(Wt.m.exitDataShapingMode());dn.getInstance(a).showStartDataShapingCard(t,e.sessionId,e.tableName,e.mashupDocument,e.queryName,e.queryScript,e.requestJson)};var ua=a(10021),ma=a(295767),ha=a(53113);const ga=async(e,t,a,n)=>{if((0,ha.OC)(a,t,"executeFormulaGeneration"),0===e.length)return!1;for(const o of e)await pa(o,t,a,n);return!0},pa=async(e,t,a,n)=>{if("addCalculatedColumns"!==e.func&&"aggregateColumns"!==e.func)throw new Error(`Unsupported function ${e.func} for formula generation`);if(e.args.length<1)throw new Error(`No arguments found for ${e.func}`);if(e.args.length>3)throw new Error(`Incorrect number of parameters for ${e.func}`);a(ua.m.updateTableName({requestId:t,table:e.args[0]})),1===e.args.length?await a((0,ma.hJ)(t,n)):"aggregateColumns"===e.func?((0,o.cY)("fetchCellRecommendations"),await a((0,ma.JK)(t,n,e.args[1]))):((0,o.cY)("fetchColumnRecommendations"),await a((0,ma.hJ)(t,n,e.args[1])))};var ba=a(906606);const fa=async(e,t,a,n)=>{if(0===e.length)return!1;for(const o of e)await Ca(o,t,a,n);return!0},Ca=async(e,t,a,n)=>{if("getTableInsights"!==e.func)throw new Error(`Unsupported function ${e.func} for Insights agent`);if(e.args.length<1)throw new Error("No arguments found for getTableInsights");const o=e.args[0],r=e.args[1],i=Yt.CP.getActiveTable();if(!i||i.name!==o)throw new Error("The query is not aimed at the active table");a((0,ba.ge)(o,i,r,t,n))};var ya=a(549815),va=a(940096),xa=a(530495),Ta=a(14086),Sa=a(157669);var wa=a(947621),Ea=a(547131);class Ia{async applyCommandingProgram(e,t,a,n,o,i){await(0,Qt.$r)((0,d.Eyh)());const l=oa.n.getCommandingFeatureName(),s=l===x.q.ConditionalFormatting?x.OP.ConditionalFormatting:x.OP.Commanding;a((0,jt.eM)(s));const c=(new Date).getTime();for(const s of t){let t="",c=!1;const d=(new Date).getTime();try{const n=s.items;switch(i){case Dt.w2.OfficeJS:t="OfficeJS",c=await this.executeJsApiEvent(e,n,a,o);break;case Dt.w2.OfficeScripts:t="OfficeScripts",c=await this.executeOfficeScript(e,n,a,o)}c&&a((0,jt._Z)({caller:t}))}catch(e){return a(Ea.m.resetIsAllowRewrite()),this.logExecutorFailure(s,d),this.telemetryLogger.endTriedActivityFailure(l),await a((0,jt.L4)()),void((0,r.yw9)("OfficeVSO_10319285_AwaitOdslErrorHandling")?await n(e):n(e))}}this.logExecutionSucceed(c),qt.B.getInstance().logKeptEvent(this.telemetryLogger.getStandardizedFeatureForSubFeature(l),l,tt.RX.Command),await(0,Qt.TA)(),await a((0,jt.L4)()),this.addCommandingSuccessMessage(a,o,!1),(0,r.yw9)("OfficeVSO_9083629_HiTLApplyResetShowUndoButton")&&rt.Z.getInstance().setShowUndoButton(!1)}async execute(e,t,a,n,o){const i=(new Date).getTime();let l=!1,s=!1,c=!1;const d=[];let u=!1;for(const i of this.events){if(e.happened)throw new kt.WD("Timeout detected during HybridEventExecutor.execute");const m=(new Date).getTime();try{switch(i.agent){case Dt.w2.OfficeJS:(0,r.k64)()?c||(l=await this.showCommandingHumanInTheLoop(e,this.events,a,(e=>n(e)),d,i.agent)||l,c=!0):(this.telemetryLogger.endTriedActivitySuccess(x.q.Commanding),s=await this.executeJsApiEvent(e,i.items,a,d)||s,s&&a((0,jt._Z)({caller:"OfficeJS"})));break;case Dt.w2.OfficeScripts:(0,r.k64)()?c||(l=await this.showCommandingHumanInTheLoop(e,this.events,a,(e=>n(e)),d,i.agent)||l,c=!0):(this.telemetryLogger.endTriedActivitySuccess(x.q.Commanding),s=await this.executeOfficeScript(e,i.items,a,d)||s,s&&a((0,jt._Z)({caller:"OfficeScripts"})));break;case Dt.w2.Insights:this.telemetryLogger.endTriedActivitySuccess(x.q.AnalyzeData),l=await fa(i.items,t,a,o)||l;break;case Dt.w2.ImportData:(0,r.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ImportDataAsSkill",!1)&&(this.telemetryLogger.startTriedActivity(x.q.ImportDataSkill),l=await ea(i.items,t,a)||l);break;case Dt.w2.FormulaGeneration:this.telemetryLogger.endTriedActivitySuccess("aggregateColumns"===i.items[0].func?x.q.CalculatedRows:x.q.CalculatedColumns),l=await ga(i.items,t,a,o)||l;break;case Dt.w2.ConditionalFormatSuggestion:this.telemetryLogger.endTriedActivitySuccess(x.q.ConditionalFormatting),l=await(0,Zt.X)(i.items,t,a,o)||l;break;case Dt.w2.DataShaping:this.telemetryLogger.endTriedActivitySuccess((0,r.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?x.q.DataShaping:x.q.Commanding),l=await ra(i.items,t,a)||l;break;case Dt.w2.UnsupportedEvent:this.telemetryLogger.endTriedActivityFailure(),u=!0;break;default:this.telemetryLogger.endTriedActivityFailure()}}catch(e){throw a(Ea.m.resetIsAllowRewrite()),this.logExecutorFailure(i,m,e instanceof Error?e.message:void 0),this.telemetryLogger.endTriedActivityFailure(),e}}if(!l&&!s)throw this.telemetryLogger.endTriedActivityFailure(),this.logNoEventsExecuted(),this.hasOnlyUnsupportedEvents()?new kt.j4("Only unsupported events.",function(e){let t=[];for(const a of e)a.agent===Dt.w2.UnsupportedEvent&&(t=t.concat(a.items));return t}(this.events)):new Error("No events were executed!");this.logExecutionSucceed(i),s&&(qt.B.getInstance().logKeptEvent(x.BJ.Commanding,x.q.Commanding,tt.RX.Command),this.addCommandingSuccessMessage(a,d,u))}async executeJsApiEvent(e,t,a,n){if(0===t.length)return!1;(0,r.k64)()||a(Wt.m.startExecutingCommand({command:x.OP.Commanding}));let o="";try{for(let a=0;a<t.length;a++){if(e.happened){const e=new kt.WD("Timeout detected during executeJsApiEvent");throw(0,r.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&(e.errorCode="Timeout"),e}const i=t[a];o=i.method.toString();const l=await i.func(i.args);n.push(l)}}catch(e){throw this.logJsApiExecutorError(e,o),this.logCommandingAshaError(e.errorCode),this.isExecutingMultipleEvents()?new kt.m2("Error has occurred when executing multiple events."):e}return!0}async executeOfficeScript(e,t,a,n){if(0===t.length)return!1;(0,r.k64)()||a(Wt.m.startExecutingCommand({command:x.OP.Commanding}));try{if(e.happened){const e=new kt.WD("Timeout detected during executeOfficeScript");throw(0,r.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&(e.errorCode="Timeout"),e}const o=await(0,Sa.V)(t);(0,r.GBi)()&&this.performScratchpadPassiveTesting(o,a((0,va.Z)()).dataLocale||"en-us").catch((()=>{})),await this.runtimeHelper.prepareScript(o),await this.runtimeHelper.executeScript(o);if((0,Xt.yC)(t).forEach((e=>{e!==Bt.O.MissingIntent&&n.push(e)})),0===n.length){const e=[{key:x.Dh.EventType,value:x.Mv.LogMissingIntentString}];(0,wa.j)(e)}}catch(e){throw e.isExecutorError&&this.logOfficeScriptExecutorError(e,t),this.logCommandingAshaError(e.errorCode),this.isExecutingMultipleEvents()?new kt.m2("Error has occurred when executing multiple events."):e}return!0}async performScratchpadPassiveTesting(e,t){try{if(T.E.getInstance().updateTelemetryChatEventData({[tt.h3.ChatEventType]:x.a5.CommandScratchpadPassiveTesting},S.M.getInstance()),!e.localUpdates?.body)return void S.M.getInstance().logError({eventType:Gt.S2.CommandingScratchpad,errorMessage:"Error scratchpad passive test: empty script",logLevel:oe.$b.Warning});const a=new Ht.p(t,"ScratchpadPassiveTesting"),n=Ut.b.instance(),o=e.localUpdates.body,r=await(0,xa.uS)(e),i=await(0,Jt.V)(o,e,r);await n.prepareCustomParams(i,void 0,a.makeBatchHandler(),e),await n.executeScript()}catch(e){S.M.getInstance().logError({eventType:Gt.S2.CommandingScratchpad,errorMessage:"Error scratchpad passive test. OfficeJs Internal Error: "+e,logLevel:oe.$b.Warning})}finally{try{(0,Mt.qK)("ScratchpadPassiveTesting",t)}catch(e){}}}logCommandingAshaError(e){const t=oa.n.getCommandingFeatureName(),a=x.q.ConditionalFormatting===t;if((0,r.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")){let t,n;switch(e){case"AccessDenied":t=v.W.Unable_To_Complete_Task,n=a?y.c.Failed_Conditional_Formatting_Execution_Due_To_Protection_Settings:y.c.Failed_Command_Execution_Due_To_Protection_Settings;break;case"Timeout":t=v.W.Response_Delayed_Or_Timed_Out,n=a?y.c.Conditional_Formatting_Execution_Took_Too_Long:y.c.Command_Execution_Took_Too_Long;break;default:t=v.W.Unclassified_Chat_Failure,n=a?y.c.Failed_Conditional_Formatting_Execution_Due_To_Other_Error:y.c.Failed_Command_Execution_Due_To_Other_Error}S.M.getInstance().logStandardizedAshaErrorEvent(t,n,a?x.BJ.ConditionalFormatting:x.BJ.Commanding)}}logExecutionSucceed(e){const t=(0,x.b6)();t[x.Dh.EventState]=x.DD.ExecutorSucceeded,t[x.Dh.TimeDurationInMs]=(0,x.xJ)(e),this.telemetryLogger.logEvent((0,x.gY)(t))}logNoEventsExecuted(){this.logNoEventExecutedError();const e=(0,x.b6)();e[x.Dh.EventState]=x.DD.ExecutorNoneExecuted,this.telemetryLogger.logEvent((0,x.gY)(e))}logExecutorFailure(e,t,a){const n=(0,x.b6)();n[x.Dh.EventState]=x.DD.ExecutorFailed,n[x.Dh.ExecutableAgent]=e.agent,n[x.Dh.TimeDurationInMs]=(0,x.xJ)(t),e.agent===Dt.w2.OfficeJS||e.agent===Dt.w2.OfficeScripts?n[x.Dh.ExecutableNames]=JSON.stringify(e.items.map((e=>e.method))):(0,r.yw9)("OfficeVSO_9275720_addErrorMessageForExecutorFailureEventsV2")&&(n[x.Dh.ErrorMessage]=a),this.telemetryLogger.logEvent((0,x.gY)(n))}logNoEventExecutedError(){const e={eventType:Gt.S2.NoEventExecuted,errorMessage:"",logLevel:oe.$b.Warning},t=[{key:x.xL.ErrorMessage,value:"No event has been executed."}];this.telemetryLogger.logError(e,void 0,t)}logJsApiExecutorError(e,t){const a=JSON.stringify(e),n={eventType:Gt.S2.Executor,errorMessage:a,logLevel:oe.$b.ASHA},o=[{key:x.LP.FailedEventMethods,value:JSON.stringify([t])},{key:x.LP.Agent,value:Dt.w2.OfficeJS},{key:x.xL.ErrorMessage,value:"Something went wrong while executing JS API events."}];this.telemetryLogger.logError(n,void 0,o)}logOfficeScriptExecutorError(e,t){const a={eventType:Gt.S2.Executor,errorMessage:e.message,logLevel:oe.$b.ASHA},n=[{key:x.LP.FailedEventMethods,value:JSON.stringify(t.map((e=>e.method)))},{key:x.LP.Agent,value:Dt.w2.OfficeScripts},{key:x.xL.ErrorMessage,value:e.message}];this.telemetryLogger.logError(a,void 0,n)}addCommandingSuccessMessage(e,t,a){rt.Z.getInstance().setShowUndoButton(!0),(0,r.k64)()&&(0,r.yw9)("OfficeVSO_9008332_FixHiTLUndoState")||e(zt.m.setDoesFluxTurnRequireUndo());const n=this.getMessageSuffix(a),o=t.map((e=>({text:e}))),{message:i,telemetry:l}=oa.n.getCommandingSuccessResponse(n,o);s.$.getInstance().displayResponse(i,l,{shouldShowWhenFluxSkillResponseRequired:!1});const c=(0,ya.r)(n,o),d=(0,na.N)(c);e((0,jt.nv)(d,$t.Aw.success,l)),e((0,jt.Yx)(["Commanding_Suggestion"]))}isExecutingMultipleEvents(){let e=0;return this.events.forEach((t=>{t.agent!==Dt.w2.OfficeJS&&t.agent!==Dt.w2.OfficeScripts||(e+=t.items.length)})),e>1}hasOnlyUnsupportedEvents(){let e=!0;return this.events.forEach((t=>{t.agent!==Dt.w2.UnsupportedEvent&&(e=!1)})),e}getMessageSuffix(e){let t;const a=Vt.g.instance().getHiddenColumnSuffixMessageAndReset();return t=a||(e?(0,d.VCG)():void 0),t}constructor(e){this.showCommandingHumanInTheLoop=async(e,t,a,n,o,i)=>{if(0===t.length)return!1;let l,c=[],u=[];for(const e of t)if((0,r.yw9)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS")&&e.agent===Dt.w2.OfficeJS){const t=e.items;u=u.concat((0,Xt.C2)(t)??[])}else{const t=e.items,{cfIntents:a,nonCfIntents:n}=(0,Xt.NU)(t);c=c.concat(a??[]),u=u.concat(n??[])}const m=Yt.CP.getActiveTable(),h=m?m.address:"";Yt.CP.setHumanInTheLoopRange((0,Ta.r)(h));let g=x.q.Commanding;c.length>0?((0,r.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")&&(g=x.q.ConditionalFormatting,this.telemetryLogger.setActiveFeature(g)),l=oa.n.getCommandingCFHumanInTheLoopResponse(c,u,(()=>this.applyCommandingProgram(e,t,a,(e=>n(e)),o,i)))):l=(0,r.yw9)("OfficeVSO_8976811_BoldRangeHiTLCard")?oa.n.getCommandingHumanInTheLoopResponse(u,(()=>this.applyCommandingProgram(e,t,a,(e=>n(e)),o,i))):oa.n.getCommandingHumanInTheLoopResponseDeprecated(u,(()=>this.applyCommandingProgram(e,t,a,(e=>n(e)),o,i))),s.$.getInstance().displayResponse(l.message,l.telemetry,{shouldShowWhenFluxSkillResponseRequired:!0});const p=JSON.stringify({text:d.qbK.HumanInTheLoop.CardShown,publishPreference:Bt.f.Never});return this.telemetryLogger.endTriedActivitySuccess(g),a((0,jt.nv)(p,$t.Aw.success,l.telemetry)),!0},this.runtimeHelper=Ut.b.instance(),this.telemetryLogger=S.M.getInstance(),this.events=e}}var Ra=a(399385),Aa=a(877825),La=a(46445),ka=a(959994),Fa=a(108869),_a=a(202051),Pa=a(839945),Na=a(804672),Ma=a(565874),Oa=a(471742);function Da(e,t){const a=t.filter(((e,a)=>!t.slice(0,a).includes(e)));let n=!1;if(!a.includes(Dt.DH.Undo)&&!a.includes(Dt.DH.InsertTables)&&!a.includes(Dt.DH.Formatting)&&a.length>0){const{message:t,telemetry:a}=oa.n.getUnsupportedCommandResponse((0,d.DUN)());s.$.getInstance().displayResponse(t,a,{shouldShowWhenFluxSkillResponseRequired:!1});const o=(0,na.N)(t);e((0,jt.nv)(o,$t.Aw.failed,a)),n=!0}return a.forEach((t=>function(e,t){const a=Office.context.platform;let n="",o=[];switch(t){case Dt.DH.Undo:{let e=[{text:(0,d.Y91)()}];a===Office.PlatformType.Mac?e=[{text:(0,d.mLK)()}]:a===Office.PlatformType.PC&&(e=[{text:(0,d.wEx)()}]),n=(0,d.vuT)(),o=e;break}case Dt.DH.TableAltText:{const e=[{text:(0,d.HhS)()}];a===Office.PlatformType.Mac||a===Office.PlatformType.PC?e.push({text:(0,d.$S6)()}):e.push({text:(0,d.gq9)()}),n=(0,d.xFL)(),o=e;break}case Dt.DH.AddComment:n=(0,d.S08)(),o=[{text:(0,d.CnK)()},{text:(0,d.Tem)()},{text:(0,d.Ub7)()},{text:(0,d.p8k)()}];break;case Dt.DH.DataValidation:n=(0,d.TVz)(),o=[{text:(0,d.FuV)()},{text:(0,d.yWY)()},{text:(0,d.tPp)()},{text:(0,d.YSs)()},{text:(0,d.di6)()},{text:(0,d.ean)()}];break;case Dt.DH.CreatePivotTable:n=(0,d.xmO)(),o=[{text:(0,d.Pzq)()},{text:(0,d.GyK)()},{text:(0,d.TMJ)()},{text:(0,d.OpW)()},{text:(0,d.rho)()}];break;case Dt.DH.InsertWorksheets:case Dt.DH.DeleteWorksheets:n=(0,d.Iy7)(),o=[{text:(0,d.Qv5)()},{text:(0,d.Xdl)()},{text:(0,d.QaT)()}];break;case Dt.DH.FreezePanes:n=(0,d.M76)(),o=[{text:(0,d.czL)()},{text:(0,d.jh3)()}];break;case Dt.DH.Formatting:n=(0,d.$5J)();break;case Dt.DH.InsertTables:n=(0,d.fLI)();break;default:n=(0,d.AWW)(),e((0,jt.Nl)())}const{message:r,telemetry:i}=oa.n.getUnsupportedCommandResponse(n,o);s.$.getInstance().displayResponse(r,i,{shouldShowWhenFluxSkillResponseRequired:!1});const l=(0,na.N)(r);e((0,jt.nv)(l,$t.Aw.failed,i))}(e,t))),n}var Ba=a(274483),$a=a(977055);function Ha(e){if(!function(e){return e.type===Ft.VF.CopilotChatResponseMeta}(e))return;const t=e.chatResponseCode;if(t!==Ft.XO.OK)switch(t){case Ft.XO.ServiceTimeout:return void a(v.W.Response_Delayed_Or_Timed_Out,y.c.Service_Timeout);case Ft.XO.ServiceError:return void a(v.W.LLM_Service_Side_Issue_Prevents_Output,y.c.Service_Error_Augloop);case Ft.XO.RAICheckFailed:return void a(v.W.Responsible_AI_Filter_Blocked_Response,y.c.RAI_Validation_Failed);case Ft.XO.Unknown:return void a(v.W.Unable_To_Complete_Task,y.c.Service_Error_Unknown_Error);default:return S.M.getInstance().logError({eventType:Gt.S2.Error,errorMessage:`Unknown CopilotChatResponseCode - ${t}`,logLevel:oe.$b.Error}),void a(v.W.Unable_To_Complete_Task,y.c.Service_Error_Unknown_Error)}function a(e,t){S.M.getInstance().logStandardizedAshaErrorEvent(e,t,x.BJ.CopilotChat)}}var Ua=a(314998),qa=a(389298),Va=a(507628),Ga=a(632512),Wa=a(449650),za=a(448514),ja=a(104450),Qa=a(502582),Ja=a(755005),Ya=a(875136),Xa=a(762542),Za=a(254359);class Ka extends Qa.r{async autoInsertPythonFormula(){return new Promise(((e,t)=>{(0,Qt.F5)((async a=>{try{(0,Ya.Fr)(Ya.xk.CodeExecution),(0,Ya.BW)(this.dispatch);const t=(0,Fa.ZK)(this.code,!0,Xa.M),n=this.codeLabel?this.codeLabel:(0,d.XZh)(),o=await(0,Fa.WH)(a,this.sheetId),r=await(0,Ya.Mg)((async()=>await this.insertLabelAndContentForPreviewOrFormula(a,o,n,t,!0,!1)),Ya.xk.InsertContentToGrid);e(r)}catch(e){(0,Ya.i5)(!1),(0,Ya.$k)(this.dispatch);const a=(0,_a.MF)(e,"PythonAutoInserter","autoInsertPythonFormula",!1);t(a)}}),{delayForCellEdit:!1})}))}async handlePythonCellExecutionResult(e,t,a){(0,$a.M5)();const n=e.output;"Error"!==e.outputType&&"Python"!==n.errorType&&(0,Ya._F)(),(0,Ya.MO)(),this.addCodeAndOutputToBuilder(e),(0,$a.S$)(t,e),await(0,Ya.ek)((async()=>{await this.handlePythonAdaExecutionResult(e,a)}),Ya.xk.HandlePythonAdaCellExecution,!0)}async handlePythonAdaExecutionResult(e,t){try{const a=Yt.CP.pythonContextManager.isPythonThinkDeeperMode?Yt.CP.pythonContextManager.MAX_AUGLOOP_CALLS_PER_QUERY_THINK_DEEPER:Yt.CP.pythonContextManager.MAX_AUGLOOP_CALLS_PER_QUERY;if(Yt.CP.pythonContextManager.augloopCallsPerQuery>=a){const e=`Maximum AugLoop Calls Per Query: ${a}`,t=(0,_a.x6)(e);return void(0,_a.QX)(this.dispatch,t,!0)}if(Yt.CP.pythonContextManager.augloopCallsPerQuery+=1,e.outputType===Ja.qf.Error){if(Yt.CP.pythonContextManager.codeRetryAttempts>=Yt.CP.pythonContextManager.MAX_CODE_RETRY_ATTEMPTS){const e=`Maximum Retry Attempts: ${Yt.CP.pythonContextManager.MAX_CODE_RETRY_ATTEMPTS}`;throw(0,_a.Jk)(e)}{Yt.CP.pythonContextManager.codeRetryAttempts+=1;const a=e.output;if(a.errorType!==Excel.ErrorCellValueType.python&&a.errorType!==Excel.ErrorCellValueType.timeout){throw(0,_a.En)(e)}{const e=(0,Fa.u1)(a.errorType,t);Za.n.displayPythonTextResponse(this.dispatch,e,!1)}}}else(0,$a.Jr)(Yt.CP.pythonContextManager.augloopCallsPerQuery,Yt.CP.pythonContextManager.codeRetryAttempts),Yt.CP.pythonContextManager.codeRetryAttempts=0;await ot.p.getInstance().handlePythonAdaExecutionResult()}catch(e){throw(0,_a.Kx)(this.dispatch,e,"handlePythonAdaExecutionResult",!0),e}}constructor(e,t,a,n,o,r){super(e,a,Qa.n.PythonCodeAndPreviewInserter,o,r),this.requestId=t,this.code=n}}var en=a(750927);class tn extends Qa.r{async handlePythonCellExecutionResult(e){let t;qt.B.getInstance().logKeptEvent(x.BJ.Python,x.q.PythonCalculatedColumns,tt.RX.Analyze);try{if("Error"===e.outputType){const a=e.output;t=(0,en.L)((0,d.pa_)(),a.errorType)}else t=(0,en.L)((0,d.TaP)(),this.columnLetters);const{message:a,telemetry:n}=oa.n.getPythonColumnInsertResponse(t,this.requestId);s.$.getInstance().displayResponse(a,n)}catch(e){this.handlePythonColumnError(e,(0,d.JIA)())}}addResultListener(e,t){const a=t=>this.onCalculatedHandler(t,e);this.onCalculatedResult=t.onCalculated.add(a),this.handlerReference=a}removeResultListener(e){this.handlerReference&&e.onCalculated.remove(this.handlerReference)}async onCalculatedHandler(e,t){await Excel.run((async a=>{const n=a.workbook.worksheets.getItem(e.worksheetId);try{const o=e.address.split(",");for(const r of o){const o=n.getRange(r).load(["formulas","valuesAsJson","rowCount","columnCount"]);await a.sync();const i=(0,Fa.o7)(t);await Promise.all(o.formulas.flatMap((async(t,a)=>t.map((async(t,n)=>{const o=(0,Fa.o7)(t),l=await this.mutex.waitFor();if(this.onCalculatedFinished)l.release();else if(i===o){this.onCalculatedFinished=!0,l.release(),this.onCalculatedResult?.remove(),await(this.onCalculatedResult?.context.sync()),this.onCalculatedResult=null;const t=Wa.ExcelCalc.addressToExcelRange(r).topLeft;t.column=(t.column??0)+n,t.row=(t.row??0)+a;const o={topLeft:t,bottomRight:t},i=Wa.ExcelCalc.IExcelRangeToAddress(o),s=await Yt.CP.pythonContextManager.getPythonCellContextWithTimeout(e.worksheetId,i);await this.handlePythonCellExecutionResult(s)}else l.release()})))))}}catch(e){this.removeResultListener(n),this.handlePythonColumnError(e,(0,d.JIA)())}this.removeResultListener(n)}))}async autoInsertPythonFormula(){return new Promise(((e,t)=>{try{(0,Qt.F5)((async t=>{const a=(0,Fa.ZK)(this.code,!0,Xa.M),n=await this.insertContentForColumn(t,this.codeLabel??(0,d.XZh)(),a);e(n)}))}catch(e){this.handlePythonColumnError(e,(0,d.JIA)()),t(e)}}))}handlePythonColumnError(e,t){const{message:a,telemetry:n}=oa.n.getPythonColumnInsertErrorResponse(e,t);s.$.getInstance().displayResponse(a,n)}async setColumnContent(e,t,a,n){const o=t.getRange(this.tableAddress).load(["rowIndex","rowCount","columnIndex","columnCount"]);await e.sync();const{headerCell:r,contentRange:i}=function(e,t){const a=t.columnIndex+t.columnCount;return{headerCell:e.getCell(t.rowIndex,a),contentRange:e.getRangeByIndexes(t.rowIndex+1,a,1,1)}}(t,o);return i.load("address"),r.values=[[a]],i.values=[[n]],i.select(),await e.sync(),i.address}async insertContentForColumn(e,t,a){const n=e.workbook.worksheets.getItemOrNullObject(this.sheetId);this.addResultListener(a,n);return await this.setColumnContent(e,n,t,a)}constructor(e,t,a,n,o,r,i,l){super(e,a,Qa.n.PythonCalculatedColumnInserter,i,l),this.requestId=t,this.code=r,this.tableAddress=n,this.columnLetters=o}}var an=a(464216),nn=a(774370),on=a(173339),rn=a(912477);function ln(e){switch(e){case Ra.r.AnswersLlmLoopLimitHit:return(0,d.kQP)();case Ra.r.AnswersCallingElseSkill:return(0,d.g9p)();case Ra.r.AnswersElseSkillDone:return"";default:{const t=`Python status ${e} is not supported.`;throw(0,_a.xp)(Ga.O.PythonUnsupportedResponseType,t)}}}var sn=a(357392);var cn=a(107295);class dn{static getInstance(e){return dn.instance||(dn.instance=new dn(e)),dn.instance}async applyAllBatches(e){if(!this.scratchpad)return{success:!1,errorMessage:`Scratchpad was not initialized when trying to apply all batches for caller ${e}`};const t=await this.scratchpad.applyAllBatches(e);return this.scratchpad.clearChangeCollectorForCaller(e),t}executeOfficeJsFromScriptRunner(e){return this.officeJsCommanding||(this.officeJsCommanding=new Mt.$v(this.dispatch)),this.officeJsCommanding.executeOfficeJsRaw(e)}startChangeCollector(e){this.scratchpad||(this.scratchpad=new nn.O(this.dispatch)),this.scratchpad.addOrResetChangeCollector(e)}async executeScript(e,t){return this.scratchpad||(this.scratchpad=new nn.O(this.dispatch)),await this.scratchpad.executeScript(e,t)}applyChartStylesOfficeJsCommanding(e,t){this.officeJsCommanding||(this.officeJsCommanding=new Mt.$v(this.dispatch)),this.officeJsCommanding.executeOfficeJs("",e,[t],!0,!1)}async handleChartDesignNoRecommendationResult(){this.officeJsCommanding||(this.officeJsCommanding=new Mt.$v(this.dispatch)),await this.officeJsCommanding.handleChartDesignNoRecommendationResult()}async handleChartDesignRecommendationResult(e,t,a,n,o){this.officeJsCommanding||(this.officeJsCommanding=new Mt.$v(this.dispatch)),await this.officeJsCommanding.handleChartDesignRecommendationResult(e,t,a,n,o)}setAugloopSignalSentTime(e){this.augloopSignalSentTime=e,this.isFirstResponse=!0,rt.Z.getInstance().resetStartQueryState(e)}markRequestCanceled(){this.dispatch((0,jt.L4)(!1));const e=S.M.userQueryGuid;this.canceledQueryIds.push(e),Ot.Q.getInstance().stopRecordingFluxWorkflow(!0),s.$.getInstance().handleEndOfQuery(void 0),this.dispatch(Ea.m.evaluateQueryFailed(e)),this.dispatch(ua.m.fetchRecommendationsFailed(e))}setAugloopModelWorkflowUnsupported(e){e&&this.dispatch(zt.m.setAugloopModelWorkflowUnsupported())}async handleErrorResponse(e,t,a){let n={},o={};const i=this.telemetryLogger.getActiveFeature();if((0,r.thH)()&&(({message:n,telemetry:o}=await oa.n.getAugloopErrorResponse(e,a,i)),!o.useClientSideErrorMessage))return!1;Yt.CP.pythonContextManager.isPythonMode&&Yt.CP.pythonContextManager.isStartAnalysisCard()&&this.dispatch(Wt.m.setPythonStartAnalysisButtonDisabled(!0)),Yt.CP.pythonContextManager.isPythonMode&&((0,Ya.hb)(),(0,Ya.P_)(!0)),this.dispatch((0,jt.Nl)()),this.telemetryLogger.endTriedActivityFailure(),(0,Na.cY)(`AL Error:\n${JSON.stringify(e,void 0,4)}`);const l=(0,Na.qW)(t);let s=!1;if("OffensiveContent"!==e.category&&0!==l.length)s=Da(this.dispatch,l),(0,r.yw9)("OfficeVSO_9220746_AddAshaForUnsupportedCommand")&&(0,r.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&S.M.getInstance().logStandardizedAshaErrorEvent(v.W.Missing_Copilot_Functionality,y.c.ODSL_Execution_Failed_Due_To_Unsupported_Commands,i);else{(0,r.thH)()||({message:n,telemetry:o}=await oa.n.getAugloopErrorResponse(e,a,i)),s=this.copilotChatUiHelper.displayErrorResponseIfNeeded(n,o,{shouldShowWhenFluxSkillResponseRequired:!1});const t=(0,na.N)(n);this.dispatch((0,jt.nv)(t,$t.Aw.failed,o)),this.showUnsupportedTLRSuggestionListIfNeeded(o)}return await this.dispatch((0,jt.L4)(!1)),Ot.Q.getInstance().stopRecordingFluxWorkflow(!1),this.telemetryLogger.logError({eventType:Gt.S2.Augloop,errorMessage:"Failure received from Augloop.",logLevel:this.telemetryLogger.getLogLevelForErrorCategory(e?.category??"")},void 0,[{key:x.IC.ErrorCategory,value:e?.category??""}]),rt.Z.getInstance().endUserPerceivedLatency(!1),Yt.CP.pythonContextManager.isPythonMode&&((0,Ya.P_)(),s&&(0,_a.OE)(this.dispatch)),!0}async handleResponse(e){if(this.augloopSignalSentTime){const t=(0,x.xJ)(this.augloopSignalSentTime);this.telemetryEventHandler.logLatency(t,x.OP.AugloopResponse),this.isFirstResponse&&(this.telemetryEventHandler.updateTelemetryLatencyData({[x.CT.FirstServiceResponse]:(0,za.W)(this.augloopSignalSentTime)},this.telemetryLogger),this.isFirstResponse=!1),(0,Na.cY)(`${e.body?ka.h.getTypeNameFor(e.body):"item.body is gone; this is a bug in"} response. Time Taken : ${t/1e3} sec \n`)}const t=this.copilotChatUiHelper.getLastUserUtterance(),a=e?.body?.odslResponse?.odsl?.responseRequired;if(e?.body?.queryId&&-1!==this.canceledQueryIds.indexOf(e?.body?.queryId))return this.telemetryLogger.endTriedActivityFailure(),(0,Na.cY)("query was cancelled"),a&&(0,jt.$U)($t.Aw.failed,(0,d.gAP)()),void rt.Z.getInstance().endUserPerceivedLatency(!1);a&&(this.copilotChatUiHelper.setIsSkillResponseRequired(!0),Ot.Q.getInstance().recordFluxCopilotStep({operation:x.OP.FluxSkillStart}));const n=e?.body,o=n?.error,i=this.getOdslProgram(n),l=n.responseMetadata,s=n.chatResponse,c=s?.telemetry?.metrics??n?.odslResponse?.telemetry?.metrics,u=s?.sessionKey,m=n?.queryId,h=n?.prompt,g=n?.odslResponse?.prompt,p=n?.raw,b=n?.entities,f=n?.rewrite,C=n?.odslResponse?.outputAnswerLanguage;if((0,r.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")){const e=n?.contentOriginInformationalOnly;this.telemetryLogger.setActiveFeatureWithContentOrigin(e),rn.MK.augloopResponseReceived(m,e,n)}const T=this.getAiResponses(n);let w,E,I,R,A,L,k,F;if(l&&this.logResponseMetadataTelemetry(l),(0,ha.VI)(l)){const e=l;return[Ft.b.Unsuccessful,Ft.b.ServiceError,Ft.b.ServiceTimeout].includes(e.chatResponseCode)&&rn.MK.augloopErrorReceived(m,e.suggestionMetadata),await(0,ha.E_)(m,l,this.dispatch)}if((0,Ba.O9)(l))return(0,r.Qyj)()&&(0,Ba.mN)(),void this.dispatch(Wt.m.startExecutingCommand({command:x.OP.ElseSkillExecuting}));if(_=l,_?.type===Ft.VF.DocumentGroundingMeta)return void await async function(e){if((0,sn.z)()&&e.tables){const t=e.tables.map((e=>e.sheetQualifiedAddress));await sn.g.getInstance().showGridFoils(t)}}(l);var _;if(T)for(const e of T)if(e.value){const t=e.type;if((0,r.H2A)()&&"pythonAda"===t)w=e.value;else if((0,r.vom)()&&"pythonCalculatedColumns"===t)E=e.value;else if((0,r.geU)()&&"officeJs"===t)I=e.value;else if((0,r.avT)()&&"officeScripts"===t){const t=e.value,a=t.operationType;"run_script"===a&&t.officeScriptsRun?R=t.officeScriptsRun:"save_script"===a&&t.officeScriptsSave?A=t.officeScriptsSave:(0,r.Lap)()&&"schedule_script"===a&&t.officeScriptsSchedule&&(L=t.officeScriptsSchedule)}}if((0,Ma.E)(n)===_t.Yn.getTypeName()&&n.conversationId&&(k=n.conversationId,S.M.conversationId=k,qt.B.conversationId=k,F=n.sydneyEndpoint,(0,Na.cY)(`conversation id from Excel Flux Copilot: ${n.conversationId}`)),f&&(0,Na.cY)(`Rewrite:\n${f}`),h&&(0,Na.cY)(`Prompt:\n${h}`),p&&(0,Na.cY)(`ODSL:\n${p}`),b&&(0,Na.cY)(`Entities:\n${b}`),w&&(0,Na.cY)(`PythonAdaResult:\n${JSON.stringify(w)}`),E&&(0,Na.cY)(`pythonColumnResult:\n${JSON.stringify(E)}`),R&&(0,Na.cY)(`OfficeScript to Run:\n${JSON.stringify(R)}`),A&&(0,Na.cY)(`OfficeScript ODSL to Save:\n${JSON.stringify(A)}`),L&&(0,Na.cY)(`OfficeScript to Schedule:\n${JSON.stringify(L)}`),C&&(0,Na.cY)(`outputLanguage:\n${C}`),I&&(0,Na.cY)(`OfficeJs to run:\n${JSON.stringify(I)}`),this.telemetryEventHandler.updateTelemetryChatEventData({[x.h3.ChatEventType]:x.a5.ResponseReceivedFromAL,...(0,x.j)(Yt.CP),[x.h3.ChatEventParameters]:JSON.stringify({annotationType:(0,Ma.E)(n)})},this.telemetryLogger),(0,r.cTR)()&&this.updateDevTelemetry(u,k,F,m,c),o){if(rn.MK.augloopErrorReceived(m,o),!(0,r.thH)())return void await this.handleErrorResponse(o,t,n);if(await this.handleErrorResponse(o,t,n))return}if(w)return(0,Fa.i_)()&&0!==w.response.length?(0,$a.fL)(x.KZ.Answers):(0,$a._8)(x.KZ.SubmitPythonAdaQuery),(0,Fa.bh)(g),(0,Ya.Li)(),Yt.CP.pythonContextManager.shouldGenerate?(Yt.CP.pythonContextManager.pythonContextBuilder.setPythonPrompt(g),void await this.showPythonAdaCards((0,Va.A)(),w,C)):void(0,Ya.P_)(!1,!0);if(E&&await this.showPythonCalculatedColumn((0,Va.A)(),E),I)return this.telemetryLogger.endTriedActivitySuccess(x.q.OfficeJsCommanding),void await(this.officeJsCommanding?.handleOfficeJsResult(m??"",I));if(R){this.telemetryLogger.endTriedActivitySuccess(x.q.OfficeScripts);const{message:e,telemetry:t}=oa.n.getOfficeScriptErrorResponse((0,d._kX)().replace("{0}",R.scriptNameToRun),La.m.RunScript);this.copilotChatUiHelper.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),this.dispatch((0,jt.nv)((0,na.N)(e),$t.Aw.failed,t))}if(A)return this.telemetryLogger.endTriedActivitySuccess(x.q.OfficeScripts),void await this.handleSaveODSLToOfficeScript(A,S.M.userQueryGuid);if(L)return this.telemetryLogger.endTriedActivitySuccess(x.q.OfficeScripts),void await this.handleScheduleOfficeScript(L,S.M.userQueryGuid);if(!i||0===i.length)return s?(s.status===Lt.lC.Success&&(this.telemetryLogger.endTriedActivitySuccess(x.q.CopilotChat),(0,r.ZAR)()&&Yt.CP.setHasTFCDeliveredQueryResult()),(0,Ba.xY)(l,this.telemetryLogger),(0,Na.cY)(`chatResponse:\n${JSON.stringify(s)}`),await rt.Z.getInstance().handleChatResponse(s,this.dispatch,k,this.augloopSignalSentTime,F,n?.fromCache,o,m)):(this.telemetryLogger.endTriedActivityFailure(),this.telemetryLogger.logError({eventType:Gt.S2.Augloop,errorMessage:"Undefined Program received from Augloop",logLevel:oe.$b.Warning}),a&&(0,jt.$U)($t.Aw.failed,(0,d._h7)()),(0,r.yw9)("OfficeVSO_10215994_TerminateQueryOnGenericFailure")&&(S.M.getInstance().logStandardizedAshaErrorEvent(v.W.UI_Failed_To_Update_Or_Load,y.c.Augloop_Error_Occurred_No_Chat_Response,this.telemetryLogger.getActiveFeature()),this.dispatch((0,jt.L4)(!1,!1)),(0,ct.s_)(ct.H0.EnableApply)),void rt.Z.getInstance().endUserPerceivedLatency(!1));const P=JSON.stringify(i.map((e=>(e.argumentsArray=void 0,e))),void 0,4);(0,Na.cY)(`Program:\n${P}`);const N=(new Date).getTime();await this.executeOdsl(i,S.M.userQueryGuid,C),this.telemetryEventHandler.logLatency((0,x.xJ)(N),x.OP.QueryExecution)}async handleSaveODSLToOfficeScript(e,t){this.dispatch(Wt.m.setLatestRequestId(t)),this.dispatch(Wt.m.startExecutingCommand({command:x.OP.CreateOfficeScripts}));const{success:a,intents:n,scriptToSave:o}=await(0,Pa.I)(e,t);if(a&&o){const{message:e,telemetry:a}=oa.n.getOfficeSaveScriptHiTL(n,o,t,!1,this.dispatch);this.copilotChatUiHelper.displayResponse(e,a,{shouldShowWhenFluxSkillResponseRequired:!0});const{message:r,telemetry:i}=oa.n.getOfficeSaveScriptHiTL(n,o,t,!0,this.dispatch);this.dispatch((0,jt.nv)((0,na.N)(r),$t.Aw.success,i))}else{const{message:e,telemetry:t}=oa.n.getOfficeScriptErrorResponse((0,d.CPY)(),La.m.SaveScript);this.copilotChatUiHelper.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),this.dispatch((0,jt.nv)((0,na.N)(e),$t.Aw.failed,t))}}async handleScheduleOfficeScript(e,t){const a=(e,a)=>{e.isOfficeScriptSkillHandlerError&&(0,Ua.hs)(e,"schedule_script",t);const{message:o,telemetry:i}=oa.n.getOfficeScriptErrorResponse(a,La.m.ScheduleScript);this.copilotChatUiHelper.displayResponse(o,i,{shouldShowWhenFluxSkillResponseRequired:!1}),(0,r.yw9)("OfficeVSO_8533885_SharedFluxProcessing")&&this.dispatch((0,jt.nv)((0,na.N)(o),$t.Aw.failed,i)),this.telemetryEventHandler.logLatency((0,x.xJ)(n),x.OP.ScheduleOfficeScriptsHiTLShown,!1,x.q.OfficeScripts)};this.dispatch(Wt.m.setLatestRequestId(t));const n=(new Date).getTime();let o;try{o=await(0,Pa.TQ)(e.scriptNameToSchedule,t)}catch(t){return void a(t,(0,d.kAS)().replace("{0}",e.scriptNameToSchedule))}try{const{message:a,telemetry:r}=await oa.n.getOfficeScriptsScheduleScriptHiTLResponse(o,e.schedulePlanExplanation,e.scheduleType,JSON.parse(e.schedulePlan),t);this.copilotChatUiHelper.displayResponse(a,r,{shouldShowWhenFluxSkillResponseRequired:!0}),this.telemetryEventHandler.logLatency((0,x.xJ)(n),x.OP.ScheduleOfficeScriptsHiTLShown,!0,x.q.OfficeScripts)}catch(e){return void a(e,(0,d.mF)())}if((0,r.yw9)("OfficeVSO_8533885_SharedFluxProcessing")){const{message:e,telemetry:t}=oa.n.getOfficeScriptsScheduleScriptFluxResponse();this.dispatch((0,jt.nv)((0,na.N)(e),$t.Aw.success,t))}}async showPythonStartAnalysisCard(e,t){if((0,r.H2A)())try{(0,$a._8)(x.KZ.SubmitPythonStartAnalysisQuery),this.dispatch(Wt.m.setLatestRequestId(e));const a=await(0,Fa.eU)(),n=a!==Excel.CalculationMode.automatic,o=await(0,Fa.RW)();if((0,Na.cY)(`Python Analysis Sheet Metadata: ${o}`),(0,r.yw9)("OfficeVSO_10271339_BlockPythonAAMode")&&(0,Fa.$)())throw(0,_a.fB)();(0,r.iq2)()?oa.n.displayPythonStartAnalysisButtonExperimentResponse(this.dispatch,e,n,o,t):oa.n.displayPythonStartAnalysisResponse(this.dispatch,e,n,o,t),(0,$a.DC)(Gt.$.StartAnalysis,a),(0,Ya.oO)(),Yt.CP.pythonContextManager.recalcSheet(!0)}catch(e){let t;t=e instanceof Error&&(0,_a.HH)(e)?(0,_a.j9)(Ga.O.PythonStartAnalysisEditModeError,"",e):e,(0,_a.Kx)(this.dispatch,t,"showPythonStartAnalysisCard",!0)}}showStartDataShapingCard(e,t,a,n,o,r,i){const l={success:!1,requestId:e,sessionId:t};try{this.dispatch(Wt.m.setLatestRequestId(e));const{message:s,telemetry:c}=oa.n.displayStartDataShapingResponse(e,a,t,n,o,r,i),d=(0,na.N)(s);this.dispatch((0,jt.nv)(d,$t.Aw.success,c,!1)),l.success=!0}finally{try{this.dispatch((0,jt.L4)())}catch{}T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:x.a5.DataShapingShowStartCard,[x.h3.ChatEventParameters]:JSON.stringify(l)},S.M.getInstance())}}showDataShapingErrorCard(e,t,a,n,o){const r={success:!1,requestId:e,sessionId:t,errorSource:a,errorCode:n};try{this.dispatch(Wt.m.setLatestRequestId(e));const t=this.dispatch((0,jt.SW)());let a=t.started?(0,d.$oZ)():(0,d.A99)();switch(n){case"QueryTable":a=(0,d.bLM)();break;case"StepFromNLFailure":case"QueryFromNLFailure":case"QueryFromNLGiveup":a=(0,d.kSh)();break;case"NoRange":case"TableNotFound":a=(0,d.eMD)();break;case"PowerQueryApiFailure":case"ExplanationFailure":case"BaseQueryFailure":case"UnexpectedError":break;default:(0,aa.x)(n)}const{message:i,telemetry:l}=oa.n.getDataShapingErrorResponse(a,t.enableDebugging?o:void 0);s.$.getInstance().displayResponse(i,l);const c=(0,na.N)(i);this.dispatch((0,jt.nv)(c,$t.Aw.success,l,!1)),r.success=!0}finally{try{this.dispatch((0,jt.L4)())}catch{}T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:x.a5.DataShapingShowErrorCard,[x.h3.ChatEventParameters]:JSON.stringify(r)},S.M.getInstance())}}async enterPythonModeDirectly(e){try{if(Yt.CP.pythonContextManager.prePythonModeError)return void(0,_a.Kx)(this.dispatch,Yt.CP.pythonContextManager.prePythonModeError,Yt.CP.pythonContextManager.prePythonModeErrorFunction??"enterPythonModeDirectly - prePythonModeError",!1,!0);this.dispatch((0,jt.eM)(x.OP.PythonStartAnalysis)),Yt.CP.pythonContextManager.enterAdvancedAnalysisMode(),await ot.p.getInstance().handlePythonStartAnalysis(e)}catch(e){(0,Fa.Tk)(!1),(0,_a.Kx)(this.dispatch,e,"enterPythonModeDirectly",!1,!1,[],!0)}}async showPythonAdaCards(e,t,a){if((0,r.H2A)()){this.dispatch(Wt.m.startExecutingCommand({command:x.OP.Python,id:e}));try{this.dispatch(Wt.m.setLatestRequestId(e)),(0,r.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&(0,cn.i)()?(0,_a.lB)(a):(0,_a.iY)(a);const n=t.response;(0,Fa.PV)(n);let o=!1;const i=!!(0,Fa.i_)()||(0,Fa.ec)(n,"code");if((0,Fa.ec)(n,"suggestions")){const e=[(0,d.rhr)(),(0,d.DjY)()];this.dispatch((0,jt.dT)(e))}const l=(0,Fa.ec)(n,"code");for(let t=0;t<n.length;t++){let a=!1;const s=n[t],c=s.type;let u,m;switch((0,r.LhK)()&&Yt.CP.pythonContextManager.renderedCardCount>=2&&(Yt.CP.pythonContextManager.isAutoScrollingEnabled=!1),(0,r.EJJ)()&&(u=(0,an.C)([s]),m=an.p.getInstance(this.dispatch)),c){case"text":{const a=s.value.text;if(!a){const e="Text is missing in IPythonAdaTextResponseChunkValue";throw(0,_a.xp)(Ga.O.PythonMissingResponseValue,e)}if((0,Fa.i_)())m?.updateCard(e,s);else{Yt.CP.pythonContextManager.pythonContextBuilder.setLlmText(a);const e=i&&t===n.length-1;oa.n.displayPythonTextResponse(this.dispatch,a,!0,!1,e,[],u)}o=!0,(0,$a.DC)(Gt.$.Text);break}case"code":{const t=s.value;let a=t.code;const n=t.codeExplanation,i=t.codeLabel;let l="",c=null;if(!a){const e=`Code: ${a?"Defined":"Undefined"} Code Explanation: ${n?"Defined":"Undefined"} Code Label: ${i?"Defined":"Undefined"} in IPythonAdaCodeResponseChunkValue.`;throw(0,_a.xp)(Ga.O.PythonMissingResponseValue,e)}if((0,Fa.i_)())m?.updateCard(e,s);else{l=await(0,Fa.nC)(this.dispatch,Yt.CP),this.dispatch(Wt.m.setLatestRequestId(e)),a=(0,Fa.MA)(a,i);const t=new Ka(this.dispatch,e,l,a,n,i);if(c=await t.autoInsertPythonFormula(),!Yt.CP.pythonContextManager.shouldGenerate)break;const o=Wa.ExcelCalc.localAddressesFromSheetAddresses(c);Yt.CP.pythonContextManager.lastCodeAndPostViewMessage=oa.n.displayPythonCodeCardWithPendingPostView(this.dispatch,e,a,l,o,!1,n,i,u)}o=!0,(0,r.vEQ)()&&await(0,Fa.bf)(l,"A2"),(0,$a.DC)(Gt.$.Code);break}case"suggestions":{let e=s.value.suggestions;if((0,r.yw9)("OfficeVSO_10238808_upsell_aa_from_maa_suggestion_pill")&&(0,Fa.i_)()&&!Yt.CP.pythonContextManager.isPythonMode&&!(0,Fa.$)()&&(e=[(0,d.fkZ)(),...e]),!e){const e="Suggestions is missing in IPythonAdaSuggestionsResponseChunkValue";throw(0,_a.xp)(Ga.O.PythonMissingResponseValue,e)}this.dispatch((0,jt.dT)(e)),o=!0,(0,$a.DC)(Gt.$.Suggestions);break}case"finalText":{const l=`Final Text Index: ${t} Total Chunks: ${n.length}`;if(!r.RNg&&t!==n.length-1)throw(0,_a.xp)(Ga.O.PythonInvalidResponseOrder,l);const c=s.value.finalText;if(!c){const e="Final text is missing in IPythonAdaFinalTextResponseChunkValue";throw(0,_a.xp)(Ga.O.PythonMissingResponseValue,e)}(0,Fa.i_)()?m?.updateCard(e,s):(Yt.CP.pythonContextManager.pythonContextBuilder.setFinalResponse(c),oa.n.displayPythonTextResponse(this.dispatch,c,!0,!1,i,[],u)),o=!0,a=!0,(0,$a.DC)(Gt.$.FinalText),((0,r.vEQ)()||(0,r.o2C)())&&(Yt.CP.pythonContextManager.disableAutoScroll=!1);break}case"debugText":break;case"status":{const t=(0,r.L_n)(),n=(0,r.Xsz)();if(o=!0,!t){const e="Python response type status is not supported.";throw(0,_a.xp)(Ga.O.PythonUnsupportedResponseType,e)}const i=s.value,l=ln(i.status),c=i.shouldStopLoadingUi;n?""!==l?(oa.n.displayPythonTextResponse(this.dispatch,l,!1,!1,c,[],u),a=c,(0,$a.DC)(Gt.$.StatusMessage)):c&&(await this.dispatch((0,jt.L4)()),a=!0):c&&(i.status===Ra.r.AnswersLlmLoopLimitHit?m?.dismissLoadingUI(e):await this.dispatch((0,jt.L4)()),a=!0),a&&m?.resetCard();break}default:{const e=`Python response type ${c} is not supported.`;throw(0,_a.xp)(Ga.O.PythonUnsupportedResponseType,e)}}(0,Ya.tW)(t,l,a)}if(0===t.response.length&&!Yt.CP.pythonContextManager.isPythonMode){if((0,r.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")&&!(0,Fa.Gd)())return void(0,_a.Kx)(this.dispatch,(0,_a.XO)(),"showPythonStartAnalysisCard",!1);return void(ot.p.getInstance().getQueryOriginValue()===Pt.Rk.MsFormsSDX?(qt.B.getInstance().logSeenEvent(x.q.Python),this.enterPythonModeDirectly(x.BC.MsFormsSDX)):this.showPythonStartAnalysisCard(e,!1))}if(!o)throw(0,_a.xp)(Ga.O.PythonResponseAllDebugChunks);i&&ot.p.getInstance().deductCopilotCredit(e)}catch(e){(0,_a.Kx)(this.dispatch,e,"showPythonAdaCards",!0)}}}async showPythonCalculatedColumn(e,t){if(!(0,r.vom)())return;const a=e=>{const{message:t,telemetry:a}=oa.n.getPythonColumnSuggestionErrorResponse(e);s.$.getInstance().displayResponse(t,a);const n=(0,na.N)(t);this.dispatch((0,jt.nv)(n,$t.Aw.failed,a,!1)),this.dispatch((0,jt.L4)())};this.dispatch(Wt.m.startExecutingCommand({command:x.OP.PythonCalculatedColumn,id:e}));try{this.dispatch(Wt.m.setLatestRequestId(e));const n=Yt.CP.getActiveTable(),o=n?.sheetRange.sheet,r=n?.address,i="number"==typeof n?.sheetRange.range.topLeft.column?function(e,t,a){const n=a?1:0;return(0,Oa.z)(t+e+n)}(n.numColumns,n.sheetRange.range.topLeft.column,!0):void 0;if(!o||!r||!i)return void a((0,d.gg6)());if(n.tableLikeRange)return void a((0,d.YvV)());const l=async()=>{const a=(0,d.Nbb)(),{message:n,telemetry:l}=oa.n.getInsertSuggestionUserChat(a);s.$.getInstance().displayResponse(n,l);try{const a=new tn(this.dispatch,e,o,r,i,t.code,t.codeExplanation,t.columnName),n=x.OP.InsertPythonCalculatedColumn;this.dispatch((0,jt.eM)(n)),this.dispatch(Wt.m.setLatestRequestId((0,Va.A)())),await a.autoInsertPythonFormula()}catch(e){const{message:t,telemetry:a}=oa.n.getPythonColumnInsertErrorResponse(e,(0,d.JIA)());s.$.getInstance().displayResponse(t,a)}finally{this.dispatch((0,jt.L4)())}},{message:c,telemetry:u}=oa.n.getPythonCalculatedColumnSuggestionResponse(e,t,r,i,o,l);s.$.getInstance().displayResponse(c,u);const m=(0,na.N)(c);this.dispatch((0,jt.nv)(m,$t.Aw.success,u,!1))}catch(e){(0,_a.Kx)(this.dispatch,e,"showPythonAdaCards",!0)}finally{this.dispatch((0,jt.L4)())}}getAiResponses(e){return e?.odslResponse?.aiResponses}getOdslProgram(e){return e?.odslResponse?.odsl?.statements}async executeOdsl(e,t,a){try{this.dispatch(Wt.m.setLatestRequestId(t));const n=new Nt.K,i=await n.convert(e,this.copilotChatUiHelper.getLastUserUtterance()),l=new Ia(i);if((0,o.kc)(i)){this.telemetryLogger.endTriedActivityFailure();const e=(0,d.CDl)(),{message:t,telemetry:a}=oa.n.getMultipleEventsErrorResponse(e);this.copilotChatUiHelper.displayResponse(t,a,{shouldShowWhenFluxSkillResponseRequired:!1});const n=(0,na.N)(t);return void this.dispatch((0,jt.nv)(n,$t.Aw.failed,a))}(0,o.qw)(i)&&(0,r.avT)()&&Aa.y.getInstance().pushOdslCache("",e),await(0,Qt.$r)((0,d.Eyh)());const s=i.some((e=>e.agent===Dt.w2.Insights)),c={happened:!1,id:void 0};let u=!1;const m=new Promise(((e,t)=>{c.id=setTimeout((()=>{c.happened=!0,e(c)}),on.R.getOdslExecutionTimeout(s,Yt.CP.getActiveTableRowNumber()))})),h=l.execute(c,t,this.dispatch,(e=>this.handleODSLExecutionError(e)),a).finally((()=>{c.id&&clearTimeout(c.id),u=!0}));await Promise.race([m,h]),u||await h,await(0,Qt.TA)()}catch(e){await this.handleODSLExecutionError(e)}}async handleODSLExecutionError(e){const t=this.telemetryLogger.getActiveFeature();if(e.isOnlyUnsupportedEventsError&&e.unsupportedTypes.length>0)return Da(this.dispatch,e.unsupportedTypes),(0,r.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&S.M.getInstance().logStandardizedAshaErrorEvent(v.W.Missing_Copilot_Functionality,y.c.ODSL_Execution_Failed_Due_To_Unsupported_Commands,t),Promise.resolve();if(e.isMultipeEventsExecutionError){const e=(0,d.Rff)(),{message:a,telemetry:n}=oa.n.getMultipleEventsErrorResponse(e,{showUndo:!0},t);this.copilotChatUiHelper.displayResponse(a,n,{shouldShowWhenFluxSkillResponseRequired:!1});const o=(0,na.N)(a);return this.dispatch((0,jt.nv)(o,$t.Aw.failed,n)),S.M.getInstance().logStandardizedAshaErrorEvent(v.W.User_Input_Could_Not_Be_Processed,y.c.ODSL_Execution_Failed_With_Multiple_Events,t),Promise.resolve()}const a=!(0,r.yw9)("OfficeVSO_9612368_ExcludeAshaForHandoffToElse")||t!==x.BJ.Commanding&&t!==x.BJ.ConditionalFormatting;if(e.isConverterError&&(this.telemetryLogger.endTriedActivityFailure(),await this.handleConverterError(e,a)))return Promise.resolve();if(e.isHumanInTheLoopError&&(this.telemetryLogger.endTriedActivityFailure(),await this.handleHumanInTheLoopError(e)))return Promise.resolve();(0,kt.iG)(e)&&this.telemetryLogger.assertFeatureIsActive(x.BJ.Commanding,"handleODSLExecutionError: isCommandingError returned true but Commanding is not the active feature");const n=(0,kt.ip)(e),o=n?(0,d.OX0)():(0,d.BVu)(),{message:i,telemetry:l}=oa.n.getOdslExecutionFailedResponse(o,x.q0.OdslExecutionFailed);a&&(n?S.M.getInstance().logStandardizedAshaErrorEvent(v.W.User_Input_Could_Not_Be_Processed,y.c.ODSL_Execution_Failed_Due_To_Payload_Too_Large,t):e.isConverterError?S.M.getInstance().logStandardizedAshaErrorEvent(v.W.User_Input_Could_Not_Be_Processed,y.c.ODSL_Execution_Failed_Due_To_Converter_Error,t):S.M.getInstance().logStandardizedAshaErrorEvent(v.W.Unable_To_Complete_Task,y.c.ODSL_Execution_Failed_General_Error,t)),this.copilotChatUiHelper.displayResponse(i,l,{shouldShowWhenFluxSkillResponseRequired:!1,logAshaError:a});const s=(0,na.N)(i);return this.dispatch((0,jt.nv)(s,$t.Aw.failed,l)),this.dispatch((0,jt.Nl)()),Promise.resolve()}async handleHumanInTheLoopError(e){let t=(0,d.ir3)(),a=y.c.Missing_HITL_Intent_String,n=x.q0.OdslExecutionFailed;e.failureType===kt.UP.NoActiveTable&&(t=(0,d.SCL)(),a=y.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,n=x.q0.NoTableLikeEntityFound);const o=(0,r.yw9)("OfficeVSO_9631333_FixHiTLErrorToElse"),{message:i,telemetry:l}=oa.n.getOdslExecutionFailedResponse(t,n);let s;return o||this.copilotChatUiHelper.displayResponse(i,l,{shouldShowWhenFluxSkillResponseRequired:!0}),s=o?JSON.stringify({text:d.qbK.HumanInTheLoop.Error}):JSON.stringify({text:d.qbK.HumanInTheLoop.Error,publishPreference:ja.f$.Never}),this.dispatch((0,jt.nv)(s,$t.Aw.failed,l)),o||S.M.getInstance().logStandardizedAshaErrorEvent(v.W.Missing_Copilot_Functionality,a,x.BJ.Commanding),!0}async handleConverterError(e,t){if(!e?.failureType)return!1;let a="",n=!1,o=y.c.ODSL_Execution_Failed_Due_To_Converter_Error,i=v.W.User_Input_Could_Not_Be_Processed;switch(e.failureType){case kt.tJ.General:break;case kt.tJ.ColumnRowOutOfBoundary:a=(0,d.dw7)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,i=v.W.Missing_Copilot_Functionality;break;case kt.tJ.ColumnRowBySelection:a=(0,d.pwZ)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=v.W.Missing_Copilot_Functionality;break;case kt.tJ.ConditionalFormatFormulaInvalid:a=(0,d.T0z)(),n=!0,o=y.c.Conditional_Formatting_Failed_Due_To_Invalid_Formula,i=v.W.Unable_To_Complete_Task;break;case kt.tJ.ConditionalFormatFormulaExplanationInvalid:a=(0,d.T0z)(),n=!0,o=y.c.Conditional_Formatting_Failed_Due_To_Invalid_Formula_Explanation,i=v.W.Unable_To_Complete_Task;break;case kt.tJ.ClearSortUnsupported:a=(0,d.uy0)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=v.W.Missing_Copilot_Functionality;break;case kt.tJ.NoColumnArgument:case kt.tJ.ColorDistanceExceededThreshold:break;case kt.tJ.DeleteUnexpectedTableRows:a=(0,d.EoV)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=v.W.Missing_Copilot_Functionality;break;case kt.tJ.DeleteWithInsertColumns:a=(0,d.uvk)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=v.W.Missing_Copilot_Functionality;break;case kt.tJ.MultipleTableStructureChanges:a=(0,d.nKX)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt,i=v.W.Missing_Copilot_Functionality;break;case kt.tJ.NoSupportedNumberFormatCategoriesNumber:a=(0,d.Pot)(),n=!0,o=y.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,i=v.W.Unable_To_Complete_Task;break;case kt.tJ.NoActiveTable:a=(0,d.SCL)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,i=v.W.Missing_Copilot_Functionality;break;case kt.tJ.NoSupportedNumberFormatCategoriesDate:a=(0,d.aYy)(),n=!0,o=y.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,i=v.W.Unable_To_Complete_Task;break;case kt.tJ.NoSupportedNumberFormatCategoriesText:a=(0,d.nx1)(),n=!0,o=y.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,i=v.W.Unable_To_Complete_Task;break;case kt.tJ.NoSupportedNumberFormatCategoriesOther:a=(0,d.SS1)(),n=!0,o=y.c.Conditional_Formatting_Failed_Due_To_Invalid_Targets,i=v.W.Unable_To_Complete_Task;break;case kt.tJ.NoVisibleRange:a=(0,d._ZG)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets,i=v.W.Missing_Copilot_Functionality;break;case kt.tJ.NumericFilterOnNonNumberError:a=(0,d.Ehc)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Invalid_Targets,i=v.W.Unable_To_Complete_Task;break;case kt.tJ.TextualFilterOnNonTextError:a=(0,d.Ykh)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Invalid_Targets,i=v.W.Unable_To_Complete_Task;break;case kt.tJ.VariableCacheEntityTypeMismatched:a=(0,d.xk_)(),n=!0,o=y.c.ODSL_Execution_Failed_Due_To_Entity_Type_Mismatch,i=v.W.Unable_To_Complete_Task}if(n){const{message:e,telemetry:n}=oa.n.getOdslExecutionFailedResponse(a,x.q0.OdslExecutionFailed);this.copilotChatUiHelper.displayResponse(e,n,{shouldShowWhenFluxSkillResponseRequired:!1,logAshaError:!(0,r.yw9)("OfficeVSO_9750946_DoNotLogASHABeforeElseHandoff")||t});const l=(0,na.N)(e);this.dispatch((0,jt.nv)(l,$t.Aw.failed,n)),(0,r.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")&&t&&S.M.getInstance().logStandardizedAshaErrorEvent(i,o,this.telemetryLogger.getActiveFeature()),await this.dispatch((0,jt.L4)(!1))}return n}updateDevTelemetry(e,t,a,n,o){e&&this.dispatch(qa.m.setAugLoopSessionKey(e)),t&&this.dispatch(qa.m.setSydneyConversationId(t)),a&&this.dispatch(qa.m.setSydneyEndpoint(a)),n&&o&&o.length>0&&this.dispatch(qa.m.addQueryMetrics({queryId:n,metrics:o}))}logResponseMetadataTelemetry(e){switch(e.type){case Ft.VF.ElseResponseMeta:return void(0,Ba.OP)(e);case Ft.VF.CopilotChatResponseMeta:return void Ha(e);case Ft.VF.DocumentGroundingMeta:return void function(){const e=T.E.getInstance(),t=S.M.getInstance();e.updateTelemetryChatEventData({[x.h3.ChatEventType]:x.a5.DocumentGroundingShown},t)}();case Ft.VF.FormulaResponseMeta:return void(0,ha.tb)(e);default:return void S.M.getInstance().logError({eventType:Gt.S2.Error,errorMessage:`Unknown ResponseMetadata type - ${e.type}`,logLevel:oe.$b.Error})}}showUnsupportedTLRSuggestionListIfNeeded(e){(0,r.tgf)()&&e.errorType===x.q0.UnsupportedTabularRange&&e.errorDetails?.TabularRangeUnsupportedFeature&&this.dispatch((0,jt.x4)(e.errorDetails.TabularRangeUnsupportedFeature))}constructor(e){this.telemetryLogger=S.M.getInstance(),this.telemetryEventHandler=T.E.getInstance(),this.augloopSignalSentTime=null,this.canceledQueryIds=[],this.copilotChatUiHelper=s.$.getInstance(),this.isFirstResponse=!0,this.dispatch=e,(0,r.geU)()&&(this.officeJsCommanding=new Mt.$v(e)),this.scratchpad=new nn.O(e)}}var un=a(705730),mn=a(678934),hn=a(276126),gn=a(373971),pn=a(86240),bn=a(38417),fn=a(170530),Cn=a(408185),yn=a(397502),vn=a(70100),xn=a(290051),Tn=a(195666);const Sn=(e,t)=>e?.length>50?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("span",{title:e,children:t?(0,Na.Yp)(e):e}),(0,n.jsx)(yn.i,{getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([e],{type:"text/plain"})})})]}):(0,n.jsx)("span",{children:e??"-"}),wn=e=>{try{return JSON.stringify(e,void 0,4)}catch(t){return e}},En=(e,t,a)=>(0,n.jsx)("div",{children:(0,n.jsxs)(vn.B,{horizontal:!0,horizontalAlign:"space-between",children:[(0,n.jsx)("span",{style:{maxWidth:"90%",overflow:"hidden"},title:e,children:e}),(0,n.jsx)("span",{style:{color:a,paddingRight:"3px"},children:Sn(t,!0)})]})}),In=(e,t)=>En(e,t?"Active":"Inactive",t?"green":"red");function Rn(){const e=Cn.$.getInstance(),[t,a]=(0,R.useState)(e.updatesFromAugloopCount),[o,r]=(0,R.useState)(e.blockAnnotationReleaseMessageEnabled),[i,l]=(0,R.useState)(e.autoRefreshEnabled),s=e.getSessionsMap(),c=()=>{a(t+1)};return e.registerUIUpdater(c),(0,n.jsxs)("div",{className:"AugloopDiganosticsPaneContainer",children:[(0,n.jsx)(xn.K,{title:"Force Refresh",iconProps:{iconName:"Refresh"},onClick:async()=>{await e.refreshSessionDiagnosticsData(),c()}}),(0,n.jsx)(Tn.d,{checked:i,onChange:t=>{e.autoRefreshEnabled=t.currentTarget.checked,l(t.currentTarget.checked),S.M.getInstance()?.logEvent({eventType:Gt.S2.AugloopDiagnostics,eventData:[{key:Gt.A.AutoRefreshEnabled,value:t.currentTarget.checked}]})},label:"Auto Refresh",title:"Auto refresh the diagnostics on websocket activity"}),(0,n.jsx)(Tn.d,{checked:o,onChange:t=>{e.blockAnnotationReleaseMessageEnabled=t.currentTarget.checked,r(t.currentTarget.checked)},label:"Block Annotations Release",title:"CommunicationHandler to block annotations release messages"}),(0,n.jsx)("ul",{className:"tree",children:Array.from(s.keys()).map((e=>{const t=s.get(e);return(0,n.jsx)("li",{children:(0,n.jsxs)("details",{open:!0,children:[(0,n.jsxs)("summary",{children:["SessionKey: ",e]}),In("Status:",t.isActive),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:"Session Info"}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:En("sessionMode",t.sessionMode)}),(0,n.jsx)("li",{children:En("isCopilotLicensed",t.isCopilotLicensed?.toString())}),(0,n.jsx)("li",{children:En("isCopilotActivated",t.isCopilotActivated?.toString())}),(0,n.jsx)("li",{children:En("isLargeWorkbookSession",t.isLargeWorkbookSession?.toString())}),(0,n.jsx)("li",{children:En("observerSessionType",t.observerSessionType)}),(0,n.jsx)("li",{children:En("ecsSessionId",t.ecsSessionId)}),(0,n.jsx)("li",{children:En("ecsStateId",t.ecsStateId)}),(0,n.jsx)("li",{children:En("uiLanguage",t.clientMetadata?.uiLanguage)}),(0,n.jsx)("li",{children:En("docSessionId",t.clientMetadata?.docSessionId)}),(0,n.jsx)("li",{children:En("documentId",t.clientMetadata?.documentId)}),(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:"Client Flights"}),(0,n.jsx)("ul",{children:t.clientMetadata?.flights?.split(";").map((e=>{if(0!==e.length)return(0,n.jsx)("li",{children:Sn(e,!1)},e)}))})]})})]})]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:"Annotations Status"}),(0,n.jsx)("ul",{children:Array.from(t.annotationActivationStatus.keys()).map((e=>(0,n.jsx)("li",{children:In(e,t.annotationActivationStatus.get(e))},e)))})]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsxs)("summary",{children:["Annotations Activations (",t.activatedAnnotationTypes.size,"):"]}),(0,n.jsx)("ul",{children:Array.from(t.activatedAnnotationTypes.keys()).map((e=>(0,n.jsx)("li",{children:En(e,t.activatedAnnotationTypes.get(e))},e)))})]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsxs)("summary",{children:["Annotations Releases (",t.releasedAnnotationTypes.size,"):"]}),(0,n.jsx)("ul",{children:Array.from(t.releasedAnnotationTypes.keys()).map((e=>(0,n.jsx)("li",{children:En(e,t.releasedAnnotationTypes.get(e))},e)))})]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsxs)("summary",{children:["Annotations Received (",t.annotationsReceived.size,"):"]}),(0,n.jsx)("ul",{children:Array.from(t.annotationsReceived.keys()).map((e=>{const a=t.annotationsReceived.get(e).length;return(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:`${e} (${a})`}),(0,n.jsx)("ul",{children:Array.from(t.annotationsReceived.get(e)??[]).map((e=>{const t=JSON.stringify(e);return(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:Sn(t,!0)}),(0,n.jsx)("pre",{children:wn(e)})]})},t)}))})]})},e)}))})]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsxs)("summary",{children:["Custom Messages Sent (",t.clientSentMessages.size,"):"]}),(0,n.jsx)("ul",{children:Array.from(t.clientSentMessages.keys()).map((e=>(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:`${e} (${t.clientSentMessages.get(e)?.length})`}),(0,n.jsx)("ul",{children:Array.from(t.clientSentMessages.get(e)).map((e=>{const t=JSON.stringify(e);return(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:Sn(t,!0)}),(0,n.jsx)("pre",{children:wn(e)})]})},t)}))})]})},e)))})]})}),(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsxs)("summary",{children:["Connection Messages (",t.connectionMessages.length,"):"]}),(0,n.jsx)("ul",{children:t.connectionMessages.map((e=>{const t=JSON.parse(e);return(0,n.jsx)("li",{children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:Sn(e,!0)}),(0,n.jsx)("pre",{children:wn(t)})]})},e)}))})]})})]})]})},e)}))})]})}var An=a(411466);const Ln="http://www.w3.org/2000/svg";class kn{constructor(e,t){this.name=e,this.label=JSON.stringify(t,void 0,4),this.path=[...t.parentPath,t.id],this.parentPath=t.parentPath,this.children=[],this.hidden=!1,this.numberOfRows=0}}function Fn(e){0===e.children.length?e.numberOfRows=1:(e.numberOfRows=e.children.filter((e=>!e.hidden)).reduce(((e,t)=>(Fn(t),e+t.numberOfRows)),0),0===e.numberOfRows&&(e.numberOfRows=1))}function _n(e){return 0===e.children.length?1:1+Math.max(...e.children.map(_n))}function Pn(e,t){const a=function(e){let t;const a=new Map;if(e.forEach((e=>{const t=new kn(e.id,e);a.set(t.path.join("/"),t)})),Array.from(a.keys()).forEach((e=>{const n=a.get(e);if(0===n.parentPath.length)t=n;else{const t=n.parentPath.join("/"),o=a.get(t);if(!o)throw new Error(`mapAugloopModelToTreeNode: Parent node not found for node ${e}`);o.children.push(n)}})),!t)throw new Error("mapAugloopModelToTreeNode: Root node not found");return t}(t),n=document.createElementNS(Ln,"svg"),o=document.createElementNS(Ln,"g");o.setAttribute("transform","translate(40,0)"),n.appendChild(o);const r=e=>30*e.numberOfRows;function i(e,t,a,n){if(e.hidden)return;const r=document.createElementNS(Ln,"g");r.setAttribute("transform",`translate(${t},${a})`);const s=document.createElementNS(Ln,"title");s.textContent=e.label,r.appendChild(s);const c=document.createElementNS(Ln,"circle");c.setAttribute("r","6"),c.setAttribute("fill",0===e.children?.length?"#dddddd":"#8096c3"),r.appendChild(c);const d=document.createElementNS(Ln,"text");if(d.setAttribute("dy","3"),d.setAttribute("x",8..toString()),d.setAttribute("fill","black"),d.textContent=(0,Na.Yp)(e.name),r.appendChild(d),e.children.length>0){r.style.cursor="pointer",r.addEventListener("click",(()=>{e.children.forEach((e=>{e.hidden=!e.hidden})),l()}));const s=t+260;let c=a-e.numberOfRows/2*25;e.children.filter((e=>!e.hidden)).forEach((e=>{const r=c+e.numberOfRows/2*25;c=r+e.numberOfRows/2*25;const l=function(e,t,a,n){const o=document.createElementNS(Ln,"path"),r=Math.abs(a-e)/2,i=`M${e},${t} C${e+r},${t} ${a-r},${n} ${a},${n}`;return o.setAttribute("d",i),o.setAttribute("stroke","#dddddd"),o.setAttribute("fill","none"),o.setAttribute("class","link"),o}(t,a,s,r);o.appendChild(l),i(e,s,r,n+1)}))}o.appendChild(r)}function l(){for(;o.firstChild;)o.removeChild(o.firstChild);if(!a)throw new Error("updateTree: Tree is undefined");Fn(a);const e=268*_n(a),t=r(a);n.setAttribute("width",e.toString()),n.setAttribute("height",t.toString()),i(a,0,t/2,0)}l(),e.replaceChildren(n),null!==e.parentElement&&(e.parentElement.scrollTop+=r(a)/2)}const Nn=async()=>{try{const e=Cn.$.getInstance(),t=await e.retrieveModelFromAugloop();if(void 0===t.stringifiedModel)throw new Error("showModelVisualization: Stringified model is undefined");const a=JSON.parse(t.stringifiedModel),n=document.getElementById("augloopModelContainer");if(!n)return void(0,o.cY)(oe.$b.Error,"Model container element not found");Pn(n,a)}catch(e){(0,o.cY)(oe.$b.Error,`Failed to visualize model: ${e}`)}};function Mn(){const e=Cn.$.getInstance().getActiveSessionKey();return(0,n.jsxs)("div",{className:"AugloopDiganosticsPaneContainer",children:[(0,n.jsx)("strong",{children:"Active SessionKey:"}),(0,n.jsx)("br",{}),(0,n.jsx)("span",{children:e}),(0,n.jsx)("br",{}),(0,n.jsx)(An.r,{iconProps:{iconName:"VisioDiagram"},allowDisabledFocus:!0,disabled:e===Cn.b,onClick:Nn,children:"Visualize model"}),(0,n.jsx)("br",{}),(0,n.jsx)("div",{id:"augloopModelContainer"})]})}var On=a(386552);class Dn extends rn.KF{async executeTestCase(e){this.updateTestStateDetails(e,"Starting Test Execution");const t=(0,Va.A)();return e.context=await Yt.CP.getContextString(t),this.updateTestStateDetails(e,"Workbook Context Extracted"),!0}async startTestCase(e){return await Yt.CP.runWithNoContextRefresh((()=>super.startTestCase(e)))}async run(){for(const[e,t]of this.tests.entries())try{await(0,o.uk)(2e3);let e=!0;if(e=await this.startTestCase(t).catch((e=>this.failTest(t,new rn.GM(e)))).finally((async()=>await(0,o.uk)(2e3))),!e)continue;if(e=await this.executeTestCase(t).then((()=>(this.passTest(t),!0))).catch((e=>this.failTest(t,e))),!e)continue}catch(e){this.failTest(t,new rn.xR(this.run.name,e))}const e=JSON.stringify(this.finishedTests.map((e=>e.test.worked?{...e.test}:{...e.test,stateDetails:e.stateDetails,errors:e.test.endToEndErrors})));return await(0,On.PE)(e,"application/json",`context-${this.testFilename}.json`,this.resultFileDirHandle),this.finishedTests}constructor(e,t,a,n,o,r){super(e,t,a,n,!1,!1,o,(()=>{}),void 0,r)}}var Bn=a(528161),$n=a(533419),Hn=a(807570),Un=a(392029),qn=a(141989),Vn=a(980663),Gn=a(730953),Wn=a(754508),zn=a(141720),jn=a(267254),Qn=a(507658),Jn=a(902573),Yn=a(845328),Xn=a(737375),Zn=a(813296),Kn=a(810525),eo=a(593562),to=a(229270);const ao={width:"100%",height:"200px"},no=({isModalOpen:e,setIsModalOpen:t,sessionId:a,commandingResponse:o})=>(0,n.jsx)(Wn.l,{open:e,onOpenChange:(e,a)=>{t(a.open)},children:(0,n.jsx)(zn.E,{style:{maxWidth:"1000px",inset:"8px"},children:(0,n.jsxs)(jn.R,{children:[(0,n.jsx)(Qn.L,{action:(0,n.jsx)(Jn.z,{action:"close",children:(0,n.jsx)(pn.$,{appearance:"subtle","aria-label":"Close",icon:(0,n.jsx)(to.Jtj,{})})}),children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)("span",{children:"Commanding Responses"}),(0,n.jsx)(pn.$,{"aria-label":"Download",size:"medium",icon:(0,n.jsx)(dt.eiB,{}),onClick:()=>(async(e,t)=>{const a=JSON.stringify(Object.entries(t).map((([t,a])=>({query:a.userUtterance,context:a.context,file:e,officeScripts:a.response,worked:a.codeCompletedSuccessfully,queryId:t,returnedMessage:a.returnedMessage})))),n="commanding-responses"+(e?"-"+e:Date.now())+".json";(0,On.PE)(a,"application/json",n)})(a,o),children:"Download"})]})}),(0,n.jsx)(Yn.C,{children:oo(o)})]})})}),oo=e=>(0,n.jsx)(un.n,{multiple:!0,collapsible:!0,children:Object.entries(e).map((([e,{userUtterance:t,context:a,response:o,codeCompletedSuccessfully:r,returnedMessage:i}])=>{const l=(e=>{const t=(0,On.Hg)(e);return(0,n.jsxs)(mn.A,{value:"context",children:[(0,n.jsx)(hn.u,{children:"Context"}),(0,n.jsx)(gn.v,{children:(0,n.jsxs)(vn.B,{horizontal:!0,children:[(0,n.jsx)(Kn.T,{contentEditable:!1,resize:"vertical",style:ao,children:t}),(0,n.jsx)(mt.m,{content:"Copy",relationship:"label",children:(0,n.jsx)(pn.$,{"aria-label":"Copy",icon:(0,n.jsx)(bn.k8e,{}),onClick:()=>(0,On.lW)(t)})})]})})]})})(a),s=(e=>e?(0,n.jsxs)(mn.A,{value:"response",children:[(0,n.jsx)(hn.u,{children:"Response"}),(0,n.jsx)(gn.v,{children:(0,n.jsxs)(vn.B,{children:[(0,n.jsx)(Xn.D,{label:"Office Scripts Code",children:(0,n.jsxs)(vn.B,{horizontal:!0,children:[(0,n.jsx)(Kn.T,{contentEditable:!1,resize:"vertical",style:ao,children:e.code}),(0,n.jsx)(mt.m,{content:"Copy",relationship:"label",children:(0,n.jsx)(pn.$,{"aria-label":"Copy",icon:(0,n.jsx)(bn.k8e,{}),onClick:()=>(0,On.lW)(e.code)})})]})}),(0,n.jsx)(Xn.D,{label:"Code Explanation",children:(0,n.jsxs)(vn.B,{horizontal:!0,children:[(0,n.jsx)(Kn.T,{contentEditable:!1,resize:"vertical",style:ao,children:e.codeExplanation}),(0,n.jsx)(mt.m,{content:"Copy",relationship:"label",children:(0,n.jsx)(pn.$,{"aria-label":"Copy",icon:(0,n.jsx)(bn.k8e,{}),onClick:()=>(0,On.lW)(e.codeExplanation)})})]})}),(0,n.jsx)(Xn.D,{label:"Metadata",children:(0,n.jsx)(vn.B,{horizontal:!0,children:(0,n.jsx)(Kn.T,{contentEditable:!1,resize:"vertical",style:ao,children:JSON.stringify({returnsValue:e.returnsValue,canMakeChanges:e.canMakeChanges,...e.apiUsageMetadata??{}},null,2)})})})]})})]}):(0,n.jsx)("span",{style:{color:"red"},children:"No Response"}))(o),c=[];return o&&void 0!==r&&(c.push((e=>e?(0,n.jsx)("span",{style:{color:"green"},children:"Code Ran Successfully"}):(0,n.jsx)("span",{style:{color:"red"},children:"Code Run Failed"}))(r)),i&&c.push((e=>(0,n.jsxs)(mn.A,{value:"returnedMessage",children:[(0,n.jsx)(hn.u,{children:"Returned From Code Completion"}),(0,n.jsx)(gn.v,{children:(0,n.jsxs)(vn.B,{horizontal:!0,children:[(0,n.jsx)(Kn.T,{contentEditable:!1,resize:"vertical",style:ao,children:e}),(0,n.jsx)(mt.m,{content:"Copy",relationship:"label",children:(0,n.jsx)(pn.$,{"aria-label":"Copy",icon:(0,n.jsx)(bn.k8e,{}),onClick:()=>(0,On.lW)(e)})})]})})]}))(i))),(0,n.jsxs)(mn.A,{value:e,children:[(0,n.jsx)(hn.u,{icon:(0,n.jsx)(to.Roy,{}),size:"large",style:{overflow:"hidden"},children:(0,On.tx)(t,e)}),(0,n.jsx)(gn.v,{children:(0,n.jsxs)(un.n,{multiple:!0,collapsible:!0,children:[l,s,...c]})})]},e)}))});var ro=a(597982),io=a(596618),lo=a(887648);const so=(0,u.n)({devStack:{margin:"32px"}}),co=e=>{window.open(e,"_blank")},uo=({isModalOpen:e,setIsModalOpen:t,sessionId:a,augloopSessionKey:o,sydneyConversationId:r,sydneyEndpoint:i,dialogMountNode:l})=>{const s=`https://devui.sdf-devui.substrate-turing-enterprisedevui.eastus-sdf.cosmic-ppe.office.net/?entryPoint=shareUI&sourceConversationId=${r}`,c=`https://dataexplorer.azure.com/dashboards/c5389d47-6569-4e8d-bcec-4057c569820e?p-_sessionIds=v-${a}#19773814-791b-4a1c-a2ef-d1f66b692f6e`;return(0,n.jsx)(Wn.l,{open:e,onOpenChange:(e,a)=>{t(a.open)},children:(0,n.jsx)(zn.E,{mountNode:l,children:(0,n.jsxs)(jn.R,{children:[(0,n.jsx)(Qn.L,{action:(0,n.jsx)(Jn.z,{action:"close",children:(0,n.jsx)(pn.$,{appearance:"subtle","aria-label":"Close",icon:(0,n.jsx)(to.Jtj,{})})}),children:"Session Info"}),(0,n.jsxs)(Yn.C,{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:"Session Id:"})," ",a,a&&(0,n.jsx)(mt.m,{content:"Copy",relationship:"label",children:(0,n.jsx)(pn.$,{"aria-label":"Copy",icon:(0,n.jsx)(bn.Jg_,{}),appearance:"subtle",onClick:()=>(0,On.lW)(a)})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:"Augloop Session Key:"})," ",o,o&&(0,n.jsx)(mt.m,{content:"Copy",relationship:"label",children:(0,n.jsx)(pn.$,{"aria-label":"Copy",icon:(0,n.jsx)(bn.Jg_,{}),appearance:"subtle",onClick:()=>(0,On.lW)(o)})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:"Sydney Conversation Id:"})," ",r,r&&(0,n.jsx)(mt.m,{content:"Copy",relationship:"label",children:(0,n.jsx)(pn.$,{"aria-label":"Copy",icon:(0,n.jsx)(bn.Jg_,{}),appearance:"subtle",onClick:()=>(0,On.lW)(r)})})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:"Sydney Endpoint:"})," ",i]}),(0,n.jsx)("div",{children:a&&(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:"Kusto Dashboard: "}),(0,n.jsx)(ro.N,{onClick:()=>co(c),children:"Excel Copilot Shield Session Explorer"})]})}),(0,n.jsx)("div",{children:r&&(0,n.jsxs)("div",{children:[(0,n.jsx)("b",{children:"Sydney Dashboard: "}),(0,n.jsx)(ro.N,{onClick:()=>co(s),children:"DevUI Session Explorer"})]})})]})]})})})},mo=({isModalOpen:e,setIsModalOpen:t,sessionId:a,queryMetrics:o,dialogMountNode:r})=>(0,n.jsx)(Wn.l,{open:e,onOpenChange:(e,a)=>{t(a.open)},children:(0,n.jsx)(zn.E,{style:{maxWidth:"1000px",inset:"8px"},mountNode:r,children:(0,n.jsxs)(jn.R,{children:[(0,n.jsx)(Qn.L,{action:(0,n.jsx)(Jn.z,{action:"close",children:(0,n.jsx)(pn.$,{appearance:"subtle","aria-label":"Close",icon:(0,n.jsx)(to.Jtj,{})})}),children:(0,n.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,n.jsx)("span",{children:"Session Queries"}),(0,n.jsx)(pn.$,{"aria-label":"Download",size:"medium",icon:(0,n.jsx)(dt.eiB,{}),onClick:()=>(async(e,t)=>{const a=JSON.stringify(t),n="query-telemetry"+(e?"-"+e:"")+".json";(0,On.PE)(a,"application/json",n)})(a,o),children:"Download"})]})}),(0,n.jsx)(Yn.C,{children:ho(o)})]})})}),ho=e=>(0,n.jsx)(un.n,{multiple:!0,collapsible:!0,children:Object.entries(e).map((([e,{userUtterance:t,metrics:a}])=>(0,n.jsxs)(mn.A,{value:e,children:[(0,n.jsx)(hn.u,{icon:(0,n.jsx)(to.Roy,{}),size:"large",style:{overflow:"hidden"},children:(0,On.tx)(t,e)}),(0,n.jsx)(gn.v,{children:(0,n.jsx)(un.n,{multiple:!0,collapsible:!0,children:a.map(((e,t)=>(0,n.jsx)(go,{uniqueId:t,metric:e},t)))})})]},e)))}),go=({metric:e,uniqueId:t})=>{const a=(0,On.zz)(e),[o,r]=(0,R.useState)(!1),i=(0,On.Hg)(e.input),l=(0,On.Hg)(e.output),s=e.input!==i||e.output!==l;return(0,n.jsxs)(mn.A,{value:t,children:[(0,n.jsx)(hn.u,{children:a}),(0,n.jsx)(gn.v,{children:(0,n.jsxs)(vn.B,{children:[s&&(0,n.jsx)(Xn.D,{label:"Formatting",children:(0,n.jsx)(Zn.S,{label:"Skip json extraction?",checked:o,onChange:e=>r(e.currentTarget.checked)})}),(0,n.jsx)(Xn.D,{label:"Input",children:(0,n.jsx)(po,{content:o?e.input:i})}),(0,n.jsx)(Xn.D,{label:"Output",children:(0,n.jsx)(po,{content:o?e.output:l})})]})})]})};function po({content:e}){return(0,n.jsxs)(vn.B,{horizontal:!0,children:[(0,n.jsx)(Kn.T,{contentEditable:!1,resize:"vertical",style:{width:"100%"},value:e}),(0,n.jsx)(mt.m,{content:"Copy",relationship:"label",children:(0,n.jsx)(pn.$,{"aria-label":"Copy",icon:(0,n.jsx)(bn.k8e,{}),onClick:()=>(0,On.lW)(e)})})]})}function bo({setShouldShowFormulaDevButton:e}){const[t,a]=(0,R.useState)(!1),[o,i]=(0,R.useState)(!1),[l,s]=(0,R.useState)(!1),c=(0,lo.d4)((e=>e.dataAI.shouldShowFormulaDevButton)),d=(0,lo.d4)((e=>e.chat.dataShapingState.enableDebugging)),u=(0,Ke.j)(),m=(0,io.u)()??"none",{alSessionKey:h,sydneyConversationId:g,sydneyEndpoint:p,queryMetrics:b,commandingResponses:f}=(0,lo.d4)((e=>e.telemetry)),[C,y]=R.useState(null),v=so();return(0,n.jsxs)(vn.B,{className:v.devStack,children:[(0,r.cTR)()&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(pn.$,{onClick:()=>a(!0),children:"Show Session Info"}),(0,n.jsx)(eo.c,{}),(0,n.jsx)(pn.$,{onClick:()=>i(!0),children:"Show Query Telemetry"}),(0,n.jsx)(eo.c,{}),(0,r.geU)()&&f&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(pn.$,{onClick:()=>s(!0),children:"Show Commanding Responses"}),(0,n.jsx)(eo.c,{})]})]}),(0,n.jsx)(Tn.d,{checked:c,onChange:t=>{e(t.currentTarget.checked)},label:"Formula Dev Button"}),(0,n.jsx)(Tn.d,{checked:d,onChange:e=>{u(Wt.m.setDataShapingDebugging(e.currentTarget.checked))},label:"Data Shaping Dev Button"}),t&&(0,n.jsx)(uo,{isModalOpen:t,setIsModalOpen:a,sessionId:m,augloopSessionKey:h,sydneyConversationId:g,sydneyEndpoint:p,dialogMountNode:C}),o&&(0,n.jsx)(mo,{isModalOpen:o,setIsModalOpen:i,sessionId:m,queryMetrics:b,dialogMountNode:C}),l&&f&&(0,n.jsx)(no,{isModalOpen:l,setIsModalOpen:s,sessionId:m,commandingResponse:f}),(0,n.jsx)("div",{ref:y})]})}var fo=a(233939),Co=a(824075);const yo=(0,u.n)({list:{paddingTop:"4px",paddingBottom:"4px",paddingLeft:"4px",display:"flex",flexDirection:"column",alignItems:"flex-start",backgroundColor:"transparent"},item:{backgroundColor:"transparent","&:hover":{backgroundColor:C.k1.colorNeutralBackground2Hover,color:C.k1.colorNeutralForeground2Hover}}});function vo({setCannedOption:e,getCannedOption:t}){const[a,o]=R.useState({skillOverride:[t()??"no-override"]}),i=yo();return(0,n.jsx)("div",{className:i.list,children:(0,n.jsxs)(fo.c,{checkedValues:a,onCheckedValueChange:(t,{name:a,checkedItems:n})=>{n[0]&&"no-override"!==n[0]?e(n[0]):e(),o({[a]:n})},children:[(0,n.jsx)(Co.s,{name:"skillOverride",value:"flux-chartsAndPivotTables",className:i.item,children:"Use the Charts and PivotTables skill directly"}),(0,n.jsx)(Co.s,{name:"skillOverride",value:"flux-textAnalysis",className:i.item,children:"Use the Text Analysis skill directly"}),(0,n.jsx)(Co.s,{name:"skillOverride",value:"flux-createCalculatedColumns",className:i.item,children:"Use the Calculated Columns skill directly"}),(0,n.jsx)(Co.s,{name:"skillOverride",value:"flux-editDocument",className:i.item,children:"Use the Commanding skill directly"}),(0,r.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.DataShaping",!1)&&(0,n.jsx)(Co.s,{name:"skillOverride",value:"flux-dataShaping",className:i.item,children:"Use the Data Shaping skill directly"}),(0,n.jsx)(Co.s,{name:"skillOverride",value:"python",className:i.item,children:"Use the Python skill directly"}),(0,n.jsx)(Co.s,{name:"skillOverride",value:"flux-createCalculatedCell",className:i.item,children:"Use the Column Aggregation skill directly"}),(0,n.jsx)(Co.s,{name:"skillOverride",value:"flux-else",className:i.item,children:"Use the Else skill directly"}),(0,n.jsx)(Co.s,{name:"skillOverride",value:"no-override",className:i.item,children:"No override"})]})})}var xo=a(544707),To=a(831310),So=a(88994);const wo={status:-1,conversationSensitivityLabel:{id:"c179f820-d535-4b2f-b252-8a9c4ac14ec6",displayName:"Highly Confidential\\Microsoft Extended",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) and non employees can view, edit and reply.",priority:21,color:"#A80000",isEncrypted:!0},messagesToAddOrReplace:[{actionId:null,action:null,sourceRequestId:null,isCancelOption:!1,text:'enterprise search whats in excel file "FF document.xlsx" ?',author:"user",from:{id:null,name:null,partnerId:null},createdAt:"2024-09-29T13:04:27.4783232+00:00",timestamp:"2024-09-29T13:04:26.168+00:00",locale:"en-us",market:"en-us",region:"us",locationInfo:{timeZone:"America/New_York"},messageId:"7b8a3e38-0634-4ba8-a1b9-627cd449c3cf",requestId:"7b8a3e38-0634-4ba8-a1b9-627cd449c3cf",messageType:"Chat",experienceType:"Default",offense:"None",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"AugmentationLoop",groundingDataCount:0,clientContext:null,inputMethod:"Keyboard",queryAnnotations:[],turnCount:8,citations:[]},{text:'Based on the results from `search_enterprise`, there is an Excel file titled "FF document.xlsx" [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1) authored by **Guy Yom Tov**. The file was last modified this morning. The file contains multiple sheets, including "Sheet1" which contains numerical data and text in multiple columns and rows, and "Sheet2" which contains a list of tasks and notes. Another sheet, "Table1", contains a table with columns such as "Campaign Owner", "Campaign Name", "Launch Date", "Campaign Type", "Budget", "Revenue", "Total Users Targeted", and "Engaged Users". The table contains data about various campaigns, their owners, launch dates, types, budgets, revenues, total users targeted, and engaged users [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1). Is there anything specific you would like to know about this file?',hiddenText:'Based on the results from `search_enterprise`, there is an Excel file titled "FF document.xlsx" [^1^] authored by **Guy Yom Tov**. The file was last modified this morning. The file contains multiple sheets, including "Sheet1" which contains numerical data and text in multiple columns and rows, and "Sheet2" which contains a list of tasks and notes. Another sheet, "Table1", contains a table with columns such as "Campaign Owner", "Campaign Name", "Launch Date", "Campaign Type", "Budget", "Revenue", "Total Users Targeted", and "Engaged Users". The table contains data about various campaigns, their owners, launch dates, types, budgets, revenues, total users targeted, and engaged users [^1^]. Is there anything specific you would like to know about this file?',author:"bot",createdAt:"2024-09-29T13:04:48.1703965+00:00",timestamp:"2024-09-29T13:04:48.1703965+00:00",messageId:"a9d573f4-1db2-4549-9efc-5bbed7672a97",requestId:"7b8a3e38-0634-4ba8-a1b9-627cd449c3cf",messageType:"Chat",experienceType:"Default",offense:"Unknown",adaptiveCards:[{type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:'Based on the results from `search_enterprise`, there is an Excel file titled "FF document.xlsx" [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1) authored by **Guy Yom Tov**. The file was last modified this morning. The file contains multiple sheets, including "Sheet1" which contains numerical data and text in multiple columns and rows, and "Sheet2" which contains a list of tasks and notes. Another sheet, "Table1", contains a table with columns such as "Campaign Owner", "Campaign Name", "Launch Date", "Campaign Type", "Budget", "Revenue", "Total Users Targeted", and "Engaged Users". The table contains data about various campaigns, their owners, launch dates, types, budgets, revenues, total users targeted, and engaged users [1](https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1). Is there anything specific you would like to know about this file?',wrap:!0}]}],actionButtons:[],sourceAttributions:[{providerDisplayName:"FF document",seeMoreUrl:"https://microsoft.sharepoint-df.com/teams/XLIL_team/Shared%20Documents/guyomtov/FF%20document.xlsx?web=1",path:null,referenceMetadata:'{"type":"Excel","typeDescription":"Excel","referenceType":1,"context":"Guy Yom Tov modified on 9/29/24","hasAttachments":false,"refType":"Excel","dataSource":"SharePoint","sourceType":"File","resultSearchType":"Lexical","fromTuring":"","provenance":"SharePoint","itemId":"AAAAABVT5a96BHRInZE2l1Qj0D8HAEBDCM6yMvVOoNAvcu9tJI4AAAAAASMAAEBDCM6yMvVOoNAvcu9tJI4AAAIYZZYAAA2","fileName":"FF document.xlsx","fileType":"xlsx","isEnterprise":true,"sensitivityLabel":{"id":"f42aa342-8706-4288-bd11-ebb85995028c","displayName":"General","tooltip":"Business data which is NOT meant for public consumption. This can be shared with internal employees, business guests and external partners as needed.","priority":2,"color":"#0078D7","isEncrypted":false}}'}],entityRepresentations:[],feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"DeepLeo",suggestedResponses:[{text:"What are the details of the campaigns in the 'Table1' sheet?",hiddenText:"DynamicTurnN",author:"user",createdAt:"2024-09-29T13:04:49.0970144+00:00",timestamp:"2024-09-29T13:04:49.0970144+00:00",messageId:"d78be5a0-fbd9-4f24-9b81-c4c3d6ac10bc",messageType:"Suggestion",experienceType:"SuggestionPill",offense:"Unknown",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"SuggestionChipsService",groundingDataCount:0,clientContext:null},{text:"Tell me more about Guy Yom Tov",hiddenText:"DynamicTurnN",author:"user",createdAt:"2024-09-29T13:04:49.0970187+00:00",timestamp:"2024-09-29T13:04:49.0970187+00:00",messageId:"eb5b9ee6-f0bb-4477-baec-3224021f0673",messageType:"Suggestion",experienceType:"SuggestionPill",offense:"Unknown",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"SuggestionChipsService",groundingDataCount:0,clientContext:null},{text:"What other files has Guy Yom Tov authored?",hiddenText:"DynamicTurnN",author:"user",createdAt:"2024-09-29T13:04:49.0970213+00:00",timestamp:"2024-09-29T13:04:49.0970213+00:00",messageId:"5683af45-264a-49d6-bcf6-b495398e7968",messageType:"Suggestion",experienceType:"SuggestionPill",offense:"Unknown",feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"SuggestionChipsService",groundingDataCount:0,clientContext:null}],groundingDataCount:10,clientContext:null,turnCount:8,sensitivityLabel:{id:"c179f820-d535-4b2f-b252-8a9c4ac14ec6",displayName:"Highly Confidential\\Microsoft Extended",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) and non employees can view, edit and reply.",priority:21,color:"#A80000",isEncrypted:!0},citations:[]}],resultType:"Success",sessionKey:"fde07ae5-5825-4d48-a1f2-e3831f50e889"},Eo="Here are the top 10 stocks in the S&P 500 and their current stock prices:\n\n| Rank | Company          | Symbol | Current Stock Price |\n|------|------------------|--------|---------------------|\n| 1    | Apple Inc.       | AAPL   | \\$244.87             |\n| 2    | NVIDIA Corporation | NVDA   | \\$139.23             |\n| 3    | Microsoft Corporation | MSFT   | \\$414.77             |\n| 4    | Amazon.com, Inc. | AMZN   | \\$226.63             |\n| 5    | Meta Platforms, Inc. | META   | \\$703.77             |\n| 6    | Alphabet Inc. (Class A) | GOOGL  | \\$185.27             |\n| 7    | Broadcom Inc.    | AVGO   | \\$228.73             |\n| 8    | Tesla, Inc.      | TSLA   | \\$360.56             |\n| 9    | Berkshire Hathaway Inc. (Class B) | BRK.B  | \\$483.77             |\n| 10   | Alphabet Inc. (Class C) | GOOG   | \\$187.13             |\n\nPlease note that this AI-generated preview may be different from the data in the sources[1](https://www.slickcharts.com/sp500)[2](https://stockanalysis.com/list/sp-500-stocks/).\n\n[1](https://www.slickcharts.com/sp500): https://www.slickcharts.com/sp500\n[2](https://stockanalysis.com/list/sp-500-stocks/): https://stockanalysis.com/list/sp-500-stocks/",Io={status:-1,conversationSensitivityLabel:{id:"c179f820-d535-4b2f-b252-8a9c4ac14ec6",displayName:"Highly Confidential\\Microsoft Extended",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) and non employees can view, edit and reply.",priority:21,color:"#A80000",isEncrypted:!0},messagesToAddOrReplace:[{text:Eo,hiddenText:Eo,author:"bot",createdAt:"2024-09-29T13:04:48.1703965+00:00",timestamp:"2024-09-29T13:04:48.1703965+00:00",messageId:"a9d573f4-1db2-4549-9efc-5bbed7672a98",requestId:"7b8a3e38-0634-4ba8-a1b9-627cd448c3cf",messageType:"Chat",experienceType:"Default",offense:"Unknown",adaptiveCards:[{type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:Eo,wrap:!0}]}],actionButtons:[],sourceAttributions:[{sourceType:"CITATION",providerDisplayName:"S&P 500 Companies by Weight - SlickCharts",seeMoreUrl:"https://www.slickcharts.com/sp500",referenceMetadata:'{"type":"Web","referenceType":0,"hasAttachments":false,"suppressCitation":false}',isCitedInResponse:"True",searchQuery:"top 10 stocks in the S&P 500 and their current stock price",videoTimeLength:"0",videoDAPublicationDate:"",videoViewCount:""}],entityRepresentations:[],feedback:{tag:null,updatedOn:null,type:"None"},contentOrigin:"DeepLeo",groundingDataCount:10,clientContext:null,turnCount:8,citations:[]}],resultType:"Success",sessionKey:"fde07ae5-5825-4d48-a1f2-e3831f50e889"},Ro={status:-1,messagesToAddOrReplace:[{text:"search my contoso agent for sales",author:"user",from:{id:"2c6b42d2-89cf-4367-9b60-b3725a1930f1",name:null,partnerId:null},createdAt:"2025-05-06T13:16:09.1311892+00:00",timestamp:"2025-05-06T16:16:08.834+03:00",locale:"en",market:"en-us",region:"us",locationInfo:{country:"",state:"",city:"",timeZone:"Asia/Jerusalem",timeZoneOffset:3,isImplicitLocationIntent:!1},messageId:"54187858-297f-4a62-bd36-e4ee0f9c0673",requestId:"54187858-297f-4a62-bd36-e4ee0f9c0673",offense:"None",adaptiveCards:[],contentOrigin:"AugmentationLoop",inputMethod:"Keyboard",turnCount:2,sensitivityLabel:{id:"d9f23ae3-a239-45ea-bf23-f515f824c57b",displayName:"Confidential\\Microsoft FTE",tooltip:"Data is classified and protected. Microsoft Full Time Employees (FTE) can edit, reply, forward and print. Recipient can unprotect content with proper justification.",priority:3,color:"#FF8C00",isEncrypted:!0},filesAndLinksContextMetadata:{files:[{annotationType:"File",sensitivityLabel:null,id:"31db3845-d989-4226-aefc-949dd635e450",itemid:"31db3845-d989-4226-aefc-949dd635e450",index:null,fileName:"Fabric Data Agent POC.xlsx",annotatedFileName:null,fileType:"xlsx",fileContent:null,fileDescription:null,docMetadata:null,fileSize:null,tokenSize:null,isCopilotContext:!0,isDeclarativeAgentKnowledge:!1,isEmbedded:!1,fileInfo:{fileUrl:"https://microsoft.sharepoint-df.com/teams/XLIL_team/_layouts/15/Doc.aspx?sourcedoc=%7B31DB3845-D989-4226-AEFC-949DD635E450%7D&file=Fabric%20Data%20Agent%20POC.xlsx&action=default&mobileredirect=true",fileContainerUrl:null},isCitedInResponse:!0,copilotAction:0}],links:[],pages:null,userIpAddress:"128.94.10.80"},gptIdentifiers:[{id:"U_e21dad7c-2232-697d-3f80-c5957669543d.declarativeCopilot",source:"MOS3",version:"1.1.6",metaOSGlobalIdentifier:{metaOSSharedServicesTitleId:"U_e21dad7c-2232-697d-3f80-c5957669543d",teamsAppId:"727610b8-aa90-4392-869b-43fcbac9616e",packageRelativeAgentId:"declarativeCopilot"}}],messageType:"Chat",citations:[]},{text:"This is Excel Data Agent. I found the Contoso Sales Agent which is designed to answer sales-related questions about the Contoso company's sales data in fiscal year 2025 (FY25) [1](). \n\nHere is the data you requested [2]().",author:"bot",responseIdentifier:"Default",createdAt:"2025-05-06T13:16:16.8281882+00:00",timestamp:"2025-05-06T13:16:16.8281882+00:00",messageId:"762d134f-fe59-4ce8-a834-b6930f05d4e6",requestId:"54187858-297f-4a62-bd36-e4ee0f9c0673",offense:"None",adaptiveCards:[{type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",text:"This is Excel Data Agent. I found the Contoso Sales Agent which is designed to answer sales-related questions about the Contoso company's sales data in fiscal year 2025 (FY25) [1](). \n\nHere is the data you requested [2]().",wrap:!0}]}],sourceAttributions:[{sourceType:"CITATION",providerDisplayDescription:"",referenceMetadata:'{"type":"ThirdParty","referenceType":0,"hasAttachments":false,"referenceSubType":"text/plain","dataSource":"{\\"id\\":\\"CopilotPlugins.GPTActionOpenAIPlugin.eyJBY3F1aXNpdGlvblRpdGxlSWQiOiJVX2UyMWRhZDdjLTIyMzItNjk3ZC0zZjgwLWM1OTU3NjY5NTQzZCIsIkFjcXVpc2l0aW9uQXBwSWQiOiI3Mjc2MTBiOC1hYTkwLTQzOTItODY5Yi00M2ZjYmFjOTYxNmUiLCJHcHRJZCI6ImRlY2xhcmF0aXZlQ29waWxvdCIsIkdwdEFjdGlvbklkIjoicGx1Z2luLW1hbmlmZXN0In0=\\",\\"source\\":\\"MOS3\\",\\"data\\":{\\"PluginType\\":\\"OpenAIPlugin\\",\\"MetaOSAppId\\":\\"727610b8-aa90-4392-869b-43fcbac9616e\\",\\"MetaOSTitleId\\":\\"U_e21dad7c-2232-697d-3f80-c5957669543d\\",\\"MetaOSBotId\\":\\"\\",\\"GptId\\":\\"declarativeCopilot\\",\\"GptActionId\\":\\"plugin-manifest\\",\\"TitleIndex\\":\\"0\\",\\"PluginName\\":\\"Excel Data Agent\\",\\"AcquisitionContext\\":\\"User\\",\\"CatalogName\\":\\"MOS3\\",\\"AppKind\\":\\"UserCreated\\"},\\"version\\":\\"1.1.6\\"}","pluginType":"OpenAIPlugin","pluginId":"727610b8-aa90-4392-869b-43fcbac9616e","appKind":"UserCreated","suppressCitation":false,"isExternal":false,"isExcluded":false}',providerDisplayName:null,seeMoreUrl:null,isCitedInResponse:"True",imageLink:"",id:"7dafab7b-1f5f-4207-9bae-2e5a17a27c4b"},{sourceType:"CITATION",adaptiveCardJson:'[{"type":"AdaptiveCard","version":"1.5","body":[{"type":"Container","items":[{"type":"TextBlock","text":"Show me sales by region","weight":"Bolder","wrap":true},{"type":"Table","columns":[{"width":"auto"},{"width":"auto"}],"rows":[{"type":"TableRow","cells":[{"type":"TableCell","items":[{"type":"TextBlock","text":"Region","weight":"Bolder"}]},{"type":"TableCell","items":[{"type":"TextBlock","text":"Sales","weight":"Bolder"}]}]},{"type":"TableRow","cells":[{"type":"TableCell","items":[{"type":"TextBlock","text":"North"}]},{"type":"TableCell","items":[{"type":"TextBlock","text":"$10,000"}]}]}]},{"type":"ActionSet","id":"toggleDown","actions":[{"type":"Action.ToggleVisibility","title":"Show Query ","targetElements":["hiddenCard","toggleDown","toggleUp"]}]},{"type":"ActionSet","id":"toggleUp","isVisible":false,"actions":[{"type":"Action.ToggleVisibility","title":"Hide Query ","targetElements":["hiddenCard","toggleDown","toggleUp"]}]},{"type":"Container","id":"hiddenCard","isVisible":false,"items":[{"type":"TextBlock","text":"SELECT Region, SUM(Sales) as Sales FROM SalesData GROUP BY Region","wrap":true},{"type":"ActionSet","actions":[{"type":"Action.Execute","title":"Import Query","data":{"query":"SELECT Region, SUM(Sales) as Sales FROM SalesData GROUP BY Region"},"role":"Button","style":"positive"}]}]}]}]}]',providerDisplayDescription:"",referenceMetadata:'{"type":"ThirdParty","referenceType":0,"hasAttachments":false,"referenceSubType":"text/adaptivecardtemplate","dataSource":"{\\"id\\":\\"CopilotPlugins.GPTActionOpenAIPlugin.eyJBY3F1aXNpdGlvblRpdGxlSWQiOiJVX2UyMWRhZDdjLTIyMzItNjk3ZC0zZjgwLWM1OTU3NjY5NTQzZCIsIkFjcXVpc2l0aW9uQXBwSWQiOiI3Mjc2MTBiOC1hYTkwLTQzOTItODY5Yi00M2ZjYmFjOTYxNmUiLCJHcHRJZCI6ImRlY2xhcmF0aXZlQ29waWxvdCIsIkdwdEFjdGlvbklkIjoicGx1Z2luLW1hbmlmZXN0In0=\\",\\"source\\":\\"MOS3\\",\\"data\\":{\\"PluginType\\":\\"OpenAIPlugin\\",\\"MetaOSAppId\\":\\"727610b8-aa90-4392-869b-43fcbac9616e\\",\\"MetaOSTitleId\\":\\"U_e21dad7c-2232-697d-3f80-c5957669543d\\",\\"MetaOSBotId\\":\\"\\",\\"GptId\\":\\"declarativeCopilot\\",\\"GptActionId\\":\\"plugin-manifest\\",\\"TitleIndex\\":\\"0\\",\\"PluginName\\":\\"Excel Data Agent\\",\\"AcquisitionContext\\":\\"User\\",\\"CatalogName\\":\\"MOS3\\",\\"AppKind\\":\\"UserCreated\\"},\\"version\\":\\"1.1.6\\"}","pluginType":"OpenAIPlugin","pluginId":"727610b8-aa90-4392-869b-43fcbac9616e","appKind":"UserCreated","suppressCitation":false,"isExternal":false,"isExcluded":false}',providerDisplayName:null,seeMoreUrl:null,isCitedInResponse:"True",imageLink:"",id:"f53197dd-5781-4d73-a2de-a7b82ae1bfcc"}],contentOrigin:"DeepLeo",turnCount:2,gptIdentifiers:[{id:"U_e21dad7c-2232-697d-3f80-c5957669543d.declarativeCopilot",source:"MOS3",version:"1.1.6",metaOSGlobalIdentifier:{metaOSSharedServicesTitleId:"U_e21dad7c-2232-697d-3f80-c5957669543d",teamsAppId:"727610b8-aa90-4392-869b-43fcbac9616e",packageRelativeAgentId:"declarativeCopilot"}}],messageType:"Chat",citations:[]}],resultType:"Success",defaultChatName:"search my contoso agent for sales",sessionKey:"a309a6c8-df7c-414b-9587-95c4ea5fa03b"},Ao=async e=>{const t=(0,Va.A)(),{message:a,telemetry:n}=oa.n.getImportDataResponse({requestId:t,dataSources:[{id:"1",type:To.o.ExcelFile,sourceUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",sourceLocation:"Book6",sourceParentUrl:"XLIL_Team",sourceRelativePath:"Documents/Workbooks/AL",sourceName:"Users",seeMoreUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",powerQueryScript:'let Source = Excel.Workbook(File.Contents("https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx"), null, true), Users_Table = Source{[Item="Users",Kind="Table"]}[Data], ChangedType = Table.TransformColumnTypes(Users_Table,{{"Name", type text}, {"Age", Int64.Type}, {"Gender", type text}}) in ChangedType',columns:[{name:"Name"},{name:"Age"},{name:"Gender"}],sampleRows:[["John","25","male"],["Doe","30","male"],["Jane","35","female"]]},{id:"2",type:To.o.ExcelFile,sourceUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",sourceLocation:"Book6",sourceName:"Movies",seeMoreUrl:"https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx?web=1",powerQueryScript:'let Source = Excel.Workbook(File.Contents("https://microsoft-my.sharepoint-df.com/personal/shaharso_microsoft_com/Documents/Workbooks/AL/Book6.xlsx"), null, true), Movies_Table = Source{[Item="Movies",Kind="Table"]}[Data], ChangedType = Table.TransformColumnTypes(Movies_Table,{{"Movie", type text}, {"Date of Release", Int64.Type}, {"Rating", type number}, {"Genre", type text}}) in ChangedType',sourceParentUrl:"XLIL_Team",sourceRelativePath:"Documents/Workbooks/AL",columns:[{name:"Movie"},{name:"Date of Release"},{name:"Rating"},{name:"Genre"}],sampleRows:[["The Shawshank Redemption","1994","9.3","Drama"],["The Godfather","1972","9.2","Crime"],["The Dark Knight","2008","9.0","Action"],["The Godfather: Part II","1974","9.0","Crime"],["The Lord of the Rings: The Return of the King","2003","8.9","Adventure"]]}],messageId:"",userQueryGuid:"",clpData:void 0,performedFallbackToAllTables:!1,importType:x.q.ImportDataFromSearch});e(Wt.m.setLatestRequestId(t)),s.$.getInstance().displayResponse(a,n)},Lo=async e=>{await async function(e){const t=structuredClone(wo),a={...t,messagesToAddOrReplace:t.messagesToAddOrReplace.map((e=>{if(!(e.sourceAttributions&&e.text&&e.messageId&&e.requestId))return e;const t=(0,Va.A)(),a=(0,Va.A)(),n="(encrypted) "+e.text,o=e.sourceAttributions.map((e=>{const t=JSON.parse(e.referenceMetadata);return t.sensitivityLabel&&!1===t.sensitivityLabel.isEncrypted&&(t.sensitivityLabel.isEncrypted=!0,e.referenceMetadata=JSON.stringify(t)),e}));return{...e,messageId:t,requestId:a,text:n,sourceAttributions:o}}))};await ko(a,e)}(e)};async function ko(e,t){await So.s.getInstance().handleChatResponse(e,t);const a={...e,status:0,messagesToAddOrReplace:[],messages:e.messagesToAddOrReplace};So.s.getInstance().handleChatResponse(a,t)}var Fo=a(875042);const _o=async e=>{const t=(0,Va.A)();e(Wt.m.setLatestRequestId(t)),e(ua.m.startFetching(t)),e(Wt.m.startExecutingCommand({command:x.OP.CalculatedColumns,id:t})),e((0,ma.UN)(No(t,"1",["1"],["link"],["=SOME_FORMULA()"],[["1"],["2"]]))),e((0,jt.L4)())};function Po(e,t){const a=e.sheetRange.range.topLeft.row+1+1,n=e.sheetRange.range.bottomRight.row+1,o=[];for(let e=a;e<=n;e++)o.push(""+e*t);return o}const No=(e,t,a,n,o,r)=>({calculatedColumns:a.map(((e,t)=>({id:e,columnName:n[t],formula:o[t],title:"Mock Title",numberFormat:"0.0",description:"<p>Mock Description.</p>",formulaExplanation:"<p>This is just a mock formula:</p>\n<ul>\n<li>It is only enabled in local SDX.</li>\n<li>It is hardcoded and does not come from LLM.</li>\n<li>The value changes every time.</li>\n</ul>"}))),isAlternativeSuggestion:!1,previewValues:r,requestId:e,suggestionId:t,suggestionMetadata:{result:Fo.sR.Success},success:!0,H_:{T_:"AugLoop_ExcelIntelligence_CalculatedColumnSuggestion",B_:["AugLoop_Core_Annotation"]},ownerId:"ExcelIntelligenceSignal"}),Mo=(e,t,a,n,o)=>({calculatedCells:a.map(((e,t)=>({id:e,formula:n[t],insertionIndexes:[1],title:"Mock Title",numberFormat:"0.0",description:"<p>Mock Description.</p>",formulaExplanation:"<p>This is just a mock formula:</p>\n<ul>\n<li>It is only enabled in local SDX.</li>\n<li>It is hardcoded and does not come from LLM.</li>\n<li>The value changes every time.</li>\n</ul>"}))),isAlternativeSuggestion:!1,previewValues:o,requestId:e,suggestionId:t,suggestionMetadata:{result:Fo.sR.Success},success:!0,H_:{T_:"AugLoop_ExcelIntelligence_CalculatedCellSuggestion",B_:["AugLoop_Core_Annotation"]},metadata:{result:Fo.sR.Success},ownerId:"ExcelIntelligenceSignal"});var Oo=a(380049),Do=a(986984),Bo=a(606364),$o=a(700853),Ho=a(63919),Uo=a(23153),qo={};qo.styleTagTransform=q(),qo.setAttributes=B(),qo.insert=O().bind(null,"head"),qo.domAPI=N(),qo.insertStyleElement=H();_()(Uo.A,qo);Uo.A&&Uo.A.locals&&Uo.A.locals;a(117463);var Vo,Go=a(743934),Wo=a(986571),zo=a(831253),jo=a(82093),Qo=a(193263),Jo=a(379490),Yo=a(123440);!function(e){e.Cycle="Cycle"}(Vo||(Vo={}));class Xo{getExtensions(e){Xo.get(this.extensionsUrl,e)}getResource(e,t,a){t===Yo.IvyRenderer.Image?this.getImage(e,a):this.getJson(e,a)}getImage(e,t){this.callPost("image/png",e,t)}getJson(e,t){this.callPost("application/json",e,t)}callPost(e,t,a){const n={chartSettings:t,colorizer:this.colorizer};Xo.post(this.layoutUrl,e,n,a)}static post(e,t,a,n){const o=new XMLHttpRequest;o.open("POST",e),o.setRequestHeader("Accept",t),o.setRequestHeader("Content-Type","text/plain"),o.send(JSON.stringify(a)),Xo.completeAjax(o,Xo.callbackWrapper(n))}static callbackWrapper(e){return function(...t){e.apply(this,[t[0],{chartResource:t[1]}])}}static get(e,t){const a=new XMLHttpRequest;a.open("GET",e),a.send(null),Xo.completeAjax(a,t)}static completeAjax(e,t){e.onreadystatechange=()=>{e.readyState===XMLHttpRequest.DONE&&(200===e.status?t(null,JSON.parse(e.responseText)):t(`Edera RequestFailed StatusCode: ${e.status}`,null))}}constructor(e,t){this.extensionsUrl=e.extensionsUrl??`${e.base}/charts/extensions?clientId=${e.clientId}`,this.layoutUrl=e.layoutUrl??`${e.base}/charts/layout?clientId=${e.clientId}`,this.colorizer=t}}var Zo=a(910480),Ko=a(699302);const er=new Map;function tr(e,t){try{s.$.getInstance().resendChatHistorySignal(t,(t=>function(e,t){if(!e.richTextJson)return void r("message has no richTextJson");const a=JSON.parse(e.richTextJson),n=a?.body?.renderData;if(!n)return void r("message has no renderData");if(T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:x.a5.ChatHistoryImageResendEvent,[x.h3.ChatEventParameters]:JSON.stringify({featureName:x.q.CopilotChat,eventType:x.a5.ChatHistoryImageResendEvent})},S.M.getInstance()),"AnalyzeData_V1"===n.component)return n.props.chartImageUrl=t,delete n.props.visual.visual,{...e,richTextJson:JSON.stringify(a),images:[t],messageId:(0,Va.A)()};if("ChartAdaptiveCard_V1"===n.component){const n=er.get(e.messageId)??[],o=(0,Va.A)(),r=[...n,t];return er.set(e.messageId,r),er.set(o,r),{...e,richTextJson:JSON.stringify(a),images:r,messageId:o}}return void r(`Unsupported message component: ${n.component}`);function r(e){(0,o.cY)(o.SA.Error,"Error while resending chat history signal with an image",e),T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:x.q0.ChatHistoryImageResendFailed,[x.h3.ChatEventParameters]:JSON.stringify({featureName:x.q.CopilotChat,eventType:x.a5.ErrorMessage,errorType:x.q0.ChatHistoryImageResendFailed})},S.M.getInstance())}}(t,e)))}catch(e){(0,o.cY)("Error while resending chat history signal with an image",e)}}function ar(e){try{return`data:image/svg+xml;base64,${btoa(e.outerHTML)}`}catch(t){if("InvalidCharacterError"===t.name)return`data:image/svg+xml,${encodeURIComponent(e.outerHTML)}`;throw S.M.getInstance().logError({eventType:Gt.S2.ChatEvents,errorMessage:`getSvgDataUrl: Failed to convert SVG to data URL: ${t?.message}`,logLevel:oe.$b.Critical}),t}}class nr extends Qo.hA{get definition(){return this.getValue(nr.definitionProperty)}set definition(e){this.definition!==e&&(this.setValue(nr.definitionProperty,e),this.updateLayout())}internalRender(){return this.chartElement=document.createElement("div"),this.chartElement.className="chart",this.setupChartHost(),this.resizeObserver=new ResizeObserver((0,Zo.debounce)((([e])=>{e&&this.onChartChange()}),1e3)),this.resizeObserver.observe(this.chartElement),this.chartElement}getJsonTypeName(){return nr.JsonTypeName}updateLayout(e=!0){super.updateLayout(e),this.renderedElement&&this.layoutChart()}setupChartHost(){const e={base:`${(0,Ko.wF)()}/v3.0`,clientId:(0,Ko.fp)()},t={disableChartElementResize:!1,renderer:Yo.IvyRenderer.Svg},a={type:Vo.Cycle};this.host=new Yo.ChartHost(new Xo(e,a),t,this.chartElement),this.host.on("error",((e,t)=>{S.M.getInstance().logErrorCode(Ga.O.IvyWebFailure,new Error(t),Gt.S2.AnalyzeDataError,oe.$b.ASHA)}))}layoutChart(){if(this.definition){const e=JSON.parse(this.definition),t=.5,a=this.chartElement.clientWidth,n=a*t,o={attributes:!0,childList:!0,characterData:!0},r=()=>{const e=this.chartElement?.querySelector("svg");e&&(e.setAttribute("focusable","false"),e.setAttribute("role","img"),e.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.isChartImageSentToHistory||(tr(ar(e),""),this.isChartImageSentToHistory=!0)),this.observer.disconnect()};this.observer=new MutationObserver(r),this.observer.observe(this.chartElement,o),e.size={width:a,height:n},this.host?.setConfiguration(e)}}onChartChange(){this.layoutChart()}constructor(...e){super(...e),this.isChartImageSentToHistory=!1}}nr.JsonTypeName="Chart",nr.definitionProperty=new zo.XB(zo.uq.v1_0,"definition",!1),(0,Jo.__decorate)([(0,zo.MZ)(nr.definitionProperty)],nr.prototype,"definition",null);var or=a(944032);function rr({requestId:e,adaptiveCardDefinition:t,cardButtonCallback:a}){const o=(0,Ke.j)(),r=new Go.l;Go.v.populateWithDefaultElements(r),r.register("Carousel",Wo.FN,zo.uq.v1_6),r.register("Table",jo.XI,zo.uq.v1_5),r.register(nr.JsonTypeName,nr);const i=new Qo.Au;i.setElementRegistry(r);const l=new Qo.hq;l.hostConfig.fontFamily="Segoe UI, Helvetica Neue, sans-serif",l.hostConfig.containerStyles.default.borderColor="#000000",l.parse(t,i);const s=[];l.getAllActions().forEach((e=>{if(e instanceof Qo.eB&&e.data){e.remove();let t=e.title??"";"insert-all"===e.verb?t=d.olU.SuggestionPillAddInsights:"insert-current"!==e.verb&&"insert"!==e.verb&&"insert-static-chart"!==e.verb||(t=d.olU.RecommendationAddToNewSheet),s.push({...(0,or.r1)(t),handleButtonOnClick:a||(()=>{ir(l,e,o)})})}}));const c=l.render(),u=(0,n.jsx)(lr,{element:c});return(0,n.jsx)(or.lJ,{contentBody:u,cardButtons:s,requestId:e})}a(313897);const ir=(e,t,a)=>{if("insert-static-chart"===t.verb){const e=t.data;return void a((0,ba.gG)(e))}const n=t.data;if("insert-all"===t.verb){const e=n.visuals;if(!e)return void(0,o.cY)("No visuals to insert");a((0,ba.z$)(e,n.interpretation,n.tableName))}else if("insert-current"===t.verb){const t=n.visuals;if(!t)return void(0,o.cY)("No visuals to insert");const r=e.getElementById("carousel");if(!r)return void(0,o.cY)("Carousel element not found");const i=r.currentIndex;if(void 0===i||i<0||i>=t.length)return void(0,o.cY)("Invalid carousel index");a((0,ba.f0)(t[i],n.interpretation,n.tableName))}else if("insert"===t.verb){const e=n.visual;if(!e)return void(0,o.cY)("No visual to insert");a((0,ba.f0)(e,n.interpretation,n.tableName))}else(0,o.cY)("Unknown execute action")},lr=({element:e})=>{const t=R.useRef();return R.useEffect((()=>(e&&t.current&&t.current.appendChild(e),()=>{e&&t.current&&t.current.removeChild(e)})),[e]),(0,n.jsx)("span",{ref:t})};var sr=a(609138),cr={};cr.styleTagTransform=q(),cr.setAttributes=B(),cr.insert=O().bind(null,"head"),cr.domAPI=N(),cr.insertStyleElement=H();_()(sr.A,cr);sr.A&&sr.A.locals&&sr.A.locals;var dr=a(527227),ur=a(320989),mr=a(486092),hr=a(557277),gr=a(900105),pr=a(390620),br=a(255065),fr=a(1182),Cr=a(947719),yr=a(6862),vr=a(198784),xr=a(682902);const Tr=(0,u.n)({textColor:{color:C.k1.black},backgroundColor:{backgroundColor:C.k1.colorSubtleBackground}}),Sr=e=>{const t=(0,xr.D)();let a=!1;const[o,r]=R.useState([]),[i,l]=R.useState();R.useEffect((()=>{e.initializeUpdateCallbackLogic&&e.initializeUpdateCallbackLogic(w,s)}),[e.initializeUpdateCallbackLogic]);const s=(e,t)=>{a||(O((0,Na.VY)(d.olU.ChartDesignRecommendationsCardGeneratingText,{chartNumber:e+1,chartTotal:t})),$(d.olU.ChartDesignRecommendationsCardProcessingText1),setTimeout((()=>{a||$(d.olU.ChartDesignRecommendationsCardProcessingText2)}),1e3),setTimeout((()=>{a||$(d.olU.ChartDesignRecommendationsCardProcessingText3)}),2e3),setTimeout((()=>{a||$(d.olU.ChartDesignRecommendationsCardProcessingText4)}),3e3),setTimeout((()=>{a||$(d.olU.ChartDesignRecommendationsCardProcessingText5)}),4e3))},[c,u]=R.useState(null),[h,g]=R.useState(1),p=R.useRef(null),b=R.useRef(null),f=R.useRef(null);R.useEffect((()=>{p.current&&p.current.scrollIntoView({behavior:"smooth"}),b.current&&b.current.focus(),f.current&&f.current.focus()}),[c]);const C=e=>(e-50)/2,[y,v]=R.useState(C(400));R.useEffect((()=>{const e=document.getElementById("copilot-chat-input");if(null!==e){const t=window.getComputedStyle(e),a=parseFloat(t.width);v(C(a));const n=()=>{const t=window.getComputedStyle(e),a=parseFloat(t.width);v(C(a))};return window.addEventListener("resize",n),()=>{window.removeEventListener("resize",n)}}}),[]);const w=(t,n,o)=>{if(r([...t]),void 0!==o&&l((()=>o)),n){const n=t.filter((e=>e.resultType===Mt.qv.Success));a=!0,$(""),0===n.length?(U(!0),O(d.olU.ChartDesignRecommendationCardErrorMessage)):(U(!1),O(d.olU.ChartDesignRecommendationsPreviewDesignLabelViaOOUI),n.length>0&&g(n[0].id)),e.onAllRecommendationsAdded();const o=t.filter((e=>e.resultType===Mt.qv.PreviewUnavailable)),r=t.filter((e=>e.resultType===Mt.qv.FailedValidation)),i=t.filter((e=>e.resultType===Mt.qv.InternalError)),l=t.filter((e=>e.resultType===Mt.qv.NoSuggestion));T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:x.a5.ChartDesignRecommendationsAllPreviewsLoaded,[x.h3.ChatEventParameters]:JSON.stringify({Success:n.length,PreviewUnavailable:o.length,FailedValidation:r.length,InternalError:i.length,NoSuggestion:l.length,queryId:e.queryId})},S.M.getInstance())}},E=e=>{h!==e.id&&g(e.id)},[I,A]=R.useState(0),L=()=>{let t=null;0!==h&&(t=o[h-1],u(t),A((e=>e+1)),T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:x.a5.ChartDesignRecommendationsPreviewButtonClicked,[x.h3.ChatEventParameters]:JSON.stringify({index:h-1,previewClickCount:I+1,queryId:e.queryId,isChartTypeChanged:t?.isChartTypeChanged??!1,isDarkMode:t?.isDarkMode??!1,colorPaletteId:t?.colorPaletteId??"",isTitleLeftAligned:t?.isTitleLeftAligned??!1,isDataSourceRangeChanged:t?.isDataSourceRangeChanged??!1})},S.M.getInstance()),S.M.getInstance().startTriedActivity(x.q.ChartDesignRecommendations),S.M.getInstance().endTriedActivitySuccess(x.q.ChartDesignRecommendations))},k=()=>{u(null)},[F,_]=R.useState(!1),P=e=>{(0,vr.J)("Office.Excel.Copilot.DisableChartDesignRecommendations"),_(!0),T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:x.a5.ChartDesignRecommendationsOptOut,[x.h3.ChatEventParameters]:JSON.stringify({queryId:e})},S.M.getInstance())};R.useEffect((()=>{const e=document.getElementById("chartRecommendationCardFooter");e&&F&&e.blur()}),[F]);const[N,M]=R.useState(d.olU.ChartDesignRecommendationsAnalyzingCardText),O=e=>{M(e)},[D,B]=R.useState(""),$=e=>{B(e)},[H,U]=R.useState(!0);R.useEffect((()=>{const e=document.getElementById("previewDesignButton");e&&H&&e.blur()}),[H]);const q=()=>{if(c){if(!c.batchProcessor)throw S.M.getInstance().logError({eventType:Gt.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: Batch processor is not available for the selected chart recommendation.",logLevel:oe.$b.Error}),new Error("[ChartDesignRecommendations]: Batch processor is not available for the selected chart recommendation.");i?.(c.id-1,I,c.code,c.codeExplanation,c.batchProcessor,c.isChartTypeChanged,c.isDarkMode,c.colorPaletteId,c.isTitleLeftAligned,c.isDataSourceRangeChanged)}},V={childrenGap:10},G=((e,t)=>{const a={id:-1,resultType:Mt.qv.Success,scenegraphJSON:"",code:"",codeExplanation:[],summary:"",expandableListItems:[]},n=[],o=[a,a,a,a];for(let t=0;t<e.length;t++)o[t]=e[t];for(let e=0;e<o.length;e+=t)n.push(o.slice(e,e+t));return n})(o,2),W=(e,t)=>{const a=document.createElement("div");a.className="scenegraphChart";const n=document.getElementsByClassName("chart");n.length>0&&e.length>0&&n[0].parentElement?.appendChild(a);const o=new Yo.OfficeRenderHost,r=new Yo.ChartPlayer({renderer:Yo.IvyRenderer.Svg,disableChartElementResize:!1},a,o),i=JSON.stringify(JSON.parse(e),null,2),l=JSON.parse(`{"data":${i}}`);try{r.render(l,void 0)}catch(e){S.M.getInstance().logError({eventType:Gt.S2.SuggestionEvents,errorMessage:"Error rendering chart "+t,logLevel:oe.$b.Error})}return a.children[0].setAttribute("width","100%"),a.children[0].setAttribute("height","100%"),a.innerHTML},z={},j=y/1.6;z.width=`${y}px`,z.height=`${j}px`;const Q=[{type:hr.w.line,height:j}],J={width:"100%",height:"100%"},Y=e=>{switch(e){case Mt.qv.PreviewUnavailable:return d.olU.ChartDesignRecommendationsCardErrorPreviewUnavailable;case Mt.qv.FailedValidation:return d.olU.ChartDesignRecommendationsCardErrorFailedValidation;case Mt.qv.InternalError:return d.olU.ChartDesignRecommendationsCardErrorInternalError;case Mt.qv.NoSuggestion:return d.olU.ChartDesignRecommendationsCardErrorNoSuggestion;default:return""}},X=Tr();return(0,n.jsxs)(dr.Z,{className:"ChartRecommendationCard",children:[(0,n.jsx)(ur.a,{image:(0,n.jsx)(fr.hw,{className:"sparkleIcon",color:t.palette?.green||"#078107"}),header:(0,n.jsx)(m.E,{className:(0,mr.z)(X.textColor,"ChartRecommendationCardText"),children:d.olU.ChartDesignRecommendationsCardText})}),(0,n.jsx)("div",{className:"chart-card",ref:p,children:c?(0,n.jsxs)("div",{className:"expanded-view",children:[(0,n.jsx)(Un.Y,{className:"backToResultButton",iconProps:{iconName:"Back"},text:d.olU.ChartDesignRecommendationsBackToResultsButtonLabel,"aria-label":d.olU.ChartDesignRecommendationsBackToResultsButtonLabel,label:d.olU.ChartDesignRecommendationsBackToResultsButtonLabel,tabIndex:0,onClick:()=>{k()},onKeyDown:e=>"Enter"===e.key?k():null}),(0,n.jsx)("div",{className:(0,mr.z)(X.textColor,"chartContainer"),dangerouslySetInnerHTML:{__html:W(c.scenegraphJSON,e.queryId)},"aria-label":c.codeExplanation?c.codeExplanation[0]:""},c.id),(0,n.jsx)(gr.J,{className:(0,mr.z)(X.textColor,"chartRecommendationLabelApply"),tabIndex:-1,children:d.olU.ChartDesignRecommendationsApplyDesignLabel}),(0,n.jsx)("div",{className:(0,mr.z)(X.textColor,X.backgroundColor),children:(0,n.jsx)(br.h,{summary:c.summary,collapsedButtonLabel:ExcelCopilotCommandingHitlStrings.ChangeListCollapsedButtonLabel,expandedButtonLabel:ExcelCopilotCommandingHitlStrings.ChangeListExpandedButtonLabel,loadingLabel:ExcelCopilotCommandingHitlStrings.ChangeListLoadingLabel,expandableListItems:c.expandableListItems,isLoading:!1,isNotAvailable:!1})}),(0,n.jsx)(Un.Y,{componentRef:b,className:"applyDesignButton",iconProps:{iconName:"Accept"},text:d.olU.ChartDesignRecommendationsApplyButtonLabel,"aria-label":d.olU.ChartDesignRecommendationsApplyButtonLabel,label:d.olU.ChartDesignRecommendationsApplyButtonLabel,tabIndex:0,onClick:()=>{q()},onKeyDown:e=>"Enter"===e.key?q():null})]}):(0,n.jsxs)("div",{className:"chart-grid",children:[(0,n.jsx)(gr.J,{className:(0,mr.z)(X.textColor,"chartRecommendationLabel"),tabIndex:-1,children:N}),D&&(0,n.jsx)(gr.J,{className:(0,mr.z)(X.textColor,"chartRecommendationSubLabel"),tabIndex:-1,children:D}),(0,n.jsx)(vn.B,{enableScopedSelectors:!0,tokens:{childrenGap:10},children:G.map(((t,a)=>(0,n.jsx)(vn.B,{enableScopedSelectors:!0,horizontal:!0,verticalAlign:"start",tokens:V,children:t.map(((t,a)=>(0,n.jsx)(vn.B.Item,{className:"chartItem",children:-1===t.id?(0,n.jsx)("div",{style:z,children:(0,n.jsx)(pr.W,{shimmerElements:Q,style:J})}):t.resultType===Mt.qv.Success?(0,n.jsx)("div",{className:(0,mr.z)(X.textColor,h===t.id?"chartContainerSelected":"chartContainer"),dangerouslySetInnerHTML:{__html:W(t.scenegraphJSON,e.queryId)},role:"button",tabIndex:0,onKeyDown:e=>"Enter"===e.key?E(t):null,onClick:()=>E(t),"aria-label":t.codeExplanation?t.codeExplanation[0]:"","aria-pressed":t.id===h?"true":"false"},t.id):(0,n.jsx)("div",{style:z,className:"chartContainerError",tabIndex:-1,children:Y(t.resultType)},t.id)},a)))},a)))}),(0,n.jsx)(pn.$,{ref:f,className:"previewDesignButton",id:"previewDesignButton",disabled:H,icon:(0,n.jsx)(Cr.OB,{}),"aria-label":d.olU.ChartDesignRecommendationsPreviewButtonLabel,tabIndex:0,onClick:()=>{L()},onKeyDown:e=>"Enter"===e.key?L():null,children:d.olU.ChartDesignRecommendationsPreviewButtonLabel}),e.isTriggeredViaOOUI?null:(0,n.jsx)(pn.$,{className:"chartRecommendationCardFooter",id:"chartRecommendationCardFooter",disabled:F,icon:(0,n.jsx)(yr.sTx,{}),"aria-label":d.olU.ChartDesignRecommendationsCardFooterText,tabIndex:0,onClick:()=>{P(e.queryId)},onKeyDown:t=>"Enter"===t.key?P(e.queryId):null,children:d.olU.ChartDesignRecommendationsCardFooterText})]})})]})},wr={v:"5.12.1",fr:60,ip:0,op:391,w:1160,h:472,nm:"E",assets:[{id:"comp_0",nm:"P",fr:60,layers:[{ind:1,ty:4,nm:"C",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[0]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:19,s:[100]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:271.002,s:[100]},{t:283,s:[0]}]},r:{a:0,k:0},p:{a:1,k:[{i:{x:.1,y:1},o:{x:.33,y:0},t:0,s:[308.253,386.538,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:22,s:[308.253,442.538,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.409,y:.503},o:{x:.51,y:0},t:35,s:[308.253,442.538,0],to:[0,0,0],ti:[-79.667,-46.667,0]},{i:{x:.513,y:1},o:{x:.206,y:.294},t:62,s:[480.725,562.237,0],to:[79.667,46.667,0],ti:[0,0,0]},{i:{x:.833,y:.833},o:{x:.167,y:.167},t:137,s:[786.253,722.538,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.1,y:1},o:{x:.33,y:0},t:168,s:[786.253,722.538,0],to:[561.747,229.462,0],ti:[-298.333,-22.333,0]},{t:238,s:[2576.253,856.538,0]}],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:1,k:[{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:25,s:[100,100,100]},{i:{x:[.833,.833,.833],y:[.833,.833,.833]},o:{x:[.167,.167,.167],y:[.167,.167,.167]},t:36,s:[65,65,100]},{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:138,s:[65,65,100]},{i:{x:[.833,.833,.833],y:[.833,.833,.833]},o:{x:[.167,.167,.167],y:[.167,.167,.167]},t:149,s:[100,100,100]},{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:258,s:[100,100,100]},{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:267,s:[65,65,100]},{t:272,s:[100,100,100]}],l:2}},ao:0,ef:[{ty:25,nm:"D",np:8,en:1,ef:[{ty:2,nm:"S",v:{a:0,k:[0,0,0,1]}},{ty:0,nm:"O",v:{a:0,k:63.75}},{ty:0,nm:"D",v:{a:0,k:135}},{ty:0,nm:"D",v:{a:0,k:3}},{ty:0,nm:"S",v:{a:0,k:1}},{ty:7,nm:"S",v:{a:0,k:0}}]}],shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.08,-5.957],[0,0],[-4.209,5.193],[0,0],[-2.166,-.01],[0,0],[5.455,4.155],[0,0]],o:[[0,0],[.09,6.684],[0,0],[1.364,-1.683],[0,0],[6.857,.031],[0,0],[-4.74,-3.61]],v:[[-7.558,-.1],[-6.59,71.866],[6.107,76.27],[24.194,53.958],[29.778,51.312],[57.966,51.439],[62.329,38.607],[3.918,-5.882]],c:!0}},nm:"P"},{ty:"st",c:{a:0,k:[.984,.984,.984,1]},o:{a:0,k:100},w:{a:0,k:3},lc:1,lj:1,ml:4,nm:"S"},{ty:"fl",c:{a:0,k:[.067,.067,.067,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"S"}],ip:0,op:818,st:-82,ct:1},{ind:2,ty:4,nm:"G",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:0,s:[0]},{t:18,s:[100]}]},r:{a:0,k:0},p:{a:0,k:[524,588,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:.1,y:1},o:{x:.33,y:0},t:0,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-31,-51.312],[-31.125,-18.312],[-109.125,-18],[-109,-51]],c:!0}]},{i:{x:.1,y:1},o:{x:.167,y:.167},t:18,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-.5,-51.25],[-.625,-18.25],[-109.125,-18],[-109,-51]],c:!0}]},{i:{x:.83,y:1},o:{x:.33,y:0},t:45,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-.5,-51.25],[-.625,-18.25],[-109.125,-18],[-109,-51]],c:!0}]},{i:{x:.83,y:1},o:{x:.167,y:.167},t:60,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-.5,-51.25],[-.75,14.75],[-109.25,15],[-109,-51]],c:!0}]},{i:{x:.83,y:1},o:{x:.167,y:.167},t:69,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-.5,-51.25],[-.75,14.75],[-109.25,15],[-109,-51]],c:!0}]},{i:{x:.83,y:1},o:{x:.167,y:.167},t:80,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[109,-51],[108.75,15],[-109.25,15],[-109,-51]],c:!0}]},{i:{x:.1,y:1},o:{x:.17,y:0},t:93,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[109,-51],[108.75,15],[-109.25,15],[-109,-51]],c:!0}]},{t:114,s:[{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[109,-51],[109,51],[-109,51],[-109,-51]],c:!0}]}]},nm:"P"},{ty:"st",c:{a:0,k:[.075,.494,.263,1]},o:{a:0,k:100},w:{a:0,k:2},lc:1,lj:1,ml:4,nm:"S"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"G"}],ip:0,op:576,st:0,ct:1},{ind:3,ty:4,nm:"P",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[260,584,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-27,-42],[-35,-34],[-27,-26],[7,-26],[15,-34],[7,-42]],c:!0}},nm:"P"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-27,-8],[-35,0],[-27,8],[27,8],[35,0],[27,-8]],c:!0}},nm:"P"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,4.418],[-4.418,0],[0,0],[0,-4.418],[4.418,0],[0,0]],o:[[0,-4.418],[0,0],[4.418,0],[0,4.418],[0,0],[-4.418,0]],v:[[-35,34],[-27,26],[17,26],[25,34],[17,42],[-27,42]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[.879,.879,.879,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"P"}],ip:0,op:600,st:0,ct:1},{ind:4,ty:4,nm:"$",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[739.566,587.662,0],l:2},a:{a:0,k:[740.066,570.162,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[3.073,-.036],[3.798,-1.864],[3.148,-3.542],[1.002,-4.776],[1.002,-7.367],[3.155,-6.656],[3.155,-8.502],[1.002,-8.967],[1.002,-10.211],[.004,-10.211],[.004,-8.939],[-2.006,-8.061],[-2.765,-6.232],[-2.18,-4.541],[.004,-3.252],[.004,-.764],[-1.397,-1.078],[-2.58,-1.673],[-2.58,.221],[.004,.85],[.004,2.292],[1.002,2.292],[1.002,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-.946,-6.349],[.004,-7.34],[.004,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[1.979,-1.769],[1.002,-.791],[1.002,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[11.126,-.036],[11.851,-1.864],[11.201,-3.542],[9.055,-4.776],[9.055,-7.367],[11.208,-6.656],[11.208,-8.502],[9.055,-8.967],[9.055,-10.211],[8.057,-10.211],[8.057,-8.939],[6.047,-8.061],[5.288,-6.232],[5.873,-4.541],[8.057,-3.252],[8.057,-.764],[6.655,-1.078],[5.473,-1.673],[5.473,.221],[8.057,.85],[8.057,2.292],[9.055,2.292],[9.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[7.106,-6.349],[8.057,-7.34],[8.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[10.032,-1.769],[9.055,-.791],[9.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[-4.979,-.036],[-4.255,-1.864],[-4.904,-3.542],[-7.051,-4.776],[-7.051,-7.367],[-4.897,-6.656],[-4.897,-8.502],[-7.051,-8.967],[-7.051,-10.211],[-8.049,-10.211],[-8.049,-8.939],[-10.059,-8.061],[-10.817,-6.232],[-10.233,-4.541],[-8.049,-3.252],[-8.049,-.764],[-9.45,-1.078],[-10.633,-1.673],[-10.633,.221],[-8.049,.85],[-8.049,2.292],[-7.051,2.292],[-7.051,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-8.999,-6.349],[-8.049,-7.34],[-8.049,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[-6.073,-1.769],[-7.051,-.791],[-7.051,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[738,722]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[7.126,-.036],[7.851,-1.864],[7.201,-3.542],[5.055,-4.776],[5.055,-7.367],[7.208,-6.656],[7.208,-8.502],[5.055,-8.967],[5.055,-10.211],[4.057,-10.211],[4.057,-8.939],[2.047,-8.061],[1.288,-6.232],[1.873,-4.541],[4.057,-3.252],[4.057,-.764],[2.655,-1.078],[1.473,-1.673],[1.473,.221],[4.057,.85],[4.057,2.292],[5.055,2.292],[5.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[3.106,-6.349],[4.057,-7.34],[4.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[6.032,-1.769],[5.055,-.791],[5.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[-.927,-.036],[-.202,-1.864],[-.852,-3.542],[-2.998,-4.776],[-2.998,-7.367],[-.845,-6.656],[-.845,-8.502],[-2.998,-8.967],[-2.998,-10.211],[-3.996,-10.211],[-3.996,-8.939],[-6.006,-8.061],[-6.765,-6.232],[-6.18,-4.541],[-3.996,-3.252],[-3.996,-.764],[-5.397,-1.078],[-6.58,-1.673],[-6.58,.221],[-3.996,.85],[-3.996,2.292],[-2.998,2.292],[-2.998,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-4.946,-6.349],[-3.996,-7.34],[-3.996,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[-2.021,-1.769],[-2.998,-.791],[-2.998,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[738,578]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[3.126,-.036],[3.851,-1.864],[3.201,-3.542],[1.055,-4.776],[1.055,-7.367],[3.208,-6.656],[3.208,-8.502],[1.055,-8.967],[1.055,-10.211],[.057,-10.211],[.057,-8.939],[-1.953,-8.061],[-2.712,-6.232],[-2.127,-4.541],[.057,-3.252],[.057,-.764],[-1.345,-1.078],[-2.527,-1.673],[-2.527,.221],[.057,.85],[.057,2.292],[1.055,2.292],[1.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-.894,-6.349],[.057,-7.34],[.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[2.032,-1.769],[1.055,-.791],[1.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[738,450]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"}],ip:0,op:600,st:0,ct:1},{ind:5,ty:4,nm:"C",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[68,364,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0]],v:[[-5,5],[5,5],[5,-5]],c:!0}},nm:"P"},{ty:"rd",nm:"R",r:{a:0,k:1}},{ty:"fl",c:{a:0,k:[.74,.74,.74,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"C"}],ip:0,op:600,st:0,ct:1},{ind:6,ty:4,nm:"A",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[302,448,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:7,ty:4,nm:"A",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[302,584,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:44,s:[1,1,1,1]},{t:63,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:8,ty:4,nm:"A",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[302,720,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:92,s:[1,1,1,1]},{t:110,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:9,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[738,448,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:70,s:[1,1,1,1]},{t:88,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:10,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[738,584,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:70,s:[1,1,1,1]},{t:88,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:11,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[738,720,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[107,32]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:92,s:[1,1,1,1]},{t:110,s:[.906,.945,.925,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:12,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2239.729,438.812,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[37,12]},p:{a:0,k:[0,0]},r:{a:0,k:12},nm:"R"},{ty:"fl",c:{a:0,k:[.879,.879,.879,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:13,ty:4,nm:"C",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2683.69,440.232,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[.081,-.081],[0,0],[0,0],[0,0],[-.081,-.081],[0,0],[0,0],[0,0],[-.081,-.081],[0,0],[-.081,.081],[0,0],[0,0],[0,0],[-.081,.081],[0,0],[.081,.081],[0,0],[0,0],[0,0],[.081,.081],[0,0],[.081,-.081],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[-.063,.091],[0,0],[0,0],[0,0],[-.063,.091],[0,0],[.091,.063],[0,0],[0,0],[0,0],[.091,.063],[0,0],[.063,-.091],[0,0],[0,0],[0,0],[.063,-.091],[0,0],[-.091,-.063],[0,0],[0,0],[0,0],[-.091,-.063]],v:[[-2.719,-2.719],[-2.746,-2.687],[-2.719,-2.719],[-2.746,-2.687],[-2.719,-2.391],[-.328,0],[-2.719,2.391],[-2.746,2.423],[-2.719,2.719],[-2.687,2.746],[-2.391,2.719],[0,.328],[2.391,2.719],[2.423,2.746],[2.719,2.719],[2.746,2.687],[2.719,2.391],[.328,0],[2.719,-2.391],[2.746,-2.423],[2.719,-2.719],[2.687,-2.746],[2.391,-2.719],[0,-.328],[-2.391,-2.719],[-2.423,-2.746]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[.129,.129,.129,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"S"}],ip:0,op:600,st:0,ct:1},{ind:14,ty:4,nm:"C",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2567,854,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:.1,y:1},o:{x:.33,y:0},t:259,s:[{i:[[-.293,.293],[-.293,-.293],[0,0],[0,0],[-.293,-.293],[.293,-.293],[0,0],[.293,.293],[0,0]],o:[[.293,-.293],[0,0],[0,0],[.293,-.293],[.293,.293],[0,0],[-.293,.293],[0,0],[-.293,-.293]],v:[[-8.28,.47],[-7.22,.47],[-3.25,4.439],[7.22,-6.03],[8.28,-6.03],[8.28,-4.97],[-2.72,6.03],[-3.78,6.03],[-8.28,1.53]],c:!0}]},{i:{x:.1,y:1},o:{x:.33,y:0},t:274,s:[{i:[[-.293,.293],[-.293,-.293],[0,0],[0,0],[-.293,-.293],[.293,-.293],[0,0],[.293,.293],[0,0]],o:[[.293,-.293],[0,0],[0,0],[.293,-.293],[.293,.293],[0,0],[-.293,.293],[0,0],[-.293,-.293]],v:[[-8.28,.47],[-7.22,.47],[-3.25,4.439],[2.196,-1.054],[3.257,-1.054],[3.257,.007],[-2.72,6.03],[-3.78,6.03],[-8.28,1.53]],c:!0}]},{t:281,s:[{i:[[-.293,.293],[-.293,-.293],[0,0],[0,0],[-.293,-.293],[.293,-.293],[0,0],[.293,.293],[0,0]],o:[[.293,-.293],[0,0],[0,0],[.293,-.293],[.293,.293],[0,0],[-.293,.293],[0,0],[-.293,-.293]],v:[[-8.28,.47],[-7.22,.47],[-3.25,4.439],[7.22,-6.03],[8.28,-6.03],[8.28,-4.97],[-2.72,6.03],[-3.78,6.03],[-8.28,1.53]],c:!0}]}]},nm:"P"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"S"}],ip:0,op:600,st:0,ct:1},{ind:15,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2566,852,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[67,34]},p:{a:0,k:[0,0]},r:{a:0,k:11},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:142,s:[.741,.741,.741,1]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:155,s:[.063,.486,.255,1]},{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:259,s:[.063,.486,.255,1]},{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:274,s:[.438,.78,.593,1]},{t:284,s:[.063,.486,.255,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:16,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2566,852,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[67,34]},p:{a:0,k:[0,0]},r:{a:0,k:11},nm:"R"},{ty:"fl",c:{a:1,k:[{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:142,s:[.741,.741,.741,1]},{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:155,s:[.063,.486,.255,1]},{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:259,s:[.063,.486,.255,1]},{i:{x:[.1],y:[1]},o:{x:[.33],y:[0]},t:274,s:[.438,.78,.593,1]},{t:284,s:[.063,.486,.255,1]}]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:17,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2306.528,853,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[49.809,16.572]},p:{a:0,k:[0,0]},r:{a:0,k:12},nm:"R"},{ty:"fl",c:{a:0,k:[.879,.879,.879,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:18,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2342,852,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[89,34]},p:{a:0,k:[0,0]},r:{a:0,k:11},nm:"R"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:19,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2430,622,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[133,65]},p:{a:0,k:[0,0]},r:{a:0,k:4},nm:"R"},{ty:"fl",c:{a:0,k:[.933,.933,.933,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:20,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[2434,960,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0],[0,4.418]],o:[[0,0],[0,0],[0,0],[4.418,0],[0,0]],v:[[74.5,-144],[-74.5,-144],[-74.5,144],[66.5,144],[74.5,136]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[.961,.961,.961,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:0,op:600,st:0,ct:1},{ind:21,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1948,936,0],l:2},a:{a:0,k:[0,240,0],l:2},s:{a:1,k:[{i:{x:[.4,.4,.4],y:[1,1,1]},o:{x:[.29,.29,.29],y:[0,1.58,0]},t:291,s:[100,0,100]},{t:318,s:[100,100,100]}],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[40,120]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:0,k:[.443,.698,.557,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:291,op:723,st:91,ct:1},{ind:22,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1588,936,0],l:2},a:{a:0,k:[0,160,0],l:2},s:{a:1,k:[{i:{x:[.4,.4,.4],y:[1,1,1]},o:{x:[.29,.29,.29],y:[0,1.58,0]},t:285,s:[100,0,100]},{t:312,s:[100,100,100]}],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[40,80]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:0,k:[.631,.796,.706,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:285,op:723,st:91,ct:1},{ind:23,ty:4,nm:"R",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1228,936,0],l:2},a:{a:0,k:[0,80,0],l:2},s:{a:1,k:[{i:{x:[.4,.4,.4],y:[1,1,1]},o:{x:[.29,.29,.29],y:[0,1.58,0]},t:281,s:[100,0,100]},{t:308,s:[100,100,100]}],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[40,40]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"fl",c:{a:0,k:[.906,.945,.925,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:281,op:723,st:91,ct:1},{ind:24,ty:4,nm:"L",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:281,s:[0]},{t:295,s:[100]}]},r:{a:0,k:0},p:{a:0,k:[1589,696,0],l:2},a:{a:0,k:[1588,696,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:281,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-39.25,0],[110,0]],c:!1}]},{t:321,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-110,0],[110,0]],c:!1}]}]},nm:"P"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:281,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-39.25,-39.75],[110,-39.75]],c:!1}]},{t:321,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-110,-39.75],[110,-39.75]],c:!1}]}]},nm:"P"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:281,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-39.25,-80],[110,-80]],c:!1}]},{t:321,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-110,-80],[110,-80]],c:!1}]}]},nm:"P"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:281,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-39.25,-120.25],[110,-120.25]],c:!1}]},{t:321,s:[{i:[[0,0],[0,0]],o:[[0,0],[0,0]],v:[[-110,-120.25],[110,-120.25]],c:!1}]}]},nm:"P"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"},{ty:"st",c:{a:0,k:[.879,.879,.879,1]},o:{a:0,k:100},w:{a:0,k:1},lc:1,lj:1,ml:4,nm:"S"},{ty:"tr",p:{a:0,k:[1588,456]},a:{a:0,k:[0,0]},s:{a:0,k:[-100,-100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"L"}],ip:281,op:723,st:123,ct:1},{ind:25,ty:4,nm:"F",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1598,1e3,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:280,s:[{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-99.375,-8],[-107.375,0],[-99.375,8],[-89.125,8],[-81.125,0],[-89.125,-8]],c:!0}]},{t:303,s:[{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-109.5,-8],[-117.5,0],[-109.5,8],[-75.5,8],[-67.5,0],[-75.5,-8]],c:!0}]}]},nm:"P"},{ind:1,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:285,s:[{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-10.75,-8],[-18.75,0],[-10.75,8],[6.125,8],[14.125,0],[6.125,-8]],c:!0}]},{t:308,s:[{i:[[0,0],[0,-4.418],[-4.418,0],[0,0],[0,4.418],[4.418,0]],o:[[-4.418,0],[0,4.418],[0,0],[4.418,0],[0,-4.418],[0,0]],v:[[-29.5,-8],[-37.5,0],[-29.5,8],[24.5,8],[32.5,0],[24.5,-8]],c:!0}]}]},nm:"P"},{ind:2,ty:"sh",ks:{a:1,k:[{i:{x:0,y:1},o:{x:.001,y:0},t:289,s:[{i:[[0,4.418],[-4.418,0],[0,0],[0,-4.418],[4.418,0],[0,0]],o:[[0,-4.418],[0,0],[4.418,0],[0,4.418],[0,0],[-4.418,0]],v:[[70.125,0],[78.125,-8],[98.375,-8],[106.375,0],[98.375,8],[78.125,8]],c:!0}]},{t:312,s:[{i:[[0,4.418],[-4.418,0],[0,0],[0,-4.418],[4.418,0],[0,0]],o:[[0,-4.418],[0,0],[4.418,0],[0,4.418],[0,0],[-4.418,0]],v:[[57.5,0],[65.5,-8],[109.5,-8],[117.5,0],[109.5,8],[65.5,8]],c:!0}]}]},nm:"P"},{ty:"fl",c:{a:0,k:[.879,.879,.879,1]},o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:282,s:[0]},{t:292,s:[100]}]},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"F"}],ip:281,op:723,st:123,ct:1},{ind:26,ty:4,nm:"$",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:281,s:[0]},{t:303,s:[100]}]},r:{a:0,k:0},p:{a:0,k:[1079.066,611.162,0],l:2},a:{a:0,k:[1080.066,598.162,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[-4.979,-.036],[-4.255,-1.864],[-4.904,-3.542],[-7.051,-4.776],[-7.051,-7.367],[-4.897,-6.656],[-4.897,-8.502],[-7.051,-8.967],[-7.051,-10.211],[-8.049,-10.211],[-8.049,-8.939],[-10.059,-8.061],[-10.817,-6.232],[-10.233,-4.541],[-8.049,-3.252],[-8.049,-.764],[-9.45,-1.078],[-10.633,-1.673],[-10.633,.221],[-8.049,.85],[-8.049,2.292],[-7.051,2.292],[-7.051,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-8.999,-6.349],[-8.049,-7.34],[-8.049,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[-6.073,-1.769],[-7.051,-.791],[-7.051,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[3.073,-.036],[3.798,-1.864],[3.148,-3.542],[1.002,-4.776],[1.002,-7.367],[3.155,-6.656],[3.155,-8.502],[1.002,-8.967],[1.002,-10.211],[.004,-10.211],[.004,-8.939],[-2.006,-8.061],[-2.765,-6.232],[-2.18,-4.541],[.004,-3.252],[.004,-.764],[-1.397,-1.078],[-2.58,-1.673],[-2.58,.221],[.004,.85],[.004,2.292],[1.002,2.292],[1.002,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-.946,-6.349],[.004,-7.34],[.004,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[1.979,-1.769],[1.002,-.791],[1.002,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[11.126,-.036],[11.851,-1.864],[11.201,-3.542],[9.055,-4.776],[9.055,-7.367],[11.208,-6.656],[11.208,-8.502],[9.055,-8.967],[9.055,-10.211],[8.057,-10.211],[8.057,-8.939],[6.047,-8.061],[5.288,-6.232],[5.873,-4.541],[8.057,-3.252],[8.057,-.764],[6.655,-1.078],[5.473,-1.673],[5.473,.221],[8.057,.85],[8.057,2.292],[9.055,2.292],[9.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[7.106,-6.349],[8.057,-7.34],[8.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[10.032,-1.769],[9.055,-.791],[9.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[1078,454]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[-.927,-.036],[-.202,-1.864],[-.852,-3.542],[-2.998,-4.776],[-2.998,-7.367],[-.845,-6.656],[-.845,-8.502],[-2.998,-8.967],[-2.998,-10.211],[-3.996,-10.211],[-3.996,-8.939],[-6.006,-8.061],[-6.765,-6.232],[-6.18,-4.541],[-3.996,-3.252],[-3.996,-.764],[-5.397,-1.078],[-6.58,-1.673],[-6.58,.221],[-3.996,.85],[-3.996,2.292],[-2.998,2.292],[-2.998,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-4.946,-6.349],[-3.996,-7.34],[-3.996,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[-2.021,-1.769],[-2.998,-.791],[-2.998,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[7.126,-.036],[7.851,-1.864],[7.201,-3.542],[5.055,-4.776],[5.055,-7.367],[7.208,-6.656],[7.208,-8.502],[5.055,-8.967],[5.055,-10.211],[4.057,-10.211],[4.057,-8.939],[2.047,-8.061],[1.288,-6.232],[1.873,-4.541],[4.057,-3.252],[4.057,-.764],[2.655,-1.078],[1.473,-1.673],[1.473,.221],[4.057,.85],[4.057,2.292],[5.055,2.292],[5.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[3.106,-6.349],[4.057,-7.34],[4.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[6.032,-1.769],[5.055,-.791],[5.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[1078,614]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"gr",it:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[-.483,.463],[0,.757],[.433,.463],[.998,.36],[0,0],[-.638,-.387],[0,0],[.962,.046],[0,0],[0,0],[0,0],[.506,-.504],[0,-.715],[-.39,-.462],[-1.066,-.396],[0,0],[.524,.182],[.264,.214],[0,0],[-.925,-.004],[0,0],[0,0],[0,0]],o:[[.483,-.462],[0,-.656],[-.433,-.462],[0,0],[.797,.087],[0,0],[-.474,-.264],[0,0],[0,0],[0,0],[-.834,.082],[-.506,.504],[0,.665],[.39,.463],[0,0],[-.41,-.027],[-.524,-.182],[0,0],[.797,.415],[0,0],[0,0],[0,0],[.898,-.1]],v:[[3.126,-.036],[3.851,-1.864],[3.201,-3.542],[1.055,-4.776],[1.055,-7.367],[3.208,-6.656],[3.208,-8.502],[1.055,-8.967],[1.055,-10.211],[.057,-10.211],[.057,-8.939],[-1.953,-8.061],[-2.712,-6.232],[-2.127,-4.541],[.057,-3.252],[.057,-.764],[-1.345,-1.078],[-2.527,-1.673],[-2.527,.221],[.057,.85],[.057,2.292],[1.055,2.292],[1.055,.809]],c:!0}},nm:"$"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,.469],[-.633,.114],[0,0]],o:[[0,-.547],[0,0],[-.633,-.314]],v:[[-.894,-6.349],[.057,-7.34],[.057,-5.173]],c:!0}},nm:"$"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,-.447],[.652,-.1],[0,0]],o:[[0,.551],[0,0],[.652,.283]],v:[[2.032,-1.769],[1.055,-.791],[1.055,-2.862]],c:!0}},nm:"$"},{ty:"fl",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[100,100]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"},{ty:"tr",p:{a:0,k:[1078,774]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"$"}],ip:281,op:723,st:123,ct:1},{ind:27,ty:4,nm:"R",sr:1,ks:{o:{a:1,k:[{i:{x:[.833],y:[.833]},o:{x:[.167],y:[.167]},t:271,s:[0]},{t:285,s:[100]}]},r:{a:0,k:0},p:{a:0,k:[1548,724,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:1,k:[{i:{x:[0,0],y:[1,1]},o:{x:[.001,.001],y:[0,0]},t:271,s:[276,119]},{t:302,s:[276,170]}]},p:{a:0,k:[0,0]},r:{a:0,k:0},nm:"R"},{ty:"st",c:{a:0,k:[.38,.38,.38,1]},o:{a:0,k:100},w:{a:0,k:1},lc:1,lj:1,ml:4,nm:"S"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"R"}],ip:271,op:723,st:123,ct:1},{ind:28,ty:4,nm:"W",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1174,992,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,-152],[53.5,-152],[53.5,-120],[-53.5,-120]],c:!0}},nm:"P"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-164.5,-50],[-271.5,-50],[-271.5,-18],[-164.5,-18]],c:!0}},nm:"P"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-164.5,-16],[-271.5,-16],[-271.5,16],[-164.5,16]],c:!0}},nm:"P"},{ind:3,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-271.5,18],[-164.5,18],[-164.5,50],[-271.5,50]],c:!0}},nm:"P"},{ind:4,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-164.5,52],[-271.5,52],[-271.5,84],[-164.5,84]],c:!0}},nm:"P"},{ind:5,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-271.5,86],[-164.5,86],[-164.5,118],[-271.5,118]],c:!0}},nm:"P"},{ind:6,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-164.5,120],[-271.5,120],[-271.5,152],[-164.5,152]],c:!0}},nm:"P"},{ind:7,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-162.5,-50],[-55.5,-50],[-55.5,-18],[-162.5,-18]],c:!0}},nm:"P"},{ind:8,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-55.5,-16],[-162.5,-16],[-162.5,16],[-55.5,16]],c:!0}},nm:"P"},{ind:9,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-162.5,18],[-55.5,18],[-55.5,50],[-162.5,50]],c:!0}},nm:"P"},{ind:10,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-55.5,52],[-162.5,52],[-162.5,84],[-55.5,84]],c:!0}},nm:"P"},{ind:11,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-162.5,86],[-55.5,86],[-55.5,118],[-162.5,118]],c:!0}},nm:"P"},{ind:12,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-55.5,120],[-162.5,120],[-162.5,152],[-55.5,152]],c:!0}},nm:"P"},{ind:13,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[53.5,-118],[-53.5,-118],[-53.5,-86],[53.5,-86]],c:!0}},nm:"P"},{ind:14,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,-84],[53.5,-84],[53.5,-52],[-53.5,-52]],c:!0}},nm:"P"},{ind:15,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[53.5,-50],[-53.5,-50],[-53.5,-18],[53.5,-18]],c:!0}},nm:"P"},{ind:16,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,-16],[53.5,-16],[53.5,16],[-53.5,16]],c:!0}},nm:"P"},{ind:17,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[53.5,18],[-53.5,18],[-53.5,50],[53.5,50]],c:!0}},nm:"P"},{ind:18,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,52],[53.5,52],[53.5,84],[-53.5,84]],c:!0}},nm:"P"},{ind:19,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[53.5,86],[-53.5,86],[-53.5,118],[53.5,118]],c:!0}},nm:"P"},{ind:20,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[-53.5,120],[53.5,120],[53.5,152],[-53.5,152]],c:!0}},nm:"P"},{ind:21,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,-152],[55.5,-152],[55.5,-120],[162.5,-120]],c:!0}},nm:"P"},{ind:22,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[55.5,-118],[162.5,-118],[162.5,-86],[55.5,-86]],c:!0}},nm:"P"},{ind:23,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,-84],[55.5,-84],[55.5,-52],[162.5,-52]],c:!0}},nm:"P"},{ind:24,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[55.5,-50],[162.5,-50],[162.5,-18],[55.5,-18]],c:!0}},nm:"P"},{ind:25,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,-16],[55.5,-16],[55.5,16],[162.5,16]],c:!0}},nm:"P"},{ind:26,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[55.5,18],[162.5,18],[162.5,50],[55.5,50]],c:!0}},nm:"P"},{ind:27,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,52],[55.5,52],[55.5,84],[162.5,84]],c:!0}},nm:"P"},{ind:28,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[55.5,86],[162.5,86],[162.5,118],[55.5,118]],c:!0}},nm:"P"},{ind:29,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[162.5,120],[55.5,120],[55.5,152],[162.5,152]],c:!0}},nm:"P"},{ind:30,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,-152],[271.5,-152],[271.5,-120],[164.5,-120]],c:!0}},nm:"P"},{ind:31,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[271.5,-118],[164.5,-118],[164.5,-86],[271.5,-86]],c:!0}},nm:"P"},{ind:32,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,-84],[271.5,-84],[271.5,-52],[164.5,-52]],c:!0}},nm:"P"},{ind:33,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[271.5,-50],[164.5,-50],[164.5,-18],[271.5,-18]],c:!0}},nm:"P"},{ind:34,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,-16],[271.5,-16],[271.5,16],[164.5,16]],c:!0}},nm:"P"},{ind:35,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[271.5,18],[164.5,18],[164.5,50],[271.5,50]],c:!0}},nm:"P"},{ind:36,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,52],[271.5,52],[271.5,84],[164.5,84]],c:!0}},nm:"P"},{ind:37,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[271.5,86],[164.5,86],[164.5,118],[271.5,118]],c:!0}},nm:"P"},{ind:38,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0],[0,0]],v:[[164.5,120],[271.5,120],[271.5,152],[164.5,152]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"W"}],ip:0,op:600,st:0,ct:1},{ind:29,ty:4,nm:"F",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1366,172,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ks:{a:0,k:{i:[[0,0],[-2.209,0],[0,0],[0,-2.209],[0,0],[2.209,0],[0,0],[0,2.209]],o:[[0,-2.209],[0,0],[2.209,0],[0,0],[0,2.209],[0,0],[-2.209,0],[0,0]],v:[[-194.5,-35],[-190.5,-39],[-11.5,-39],[-7.5,-35],[-7.5,-27],[-11.5,-23],[-190.5,-23],[-194.5,-27]],c:!0}},nm:"P"},{ind:1,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-2.209],[0,0],[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0]],o:[[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0],[0,0],[0,-2.209],[0,0]],v:[[-329.5,-4],[-333.5,0],[-333.5,16],[-329.5,20],[329.5,20],[333.5,16],[333.5,0],[329.5,-4]],c:!0}},nm:"P"},{ind:2,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-2.209],[0,0],[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0]],o:[[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0],[0,0],[0,-2.209],[0,0]],v:[[-178.5,23],[-182.5,27],[-182.5,35],[-178.5,39],[329.5,39],[333.5,35],[333.5,27],[329.5,23]],c:!0}},nm:"P"},{ind:3,ty:"sh",ks:{a:0,k:{i:[[0,0],[-2.209,0],[0,0],[0,-2.209],[0,0],[2.209,0],[0,0],[0,2.209]],o:[[0,-2.209],[0,0],[2.209,0],[0,0],[0,2.209],[0,0],[-2.209,0],[0,0]],v:[[-333.5,27],[-329.5,23],[-257.5,23],[-253.5,27],[-253.5,35],[-257.5,39],[-329.5,39],[-333.5,35]],c:!0}},nm:"P"},{ind:4,ty:"sh",ks:{a:0,k:{i:[[0,0],[0,-2.209],[0,0],[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0]],o:[[-2.209,0],[0,0],[0,2.209],[0,0],[2.209,0],[0,0],[0,-2.209],[0,0]],v:[[-245.5,23],[-249.5,27],[-249.5,35],[-245.5,39],[-190.5,39],[-186.5,35],[-186.5,27],[-190.5,23]],c:!0}},nm:"P"},{ty:"fl",c:{a:0,k:[1,1,1,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"F"}],ip:0,op:600,st:0,ct:1},{ind:30,ty:4,nm:"B",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:0,k:[1366,768,0],l:2},a:{a:0,k:[0,0,0],l:2},s:{a:0,k:[100,100,100],l:2}},ao:0,shapes:[{ty:"gr",it:[{ty:"rc",d:1,s:{a:0,k:[683,384]},p:{a:0,k:[0,0]},r:{a:0,k:8},nm:"R"},{ty:"fl",c:{a:0,k:[.961,.961,.961,1]},o:{a:0,k:100},r:1,nm:"F"},{ty:"tr",p:{a:0,k:[0,0]},a:{a:0,k:[0,0]},s:{a:0,k:[400,400]},r:{a:0,k:0},o:{a:0,k:100},sk:{a:0,k:0},sa:{a:0,k:0},nm:"T"}],nm:"B"}],ip:0,op:600,st:0,ct:1}]}],layers:[{ind:1,ty:0,nm:"P",refId:"comp_0",sr:1,ks:{o:{a:0,k:100},r:{a:0,k:0},p:{a:1,k:[{i:{x:.1,y:1},o:{x:.33,y:0},t:0,s:[580,236,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.1,y:.1},o:{x:.33,y:.33},t:55,s:[1e3,340,0],to:[0,0,0],ti:[0,0,0]},{i:{x:.1,y:1},o:{x:.167,y:0},t:158,s:[1e3,340,0],to:[0,0,0],ti:[0,0,0]},{t:231,s:[580,236,0]}],l:2},a:{a:0,k:[1366,768,0],l:2},s:{a:1,k:[{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:0,s:[25,25,100]},{i:{x:[.833,.833,.833],y:[1,1,1]},o:{x:[.33,.33,.33],y:[0,0,0]},t:55,s:[70,70,100]},{i:{x:[.1,.1,.1],y:[1,1,1]},o:{x:[.167,.167,.167],y:[0,0,0]},t:158,s:[70,70,100]},{t:231,s:[25,25,100]}],l:2}},ao:0,w:2732,h:1536,ip:0,op:600,st:0}],markers:[]};var Er=a(611975);const Ir=(0,u.n)({textColor:{color:C.k1.black}}),Rr=e=>{const t=(0,xr.D)(),a={height:"114.228px",width:"280.73px",margin:"0px !important",backgroundColor:t.palette.themeLighter,border:"1px solid #d1d1d1"},o={marginTop:"6px",marginBottom:"6px",marginRight:"6px"},r=Ir();return(0,n.jsxs)(dr.Z,{className:"ChartRecommendationCard",children:[(0,n.jsx)(ur.a,{image:(0,n.jsx)(fr.hw,{className:"sparkleIcon",color:t.palette?.green||"#078107"}),header:(0,n.jsx)(m.E,{className:(0,mr.z)(r.textColor,"ChartRecommendationCardText"),children:d.olU.ChartDesignRecommendationsCardText})}),(0,n.jsx)("div",{className:"chart-card",children:(0,n.jsxs)("div",{className:"chart-grid",children:[(0,n.jsx)(gr.J,{className:(0,mr.z)(r.textColor,"chartRecommendationLabel"),tabIndex:-1,children:d.olU.ChartDesignRecommendationsPreviewDesignSnowballChartLabel1}),(0,n.jsx)(gr.J,{className:(0,mr.z)(r.textColor,"chartRecommendationLabel"),tabIndex:-1,children:(0,n.jsx)("b",{children:d.olU.ChartDesignRecommendationsPreviewDesignSnowballChartLabel2})}),e.isTriggeredViaOOUI?null:(0,n.jsx)("div",{className:"sourceLottie",style:o,tabIndex:-1,children:(0,n.jsx)(Er.A,{options:{animationData:wr,loop:!0,autoplay:!0,rendererSettings:{className:"sourceLottie"}},isClickToPauseDisabled:!0,style:a,ariaLabel:"animation"})})]})})]})};var Ar=a(223887),Lr=a(527691);const kr={cardStack:{"& > :first-child":{marginBottom:"2px"},backgroundColor:C.k1.neutralLight,color:C.k1.neutralDark},bulletList:{marginTop:"8px",marginBottom:"8px",paddingLeft:"25px"},bulletListHeader:{marginBottom:"4px"}},Fr=(0,u.n)(kr);function _r(e){return(0,n.jsx)(or.lJ,{contentBody:function(){const e=Fr();return(0,n.jsxs)(vn.B,{className:e.cardStack,children:[(0,n.jsx)(m.E,{children:(0,d.i3R)()}),(0,n.jsx)(m.E,{children:(0,d.pF5)()})]})}(),requestId:e.requestId,cardButtons:[]})}var Pr=a(923971),Nr=a(886866),Mr=a(824088),Or=a(740533),Dr=a(488229),Br=a(290766),$r=a(626128),Hr=a(688889),Ur=a(231160),qr=a(654417),Vr=a(215592),Gr=a(57980);const Wr=C.k1.neutralLight,zr=(0,Gr.l8)({sliderButton:{alignSelf:"flex-end",backgroundColor:Wr,border:Wr,alignItems:"center",paddingLeft:0,paddingRight:0,":hover":{color:C.k1.themePrimary+" !important",cursor:"pointer",backgroundColor:"inherit"}},excelFileNameLink:{color:C.k1.colorNeutralForeground3,fontSize:C.k1.fontSizeBase200,lineHeight:"16px",padding:"5px",verticalAlign:"super",fontWeight:"600",":hover":{color:C.k1.themePrimary,cursor:"pointer"}},excelFileNameLinkInner:{color:C.k1.colorNeutralForeground3},excelFileNameSuffix:{display:"block",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",direction:"rtl",textAlign:"left",maxWidth:"100%",fontSize:C.k1.fontSizeBase200,fontWeight:"400",padding:"0",marginBottom:"-12px",color:C.k1.colorNeutralForeground3},importButton:{height:"24px",padding:"0 8px",width:"fit-content"},folderIcon:{color:C.k1.colorNeutralForeground3,marginTop:"1px"}}),jr={title:{justifyContent:"start",...Vr.shorthands.padding("0px",0),"&:hover":{color:C.k1.themePrimary,"&:active":{color:C.k1.themeDarkAlt}},"&:disabled":{color:C.k1.neutralQuaternary}},snippet:{transition:"max-height 0.5s ease-in-out"},snippetVisible:{maxHeight:"1000px"},snippetHidden:{maxHeight:"0"}},Qr=(0,u.n)(jr);function Jr(e){const[t,a]=(0,R.useState)(!1),[o,r]=(0,R.useState)(!1),[i,l]=(0,R.useState)(!1),s=Qr(),c=i?(0,mr.z)(s.snippet,s.snippetVisible):(0,mr.z)(s.snippet,s.snippetHidden);return(0,R.useEffect)((()=>{t?(r(!0),setTimeout((()=>{l(!0)}),50)):(l(!1),setTimeout((()=>{r(!1)}),600))}),[t]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(pn.$,{size:"small",appearance:"transparent",onClick:()=>{a(!t),e.logBodyShown&&!t&&e.logBodyShown()},"aria-expanded":t,className:s.title,icon:t?(0,n.jsx)(Nr.g4$,{}):(0,n.jsx)(Nr.rLf,{}),iconPosition:"after",children:t?(0,d.Z4S)():(0,d.U45)()}),o&&(0,n.jsx)("div",{className:c,children:(0,n.jsx)(qr.$,{title:(0,d.m3r)(),content:(0,n.jsx)(n.Fragment,{children:e.query}),explanation:{explanation:e.explanation},alwaysShowExplanation:!0,telemetryUsageFeatureName:x.q.ImportDataFromSearch,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([e.query],{type:"text/plain"})}),ariaAttributes:{"aria-label":(0,d.m3r)()}})})]})}var Yr=a(553373),Xr=a(800862);const Zr=(e,t)=>{const a=t.slice(0,4).map(((e,t)=>({row:t+2,values:e})));return t.length>4&&a.push({row:6,values:e.map((e=>"..."))}),0===a.length?(S.M.getInstance().logError({eventType:Gt.S2.ImportData,errorMessage:"getSampleRows: No rows provided",logLevel:oe.$b.Warning}),[{row:"...",values:e.map((e=>"..."))}]):a};var Kr=a(509779);const ei=()=>(0,n.jsxs)("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,n.jsx)("path",{fill:"#fff",d:"M7.5 22h14c.275 0 .5-.225.5-.5V7h-3.5c-.827 0-1.5-.673-1.5-1.5V2H7.5c-.275 0-.5.225-.5.5v19c0 .275.225.5.5.5z"}),(0,n.jsx)("path",{fill:"#fff",d:"M21.293 6 18 2.707V5.5c0 .275.225.5.5.5h2.793z"}),(0,n.jsx)("path",{fill:"#605E5C",fillRule:"evenodd",d:"m22.56 5.854-4.414-4.415A1.51 1.51 0 0 0 17.086 1H7.5C6.673 1 6 1.673 6 2.5v19c0 .827.673 1.5 1.5 1.5h14c.827 0 1.5-.673 1.5-1.5V6.914c0-.4-.156-.777-.44-1.06zM18 2.707 21.293 6H18.5a.501.501 0 0 1-.5-.5V2.707zM7.5 22h14c.275 0 .5-.225.5-.5V7h-3.5c-.827 0-1.5-.673-1.5-1.5V2H7.5c-.275 0-.5.225-.5.5v19a.5.5 0 0 0 .5.5z",clipRule:"evenodd",opacity:".64"}),(0,n.jsx)("path",{fill:"#134A2C",d:"M19 17h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2z"}),(0,n.jsx)("path",{fill:"#185C37",d:"M15 17h-1v-2h1a1 1 0 1 1 0 2z"}),(0,n.jsx)("path",{fill:"#21A366",d:"M19 14h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2z"}),(0,n.jsx)("path",{fill:"#107C41",d:"M15 14h-1v-2h1a1 1 0 1 1 0 2z"}),(0,n.jsx)("path",{fill:"#33C481",d:"M19 11h-1a1 1 0 1 1 0-2h1a1 1 0 1 1 0 2z"}),(0,n.jsx)("path",{fill:"#21A366",d:"M15 11h-1V9h1a1 1 0 1 1 0 2z"}),(0,n.jsx)("path",{fill:"#107C41",d:"M2 19h10a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1z"}),(0,n.jsx)("path",{fill:"#F9F7F7",d:"m4.125 16 2.06-3.009L4.298 10h1.518l1.03 1.913c.095.18.16.316.196.405h.014c.067-.145.138-.285.213-.422L8.369 10h1.394l-1.936 2.974L9.813 16H8.329l-1.19-2.1a1.75 1.75 0 0 1-.142-.28H6.98a1.28 1.28 0 0 1-.138.271L5.617 16H4.125z"})]});const ti=({dataSourcesLength:e,performedFallbackToAllTables:t,messageId:a})=>(0,n.jsx)(Or.c,{children:(0,n.jsx)(Br.sA,{message:(()=>{if(t)return(0,d.Txd)();return Yr.qx.getInstance().doesMessageHaveFilteredExcelFiles(a)?(0,d.zb)():e>1?(0,d.h9u)():(0,d.u1U)()})(),values:[e]})}),ai=({selectedSourceIndex:e,dataSourcesLength:t,handlePrevious:a,handleNext:o})=>{const r=d.SGs;return(0,n.jsxs)(vn.B,{horizontal:!0,reversed:r,horizontalAlign:r?"end":"start",children:[(0,n.jsx)(pn.$,{size:"small",name:(0,d.Rcx)(),"aria-label":(0,d.Rcx)(),appearance:"transparent",icon:(0,n.jsx)(Nr.bP_,{}),className:zr.sliderButton,"aria-expanded":void 0,onClick:a}),(0,n.jsx)(Or.c,{style:{lineHeight:"24px"},children:(0,d.Dqz)().replace("{0}",`${e+1}`).replace("{1}",`${t}`)}),(0,n.jsx)(pn.$,{size:"small",name:(0,d.n1d)(),"aria-label":(0,d.n1d)(),appearance:"transparent",icon:(0,n.jsx)(Nr.KOR,{}),className:zr.sliderButton,"aria-expanded":void 0,onClick:o})]})},ni=({selectedTable:e,tableWasImported:t,handleAddToSheet:a,importDataStyles:o,loadingTimeouts:r})=>{const i={headerRow:1,columnLetters:Array.from({length:e.columns?.length||0},((e,t)=>String.fromCharCode(65+t))),columnHeaders:e.columns?.map((e=>e.name))||[],rows:Zr(e.columns||[],e.sampleRows||[])},l=t?(0,d.gTs)():(0,d.N0D)(),s=t?(0,n.jsx)(Nr.N5_,{}):(0,n.jsx)(Mr.rz9,{}),c=e.powerQueryScript;return(0,n.jsxs)(dr.Z,{children:[(0,n.jsxs)(Or.c,{children:[(0,n.jsxs)(vn.B,{horizontal:!0,grow:!0,horizontalAlign:"space-between",tokens:{childrenGap:5},styles:{root:{whiteSpace:"nowrap"}},children:[(0,n.jsxs)(vn.B.Item,{styles:{root:{overflow:"hidden"}},children:[(0,n.jsx)(mt.m,{relationship:"description",content:(0,d.yWm)(),children:(0,n.jsx)(ei,{})}),(0,n.jsx)(ro.N,{title:e.sourceLocation,className:o.excelFileNameLink,appearance:"subtle",href:e.seeMoreUrl,target:"_blank",children:(0,n.jsx)(Hr.E,{nowrap:!0,className:o.excelFileNameLinkInner,children:e.sourceLocation})})]}),(0,n.jsx)(Dr.E,{title:e.sourceName,shape:"rounded",color:"informative",size:"small",appearance:"filled",children:e.sourceName})]}),(0,n.jsxs)(vn.B,{horizontal:!0,tokens:{childrenGap:4},children:[(0,n.jsx)(to.aPM,{className:o.folderIcon}),(0,n.jsx)(gr.J,{className:o.excelFileNameSuffix,title:e.sourceRelativePath,children:e.sourceRelativePath})]})]}),(0,n.jsx)("div",{style:{height:"155px",marginTop:"-12px"},children:(0,n.jsx)(Xr.J,{uiTimeout:r.preview,theme:Ur.Q1.neutralV2,preview:i,type:$r.VS.Column,errorData:{errorCode:Ga.O.ImportDataTablePreviewNotUpdated,telemetryType:Gt.S2.ImportData,telemetryFeature:x.BJ.ImportData}})}),(0,n.jsx)(vn.B,{tokens:{childrenGap:0},children:(0,n.jsx)(Jr,{query:c,explanation:(0,d.Iiw)(),logBodyShown:()=>{var t,a;t=e.id,a=x.a5.ImportDataExplainButtonClicked,T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:a,[x.h3.ChatEventParameters]:t},S.M.getInstance())}})}),(0,n.jsx)(vn.B,{tokens:{childrenGap:0},children:(0,n.jsx)(pn.$,{className:o.importButton,size:"small",title:l,icon:s,disabled:t,onClick:a,children:l})})]})},oi=({importType:e,requestId:t,dataSources:a,messageId:o,userQueryGuid:i,performedFallbackToAllTables:l})=>{const s=(0,Ke.j)(),[c,d]=R.useState(0),[u,m]=R.useState(new Set),h=a[c],g=u.has(h.id),p=(0,Kr.t)(),b=function(){const[e,t,a]=(0,r.xtK)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsUITimeouts",[0,15e3,25e3]);return{description:e,preview:t,explanation:a}}(),f=a.length>1;return(0,n.jsx)(or.lJ,{contentBody:(0,n.jsxs)(vn.B,{tokens:{childrenGap:12},className:(0,mr.z)(p.columnRecommendation,"column-recommendation"),children:[(0,n.jsx)(ti,{dataSourcesLength:a.length,performedFallbackToAllTables:l,messageId:o}),f&&(0,n.jsx)(ai,{selectedSourceIndex:c,dataSourcesLength:a.length,handlePrevious:()=>{d((e=>(e-1+a.length)%a.length))},handleNext:()=>{d((e=>(e+1)%a.length))}}),(0,n.jsx)(ni,{selectedTable:h,tableWasImported:g,handleAddToSheet:()=>{const t=a[c];(0,Kt.I2)(o,i,s,e,c)({sourceName:t.sourceName,sourceLocation:t.sourceLocation,sourceUrl:t.sourceUrl??"",columns:t.columns??[],sampleRows:t.sampleRows??[],powerQueryScript:t.powerQueryScript}),m(new Set(u).add(t.id)),qt.B.getInstance().logKeptEvent(x.BJ.ImportData,e,tt.RX.Create),(0,Na.cY)(`Added ${t.sourceName} to sheet.`)},importDataStyles:zr,loadingTimeouts:b})]}),requestId:t})};var ri=a(686576),ii=a(178502),li=a(416223),si=a(8745);const ci=(0,R.lazy)((()=>Promise.all([a.e("monaco-editor","high"),a.e("vendors-npm_store_sdx_officecopilot_monaco-editor_0_46_0-51dbdf7e44e9cf33acc3_node_modules_mo-e5e20f","high"),a.e("monacoreadonly","high")]).then(a.bind(a,364130))));function di({id:e,columnName:t,code:a,codeExplanation:o,text:r,onFirstTimeExplanationShown:i,loadingTimeouts:l}){const s=mi(`description[${e}]`,Boolean(r),l.description);return(0,n.jsxs)(vn.B,{tokens:{childrenGap:8},children:[(0,n.jsx)(ii.V,{role:"heading","aria-level":2,"data-testid":"formula-title",children:t}),(0,n.jsx)(li.u,{text:function(e){switch(s){case"loading":return;case"timeout":return d.olU.FormulaSuggestion_Description_NotAvailable;default:return e}}(r)}),(0,n.jsx)(ui,{id:e,code:a,codeExplanation:o,onFirstTimeExplanationShown:i,loadingTimeouts:l})]})}function ui({id:e,code:t,codeExplanation:a,onFirstTimeExplanationShown:o,loadingTimeouts:r}){const i=mi(`explanation[${e}]`,Boolean(a),r.explanation),l=x.q.PythonCalculatedColumns,s=(0,n.jsx)(ci,{code:t}),c=(0,Fa.ZK)(t,!0,0);return(0,n.jsx)(qr.$,{title:"Python",content:s,explanation:{explanation:a,isLoading:"loading"===i,isNotAvailable:"timeout"===i,onFirstTimeExplanationShown:o},telemetryUsageFeatureName:l,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([c],{type:"text/plain"})})})}function mi(e,t,a){return(0,si.rK)(e,t,a,{onTimeout(){},onLoaded(){}})}var hi=a(209980);function gi({recommendation:e,...t}){return e?(0,n.jsx)(pi,{recommendation:e,...t}):(0,n.jsx)(fi,{})}function pi({requestId:e,recommendation:t,targetAddress:a,columnLetters:o,insertCallback:i}){if(!t)return(0,n.jsx)(fi,{});if(!a)return(0,n.jsx)(fi,{errorMessage:(0,d.gg6)()});const l=(0,hi.E)().pythonRecommendation,s=function(){const[e,t,a]=(0,r.xtK)("Microsoft.Office.Excel.FA000000124.FormulaSuggestionsUITimeouts",[15e3,15e3,25e3]);return{description:e,preview:t,explanation:a}}();return(0,n.jsx)(or.lJ,{requestId:e,contentBody:(0,n.jsxs)(vn.B,{tokens:{childrenGap:12},className:(0,mr.z)(l,"python-recommendation"),children:[a&&o&&(0,n.jsx)(bi,{targetAddress:a,columnLetters:o}),(0,n.jsx)(vn.B,{tokens:{childrenGap:12},children:(0,n.jsx)(di,{loadingTimeouts:s,id:`${t.id}_${t.id}`,columnName:t.columnName,text:t.text,code:t.code,codeExplanation:t.codeExplanation,onFirstTimeExplanationShown:()=>{var e,a;e=t.id,a=x.a5.PythonCalculatedColumnsExplainButtonClicked,T.E.getInstance().updateTelemetryChatEventData({[x.h3.ChatEventType]:a,[x.h3.ChatEventParameters]:e},S.M.getInstance())}},t.id)})]}),cardButtons:[{...(0,or.r1)((0,d.Nbb)()),handleButtonOnClick:i}]})}function bi({targetAddress:e,columnLetters:t}){const a=(0,Ta.r)(e),o=(0,n.jsx)(Br.sA,{message:d.olU.FormulaSuggestion_Header_Singular_Location,values:{columnLetter:t}});return(0,n.jsx)(Or.c,{children:(0,n.jsx)(Br.sA,{message:d.olU.FormulaSuggestion_Header_Singular,values:{tableRange:(0,n.jsx)(ii.V,{children:a}),location:(0,n.jsx)(ii.V,{children:o})}})})}function fi({errorMessage:e}){return(0,n.jsx)(p.DefaultMessage,{body:{user:"chat",messageHeader:{text:e??(0,d.JIA)()}},styles:(0,hi.E)(),shouldShowAIGeneratedIndicator:!1})}var Ci=a(469069),yi=a(139821),vi=a(498736),xi=a(979426);const Ti=(0,u.n)({paddedContainer:{paddingBottom:"12px","& > *":{margin:"0 !important"},"& > * > *":{margin:"0 !important"}},paddedFinalText:{paddingBottom:"2px"}});var Si=a(848403);function wi(e,t){const a=(0,_a.au)(`Output missing in ${e}`);(0,_a.QX)(t,a,!1)}async function Ei(e,t,a,n){try{let o="";await(0,Qt.F5)((async function(r){if(!t)return void wi("handleInsertImage",e);const{left:i,top:l}=await async function(e){try{return await async function(e){const t=e.workbook.getSelectedRange().load("left,top");return await e.sync(),{left:t.left,top:t.top}}(e)}catch{return await async function(e){const t=e.workbook.worksheets.getActiveWorksheet().getRange("A1").load("left,top");return await e.sync(),{left:t.left,top:t.top}}(e)}}(r);let s=function(e){if(!e)return null;try{return JSON.parse(e)?.base64_data??null}catch{return null}}(t);if(!s){const t=(0,_a.Wx)("Base64 image data not found in output.");return void(0,_a.QX)(e,t,!0)}s.startsWith("data:image")||(s=`data:image/png;base64,${s}`);const c=r.workbook.worksheets.getActiveWorksheet(),d=new Image;d.src=s,d.onload=async()=>{const{width:e,height:t}=function(e,t){const a=600/e,n=Math.min(a,1);return{width:e*n*.75,height:t*n*.75}}(d.naturalWidth,d.naturalHeight);o=await async function(e,t,a,n,o,r,i,l){const s=e.shapes.addImage(t);return s.left=a,s.top=n,s.width=o,s.height=r,i&&(s.altTextTitle=i),l&&(s.altTextDescription=l),e.load("name"),await e.context.sync(),e.name}(c,d.src.split(",")[1],i,l,e,t,a,n)}})),Ii(e,o)}catch(t){const a=(0,_a.dL)(Ga.O.AnswersInsertImageError,t);(0,_a.Kx)(e,a,"handleInsertImage",!1)}}function Ii(e,t){const a=(0,$a.SG)(),n=[(0,ct.FW)(a)],o=(0,d.OKX)().replace("{0}",t);oa.n.displayPythonTextResponse(e,o,!1,!0,!0,n)}function Ri(e){const t=s.$.getInstance().getChatLog().reverse().filter(((t,a,n)=>t.chatMessageBodyData?.messageId!==e&&"Python"===t.chatMessageBodyData?.aiResponseMetadata.type&&n.findIndex((e=>e.chatMessageBodyData?.messageId===t.chatMessageBodyData?.messageId))===a)).reverse().map((e=>function(e){const t=e.chatMessageBodyData?.aiResponseMetadata.metadata;let a;try{a=JSON.parse(t)}catch(e){const t=(0,_a.kh)("handleCodeEntry parsing metadata failed");return(0,$a.Lv)(t),[]}return a.chunks.filter((e=>"code"===e.type)).map((e=>{if(!e.value.code)return"";let t=e.value.code;return e.value.output?.includes("hresult")&&e.value.output.includes("errorName")&&e.value.output.includes("errorMessage")&&(t=t.split("\n").map((e=>`# ${e}`)).join("\n")),t=t.split("\n").map((e=>e.includes("plt")||e.includes(".plot")?`# ${e}`:e)).join("\n"),t}))}(e))).reduce(((e,t)=>e.concat(t)),[]).join("\n\n");return t}function Ai(e){if(!(0,r.pS6)())return e;try{const t=/(?:^|\.\s+)(\*\*(.+?)\*\*)([^.]+)\.?/g;return[...e.matchAll(t)].map((e=>`- [x] **${e[2].trim()}**  \n  ${e[3].trim().replace(/^[\s:-]+/,"")}  `)).join("\n")}catch{return e}}function Li(e){const t=(0,p.useMarkdownStyles)(),a=Ti(),{linkTheme:o,getStyles:i}=(0,Si.X)(),l=["text","code","finalText"],s=(0,lo.wA)();let c=(0,r.DBQ)()?Ri(e.messageId):"";const u=(0,Ci.j)();let m;(0,r.g6K)()&&u&&(m=u.getChartRef);const h=e.chunks.filter((e=>l.includes(e.type))).map(((l,u)=>{switch(l.type){case"text":return l.value.text?(0,n.jsx)("div",{className:a.paddedContainer,children:(0,n.jsx)(p.MarkdownTextProcessor,{styles:t,body:{message:Ai(l?.value?.text)||l?.value?.text}})},`text-${u}`):((0,$a.oA)(l.type),null);case"code":{if(!l.value.code)return(0,$a.oA)(l.type),null;const t=l.value.isLargeOutput,g=!t||!(0,r.yw9)("OfficeVSO_10346383_AnswersShowLargeDataMessage");let p,b=!0;const f=[];let C=!0;if(g){if((0,r.yw9)("OfficeVSO_10196331_Handle_Table_With_Objects_Edge_Case")){let e,t,a=!1;try{const n=JSON.parse(l.value.output||"{}");(0,r._dF)()&&n&&"object"==typeof n&&"type"in n&&n.type!==ri.z.Image?(e=n.rawData,t=n.type,t!==ri.z.Table&&t!==ri.z.TableWithObjects||(C=n.firstRowIsHeader??!0),[ri.z.Boolean,ri.z.String,ri.z.Number].includes(t)&&(e="string"==typeof n.rawData?n.rawData:JSON.stringify(n.rawData)),a=!0):(e=l.value.output,t=l.value.outputType)}catch(a){e=l.value.output,t=l.value.outputType}p=a?{output:e,outputType:t}:(0,xi._)(e,t)}else{const e=function(e,t){if(!e)return ri.z.None;if(t===ri.z.Image)return ri.z.Image;if(!isNaN(Number(e))&&""!==e.trim())return ri.z.Number;if("true"===e.toLowerCase()||"false"===e.toLowerCase())return ri.z.Boolean;try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0){if(t.every((e=>Array.isArray(e)&&e.length===t[0].length&&t[0].length>0))){const e=t=>typeof t===ri.z.String||typeof t===ri.z.Number||typeof t===ri.z.Boolean||typeof t===ri.z.None||!!Array.isArray(t)&&t.every((t=>e(t)));return t.every((t=>t.every((t=>e(t)))))?ri.z.Table:ri.z.TableWithObjects}return ri.z.Json}if(typeof t===ri.z.Object)return ri.z.Json}catch(e){return(0,$a.eA)(),ri.z.String}return ri.z.String}(l.value.output,l.value.outputType);p={output:l.value.output,outputType:e}}b=p.outputType!==ri.z.Table&&p.outputType!==ri.z.Image,p.outputType===ri.z.Image?((0,$a.Qc)(Gt.L3.CardShownWithInsertionButton,Gt.IM.InsertToSheetButton,Gt.Zf.Image),f.push({...(h=(0,d.ivT)(),{buttonTitle:h,buttonText:h,icon:(0,n.jsx)(yi.j6g,{})}),handleButtonOnClick:async()=>{if(await(0,Fa.e1)(s))if((0,r.g6K)()){const e=JSON.parse(l?.value?.output??"{}");if(e.chart_json){const t=(0,Na.RE)(e.title,e.summary),a=m(t);ki(a?.current,s,l?.value?.output),(0,$a.PB)(Gt.L3.InteractiveChartImageInserted,[])}else Ei(s,l?.value?.output),(0,$a.PB)(Gt.L3.StaticChartImageInserted,[])}else(0,r.yw9)("OfficeVSO_10222788_Insert_Image_Error")?Ei(s,l?.value?.output):async function(e,t){try{let a="";await(0,Qt.F5)((async function(n){if(!t)return void wi("handleInsertImage",e);const o=n.workbook.getSelectedRange().load("left,top");await n.sync();const r=JSON.parse(t)?.base64_data;if(!r){const t=(0,_a.Wx)("Base64 image data not found in output.");return void(0,_a.QX)(e,t,!1)}const i=n.workbook.worksheets.getActiveWorksheet(),l=i.shapes.addImage(r);return l.left=o.left,l.top=o.top,l.width=480,l.height=290,i.load("name"),await n.sync(),a=i.name,n.sync()})),Ii(e,a)}catch(t){const a=(0,_a.dL)(Ga.O.AnswersInsertImageError,t);(0,_a.Kx)(e,a,"handleInsertImage",!1)}}(s,l.value.output);(0,$a.Qc)(Gt.L3.CardInsertionButtonClicked,Gt.IM.InsertToSheetButton,Gt.Zf.Image)}})):p.outputType===ri.z.Table&&((0,$a.Qc)(Gt.L3.CardShownWithInsertionButton,Gt.IM.InsertButton,Gt.Zf.Table),f.push({...(0,or.r1)((0,d.J40)()),handleButtonOnClick:()=>{(0,r.yw9)("OfficeVSO_10196331_Handle_Table_With_Objects_Edge_Case")?Array.isArray(p?.output)&&async function(e,t){try{let a="";await(0,Qt.F5)((async n=>{if(!t)return void wi("handleInsertTable",e);if(!Array.isArray(t)||0===t.length)return;const o=n.workbook.worksheets.add(),r=o.getRangeByIndexes(0,0,t.length,t[0].length);return r.values=t,o.tables.add(r,!0),o.activate(),o.load("name"),await n.sync(),a=o.name,await n.sync()})),Ii(e,a)}catch(t){const a=(0,_a.dL)(Ga.O.AnswersInsertTableError,t);(0,_a.Kx)(e,a,"handleInsertTable",!1)}}(s,p?.output):async function(e,t){try{let a="";await(0,Qt.F5)((async n=>{if(!t)return void wi("handleInsertTableOld",e);const o=JSON.parse(t);if(!Array.isArray(o)||0===o.length)return;const r=n.workbook.worksheets.add(),i=r.getRangeByIndexes(0,0,o.length,o[0].length);return i.values=o,r.tables.add(i,!0),r.activate(),r.load("name"),await n.sync(),a=r.name,await n.sync()})),Ii(e,a)}catch(t){const a=(0,_a.dL)(Ga.O.AnswersInsertTableError,t);(0,_a.Kx)(e,a,"handleInsertTableOld",!1)}}(s,l.value.output),(0,$a.Qc)(Gt.L3.CardInsertionButtonClicked,Gt.IM.InsertButton,Gt.Zf.Table)}}))}return(0,r.DBQ)()&&(c+="\n"+l.value.code),(0,n.jsxs)(R.Fragment,{children:[(0,n.jsx)("div",{className:a.paddedContainer,children:(0,n.jsx)(vi.W,{code:(0,r.DBQ)()?c:l.value.code,codeExplanation:l.value.codeExplanation,styles:i(),linkTheme:o,requestId:"",output:p?.output,outputType:p?.outputType,isPythonOutputCollapsable:b,isLargeOutput:t,tableHasHeader:C})}),g&&["image","table"].includes(p?.outputType??"")?(0,n.jsx)(or.lJ,{requestId:e.requestId,pythonUserRequestId:e.pythonUserRequestId,renderHeader:()=>null,renderBody:()=>null,renderFooter:e=>(0,n.jsx)("div",{className:a.paddedContainer,children:e()}),cardButtons:f}):null]},`code-${u}`)}case"finalText":return l.value.finalText?(0,n.jsx)("div",{className:a.paddedFinalText,children:(0,n.jsx)(p.MarkdownTextProcessor,{styles:t,body:{message:l.value.finalText}})},`finalText-${u}`):((0,$a.oA)(l.type),null);default:return null}var h})).filter((e=>null!==e));return(0,n.jsx)(or.lJ,{contentBody:(0,n.jsx)(n.Fragment,{children:h}),requestId:e.requestId})}const ki=(e,t,a)=>{if(e)try{const n=JSON.parse(a??"{}");e.exportAsImage().then((async e=>{Ei(t,JSON.stringify({base64_data:e}),n.title??"",n.summary??"")})).catch((e=>{e.name=e.message;const a=(0,_a.Ix)(Ga.O.AnswersInvalidChartImageResponse,"Unable to export interactive chart as image",e);(0,_a.QX)(t,a,!0)}))}catch(e){const a=(0,_a.Ix)(Ga.O.AnswersInteractiveChartImageGenerationFailed,"Unable to insert interactive chart image",e);(0,_a.QX)(t,a,!0)}else{const e=(0,_a.Ix)(Ga.O.AnswersInteractiveChartRefFailed,"Interactive chart reference is not available.");(0,_a.QX)(t,e,!0)}},Fi=e=>(0,n.jsx)(Ci.z,{children:(0,n.jsx)(Li,{...e})});var _i=a(60398);const Pi={pythonStartAnalysis:{"& > :first-child":{marginBottom:"2px"},"& > :nth-child(2)":{marginTop:"0px",paddingLeft:"25px"},backgroundColor:C.k1.neutralLight,color:C.k1.neutralDark}},Ni=(0,u.n)(Pi);function Mi(e){const t=(0,Ke.j)(),a=(0,lo.d4)((e=>e.chat.showLoadingUI)),o=(0,lo.d4)((e=>e.chat.isPythonStartAnalysisButtonDisabled));(0,R.useEffect)((()=>{t(Wt.m.setPythonStartAnalysisButtonDisabled(!1))}),[]);const i=[];if(!o){const e=(0,r.gnD)()?(0,d.CsI)():(0,d.QAQ)();i.push({buttonTitle:e,buttonText:e,handleButtonOnClick:()=>l(),icon:(0,n.jsx)(dt.u9I,{}),isDisabled:a}),(0,r.gnD)()&&i.push({buttonTitle:(0,d.YVl)(),buttonText:(0,d.YVl)(),handleButtonOnClick:()=>async function(){Yt.CP.pythonContextManager.setIsPythonThinkDeeperMode(!0),await l(!0)}(),icon:(0,n.jsx)(dt.W66,{}),isDisabled:a})}return(0,n.jsx)(or.lJ,{contentBody:function(e,t){const a=Ni();return(0,n.jsxs)(vn.B,{className:(0,mr.z)(a.pythonStartAnalysis,"python-start-analysis"),children:[(0,n.jsx)(m.E,{children:(0,d.XXH)()}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,d.zqN)(t)},"first-bullet"),(0,n.jsx)("li",{children:(0,d.lQ6)()},"second-bullet"),(0,n.jsx)("li",{children:(0,d.WQT)()},"third-bullet"),e?(0,n.jsx)("li",{children:(0,d.PxQ)()},"fourth-bullet"):null]}),(0,n.jsx)(m.E,{children:(0,d.LMV)()})]})}(e.shouldShowRecalcNotice,e.pythonAnalysisSheetName),requestId:e.requestId,cardButtons:i});async function l(e){try{const a=(0,r.yw9)("OfficeVSO_10320925_ThinkDeeperStringUpdate")&&e;(0,$a.PB)(Gt.L3.StartAnalysisClicked,[]);const n={chatCardType:$o._.Default,chatMessageData:{defaultMessageProps:{user:Ho.Q9.Human,messageHeader:{text:a?(0,d.YVl)():(0,d.QAQ)()}}}},o={featureName:x.q.Python,eventType:x.a5.SuggestionMessage};if(s.$.getInstance().displayResponse(n,o),Yt.CP.pythonContextManager.prePythonModeError)return void(0,_a.Kx)(t,Yt.CP.pythonContextManager.prePythonModeError,Yt.CP.pythonContextManager.prePythonModeErrorFunction??"handleStartAnalysisOnClick - prePythonModeError",!1,!0);t((0,jt.eM)(x.OP.PythonStartAnalysis)),Yt.CP.pythonContextManager.enterAdvancedAnalysisMode(),await ot.p.getInstance().handlePythonStartAnalysis()}catch(e){(0,Fa.Tk)(!1);const a=new _i.H({errorCode:Ga.O.PythonStartAnalysisFailed,innerError:e});(0,_a.Kx)(t,a,"handleStartAnalysisOnClick",!1,!1,[],!0)}}}function Oi(e){return(0,n.jsx)(or.lJ,{contentBody:function(e,t){const a=Ni();return(0,n.jsxs)(vn.B,{className:(0,mr.z)(a.pythonStartAnalysis,"python-start-analysis"),children:[(0,n.jsx)(m.E,{children:(0,d.XXH)()}),(0,n.jsxs)("ul",{children:[(0,n.jsx)("li",{children:(0,d.zqN)(t)},"first-bullet"),(0,n.jsx)("li",{children:(0,d.lQ6)()},"second-bullet"),(0,n.jsx)("li",{children:(0,d.WQT)()},"third-bullet"),e?(0,n.jsx)("li",{children:(0,d.PxQ)()},"fourth-bullet"):null]}),(0,n.jsx)(m.E,{children:(0,d.LMV)()})]})}(e.shouldShowRecalcNotice,e.pythonAnalysisSheetName),requestId:e.requestId})}const Di={title:{color:C.k1.black}},Bi=(0,u.n)(Di);function $i(e){const t=Bi();if(!e.title)return null;const a=e.title.runs.map(((e,t)=>{const a=null!=e.highlightStyleIndex?`recommendation-title__rich-text__${e.highlightStyleIndex}`:"";return(0,n.jsx)("span",{className:a,children:e.text},t)}));return(0,n.jsx)("div",{className:(0,mr.z)(t.title,"recommendation-title"),children:a})}a(849473);var Hi=a(553482),Ui=a(270750),qi=a(601301),Vi=a(771496),Gi=a(586446),Wi=a(162134);function zi(e,t=1){if(!e||7!==e.length)throw new Error("Invalid color string.");return{r:ji(e.substr(1,2)),g:ji(e.substr(3,2)),b:ji(e.substr(5,2)),a:t}}function ji(e){const t=Number.parseInt(e[0],16),a=Number.parseInt(e[1],16);if(Number.isNaN(t)||Number.isNaN(a))throw new Error("Invalid color string.");return(16*t+a)/255}var Qi,Ji=a(777179),Yi=a(590572);function Xi(e){const t=Date.UTC(0,0,-1,0,0,0);return(e.getTime()-t)/1e3/60/60/24}function Zi(e,t,a=1){const n=new Date(+e);return 3===t?n.setUTCFullYear(e.getUTCFullYear()+a):2===t?n.setUTCMonth(e.getUTCMonth()+a):1===t?n.setUTCDate(e.getUTCDate()+7*a):n.setUTCDate(e.getUTCDate()+a),n}function Ki(e){const t=e.filter((e=>0!==e)).reduce(((e,t)=>Math.min(e,t)),Number.MAX_VALUE),a=e.filter((e=>0!==e)).reduce(((e,t)=>Math.max(e,t)),Number.MIN_VALUE),n=function(e,t,a){const n=function(e){let t=Number.MAX_VALUE,a=e[0];for(let n=1;n<e.length;n++){const o=e[n];t=Math.min(Math.abs(a-o),t),a=o}return t}(a),o=t-e;if(n<7&&o<56)return Qi.Day;if(n<28&&o<365)return Qi.Week;if(n<365&&o<1825)return Qi.Month;return Qi.Year}(t,a,e);return function(e,t,a,n=1){const o=[];if(e===t)o.push(1);else if(a===Qi.Day)o.push(n);else if(a===Qi.Week)o.push(7*n);else{let i=e;for(;i<t;){const e=Xi(Zi((r=i,new Date(Date.UTC(0,0,r-1,0,0,0))),a,n));o.push(e-i),i=e}}var r;return o}(t,a,n)}!function(e){e[e.Day=0]="Day",e[e.Week=1]="Week",e[e.Month=2]="Month",e[e.Year=3]="Year"}(Qi||(Qi={}));var el=a(69284);class tl{createAxes(e,t){return this.getAxesForChart(e,t)}static updateAxesTickLabels(e,t,a,n,o){if("histogram"===e.series[0].layout)return;const r=t&&n>el.y3;a.forEach((t=>{if("categoryValues"!==t.dimensionType)return;const a=tl.getCategoryCountForSeries(e.data,e.series[0]);if(!r&&!o&&a>n&&t.tickLabels)return void(t.tickLabels.show=!1);const i=tl.isDateDimension(e,"categories");(0,Vi.tJ)(e.series)&&(-1===a||i)||t.tickLabels&&(t.tickLabels.show=!0)}))}getAxesForChart(e,t){const a=(0,Wi.ip)(e),n=[...(0,qi.lf)(a.primary.insightsType)];if(a.secondary){const e=(0,qi.t7)(a.secondary.insightsType);n.push(...e)}return n.map(((a,n)=>{const o=a.dimension,r=(0,Vi.tJ)(e.series)?(0,Vi.fB)(e,a):e.axes.find((e=>e.dimensionType===o&&e.axisGroup===a.axisGroup)),i=(0,Hi.q)(e,o,a.axisGroup),l={dimensionType:"categories"===o?"categoryValues":o,tickLabels:this.getTickLabelsForAxis(e,a),index:n};if(a.isValue&&"primary"===a.axisGroup&&(l.majorGridLines={}),"values"===a.dimension?l.lineThickness=0:l.lineColor=zi(Ui.Ei),r){this.isTitleForAxisRequired(e,r)&&(l.title=tl.getTitleForAxis(r));const t=r.linearValueScale;!!t&&"includeZero"===t.zeroPolicy&&(l.linearValueScale={...l.linearValueScale,zeroPolicy:"IncludeZero"})}if(this.shouldSetupIntervals(e,o)){const t=(0,Gi.Q)(e,0,o).values.raw;l.intervalsScale=tl.getIntervalsScale(t),l.tickLabels={show:!1}}if(a.isHundredPercent?(l.units="Percentage",l.linearValueScale={...l.linearValueScale,autoBufferRatio:0}):i&&i.languageUnitsValue!==Hi.YO.None&&(l.units=i.languageUnitsValue),(0,Gi.$)(o)){const t=(0,Ji.r)(e,o,a.axisGroup);t&&t.max<=0&&0!==t.min&&(l.axisCrossType="Maximum")}if(r?.reversePlotOrder&&(l.reverseDirection=!0,l.axisCrossType="Maximum"),"categories"===o&&(0,Vi.q3)(e.series)&&!this.shouldSetupIntervals(e,o)&&(l.reverseDirection=!0),(0,Vi.tJ)(e.series)&&(0,Gi.$)(o)){const t=!!r&&!!r.linearValueScale&&"includeZero"===r.linearValueScale.zeroPolicy,n=(0,Vi.ps)(e,o,a.axisGroup,t);n&&(l.linearValueScale={...l.linearValueScale,maximum:n.maximum,minimum:n.minimum})}if(t){if(null!=t.primaryCategoryAxis&&"primary"===a.axisGroup&&"Category"===a.excelAxisType)return tl.applyChartConfigToAxis(l,t.primaryCategoryAxis);if(null!=t.primaryValueAxis&&"primary"===a.axisGroup&&"Value"===a.excelAxisType)return tl.applyChartConfigToAxis(l,t.primaryValueAxis);if(null!=t.secondaryCategoryAxis&&"secondary"===a.axisGroup&&"Category"===a.excelAxisType)return tl.applyChartConfigToAxis(l,t.secondaryCategoryAxis);if(null!=t.secondaryValueAxis&&"secondary"===a.axisGroup&&"Value"===a.excelAxisType)return tl.applyChartConfigToAxis(l,t.secondaryValueAxis)}return l}))}static getIntervalsScale(e){const t=e.reduce(((e,t)=>Math.min(e,t)),Number.MAX_VALUE);return{plotLevel:0,manualLevels:[{start:Math.floor(t),intervals:Ki(e)}]}}static applyChartConfigToAxis(e,t){return null!=t.minimum&&(e.linearValueScale={...e.linearValueScale,minimum:t.minimum}),null!=t.maximum&&(e.linearValueScale={...e.linearValueScale,maximum:t.maximum}),null!=t.title?.text&&(e.title={...e.title,text:t.title.text}),null==t.showTitle||t.showTitle||(e.title=void 0),null!=t.majorGridlines?.visible&&(t.majorGridlines.visible?e.majorGridLines={}:e.majorGridLines=void 0),null!=t.minorGridlines?.visible&&(t.minorGridlines.visible?e.minorGridLines={}:e.minorGridLines=void 0),null!=t.tickLabel?.visible&&(e.tickLabels={show:t.tickLabel.visible}),e}areTickLabelsAppropriate(e,t){const a="categories"===t.dimension;if(a&&"histogram"===e.series[0].layout)return!1;const n=tl.getCategoryCountForSeries(e.data,e.series[0]);if(!this.options.showHierarchicalCategoryTickLabels&&a&&n>this.options.maxCategoryLabels)return!1;const o=a&&-1===n,r=tl.isDateDimension(e,"categories");return!(0,Vi.tJ)(e.series)||!o&&!r}isTitleForAxisRequired(e,t){const a=this.options.allowDateAxis&&"categories"===t.dimensionType&&tl.isDateDimension(e,"categories"),n="secondary"===t.axisGroup?(0,Wi.ip)(e).secondary.insightsType:(0,Wi.ip)(e).primary.insightsType,o=(0,qi.C$)(n,t.dimensionType),r=this.areTickLabelsAppropriate(e,o),i=(0,Gi.$)(t.dimensionType),l=e.axes.filter((e=>(0,Gi.$)(e.dimensionType))).length;return!(!(this.options.showAxisTitles||a||this.options.showAxisLabels&&!r||this.options.showAxisLabels&&i&&l>1)||!t.title)}static getTitleForAxis(e){return{text:e.title&&(0,Yi.HK)(e.title,30),textFaceName:Ui.e0,textPointSize:Ui.Wn,textColor:zi(Ui.Yg)}}getTickLabelsForAxis(e,t){const a=!!this.options.showAxisLabels&&this.areTickLabelsAppropriate(e,t),n="categories"===t.dimension,o="secondary"===t.axisGroup,r={show:a,allowAdvancedLayout:this.options.showHierarchicalCategoryTickLabels,textFaceName:Ui.e0,textPointSize:Ui.QN,textColor:zi(Ui.Yg)},i=(0,Wi.ip)(e).primary.insightsType;if(a&&!n&&!t.isHundredPercent&&"histogram"!==i){const a=e.series.findIndex((e=>o?"secondary"===e.valueAxisGroup:"secondary"!==e.valueAxisGroup)),n=(0,Gi.Q)(e,a,t.dimension);n?.formatInfo&&(r.numberFormat=n.formatInfo.format)}return r}shouldSetupIntervals(e,t){if(!this.options.allowDateAxis||!tl.isDateDimension(e,t))return!1;return(0,Gi.Q)(e,0,t).values.raw.every((e=>"number"==typeof e))}static isDateDimension(e,t){const a=(0,Gi.Q)(e,0,t);if(!a)return!1;const n=!!a.formatInfo&&a.formatInfo.isDateTime;return"categories"===t&&n}static getCategoryCountForSeries(e,t){const a=t.dataBindings.find((e=>"categories"===e.dimensionType));if(!a)return-1;const n=e.dimensions.find((e=>e.id===a.dimensionId));return n?n.values.raw.length:-1}constructor(e){this.options=e}}var al=a(47262),nl=a(644864),ol=a(824737),rl=a(707314),il=a(880496);class ll{createSeries(e){return this.getSeriesForChart(e)}getSeriesForChart(e){const t=this.options.allowDateAxis&&ll.hasDateDimension(e),a=[...e.series],n=a.some((e=>null!=e.highlightStyleIndex));return a.map(((o,r)=>{const i=o.exceptions&&o.exceptions.length>0,{hasDataMarkers:l,isLine:s,isPie:c}=(0,ol.Y)(o.layout);let d={id:`Series${r}`,title:this.getTitleForSeries(o,e.data),layout:(0,Wi.Pg)(o.layout).ivyLayout,data:this.getDataForSeries(o,e.data)};if((0,Vi.tJ)(e.series))switch(o.valueAxisGroup){case"primary":d.boundAxes=[0,1];break;case"secondary":d.boundAxes=[0,2];break;default:(0,al.c)(o.valueAxisGroup)}if("histogram"===o.layout&&(d.fillColor=zi(Ui.w8)),(l||i&&s)&&(d.dataMarkers=ll.getDataMarkersForSeries(o,n)),o.trendlines&&o.trendlines.length>0){"linear"===o.trendlines[0].trendType&&(d.trendLines=ll.getTrendlinesForSeries(o,n))}if(n){const e=null!=o.highlightStyleIndex?Ui.hr[o.highlightStyleIndex]:Ui.wm;s?d.lineColor=zi(e):d.fillColor=zi(e)}if(i&&(s?d.lineColor=zi(Ui.Zx):(d.exceptionalDatapoints=ll.getExceptionsForSeries(o),d.fillColor=zi(Ui.Zx))),(0,rl.o_)(o,["highlightedLineSegments"])&&o.highlightedLineSegments.length>0&&(d.lineColor=zi(Ui.Zx),d.exceptionalDatapoints=ll.getExceptionalDatapointsForSeries(o)),s?d.lineThickness=2:c?(d.lineColor=zi(Ui.ON),d.lineThickness=1):(d.lineColor=zi(Ui.ON,0),d.lineThickness=1),t&&void 0!==d.data.categoryValues&&(d=(0,nl.Lt)(d,"categoryValues",nl.V0)),"Line"===d.layout&&(d=(0,nl.jx)(d)),(0,Vi.q3)(a)){const e=void 0===d.data.categoryNames;e&&(d.data.categoryNames=(d.data.values||[[]]).map((e=>e.map(((e,t)=>t.toString()))))),d=(0,nl.Lt)(d,"categoryNames",nl.Hw),e&&(d.data.categoryNames=void 0)}return d}))}getTitleForSeries(e,t){const a=e.dataBindings.find((e=>"title"===e.dimensionType));if(a){const e=t.dimensions.find((e=>e.id===a.dimensionId));if(e)return e.values.strings[0]}}getDataForSeries(e,t){if("histogram"===e.layout)return this.getHistogramData(e,t);return e.dataBindings.reduce(((e,a)=>{switch(a.dimensionType){case"categories":{const n=this.getDimensionForSeries(t,a);if(this.options.showHierarchicalCategoryTickLabels&&n.categoryNames&&1===n.categoryNames.length){if(n.categoryNames[0].every((e=>""===e)))return e;{const t=e.categoryNames?e.categoryNames:[];return t.unshift(n.categoryNames[0]),{...e,categoryNames:t}}}return{...e,...n}}case"values":case"xValues":case"yValues":return{...e,...this.getDimensionForSeries(t,a)};case"title":return e;default:throw new Error("Unrecognized dimension.")}}),{})}getDimensionForSeries(e,t){const a=t.dimensionId,n=e.dimensions.find((e=>e.id===a));if(!n)throw new Error("Invalid dimension.");const o=this.getDimensionName(n,t),r=this.getDimensionValues(n,t);return this.options.maxDatapoints<0?{[o]:[r]}:{[o]:[r.slice(0,this.options.maxDatapoints)]}}getDimensionName(e,t){if("categories"===t.dimensionType){const t=e.formatInfo,a=!!t&&t.isDateTime&&!(0,il.Xw)(t.format),n=e?.values.raw&&!e.values.raw.some((e=>"number"!=typeof e));return this.options.allowDateAxis&&a&&n?"categoryValues":"categoryNames"}return t.dimensionType}getDimensionValues(e,t){const a="categoryNames"===this.getDimensionName(e,t)?e.values.strings:e.values.raw;switch(t.dimensionType){case"categories":case"title":return a;case"values":case"xValues":case"yValues":return a.map((e=>null===e||""===e?"NaN":e));default:throw new Error("Unrecognized dimension.")}}getHistogramData(e,t){const a="values",n=(0,nl.Mi)(e,t);return this.options.maxDatapoints<0?{[a]:[n]}:{[a]:[n.slice(0,this.options.maxDatapoints)]}}static hasDateDimension(e){return e.series.some((t=>t.dataBindings.some((t=>{if("categories"!==t.dimensionType)return!1;const a=t.dimensionId,n=e.data.dimensions.find((e=>e.id===a)),o=n.formatInfo,r=!!n&&n.values?.raw&&!n.values.raw.some((e=>"number"!=typeof e));return o?.isDateTime&&r&&!(0,il.Xw)(o.format)}))))}static getDataMarkersForSeries(e,t){const a=e.exceptions&&e.exceptions.length>0,n=(0,ol.Y)(e.layout).hasDataMarkers,o={defaultSize:0};return t&&(null!=e.highlightStyleIndex?o.fillColor=zi(Ui.hr[e.highlightStyleIndex]):o.fillColor=zi(Ui.wm)),n&&(o.defaultSize=Ui.iR,o.lineColor=zi(Ui.ON),a&&(o.fillColor=zi(Ui.Zx))),a&&(o.exceptionalDataMarkers=ll.getExceptionalDataMarkersForSeries(e)),o}static getExceptionalDataMarkersForSeries(e){const t=(0,ol.Y)(e.layout).hasDataMarkers?Ui.iR:Ui.r$;return e.exceptions.map((e=>({index:e,size:t,fillColor:zi(Ui.SB),lineColor:zi(Ui.ON)})))}static getExceptionsForSeries(e){return e.exceptions.map((e=>({index:e,fillColor:zi(Ui.SB),lineColor:zi(Ui.ON),lineThickness:1})))}static getExceptionalDatapointsForSeries(e){return e.highlightedLineSegments.map((e=>({index:e+1,lineColor:zi(Ui.SB),lineThickness:Ui.kd})))}static getTrendlinesForSeries(e,t){const a=e.exceptions&&e.exceptions.length>0,n=!!e.highlightedLineSegments&&e.highlightedLineSegments.length>0,o={lineThickness:Ui.yX,lineDashStyle:Ui.Vs};return t&&(null!=e.highlightStyleIndex?o.lineColor=zi(Ui.hr[e.highlightStyleIndex]):o.lineColor=zi(Ui.wm)),(a||n)&&(o.lineColor=zi(Ui.Zx)),[o]}constructor(e){this.options=e}}class sl{render(e,t,a){return{...sl.getEmptyChart(),series:new ll(this.options).createSeries(e),axes:new tl(this.options).createAxes(e,a),locale:t,legend:sl.getLegend(e,a)}}static getLegend(e,t){if(t?.legend){if(!1===t.legend.visible)return;if(t.legend.position)return{position:{edge:t.legend.position}};if(!0===t.legend.visible)return{position:{edge:"Bottom"}}}return e.showLegend?{position:{edge:"Bottom"}}:void 0}static getDefaults(){return{allowDateAxis:!0,showAxisLabels:!1,showAxisTitles:!0,maxCategoryLabels:6,maxDatapoints:-1,minRangeForValueLabels:0,showHierarchicalCategoryTickLabels:!1}}static getEmptyChart(){return{series:[],size:{width:300,height:200},lineThickness:0}}constructor(e={}){this.options={...sl.getDefaults(),...e}}}var cl=a(534537),dl=a(348065),ul=a(724910);class ml extends R.Component{layoutChart(e){const t=d.imT,a=this.chartRef.clientWidth,n=a*t;this.observer=new MutationObserver((()=>{const e=this.chartRef?.querySelector("svg");e&&(e.setAttribute("focusable","false"),e.setAttribute("role","img"),e.setAttribute("aria-label",(0,cl.Z)(this.props.visual)),(0,r.yw9)("OfficeVSO_8691849_CopilotChartToImage")&&e.setAttribute("xmlns","http://www.w3.org/2000/svg"),this.props.onChartRendered?.(ar(e))),this.observer.disconnect()})),this.observer.observe(this.chartRef,{attributes:!0,childList:!0,characterData:!0}),this.chartSettings.size.width!==a&&this.updateAxesSettings(a,t),e&&this.updateChartColors(e.lightColor,e.darkColor),this.chartSettings.size={width:a,height:n},this.host.setConfiguration(this.chartSettings)}createChartSettings(){const e=this.props.visual;{this.chartRenderOptions={allowDateAxis:"ChartVisual"===e.visualType||"QueryChartVisual"===e.visualType,showAxisLabels:!0,showAxisTitles:!1,maxDatapoints:this.props.maxDataPoints,showHierarchicalCategoryTickLabels:!1};const t=new sl(this.chartRenderOptions),a=(0,dl.KA)().dispatch((0,va.Z)())?.localeInfo;return t.render(e.chart,a,e.chartConfig)}}updateAxesSettings(e,t){const a=Math.floor((e-300)*t/20+6),n=Math.max(a,0);if(n!==this.chartRenderOptions.maxCategoryLabels&&this.chartSettings.axes){this.chartRenderOptions.maxCategoryLabels=n;const e=this.props.visual;tl.updateAxesTickLabels(e.chart,"PivotChartVisual"===e.visualType,this.chartSettings.axes,this.chartRenderOptions.maxCategoryLabels,!!this.chartRenderOptions.showHierarchicalCategoryTickLabels&&this.chartRenderOptions.showHierarchicalCategoryTickLabels)}}static areEqual(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b}updateChartColors(e,t){e&&!ml.areEqual(e,this.defaultLightColor)&&(this.chartSettings.fillColor=e),t&&!ml.areEqual(t,this.defaultDarkColor)&&(this.chartSettings.lineColor=t,this.chartSettings.axes&&this.chartSettings.axes.forEach((e=>{if(e.majorGridLines){const a={r:t.r,g:t.g,b:t.b,a:t.a};Yo.Utils.brightenColor(a,.85),e.majorGridLines.lineColor=a}if(e.tickLabels||e.title){const a={r:t.r,g:t.g,b:t.b,a:t.a};Yo.Utils.brightenColor(a,.35),e.tickLabels&&(e.tickLabels.textColor=a),e.title&&(e.title.textColor=a)}})))}componentDidMount(){const e=`${(0,Ko.wF)()}/v3.0`,t={cycleColors:this.props.themeColors.accentColors,type:Vo.Cycle},a=new Xo({base:e,clientId:(0,Ko.fp)()},t);this.resizeObserver=new ul.A((0,Zo.debounce)((([e])=>{e&&this.layoutChart(this.props.themeColors)}),1e3)),this.host=new Yo.ChartHost(a,this.ivySettings,this.chartRef),this.host.on("error",((e,t)=>{S.M.getInstance().logErrorCode(Ga.O.IvyWebFailure,new Error(t),Gt.S2.AnalyzeDataError,oe.$b.ASHA)})),this.chartSettings=this.createChartSettings(),this.layoutChart(this.props.themeColors),this.resizeObserver.observe(this.chartRef)}componentWillUnmount(){this.resizeObserver.unobserve(this.chartRef),this.host.on("error",null),this.host=void 0}render(){return(0,n.jsx)("div",{className:"chart",ref:e=>{this.chartRef=e}})}constructor(...e){super(...e),this.chartRenderOptions={},this.defaultDarkColor={r:0,g:0,b:0,a:1},this.defaultLightColor={r:1,g:1,b:1,a:1},this.ivySettings={disableChartElementResize:!0,renderer:Yo.IvyRenderer.Svg}}}var hl=a(603866),gl=a(944058);function pl(e){const{value:t}=e;if(t.toString().length<=3)return(0,n.jsx)(n.Fragment,{children:t.toString()});const a=function(e){const t=Math.min(Math.max(e.toString().length-e.toFixed(0).length-1,0),4);return t>0?{isFullEllipsis:!1,fractionDecimalLength:t,cacheKey:`true${t}`}:{isFullEllipsis:!0,fractionDecimalLength:0,cacheKey:"false0"}}(t);return(0,n.jsx)(hl.A,{data:{fractionDecimalLength:-1,isFullEllipsis:!1,cacheKey:"true-1"},onRenderData:e=>{const a=(0,gl.Fl)(t,e.isFullEllipsis,e.fractionDecimalLength);return(0,n.jsx)(n.Fragment,{children:a})},onReduceData:e=>-1===e.fractionDecimalLength?a:0===e.fractionDecimalLength?e.isFullEllipsis?void 0:{isFullEllipsis:!0,fractionDecimalLength:0,cacheKey:"false0"}:{fractionDecimalLength:e.fractionDecimalLength-1,isFullEllipsis:!1,cacheKey:"true"+(e.fractionDecimalLength-1)}})}const bl={header:{backgroundColor:C.k1.lightBlue},grandTotal:{backgroundColor:C.k1.lightBlue}},fl=(0,u.n)(bl);var Cl,yl;function vl(e){const{cellType:t,className:a,isHighlightCell:o,colspan:r,isEllipsisBodyCell:i,isRowLabelsColumn:l}=e,{value:s,isNumber:c,indent:d}=e.value,u=fl();let m;m="number"==typeof s&&"Header"!==t?(0,n.jsx)(pl,{value:s}):s?.toString()||"";const h=[`${a}__text`];switch(!c&&!i||l||h.push(`${a}__right-aligned`),o&&h.push(`${a}__highlight-cell`),t){case"Header":{h.push(`${a}__header`);const e=r>0?r:void 0;return(0,n.jsx)("th",{colSpan:e,className:(0,mr.z)(u.header,h.join(" ")),children:m})}case"Body":h.push(`${a}__body`);break;case"SubTotal":h.push(`${a}__subtotal`);break;case"GrandTotal":h.push(`${a}__grand-total`);break;default:(0,aa.x)(t)}const g=d>0?{textIndent:10*d+"px"}:void 0;let p;return p="GrandTotal"===t?(0,mr.z)(u.grandTotal,h.join(" ")):h.join(" "),(0,n.jsx)("td",{className:p,style:g,children:m})}!function(e){e.Header="Header",e.Body="Body",e.GrandTotal="GrandTotal",e.SubTotal="SubTotal"}(Cl||(Cl={})),function(e){e.PivotTable="PivotTable",e.QueryResult="QueryResult",e.TaggingResult="TaggingResult"}(yl||(yl={}));class xl extends R.Component{getRowCount(){switch(this.props.type){case"PivotTable":return(this.props.pivotTable.pivotTableData[0]||[]).length;case"QueryResult":return 0===this.props.data.fields.length?el.mz:Math.min(this.props.data.fields[0].values.strings.length+1,el.m6);case"TaggingResult":return 0===this.props.taggingResult.tagFields.length?el.mz:Math.min(this.props.taggingResult.tagFields.length+1,el.m6);default:return(0,al.x)(this.props)}}getColumnCount(){switch(this.props.type){case"PivotTable":return this.props.pivotTable.pivotTableData.length;case"QueryResult":return this.props.data.fields.length;case"TaggingResult":return el.tT;default:return(0,al.x)(this.props)}}getColGroup(e){const t=this.getColumnCount(),a=[];for(let o=0;o<t;o++){const t={width:this.state.colWidths[o],visibility:this.state.collapseColIndex>0&&o>=this.state.collapseColIndex?"collapse":void 0};a.push((0,n.jsx)("col",{id:`${e}Col${o}`,style:t},`${o}-${e}`))}return(0,n.jsx)("colgroup",{children:a})}getTableCell(e,t,a,o,r,i=0,l=!1){return(0,n.jsx)(vl,{value:e,className:this.props.className,cellType:a,colspan:i,isHighlightCell:o,isEllipsisBodyCell:l,isRowLabelsColumn:r},t)}static getBlankPreviewTable(e){return(0,n.jsx)("div",{className:"preview-table__no-values",children:e?d.olU.NoValueAnswerTextForNLInsight:d.olU.NoValueAnswerTextForIdeas})}renderPivotTable(e){const{pivotTableData:t,grandTotalRowIndex:a,subTotalRowIndices:o,highlightCellReferences:r}=e;if(t&&0===t.length)return xl.getBlankPreviewTable(!1);const i=!!o&&o.length>1,l=(0,el.HF)(e),s=t[0].map(((e,a)=>t.map((e=>e[a])))),c=e.rowFields.length>=1,d=s.slice(0,l).map(((e,t)=>{const a=l>1&&0===t,o=e.map(((n,o)=>{const i=r?.some((e=>t===e.row&&o===e.column));if(a&&1===o){const t=e.length-1;return this.getTableCell(n,o,Cl.Header,i,!1,t)}return a&&o>1?void 0:this.getTableCell(n,o,Cl.Header,i,c&&0===o)}));return(0,n.jsx)("tr",{children:o},t)})),u=(()=>{const e=[],t=s.slice(l,a);let d=0;for(let a=0;a<t.length;a++){const s=!!o&&o.length>0&&o.some((e=>e===a+l));d=s?0:d+1;const u=[],m=t[a];if(!(!s&&d>3&&i)){for(let e=0;e<m.length;e++){const t=r?.some((t=>a+l===t.row&&e===t.column));s?u.push(this.getTableCell(m[e],e,Cl.SubTotal,t,c&&0===e)):3===d&&i?u.push(this.getTableCell({value:"...",isNumber:!1,indent:0},e,Cl.Body,!1,c&&0===e,void 0,!0)):u.push(this.getTableCell(m[e],e,Cl.Body,t,c&&0===e))}e.push((0,n.jsx)("tr",{className:s?`${this.props.className}__subtotal-row`:"",children:u},a+l))}}return e})(),m=u.length>0?(0,n.jsx)("tbody",{children:u}):null,h="number"==typeof a?s.slice(a).map((e=>{const t=e.map(((e,t)=>this.getTableCell(e,t,Cl.GrandTotal,!1,c&&0===t)));return(0,n.jsx)("tr",{children:t},a)})):[],g=h.length>0?(0,n.jsx)("tfoot",{children:h}):null,p=this.getColGroup("PivotTable");return(0,n.jsxs)("table",{className:`${this.props.className}__table`,ref:e=>{this.tableRef=e},style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0},children:[p,(0,n.jsx)("thead",{children:d}),m,g]})}renderQueryResult(e){if(0===e.fields.length)return xl.getBlankPreviewTable(!0);if(0===e.fields[0].values.raw.length)return xl.getBlankPreviewTable(!1);const t=e.fieldHeaders.map(((e,t)=>{const a=e.runs.map((e=>e.text)).join("");return(0,n.jsx)(vl,{className:"query-result",value:{value:a,isNumber:!1,indent:0},cellType:Cl.Header,isEllipsisBodyCell:!1,isRowLabelsColumn:!1},t)})),a=t.length>0?(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:t})}):null,o=this.getRowCount()-1,r=[];for(let t=0;t<o;t++){const a=[];for(let o=0;o<this.getColumnCount();o++)if(e.fields[o].values.formattedValues){const r=e.fields[o].values.formattedValues[t];a.push((0,n.jsx)(vl,{value:r,className:"query-result",cellType:Cl.Body,isEllipsisBodyCell:!1,isRowLabelsColumn:!1},o))}else{const r=e.fields[o].values.strings[t],i=e.fields[o].values.raw[t],l=r||i;a.push((0,n.jsx)(vl,{className:"query-result",value:{value:l,isNumber:!1,indent:0},cellType:Cl.Body,isEllipsisBodyCell:!1,isRowLabelsColumn:!1},o))}r.push((0,n.jsx)("tr",{children:a},t))}const i=this.getColGroup("QueryResult");return(0,n.jsxs)("table",{className:"query-result__table",ref:e=>{this.tableRef=e},style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0},children:[i,a,(0,n.jsx)("tbody",{children:r})]})}getRawWidth(){this.rawTableWidth=this.tableRef.scrollWidth;const e=this.tableRef.getElementsByTagName("tr"),t=e.item(e.length-1).children;this.rawColumnsWidth=[];for(let e=0;e<t.length;e++)this.rawColumnsWidth.push(t.item(e).scrollWidth)}restyleTable(){const e=this.getColumnCount(),t=this.tableContainerDivRef.getBoundingClientRect().width,a=this.getColWidthsLoad(t,e),n=this.getCollapseColIndexLoad(t,e),o=this.getTableLayoutFixed(t,e);this.setState({colWidths:a,collapseColIndex:n,tableWidth:"100%",tableLayoutFixed:o})}getColWidthsLoad(e,t){const a=new Array(t);if(2===t){if(this.rawColumnsWidth[0]<=.5*e&&this.rawColumnsWidth[1]<=.5*e)return["50%","50%"];if(this.rawTableWidth>e){if(this.rawColumnsWidth[0]/e<=.67){const t=this.rawColumnsWidth[0]/e;return[`${t.toLocaleString("en",{style:"percent"})}`,`${(1-t).toLocaleString("en",{style:"percent"})}`]}return["67%","33%"]}}if(t>2){if(Math.max(...this.rawColumnsWidth)<=e/t)for(let e=0;e<a.length;e++)a[e]=`${(1/t).toLocaleString("en",{style:"percent"})}`;else if(this.rawTableWidth<=e)for(let e=0;e<a.length;e++)a[e]=`${(this.rawColumnsWidth[e]/this.rawTableWidth).toLocaleString("en",{style:"percent"})}`;else{if(!(this.rawColumnsWidth[0]+this.rawColumnsWidth[1]<=.75*e)){const t=.5,a=.75,n="25%";if(this.rawColumnsWidth[0]<=e*t){const t=this.rawColumnsWidth[0]/e;return[`${t.toLocaleString("en",{style:"percent"})}`,`${(a-t).toLocaleString("en",{style:"percent"})}`,n]}return["50%","25%","25%"]}{let t=0,n=e;for(;n>0;)a[t]=n-this.rawColumnsWidth[t]>0?`${(this.rawColumnsWidth[t]+1).toString()}px`:`${n.toString()}px`,n-=this.rawColumnsWidth[t]+1,++t}}}return a}getCollapseColIndexLoad(e,t){if(t>2&&this.rawTableWidth>e){if(this.rawColumnsWidth[0]+this.rawColumnsWidth[1]>.9*e)return 3;{let t=0,a=e;for(;a>0;)a-=this.rawColumnsWidth[t]+1,++t;return t}}return-1}getTableLayoutFixed(e,t){return!(Math.max(...this.rawColumnsWidth)>e/t&&this.rawTableWidth<=e)}componentDidMount(){this.tableRef&&(this.getRawWidth(),this.restyleTable(),this.resizeObserver.observe(this.tableContainerDivRef))}componentWillUnmount(){this.tableRef&&this.resizeObserver.unobserve(this.tableContainerDivRef)}renderTable(){switch(this.props.type){case"PivotTable":return this.renderPivotTable(this.props.pivotTable);case"QueryResult":return this.renderQueryResult(this.props.data);case"TaggingResult":return this.renderTaggingResult(this.props.taggingResult,this.props.columnName);default:return(0,al.x)(this.props)}}renderTaggingResult(e,t){if(0===e.tagFields.length)return xl.getBlankPreviewTable(!0);const a=[t,(0,d.HZc)()].map(((e,t)=>(0,n.jsx)(vl,{className:"text-analysis-tagging",value:{value:e,isNumber:!1,indent:0},cellType:Cl.Header,isEllipsisBodyCell:!1,isRowLabelsColumn:!1},t))),o=a.length>0?(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:a})}):null,r=this.getRowCount()-1,i=[];for(let t=0;t<r;t++){const a=[],o=e.tagFields[t].originalData,r=e.tagFields[t].tag;a.push((0,n.jsx)(vl,{className:"text-analysis-tagging",value:{value:o,isNumber:!1,indent:0},cellType:Cl.Body,isEllipsisBodyCell:!0,isRowLabelsColumn:!1},0)),a.push((0,n.jsx)(vl,{className:"text-analysis-tagging",value:{value:r,isNumber:!1,indent:0},cellType:Cl.Body,isEllipsisBodyCell:!1,isRowLabelsColumn:!1},1)),i.push((0,n.jsx)("tr",{children:a},t))}const l=this.getColGroup("TaggingResult");return(0,n.jsxs)("table",{className:"text-analysis-tagging__table",ref:e=>{this.tableRef=e},style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0},children:[l,o,(0,n.jsx)("tbody",{children:i})]})}getEllipsisRow(){const e=this.getColumnCount(),t=[],a="PivotTable"===this.props.type&&this.props.pivotTable.rowFields.length>=1;for(let o=0;o<e;o++)t.push((0,n.jsx)(vl,{className:this.props.className,value:{value:"...",isNumber:!1,indent:0},cellType:Cl.Body,isHighlightCell:!1,isEllipsisBodyCell:!0,isRowLabelsColumn:a&&0===o},o));return(0,n.jsx)("tr",{children:t})}renderEllipsis(){const e=this.getColGroup("Ellipsis"),t=this.getEllipsisRow();return(0,n.jsx)("div",{className:`${this.props.className}__ellipsis`,"aria-hidden":!0,children:(0,n.jsxs)("table",{className:`${this.props.className}__table`,style:{width:this.state.tableWidth,tableLayout:this.state.tableLayoutFixed?"fixed":void 0},children:[e,(0,n.jsx)("tbody",{children:t})]})})}render(){const e=Math.ceil(3*this.props.windowWidth/5)-40,t=Math.floor(e/22),a=22*t;return(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{className:this.props.className,style:{maxHeight:a},ref:e=>{this.tableContainerDivRef=e},children:this.renderTable()}),this.getRowCount()>t?this.renderEllipsis():null]})}constructor(e){super(e),this.state={colWidths:new Array(this.getColumnCount()),collapseColIndex:-1,tableWidth:"",tableLayoutFixed:!1},this.resizeObserver=new ul.A((e=>{e.forEach((()=>{this.restyleTable()}))}))}}var Tl=a(73915),Sl=a(357781);function wl({textAnalysis:e,title:t,tableContext:a}){const o=(0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1),i=e.textAnalysisResult.bulletList,l=function(e,t,a,n){if(!e||!n||n.length<=0)return{chatReferences:void 0,referencesForV2:void 0};const o=t.sheetRange.range.topLeft;if(null===o.column||null===o.row)throw new Error("unexpected range. The supported range should be a limited one.");const r=t.sheetRange.sheet,i=o.column+a.left+1,l=o.row+a.top+1;let s=1;const c=[],u=[];return n.forEach((e=>{const t=function(e,t,a,n){const o=e=>`${t}!${(0,Sl.LM)(a+e,n)}`;return e.map(o)}(e.reference,r,l,i),a=function(e){if(e.length<=0)return"";try{let t=e[0].split("!")[0];return e.length<=3?t+=` ${e.map((e=>e.split("!")[1])).join(", ")}`:(t+=` ${e[0].split("!")[1]}`,t+=" ...",t+=` ${e[e.length-1].split("!")[1]}`),t}catch{return""}}(t),n=e.reference.length>d.ifF,o=function(e,t){if(t.length<=0)return[];if(e){const e=t.slice(0,d.ifF-2);return e.push(t[t.length-1]),e}return t}(n,t),m=function(e,t,a){if(!t||!a||t.length!==a.length)return"";try{let n="";return e?(a.slice(0,a.length-1).map(((e,a)=>{n+=`${t[a].split("!")[1]}: ${Il(e)}\n`})),n+="...\n",n+=`${t[t.length-1].split("!")[1]}: ${Il(a[a.length-1])}`):a.map(((e,a)=>{n+=`${t[a].split("!")[1]}: ${Il(e)}\n`})),n.replace(/\n$/,"")}catch{return""}}(n,o,e.perviewCitationValues),h={referenceIndex:s,referenceProps:{title:a,primarySubtitle:(0,d.wzu)(),snippet:m,iconAppName:Tl._R.Excel,referenceType:Tl._2.Internal,onClickCitationLink:Rl,path:t}};c.push(h),t.length>0&&(u.push({...h}),s++)})),{chatReferences:c,referencesForV2:u}}(o,a,e.textAnalysisResult.columnReference,i),s=l.chatReferences,c=function(e){if(!e||e.length<=0)return[];return(0,p.getCitationReferenceV2fromV1)(e,p.ChatContainerBuilder.featureFlags,!0).citationsV2}(l.referencesForV2),u=i&&i.length>0?(0,n.jsx)("ul",{className:"recommendation__text-analysis_bullet-list",children:i.map(((e,t)=>(0,n.jsxs)("li",{children:[(0,n.jsxs)("span",{className:"recommendation__text-analysis__bullet-header",children:[e.title,":"," "]}),(0,n.jsx)("span",{className:"recommendation__text-analysis__bullet-description",children:e.description}),o&&s?.length===i.length&&e.reference.length>0&&s[t]?(0,n.jsx)("span",{className:"recommendation__text-analysis__bullet-citation","aria-hidden":"true",children:(0,R.createElement)(p.CitationPill,{...s[t],citationsV2:c,key:t})}):null]},t)))}):void 0,m=e.textAnalysisResult.generalResponse?(0,n.jsx)("div",{className:"recommendation__text-analysis__generalResponse",style:{paddingTop:"50%"},children:e.textAnalysisResult.generalResponse}):void 0,h=u||m;return(0,n.jsxs)("div",{className:"recommendation__text-analysis",children:[(0,n.jsx)(El,{title:t}),h]})}const El=({title:e})=>{const t=e?.runs.map((e=>e.text)).join(" ")??"";return(0,n.jsx)("div",{className:"recommendation__text-analysis__title",children:(0,n.jsx)("span",{children:t})})};const Il=e=>e.length>30?`${e.slice(0,27)}...`:e,Rl=async(e,t,a)=>{(0,o.cY)(`onClickCitationLink called with referenceId : ${e}, and telemetryData : ${a}`),(0,sn.z)()&&st.iJ.isWebPlatform()&&(void 0!==t&&t.length>0&&await sn.g.getInstance().highlightWithDuration(t,d.Lii),S.M.getInstance().logCitationOnClickEvent())};var Al=a(395987),Ll=a(401227),kl=a(479504);const Fl={recommendationTitle:{backgroundColor:C.k1.neutralLight,color:C.k1.black},recommendationSubtitle:{color:C.k1.black}},_l=(0,u.n)(Fl);function Pl({visual:e,tableName:t,requestId:a,tableContext:o,chartImageUrl:i,query:l}){const s=(0,Ke.j)(),c=(0,lo.d4)((e=>e.selection.interpretations[t])),u=(0,lo.d4)((e=>e.selection.nlEvaluationStates[a]?.intermediateResults??[])),[m]=R.useState((0,lo.d4)((e=>e.selection.selectionContexts[t]))),h=(0,lo.d4)((e=>e.chat.showLoadingUI)),[g,p]=R.useState(!1),[b,f]=R.useState("gpt-o3-mini"),C=(0,r.yw9)("OfficeVSO_8691849_CopilotChartToImage")&&i?.startsWith("data:image")?(0,n.jsx)("div",{className:"recommendation__chart",style:{paddingTop:0},children:(0,n.jsx)("img",{alt:"Chart",src:i})}):(0,n.jsx)(Ml,{recommendationVisual:e,tableContext:o,onChartRendered:(0,r.yw9)("OfficeVSO_8691849_CopilotChartToImage")?t=>{g||(tr(t,e.id),p(!0))}:void 0}),y=[],v=(0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1),T=(0,R.useCallback)((()=>{if(v&&"TextAnalysisVisual"===e.visual?.visualType&&e.visual.textAnalysisResult.bulletList){const{header:t,values:a}=(0,Ll.RU)(e.visual.textAnalysisResult);s((0,ba.Om)(a.map((e=>e.map((e=>null===e?"":e.toString())))),t,o))}}),[e,o,s]),w=(0,R.useCallback)((()=>{v&&"TextAnalysisVisual"===e.visual?.visualType&&e.visual.textAnalysisResult.bulletList&&s((0,ba.vW)(o))}),[e,o,s]);if((0,Sl.g8)(e,c)){let a=()=>Promise.resolve(s((0,ba.A4)(t,e,o)));if((0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)){const e=(0,Sl.PX)(u,c);e&&e.length>0&&(a=async()=>{let a=m;for(const n of e)await Promise.resolve(s((0,ba.A4)(t,n,o,(0,Sl.gD)(n,c),a))),"TextAnalysisVisual"===n.visual.visualType&&(a={...a,columnCount:a.columnCount+1,address:(0,Sl.Ej)(a.rowIndex,a.columnIndex,a.rowCount,a.columnCount+1)})})}y.push({...(0,or.r1)(Dl(e)),handleButtonOnClick:a,handleOnMouseEnter:T,handleOnMouseLeave:w,isDisabled:h})}if(!(0,Sl.fB)(e)){const t=e.visual.textAnalysisResult?.generalResponse??"",a=new ClipboardItem({"text/plain":new Blob([t],{type:"text/plain"})}),o={actionType:x.he.CopyMessageClicked,source:x.KZ.InsightsApi,featureName:x.q.AnalyzeData,userQueryGuid:S.M.userQueryGuid};y.push({buttonTitle:d.xxz.CopyButtonLabel,buttonText:d.xxz.CopyButtonLabel,icon:(0,kl.dD)()?(0,n.jsx)(bn.c2D,{}):(0,n.jsx)(bn.Jg_,{}),handleButtonOnClick:()=>(0,Na.Kv)(a,Gt.S2.AnalyzeDataError,o),isDisabled:h,popoverText:d.xxz.CopyButtonPopover})}return(0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableExcelAnalysisWorkflow",!1)&&l&&y.push({buttonTitle:"Reanalyze",buttonText:"Reanalyze",handleButtonOnClick:()=>{s((0,ba.b9)(t,l,b,a))},isDisabled:h}),(0,n.jsx)(or.lJ,{contentBody:(0,n.jsxs)(n.Fragment,{children:["TextAnalysisVisual"!==e.visual?.visualType?(0,n.jsx)(Ol,{title:e?.title,subtitleText:(0,Al.g)(e,!1),tableName:o.address,activeTableSheetName:o.sheetRange.sheet}):void 0,C,(0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableExcelAnalysisWorkflow",!1)&&l?(0,n.jsxs)("select",{value:b,onChange:e=>f(e.target.value),style:{marginTop:"10px"},children:[(0,n.jsx)("option",{value:"gpt-o3-mini",children:"gpt-o3-mini"}),(0,n.jsx)("option",{value:"gpt-4o-mini-2024-07-18",children:"gpt-4o-mini-2024-07-18"}),(0,n.jsx)("option",{value:"gpt-4o-11-20",children:"gpt-4o-11-20"}),(0,n.jsx)("option",{value:"gpt-o1",children:"gpt-o1"}),(0,n.jsx)("option",{value:"gpt-o1-mini",children:"gpt-o1-mini"}),(0,n.jsx)("option",{value:"deepseek-r1-distill-qwen-32b",children:"deepseek-r1-distill-qwen-32b"}),(0,n.jsx)("option",{value:"deepseek-r1-full",children:"deepseek-r1-full"}),(0,n.jsx)("option",{value:"phi-4",children:"phi-4"}),(0,n.jsx)("option",{value:"phi-35-mini-instruct",children:"phi-35-mini-instruct"}),(0,n.jsx)("option",{value:"phi-35-moe-instruct",children:"phi-35-moe-instruct"})]}):void 0]}),cardButtons:y,requestId:a})}const Nl=e=>{if(e&&"PivotChartVisual"===e.visual.visualType){if(!(1===e.visual.pivotTable.rowFields.length))return-1;const t=(0,Wi.ip)(e.visual.chart),a=[t.primary.datapointLimit];t.secondary&&a.push(t.secondary.datapointLimit);const n=a.filter((e=>-1!==e));return 0===n.length?-1:Math.min(...n)}},Ml=({recommendationVisual:e,tableContext:t,onChartRendered:a})=>{const o=e.visual,i=(0,lo.d4)((e=>e.selection.themeColors));switch(o.visualType){case"PivotChartVisual":case"ChartVisual":case"QueryChartVisual":{const t=`${d.Xxp}%`;return(0,n.jsx)("div",{className:"recommendation__chart",style:{paddingTop:t},children:(0,n.jsx)(ml,{visual:o,"aria-live":"assertive",maxDataPoints:Nl(e),onChartRendered:a,themeColors:i})})}case"PivotTableVisual":{const e=o.pivotTable.pivotTableData,t=e&&0===e.length?"recommendation__empty-pivot-table":"recommendation__pivot-table";return(0,n.jsx)("div",{className:t,children:(0,n.jsx)(xl,{"aria-live":"assertive",pivotTable:o.pivotTable,className:"pivot-table-light16",windowWidth:window.innerWidth,type:yl.PivotTable})})}case"QueryResultVisual":return(0,n.jsx)("div",{className:"recommendation__query-result",children:(0,n.jsx)(xl,{"aria-live":"assertive",className:"query-result",windowWidth:window.innerWidth,type:yl.QueryResult,data:o.result,formula:o.query})});case"ForecastVisual":return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"recommendation__chart",children:(0,n.jsx)(ml,{visual:o,"aria-live":"assertive",maxDataPoints:Nl(e),themeColors:i,onChartRendered:a})}),(0,n.jsx)("div",{className:"recommendation__query-result",children:(0,n.jsx)(xl,{"aria-live":"assertive",className:"query-result",windowWidth:window.innerWidth,type:yl.QueryResult,data:o.previewTable})})]});case"TextAnalysisVisual":return(0,r.iPS)("Microsoft.Office.Excel.FA000000124.Insights.EnableTaggingInTextAnalysis",!1)&&o.textAnalysisResult?.analysisType===rl.uK.Tagging&&o.textAnalysisResult?.tagResult?(0,n.jsx)("div",{className:"recommendation__text-analysis-tagging",children:(0,n.jsx)(xl,{"aria-live":"assertive",className:"text-analysis-tagging",windowWidth:window.innerWidth,type:yl.TaggingResult,taggingResult:o.textAnalysisResult.tagResult,columnName:o.textAnalysisResult.columnName})}):(0,n.jsx)(wl,{textAnalysis:o,title:e.title,tableContext:t});default:return(0,al.x)(o)}},Ol=({title:e,subtitleText:t,tableName:a,activeTableSheetName:o})=>{const i=_l();let l="";return l=(0,r.ZAR)()?(0,d.PDm)().replace("{range}",(0,Ta.r)(a)).replace("{sheet}",o):(0,d.I5y)().replace("{0}",(0,Ta.r)(a)),(0,n.jsxs)("div",{className:"recommendation__title-group",children:[(0,n.jsx)("p",{className:(0,mr.z)(i.recommendationSubtitle,"recommendation-subtitle"),children:l}),(0,n.jsx)("div",{className:(0,mr.z)(i.recommendationTitle,"recommendation__title"),children:(0,n.jsx)($i,{title:e})}),t&&(0,n.jsx)("p",{className:(0,mr.z)(i.recommendationSubtitle,"recommendation-subtitle"),children:t})]})};function Dl(e){return"TextAnalysisVisual"===e.visual.visualType?(0,d.aVz)():"ChartVisual"===e.visual.visualType?(0,d.zVb)():(0,d.W4k)()}var Bl=a(81051);function $l(e){const t=(0,Ke.j)(),[a,o]=(0,R.useState)(!0),r=(0,lo.d4)((e=>e.chat.showLoadingUI)),i=(0,R.useCallback)((()=>{o(!1),t((0,jt.RX)(e))}),[o,t]);return(0,n.jsx)(or.lJ,{contentBody:Hl(),requestId:e.requestId,cardButtons:a?[{buttonTitle:(0,d.yXE)(),buttonText:(0,d.yXE)(),handleButtonOnClick:()=>i(),icon:(0,n.jsx)(Mr.Eu3,{}),isDisabled:r}]:[]})}function Hl(){const e=Fr();return(0,n.jsxs)(vn.B,{className:e.cardStack,children:[(0,n.jsx)(m.E,{children:(0,d.Y9M)()}),(0,n.jsx)(m.E,{children:(0,d.O8z)()}),(0,n.jsxs)("ul",{className:e.bulletList,children:[(0,n.jsx)("li",{children:(0,d.vK1)()},"first-bullet"),(0,n.jsx)("li",{children:(0,d.m$v)()},"second-bullet")]}),(0,n.jsx)(m.E,{children:(0,d.AS_)()})]})}function Ul({requestId:e,columnName:t}){const a=(0,Ke.j)();return(0,n.jsx)(or.lJ,{contentBody:(0,n.jsx)(n.Fragment,{children:(0,d.BZb)()}),cardButtons:[{buttonTitle:(0,d.h8D)(),buttonText:(0,d.h8D)(),icon:(0,n.jsx)(f.u5x,{}),handleButtonOnClick:()=>{a((0,jt.eM)(x.OP.AnalyzeData)),ot.p.getInstance().handleTextAnalysisSuggestionQuerySubmission((0,Na.VY)((0,d.b_h)(),{columnName:t}))}}],requestId:e})}function ql({requestId:e,textAnalysis:t,title:a}){const o=(0,lo.d4)((e=>e.chat.showLoadingUI)),r=t.textAnalysisResult.bulletList&&t.textAnalysisResult.bulletList.length>0?(0,n.jsx)("ul",{className:"recommendation__text-analysis_bullet-list",children:t.textAnalysisResult.bulletList.map(((e,t)=>(0,n.jsxs)("li",{children:[(0,n.jsxs)("span",{className:"recommendation__text-analysis__bullet-header",children:[e.title,":"," "]}),(0,n.jsx)("span",{className:"recommendation__text-analysis__bullet-description",children:e.description})]},t)))}):void 0,i=t.textAnalysisResult.generalResponse?(0,n.jsx)("div",{className:"recommendation__text-analysis__generalResponse",style:{paddingTop:"50%"},children:t.textAnalysisResult.generalResponse}):void 0,l=r||(i||void 0),s=t.textAnalysisResult.generalResponse??"",c=new ClipboardItem({"text/plain":new Blob([s],{type:"text/plain"})}),u={actionType:x.he.CopyMessageClicked,source:x.KZ.InsightsApi,featureName:x.q.AnalyzeData,userQueryGuid:S.M.userQueryGuid};return(0,n.jsx)(or.lJ,{contentBody:(0,n.jsxs)("div",{className:"recommendation__text-analysis",children:[(0,n.jsx)(Vl,{title:a}),l]}),cardButtons:[{buttonTitle:d.xxz.CopyButtonLabel,buttonText:d.xxz.CopyButtonLabel,icon:(0,kl.dD)()?(0,n.jsx)(bn.c2D,{}):(0,n.jsx)(bn.Jg_,{}),handleButtonOnClick:()=>(0,Na.Kv)(c,Gt.S2.AnalyzeDataError,u),isDisabled:o}],requestId:e})}const Vl=({title:e})=>{const t=e?.runs.map((e=>e.text)).join(" ")??"";return(0,n.jsx)("div",{className:"recommendation__text-analysis__title",children:(0,n.jsx)("span",{children:t})})};var Gl=a(49236);const Wl={AnalyzeData_V1:R.memo(Pl),ChartAdaptiveCard_V1:R.memo(rr),StartDataShaping_V1:R.memo($l),DataShapingIntro_V1:R.memo(_r),FormulaSuggestion_V2:R.memo(Pr.X),ChatCardHumanInTheLoop_V1:R.memo(Ar.AU),ChatCardListWithColorSwatch_V1:R.memo(Ar.uS),PythonAdaRecommendation_V1:R.memo(Xa.m),PythonCalculatedColumn_V1:R.memo(gi),PythonStartAnalysis_V1:R.memo(Mi),PythonStartAnalysisButtonExperiment_V1:R.memo(Oi),ChatCardWithConditionalFormatting_V1:R.memo(Ar.YV),TextAnalysis_V1:R.memo(ql),TextAnalysisSuggestion:R.memo(Ul),ConditionalFormattingSuggestionCard_V1:R.memo(Ar.g$),CodeAndPostView:R.memo(Lr.o),ImportData_V1:R.memo(oi),ModelessOutput:R.memo(ri.e),ScratchpadCommandingCard:R.memo(Bl.x),PythonMergedCard_V1:(0,r.g6K)()?R.memo(Fi):R.memo(Li),ChartDesignRecommendationsCard_V1:R.memo(Sr),ChartDesignRecommendationsSnowballChartCard_V1:R.memo(Rr)},zl=R.memo((({component:e})=>((0,si.H5)((()=>{(0,Gl.np)(e,Gt.S2.Error,`Missing renderer for ${e}`)})),(0,n.jsx)("i",{children:"Sorry, cannot display this message."})))),jl={renderers:Wl,renderFallback:e=>(0,n.jsx)(zl,{component:e.component})};var Ql=a(644082);const Jl=e=>{const{message:t,telemetry:a}=Ql.n.getAnalyzeDataRecommendationResponse((e=>{switch(e){case"ChartVisual":return{requestId:"Request1",responseText:"Here's a Chart that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data chart title"}]},visual:{chart:{axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]},chartConfig:{},visualType:e}}};case"ForecastVisual":return{requestId:"Request1",responseText:"Here's a Forecast that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data forecast title"}]},visual:{chart:{axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]},previewTable:{fieldHeaders:[{runs:[{text:"Column A"}]},{runs:[{text:"Column B"}]}],fields:[{id:0,values:{raw:["a","b"],strings:["a","b"]}},{id:1,values:{raw:[1,2],strings:["1","2"]}}]},formulasTable:{fieldHeaders:[{runs:[{text:"Column A"}]},{runs:[{text:"Column B"}]}],fields:[{id:0,values:{raw:["a","b"],strings:["a","b"]}},{id:1,values:{raw:[1,2],strings:["1","2"]}}]},visualType:e}}};case"PivotChartVisual":return{requestId:"Request1",responseText:"Here's a PivotChart that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data PivotChart title"}]},visual:{chart:{axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]},chartConfig:{},pivotTable:{columnFields:[],dataFields:[{name:"Sales",dataCalculation:"sum"}],dateFilters:[],filterFields:[],highlightCellReferences:[],labelFilters:[],pivotTableData:[[{value:"Year",isNumber:!1,indent:0},{value:2015,isNumber:!0,indent:0},{value:2016,isNumber:!0,indent:0},{value:2017,isNumber:!0,indent:0},{value:"Grand Total",isNumber:!1,indent:0}],[{value:"Sum of Sales",isNumber:!1,indent:0},{value:" $111,100 ",isNumber:!0,indent:0},{value:" $249,300 ",isNumber:!0,indent:0},{value:" $437,900 ",isNumber:!0,indent:0},{value:" $798,300 ",isNumber:!0,indent:0}]],rowFields:[{name:"Year"}],valueFilters:[]},visualType:e}}};case"PivotTableVisual":return{requestId:"Request1",responseText:"Here's a PivotTable that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data PivotTable title"}]},visual:{pivotTable:{columnFields:[],dataFields:[{name:"Sales",dataCalculation:"sum"}],dateFilters:[],filterFields:[],highlightCellReferences:[],labelFilters:[],pivotTableData:[[{value:"Year",isNumber:!1,indent:0},{value:2015,isNumber:!0,indent:0},{value:2016,isNumber:!0,indent:0},{value:2017,isNumber:!0,indent:0},{value:"Grand Total",isNumber:!1,indent:0}],[{value:"Sum of Sales",isNumber:!1,indent:0},{value:" $111,100 ",isNumber:!0,indent:0},{value:" $249,300 ",isNumber:!0,indent:0},{value:" $437,900 ",isNumber:!0,indent:0},{value:" $798,300 ",isNumber:!0,indent:0}]],rowFields:[{name:"Year"}],valueFilters:[]},visualType:e}}};case"QueryResultVisual":return{requestId:"Request1",responseText:"Here's a QueryResult that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data query result title"}]},visual:{result:{fieldHeaders:[{runs:[{text:"Column A"}]},{runs:[{text:"Column B"}]}],fields:[{id:0,values:{raw:["a","b"],strings:["a","b"]}},{id:1,values:{raw:[1,2],strings:["1","2"]}}]},visualType:e}}};case"QueryChartVisual":return{requestId:"Request1",responseText:"Here's a QueryResult that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data query result title"}]},visual:{result:{fieldHeaders:[{runs:[{text:"Column A"}]},{runs:[{text:"Column B"}]}],fields:[{id:0,values:{raw:["a","b"],strings:["a","b"]}},{id:1,values:{raw:[1,2],strings:["1","2"]}}]},chart:{axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]},chartConfig:{},visualType:e}}};case"TextAnalysisVisual":return{requestId:"Request1",responseText:"Here's a TextAnalysis that shows an insight about your data",tableContext:{name:"Table1",address:"Sheet1!A1:D12",sheetRange:{range:{bottomRight:{column:3,row:11},topLeft:{column:0,row:0}},sheet:"Sheet1"}},tableName:"Table1",visual:{id:"PC1",interpretationId:"Interpretation1",title:{runs:[{text:"Mock analyze data text analysis title"}]},visual:{textAnalysisResult:{analysisType:rl.uK.Summary,bulletList:[{title:"Bullet 1",description:"First description",reference:[5],perviewCitationValues:["First citation"]},{title:"Bullet 2",description:"Second description",reference:[2,7],perviewCitationValues:["Second citation 1","Second citation 2"]}],columnName:"Column A",columnReference:{top:1,right:1,bottom:100,left:1},generalResponse:'Here is a summary of "Column A" column:',resultType:rl.rb.Others,insertionColumnHeader:"Themes"},visualType:e}}};default:(0,aa.x)(e)}})(e));s.$.getInstance().displayResponse(t,a)},Yl=()=>{const e=new sl({allowDateAxis:!0,showAxisLabels:!0,showAxisTitles:!1,maxDatapoints:1e3,showHierarchicalCategoryTickLabels:!1}),{message:t,telemetry:a}=Ql.n.getChartAdaptiveCardResponse({requestId:"Request1",adaptiveCardDefinition:{body:[{type:"TextBlock",text:"Mock Chart Adaptive Card",wrap:!0},{type:"Chart",definition:JSON.stringify(e.render({axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]}))},{type:"TextBlock",text:"Dynamic custom response",wrap:!0}],type:"AdaptiveCard",version:"1.3"}});s.$.getInstance().displayResponse(t,a)},Xl=()=>{const e=new sl({allowDateAxis:!0,showAxisLabels:!0,showAxisTitles:!1,maxDatapoints:1e3,showHierarchicalCategoryTickLabels:!1}),{message:t,telemetry:a}=Ql.n.getChartAdaptiveCardResponse({requestId:"Request1",adaptiveCardDefinition:{body:[{type:"TextBlock",text:"Mock Chart Carousel Adaptive Card",wrap:!0},{type:"Carousel",timer:5e3,pages:[{type:"CarouselPage",id:"firstCarouselPage",items:[{type:"TextBlock",text:"Mock Chart 1",wrap:!0},{type:"Chart",definition:JSON.stringify(e.render({axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]}))},{type:"TextBlock",text:"Dynamic custom response 1",wrap:!0}]},{type:"CarouselPage",id:"theSecondCarouselPage",items:[{type:"TextBlock",text:"Mock Chart 2",wrap:!0},{type:"Chart",definition:JSON.stringify(e.render({axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]}))},{type:"TextBlock",text:"Dynamic custom response 2",wrap:!0}]},{type:"CarouselPage",id:"last-carousel-page",items:[{type:"TextBlock",text:"Mock Chart 3",wrap:!0},{type:"Chart",definition:JSON.stringify(e.render({axes:[{axisGroup:"primary",dimensionType:"categories",title:{runs:[{text:"Category axis"}]}},{axisGroup:"primary",dimensionType:"values",title:{runs:[{text:"Value axis"}]}}],data:{dimensions:[{id:1,values:{raw:[2015,2016,2017],strings:["2015","2016","2017"]}},{id:3,values:{raw:[111100,249300,437900],strings:["111100","249300","437900"]}}]},series:[{dataBindings:[{dimensionId:1,dimensionType:"categories"},{dimensionId:3,dimensionType:"values"}],layout:"line",valueAxisGroup:"primary",exceptions:[]}]}))},{type:"TextBlock",text:"Dynamic custom response 3",wrap:!0}]}]}],type:"AdaptiveCard",version:"1.3"}});s.$.getInstance().displayResponse(t,a)},Zl=()=>{const{message:e,telemetry:t}=Ql.n.getTextAnalysisV1Response({requestId:"Request1",textAnalysis:{textAnalysisResult:{analysisType:rl.uK.Summary,bulletList:[{title:"Bullet 1",description:"First description",reference:[5],perviewCitationValues:["First citation"]},{title:"Bullet 2",description:"Second description",reference:[2,7],perviewCitationValues:["Second citation 1","Second citation 2"]}],columnName:"Column A",columnReference:{top:1,right:1,bottom:100,left:1},generalResponse:'Here is a summary of "Column A" column:',resultType:rl.rb.Others,insertionColumnHeader:"Themes"},visualType:"TextAnalysisVisual"},title:{runs:[{text:"Mock text analysis title"}]}});s.$.getInstance().displayResponse(e,t)},Kl=()=>{const{message:e,telemetry:t}=Ql.n.getFullThemingSuggestionResponse("Request1","");s.$.getInstance().displayResponse(e,t)};var es=a(885930);const ts=["Sort column A","Format table red"];async function as(){}const ns=async()=>{const{message:e,telemetry:t}=oa.n.getCommandingHumanInTheLoopResponse(ts,as);s.$.getInstance().displayResponse(e,t)},os=async()=>{const e=[{title:"Custom Formula: ",explanation:"Apply formatting using formula below",conditionalFormatResponseCardData:{cardTitle:es.D.CustomCreated,customFormat:{BackgroundColor:"#000000",TextColor:"#FFFFFF",IsTextBold:!1,IsTextItalic:!1,IsTextStrikethrough:!1,IsTextUnderlined:!1,IsTextDoubleUnderlined:!1,BorderFormat:{Position:15,LineStyle:[0,0,0,0],Color:[0,0,0,0],ThemeBorderColor:[{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0}],ColorTypeOption:0,Thickness:[0,0,0,0]},PreserveBackgroundColor:!1,PreserveTextColor:!1},customFormula:"=$E2 > $F2",formulaExplanation:"If E2 is greater than F2"},subExplanations:["Format1","Format2"]}],{message:t,telemetry:a}=oa.n.getCommandingCFHumanInTheLoopResponse(e,ts,as);s.$.getInstance().displayResponse(t,a)},rs=async()=>{const{message:e,telemetry:t}=oa.n.getConditionalFormattingSuggestionsResponseMessage([{Description:"Highlight cells below average in column 'Total Budget and Revenue'",TableName:"Table1",ColumnID:1,Key:"Average/Below"},{Description:"Highlight top 3 in column 'Column1'",TableName:"Table1",ColumnID:1,Key:"TopBottom/Top"}],void 0,"Okay! Here are some conditional formatting suggestions for data in {0}","guid");s.$.getInstance().displayResponse(e,t)},is=async e=>{oa.n.displayPythonAdaRecommendationResponse({dispatch:e,requestId:"",code:"#Import the pandas library \n import pandas",codeExplanation:"This code imports the pandas library."})},ls=async e=>{oa.n.displayPythonStartAnalysisResponse(e,"requestId",!1,"",!1)},ss=async e=>{oa.n.displayPythonStartAnalysisButtonExperimentResponse(e,"requestId",!1,"",!1)},cs=async e=>{oa.n.displayPythonCodeCardWithPendingPostView(e,"requestId","import pandas","sheetId","A1",!1,"This code imports the pandas library.","Import the pandas library")},ds=async e=>{oa.n.displayPythonModelessResponse(e,'{"base64_data":"iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAEf0lEQVR4nO2bzW8NYRTGH0GJiPRDUoveSgQlImHTJQm18QcQCQvxUf+BLYmF0C5qg5WERJRGbWwEidiwwMLCRkWoaClttUoX7pFpT5Ob6Tszd3rn48w950neVeeeeeb85p33vB8FTCaTyWQySVQJwACAX9wGAXTkbUozjB8AyNd+8t9MGWvAAWOh3c3ajAlzn6ggIJOWoOw1HgJkIgc/6vU0BEi/+uxkrH0A/gXAGAPQlrUhzWoBMBwwbng9w2BkrH4fiDKAg1mbMM3rlKNn9PDfTBlrs6PUfQtgddZGTMBKAC99MP4A2GnJyUeXHZ+q7py8qNdeR4n7EMAy9ZnJQU0APvlgjABozcOMCXOLhJUwvJ7SZYnJR92OccMbS0w5lbhTPhivATRAuUq+Hbl7ANpTvmcDJ78Sxm8A26BcpYAdubGUobhK3NMp3q8uduTupHTPLkeJ6+2TmxC+I+f1ksaEs7QewBfffYZ5dVe9mgDMhgAh3rE7x3OFJPTAUeLuV08C84PnuwgYlc3rSRcBNNeQvDOOuJcMBnAYwHQMGJVtaolgtnMVVRnrlfYSdzlXN2VHoocAjHLFdZ/3H/xzBP/O3YUqwawC8Mb3+2nth91aADwKSO71gDe1hcePiYge0xex7tTr+N3JgGupxlYI7QLwwWH+b0hiXGDGqwCzwffbA44S1+uB0ArkGIAZh/HPADpjxmrmz9RkBJgeTrprwhlV4tYtkBU8+LpMP3e8yXG0DsDZiB7jatWUuHUJpBXAswDDfbxVmoS8ucn5iDGmsnmH3qIUN8HigXTy58hvdIY/X2moqYoxZuHEuiogJ3igJl/7CGB3BvdvjJjfTGgB4pWs1wKS8JjXj7LSYI1ncQsJZBOvxI5yG3IYK/Mk0JsMZqn2kOX8tnoEshHAt4hv9TQvj+Sldt4nn1zCWdzCAbkVAeN9wQ+WFQbIWj7zGra+NJvgMnleEg/EW/a4GjE7jlPFSJdIIGsAHAfwogoIcasY6RIFZAeAK0tYkohTxUhX7kC8Y/ZHeX0pKunfeeFuDw/uI3X4H0WUBZDKc09eEm9yUnv5zQ6DUOY1oCO80VPvorSBBJ17imrfeGK3FbpEaQMJO/fk6g1PeFKXVm+gGlvhgYSde1poo3z6YgvSFxmQ4CR41dShjE9ekHYgYaufN5C9SDuQDt6YcX2m8ihVKe0HLoK/UsXq51cAt3nVNg+RAZElMiCyRAZElsiAyBIZkPoGQgmX0dJfmMRFBkSWyIDIEhkQXUCiZGNIwRIoflCXXsWQ8HiJy4CEy4D4ZD3EPlmyekit15OyeIlL+gOT8HiJS/oDk/B4iUv6A5PweIsuiNuK9sAkPJ4BiZABKdgbbT1EGxBpBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVk88QZJWTzxBklZPPEGSVm8RRfEbRYPiebPgEDWC2hAYEDsEwhfD/kPC3d1fgj2RhMAAAAASUVORK5CYII="}',ri.z.Image,!0,!1,!0)},us=async e=>{Yt.CP.pythonContextManager.lastCodeAndPostViewMessage={chatCardType:$o._.Default,chatMessageData:{chatCardWrapperProps:{renderData:{component:"",props:{}}}}};const t={pythonContextManager:{},workbook:{localImage:{getBase64EncodedImageData:e=>({value:e})}},sync:()=>{}},n=Promise.all([a.e("chunk1jsfluent","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81","high"),a.e("calc","high")]).then(a.bind(a,837051)),o={id:"sheetId",getRange:e=>({load:t=>({address:e??"A1",valuesAsJson:[[{type:"ExternalCodeServiceObject",basicType:"Error",basicValue:"#VALUE!",preview:{type:"Entity",basicType:"Error",basicValue:"#VALUE!",text:"Image",properties:{image:{type:"LocalImage",basicType:"Error",basicValue:"#VALUE!",image:{cachedUid:"{D250033B-D6AF-4048-82FB-A4A123FBB6BF}"}}}}}]]}),valuesAsJson:()=>[[{type:"String",basicValue:"Hello"}]]}),load:e=>({})};oa.n.updatePythonCodeAndPostViewCardWithPostView(e,"A1",n,o,t,{})},ms=async e=>{const t=[{type:"text",value:{text:"text1"}},{type:"code",value:{code:"code1",codeExplanation:"codeExplanation1"}},{type:"text",value:{text:"text2"}},{type:"code",value:{code:"code2",codeExplanation:"codeExplanation2"}}];oa.n.displayPythonMergedCardResponse(e,t,!1,!1,"requestIdForMergedCard","messageIdForMergedCard"),t.push({type:"finalText",value:{finalText:"finalText1"}}),oa.n.displayPythonMergedCardResponse(e,t,!0,!0,"requestIdForMergedCard","messageIdForMergedCard")},hs=async()=>{oa.n.displayStartDataShapingResponse((0,Va.A)(),"Table1",(0,Va.A)(),"testMashupDocument","NewQuery","testQueryScript")},gs="",ps=`${gs} Unexpected Error`,bs=`${gs}${gs}${gs} Test Failed`,fs=" Missing Test Coverage",Cs=" Test Passed",ys=["PythonCalculatedColumn_V1","ChatCardListWithColorSwatch_V1","ChatCardWithConditionalFormatting_V1","ScratchpadCommandingCard","ChartDesignRecommendationsCard_V1","ChartDesignRecommendationsSnowballChartCard_V1"],vs=async(e,t)=>{const a=new Map(Object.keys(jl.renderers).map((e=>[e,fs]))),n=`Chat History Tests - ${(new Date).toLocaleTimeString()}`;a.set("SimpleTextCard",await xs(t,e,n,(()=>{}),[{contentParts:[n]}],!0)),await async function(e,t,a){const n=[(0,d.Y9M)(),(0,d.O8z)(),(0,d.vK1)(),(0,d.m$v)(),(0,d.AS_)()];a.set("StartDataShaping_V1",await xs(e,t,"Start Data Shaping",hs,[{contentParts:n}]));const o=[(0,d.i3R)(),(0,d.pF5)()],r="Data Shaping Intro mock metadata";a.set("DataShapingIntro_V1",await xs(e,t,"Data Shaping Intro",(()=>(async e=>{oa.n.displayDataShapingIntroResponse(e,(0,Va.A)())})(r)),[{contentParts:o,metadata:r}]));const i="Done! i've removed the Budget column",l="Add step mock metadata";a.set("DataShapingAddStep",await xs(e,t,"Data Shaping Add step",(()=>(async(e,t)=>{const{message:a,telemetry:n}=oa.n.getDataShapingSuccessResponse(e,t,(async e=>{}));s.$.getInstance().displayResponse(a,n)})(i,l)),[{contentParts:[i],metadata:l}])),a.set("DataShapingReplaceTable",await xs(e,t,"Data Shaping replace table",(()=>(async()=>{const{message:e,telemetry:t}=oa.n.getExitModeResponse("replace",{});s.$.getInstance().displayResponse(e,t)})()),[{contentParts:[(0,d.K1Z)()]}]))}(t,e,a),a.set("ImportData_V1",await xs(t,e,"Import Data",Ao,[{contentParts:[(0,d.h9u)().replace("{0}","2")]}])),a.set("PythonAdaRecommendation_V1",await xs(t,e,"PythonAdaRecommendation",is,[{contentParts:["#Import the pandas library \n import pandas","This code imports the pandas library"]}])),a.set("ChatCardHumanInTheLoop_V1",await xs(t,e,"Commanding HiTL",ns,[{contentParts:["Sort column A","Format table red"]}])),a.set("ChatCardWithConditionalFormatting_V1",await xs(t,e,"Commanding Conditional Formatting Formula HiTL",os,[{contentParts:["Sort column A","Format table red","Custom Formula: Apply formatting using formula below","Format1","Format2","=$E2 > $F2","If E2 is greater than F2"]}])),a.set("ConditionalFormattingSuggestionCard_V1",await xs(t,e,"Commanding Conditional Formatting Suggestion",rs,[{contentParts:["Highlight cells below average in column 'Total Budget and Revenue'","Average/Below","Highlight top 3 in column 'Column1'","TopBottom/Top"]}])),a.set("FormulaSuggestion_V2",await xs(t,e,"Calculated Column",_o,[{contentParts:["=SOME_FORMULA()"]}])),await async function(e,t,a){const n=new Map,o=(0,d.PDm)().replace("{range}","A1:D12").replace("{sheet}","Sheet1");n.set("AnalyzeData_V1_PivotChart",await xs(e,t,"Analyze Data PivotChart Recommendation",(()=>Jl("PivotChartVisual")),[{contentParts:[o,"Mock analyze data PivotChart title","Sum of Sales (Thousands)"],imageCount:0},{contentParts:[o,"Mock analyze data PivotChart title","Sum of Sales (Thousands)"],imageCount:1}])),n.set("AnalyzeData_V1_Chart",await xs(e,t,"Analyze Data Chart Recommendation",(()=>Jl("ChartVisual")),[{contentParts:[o,"Mock analyze data chart title","(Thousands)"],imageCount:0},{contentParts:[o,"Mock analyze data chart title","(Thousands)"],imageCount:1}])),n.set("AnalyzeData_V1_PivotTable",await xs(e,t,"Analyze Data PivotTable Recommendation",(()=>Jl("PivotTableVisual")),[{contentParts:[o,"Mock analyze data PivotTable title"],imageCount:0}])),n.set("AnalyzeData_V1_TextAnalysis",await xs(e,t,"Analyze Data Text Analysis Recommendation",(()=>Jl("TextAnalysisVisual")),[{contentParts:["Mock analyze data text analysis title",'Here is a summary of "Column A" column:',"Bullet 1: First description","Bullet 2: Second description"]}])),n.set("AnalyzeData_V1_QueryResult",await xs(e,t,"Analyze Data Query Result Recommendation",(()=>Jl("QueryResultVisual")),[{contentParts:[o,"Mock analyze data query result title"]}])),n.set("AnalyzeData_V1_Forecast",await xs(e,t,"Analyze Data Forecast Recommendation",(()=>Jl("ForecastVisual")),[{contentParts:[o,"Mock analyze data forecast title","(Thousands)"],imageCount:0},{contentParts:[o,"Mock analyze data forecast title","(Thousands)"],imageCount:1}])),Array.from(n.values()).every((e=>e===Cs))?a.set("AnalyzeData_V1",Cs):a.set("AnalyzeData_V1",bs);n.forEach(((e,t)=>{a.set(t,e)}))}(t,e,a),await async function(e,t,a){const n=new Map;n.set("ChartAdaptiveCard_V1_Chart",await xs(e,t,"Chart Adaptive Card",Yl,[{contentParts:["Mock Chart Adaptive Card","Dynamic custom response"],imageCount:0},{contentParts:["Mock Chart Adaptive Card","Dynamic custom response"],imageCount:1}])),n.set("ChartAdaptiveCard_V1_Carousel",await xs(e,t,"Chart Carousel Adaptive Card",Xl,[{contentParts:["Mock Chart Carousel Adaptive Card","Mock Chart 1","Dynamic custom response 1","Mock Chart 2","Dynamic custom response 2","Mock Chart 3","Dynamic custom response 3"],imageCount:0},{contentParts:["Mock Chart Carousel Adaptive Card","Mock Chart 1","Dynamic custom response 1","Mock Chart 2","Dynamic custom response 2","Mock Chart 3","Dynamic custom response 3"],imageCount:1},{contentParts:["Mock Chart Carousel Adaptive Card","Mock Chart 1","Dynamic custom response 1","Mock Chart 2","Dynamic custom response 2","Mock Chart 3","Dynamic custom response 3"],imageCount:2},{contentParts:["Mock Chart Carousel Adaptive Card","Mock Chart 1","Dynamic custom response 1","Mock Chart 2","Dynamic custom response 2","Mock Chart 3","Dynamic custom response 3"],imageCount:3}])),Array.from(n.values()).every((e=>e===Cs))?a.set("ChartAdaptiveCard_V1",Cs):a.set("ChartAdaptiveCard_V1",bs);n.forEach(((e,t)=>{a.set(t,e)}))}(t,e,a),a.set("TextAnalysis_V1",await xs(t,e,"Text Analysis",Zl,[{contentParts:["Mock text analysis title",'Here is a summary of "Column A" column:',"Bullet 1: First description","Bullet 2: Second description"]}])),a.set("TextAnalysisSuggestion",await xs(t,e,"Run Full Theme Analysis",Kl,[{contentParts:["The quick summary above considers only part of your data. Would you like a full theme analysis that you can insert in a new column? It may take a few minutes.\nRun full theme analysis"]}])),a.set("ModelessOutput",await xs(t,e,"Base64 Image Modeless output",ds,[{contentParts:["image"]},{imageCount:1,contentParts:["image"]}])),a.set("CodeAndPostView",await xs(t,e,"Code And Post View",cs,[{contentParts:[(0,en.L)((0,d.vX0)(),["A1"])+"\nCode: import pandas\nCode Explanation: This code imports the pandas library."]}])),a.set("UpdatePythonCodeAndPostViewCardWithPostView",await xs(t,e,"Code And PostView Card With PostView",us,[{imageCount:1,contentParts:["Here's what I inserted in A1:\nCode: import pandas\nCode Explanation: This code imports the pandas library."]}])),a.set("PythonStartAnalysis_V1",await xs(t,e,"Python Start Analysis",ls,[{contentParts:[`${(0,d.XXH)()}\n${(0,d.zqN)()}\n${(0,d.lQ6)()}\n${(0,d.WQT)()}\n${(0,d.LMV)()}`]}])),a.set("PythonStartAnalysisButtonExperiment_V1",await xs(t,e,"Python Start Analysis Button Experiment",ss,[{contentParts:[`${(0,d.XXH)()}\n${(0,d.zqN)()}\n${(0,d.lQ6)()}\n${(0,d.WQT)()}\n${(0,d.LMV)()}`]}])),a.set("PythonMergedCard_V1",await xs(t,e,"Python Merged Card",ms,[{contentParts:["text1\nCode: code1\nCode Explanation: codeExplanation1\ntext2\nCode: code2\nCode Explanation: codeExplanation2\nfinalText1"],metadata:'{"chunks":[{"type":"text","value":{"text":"text1"}},{"type":"code","value":{"code":"code1","codeExplanation":"codeExplanation1"}},{"type":"text","value":{"text":"text2"}},{"type":"code","value":{"code":"code2","codeExplanation":"codeExplanation2"}},{"type":"finalText","value":{"finalText":"finalText1"}}],"isUpdatedCodeChunk":false}'}]));for(const e of ys)a.set(e," Test Skipped (not needed)");Ts(Array.from(a,(([e,t])=>`${e}: ${t}`)).sort().join("\n"))};async function xs(e,t,a,n,o,r=!1){return new Promise((i=>{const l=new AbortController,s=setTimeout((()=>{i(`${bs}: timed out after ${Math.round(4)} seconds`),l.abort()}),4e3);let c=0;const d=t=>{clearTimeout(s),e.debugEvents.removeEventListener(String(Bo.PV.QuerySubmitted),u),i(t)},u=t=>{const a=function(e,t){if(!(e instanceof CustomEvent))return void t(`${ps}: no CustomEvent: ${JSON.stringify(e)}`);const a=e.detail;if(!("operation"in a))return void t(`${ps}: no operation in eventArgs: ${JSON.stringify(a)}`);const n=JSON.parse(a.operation);if(!ae.g0.typeGuard(n))return void t(`${ps}: no SignalOperation: ${JSON.stringify(a)}`);const o=n.items[0]?.body;if(!o||!Do.T.typeGuard(o))return void t(`${ps}: no CopilotChatHistorySignal: ${JSON.stringify(n)}`);const r=o.operation;if(!r)return void t(`${ps}: no AddMessageOperation: ${JSON.stringify(o)}`);const i=r.newMessage;if(!i)return void t(`${ps}: no CopilotMessage: ${JSON.stringify(r)}`);return i}(t,d);if(!a)return;if(a.userRole===Oo.gG.User&&!r)return;c>=o.length?d(`${fs}: no expectation set for update: ${c}`):c===o.length-1&&e.debugEvents.removeEventListener(String(Bo.PV.QuerySubmitted),u);const n=function(e,t){const a=e.richTextJson;if(!a)return void t(`${ps}: no richTextJson: ${JSON.stringify(e)}`);try{return JSON.parse(a)}catch(e){return void t(`${ps}: bad richTextJson: ${JSON.stringify(a)}. Error: ${e}`)}}(a,d);if(!n)return;const{contentParts:i,imageCount:l,metadata:s}=o[c];c++,function(e,t,a){const n=e.content.trim();0===n.length&&t.length>0&&a(`${bs}: empty content field, signal: ${JSON.stringify(e)}`);n.length>0&&0===t.length&&a(`${fs}: no expectation set. signals content: ${JSON.stringify(n)}`);t.forEach((e=>{n.includes(e)||a(`${bs}: expected content part wasn't found. Expected: ${JSON.stringify(t)}. Actual: ${JSON.stringify(n)}`)}))}(a,i,d),function(e,t,a){if(e){const n=t.messageMetadata?.metadata;n||a(`${bs}: no metadata found. Expected: ${JSON.stringify(e)}.`),n!==e&&a(`${bs}: unexpected metadata. Expected: ${JSON.stringify(e)}. Actual: ${JSON.stringify(n)}`)}}(s,a,d),function(e,t,a){if(void 0!==e){const n=t.images;(n?.length??0)!==e&&a(`${bs}: unexpected number of images. Expected: ${e}. Actual: ${n?.length??0}`)}}(l,a,d),c>=o.length&&d(Cs)};e.debugEvents.addEventListener(String(Bo.PV.QuerySubmitted),u,{signal:l.signal}),Ts(a),n(t)}))}function Ts(e){(0,o.cY)(`showUserTextCard: ${e}`),s.$.getInstance().displayResponse({chatCardType:$o._.Default,chatMessageData:{defaultMessageProps:{user:Ho.Q9.Human,messageHeader:{text:e}}}})}const Ss={[rn.U2.Running]:$n.H.info,[rn.U2.Success]:$n.H.success,[rn.U2.Failure]:$n.H.error};function ws({communicationHandler:e,setCannedOption:t}){const[a,i]=R.useState(!1),[l,s]=R.useState(!1),[c,d]=R.useState(void 0),[u,m]=R.useState(!0),[h,g]=R.useState(!1),[p,b]=R.useState([]),[f,C]=R.useState({resolve:()=>{}}),[y,v]=R.useState(),[T,S]=R.useState({reject:()=>{}}),w=R.createRef(),[E,I]=R.useState(0),A=(0,Ke.j)(),L=async()=>{try{let e=null;const t=w.current?.files,a=t?.length;if(!t||!a)throw new Error("No test files uploaded");if(1===a&&t.item(0)?.name.endsWith(".js")){const a=await t.item(0).text(),n=t.item(0).name.slice(0,-3);return e=[{filename:n,tests:[{query:n,create:{type:"worksheet",workbook:"",name:""},officeScripts:{code:a,codeExplanation:"Test",canMakeChanges:!1,returnsValue:!0,apiUsageMetadata:{}},requiredFeatureUsed:x.q.OfficeJsCommanding}]}],void f.resolve({testSets:e,workbooks:{},savingWorksheetStates:u,dirHandle:c})}const n=[];for(let o=0;o<a;o++){const a=t.item(o);if(a)if(a.name.endsWith(".json")){const t=await a.text();try{e=e??[];const n=a.name.slice(0,-5);e.push({filename:n,tests:JSON.parse(t)})}catch{throw new Error("Could not parse "+a.name)}}else a.name.endsWith(".xlsx")&&n.push(a)}if(!e||!Array.isArray(e))throw new Error("Please upload a json file with a list of test details");const o=[];for(const{filename:t,tests:a}of e)for(let e=0;e<a.length;e++){const r=a[e],i=`${t}'s test ${e}`;if(!r.query)throw new Error(`${i} does not have a query`);if(!r.create)throw new Error(`No instructions on how to create ${i}'s workbook state`);if(r.expectedFailureStates){const e=r.expectedFailureStates.filter((e=>!(0,rn.pE)(e)));if(e.length)throw new Error(`Expected errors states [${e.join(", ")}] do not exist. Valid states are:\n${rn.uq.join("\n")}`)}if("string"==typeof r.create)continue;const l=r.create;if(!l.workbook)throw new Error(`No workbook named to create ${i}'s state`);if(!l.name)throw new Error(`No active selection was named for ${i}`);if(!l.type)throw new Error(`No active selection types was named for ${i}`);const s=n.find((e=>e.name===l.workbook));if(!s)throw new Error(`Workbook ${l.workbook} was not uploaded to create ${i}'s state`);o.includes(s)||o.push(s)}const r={};await Promise.all(o.map((e=>new Promise(((t,a)=>{const n=new FileReader;n.onload=()=>{if(!n.result)return a(new Error(e.name+" could not be uploaded"));const o=n.result.toString().indexOf("base64,"),i=n.result.toString().substr(o+7);r[e.name]=i,t(null)},n.readAsDataURL(e)}))))),f.resolve({testSets:e,workbooks:r,savingWorksheetStates:u,dirHandle:c})}catch(e){alert("Failed uploading test files: "+e.message),f.resolve({})}},k=async(t=!0,a,n,r,i,l=!1,c)=>{OfficeExtension.config.extendedErrorLogging=!0,g(!!i);const d=[],u={};let m,h=!1;if(a&&n&&r)d.push({filename:r,tests:a}),Object.assign(u,n);else{const e=await(async()=>(s(!0),new Promise((e=>C({resolve:e}))).finally((()=>s(!1)))))();if(!e.testSets||!e.workbooks)return[];g(!!i),Object.assign(d,e.testSets),Object.assign(u,e.workbooks),h=e.savingWorksheetStates,m=e.dirHandle}let p=!1;if(t){const e=d.flatMap((({filename:e,tests:t})=>t.flatMap(((t,a)=>t.check?[]:[` ${e} ${a}:  ${t.query}`]))));e.length&&((0,o.cY)("Tests without checks:",e.join("\n")),p=confirm(`You selected automated tests but have ${e.length} tests without checks (find "Tests without checks" in the console for list of queries).\nDo you want to count tests that successfully apply changes as passing?`))}i&&(h=!1);const f=await(0,xo.Eb)((()=>({}))),y=f.documentConfig?.documentSensitivity;if(h&&y?.isEncrypted&&alert(`Before and after workbooks for each test won't be downloaded because this document's "${y.displayName}" sensitivity. An unencrypted sensitivity label is required to save to those state, but the tests will run as normal.`),h&&!confirm(`All the data in your workbook will be deleted and ${2*d.flatMap((({tests:e})=>e)).length} workbooks will be saved in your ${m?.name??"current downloads"} folder. Do you want to continue?`))return[];const x=[];for(const a of d){I(a.tests.length);let n,o=m;d.length>1&&m&&h&&(o=await m.getDirectoryHandle(a.filename.replace(/\.\w$/,""),{create:!0})),n=i?new Dn(a,u,A,e,b,m):new rn.KF(a,u,A,e,p,h,b,S,t?void 0:v,m,o,l,c);const r=await n.run();x.push(...r),b([])}return OfficeExtension.config.extendedErrorLogging=!1,x};if(R.useEffect((()=>{(0,r.usH)()&&"undefined"!=typeof window&&(window.runTests=async(e,t,a,n,o,r=!1,i=void 0)=>await k(e,t,a,n,o,r,i))}),[k]),!(0,r.usH)())return null;const F=async t=>{switch(t){case"Automated Tests":return k(!0);case"Manual Tests":return k(!1);case"Extract Test Context Only":return k(!1,void 0,void 0,void 0,!0);case"Calculated Columns":return(async e=>{const t=(0,Va.A)(),a=e;a(Wt.m.setLatestRequestId(t));const n=Yt.CP.getActiveTable();if(!n)return;const o=n.name;await a((0,ba.VW)(o,t)),e(ua.m.updateTableName({requestId:t,table:o})),a(ua.m.startFetching(t)),e(Wt.m.startExecutingCommand({command:x.OP.CalculatedColumns,id:t})),a((0,ma.UN)(No(t,"1",["1"],["link"],['=HYPERLINK("https://www.microsoft.com", "Microsoft")'],[Po(n,1)]))),a((0,ma.UN)(No(t,"1",["1"],["row"],["=ROW()"],[Po(n,1)]))),a((0,ma.UN)(No(t,"2",["2","3"],["Row*10","Row*100"],["=ROW() * 10","=ROW() * 100"],[Po(n,10),Po(n,100)]))),a((0,ma.UN)(No(t,"3",["4","5","6","7","8","9","10","11"],["Row*10","Row*100","Row*1000","Row*10000","Row*100000","long name with spaces long name with spaces","name with\n             new line","Row*100000000"],["=ROW() * 10","=ROW() * 100","=ROW() * 1000","=ROW() * 10000","=ROW() * 100000","=ROW() * 1000000","=ROW() * 10000000","=ROW() * 100000000"],[Po(n,10),Po(n,100),Po(n,1e3),Po(n,1e4),Po(n,1e5),Po(n,1e6),Po(n,1e7),Po(n,1e8)])))})(A);case"Calculated Row":return(async e=>{const t=(0,Va.A)(),a=e;a(Wt.m.setLatestRequestId(t));const n=Yt.CP.getActiveTable();if(!n)return;const o=n.name;await a((0,ba.VW)(o,t)),e(ua.m.updateTableName({requestId:t,table:o})),a(ua.m.startFetching(t)),e(Wt.m.startExecutingCommand({command:x.OP.CalculatedColumns,id:t})),a((0,ma.UN)(Mo(t,"1",["1"],["=ROW()"],["1"])))})(A);case"Search With Citations":return(async e=>{const t=wo;await ko(t,e)})(A);case"Web Search With Table":return(async e=>{const t=Io;await ko(t,e)})(A);case"Adaptive Card":return(async e=>{const t=Ro;await ko(t,e)})(A);case"Search Negative Tests":return Lo(A);case"Import Data - Render Card":return Ao(A);case"Chat History":return vs(A,e)}},_=[{key:"flux-getInsights",text:"Use the Analyze Data skill directly"},{key:"flux-createCalculatedColumns",text:"Use the Calculated Columns skill directly"},...(0,r.vom)()?[{key:"flux-pythonCalculatedColumns",text:"Use the Python Calculated Columns skill directly"}]:[],{key:"flux-editDocument",text:"Use the Commanding skill directly"},...(0,r.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.DataShaping",!1)?[{key:"flux-dataShaping",text:"Use the Data Shaping skill directly"}]:[],...(0,r.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ImportDataAsSkill",!1)?[{key:"flux-importData",text:"Use the Import Data as skill directly"}]:[],{key:"python",text:"Use the Python skill directly"},...(0,r.GqX)()?[{key:"flux-pythonEditInPlace",text:"Use the Python Edit In-Place skill directly"}]:[]];_.push({key:"flux-createCalculatedCell",text:"Use the Column Aggregation skill directly"}),_.push({key:"no-override",text:"No override",iconProps:{iconName:"Checkmark"}});const P={items:_,onItemClick(e,a){_.forEach((e=>delete e.iconProps)),a&&(a.iconProps={iconName:"Checkmark"}),"no-override"===a?.key?t?.():t?.(a?.key)}},N={items:[{key:"Automated Tests",text:"Automated End-to-End Tests"},{key:"Manual Tests",text:"Manual End-to-End Tests"},{key:"Extract Test Context Only",text:"Extract Test Context Only"},{key:"Calculated Columns",text:"Calculated Columns suggestion"},{key:"Calculated Row",text:"Calculated Row suggestion"},{key:"Import Data - Render Card",text:"Import Data - Render Card"},{key:"Search With Citations",text:"Search With Citations"},{key:"Web Search With Table",text:"Web Search With Table"},{key:"Adaptive Card",text:"Adaptive Card"},{key:"Search Negative Tests",text:"Search Negative Tests"},{key:"Chat History",text:"Chat History Tests"}],onItemClick(e,t){i(!0),F(t?.key).finally((()=>i(!1)))}};if(l){const e=()=>f.resolve({});return(0,n.jsxs)(Hn.a,{isOpen:!0,onDismiss:e,styles:{main:{position:"fixed",top:0,zIndex:100,minHeight:0}},children:[(0,n.jsx)("input",{type:"file",id:"test-selector",ref:w,multiple:!0,accept:"*.json,*.xlsx,*.js",style:{display:"none"},onChange:L}),(0,n.jsxs)(vn.B,{children:[(0,n.jsx)(xn.K,{iconProps:{iconName:"Cancel"},onClick:e}),(0,n.jsx)(Un.Y,{text:"Select Test File and Workbooks",primary:!0,onClick:()=>w.current?.click()}),(0,On.vH)()?(0,n.jsx)(Un.Y,{text:"Select Output folder",primary:!0,onClick:()=>window.showDirectoryPicker().then(d)}):null,h?null:(0,n.jsx)(qn.l,{label:"Save Workbook States",inlineLabel:!0,defaultChecked:!0,onText:"On",offText:"Off",onChange:(e,t)=>m(!!t),styles:{root:{margin:"10px auto"}}})]})]})}return a?(0,n.jsx)(Hn.a,{isOpen:!0,styles:{main:{position:"fixed",top:0,minHeight:0,maxHeight:"unset",padding:"5px"}},children:(0,n.jsxs)(un.n,{multiple:!0,collapsible:!0,children:[(0,n.jsx)("h3",{style:{textAlign:"center",margin:0,fontFamily:"sans-serif"},children:`Tests ${p.length}/${E}`}),(0,n.jsx)(xn.K,{iconProps:{iconName:"Cancel"},onClick:T.reject}),p.map(((e,t)=>(0,n.jsxs)(mn.A,{value:t,children:[(0,n.jsx)(hn.u,{expandIconPosition:"end",children:(0,n.jsxs)(Vn.n,{messageBarType:Ss[e.state],children:[e.test.query,": ",(0,n.jsx)("b",{children:e.stateDetails.at(-1)})]})}),y?.test===e.test?(0,n.jsxs)("div",{style:{width:"80%",margin:"auto",marginTop:"5px"},children:[(0,n.jsx)("h4",{style:{textAlign:"center",margin:0,fontFamily:"sans-serif"},children:"Correct?"}),(0,n.jsx)(Gn.j,{style:{float:"left",marginBottom:"5px"},onClick:()=>y.resolve(!0),children:"Yes"}),(0,n.jsx)(Gn.j,{style:{float:"right"},onClick:()=>y.resolve(!1),children:"No"})]}):null,(0,n.jsxs)(gn.v,{children:[(0,n.jsx)(pn.$,{"aria-label":"Copy",icon:(0,n.jsx)(bn.k8e,{}),onClick:()=>(0,On.lW)(JSON.stringify(e))}),(0,n.jsx)("pre",{children:JSON.stringify(e,null,2)})]})]},t))).reverse()]})}):(0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)?(0,n.jsxs)(n.Fragment,{children:[t&&(0,n.jsx)(Un.Y,{iconProps:{iconName:"TestPlan"},split:!0,splitButtonAriaLabel:"Set Canned option","aria-roledescription":"Set Canned option",menuProps:P,style:{position:"fixed",top:0,right:100,zIndex:100,opacity:"50%"}}),(0,n.jsx)(Un.Y,{iconProps:{iconName:"TestUserSolid"},split:!0,splitButtonAriaLabel:"Run Tests","aria-roledescription":"Run Tests",menuProps:N,style:{position:"fixed",top:0,right:0,zIndex:100,opacity:"50%"}})]}):(0,n.jsx)(n.Fragment,{children:!(0,r.yw9)("OfficeVSO_9205837_formulasDevButton")&&t&&(0,n.jsx)(Un.Y,{split:!0,splitButtonAriaLabel:"Set Canned option","aria-roledescription":"Set Canned option",menuProps:P,text:"Use skill directly",style:{position:"fixed",top:10,right:15,zIndex:100,opacity:"100%",borderColor:"green"}})})}function Es(e,t){const a=[];return(0,r.yw9)("OfficeVSO_9205837_formulasDevButton")&&((0,X.I_)()||(0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1))&&(a.push({id:d.erl.DirectSkill,name:d.rBP[d.erl.DirectSkill],isSelected:!1,isDefaultCopilot:!1,copilotType:Bn.NV.ClientProvided,copilotComponent:(0,n.jsx)(vo,{setCannedOption:t=>e.cannedOption=t,getCannedOption:()=>e.cannedOption}),menuIcon:(0,n.jsx)(bn.SFT,{})}),a.push({id:d.erl.DevTools,name:d.rBP[d.erl.DevTools],isSelected:!1,copilotType:Bn.NV.ClientProvided,isDefaultCopilot:!1,copilotComponent:(0,n.jsx)(bo,{setShouldShowFormulaDevButton:e=>t(ua.m.setShouldShowFormulaDevButton({shouldShowFormulaDevButton:e}))}),menuIcon:(0,n.jsx)(bn.SFT,{})}),(0,r.yw9)("OfficeVSO_9503894_AugloopDiagnosticsPane")&&(a.push({id:d.erl.AugloopDiagnostics,name:d.rBP[d.erl.AugloopDiagnostics],isSelected:!1,copilotType:Bn.NV.ClientProvided,isDefaultCopilot:!1,copilotComponent:(0,n.jsx)(Rn,{}),menuIcon:(0,n.jsx)(fn.HpN,{})}),a.push({id:d.erl.AugloopModelVisualizer,name:d.rBP[d.erl.AugloopModelVisualizer],isSelected:!1,copilotType:Bn.NV.ClientProvided,isDefaultCopilot:!1,copilotComponent:(0,n.jsx)(Mn,{}),menuIcon:(0,n.jsx)(fn.HpN,{})}))),a}var Is=a(993384);var Rs=a(173491);var As=a(472096),Ls=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},ks=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},Fs=function(){return Ls(void 0,void 0,void 0,(function(){var e,t;return ks(this,(function(a){switch(a.label){case 0:if(!(0,As.$$)()&&!(0,As.fU)())return[3,5];a.label=1;case 1:return a.trys.push([1,3,,4]),[4,OfficeFirstParty.PrivateApi.execute("SHOW_COPILOT_PRODIGY_UPSELL_FLOW")];case 2:return e=a.sent(),(0,re.cY)(e),[3,4];case 3:return t=a.sent(),(0,re.cY)("Error Executing SHOW_COPILOT_PRODIGY_UPSELL_FLOW"+t),[3,4];case 4:return[3,7];case 5:return[4,Office.license.launchUpsellExperience("copilotsidepanel_creditlimit")];case 6:a.sent(),a.label=7;case 7:return[2]}}))}))},_s=a(259895);const Ps=(0,u.n)((0,_s.f)({chatFreStack:{flexGrow:1},chatUiStack:{backgroundColor:"transparent"},spinner:{height:"100vh",width:"100vw",justifyContent:"center",alignItems:"center"}})),Ns={root:{height:"100vh",width:"100vw",justifyContent:"center",alignItems:"center"}},Ms=(0,u.n)({root:{height:"10%",width:"max-content",backgroundColor:"white",zIndex:1}}),Os={calloutStyles:{marginTop:4,borderRadius:2,paddingRight:10},containerStyles:{maxWidth:"calc(100vw - 20px)",minWidth:"calc(100vw - 20px)",borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},Ds={calloutStyles:{marginTop:4,borderRadius:2,paddingRight:0},containerStyles:{maxWidth:"calc(100vw - 20px)",minWidth:"calc(100vw - 20px)",borderRadius:2,paddingHorizontal:0,paddingTop:0,paddingBottom:8,maxHeight:400},itemsStyles:{fileItemStyles:{iconStyles:{margin:4}}}},Bs=()=>{const e=(0,st.vI)();switch(e){case Office.PlatformType.PC:return"Excel_Win32";case Office.PlatformType.Mac:return"Excel_Mac";case Office.PlatformType.iOS:return"Excel_iOS";case Office.PlatformType.OfficeOnline:return"Excel_Online";default:return S.M.getInstance().logError({eventType:Gt.S2.ChatEvents,errorMessage:`Unknown Host Platform Type: ${e}`,logLevel:oe.$b.Error}),""}},$s=()=>{const e=(0,st.vI)();switch(e){case Office.PlatformType.PC:return"Win32";case Office.PlatformType.Mac:return"Mac";case Office.PlatformType.iOS:return"iOS";case Office.PlatformType.OfficeOnline:return"Web";default:return S.M.getInstance().logError({eventType:Gt.S2.ChatEvents,errorMessage:`Unknown Host Platform Type: ${e}`,logLevel:oe.$b.Error}),""}};var Hs=a(48093),Us=a(520107);var qs=a(101576),Vs=a(719322),Gs=a(991940);const Ws=()=>{const e=[];Office.context.document.mode!==Office.DocumentMode.ReadOnly&&e.push((()=>{const e=[];return e.push({nodeType:"ActionSet",text:d.Pqm.generateFormulaColumnSuggestion(),data:{shouldSubmitQueryOnClick:!0}}),e.push({nodeType:"ActionSet",text:d.Pqm.addAColumnThatCombines()}),e.push({nodeType:"ActionSet",text:d.Pqm.addAColumnToExtract()}),e.push({nodeType:"ActionSet",text:d.Pqm.addAColumnThatCalculates()}),{nodeType:"Category",text:d.hn.menuSectionCreate(),promptCategory:"Create",iconRegular:qs.vfO,iconHover:qs.Dal,children:e}})());const t=(()=>{const e=[];return e.push({nodeType:"ActionSet",text:d.BaM.showDataInsights(),data:{shouldSubmitQueryOnClick:!0}}),e.push({nodeType:"ActionSet",text:d.BaM.percentageCalculation()}),e.push({nodeType:"ActionSet",text:d.BaM.howManyDifferent()}),e.push({nodeType:"ActionSet",text:d.BaM.whichItems()}),{nodeType:"Category",text:d.hn.menuSectionUnderstand(),promptCategory:"Understand",iconRegular:Vs.uJg,iconHover:Vs._38,children:e}})();t&&e.push(t);const a=(()=>{const e=[];return e.push({nodeType:"ActionSet",text:d.ZB_.highlight()}),e.push({nodeType:"ActionSet",text:d.ZB_.sort()}),e.push({nodeType:"ActionSet",text:d.ZB_.filter()}),e.push({nodeType:"ActionSet",text:d.ZB_.applyRYG()}),{nodeType:"Category",text:d.hn.menuSectionEdit(),promptCategory:"Edit",iconRegular:Gs.RIf,iconHover:Gs.FBb,children:e}})();a&&Office.context.document.mode!==Office.DocumentMode.ReadOnly&&e.push(a),e.push((()=>{const e=[];return e.push({nodeType:"ActionSet",text:d.epH.help(),data:{shouldSubmitQueryOnClick:!0}}),{nodeType:"Category",text:d.hn.menuSectionAsk(),promptCategory:"Ask",iconRegular:Nr.I11,iconHover:Nr.kNP,children:e}})());return{promptGuideMenuData:{nodeType:"Root",text:d.hn.menuTitle(),children:e}}};var zs=a(200828),js=a(991869),Qs=a(734e3),Js=a(371616);const Ys=e=>{if(s.$.getInstance().getInputText().length>0)return{message:"",restShyMessage:""};const t=(0,r.ZAR)()?void 0:(e=>{if(e&&e?.tableLikeRangeFeatures!==Pt.ye.Unrecognized)return(0,Ta.r)(e.address)})(e),a=(0,r.vIj)()&&((0,Hs.gc)()||(0,Hs.pX)());if(Yt.CP.pythonContextManager.isPythonMode)return{message:(0,d.ahY)(),restShyMessage:(0,d.Hn3)()};if(t){let e=a?(0,d.IZs)():(0,d.tl8)();e=e.replace("{0}",t);return{message:e,restShyMessage:(0,d.LA5)().replace("{0}",t)}}return a?{message:(0,d.ir6)(),restShyMessage:(0,d.Hn3)()}:{message:(0,d.NIQ)(),restShyMessage:(0,d.Hn3)()}};function Xs(e,t){return{settings:{hostAppId:Bs(),hostAppName:d.fn_,hostAppPlatform:$s(),hostAppScenario:d.Z1M,hostDefaultLocale:(0,r.yw9)("OfficeVSO_9463384_EditorConfigUseUserLang")?(0,js.gl)():(0,st.Yd)(),isDogfoodEnvironment:(0,X.I_)(),enableAutomaticScoping:!0,enableVisualRefresh:(0,r.g92)()},telemLogger:{logError:e=>{(0,Na.cY)("Shared Copilot CIQ Error Log: ",e)}},telemSink:S.M.getInstance().getTelemetrySink(),entitiesSupported:[Bo.ck.File,Bo.ck.People,Bo.ck.Event,Bo.ck.Message],isExpandedECCEnabled:!0,getSensitivityInfo:xo.qH,featureFlags:{enableAppGptsInCiq:(0,r.v2n)(),enableAppPluginsInCiq:(0,r.DU1)(),enableTopicECC:(0,r.K7T)(),enableAppMessageExtensionsInCiq:(0,r.vNc)(),enableAppPPInCiq:(0,r.$Xf)(),enableAppTypeBInCiq:(0,r.DDL)(),disableClientConfigQueryCharacterForEditorService:!t&&(0,r.WIm)(),disablePluginsAsDAInFlyout:!(0,r.Pz_)(),enableLocalCUAAgent:(0,r.PrP)()},onOpenGptStorefront:()=>{(0,Pe.iB)((0,r.dA9)(),!1,ce.Xt.AtMention)},onAttachCloudFiles:e,inlineSuggestionsStyles:(0,r.g92)()?Ds:Os,moreCopilotsStringOverride:(0,r.tmD)()?(0,se.Cs)()?OfficeaicopilotStrings.GetAgents:"Get agents":void 0}}const Zs=()=>{const e={promptSuggestionHintCardMap:{[(0,d.Yhj)()]:{headerText:(0,d.o3Z)(),descriptionTextList:[(0,d.hAn)(),(0,d.aS7)(),(0,d.VdU)(),(0,d.aDZ)()]},[(0,d.ekx)()]:{headerText:(0,d.YKk)(),descriptionTextList:[(0,d.vqw)(),(0,d.oOi)()]},[(0,d.byP)()]:{headerText:(0,d.YKk)(),descriptionTextList:[(0,d.v7j)(),(0,d.vks)()]},[(0,d.z15)()]:{headerText:(0,d.cRY)(),descriptionTextList:[(0,d.zr)(),(0,d.sJU)(),(0,d.l7G)(),(0,d.s46)(),(0,d.lqT)()]}}};return(0,r.H2A)()&&(0,Fa.Gd)()&&(e.promptSuggestionHintCardMap[(0,d.n00)()]={headerText:"Use Python to analyze data",descriptionTextList:["Forecast the sales for the next 10 periods","Reduce Features via PCA with 3 components, plot 3d for k means clustering","Summarize each cluster with 75 percentiles in a column in descending order by row sum"]}),e},Ks=(e,t)=>({trySydneyToggleChecked:!1,trySydneyToggleEnabled:!1,tryEnterpriseSearchToggleChecked:!1,tryEnterpriseSearchToggleEnabled:!1,tryReviewerAgentToggleOnChange:e,tryReviewerAgentToggleChecked:t,tryReviewerAgentToggleEnabled:(0,r.wBl)()}),ec=(e,t,n,o,i,l,s,c,u,m,h,g,p,b,f,C,y,v)=>{const x={zeroQueryMessageV2Props:(0,Qs.uC)(b,(()=>{o((0,jt.it)())})),hintCardProps:Zs(),tipCardProps:n,suggestionPillsUiProps:(0,zs.n)(t,!Yt.CP.pythonContextManager.isPythonMode&&t.length>0,(()=>{o((0,jt.yG)())}),l,i),toggleUiProps:Ks(u,m),chatContainerUiProps:{showFeedbackButtons:(0,Js.tV)(),useFluentAIGeneratedIndicator:(0,r.yw9)("OfficeVSO_9066056_useFluentAIGeneratedIndicator"),shouldSupportCitationsInAvalon:(0,r.aJZ)()},customMessageRenderers:jl,documentSensitivityProps:s,changeTopicUiProps:{hideChangeTopicButton:(0,r.T$f)()},clientInfoProps:{clientInfo:h,taskModuleLauncher:C.launchTaskModule,extensibilityDialogLauncher:y.launchExtensibilityDialog},singleModeProps:"off"===p.feature?{isInSingleMode:!1}:{isInSingleMode:!0,exitButtonProps:tc(o,p)}};return x.chatInputV2Props=((e,t,n,o,i,l=!1)=>{const s=!Yt.CP.pythonContextManager.isPythonMode,c=(0,r.vIj)()&&s,u=(0,r.lDp)()&&s,m=Ys(e);return{chatPlaceholderMessage:(0,r.de5)()?(0,d.bj$)():void 0,chatRestShyPlaceholderMessage:m.restShyMessage,voiceInputProps:(0,r.CGU)()?{voiceInputLocale:(0,st.Yd)(),microphonePermissionErrorMessage:st.iJ.isWebPlatform()?(0,d.XWM)():(0,d.Sak)(),microphonePermissionErrorTitle:st.iJ.isWebPlatform()?(0,d._C5)():(0,d.ReY)(),microphonePermissionImagePath:st.iJ.isWebPlatform()?a(450501):void 0,showMicrophonePermissionHelpLink:st.iJ.isWebPlatform(),handleInChatInput:!0}:void 0,menuProps:s?Ws():void 0,editorConfig:(0,r.Dl1)()?Xs(o,(0,r.H_b)()&&t):void 0,buttonProps:{groundingButtonEnabled:c,atMentionButtonEnabled:u},pluginsInfo:n(),shouldInitializeEditorInChatInput:c,characterLimitErrorMessage:(0,r.yw9)("OfficeVSO_8986671_UseLocalizedStringForCharacterLimitExceed")?(0,d.OKS)():void 0,imageInputEnabled:(0,r.ljm)()&&s,insertImageFlags:{isImageFromPhoneButtonEnabled:(0,r.O8_)(),isPasteFromClipboardButtonEnabled:(0,r.NBG)(),imageFromPhoneEndpoint:(0,r.Oo4)()},chatInputButtons:i,addMenuOptionsProps:{addButtonDirection:"left"},isDisabled:l,shouldRunMCPAgent:async()=>{if(0===(0,r.eHf)().length&&!(0,r.NbV)()||0===(0,r.CyP)().length)return;const e={"Non-Business":0,Public:1,General:2,Confidential:3,"Highly Confidential":4},t=await nt.n.getInstance().getInDocSensitiveLabelUsingOfcJs();if(!t.displayName)return!1;const a=t.displayName.split("\\");return 0!==a.length&&""!==a[0]&&a[0]in e&&e[a[0]]<e.Confidential},orbisProps:{getOfficeComJSClientProps:void 0,getOfficeJSClientProps:(0,r.NbV)()?Us.z:void 0}}})(i,e,c,g,f,v),x.chatHistoryUiProps={enableChatHistoryV2:(0,r.K$3)(),isGptsEnabled:(0,r.Pz_)()},x.creditsUIProps={creditUpsellHandler:Fs,upsellFwdLinkId:(0,d.tMN)(),clientParam:(0,d.DPI)()},x};function tc(e,t){return{buttonText:t.caption,...t.exitMenuOptions&&t.exitMenuOptions?.length>0?{menuProps:t.exitMenuOptions,onClick:t=>{e((0,jt.eB)(t))}}:{onClick:()=>{e((0,jt.eB)(void 0))}}}}var ac=a(119202);var nc=a(272487);const oc=(0,b.A)(f.wrX,f.UhZ),rc=(0,b.A)(Nr.BKZ,Nr.XQT),ic=(0,b.A)(f.Qko,f.gu9),lc=(0,b.A)(bn.XZm,bn.pnR),sc=(0,u.n)({actionButton:{backgroundColor:C.k1.colorBrandBackground,color:C.k1.colorNeutralForegroundOnBrand},root:{border:`1px solid ${C.k1.colorBrandBackground}`},tipCardIcon:{color:C.k1.colorBrandBackground}}),cc=(0,u.n)({root:{border:`1px solid ${C.k1.colorBrandBackground}`},tipCardIcon:{color:C.k1.colorBrandBackground}});const dc=(e,t,a,o,i,l,u,g,p,b,f)=>{const[C,y]=R.useState(!1);if(R.useEffect((()=>{void 0!==f&&(f!==c.$.Enabled?(s.$.getInstance().clearLoadingPaneTimeout(),(0,I.oO)((new Date).getTime().toString()),y(!0)):C&&(s.$.getInstance().startLoadingPaneTimeout(!0),(0,I.Gr)((new Date).getTime().toString())))}),[f]),void 0!==f){if(f&c.$.DisabledThirdPartyHost)return{descriptionTextList:[(0,d.gk_)()],headerText:(0,d.DyN)(),icon:oc,isError:!0,overrideStyles:cc()};if((f&(c.$.DisabledNewWorkbook|c.$.DisabledAutoSaveOff|c.$.DisabledLocalFile))!==c.$.Enabled)return{descriptionTextList:[(0,d.USL)()],headerText:(0,d.tDq)(),buttonTitle:(0,d.mT9)(),onClick:()=>{E("EnableAutoSave")},icon:oc,isError:!0,overrideStyles:sc()};if((0,r.yw9)("OfficeVSO_9854459_UpdateErrorMessageForUnsupportedFileState")&&f&c.$.DisabledSharedLock)return{descriptionTextList:[(0,n.jsxs)(m.E,{block:!0,children:[d.olU.FileStateUnsupportedMessage,(0,n.jsx)("div",{style:{marginTop:"16px"},children:(0,n.jsx)(h.N,{href:d.Fxc,target:"_blank",style:{textDecoration:"underline"},children:d.olU.FileStateUnsupportedLearnMoreLinkText})})]},"unsupported-file-state-message")],headerText:d.olU.FileStateUnsupportedTitle,icon:oc,isError:!0,overrideStyles:cc()};if((0,r.yw9)("OfficeVSO_9185107_DisabledDialogSheetError")&&f&c.$.DisabledDialogSheetExists)return{descriptionTextList:[(0,d.UEB)()],headerText:(0,d.v01)(),icon:oc,isError:!0,overrideStyles:cc()};if(!(0,r.yw9)("OfficeVSO_9854459_UpdateErrorMessageForUnsupportedFileState")&&f&c.$.DisabledSharedLock||f&c.$.DisabledAugLoopPermanentError)return{descriptionTextList:[(0,d.HTR)()],headerText:(0,d.Vx2)(),icon:oc,isError:!0,overrideStyles:cc()}}if(p){return{descriptionTextList:[Office.context.platform===Office.PlatformType.OfficeOnline?(0,d.PEH)():(0,d.HTR)()],headerText:(0,d.Vx2)(),icon:oc,isError:!0}}if((0,r.geU)()&&!l&&u&&g){const e=function(e,t,a,n){let o="",r=oc;if(t?(o=t.title,r=rc):n?(o=n.address,r=ic):a?(o=a.name,r=lc):e&&!1!==e.tableIntersected&&(e.tableLikeRange?(o=e.address,r=lc):o=e.name),o){const[e,t]=(0,d.DwD)().split("{0}");return{headerText:[e,o,t].join(""),icon:r,isError:!1,isWarning:!0}}}(t,a,o,i);if(e)return e}if(e||l||!u||!g)return g?u||b?l?{descriptionTextList:[(0,d.MED)()],headerText:(0,d.TSg)(),icon:oc,isError:!0}:{isError:!1}:{descriptionTextList:[(0,d.L0p)()],headerText:(0,d.QOn)(),icon:oc,isError:!0}:{descriptionTextList:[(0,d.USL)()],headerText:(0,d.tDq)(),icon:oc,isError:!0}},uc=({theme:e=g.Gm.defaultWhite,isHighContrast:t=!1,accountInfo:a,initTelemetryHandler:l})=>{const[c]=(0,nc.usePreloadCopilot)(),[u]=(0,nc.useHasPreloadedCopilotBeenShown)(),[m,h]=(0,nc.useUnifiedPromptPrivateApiMessage)(),b=(0,Ke.j)(),f=(0,lo.Pj)(),[y,v]=(0,R.useState)({citationTitle:"",isFluxFlowEnabled:!0,isCitationsEnabled:(0,r.vIj)()}),T=(0,R.useMemo)((()=>(0,js.gl)()),[]);var w;w=async()=>{const e=document.getElementsByClassName(d.fw9);e?.length&&e[0].focus(),s.$.getInstance().setInputFocus(),s.$.getInstance().scrollToBottom()},R.useEffect((function(){var e=Q.subscribe(w);return function(){e()}}),[]),R.useEffect((()=>{l&&l(qt.B.getInstance())}),[l]);const E=(0,r.K5)()&&void 0!==c&&(0,r.wQA)();!function(e){var t,a=!1;R.useEffect((function(){return t=Q.subscribe((function(){return J(void 0,void 0,void 0,(function(){return Y(this,(function(n){switch(n.label){case 0:return a?[3,2]:(a=!0,[4,e()]);case 1:n.sent(),t(),n.label=2;case 2:return[2]}}))}))})),function(){t()}}),[])}((async()=>{E&&!u&&s.$.getInstance().activateAugloopAnnotations()}));const[I,A]=R.useState(!1),[L,k]=R.useState(!1),[F,_]=(0,R.useState)((0,r._bw)()?nt.n.getInstance(void 0,void 0,s.$.getInstance().getCopilotRef(),void 0,Na.Y6).getSensitivity():void 0),P=(0,r.geU)();let N=(0,lo.d4)((e=>e.chat.suggestionList));const M=(0,lo.d4)((e=>e.chat.zqmSuggestionList)),O=(0,lo.d4)((e=>e.chat.loadingStrings)),D=(0,lo.d4)((e=>e.selection.selectionError)),B=(0,lo.d4)((e=>e.chat.executingCommand)),$=(0,lo.d4)((e=>e.chat.isPythonMode)),H=(0,lo.d4)((e=>e.chat.isPythonThinkDeeperMode)),U=(0,lo.d4)(va.OA),q=(0,lo.d4)((e=>e.selection.activeTable),((e,t)=>{let a=!0;return P&&(a=e?.tableIntersected===t?.tableIntersected),e?.name===t?.name&&e?.tableLikeRangeFeatures===t?.tableLikeRangeFeatures&&a})),V=(0,lo.d4)((e=>P?e.selection.activeChart:void 0)),G=(0,lo.d4)((e=>P?e.selection.activePivotTable:void 0)),W=(0,lo.d4)((e=>P?e.selection.activeRange:void 0)),K=(0,lo.d4)((e=>e.selection.isWorksheetProtected)),ie=(0,lo.d4)((e=>e.selection.isPermanentError)),he=(0,lo.d4)((e=>e.selection.isWorkbookAutoSaveOn)),ge=(0,lo.d4)((e=>e.selection.isWorksheet)),pe=(0,lo.d4)((e=>e.chat.dataShapingState.started)),be=(0,lo.d4)((e=>e.app.userType)),fe=(0,lo.d4)((e=>e.chat.singleModeState)),[Ce,ye]=R.useState({objectId:"",tenantId:""}),ve=R.useRef(null);(0,R.useEffect)((()=>{s.$.getInstance().setCopilotRef(ve)}),[ve]);const[xe,Te]=(0,R.useState)(void 0);(0,R.useEffect)((()=>{it.Y.getInstance().setBizChatHandoffPropertiesHandler(Te)}),[Te]);const Se=(0,r._SP)(),[we,Ee]=(0,R.useState)(!1),Ie=R.useCallback((()=>{const e=[];return(0,r.oJj)()&&!(0,r.ULj)()&&e.push({id:et.$.Work,onToggle:e=>{(0,o.cY)("ExcelCopilotChat: Microsoft M365 toggle is "+(e?"enabled":"turned off")),(0,Hs.LA)(e),A(e)},state:I?et.p.Enabled:et.p.Disabled}),e.push({id:et.$.Web,onToggle:e=>{(0,o.cY)("ExcelCopilotChat: Web Content toggle is "+(e?"enabled":"turned off")),(0,Hs.u$)(e),k(e)},state:L?et.p.Enabled:et.p.Disabled}),e}),[I,L]);(0,R.useEffect)((()=>{(0,r.vIj)()&&((0,o.cY)("ExcelCopilotChat: Reinitializing AL session due to user type change to "+be),(0,r._bw)()&&ke())}),[be]),(0,R.useEffect)((()=>{const e=B===x.OP.ActionAI||B===x.OP.AnalyzeData||B===x.OP.CalculatedColumns||B===x.OP.CalculatedCells||B===x.OP.ElseSkillExecuting||B===x.OP.FluxReasoning||B===x.OP.FluxGenerateResponse||B===x.OP.Search||B===x.OP.Python||B===x.OP.ImportDataGenerateSuggestion||B===x.OP.ImportDataRelevancyCheck||B===x.OP.PythonStartAnalysis;s.$.getInstance().updateLoadingComponentProps({loadingUiStringList:O,showStopGeneratingButton:e&&!(0,kl.dD)(),showInlineStopGeneratingButton:e&&(0,kl.dD)()})}),[B,O]),(0,si.H5)((()=>{b(ua.m.setShouldShowFormulaDevButton({shouldShowFormulaDevButton:(0,r.yw9)("OfficeVSO_9205837_formulasDevButton")&&((0,X.I_)()||(0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1))}))}));const Le=async()=>{const e=await async function(){try{return await Excel.run((async e=>{const t=(0,Is.dI)(e);return await e.sync(),t()}))}catch(e){const t=S.M.getInstance();return t.logErrorCode(Ga.O.LocaleFetchFailed,e),void((e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.inactiveWorkbook||e instanceof Ga.u)&&t.logErrorCode(Ga.O.InactiveWorkbook,e))}}();e&&b(zt.m.setLocaleInfo({localeInfo:e}))};async function ke(){nt.n.getInstance().getInDocSensitiveLabelInfo(),nt.n.getInstance().setLabelChangeEventListener(Fe),Oe()}async function Fe(e,t){(0,o.cY)(`ExcelCopilotChat: Sensitivity Label Change Event: ${JSON.stringify(e)} to ${JSON.stringify(t)}`),(0,r.vIj)()?await nt.n.getInstance().setSensitivityLabelToHighestSensitivity([nt.n.getInstance().getInDocSensitiveLabelInfo(),t]):(nt.n.getInstance().setInDocSensitivityLabelInfo(t),Oe())}function Oe(){(0,o.cY)("ExcelCopilotChat: Setting sensitivity in basic chat props");const e=(0,xo.yu)();v((t=>({...t,sensitivityIndicatorData:(0,xo.Q9)(e)}))),_(nt.n.getInstance().getSensitivity())}(0,R.useEffect)((()=>{(0,Na.sZ)();let e=!1;(0,r._bw)()&&(F&&""!==F.id||(async()=>{await nt.n.getInstance().setInDocSensitiveLabelInfoUsingOfcJs(),_(nt.n.getInstance().getSensitivity())})()),(async()=>{if((0,r.TyP)()&&function(e){de(this,void 0,void 0,(function(){var t,a,n,o,r;return ue(this,(function(i){switch(i.label){case 0:return(0,re.cY)("Sending signal to Copilot Warmup Flow"),t=(new Date).getTime(),[4,me(e)];case 1:i.sent(),(0,re.cY)("User Context Annotation Time is "+(0,ne.W)(t)),re.EG.sendLatencyTelemetry((0,le.pN)(((o={})[oe.CT.UserContextAnnotationActivationTime]=(0,ne.W)(t),o))),a=new ae.g0({parentPath:["Signal",ee.P.getTypeName()],items:[{id:te.r.generateId(),body:new ee.P}]}),n=ee.P.getTypeName(),(0,re.cY)("Submitting User Context signal"+JSON.stringify(a)),j=(new Date).getTime();try{z.submitOperation(a)}catch(e){(0,re.cY)("Error while submitting signal to Copilot Warmup Flow"+e)}return(0,re.cY)("User Context signal submitted..."),re.EG.sendChatEventTelemetry((0,le.pN)(((r={})[oe.h3.ChatEventType]=oe.a5.UserContextSignalSubmitted,r[oe.h3.ChatEventParameters]=n,r))),[2]}}))}))}((e=>{b(zt.m.setUserType(e))})),S.M.userQueryOrder=0,qt.B.getInstance().logSeenEvent(x.q.CopilotChat),(0,r.Qyj)()||(0,Ba.mN)(),await(async()=>{await Excel.run({delayForCellEdit:!0},(async e=>{e.application.onUndoChanged.add((async e=>{Z.xP.checkAndSetIsUndoableActionPresent(),"UndoGroupAdded"===e.changeType&&Yt.CP.isContextLocked()||(await b((0,jt.q9)())!==x.OP.FluxGenerateResponse?(0,ct.s_)(ct.H0.DisableUndo):rt.Z.getInstance().setDisableUndoButton(!0))}))}))})(),!e&&!(e||(0,r.LrR)()&&(await Le(),e))){if((0,r._bw)()&&ke(),!(0,r.yw9)("OfficeVSO_9113126_copilotchatrefnulltimeoutfix")&&(0,js.C6)()){const{message:e,telemetry:t}=oa.n.getLanguageUnavailableResponse();s.$.getInstance().displayResponse(e,t)}}})(),async function(){const e=await(0,Na.m4)();Nt.current=e,(0,o.cY)("SDX ClientInfo : ",e),b(zt.m.setClientInfo(e))}()}),[]),(0,R.useEffect)((()=>{b(Wt.m.initializeSuggestionList())}),[]),(0,R.useEffect)((()=>{(0,Hs.LA)(I),(0,r.vIj)()||(b(Wt.m.clearSuggestionList()),S.M.getInstance()?.logEvent((0,x.SV)(I?x.he.GroundPickerSelected_EnterpriseMode:x.he.GroundPickerSelected_DocMode,x.q.CopilotChat)),I||b((0,jt.Nl)()))}),[I]),(0,R.useEffect)((()=>{b((0,jt.it)())}),[]);const Je=R.useCallback((()=>{Ee(!0),setTimeout((()=>{Ee(!1)}),2e3)}),[]),Xe={enableClientSelectionContext:(0,r.OUH)()||(0,r.KV_)(),enableFetchImplicitQueryAnnotations:(0,r.KV_)()||(0,r.LUs)(),enableImplicitCIQForLocalFiles:(0,r.KV_)(),isChatHistorySignalDeferred:(0,r.KV_)(),enableImplicitCIQForCloudFiles:(0,r.uPG)()&&!(0,r.KV_)(),isBundledPackageEnabled:!0,isZQMEarlyLoadAndSessionStorageForChatHistoryEnabled:(0,r.qJy)(),enableProactiveZQMWith3SAPISuggestions:(0,r.Cpg)(),enableProactiveZQMWithSuggestedQnA:(0,r.wOV)(),isCreditsUIEnabled:!0,isAttachmentListEnabled:(0,r.N6k)(),isCloudFileUploadEnabled:(0,r.Shf)(),isLocalFileUploadEnabled:!1,isAppChatRebrandingEnabled:(0,r.de5)(),enablePluginSearchInFlyout:(0,r.fnY)()&&(0,Hs.pX)(),enableMorePluginHyperLinkInFlyout:(0,r.mdc)()&&(0,Hs.pX)(),defaultEnableEnterpriseGrounding:(0,r.HSC)(),defaultEnableWebGrounding:(0,r.gr8)(),enableQueryEndOnGptSwitch:(0,r.FFf)(),showNewChatOnGPTItem:(0,r.CUx)(),enableNewChatOnlyOnCopilot:(0,r.Lzg)(),isCustomGPTsEnabled:(0,r.Pz_)(),isSavePromptEnabled:(0,r.pBW)(),isSccReadAloudAugloopEnabled:(0,r.vzv)(),isSccReadAloudEnabled:(0,r.gPg)(),isViewMorePromptsIconV2Enabled:(0,r.s2L)(),isViewMorePromptsOneClickEnabled:(0,r.zd8)(),promptInputLength:(0,r.Z8j)("Microsoft.Office.Excel.FA000000124.AugLoop.PromptInputLength",ce.Rk),isAppChatGlowUXEnabled:!0,isNewAttachmentListUiEnabled:!0,isSimplifiedChatInputEnabled:!0,isAddMenuUxRefreshEnabled:!0,isSimplifiedChatInputFlairEnabled:!0,isHideSendButtonEnabled:!0,showWelcomeExperience:!0,disableALAnnotationsOnPreload:E,isApiPluginsCardsEnabled:(0,r.l6e)(),isInterstitialConfirmationEnabled:(0,r.dw_)(),isInterstitialAuthEnabled:(0,r.I3H)(),isDAOutputV2Enabled:(0,r.MNq)(),isDABrandingEnabled:(0,r.CLb)(),isOutputV2Enabled:!0,isFluentV9TaskPaneEnabled:(0,r.dl3)(),isAddScrollingFreezeEnabled:(0,r.LhK)(),isHandoffButtonEnabled:(0,r.oaD)(),isHandoffRTLEnabled:(0,r.gQ_)(),openInWordMinimumForHeuristic:(0,r.rY0)(),isHandoffBookendingEnabled:(0,r.Skv)(),isHandoffGetAnnotationsEnabled:(0,r.KWs)(),isHandoffInteractiveSummaryAndContentCallbackEnabled:(0,r.dOo)(),clearLoadingMessagesOnHandleSubmit:!0,shouldUseHybridAppService:(0,r.Pz_)(),shouldUseMsalSsoSilentLogin:(0,r.Pz_)(),shouldUseMsalLocalSilentFlag:(0,r.Pz_)(),showAgentMenuNudgeAndTooltip:(0,r.B0c)(),showAgentMenuExploreBadge:(0,r.Q11)(),showPluginsAsAgents:(0,r.Pz_)(),shouldRenderAllHyperLinks:(0,r.Pz_)(),enableCustomWidthPropOnAC:(0,r.Pz_)(),disableACHorizontalScroll:(0,r.Pz_)(),isALRequestResponseEnabled:(0,r.NT7)(),useExternalAuthService:(0,r.Pz_)(),areAddinLocalPluginActionsEnabled:(0,r.UxI)(),isTextDirectionEnabled:(0,r.cz7)(),enableSystemMessageActions:(0,r.LNg)(),enableSwitcherMenuV2:(0,r.o25)(),enableSydneyEndpointOverride:!1,enableAgentsBasedOnSkill:(0,r.VDk)(),isSccFeedbackPluginEnabled:!0,invokeTenantFeedbackServiceFromFeedbackSDK:!0,useSharedFeedbackDataUpdate:!0,isCodePreviewEnabled:(0,r.jxV)(),isEnabledLocalCUAAgent:(0,r.PrP)(),renderChatHistoryInHandoffDestination:(0,r.yqt)(),isHandoffLoadingPageEnabled:(0,r.HHv)(),enableAppAgentsInCiqOverride:(0,r.pv3)(),isDABrandingRefactorEnabled:(0,r.Om4)(),showPromptSuggestionsWithOutput:(0,r.Slc)(),isAcquirePluginsFromMosEnabled:(0,r.dA9)(),isCiqEnabledInDAs:(0,r.osS)(),isClickButtonStyleHamburgerEnabled:(0,r.cts)(),isMultipleConfirmationDialogFlowEnabled:(0,r.dw_)(),enableOpenUrlDialogAction:(0,r.Pz_)(),isALHookEnabled:(0,r.UTV)(),enableStopGeneratingButtonInChatInput:(0,r.$bq)(),useResponsiveSystemMessage:(0,r.Wo)(),isResponseDoubleBrandingHidden:(0,r.Wuj)(),applyDynamicHostWidthToAC:(0,r.Pz_)(),enableImBackActions:(0,r.Pz_)(),isAgentsLoggingEnabledInShared:(0,r.Fz9)(),mosAgentInstallTimeout:(0,r.tCt)(),newChatInHeaderControl:!0,isLatencyArrowEnabled:(0,r.Pol)(),enableBizChat:(0,r.vPK)(),enableBizChatInAppChat:(0,r.TS5)(),enableBizChatAgentsInAppChat:(0,r.jjh)(),enableBizChatOtelLogger:(0,r.ddP)(),enableBizChatIdsInOtelLog:(0,r.uEU)(),enableBizChatPerfOtelLog:(0,r.Ak0)(),enableCloseChatPaneButton:st.iJ.isWebPlatform()||st.iJ.isWin32Platform(),m365ChatCdnVersion:(0,r.Jqb)(),m365ChatDeploymentRing:(0,r.b13)(),m365ChatDeploymentEnvironment:(0,r.UjX)(),enableM365EcsProvidedProps:(0,r.lJI)(),useAppVersionECSProject:(0,r.C6)(),isSafeLinksEnabled:(0,r.SBS)(),enableBizChatInAppAuthDialog:(0,r.$Cf)(),enableM365ChatLogger:(0,r.tO4)(),enableCatalystConsumerToPacman:(0,r.eUQ)(),enableM365ChatAuthTreatFallbackAsFatalError:(0,r.PiX)(),enableM365ChatAuthHandleNonInteractiveFatalErrors:(0,r.f7I)(),enableM365ChatFatalErrorCallback:(0,r.QI_)(),enableBizchatNestedAppAuthSupport:(0,r.AJD)(),isEligibilityCheckEnabled:(0,r.i3k)(),isEligibilityCacheEnabled:(0,r.Kuk)(),enableBizChatFeedbackCompliancePolicyFetching:(0,r.$ii)(),enableBizChatDefaultFeedbackAppId:(0,r.DnQ)(),enableOcpsPolicyFetching:(0,r.O74)(),enableBizChatInAppSettings:(0,r.IfU)(),enableLocalFileMessageBanner:!st.iJ.isWebPlatform()&&(0,r._k_)(),enableFileAccessMessageBanner:(0,r.DI8)(),enableIsEuCheck:(0,r.U4g)(),hrdServiceProviderId:(0,r.AmF)(),enableBizChatInAppAuthDialogV2:(0,r.ThR)(),waitForEcsSettingsTimeout:(0,r.l9B)(),enableWaitForEcsSettings:(0,r.sx$)(),enableKeepAliveForALSessionV2:(0,r.e7E)(),keepAliveForALSessionIntervalInSecond:(0,r.zf$)(),enableSPOFileIdForCloudFiles:(0,r.Oc9)(),enableOcpsLogging:(0,r.eh5)(),isEligibilityTelemetryEnabled:(0,r.mXJ)(),forceDfSydney:(0,r.vcx)(),isInsertImageEnabledForDesigner:(0,r.eOl)(),enableBizChatAuthTelemetry:(0,r.cMx)(),enableBizChatInfiniteAuthShimmerFix:(0,r.zn0)(),enableProvideDynamicScreenshot:(0,r.At2)(),enablePuidCompliantCheck:(0,r.IQJ)(),enableWaitForEcsOnExpiredCache:(0,r.cpQ)(),isRingSwitcherEnabled:(0,r.FYS)(),enableBizChatInactiveLog:(0,r.KxH)(),enableM365ChatRehydration:(0,r._Ij)(),enableMsaInCatalyst:(0,r.rFv)(),enableM365ChatAuthWaitForRaf:(0,r.Sdn)(),enableM365ChatUseBackupResourceScopes:(0,r.LaH)(),enableBizChatPairwiseBrokerSupport:(0,r.XPY)(),bizchatPairwiseBrokerHandshakeTimeout:(0,r.n7$)(),bizchatPairwiseBrokerConnectionTimeout:(0,r.OSh)(),enableM365ChatTokenPrefetch:(0,r.fFf)(),enableM365ChatWaitForBroker:(0,r.SAS)(),enableBizchatEcsSettingsTelemetry:(0,r.OWE)(),enableIsDevLog:(0,r.Ton)(),enableOcpsTokenProviderLogFix:(0,r.iYf)(),enableM365ChatHandleAuthBackgroundVisibility:(0,r.dru)(),enableM365ChatHandleBackgroundVisibilityForRequests:(0,r.YAc)(),enableUsePlumbedHostAccountInfo:(0,r.jI5)(),enablePerfMarks:(0,r.qcw)(),eligibilityCacheDurationMs:(0,r.wOI)(),fallbackToastEnabled:(0,r.jEg)(),bizChatFallbackToastDisabled:(0,r.Xfp)(),enableAgentSwitchInCatalyst:(0,r.TGR)(),enableUseM365ChatDevMode:(0,r.etf)(),disableHostCommunicationNovaEventsHandling:(0,r.uPA)(),commandingFlags:{chatLogLevel:(0,r.Wp2)(),openAIApiKey:(0,r.sK$)(),anthropicApiKey:i.getInstance().getAnthropicKey(),awsAnthropicAuth:i.getInstance().getAwsAnthropicKeys(),anthropicClaudeModel:(0,r.cjy)(),localMCPServerURL:(0,r.eHf)(),enableOfficeJSTool:(0,r.NbV)()}},Ze=R.useCallback(((e,t)=>{const a=t?.checked;(0,o.cY)("Toggling Reviewer Agent to "+(a?"on":"off"))}),[Je]),dt=e=>{const t=e.actionType;t===g.At.ActivateCopilotAgent||t===g.At.Activated?((0,o.cY)("handleActivateCopilotAgentFromHost in client ",e.titleId),wt({appId:e.titleId})):t!==g.At.RemoveCopilotAgent&&t!==g.At.Removed||((0,o.cY)("handleRemoveCopilotAgentFromHost in client ",e.titleId),It({appId:e.titleId}))},ut=dn.getInstance(b),mt=(0,R.useMemo)((()=>(ot.p.init(f,ut,dt),ot.p.getInstance())),[]),[ht,gt]=R.useState(!1);mt.setCopilotChatLoadedSetter(gt);const pt=R.useMemo((()=>{const e=Re.getInstance();return ve.current&&e.setProxyOperator(ve.current?.executePluginOperation),e}),[ve.current]),bt=R.useMemo((()=>_e.getInstance()),[]);mt.setSuggestionList(N),mt.setZeroQueryMessageTitles((0,Qs.dW)()),mt.setZqmSuggestionList(M);const ft=(0,r.yw9)("OfficeVSO_8427023_HandleTabKey")?e=>{"Tab"===e.key&&e.stopPropagation()}:void 0,Ct=Ms(),[yt,vt]=R.useState((()=>{const e=[];return e.push(...Es(mt,b)),e})),[xt,Tt]=R.useState(d.erl.CopilotChat),[St,wt]=R.useState(void 0),[Et,It]=R.useState(void 0);R.useEffect((()=>{(0,r.dA9)()&&(0,Pe.GZ)(dt,(0,r.LKL)())}),[]);const Rt=e=>{if((0,o.cY)("handleCopilotChatChange in client",e),e===p.mosCopilotExtensionMenuItemID)return void(0,Pe.iB)((0,r.dA9)(),!1,ce.Xt.SwitcherMenu);const t=yt.map((t=>({...t,isSelected:t.id===e})));vt(t),Tt(e),(0,Ne.P7)((0,Pe.TR)(void 0,e,p.defaultCopilotChatMenuItemId))};R.useEffect((()=>{Rt(xt)}),[xt]);const[Lt,kt]=R.useState((()=>{if(!(0,r.UW0)())return;const e=(0,Me.dL)();return e?.PrimaryUserAccountInfo?{...e,PrimaryUserAccountInfo:{...e.PrimaryUserAccountInfo,CopilotExperience:"AppChat"}}:e}));R.useEffect((()=>{(0,r.UW0)()&&(Lt&&mt.setBizChatHostContext(Lt),mt.setBizChatHostContextSetter(kt))}),[Lt,kt,mt]),R.useEffect((()=>{(0,r.UW0)()&&lt.V.IsSettingTrue(lt.z.ExcelSdxPrivateApiEnabled)&&(void 0===c||c&&(u||!(0,r.K5)()))&&(mt.attachPrivateApiHandlers(),m&&ht&&(h(void 0),mt.unifiedPromptHandler(m)))}),[c,u,m,ht]),R.useEffect((()=>{(0,r.UW0)()&&(qt.B.getInstance().sendChatEventTelemetry([{key:tt.h3.ChatEventType,value:x.a5.BizchatHostContext},{key:tt.h3.ChatEventParameters,value:{doesUpnExist:!!Lt?.PrimaryUserAccountInfo?.Upn,aggregatedLicensedFeatures:Lt?.PrimaryUserAccountInfo?.AggregatedLicensedFeatures,licensedFeatures:Lt?.PrimaryUserAccountInfo?.LicensedFeatures,copilotExperience:Lt?.PrimaryUserAccountInfo?.CopilotExperience}}]),(0,Me.pH)(Lt))}),[Lt]),R.useEffect((()=>{mt.handleHandoffMessageHostAppSettingsIfNeeded()}),[]);const Ft={closeButton:(0,ac.JA)(),headerMenuButtonProps:(0,ac.qP)(),showCreditButton:!0,enableChatHistory:!0,enableSettingsPanel:(0,r.s9k)()},{excelAgentFilterConstants:_t}={excelAgentFilterConstants:R.useMemo((()=>({supportedCapabilities:[{value:"GraphicArt",disabled:!0},{value:"CodeInterpreter",disabled:!(0,r.LSW)()}],supportedAgentType:[{value:"AgentWithBizChatProfile",disabled:!(0,r.hrE)()},{value:"FluxV3",disabled:!(0,r.Wmj)()}]})),[])},Pt={showCopilotSwitcherMenu:!0,copilotList:yt,handleCopilotChatChange:Rt,showNewChatButtonOnTop:!1,enableMorePlugins:!0,paneSilhouetteHeaderProps:Ft,agentFilterConfig:_t,copilotSwitcherRequest:{copilotSwitcherOpenRequest:St,setCopilotSwitcherOpenRequest:wt,copilotSwitcherRemoveRequest:Et,setCopilotSwitcherRemoveRequest:It}};const Nt=R.useRef((0,p.getDefaultClientInfo)()),{onAttachCloudFiles:Mt}=De({clientInfoRef:Nt,theme:e,locale:T,clientId:Be.ky,redirectUri:(0,Rs.x3)(),isWebPlatform:st.iJ.isWebPlatform()}),Ot=R.useMemo((()=>{const{userPrincipalName:e}=Nt.current;return new Ae.j({userPrincipalName:e,redirectUri:(0,Rs.x3)()})}),[Nt.current]),Dt=R.useMemo((()=>({mosTokenProvider:async()=>Ot.getToken(Be.Ss).then((e=>e?.accessToken))})),[Ot]),Bt=R.useCallback((async()=>{const e=(0,r.BCo)(),t=await function(e,t){return He(void 0,void 0,void 0,(function(){var a,n,o;return Ue(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),a=t?Be.dX:Be.L6,[4,e.getToken(a)];case 1:return n=r.sent(),[2,(0,$e.t)(n)];case 2:throw o=r.sent(),(0,re.cY)("Error fetching Safe Links token:",o),o;case 3:return[2]}}))}))}(Ot,e);return t}),[Ot]),$t=(0,r.gnD)()&&$,Ht={text:(0,d.GRh)(),tooltipText:(0,d.dI9)(),handleClick:()=>{Yt.CP.pythonContextManager.setIsPythonThinkDeeperMode(!H)},isDisabled:!!B,isToggleOn:H},Ut={...Ht,isIconOnly:!0},Vt={button:(0,n.jsx)(At,{...Ut}),multilineButton:(0,n.jsx)(At,{...Ht}),buttonType:at.N.InputArea},Qt=[...$t?[Vt]:[]];(0,r.IdM)()&&(N=ve.current?.getLastMessage()?N:[]);const Jt=ec(I,N,dc((0,Hs.pX)()?void 0:D,q,V,G,W,K,ge,he,ie,pe,U),b,q,D,F,Ie,Ze,!1,Nt.current,Mt,fe,M,Qt,pt,bt,K),Xt=Pt,Zt=R.useCallback((async e=>{const t=Ot;return await(0,qe.v)(t,e)}),[Ot]),Kt=R.useCallback((async e=>{var t,a;return await(t=Ot,a=e,Ve(void 0,void 0,void 0,(function(){var e,n;return Ge(this,(function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,t.getToken(null!=a?a:Be.w8.loki)];case 1:return e=o.sent(),[2,(0,$e.t)(e)];case 2:throw n=o.sent(),(0,re.cY)("Error fetching Loki token:",n),n;case 3:return[2]}}))})))}),[Ot]),ea=R.useCallback((async e=>{var t,a;return await(t=Ot,a=e,We(void 0,void 0,void 0,(function(){var e,n,o;return ze(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),e=null!=a?a:Be.w8.ic3,[4,t.getToken(e,void 0,["".concat(e,"/Media.ReadWrite.All")])];case 1:return n=r.sent(),[2,(0,$e.t)(n)];case 2:throw o=r.sent(),(0,re.cY)("Error fetching IC3 token:",o),o;case 3:return[2]}}))})))}),[Ot]),ta=R.useCallback((async e=>{const t=(0,$e.Q)(e??Be.w8.sharepoint),a=Ot;var n,o;return await(n=a,o=t,je(void 0,void 0,void 0,(function(){var e,t;return Qe(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,n.getToken(null!=o?o:Be.w8.sharepoint)];case 1:return e=a.sent(),[2,(0,$e.t)(e)];case 2:throw t=a.sent(),(0,re.cY)("Error fetching SharePoint token:",t),t;case 3:return[2]}}))})))}),[Ot]),aa=R.useCallback((()=>(0,r.Shf)()?{graphTokenProvider:Zt,sharepointTokenProvider:ta}:{}),[Zt,ta]),[na,ra]=(0,R.useState)(aa()),[ia,la]=(0,R.useState)(Xe);R.useEffect((()=>{sa()}),[Kt]);const sa=async()=>{(0,r.A9c)()&&""!==Nt.current.userPrincipalName&&(ra((e=>({...e,lokiTokenProvider:Kt}))),la({...ia,isLocalFileUploadEnabled:!0}))};R.useEffect((()=>{(0,r.LSW)()&&ra((e=>({...e,ic3TokenProvider:ea})))}),[ea]),(0,R.useEffect)((()=>{const e=aa();ra((t=>({...t,...e})))}),[aa]),R.useEffect((()=>{(0,r.SBS)()&&ra((e=>({...e,safeLinksTokenProvider:Bt})))}),[Bt]);const ca=(0,r.$Cf)()&&(0,Me.gt)();(0,R.useEffect)((()=>{ca&&async function(){try{Office.context.auth.getAuthContextAsync((function(e){const t=e.value;if(t){const e=t.userObjectId||Ce.objectId,a=t.tenantId||Ce.tenantId,n=t.authorityType||Ce.authorityType;ye({objectId:e,tenantId:a,authorityType:n})}else(0,o.cY)("Authcontext is undefined"),S.M.getInstance().logError({eventType:Gt.S2.Error,errorMessage:"getAuthContextAsync returned undefined",logLevel:oe.$b.Warning})}))}catch(e){(0,o.cY)(`Error calling getAuthContextAsync: ${e}`),S.M.getInstance().logError({eventType:Gt.S2.Error,errorMessage:"Error calling getAuthContextAsync",logLevel:oe.$b.Warning})}}()}),[]);const da=R.useMemo((()=>{if(ca){if(!(0,r.jI5)()){const e=ca&&Ce.objectId?{objectId:Ce.objectId,tenantId:Ce.tenantId,accountType:Ce.authorityType?.toUpperCase()??""}:void 0;return!e?.accountType&&e?.objectId&&(0,o.cY)("Failed to fetch authorityType from OfficeJS"),e}return a}}),[(0,r.jI5)()?void 0:a]),ma=R.useMemo((()=>(0,r.rFv)()||"AAD"===a.accountType||void 0===Lt?Lt:{...Lt,PrimaryUserAccountInfo:Lt.PrimaryUserAccountInfo?{...Lt.PrimaryUserAccountInfo,CopilotExperience:"AppChat"}:void 0}),[Lt]),ha=function(e){var t=OfficeRuntime.experimentation.getStringFeatureGate("".concat(Ye,".").concat(e,".").concat("SydneyEndpointOverride"));if(void 0!==t)return t}("FA000000124"),ga={copilotCommunicationHandler:mt,style:Ps(),platformType:(0,kl.mw)(),theme:(0,C.eS)(e,t),useALRuntime:!1,ref:ve,chatUiProps:Jt,basicChatProps:y,copilotTelemetryHandler:qt.B.getInstance(),copilotPluginProps:Xt,copilotFeatureFlags:ia,hostAppAuthTokens:na,wasChatPaneAutoOpened:lt.V.IsSettingTrue(lt.z.AutoOpenChatPane),themeV2:(0,se.Id)(C.v1,e,t,(0,js.xt)()?"rtl":"ltr",(0,r._7P)()?d.GHt:void 0),hostTokenProviders:Dt,hostAccountInfo:da,customM365ChatProps:{...(0,r.yjA)()&&{scenarioName:d.M8Q,sourceName:d.tFi},allowSydneyConfigOverrideInUrl:!1,...void 0!==ha&&{serviceEndpointUrl:ha}},getTenantId:Na.EO,bizChatHostContext:ma,handoffProperties:xe,getDocSensitivityLabel:(0,r.DI8)()?nt.n.getInstance().getInDocSensitiveLabelUsingOfcJs:void 0};return Se?(0,n.jsxs)("div",{onKeyDown:ft,children:[(0,n.jsxs)(p.StackV9,{children:[we?(0,n.jsx)("div",{children:"Loading Chat..."}):(0,n.jsx)(p.LocalizedCopilotChatCore,{...ga,locale:T}),(0,r.w9F)()?(0,n.jsx)("div",{className:Ct.root,children:(0,n.jsx)(Kn.T,{resize:"both",onChange:(e,t)=>{Yt.CP.setPythonAdaStaticPromptOverride(t.value)}})}):null]}),(0,n.jsx)(ws,{communicationHandler:mt,setCannedOption:e=>mt.cannedOption=e})]}):(0,n.jsxs)("div",{onKeyDown:ft,children:[(0,n.jsxs)(p.StackV9,{children:[(0,n.jsx)(p.LocalizedCopilotChatCore,{...ga,locale:T}),(0,r.w9F)()?(0,n.jsx)("div",{className:Ct.root,children:(0,n.jsx)(Kn.T,{resize:"both",onChange:(e,t)=>{Yt.CP.setPythonAdaStaticPromptOverride(t.value)}})}):null]}),(0,n.jsx)(ws,{communicationHandler:mt,setCannedOption:e=>mt.cannedOption=e})]})};var mc=a(780642),hc=a(906248),gc=function(e){},pc=(0,mc.mL)(hc.N,{currentLocale:void 0,strings:{},errorHandler:gc,loaders:[],stringMapInitialized:!1});var bc=a(590345),fc=a(678211),Cc=a(979396),yc=a(730938),vc=a(262452),xc=a(911443),Tc=a(233488);let Sc;async function wc(e,t,a,n,i,l){try{if((0,r.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit")&&await Excel.run({delayForCellEdit:!1},(async e=>{e.workbook.load("name"),await e.sync()})),(0,r.yw9)("OfficeVSO_8455363_MoveInitializationCodeToInitializeTasks")){if((0,Cc.v)(),Office.context.platform===Office.PlatformType.PC?(n(Office.context.officeTheme.bodyBackgroundColor,!0),t().catch((e=>{(0,Na.cY)("Register Theme Callback() error: "+e),S.M.getInstance().logError({eventType:Gt.S2.Error,errorMessage:e,logLevel:oe.$b.Error})}))):(0,kl.OK)()&&Office.context?.themeManager?.getOfficeThemeAsync((e=>{if("succeeded"===e.status){const a=e.value;n(a.bodyBackgroundColor,!0),t()}})),(0,r.yw9)("OfficeVSO_8565845_GateForConsumer")){const e=await OfficeFirstPartyAuth.getPrimaryIdentityInfo(),t=e.identityType===OfficeCore.IdentityType.organizationAccount?g.ut.Enterprise:e.identityType===OfficeCore.IdentityType.microsoftAccount?g.ut.Consumer:g.ut.Unknown;l(zt.m.setUserType(t)),(0,r.Awf)(t)}window.matchMedia("(forced-colors: active)").matches&&a(!0)}if((0,re.YP)(d.fn_,Na.cY,qt.B.getInstance(),{IsClpEnabledInEnterpriseForSydney:()=>(0,r._bw)(),IsApplyLabelUsingTryUpgradeLabelEnabled:()=>(0,r._bw)(),IsUserTypeEnterprise:()=>(0,r.Dl1)(),getOfficeJSDocumentURL:()=>(0,st.H5)(),shouldCLPExceptionDisableEnterpriseSearch:()=>(0,r.vIj)(),setEnableEnterpriseSearchOverride:Hs.LA}),!Tc.copilotStringsLoaded){const e=(new Date).getTime();await(0,js.XX)(),Sc=((new Date).getTime()-e)/1e3,T.E.getInstance().logLatency(Sc,x.OP.LoadLocalizedStrings)}(0,se.Bp)((0,r.kh6)().toString()),lt.V.IsSettingTrue(lt.z.ExcelSdxPrivateApiEnabled)&&vc.s.getInstance().initializePrivateApi(),lt.V.IsSettingTrue(lt.z.ButtonEnabledForLocalFiles)&&async function(e){if((0,r.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit"))try{await w(!1,e)}catch(t){(0,o.cY)("initializePrivateHostMessaging failed due to invalid operation in cell edit mode. Retrying with delay."),S.M.getInstance().logStandardizedAshaErrorEvent(v.W.Copilot_Chat_Pane_Failed_To_Load,y.c.Pane_Taking_Too_Long_To_Load_Due_To_CellEditMode_PrivateHost,x.BJ.CopilotChat),await w(!0,e)}else await w(!1,e)}(((e,t)=>{t&&(0,Ma.V1)(t),i(e)}))}catch(e){(0,r.H_5)()||e instanceof xc.DY&&(0,Na.cY)(e.message),(0,r.yw9)("OfficeVSO_9410553_copilotInfiniteLoadOnCellEdit")&&e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode&&S.M.getInstance().logStandardizedAshaErrorEvent(v.W.Copilot_Chat_Pane_Failed_To_Load,y.c.Pane_Taking_Too_Long_To_Load_Due_To_CellEditMode_InitializeTasks,x.BJ.CopilotChat)}e(!0)}const Ec={},Ic=(0,R.createContext)(Ec),Rc=e=>{const[t,a]=R.useState(g.Gm.defaultWhite),[o,d]=R.useState(C.QJ.disabled),[u,m]=R.useState(!1),[h,b]=R.useState(void 0),[f,y]=R.useState(void 0),v=(0,Ke.j)(),x=(0,C.eS)(t,o!==C.QJ.disabled),T=e=>{const t=window.matchMedia("(prefers-color-scheme: light)").matches;(0,p.setIsHighContrastEnabled)(e),e?d(t?C.QJ.light:C.QJ.dark):(d(C.QJ.disabled),I(Office.context.officeTheme.bodyBackgroundColor,!1))};R.useEffect((()=>{const e=e=>{T(e.matches)};return window.matchMedia("(forced-colors: active)").addEventListener("change",e),()=>{window.matchMedia("(forced-colors: active)").removeEventListener("change",e)}}),[]),R.useEffect((()=>{Re.setTheme(x),_e.setTheme(x)}),[t]);const w=e=>{I(e.officeTheme.bodyBackgroundColor,!0)},E=async()=>{Office.context?.themeManager&&await Office.context.themeManager.addHandlerAsync(Office.EventType.OfficeThemeChanged,w)},I=(e,t)=>{const n=(0,C.mR)(e,t),o=(0,C.j2)(n);v(Wt.m.setIsDarkModeEnabled(o)),a(n)};R.useEffect((()=>{const e=e=>{window.matchMedia("(forced-colors: active)").matches&&d(e.matches?C.QJ.light:C.QJ.dark)};return window.matchMedia("(prefers-color-scheme: light)").addEventListener("change",e),()=>{window.matchMedia("(prefers-color-scheme: light)").removeEventListener("change",e)}}),[]),R.useEffect((()=>{(0,r.v5R)()&&y(lt.V.getSettingAsString(lt.z.CopilotLicenseStatus)),(0,r.yw9)("OfficeVSO_8455363_MoveInitializationCodeToInitializeTasks")||((0,Cc.v)(),Office.context.platform===Office.PlatformType.PC?(I(Office.context.officeTheme.bodyBackgroundColor,!0),E().catch((e=>{(0,Na.cY)("Register Theme Callback() error: "+e),S.M.getInstance().logError({eventType:Gt.S2.Error,errorMessage:e,logLevel:oe.$b.Error})}))):(0,kl.OK)()&&Office.context?.themeManager?.getOfficeThemeAsync((e=>{if("succeeded"===e.status){const t=e.value;I(t.bodyBackgroundColor,!0),E()}})),window.matchMedia("(forced-colors: active)").matches&&T(!0)),(async()=>{try{(0,r.CyP)().length>0&&await i.getInstance().init()}catch(e){(0,Na.cY)(`Unable to initialize Anthropic keys: ${e}`)}})();const e=e=>{v(zt.m.setCopilotState(e)),b((t=>t===c.$.Enabled?((0,Na.cY)("Leaving copilotState as Enabled instead of changing to "+e),t):(e!==c.$.Enabled?(0,Na.sZ)():void 0!==t&&(s.$.getInstance().startReinitializeALSession(),s.$.getInstance().activateAugloopAnnotations()),(0,Na.cY)("Updating copilotState to "+e),e)))};s.$.getInstance().startLoadingPaneTimeout(!1),(async()=>{await wc(m,E,T,I,e,v)})(),window.addEventListener("beforeunload",(()=>{Re.getInstance().closeActiveDialog(),_e.getInstance().closeActiveDialog()}))}),[]),R.useEffect((()=>{switch(o){case C.QJ.light:(0,p.setClientThemeType)(g.Gm.defaultWhite),a(g.Gm.defaultWhite);break;case C.QJ.dark:(0,p.setClientThemeType)(g.Gm.defaultBlack),a(g.Gm.defaultBlack)}}),[o]);const A=function(e,t){void 0===t&&(t=gc);var a=(0,R.useState)(pc),n=a[0],o=a[1];return(0,R.useEffect)((function(){(0,mc.Au)((0,mc.U5)(e,"en-us"),n).then(o)}),[e]),(0,R.useEffect)((function(){o((0,mc._c)(t,n))}),[t]),(0,mc.zB)(n)}((0,js.gl)(),void 0),L=(0,p.useStringLoader)((0,js.gl)(),void 0);if(R.useEffect((()=>{!function(e){var t=OfficeRuntime.experimentation.getIntFeatureGate("".concat(Ye,".").concat(e,".").concat("BizchatLocalServer"));if(void 0===t){var a=OfficeRuntime.experimentation.getStringFeatureGate("".concat(Ye,".").concat(e,".").concat("BizchatBranch"));void 0===a||Ze(Je(Je({},Xe),{M365ChatBranch:a}))}else Ze(Je(Je({},Xe),{M365ChatLocal:t.toString()}))}("FA000000124")}),[]),u){if((0,r.v5R)()&&f===l.MultiAccessDisabledByAdmin){(0,Na.sZ)();const e=t!==g.Gm.defaultWhite?"./assets/error-boundary-dark.webp":"./assets/error-boundary-light.webp",a=(0,n.jsx)(p.ThemeProvider,{theme:x,children:(0,n.jsx)(p.LicenseErrorScreen,{licenseErrorImagePath:e,handleRefreshButtonOnClick:()=>{Office?.ExtensionLifeCycle?.taskpane?.close().catch((e=>{(0,Na.cY)(`Error closing taskpane: ${e}`)}))}})}),o=(0,n.jsx)(p.Localization,{lookupString:L,children:a});return(0,n.jsx)(fc.q,{dir:(0,js.xt)()?"rtl":"ltr",children:o})}if(lt.V.IsSettingTrue(lt.z.ButtonEnabledForLocalFiles)&&void 0===h)return void 0===h?(0,n.jsx)("div",{}):(0,r.vCb)()?(0,n.jsx)(fc.q,{dir:(0,js.xt)()?"rtl":"ltr",children:(0,n.jsx)(k,{copilotState:h,theme:t,isHighContrast:o!==C.QJ.disabled})}):(0,n.jsx)(k,{copilotState:h,theme:t,isHighContrast:o!==C.QJ.disabled});{const a=(0,n.jsx)(bc.G,{lookupString:A,children:(0,n.jsx)(uc,{theme:t,isHighContrast:o!==C.QJ.disabled,accountInfo:e.accountInfo,initTelemetryHandler:e.initTelemetryHandler})});return(0,n.jsx)(Ic.Provider,{value:{sdxTheme:t,highContrastClientMode:o},children:(0,n.jsx)("div",{className:"ms-welcome",children:(0,r.vCb)()?(0,n.jsx)(fc.q,{dir:(0,js.xt)()?"rtl":"ltr",children:a}):a})})}}return(0,n.jsx)(vn.B,{styles:Ns,children:(0,n.jsx)(yc.y,{})})}},252610:(e,t,a)=>{"use strict";a.d(t,{i:()=>me});var n=a(9847),o=a(476730),r=a(956258);const i=0,l=1,s=2,c=3,d=4,u=5,m=6,h=7,g=8,p=9,b=10,f=11,C=12,y=13,v=14,x=15,T=16,S=17,w=18,E=19,I=20,R=21,A=22,L=23,k=24,F=25,_=26,P=27,N=28,M=29,O=30,D=31,B=32,$=33,H=34,U=35,q=36,V=37,G=38,W=39,z=40,j=41,Q=42,J=43,Y=44,X=45,Z=46,K=47,ee=48,te=49,ae=50,ne=51,oe=52,re=53,ie=54,le=55,se=56,ce=57,de=58,ue=59;class me{static get CHANGE_CATEGORIES(){return this._changeCategories||(this._changeCategories=[{name:ExcelCopilotCommandingHitlStrings.ChangeLeveragingText,match:["AllowEditRange.Title","DataPivotHierarchy.Name","FilterPivotHierarchy.Name","PivotField.Name","PivotHierarchy.Name","PivotItem.Name","PivotTable.Name","PivotTableStyle.Name","Range.ReplaceAll","RowColumnPivotHierarchy.Name","Shape.Name","ShapeFont.Name","SlicerStyle.Name","TableStyle.Name","TextRange.Text","TimelineStyle.Name"],isTextValueChange:!0,type:se},{name:ExcelCopilotCommandingHitlStrings.CellValueEdits,match:["Range.Values","Range.Hyperlink","RangeView.Values"],isTextValueChange:!0,type:i},{name:ExcelCopilotCommandingHitlStrings.CellFormulaEdits,match:["Range.Formulas","Range.FormulasLocal","Range.FormulasR1C1","RangeView.Formulas","RangeView.FormulasLocal","RangeView.FormulasR1C1"],isTextValueChange:!0,type:l},{name:ExcelCopilotCommandingHitlStrings.ChangeNumberFormatting,match:["Range.NumberFormat","Range.NumberFormatLocal","RangeView.NumberFormat","Style.NumberFormat","Style.NumberFormatLocal"],isTextValueChange:!0,type:c},{name:ExcelCopilotCommandingHitlStrings.Autofit,match:["RangeFormat.AutofitColumns","RangeFormat.AutofitRows"],isTextValueChange:!1,type:ce},{name:ExcelCopilotCommandingHitlStrings.ResizeRows,match:["RangeFormat.RowHeight"],isTextValueChange:!1,type:w},{name:ExcelCopilotCommandingHitlStrings.ResizeColumns,match:["RangeFormat.ColumnWidth"],isTextValueChange:!1,type:E},{name:ExcelCopilotCommandingHitlStrings.SetCellFormatting,match:["FormatProtection","Range.Style","RangeAreas.Style","RangeBorder","RangeBorderCollection","RangeFill","RangeFont","RangeFormat","Style.","StyleCollection.Add","Worksheet.StandardWidth"],isTextValueChange:!1,type:s},{name:ExcelCopilotCommandingHitlStrings.ModifyComments,match:["CommentCollection.Add","CommentReplyCollection.Add"],isTextValueChange:!0,type:u},{name:ExcelCopilotCommandingHitlStrings.ModifyComments,match:["Comment.Delete","CommentReply.Delete"],isTextValueChange:!1,type:m},{name:ExcelCopilotCommandingHitlStrings.ModifyComments,match:["Comment.Content","CommentReply.Content"],isTextValueChange:!0,type:d},{name:ExcelCopilotCommandingHitlStrings.SetConditionalFormatting,match:["ConditionalFormatCollection.Add"],isTextValueChange:!1,type:g},{name:ExcelCopilotCommandingHitlStrings.SetConditionalFormatting,match:["ConditionalFormat.Priority","ConditionalFormat.StopIfTrue","ConditionalFormat.SetRanges","ConditionalFormat.ChangeRuleToCellValue","ConditionalFormat.ChangeRuleToColorScale","ConditionalFormat.ChangeRuleToContainsText","ConditionalFormat.ChangeRuleToCustom","ConditionalFormat.ChangeRuleToDataBar","ConditionalFormat.ChangeRuleToIconSet","ConditionalFormat.ChangeRuleToPresetCriteria","ConditionalFormat.ChangeRuleToTopBottom","CellValueConditionalFormat","ConditionalRangeFill","ConditionalFormatRule","PresetCriteriaConditionalFormat","ColorScaleConditionalFormat","CustomConditionalFormat","DataBarConditionalFormat","ConditionalDataBarPositiveFormat","ConditionalDataBarNegativeFormat","IconSetConditionalFormat","TextConditionalFormat","TopBottomConditionalFormat","ConditionalRangeBorder","ConditionalRangeFill","ConditionalRangeFont"],isTextValueChange:!0,type:h},{name:ExcelCopilotCommandingHitlStrings.DeleteConditionalFormatting,match:["ConditionalFormat.Delete","ConditionalFormatCollection.ClearAll"],isTextValueChange:!1,type:p},{name:ExcelCopilotCommandingHitlStrings.MergeCells,match:["Range.Merge"],isTextValueChange:!1,type:b},{name:ExcelCopilotCommandingHitlStrings.UnmergeCells,match:["Range.Unmerge"],isTextValueChange:!1,type:f},{name:ExcelCopilotCommandingHitlStrings.ClearContent,match:["Range.Clear","RangeAreas.Clear"],isTextValueChange:!1,type:C},{name:ExcelCopilotCommandingHitlStrings.RangeMoveCopy,match:["Range.MoveTo","Range.CopyFrom","Range.CopyTo","RangeAreas.CopyFrom"],isTextValueChange:!1,type:y},{name:ExcelCopilotCommandingHitlStrings.InsertRows,match:["Range.Insert"],isTextValueChange:!1,type:v,fnMatch:e=>!e.Arguments?.length||Boolean(e.Arguments[0]===Excel.InsertShiftDirection.down)},{name:ExcelCopilotCommandingHitlStrings.InsertColumns,match:["Range.Insert"],isTextValueChange:!1,type:x,fnMatch:e=>Boolean(e.Arguments?.length&&e.Arguments[0]===Excel.InsertShiftDirection.right)},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.AddRow","Table.AddRows","TableRowCollection.Add"],isTextValueChange:!1,type:O},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.AddColumn","TableColumnCollection.Add"],isTextValueChange:!1,type:D},{name:ExcelCopilotCommandingHitlStrings.DeleteRows,match:["Range.Delete"],isTextValueChange:!1,type:T,fnMatch:e=>!e.Arguments?.length||Boolean(e.Arguments[0]===Excel.DeleteShiftDirection.up)},{name:ExcelCopilotCommandingHitlStrings.DeleteColumns,match:["Range.Delete"],isTextValueChange:!1,type:S,fnMatch:e=>Boolean(e.Arguments?.length&&e.Arguments[0]===Excel.DeleteShiftDirection.left)},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.DeleteRowsAt","TableRowCollection.DeleteRows","TableRowCollection.DeleteRowsAt","TableRow.Delete"],isTextValueChange:!1,type:B},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["TableColumn.Delete"],isTextValueChange:!1,type:$},{name:ExcelCopilotCommandingHitlStrings.HideRows,match:["Range.RowHidden"],isTextValueChange:!1,type:I,fnMatch:e=>Boolean(e.Arguments?.length&&!0===e.Arguments[0])},{name:ExcelCopilotCommandingHitlStrings.UnhideRows,match:["Range.RowHidden"],isTextValueChange:!1,type:R,fnMatch:e=>Boolean(e.Arguments?.length&&!1===e.Arguments[0])},{name:ExcelCopilotCommandingHitlStrings.HideColumns,match:["Range.ColumnHidden"],isTextValueChange:!1,type:A,fnMatch:e=>Boolean(e.Arguments?.length&&!0===e.Arguments[0])},{name:ExcelCopilotCommandingHitlStrings.UnhideColumns,match:["Range.ColumnHidden"],isTextValueChange:!1,type:L,fnMatch:e=>Boolean(e.Arguments?.length&&!1===e.Arguments[0])},{name:ExcelCopilotCommandingHitlStrings.CreateTableCategory,match:["TableCollection.Add"],isTextValueChange:!1,type:N},{name:ExcelCopilotCommandingHitlStrings.DeleteTableCategory,match:["Table.Delete"],isTextValueChange:!1,type:M},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.Resize"],isTextValueChange:!1,type:H},{name:ExcelCopilotCommandingHitlStrings.NameTableCategory,match:["Table.Name"],isTextValueChange:!0,type:q},{name:ExcelCopilotCommandingHitlStrings.ModifyTableCategory,match:["Table.Style","TableStyleCollection.Add","TableStyleCollection.SetDefault","TableStyle"],isTextValueChange:!1,type:U},{name:ExcelCopilotCommandingHitlStrings.SortFilterTable,match:["RangeSort.Apply"],isTextValueChange:!1,type:V},{name:ExcelCopilotCommandingHitlStrings.SortFilterTable,match:["TableSort.Apply","TableSort.Reapply"],isTextValueChange:!1,type:G},{name:ExcelCopilotCommandingHitlStrings.SortFilterTable,match:["Filter","AutoFilter"],isTextValueChange:!1,type:W},{name:ExcelCopilotCommandingHitlStrings.EditAltTextCategory,match:["Shape.AltTextTitle","Shape.AltTextDescription"],isTextValueChange:!0,type:_},{name:ExcelCopilotCommandingHitlStrings.ModifyShapePositioning,match:["Shape.Height","Shape.Width","Shape.Top","Shape.Left","Shape.LockAspectRatio","Shape.Placement","Shape.Rotation","Shape.Visible","Shape.IncrementLeft","Shape.IncrementRotation","Shape.IncrementTop","Shape.ScaleHeight","Shape.ScaleWidth","Shape.SetZOrder","ShapeGroup.Ungroup","ShapeCollection.AddGroup","TextFrame.AutoSizeSetting","TextFrame.BottomMargin","TextFrame.LeftMargin","TextFrame.Orientation","TextFrame.RightMargin","TextFrame.TopMargin"],isTextValueChange:!0,type:P},{name:ExcelCopilotCommandingHitlStrings.CreateChartCategory,match:["ChartCollection.Add"],isTextValueChange:!1,type:z},{name:ExcelCopilotCommandingHitlStrings.DeleteChartCategory,match:["Chart.Delete"],isTextValueChange:!1,type:j},{name:ExcelCopilotCommandingHitlStrings.MoveChartCategory,match:["Chart.SetPosition","Chart.Top","Chart.Left","Chart.Height","Chart.Width"],isTextValueChange:!1,type:Q},{name:ExcelCopilotCommandingHitlStrings.ChangeChartTypeCategory,match:["Chart.ChartType","ChartSeries.ChartType"],isTextValueChange:!1,type:J},{name:ExcelCopilotCommandingHitlStrings.ChangeChartDataSourceCategory,match:["Chart.SetData","ChartAxis.SetCategoryNames","ChartSeriesCollection.Add","ChartSeries.Delete","ChartSeries.SetValues","ChartSeries.SetXAxisValues","ChartSeries.SetBubbleSizes"],isTextValueChange:!1,type:Y},{name:ExcelCopilotCommandingHitlStrings.ChangeChartText,match:["Chart.Name","ChartTitle.Text","ChartAxisTitle.Text","ChartDataLabel.Text","ChartSeries.Name","ChartTrendline.Name","ChartTrendlineLabel.Text","ChartAxisTitle.SetFormula","ChartDataLabel.Formula","ChartTitle.SetFormula","ChartTrendlineLabel.Formula","ChartAxis.NumberFormat","ChartDataLabel.NumberFormat","ChartDataLabel.Separator","ChartDataLabels.NumberFormat","ChartDataLabels.Separator","ChartFont.Name","ChartTrendlineLabel.NumberFormat"],isTextValueChange:!0,type:Z},{name:ExcelCopilotCommandingHitlStrings.ChangeChartFormatting,match:["Chart.","ChartAreaFormat","ChartAxes","ChartAxis","ChartAxis.Visible","ChartAxisFormat","ChartAxisTitle","ChartAxisTitle.Visible","ChartAxisTitleFormat","ChartBinOptions","ChartBorder","ChartBoxwhiskerOptions","ChartDataLabels","ChartDataLabel","ChartDataLabelFormat","ChartDataTable","ChartDataTable.Visible","ChartDataTableFormat","ChartErrorBars","ChartErrorBars.Visible","ChartErrorBarsFormat","ChartFill","ChartFont","ChartFormatString","ChartGridlines","ChartGridlines.Visible","ChartGridlinesFormat","ChartLegend","ChartLegend.Visible","ChartLegendEntry","ChartLegendEntry.Visible","ChartLegendFormat","ChartLineFormat","ChartMapOptions","ChartPivotOptions","ChartPlotArea","ChartPlotAreaFormat","ChartPoint","ChartPointFormat","ChartSeries","ChartSeriesFormat","ChartTitle","ChartTitle.Visible","ChartTitleFormat","ChartTrendlineCollection.Add","ChartTrendline","ChartTrendline.Delete","ChartTrendlineFormat","ChartTrendlineLabel","ChartTrendlineLabelFormat"],isTextValueChange:!1,type:X},{name:ExcelCopilotCommandingHitlStrings.CreateSheet,match:["WorksheetCollection.Add"],isTextValueChange:!1,type:K},{name:ExcelCopilotCommandingHitlStrings.DeleteSheet,match:["Worksheet.Delete"],isTextValueChange:!1,type:ee},{name:ExcelCopilotCommandingHitlStrings.RenameSheet,match:["Worksheet.Name"],isTextValueChange:!0,type:te},{name:ExcelCopilotCommandingHitlStrings.MoveSheetCategory,match:["Worksheet.Position"],isTextValueChange:!1,type:ae},{name:ExcelCopilotCommandingHitlStrings.SheetProtectionCategory,match:["WorksheetProtection.Protect","WorksheetProtection.Unprotect"],isTextValueChange:!1,type:ne},{name:ExcelCopilotCommandingHitlStrings.ChangeNamedItems,match:["NamedItemCollection.Add","NamedItemCollection.AddFormulaLocal"],isTextValueChange:!0,type:F},{name:ExcelCopilotCommandingHitlStrings.ChangeNamedItems,match:["NamedItem"],isTextValueChange:!0,type:k},{name:ExcelCopilotCommandingHitlStrings.CreatePivotTableCategory,match:["PivotTableCollection.Add"],isTextValueChange:!1,type:oe},{name:ExcelCopilotCommandingHitlStrings.DeletePivotTableCategory,match:["PivotTable.Delete"],isTextValueChange:!1,type:re},{name:ExcelCopilotCommandingHitlStrings.ModifyPivotTableFormatting,match:["DataPivotHierarchy.NumberFormat","DataPivotHierarchy.ShowAs","PivotLayout.AutoFormat","PivotLayout.PreserveFormatting","PivotTableStyle","PivotTableStyleCollection.Add","PivotTableStyleCollection.SetDefault"],isTextValueChange:!1,type:le},{name:ExcelCopilotCommandingHitlStrings.ModifyPivotTable,match:["DataPivotHierarchy.Position","DataPivotHierarchy.SetToDefault","DataPivotHierarchy.SummarizeBy","DataPivotHierarchyCollection.Add","DataPivotHierarchyCollection.Remove","FilterPivotHierarchy.EnableMultipleFilterItems","FilterPivotHierarchy.Position","FilterPivotHierarchy.SetToDefault","FilterPivotHierarchyCollection.Add","FilterPivotHierarchyCollection.Remove","PivotField.ApplyFilter","PivotField.ClearAllFilters","PivotField.ClearFilter","PivotField.ShowAllItems","PivotField.SortByLabels","PivotField.SortByValues","PivotField.Subtotals","PivotItem.IsExpanded","PivotItem.Visible","PivotLayout.","PivotTable.AllowMultipleFiltersPerField","PivotTable.EnableDataValueEditing","PivotTable.Refresh","PivotTableCollection.RefreshAll","RowColumnPivotHierarchy.Position","RowColumnPivotHierarchy.SetToDefault","RowColumnPivotHierarchyCollection.Add","RowColumnPivotHierarchyCollection.Remove"],isTextValueChange:!1,type:ie},{name:ExcelCopilotCommandingHitlStrings.GenericChange,match:["Range.AutoFill","Range.Group","Range.HideGroupDetails","Range.RemoveDuplicates","Range.ShowGroupDetails","Range.Ungroup"],isTextValueChange:!1,type:ue}]),this._changeCategories}static generateDocumentChanges(e){const t=[];e.forEach((e=>{t.push(e.Scope);const a=e.Arguments,n=this.getCategory(e).type;n===te&&e.Scope.Worksheet&&a&&a.length>0&&t.push({Worksheet:{Name:this.extractArgumentValues(a)}}),n===q&&e.Scope.Table&&a&&a.length>0&&t.push({Table:{Name:this.extractArgumentValues(a)},...e.Scope.Worksheet&&{Worksheet:{Name:e.Scope.Worksheet.Name}}})}));const a=new Map,n={};t.forEach((e=>{const t=e.Worksheet?.Name,o=t?a.get(t)||a.set(t,{Name:t}).get(t):n;Object.entries(e).forEach((([e,t])=>{if("Worksheet"===e||!t||"object"!=typeof t)return;const a=["Name","Address"].map((e=>t[e])).filter((e=>"string"==typeof e));a.length&&(o[e]=o[e]||[],a.forEach((t=>{o[e].includes(t)||o[e].push(t)})))}))}));return{Worksheets:Array.from(a.values()),...n}}static generateDescription(e){e=e.filter((e=>!this.READONLY_API_NAMES.includes(e.Name)&&!e.Name.includes(".Get")));const t=[],a=[],n=new Map,o=new Map;for(const t of e){const e=this.getCategory(t),a=this.getScopeString(t,e.type);n.set(e.name,e),o.has(a)||o.set(a,[]),o.get(a).push({call:t,category:e})}const r=new Set;for(const[e,n]of o.entries())for(const{call:o,category:i}of n){const n=this.getChangeDescription(o,i.type),l=`${e}:${n}`;if(!r.has(l)){const o={scope:e,change:n};i.isTextValueChange?t.push(o):a.push(o),r.add(l)}}let i=Array.from(o.keys());return i.length>3&&(i=this.generalizeScopes(e)),{header:this.generateHeader(Array.from(n.values()),i),descriptions:[...t,...a]}}static conjoinStrings(e){if(0===e.length)return"";if(1===e.length)return e[0];const t=ExcelCopilotCommandingHitlStrings.MultipleItemsTemplate;let a=e[0];for(let n=1;n<e.length;n++)a=t.replace("{0}",a).replace("{1}",e[n]);return a}static getScopeString(e,t){const a=Object.keys(e.Scope),n="string"==typeof e.Scope.Table?.Name;for(const o of a)switch(o){case"Table":if("string"==typeof e.Scope.Table?.Name&&t!==N)return e.Scope.Table.Name;break;case"Chart":if("string"==typeof e.Scope.Chart?.Name&&t!==z)return e.Scope.Chart.Name;break;case"PivotTable":if("string"==typeof e.Scope.PivotTable?.Name&&t!==oe)return e.Scope.PivotTable.Name;break;case"Shape":if("string"==typeof e.Scope.Shape?.Name)return e.Scope.Shape.Name;break;case"Range":if("string"==typeof e.Scope.Range?.Address&&!n)return e.Scope.Range.Address;break;case"Worksheet":if("string"==typeof e.Scope.Worksheet?.Name&&t!==K)return e.Scope.Worksheet.Name}return ExcelCopilotCommandingHitlStrings.WorkbookScope}static generalizeScopes(e){const t=new Set,a=new Set;for(const n of e)"string"==typeof n.Scope.Table?.Name?a.add(n.Scope.Table.Name):"string"==typeof n.Scope.Worksheet?.Name&&t.add(n.Scope.Worksheet.Name);if(t.size+a.size<=3)return[...t,...a];for(const a of e)a.Scope.Table?.Name&&"string"==typeof a.Scope.Worksheet?.Name&&t.add(a.Scope.Worksheet.Name);return t.size<=3?[...t]:[ExcelCopilotCommandingHitlStrings.WorkbookScope]}static getCategory(e){for(const t of this.CHANGE_CATEGORIES)if(t.match.some((t=>e.Name.startsWith(t)))&&(!t.fnMatch||t.fnMatch(e)))return t;return{name:ExcelCopilotCommandingHitlStrings.GenericChange,match:[],isTextValueChange:!1,type:de}}static getChangeDescription(e,t){const a=e.Arguments;switch(t){case i:return a&&a.length>0?ExcelCopilotCommandingHitlStrings.UpdateToTemplate.replace("{0}",this.extractArgumentValues(a)):ExcelCopilotCommandingHitlStrings.UpdateValues;case l:return a&&a.length>0?ExcelCopilotCommandingHitlStrings.UpdateFormulaTemplate.replace("{0}",this.extractArgumentValues(a)):ExcelCopilotCommandingHitlStrings.UpdateValues;case s:return e.Name.includes("RangeFont.Name")?this.getFallbackDescription(a,e.Name,ExcelCopilotCommandingHitlStrings.SetCellFormatting):ExcelCopilotCommandingHitlStrings.SetCellFormatting;case c:return ExcelCopilotCommandingHitlStrings.ChangeNumberFormatting;case u:if(a&&a.length>0){const e=this.extractArgumentValues(a);return ExcelCopilotCommandingHitlStrings.AddCommentTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.AddComment;case d:if(a&&a.length>0){const e=this.extractArgumentValues(a);return ExcelCopilotCommandingHitlStrings.ChangeCommentTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.ChangeComment;case m:return ExcelCopilotCommandingHitlStrings.DeleteComment;case g:if(a&&a.length>0){const e=a[0];if(e===Excel.ConditionalFormatType.colorScale)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatColorScale;if(e===Excel.ConditionalFormatType.dataBar)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatDataBar;if(e===Excel.ConditionalFormatType.cellValue)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCellValue;if(e===Excel.ConditionalFormatType.presetCriteria)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatPreset;if(e===Excel.ConditionalFormatType.containsText)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatContainsText;if(e===Excel.ConditionalFormatType.topBottom)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatTopBottom;if(e===Excel.ConditionalFormatType.custom)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCustom;if(e===Excel.ConditionalFormatType.iconSet)return ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatIconSet}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;case h:return this.getConditionalFormattingDescription(e,a);case p:return ExcelCopilotCommandingHitlStrings.DeleteConditionalFormatting;case b:return ExcelCopilotCommandingHitlStrings.MergeCells;case f:return ExcelCopilotCommandingHitlStrings.UnmergeCells;case C:return ExcelCopilotCommandingHitlStrings.ClearContent;case y:return e.Name.includes("Copy")?ExcelCopilotCommandingHitlStrings.Copy:ExcelCopilotCommandingHitlStrings.Move;case v:return ExcelCopilotCommandingHitlStrings.InsertRows;case x:return ExcelCopilotCommandingHitlStrings.InsertColumns;case T:return ExcelCopilotCommandingHitlStrings.DeleteRows;case S:return ExcelCopilotCommandingHitlStrings.DeleteColumns;case w:return ExcelCopilotCommandingHitlStrings.ResizeRows;case E:return ExcelCopilotCommandingHitlStrings.ResizeColumns;case I:return ExcelCopilotCommandingHitlStrings.HideRows;case R:return ExcelCopilotCommandingHitlStrings.UnhideRows;case A:return ExcelCopilotCommandingHitlStrings.HideColumns;case L:return ExcelCopilotCommandingHitlStrings.UnhideColumns;case N:return ExcelCopilotCommandingHitlStrings.CreateTable;case M:return ExcelCopilotCommandingHitlStrings.DeleteTable;case O:return ExcelCopilotCommandingHitlStrings.InsertTableRows;case D:return ExcelCopilotCommandingHitlStrings.InsertTableColumns;case B:return ExcelCopilotCommandingHitlStrings.DeleteTableRows;case $:return ExcelCopilotCommandingHitlStrings.DeleteTableColumns;case H:return ExcelCopilotCommandingHitlStrings.ModifyTable;case U:return ExcelCopilotCommandingHitlStrings.ModifyTableStyle;case ce:return ExcelCopilotCommandingHitlStrings.Autofit;case q:return ExcelCopilotCommandingHitlStrings.NameTableTemplate.replace("{0}",a&&a.length>0?this.extractArgumentValues(a):"");case V:return ExcelCopilotCommandingHitlStrings.SortRange;case G:return ExcelCopilotCommandingHitlStrings.SortTable;case W:return a&&a.length>0?ExcelCopilotCommandingHitlStrings.FilterTableTemplate.replace("{0}",this.extractArgumentValues(a)):this.getFallbackDescription(a,e.Name,ExcelCopilotCommandingHitlStrings.GenericChange);case z:return ExcelCopilotCommandingHitlStrings.CreateChart;case j:return ExcelCopilotCommandingHitlStrings.DeleteChart;case Q:return ExcelCopilotCommandingHitlStrings.MoveChart;case J:return ExcelCopilotCommandingHitlStrings.ChangeChartType;case Y:return a&&a.length>0&&"string"==typeof a[0]?ExcelCopilotCommandingHitlStrings.ChangeChartDataSourceTemplate.replace("{0}",this.extractArgumentValues(a)):ExcelCopilotCommandingHitlStrings.ChangeChartDataSource;case X:return ExcelCopilotCommandingHitlStrings.ChangeChartFormatting;case Z:if(a&&a.length>0){const t=this.extractArgumentValues(a);return e.Name.includes("ChartTitle")?ExcelCopilotCommandingHitlStrings.ChangeChartTitleTemplate.replace("{0}",t):ExcelCopilotCommandingHitlStrings.ChangeChartTextTemplate.replace("{0}",t)}return ExcelCopilotCommandingHitlStrings.ChangeChartText;case K:return a&&a.length>0?ExcelCopilotCommandingHitlStrings.CreateSheetTemplate.replace("{0}",this.extractArgumentValues(a)):ExcelCopilotCommandingHitlStrings.CreateSheet;case ee:return ExcelCopilotCommandingHitlStrings.DeleteSheet;case te:return ExcelCopilotCommandingHitlStrings.RenameSheetTemplate.replace("{0}",a&&a.length>0?this.extractArgumentValues(a):"");case ae:return ExcelCopilotCommandingHitlStrings.MoveSheet;case ne:return e.Name.includes("Unprotect")?ExcelCopilotCommandingHitlStrings.UnprotectSheet:ExcelCopilotCommandingHitlStrings.ProtectSheet;case oe:return ExcelCopilotCommandingHitlStrings.CreatePivotTable;case re:return ExcelCopilotCommandingHitlStrings.DeletePivotTable;case ie:return ExcelCopilotCommandingHitlStrings.ModifyPivotTable;case le:return ExcelCopilotCommandingHitlStrings.ModifyPivotTableFormatting;case F:return a&&a.length>=2&&"string"==typeof a[0]?this.getNamedItemDescription(a[0],a[1]):this.getFallbackDescription(a,e.Name,ExcelCopilotCommandingHitlStrings.ChangeNamedItems);case k:return e.Name.includes("NamedItem.Formula")&&a&&a.length>0&&"string"==typeof e.Scope.NamedItem?.Name?this.getNamedItemDescription(e.Scope.NamedItem.Name,a[0]):this.getFallbackDescription(a,e.Name,ExcelCopilotCommandingHitlStrings.ChangeNamedItems);case _:return a&&a.length>0&&"string"==typeof a[0]?ExcelCopilotCommandingHitlStrings.EditAltTextTemplate.replace("{0}",a[0]):this.getFallbackDescription(a,e.Name,ExcelCopilotCommandingHitlStrings.EditAltTextCategory);case P:return ExcelCopilotCommandingHitlStrings.ModifyShapePositioning;case ue:return ExcelCopilotCommandingHitlStrings.GenericChange;default:return this.getFallbackDescription(a,e.Name,ExcelCopilotCommandingHitlStrings.GenericChange)}}static getConditionalFormattingDescription(e,t){if(e.Name.includes("ColorScaleConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToColorScale"))return this.getColorScaleDescription(e,t);if(e.Name.includes("DataBarConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToDataBar"))return this.getDataBarDescription(e,t);if(e.Name.includes("ConditionalDataBarPositiveFormat"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("ConditionalDataBarNegativeFormat"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("IconSetConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToIconSet"))return this.getIconSetDescription(e,t);if(e.Name.includes("TopBottomConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToTopBottom"))return this.getTopBottomDescription(e,t);if(e.Name.includes("ConditionalRangeFormat")){if(e.Name.includes("NumberFormat")&&t?.length&&null!==t[0]){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("ConditionalRangeFont"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("ConditionalRangeFill"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("ConditionalRangeBorder"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("TextConditionalFormat")||e.Name.includes("ConditionalFormat.ChangeRuleToContainsText"))return this.getTextComparisonDescription(e,t);if(e.Name.includes("CellValueConditionalFormat")){if(e.Name.includes("Rule")&&t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("CustomConditionalFormat"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("PresetCriteriaConditionalFormat")){if(e.Name.includes("Rule")&&t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("ConditionalFormatRule")){if((e.Name.includes("Formula")||e.Name.includes("FormulaLocal"))&&t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingFormulaTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("ConditionalFormat.SetRanges")){if(t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}if(e.Name.includes("ConditionalFormat.Priority"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(e.Name.includes("ConditionalFormat.StopIfTrue"))return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting;if(t&&t.length>0){const e=this.extractArgumentValues(t);return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",e)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static generateCFDescriptionWithFormulasAndValues(e,t){if(e.length>0&&0===t.length)return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingFormulaTemplate.replace("{0}",me.conjoinStrings(e));if(t.length>0||e.length>0){const a=[...t.map((e=>JSON.stringify(e))),...e];return ExcelCopilotCommandingHitlStrings.SetConditionalFormattingTemplate.replace("{0}",me.conjoinStrings(a))}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getColorScaleDescription(e,t){if(e.Name.includes("Criteria")&&t&&t.length>0){const e=t[0],a=[],n=[];return["minimum","midpoint","maximum"].forEach((t=>{const o=e?.[t];"string"==typeof o?.formula?a.push(o.formula):null!=o?.formula&&n.push(o.formula)})),this.generateCFDescriptionWithFormulasAndValues(a,n)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getDataBarDescription(e,t){if((e.Name.includes("LowerBoundRule")||e.Name.includes("UpperBoundRule"))&&t&&t.length>0){const e=t[0],a=[],n=[];return"string"==typeof e?.formula?a.push(e.formula):null!=e?.formula&&n.push(e.formula),this.generateCFDescriptionWithFormulasAndValues(a,n)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getIconSetDescription(e,t){if(e.Name.includes("Criteria")&&t&&t.length>0){const a=t[0];if(Array.isArray(a)){const e=[],t=[];for(const n of a)"string"==typeof n.formula?e.push(n.formula):null!=n.formula&&t.push(n.formula);return this.generateCFDescriptionWithFormulasAndValues(e,t)}return this.getFallbackDescription(t,e.Name,ExcelCopilotCommandingHitlStrings.SetConditionalFormatting)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getTopBottomDescription(e,t){if((e.Name.includes("Rule")||e.Name.includes("ConditionalFormat.ChangeRuleToTopBottom"))&&t&&t.length>0){const a=t[0],n={[Excel.ConditionalTopBottomCriterionType.bottomItems]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomItemsTemplate,[Excel.ConditionalTopBottomCriterionType.bottomPercent]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomPercentTemplate,[Excel.ConditionalTopBottomCriterionType.topItems]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopItemsTemplate,[Excel.ConditionalTopBottomCriterionType.topPercent]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopPercentTemplate}[a?.type];return n?ExcelCopilotCommandingHitlStrings.SetConditionalFormattingCriteriaTemplate.replace("{0}",n.replace("{0}",a.rank?.toString())):this.getFallbackDescription(t,e.Name,ExcelCopilotCommandingHitlStrings.SetConditionalFormatting)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getTextComparisonDescription(e,t){if((e.Name.includes("Rule")||e.Name.includes("ConditionalFormat.ChangeRuleToContainsText"))&&t?.length){const a=t[0],n={[Excel.ConditionalTextOperator.beginsWith]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonBeginsWithTemplate,[Excel.ConditionalTextOperator.contains]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonContainsTemplate,[Excel.ConditionalTextOperator.endsWith]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonEndsWithTemplate,[Excel.ConditionalTextOperator.notContains]:ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonDoesNotContainTemplate}[a?.operator];return n?ExcelCopilotCommandingHitlStrings.SetConditionalFormattingCriteriaTemplate.replace("{0}",n.replace("{0}",a.text??"")):this.getFallbackDescription(t,e.Name,ExcelCopilotCommandingHitlStrings.SetConditionalFormatting)}return ExcelCopilotCommandingHitlStrings.SetConditionalFormatting}static getFallbackDescription(e,t,a){return o.E.getInstance().updateTelemetryChatEventData({[n.h3.ChatEventType]:n.a5.CommandScratchpadFallbackDescriptionUsed,[n.h3.ChatEventParameters]:t},r.M.getInstance()),e&&e.length>0?"string"==typeof e[0]?ExcelCopilotCommandingHitlStrings.ChangeLeveragingTextTemplate.replace("{0}",this.extractArgumentValues(e)):ExcelCopilotCommandingHitlStrings.ChangeLeveragingValueTemplate.replace("{0}",this.extractArgumentValues(e)):a}static generateHeader(e,t){if(0===e.length)return"";const a=[...e.filter((e=>e.isTextValueChange)).map((e=>e.name)),...e.filter((e=>!e.isTextValueChange)).map((e=>e.name))];let n;if(n=a.length>5?ExcelCopilotCommandingHitlStrings.MultipleCategoriesTemplate.replace("{0}",me.conjoinStrings(a.slice(0,5))):me.conjoinStrings(a),0===t.length)return n;const o=me.conjoinStrings(t);return ExcelCopilotCommandingHitlStrings.HeaderTemplate.replace("{0}",n).replace("{1}",o)}static extractArgumentValues(e){const t=e=>{if(Array.isArray(e)){const a=e.map(t);return`${me.conjoinStrings(a)}`}return"string"==typeof e?`"${e}"`:JSON.stringify(e)},a=e.map(t);return me.conjoinStrings(a)}static getNamedItemDescription(e,t){return"string"==typeof t?ExcelCopilotCommandingHitlStrings.ChangeNamedItemWithFormulaTemplate.replace("{0}",e).replace("{1}",t):ExcelCopilotCommandingHitlStrings.ChangeNamedItemTemplate.replace("{0}",e)}}me.READONLY_API_NAMES=["Range.Select","WorksheetProtection.CheckPassword","Worksheet.Activate","Chart.Activate","Worksheet.FindAllOrNullObject","Worksheet.FindAll","Range.FindOrNullObject","Range.Find","Range._ValidateArraySize","Shape.Activate"]},254359:(e,t,a)=>{"use strict";a.d(t,{n:()=>M});var n=a(700853),o=a(63919),r=a(322466),i=a(103806),l=a(365319),s=a(267324),c=a(937234),d=a(686576),u=a(255448),m=a(9847),h=a(965634),g=a(235373),p=a(797639),b=a(49236),f=a(750927),C=a(464216),y=a(202051),v=a(528804),x=a(340889),T=a(119202),S=a(494554),w=a(4091),E=a(644737),I=a(977055),R=a(107295),A=a(108869),L=a(507628);function k(e,t,a){try{const a=t.extractOper(e);return t.checkIsBusy(a)?void 0:a}catch(e){const t=(0,y.pz)((0,y.MQ)(e,"getCellTypeAndValueIfNotBusy"),e);return void(0,y.QX)(a,t,!1)}}function F(){const e=p.CP.pythonContextManager.lastCodeAndPostViewMessage;if(void 0===e)throw(0,y.pz)("Cannot find the last postview message while updating. Function: getPythonCodeAndPostViewCardProps.",void 0);return{message:e,component:e.chatMessageData.chatCardWrapperProps.renderData.component,props:e.chatMessageData.chatCardWrapperProps.renderData.props}}function _(e,t,a,n){t.chatMessageData.chatCardWrapperProps.renderData=(0,b.Av)(a,n,{isPythonExecutionSuccess:!1},h.S2.PythonError);const o={featureName:m.q.Python,eventType:m.a5.PythonCodeAndPostViewCardUpdatedWithError};l.$.getInstance().updateMessage(t),N(e,t,o,c.Aw.success,!1)}function P({shouldShowAIGeneratedIndicator:e,shouldHideFeedbackSection:t,pythonError:a,actionButtonList:n=[],shouldShowReadAloudButton:o=!1,messageId:l=(0,L.A)(),metadata:s}){const c=function(){let e="Copilot\\Python";const t=(0,v.yw9)("OfficeVSO_9902870_UseFormsAreaPath"),a=i.p.getInstance().getQueryOriginValue()===u.Rk.MsFormsSDX;return(0,R.i)()?e="Copilot\\Answers":t&&a&&(e="Copilot\\PythonForms"),e}(),d={shouldShowAIGeneratedIndicator:e,feedbackData:t?void 0:(0,T.M5)(c),feedbackSectionPosition:t?void 0:r.O.Footer,messageId:l,shouldShowReadAloudButton:o,actionButtonList:a&&(0,v.jHv)()||(0,v.yw9)("OfficeVSO_10238808_answers_add_dev_button")&&(0,v.jHv)()&&(0,R.i)()?[...n,(0,E.yo)(l)]:n};return(0,v.UaO)()&&s&&(d.aiResponseMetadata=s),d}function N(e,t,a,n,o,r=!1){let i="";if(i=JSON.stringify({text:(0,S.N)(t),publishPreference:"Never",stopLoadingUi:o}),o){const t=n===c.Aw.success;e((0,w.L4)(t,r))}e((0,w.nv)(i,n,a,!0,o))}const M={displayPythonAdaRecommendationResponse:function({dispatch:e,requestId:t,code:a,codeExplanation:r,codeLabel:i}){const s=(0,x.if)(a,r),d={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("PythonAdaRecommendation_V1",{requestId:t,code:a,codeExplanation:r,codeLabel:i}),textContent:s}},stopLoadingUi:!1,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:!0})},u={featureName:m.q.Python,eventType:m.a5.SuggestionMessage};l.$.getInstance().displayResponse(d,u),N(e,d,u,c.Aw.success,!1)},displayPythonModelessResponse:function(e,t,a,r,i=!1,s=!1,u=!1,h){const g={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:{component:"ModelessOutput",props:{output:t,outputType:a}},textContent:a}},stopLoadingUi:s,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:r,shouldHideFeedbackSection:i,actionButtonList:h,shouldShowReadAloudButton:u})},p={featureName:(0,I.SG)(),eventType:m.a5.SuggestionMessage};if(l.$.getInstance().displayResponse(g,p),a===d.z.Image){let a;try{const e=JSON.parse(t);a=(0,x.YS)(e.base64_data),a&&l.$.getInstance().resendChatHistorySignal("",(e=>({...e,richTextJson:e.richTextJson,images:a?[a]:[]})))}catch(t){const a=(0,y.Wx)((0,y.MQ)(t,"RenderModelessOutput"),t);(0,y.QX)(e,a,!1)}}N(e,g,p,c.Aw.success,!1)},displayPythonStartAnalysisResponse:function(e,t,a,r,i){const s=(0,x.F)(),d={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("PythonStartAnalysis_V1",{requestId:t,shouldShowRecalcNotice:a,pythonAnalysisSheetName:r}),textContent:s}},stopLoadingUi:!0,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:!1})},u={featureName:m.q.Python,eventType:m.a5.SuggestionMessage};e(g.m.setSuggestionListDetails({suggestionList:[],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0})),l.$.getInstance().displayResponse(d,u),N(e,d,u,c.Aw.success,!0,!i)},displayPythonStartAnalysisButtonExperimentResponse:function(e,t,a,r,i){const s=(0,x.F)(),d=[(0,E.HZ)()],u={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("PythonStartAnalysisButtonExperiment_V1",{requestId:t,shouldShowRecalcNotice:a,pythonAnalysisSheetName:r}),textContent:s}},stopLoadingUi:!0,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:!1,shouldHideFeedbackSection:!1,actionButtonList:d})},h={featureName:m.q.Python,eventType:m.a5.SuggestionMessage};e(g.m.setSuggestionListDetails({suggestionList:[],nextSuggestionTypePriorities:[],shouldResetRecentPrompts:!0,isPythonSuggestion:!0})),l.$.getInstance().displayResponse(u,h),N(e,u,h,c.Aw.success,!0,!i)},displayPythonTextResponse:function(e,t,a,r=!1,i=!1,s,d){if("string"!=typeof t){const e="Python text response is not a string. Message type: "+typeof t;throw(0,y.i_)(e)}const u={chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:o.Q9.Chat,message:t,horizontalTableScroll:!0,disableLinksProcessing:!1,shouldApplyInputLinkTheme:!0}},stopLoadingUi:i,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:a,shouldHideFeedbackSection:r,actionButtonList:s,metadata:d})},h={featureName:m.q.Python,eventType:m.a5.SuggestionMessage};l.$.getInstance().displayResponse(u,h),N(e,u,h,c.Aw.success,i)},displayPythonErrorResponse:function(e,t,a){(0,A.FN)(t);const r={chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:o.Q9.Chat,message:t.errorDisplayMessage,disableLinksProcessing:!0,shouldApplyInputLinkTheme:!0}},stopLoadingUi:!0,chatMessageBodyData:P({shouldShowAIGeneratedIndicator:!1,shouldHideFeedbackSection:!1,pythonError:t,actionButtonList:a})},i={featureName:(0,I.SG)(),eventType:m.a5.ErrorMessage,errorType:m.q0.PythonError,devInfo:t.toString()};p.CP.pythonContextManager.ocvErrorDetails={lastMessageTelemetry:i,...t.errorDetailsOCVOnly},l.$.getInstance().displayResponse(r,i),N(e,r,i,c.Aw.failed,!0)},displayPythonCodeCardWithPendingPostView:function(e,t,a,r,i,d,u,h,g){const p=(0,f.L)(d?(0,s.oMg)():(0,s.vX0)(),[i])+"\n"+(0,x.if)(a,u),C=e((0,w.HO)()),y=P({shouldShowAIGeneratedIndicator:!0,shouldHideFeedbackSection:!1,metadata:g}),v={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("CodeAndPostView",{requestId:t,code:a,cellAddress:i,sheetId:r,pythonCell:void 0,codeLabel:h,codeExplanation:u,pythonUserRequestId:C,isInitialDataFrame:d}),textContent:p}},stopLoadingUi:!1,chatMessageBodyData:y},T={featureName:m.q.Python,eventType:m.a5.PythonCodeAndPostViewCardShown};return l.$.getInstance().displayResponse(v,T),N(e,v,T,c.Aw.success,!1),v},updatePythonCodeAndPostViewCardWithPostView:async function(e,t,a,n,o,r,i){const{message:s,component:d,props:u}=F(),{pythonCell:g,cellTypeAndValue:f}=await async function(e,t,a,n,o){let r;try{r=await n}catch(n){const r=(0,y.pz)((0,y.MQ)(n,"getCellTypeAndValueWithRetry"),n);(0,y.QX)(o,r,!1);const i=e.getRange(a).load(["valuesAsJson"]);return await t.sync(),{pythonCell:i.valuesAsJson[0][0],cellTypeAndValue:void 0}}return await(0,A.AJ)((async()=>{const n=e.getRange(a).load(["valuesAsJson"]);await t.sync();const i=n.valuesAsJson[0][0];return{pythonCell:i,cellTypeAndValue:k(i,r,o)}}),(e=>void 0!==e),await p.CP.pythonContextManager.getMaxRetryAttempts("GetCellTypeAndValueIfNotBusy"),p.CP.pythonContextManager.RETRY_WAIT_IN_MILLISECONDS,!1,o)}(n,o,t,a,e);if((0,v.EJJ)()){const e={type:"code",value:{code:i?.code??"",codeLabel:i?.codeLabel,codeExplanation:i?.codeExplanation,output:JSON.stringify(i?.output),outputType:i?.outputType}},t=(0,C.C)([e],!0);s.chatMessageBodyData&&(s.chatMessageBodyData.aiResponseMetadata=t)}if(void 0!==f&&void 0!==g){let t=s.chatMessageData.chatCardWrapperProps.textContent??"";let a;t+=JSON.stringify(g);const n=g.preview?.properties?.image?.image?.cachedUid;if(n){const e=(o?.workbook).localImage.getBase64EncodedImageData(n);await o.sync(),e?.value&&(a=(0,x.YS)(e.value))}s.chatMessageData.chatCardWrapperProps.textContent=t,s.chatMessageData.chatCardWrapperProps.renderData=(0,b.Av)(d,u,{pythonCell:g,diagnosticsEntry:r,chartImageUrl:a},h.S2.PythonError);const i={featureName:m.q.Python,eventType:m.a5.PythonCodeAndPostViewCardUpdatedWithResult};a&&l.$.getInstance().resendChatHistorySignal("",(e=>({...e,richTextJson:e.richTextJson,images:a?[a]:[]}))),l.$.getInstance().updateMessage(s),N(e,s,i,c.Aw.success,!1)}else _(e,s,d,u)},updatePythonCodeAndPostViewCardWithError:function(e){const{message:t,component:a,props:n}=F();_(e,t,a,n)},displayPythonMergedCardResponse:function(e,t,a,r,i,s){const d=(0,C.C)(t),u=(0,v.cGu)()?e((0,w.HO)()):void 0,h={chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,b.IM)("PythonMergedCard_V1",{requestId:i,pythonUserRequestId:u,messageId:s,chunks:t}),textContent:(0,x.VF)(t)}},stopLoadingUi:r,chatMessageBodyData:{shouldShowCopyButton:!0,...P({shouldShowAIGeneratedIndicator:!1,shouldHideFeedbackSection:!1,shouldShowReadAloudButton:!0,messageId:s,metadata:d})},addCardToChatHistory:r},g={featureName:(0,I.SG)(),eventType:m.a5.PythonMergedCardShown};l.$.getInstance().displayResponse(h,g,{replaceExistingMessage:a}),N(e,h,g,c.Aw.success,!0,!r)}}},255065:(e,t,a)=>{"use strict";a.d(t,{h:()=>C});var n=a(725556),o=a(267324),r=a(886866),i=a(96994),l=a(546762),s=a(980214),c=a(135973),d=a(593562),u=a(9847),m=a(476730),h=a(944563),g=a(576583),p=a(215592);const b=(0,g.n)({mainContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",...p.shorthands.gap("8px"),alignSelf:"stretch",borderRadius:"8px",...p.shorthands.border("1px","solid",h.k1.colorNeutralStroke1),background:h.k1.neutralTertiary},summaryContainer:{display:"flex",...p.shorthands.padding("12px","12px","8px"),alignItems:"center",alignSelf:"stretch"},expandedSectionContainer:{display:"flex",maxHeight:"168px",...p.shorthands.padding("0","12px","0"),alignItems:"flex-start",...p.shorthands.gap("10px"),alignSelf:"stretch",overflowY:"auto",flexDirection:"column"},explanationDivider:{height:"1px"},footer:{display:"flex",height:"28px",...p.shorthands.padding("4px","12px"),justifyContent:"flex-end",alignItems:"center",...p.shorthands.gap("12px"),alignSelf:"stretch",borderRadius:"0px 0px 4px 4px",...p.shorthands.borderTop("1px","solid",h.k1.colorNeutralStroke1)},footerForeground:{color:h.k1.colorNeutralForeground3,"&:hover":{color:h.k1.colorNeutralForeground2Hover},"&:hover:active":{color:h.k1.colorNeutralForeground2Pressed},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},footerForegroundDisabled:{color:h.k1.colorNeutralForegroundDisabled},list:{listStyleType:"none",width:"100%",...p.shorthands.padding("0px"),...p.shorthands.margin("0","0")},listItem:{display:"flex",flexDirection:"column",alignItems:"flex-start",alignSelf:"stretch",width:"100%",...p.shorthands.padding("4px","0")},listItemDivider:{height:"1px"},listItemTitle:{fontWeight:"600",lineHeight:"16px"},listItemContent:{fontWeight:"400",lineHeight:"16px",...p.shorthands.margin("0","0","12px")},loadingContainer:{borderRadius:"8px",...p.shorthands.border("1px","solid",h.k1.colorNeutralStroke1),...p.shorthands.gap("12px"),...p.shorthands.padding("12px","12px")},loadingSkeleton:{...p.shorthands.margin("12px","0"),height:"8px"}});var f=a(208520);function C(e){const t=b(),[a,h]=f.useState(e.showExpandedListOnInit),[g,p]=f.useState(!1),C=(0,f.useRef)(null),y=e.isNotAvailable||0===e.expandableListItems.length;(0,f.useEffect)((()=>{y&&h(!1)}),[y]),(0,f.useEffect)((()=>{a&&null!==C.current&&requestAnimationFrame((()=>{m.E.getInstance().logLatency(performance.now()-C.current,u.OP.ExpandableListExpansion,!0,u.q.OfficeJsCommanding),C.current=null}))}),[a]);const v=()=>{g||(C.current=performance.now(),e.onFirstTimeListExpanded?.(),p(!0)),h(!a)},x=e.isLoading;return(0,n.jsx)("div",{children:x?(0,n.jsxs)("div",{className:t.loadingContainer,children:[(0,n.jsx)(l.E,{children:e.loadingLabel}),(0,n.jsx)(s.E,{animation:"wave",appearance:"opaque",className:t.loadingSkeleton,children:(0,n.jsx)(c.H,{})})]}):(0,n.jsxs)("div",{className:t.mainContainer,children:[(0,n.jsx)("div",{className:t.summaryContainer,children:(0,n.jsx)(l.E,{children:e.summary})}),a&&e.expandableListItems&&(0,n.jsxs)("div",{className:t.expandedSectionContainer,children:[(0,n.jsx)(d.c,{className:t.explanationDivider}),(0,n.jsx)("ul",{className:t.list,children:e.expandableListItems.map(((a,o)=>(0,n.jsxs)("div",{className:t.listItem,children:[(0,n.jsxs)("li",{children:[a.title&&(0,n.jsx)(l.E,{className:t.listItemTitle,children:a.title}),(0,n.jsx)("div",{className:t.listItemContent,children:a.content})]}),o!==e.expandableListItems.length-1&&(0,n.jsx)(d.c,{className:t.listItemDivider})]},o)))})]}),(0,n.jsx)("div",{className:t.footer,children:function(){const s=a?r.g4$:r.rLf;return(0,n.jsx)(i.f,{"aria-roledescription":(0,o.qcV)(),checked:a,disabled:y,size:"small",appearance:"transparent",iconPosition:"after",className:y?t.footerForegroundDisabled:t.footerForeground,onClick:v,icon:(0,n.jsx)(s,{className:y?t.footerForegroundDisabled:t.footerForeground}),children:(0,n.jsx)(l.E,{children:a?e.expandedButtonLabel:e.collapsedButtonLabel})})}()})]})})}},262452:(e,t,a)=>{"use strict";a.d(t,{s:()=>u});var n=a(818067);class o{invokeNative(e){OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))}constructor(){this.RekaConstants={}}}var r=a(534756),i=a(79458);r.ft.registerTypeInfos({"Excel::Copilot::DataShapingPrivateSdxApiTransformationStep":{name:"$string",script:"$string"},"Excel::Copilot::DataShapingPrivateSdxApiInitialScript":{mashupDocument:"$string",queryName:"$string"},"Excel::Copilot::QueryEditorPreviewSuccessResult":{kind:"$string",resultJson:"$string"},"Excel::Copilot::QueryEditorPreviewUnsupportedResult":{kind:"$string",resultKind:"$string"},"Excel::Copilot::QueryEditorPreviewFailResult":{kind:"$string",error:"$string"}});const l={IDataShapingPrivateSdxApiService:["Excel::Copilot::IDataShapingPrivateSdxApiService",{startPreview:["ReturnsPromiseMethod","$any",["$string","$string","$string"],{}],startEmptyPreview:["ReturnsPromiseMethod","$any",["$string"],{}],updatePreviewData:["ReturnsPromiseMethod","$any",["$string","$string"],{}],endPreview:["ReturnsPromiseMethod","$any",["$string"],{}],appendSteps:["ReturnsPromiseMethod","$any",[["$array","Excel::Copilot::DataShapingPrivateSdxApiTransformationStep"]],{}],removeStep:["ReturnsPromiseMethod","$any",["$string"],{}],getQueryScript:["ReturnsPromiseMethod","$string",[],{}],getInitialScript:["ReturnsPromiseMethod",["$optional","Excel::Copilot::DataShapingPrivateSdxApiInitialScript"],[],{}],updateQueryScript:["ReturnsPromiseMethod","$any",["$string"],{}],showErrorMessage:["ReturnsPromiseMethod","$any",["$string"],{}],onQueryScriptChanged:["Event","$string"],onPreviewResultChanged:["Event",["$union",["Excel::Copilot::QueryEditorPreviewSuccessResult","Excel::Copilot::QueryEditorPreviewUnsupportedResult","Excel::Copilot::QueryEditorPreviewFailResult"]]],onPreviewClosed:["Event","$string"]}]};r.ft.registerTypeInfos({"Excel::Copilot::AddQueryResultSuccess":{kind:"$string",actualQueryName:"$string"},"Excel::Copilot::AddQueryResultFail":{kind:"$string",error:"$string"},"Excel::Copilot::AddStepResultSuccess":{kind:"$string",actualStepName:"$string"},"Excel::Copilot::AddStepResultFail":{kind:"$string",error:"$string"}});const s={IPowerQueryPrivateSdxApiService:["Excel::Copilot::IPowerQueryPrivateSdxApiService",{showEditor:["ReturnsPromiseMethod","$any",[],{}],addQuery:["ReturnsPromiseMethod",["$union",["Excel::Copilot::AddQueryResultSuccess","Excel::Copilot::AddQueryResultFail"]],["$string","$string","$boolean"],{}],appendStep:["ReturnsPromiseMethod",["$union",["Excel::Copilot::AddStepResultSuccess","Excel::Copilot::AddStepResultFail"]],["$string","$string","$string"],{}],onCommit:["Event","$string"],onCancel:["Event","$any"]}]},c={IPythonAAPrivateSdxApiService:["Excel::Copilot::IPythonAAPrivateSdxApiService",{showTeachingCalloutScenario:["ReturnsPromiseMethod","$any",["$string"],{}]}]};class d{constructor(e){this._factory=e}get value(){return void 0===this._value&&(this._value=this._factory()),this._value}}class u{static getInstance(){return u.excelSdxPrivateApi||(u.excelSdxPrivateApi=new u),u.excelSdxPrivateApi}get NativeServices(){return this.nativeServices}async initializePrivateApi(){await this.appChatPrivateApi.initializePrivateApi(),this.rekaEnvironment.RekaInstance.initBridge(new o,[]),this.attachPrivateEventHandler("RekaBridgeMessage",(e=>{(0,i.cY)("PrivateApi response: "+e),this.rekaEnvironment?.RekaInstance.invokeJavaScript(e)}))}sendOnReadyEvent(e){const t={messageType:"commonPrivateApiEvent",eventName:e};this.appChatPrivateApi.execute(t)}attachPrivateEventHandler(e,t){this.appChatPrivateApi.attachPrivateEventHandler(e,t)}constructor(){var e;this.appChatPrivateApi=n.B.getInstance(),this.rekaEnvironment=(0,r.NU)(),this.nativeServices=(e=this.rekaEnvironment.RekaServiceRegistry,{IPythonAAPrivateSdxApiService:new d((()=>e.getNativeService(c.IPythonAAPrivateSdxApiService))),IPowerQueryPrivateSdxApiService:new d((()=>e.getNativeService(s.IPowerQueryPrivateSdxApiService))),IDataShapingPrivateSdxApiService:new d((()=>e.getNativeService(l.IDataShapingPrivateSdxApiService)))})}}},265167:(e,t,a)=>{"use strict";a.d(t,{r:()=>r});var n=a(660606),o="AugLoopChat".concat(n.JB),r=function(){function e(){}return e.generateId=function(){return e.operationId++,o+e.operationId.toString()},e.operationId=0,e}()},267324:(e,t,a)=>{"use strict";a.d(t,{Yhj:()=>yn,CnK:()=>ah,Tem:()=>nh,Ub7:()=>oh,p8k:()=>rh,S08:()=>th,inn:()=>jt,MiK:()=>Wc,W4k:()=>pt,zVb:()=>bt,U2P:()=>rd,AXy:()=>Mc,V7x:()=>cn,WJg:()=>dn,I5y:()=>zs,PDm:()=>js,Rzj:()=>rn,fDp:()=>bn,_Q4:()=>fn,Hum:()=>sn,mRA:()=>gn,P6V:()=>pn,S5F:()=>on,zr:()=>rr,sJU:()=>ir,l7G:()=>lr,s46:()=>sr,lqT:()=>cr,cRY:()=>or,OSb:()=>ua,a0$:()=>Cn,$Sd:()=>ln,hiC:()=>Oi,YTh:()=>_i,bUh:()=>Ni,aI5:()=>Mi,wT9:()=>Pi,YXQ:()=>Xa,Q40:()=>Ya,wYv:()=>Qa,Dvy:()=>za,SqW:()=>un,NUW:()=>hn,ynC:()=>mn,Tr2:()=>ja,z15:()=>Tn,n00:()=>Sn,IyO:()=>Ja,YgX:()=>E,t9X:()=>Eg,ht0:()=>k,xJ7:()=>z,YB4:()=>j,yZI:()=>Wd,nuZ:()=>nl,iUs:()=>Ft,BFD:()=>It,l_I:()=>Lt,UDz:()=>kt,sWz:()=>ru,CY_:()=>Rt,RVs:()=>nu,AUM:()=>ou,HTR:()=>ga,PEH:()=>pa,Vx2:()=>ha,dKK:()=>Li,CDl:()=>Hm,P13:()=>lg,z32:()=>og,yo8:()=>eg,Pqn:()=>ng,XD3:()=>ig,ay0:()=>ag,H6H:()=>sg,DqZ:()=>rg,qp3:()=>tg,o9V:()=>Sc,omg:()=>hc,Atw:()=>pc,qcV:()=>$l,ZKU:()=>gt,HGr:()=>Q,qjK:()=>dt,Goo:()=>Y,u3x:()=>ae,YbA:()=>Z,ZX_:()=>ee,yUb:()=>J,_1n:()=>ut,wzr:()=>mt,SXB:()=>X,mYV:()=>ne,wQR:()=>K,Rc5:()=>te,jcG:()=>ht,zQo:()=>Di,imT:()=>I,tOz:()=>Wa,Xxp:()=>R,eZ0:()=>Pc,Wuy:()=>Qs,CDV:()=>Js,QKr:()=>Ys,AUu:()=>Xs,wnp:()=>Zs,yid:()=>Ks,nsJ:()=>dc,bo$:()=>ec,H1r:()=>tc,N0H:()=>ac,$c5:()=>ic,paF:()=>cc,PKs:()=>nc,Dt7:()=>oc,dcf:()=>rc,DXl:()=>lc,HPY:()=>sc,Bjy:()=>Tr,NIQ:()=>Zt,ahY:()=>Kt,tl8:()=>ea,IZs:()=>aa,ir6:()=>ta,Hn3:()=>na,LA5:()=>oa,aXL:()=>Vt,svm:()=>Bt,L1E:()=>$t,UVk:()=>Ht,$cm:()=>Ut,UGc:()=>qt,q7F:()=>ji,Lii:()=>L,uy0:()=>Ah,vdP:()=>il,KCq:()=>cl,Muj:()=>Hi,XsD:()=>zi,dw7:()=>Um,ICT:()=>Ki,XM5:()=>Nc,zSd:()=>_r,hJV:()=>Nr,yPQ:()=>Mr,AbP:()=>Fr,DSt:()=>Or,lj0:()=>Fi,go9:()=>ki,vqw:()=>br,oOi:()=>fr,v7j:()=>Cr,vks:()=>yr,YKk:()=>pr,DwD:()=>Pr,ZcJ:()=>Za,Sur:()=>tn,UFE:()=>Ka,$nW:()=>en,Gpd:()=>an,N9u:()=>nn,VCG:()=>Gm,$0s:()=>_c,T0z:()=>Vd,yNF:()=>Ud,I77:()=>Dd,t_C:()=>Hd,LNV:()=>qd,AsH:()=>Bd,z4t:()=>$d,$5J:()=>Gd,mjl:()=>Ga,ax8:()=>Va,OfU:()=>oe,q_f:()=>re,TaP:()=>$s,H6b:()=>qa,COL:()=>qr,Klw:()=>Ur,eII:()=>Vr,JF4:()=>Ri,rZm:()=>Ei,O0M:()=>wc,Pzq:()=>gh,GyK:()=>ph,TMJ:()=>bh,OpW:()=>fh,rho:()=>Ch,xmO:()=>hh,DPI:()=>gg,tMN:()=>hg,erl:()=>zd,rBP:()=>jd,Ib6:()=>la,NKv:()=>da,OXO:()=>sa,xqS:()=>ca,PUb:()=>ia,LxC:()=>jc,wzs:()=>Ie,fYt:()=>Re,yXE:()=>ce,A99:()=>Ee,Bdz:()=>Ae,Bms:()=>Fe,qmi:()=>Me,SpP:()=>Le,bCm:()=>ke,$oZ:()=>ve,lp5:()=>_e,CcC:()=>pe,aRL:()=>be,gXw:()=>Ne,eMD:()=>Se,i3R:()=>fe,pF5:()=>Ce,bLM:()=>Te,K1Z:()=>Pe,vK1:()=>me,m$v:()=>he,Y9M:()=>de,O8z:()=>ue,AS_:()=>ge,y3x:()=>xe,kSh:()=>we,FuV:()=>lh,yWY:()=>sh,tPp:()=>ch,YSs:()=>dh,di6:()=>uh,ean:()=>mh,TVz:()=>ih,fOb:()=>Qt,Xlr:()=>oi,y9Z:()=>li,Hdt:()=>ri,EoV:()=>Mh,uvk:()=>Oh,ZDb:()=>xg,K2I:()=>al,Obq:()=>Pt,UuN:()=>tu,u1i:()=>Xt,mT9:()=>_a,VMi:()=>hi,Ogc:()=>Dt,Oj_:()=>Ar,RCr:()=>Lr,BVL:()=>kr,M8Q:()=>P,tFi:()=>N,wZB:()=>wr,vvX:()=>ug,aDv:()=>dg,R7A:()=>mg,ySS:()=>Tg,I3c:()=>au,m1B:()=>Hc,FA0:()=>Uh,gAP:()=>Vs,_h7:()=>Ws,Twc:()=>Gs,_A_:()=>Ai,SHb:()=>St,czL:()=>wh,jh3:()=>Eh,M76:()=>Sh,u1Q:()=>Yt,YWO:()=>Vi,qbK:()=>W,XBr:()=>wt,vG7:()=>Ca,zyf:()=>ya,AWH:()=>Yh,yfY:()=>Xh,jdI:()=>Qi,QEp:()=>Gt,ekx:()=>vn,vMn:()=>ar,Edn:()=>md,nEe:()=>hd,syu:()=>sd,LhO:()=>cd,Af3:()=>dd,Bfv:()=>ud,$Mo:()=>id,UQX:()=>ld,$Eq:()=>qi,M_y:()=>rl,koJ:()=>sl,hIB:()=>ul,OS6:()=>yd,Txd:()=>bd,h9u:()=>gd,u1U:()=>pd,zb:()=>fd,yWm:()=>Id,pZZ:()=>Od,Z4S:()=>Ld,N0D:()=>vd,k0o:()=>Pd,kM:()=>Nd,uLY:()=>Md,U45:()=>Ad,n1d:()=>wd,Rcx:()=>Ed,Dqz:()=>Sd,m3r:()=>Td,Iiw:()=>Rd,Vd6:()=>Cd,gTs:()=>xd,w$T:()=>_d,NLG:()=>Fd,J40:()=>Sa,E$x:()=>yt,aVz:()=>ft,oOI:()=>yg,BqH:()=>Ct,IKl:()=>Ea,Nbb:()=>Ds,EWN:()=>vt,Yyo:()=>wa,fLI:()=>Ih,LLM:()=>Ia,imX:()=>h,WlT:()=>m,u7V:()=>b,w_Q:()=>p,W32:()=>g,Vno:()=>c,gu1:()=>d,mDj:()=>u,VHx:()=>Ir,bcx:()=>Er,Amo:()=>Ii,BU1:()=>Rr,Kc4:()=>el,M_1:()=>Ge,tZV:()=>We,SUe:()=>ze,zZj:()=>je,uo4:()=>Ke,x4R:()=>et,znb:()=>ye,_lL:()=>Ze,tJt:()=>rt,aaC:()=>it,wvg:()=>Xe,BaS:()=>nt,CP3:()=>ot,XQw:()=>Qe,$LK:()=>Je,_73:()=>Ye,_9M:()=>tt,Bpz:()=>at,XFR:()=>Be,ZYo:()=>qe,w7p:()=>$e,T8g:()=>He,ZU3:()=>Ue,De1:()=>Ve,j9u:()=>vg,UOv:()=>De,C3N:()=>nr,olU:()=>U,WpK:()=>Bi,PX_:()=>Ic,T1Y:()=>S,cGI:()=>w,ifF:()=>F,Sak:()=>wi,XWM:()=>Ti,ReY:()=>Si,_C5:()=>xi,Pjp:()=>mc,dlV:()=>Ec,hAn:()=>ur,aS7:()=>mr,VdU:()=>hr,aDZ:()=>gr,o3Z:()=>dr,xau:()=>se,L8i:()=>ie,AKP:()=>le,J0g:()=>Oe,Rff:()=>Tm,nKX:()=>Vm,Tg4:()=>Xi,_:()=>Wm,L0p:()=>Ua,QOn:()=>Ha,GRk:()=>Qh,r$C:()=>A,V0i:()=>Hh,aYy:()=>kh,Pot:()=>Lh,SS1:()=>_h,nx1:()=>Fh,SCL:()=>iu,MKr:()=>lu,_ZG:()=>qm,Ehc:()=>Ph,BVu:()=>Kd,ir3:()=>eu,v3A:()=>Br,KVc:()=>$r,f7s:()=>Dr,CLD:()=>Hr,Nfx:()=>ii,_kX:()=>Zr,IH5:()=>ei,Y55:()=>Kr,CPY:()=>Gr,ak4:()=>jr,s2u:()=>Xr,mF:()=>zr,T5i:()=>Qr,r8x:()=>Jr,nPU:()=>Yr,gnM:()=>ni,kAS:()=>Wr,gtW:()=>_,R_I:()=>pg,xxz:()=>V,OX0:()=>Ra,gGJ:()=>tl,FxF:()=>Bh,zGM:()=>$h,NRU:()=>kc,gOS:()=>ad,Gn5:()=>Oc,e0T:()=>nd,ds$:()=>Fm,sY1:()=>Mm,kTv:()=>$m,Fsb:()=>Lm,DIE:()=>Am,jpr:()=>Nm,pRP:()=>Pm,KBQ:()=>km,I53:()=>_m,JGR:()=>Bm,NeW:()=>Dm,sGO:()=>Om,vKl:()=>wm,CNP:()=>Em,v$B:()=>Im,C2X:()=>Rm,AZo:()=>Fc,ft7:()=>Dc,VDh:()=>Lc,hLq:()=>ed,ZSg:()=>od,u6S:()=>Bc,n0L:()=>td,hiv:()=>pi,zDx:()=>kd,y$1:()=>hl,Sa0:()=>Qc,Ony:()=>Jc,KdV:()=>Cc,$98:()=>yc,UTd:()=>Ig,kDR:()=>Fu,NSY:()=>Au,RT6:()=>_u,j0F:()=>Lu,Q0:()=>Iu,fzU:()=>xu,I$I:()=>vu,JAc:()=>fu,gNJ:()=>bu,nhC:()=>Su,fu2:()=>uu,EW5:()=>du,mk8:()=>Tu,I$d:()=>yu,t8C:()=>Cu,TTT:()=>hu,IpP:()=>mu,qbB:()=>pu,B3O:()=>gu,fRc:()=>cu,ENk:()=>su,LC$:()=>Uu,ijW:()=>Hu,irK:()=>Du,J$y:()=>Ou,RV_:()=>Mu,uVJ:()=>ku,hEI:()=>wu,qU2:()=>Nu,P82:()=>xm,v3q:()=>Eu,Y2N:()=>Pu,I64:()=>$u,pDo:()=>Bu,wUB:()=>Ru,Vl3:()=>rs,ELg:()=>as,J9g:()=>os,LAW:()=>Kl,Efv:()=>Zl,I_l:()=>Xl,Rpx:()=>es,Sl:()=>Il,Gyx:()=>Al,kQP:()=>Ml,ZgC:()=>At,jv5:()=>xl,GLO:()=>yl,WIE:()=>ms,Sk4:()=>El,gg6:()=>Hs,JIA:()=>Bs,pa_:()=>Us,YvV:()=>qs,kvH:()=>gl,YCq:()=>Bl,mq0:()=>Rl,IiW:()=>Dl,x75:()=>us,vCA:()=>bs,YYS:()=>ps,Toc:()=>xs,g$5:()=>vs,r5N:()=>ts,g9p:()=>Ol,Yzk:()=>Yl,ABr:()=>Nl,Lby:()=>Ql,lL1:()=>ks,o7M:()=>Ls,A1r:()=>kl,O4H:()=>Fl,jYw:()=>Ll,xUh:()=>Sl,wW0:()=>ns,Lw5:()=>_s,OKX:()=>As,lgi:()=>fl,FCw:()=>bl,ivT:()=>Rs,XZh:()=>gs,pKU:()=>Os,Huq:()=>ct,aDI:()=>st,EwU:()=>lt,UvY:()=>Pl,zOC:()=>_l,V8T:()=>Ps,S3X:()=>Cl,vX0:()=>is,oPd:()=>cs,oMg:()=>ls,csN:()=>ss,g1k:()=>vl,ZOw:()=>fs,$L3:()=>wl,rfR:()=>ds,NCh:()=>Ul,gU_:()=>Fs,QAQ:()=>jl,dvg:()=>Tl,zqN:()=>ql,LMV:()=>zl,PxQ:()=>Wl,XXH:()=>Hl,Dpi:()=>Jl,lQ6:()=>Vl,WQT:()=>Gl,YVl:()=>Es,rhr:()=>Cs,EB5:()=>Ms,PHI:()=>Ns,GRh:()=>Ts,dI9:()=>Ss,PX7:()=>Is,CsI:()=>ws,ie5:()=>hs,V9X:()=>pl,DjY:()=>ys,hn:()=>bi,epH:()=>vi,Pqm:()=>fi,ZB_:()=>yi,BaM:()=>Ci,b4o:()=>Nt,KC:()=>_t,bj$:()=>Ta,r9E:()=>Yi,Rp5:()=>ai,mnG:()=>$i,XKD:()=>si,QbU:()=>ci,ejy:()=>di,YtG:()=>Yc,qvS:()=>Xc,W9h:()=>vc,JuZ:()=>xc,pwZ:()=>Rh,Is:()=>zc,Iy7:()=>yh,Qv5:()=>vh,Xdl:()=>xh,QaT:()=>Th,OsU:()=>f,QCY:()=>Aa,ZOE:()=>La,$TB:()=>cg,FIy:()=>Zi,byP:()=>xn,brP:()=>ol,t3j:()=>ll,Kve:()=>dl,yMF:()=>Ui,fVE:()=>Rc,lJi:()=>xr,s_X:()=>vr,ZQs:()=>Uc,iMG:()=>qc,xKU:()=>Gc,cFM:()=>Vc,gZd:()=>In,JEr:()=>Fn,hzZ:()=>An,lkD:()=>En,dYE:()=>Ln,gax:()=>Rn,jmZ:()=>wn,G5z:()=>ra,fkZ:()=>ho,EZu:()=>kn,PFs:()=>_n,h8D:()=>fg,BZb:()=>bg,b_h:()=>Cg,Qte:()=>Tc,etO:()=>Wi,rGh:()=>v,HhS:()=>Zm,$S6:()=>eh,gq9:()=>Km,xFL:()=>Xm,hAW:()=>zt,S0l:()=>Sm,Pxj:()=>Zu,Gp3:()=>Xu,qre:()=>Yu,P$N:()=>Jh,MIy:()=>qh,bor:()=>Vh,MuJ:()=>zh,VJh:()=>jh,uvg:()=>Gh,R3b:()=>Wh,h_t:()=>bm,ev2:()=>pm,up8:()=>gm,c_T:()=>hm,Dh1:()=>mm,Tlk:()=>um,mJ6:()=>dm,z56:()=>cm,jLG:()=>sm,vkL:()=>lm,GIT:()=>im,c7Y:()=>rm,C$7:()=>Ju,Thz:()=>Qu,ZkE:()=>ju,VH3:()=>Cm,S7l:()=>fm,nYf:()=>ym,mcb:()=>tm,pP4:()=>em,nMc:()=>Ku,pOf:()=>om,kMm:()=>nm,ujQ:()=>am,L0V:()=>zu,NXr:()=>Wu,DIq:()=>Gu,p8O:()=>vm,YMx:()=>Vu,eGo:()=>qu,HZc:()=>Ot,DwS:()=>C,fw9:()=>y,Ykh:()=>Nh,wzu:()=>mi,xtr:()=>M,Yuw:()=>O,NOF:()=>ui,Moz:()=>wg,$sl:()=>Sg,vLX:()=>uc,qPG:()=>Zh,Py2:()=>Kh,pH2:()=>Sr,fhV:()=>$c,OJx:()=>Gi,chZ:()=>gc,px2:()=>ba,_J3:()=>fa,HRg:()=>ml,sUU:()=>va,W1n:()=>xa,mLK:()=>Ym,wEx:()=>Jm,Y91:()=>Qm,vuT:()=>jm,J_P:()=>Wt,Eyh:()=>ma,DUN:()=>zm,AWW:()=>Et,KeO:()=>xt,ooE:()=>Tt,xk_:()=>Dh,ORJ:()=>Ac,H2U:()=>ti,iVS:()=>Ji,AF5:()=>gi,USL:()=>Fa,tDq:()=>ka,UEB:()=>Na,v01:()=>Pa,gk_:()=>Oa,DyN:()=>Ma,Fxc:()=>Da,MED:()=>$a,TSg:()=>Ba,VAP:()=>Jt,zvE:()=>Zc,tdb:()=>bc,mjS:()=>Kc,kfS:()=>fc,KsV:()=>Yn,ztP:()=>Xn,Oz3:()=>mo,Bzb:()=>go,gsW:()=>Go,bgS:()=>Wo,ixU:()=>So,BhF:()=>wo,E9A:()=>fo,pKA:()=>Co,BIf:()=>Bo,wwj:()=>$o,D02:()=>Oo,QHr:()=>Do,nHd:()=>oo,KtU:()=>ro,lun:()=>Un,fEB:()=>Vn,On3:()=>qn,qag:()=>$n,d0n:()=>Hn,no:()=>Zn,qAx:()=>Kn,$dh:()=>Nn,U7J:()=>Lo,roM:()=>Ho,esl:()=>Uo,D8x:()=>xo,Coj:()=>To,H5o:()=>uo,I1u:()=>so,N_T:()=>co,_JR:()=>Wn,jI0:()=>Mn,lFW:()=>qo,aW0:()=>Vo,_ok:()=>Fo,Z2X:()=>ko,Ghz:()=>Gn,nby:()=>Yo,_BM:()=>Xo,zp5:()=>Pn,$OL:()=>eo,C_C:()=>to,wvv:()=>Eo,hCI:()=>Io,sqX:()=>po,xf7:()=>bo,vJt:()=>Zo,ST4:()=>Ko,vNK:()=>Bn,ONP:()=>Dn,_0P:()=>er,tMQ:()=>tr,IZv:()=>On,xMZ:()=>yo,YYh:()=>vo,NyX:()=>No,WNU:()=>Mo,xOV:()=>ao,_zy:()=>no,UXx:()=>zn,VG_:()=>jn,XAy:()=>_o,kvY:()=>Po,qhm:()=>Ro,DqS:()=>Ao,Qhk:()=>zo,rnM:()=>jo,r3R:()=>Qo,_xk:()=>Jo,ptM:()=>Qn,K0f:()=>Jn,itS:()=>io,f00:()=>lo,Z1M:()=>T,GHt:()=>Rg,OKS:()=>Zd,sj0:()=>Qd,Vgn:()=>Jd,ZAw:()=>Yd,Ovt:()=>Xd,fn_:()=>x,SGs:()=>D,N1d:()=>$,kK2:()=>H});var n=a(722307),o=a(528804);function r(e,t=3e3){window.setTimeout((()=>{throw new Error(e)}),t)}function i(e,t,a=r){return new Proxy(t,{get(t,n){if("string"!=typeof n)return a("Unexpected string name type"),"";const o=n,r=globalThis[e];return r?r[o]:(a(`Requesting string ${e}.${n} before strings have loaded`),t[o])}})}const l=JSON.parse('{"FREHeader":"Introducing Copilot","FREDescriptionMessage":"Use the power of AI to add columns with formulas, format tables, and generate insights about data in your tables.\\n\\nCopilot can make mistakes, so remember to verify info and share your feedback.","ServerErrorMessage":"Whoops! I\'m not able to understand this yet. Is there something else I can do to help?","QueryLengthTooShortError":"Your message is too short. Please provide more information.","RaiErrorUserMessage":"I\'m not able to do that. What else can I do for you?","RaiErrorSuccessfulActionBlockedResponse":"Done! I made some changes, but I\'m not able to provide a description of the changes right now.","ServerErrorWithNoRetry":"I can\'t help with that. Try another prompt or use the prompt guide to see how I can help.","ServerErrorWithNoRetrySuggestionPill":"While I don\'t have a suggestion for you right now, try asking a specific question about the data.","ThrottlingErrorMessage":"You\'ve reached the limit on the total number of Copilot requests per hour. Try again in a little while.","LicensingErrorMessage":"Your account is not licensed to use Copilot, please contact your admin","ErrorQueryTooLarge":"I\'m still learning. That request is too large. Would you mind simplifying your request to one thing you want me to do?","ErrorServerBusy":"The server is really busy right now. Please try again later.","ZQMPromptItemAsk":"Ask","ZQMPromptItemSummarize":"Summarize","CitationTitle":"This workbook","ClpLabelError":"I wasn\'t able to apply a sensitivity label to this file. Please choose another file or try again.","BlankWorksheetButtonText":"Try an example","BlankWorksheetButtonSuccess":"Done! I\'ve added the sample table. Try some of the suggestions to see how I can help.","ConvertToTableButtonSuccess":"Done! I\'ve created a Table from your data in {0}. How else can I help?","InsertTableSummaryCommentSuccessMessage":"Done! I added the description as a comment at {0}","TableTooLargeMessage":"Copilot doesn\'t work with tables that have more than 40,000 cells. Try again with a smaller table.","TLRTooSmallMessage":"I can only work on data ranges that have at least 3 rows and 2 columns. If the range doesn\'t meet this criteria, convert it to a table by selecting **Insert** in the ribbon, and then selecting **Table**.","LoadingTableLikeRangesWarning":"While I\'m understanding your data, feel free to ask general Excel questions or try again later if my answer is inaccurate.","ShowHeadersButtonTitle":"Show Header Row","ShowHeadersSuccessMessage":"Done! I\'ve made the header row of the table visible. How else can I help?","WorkbookTooLargeTitle":"Workbook too large","WorkbookTooLargeMessage":"Copilot doesn\'t work with workbooks that have more than 150,000 cells. Try using Copilot with a smaller workbook.","WorksheetAutosaveOffTitle":"AutoSave is turned off","WorksheetAutosaveOffMessage":"I only work with files that have AutoSave turned on. Turn it on to continue.","EnableAutosaveButtonText":"Turn on AutoSave","WorksheetProtectedTitle":"This sheet is protected","WorksheetProtectedMessage":"I can\'t work on sheets that are protected or require a password. If you remove the protection temporarily, I can help you explore your data. Don\'t worry, you can add the protection back anytime.","NonWorksheetActivatedTitle":"Start with a different sheet","NonWorksheetActivatedMessage":"I don\'t work in chart, macro, or dialog sheets. Select another sheet with data in an Excel table to continue.","ActionButtonGoToTable":"Go back to table","ActionButtonGoToData":"Go back to data","ActionButtonGoToWorksheet":"Go back to {0}","ActionButtonInsert":"Insert to new sheet","ActionButtonUndo":"Undo","ActionButtonUndoSuccessMessage":"Sure, I just reversed the last change I made.","ActionButtonApply":"Apply","InsertSingleTableSuccessMessage":"Done! A new table was inserted to {0}.","InsertMultiTablesSuccessMessage":"Done! {0} tables were added to your workbook.","InsertTableErrorMessage":"Sorry, something went wrong. Try your request again later.","InsertAllDataConfirmationMessage1":"Done! All insights from","InsertAllDataConfirmationMessage2":"were added to a new sheet.","InsertAllDataConfirmationMessage":"Done! I added all insights from {0} to a new sheet.","InsertDataConfirmationMessage1":"Done!","InsertDataConfirmationMessage2":"was added to","InsertDataConfirmationMessage":"Done! I added {0} to {1}.","CalculatedColumnsColumnConfirmationMessage":"Done! I inserted \'{0}\' to column {1}.","CalculatedColumnsTableConfirmationMessage":"Done! I inserted \'{0}\' to \'{1}\'.","MultipleCalculatedColumnsAddedToColumnsConfirmationMessage":"Done! I inserted {columnNames} to columns {columnHeaders}.","MultipleCalculatedColumnsAddedToTableConfirmationMessage":"Done! I inserted {columnNames} to \'{tableName}\'.","MoreThanThreeColumnsAddedToTableConfirmationMessage":"Done! I inserted {columnLength} formula columns to the table.","And":"and","EnterDataShapingNoTableError":"Whoops! This feature only works on formatted tables. Please format your data as an Excel table and try again. (Hint: select the table and run CTRL+T)","EnterDataShapingGenericError":"Data Preparation in Excel isn\'t available. Try your request again later.","DataShapingGenericError":"I\'m having trouble working on prompts. If you want help with something other than preparing the data for analysis, exit the mode and continue.","DataShapingUnsupportedPromptError":"I can\'t generate a high-quality answer for this prompt. Stop preparing the data and use another prompt.","DataShapingSuggestEnterModeHeaderText":"I can prepare the data for you, so it\'s easier to perform analysis and get accurate results.","DataShapingSuggestEnterModeText1":"Here\'s what I\'ll do:","DataShapingSuggestEnterModeTextBullet1":"Show a preview of the changes to apply","DataShapingSuggestEnterModeTextBullet2":"Apply the changes you want in the current sheet or a new one","DataShapingSuggestEnterModeText3":"Stop preparing the data if you\'d like help with other tasks.","DataShapingEnterModeButton":"Start preparing data","DataShapingLoadingStartDataShapingMode":"Entering data preparation.. ","DataShapingPostEnterModeText1":"Before you start analyzing data in this workbook, I can help identify ways to prepare your data for the most accurate answers.","DataShapingPostEnterModeText2":"Describe what you\'d like help with.","LoadingUIApplyDataShapingStep":"Working on it...","LoadingUIApplyDataShapingStep2":"Reviewing the data...","LoadingUIApplyDataShapingStep3":"Preparing the data...","LoadingUIApplyDataShapingStep4":"Almost there...","DataShapingDone":"Done! {0}","DataShapingApplyOrExit":"Apply changes and stop preparing","DataShapingApplyToExistingTable":"Replace original table","DataShapingApplyToNewSheet":"Apply to new sheet","DataShapingDiscardChanges":"Discard Changes ","LoadingUIExitDataShapingMode":"Stopping data preparation...","DataShapingDiscardChangesDone":"OK, I stopped preparing the data","DataShapingApplyToExistingTableDone":"Ok, I replaced the original table","DataShapingApplyToNewSheetDone":"OK, I applied it to a new sheet","ExplainInsights":"Explain insights","ExplainFormula":"Explain formula","ExplainFormulas":"Explain formulas","ExplainCode":"Explain code","NoInsightsMessage":"I didn\'t find any relevant insights in your data. Try adding more data or use another data set.","NoAnalyzeDataMessage":"I don\'t have a helpful answer. Try another prompt.","AnalyzePotentialBiasMessage":"I\'m not able to work on that. However, I can try getting other insights for you.","AddMoreInfoMessage":"The more I know, the better I can answer. Try adding more information.","AnalyzeNotSupportedMessage":"I can\'t do that just yet. What else would you like me to do?","AnalyzeDataGenericError":"I\'m having trouble right now. Try inserting the content later.","AnalyzeDataGenericError2":"I\'m having trouble working on prompts right now. Try sending your prompt later.","AccessDeniedMessage":"Looks like this is a password-protected sheet. I\'m unable to insert this suggestion. Unprotect this sheet for a moment and try again.","CellEditingMessage":"I can\'t insert a suggestion while you\'re editing. Try again when you finish.","ChatPlaceholderMessageV2":"Ask a question, or tell me how I can help","ChatPlaceholderMessageSearch":"Search for content, ask a question, or tell me how I can help","ChatPlaceholderMessageRange":"Ask a question, or tell me what you\'d like to do with {0}","ChatPlaceholderMessageSearchWithRange":"Search for content, ask a question, or tell me what you\'d like to do with {0}","ChatPlaceholderMessageInputV2NoGrounding":"Ask questions and work with this workbook","ChatPlaceholderMessageInputV2Enterprise":"Ask questions regarding people and files across your organization","ChatPlaceholderMessageAnalyzeData":"Describe what you want to know about the data","ChatPlaceholderMessageFormatTable":"Describe the changes you want to make to the table","ChatPlaceholderMessageFormulaColumn":"Describe the formula column you want to add","ChatRestShyPlaceholderMessage":"Ask a question","ChatRestShyPlaceholderMessageRange":"Ask a question about {0}","LoadingUIWorkingOnItStep":"Working on it...","LoadingUiUnderstandingDataStep":"Understanding your data...","LoadingUIAlmostThereStep":"Almost there...","LoadingUILookingAtDataRangeStep":"Looking at data range {0}...","LoadingUILookingAtDataRangeStepWithSheet":"Looking at data range {range} on \'{sheet}\'...","LoadingUILookingAtDataRangeStepWithNamedSheet":"Looking at data range {range} on the \'{sheet}\' sheet...","LoadingUIAddingColumnStep":"Adding column...","LoadingUIAddingColumnsStep":"Adding columns...","LoadingUIInsertingContentStep":"Inserting content...","LoadingUIAnalyzingDataStep":"Analyzing your data...","LoadingUIAnalyzingDataTLRStep":"Analyzing {0}...","LoadingUIAnalyzingDataTLRStepWithSheet":"Analyzing {range} on \'{sheet}\'...","LoadingUIAnalyzingDataTLRStepWithNamedSheet":"Analyzing {range} on the \'{sheet}\' sheet...","LoadingUIFinishingUpStep":"Finishing up...","LoadingUIMakingChangesStep":"Making changes to your table...","LoadingUIMakingChangesChartStep":"Making changes to your chart...","LoadingUIMakingChangesTLRStep":"Making changes to {0}...","LoadingUIMakingChangesTLRStepWithSheet":"Making changes to {range} on \'{sheet}\'...","LoadingUIMakingChangesTLRStepWithNamedSheet":"Making changes to {range} on the \'{sheet}\' sheet...","LoadingUIGeneratingFormulaColumnSuggestionsStep":"Generating formula column suggestions...","LoadingUIGeneratingFormulaColumnSuggestionsTLRStep":"Generating formula column suggestions for {0}...","LoadingUIGeneratingFormulaColumnSuggestionsTLRStepWithSheet":"Generating formula column suggestions for {range} on \'{sheet}\'...","LoadingUIGeneratingFormulaColumnSuggestionsTLRStepWithNamedSheet":"Generating formula column suggestions for {range} on the \'{sheet}\' sheet...","LoadingUIMakingChangesStepTableOfficeJSLikeRange":"Making changes to your workbook...","RecommendationAddToNewSheet":"Add to a new sheet","RecommendationAddToSheet":"Add to sheet","RecommendationInsertColumn":"Insert column","RecommendationInsertMultipleColumns":"Insert columns","RecommendationSuggestionHeader":"Here\'s 1 formula column to review and insert:","RecommendationSuggestionHeaderGrounded":"Here\'s 1 formula column to review and insert into {range}:","RecommendationSuggestionHeaderGroundedWithSheet":"Here\'s 1 formula column to review and insert into {range} on \'{sheet}\':","RecommendationSuggestionHeaderGroundedWithNamedSheet":"Here\'s 1 formula column to review and insert into {range} on the \'{sheet}\' sheet:","RecommendationFormulaSuggestionHeaderGrounded":"Here\'s 1 formula to review and insert into {range}:","RecommendationFormulaSuggestionHeaderGroundedWithSheet":"Here\'s 1 formula to review and insert into {range} on \'{sheet}\':","RecommendationFormulaSuggestionHeaderGroundedWithNamedSheet":"Here\'s 1 formula to review and insert into {range} on the \'{sheet}\' sheet:","RecommendationSuggestionMultipleColumnsHeader":"Here are {columnLength} formula columns to review and insert:","RecommendationSuggestionMultipleColumnsHeaderGrounded":"Here are {columnLength} formula columns to review and insert into {range}:","RecommendationSuggestionMultipleColumnsHeaderGroundedWithSheet":"Here are {columnLength} formula columns to review and insert into {range} on \'{sheet}\':","RecommendationSuggestionMultipleColumnsHeaderGroundedWithNamedSheet":"Here are {columnLength} formula columns to review and insert into {range} on the \'{sheet}\' sheet:","RecommendationAnotherSuggestionHeader":"Here\'s another suggestion for you:","RecommendationAnotherSuggestionMultipleColumnsHeader":"Here are another {columnLength} suggestions for you:","FormulaSuggestion_Header_Singular":"Looking at {tableRange}, here\'s 1 formula column to review and insert in {location}:","FormulaSuggestion_Header_SingularWithSheet":"Looking at {tableRange} on \'{sheet}\', here\'s 1 formula column to review and insert in {location}:","FormulaSuggestion_Header_SingularWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here\'s 1 formula column to review and insert in {location}:","FormulaSuggestion_Header_Plural":"Looking at {tableRange}, here are {columnLength} formula columns to review and insert in {location}:","FormulaSuggestion_Header_PluralWithSheet":"Looking at {tableRange} on \'{sheet}\', here are {columnLength} formula columns to review and insert in {location}:","FormulaSuggestion_Header_PluralWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here are {columnLength} formula columns to review and insert in {location}:","FormulaSuggestion_Header_Singular_Location":"Column {columnLetter}","FormulaSuggestion_Header_Plural_Location":"Columns {columnLetters}","FormulaSuggestion_FormulaSnippet_AriaLabel":"Formula snippet","JunkPhrase1":"hey","JunkPhrase2":"hi","JunkPhrase3":"whats happening","JunkPhrase4":"hey there","JunkPhrase5":"whats up","JunkPhrase6":"who are you","JunkPhrase7":"heyo","JunkPhrase8":"whats going on","JunkPhrase9":"what up","JunkPhrase10":"hi there","JunkPhrase11":"how are you","JunkPhrase12":"good morning","JunkPhrase13":"good afternoon","JunkPhrase14":"good evening","JunkPhrase15":"whats your name","JunkPhrase16":"where are you from","JunkPhrase17":"where do you live","JunkPhrase18":"who made you","JunkPhrase19":"what is this","JunkPhrase20":"what do you do","JunkPhrase21":"what does this do","OptOutMessageTitle":"Thanks for giving me a try!","OptOutMessageSubTitle":"I know it\'s not you, it\'s me. But if you want me back, click the Ribbon Display Options down arrow and choose Beta","OptOutPhrase1":"quit","OptOutPhrase2":"return","OptOutPhrase3":"stop","OptOutPhrase4":"leave","OptOutPhrase5":"i dont like this","OptOutPhrase6":"i dont want this","OptOutPhrase7":"i hate this","OptOutPhrase8":"i dont want to use this","OptOutPhrase9":"i want the ribbon","OptOutPhrase10":"i want the regular Excel","OptOutPhrase11":"i want the old Excel","OptOutPhrase12":"old toolbar","OptOutPhrase13":"classic toolbar","OptOutPhrase14":"opt out","OptOutPhrase15":"goodbye","OptOutPhrase16":"bye","OptOutPhrase17":"leave me alone","OptOutPhrase18":"this sucks","OptOutPhrase19":"exit","OptOutPhrase20":"exit out","OptOutPhrase21":"leave beta","OptOutPhrase22":"leave experiment","OptOutPhrase23":"i want to quit","OptOutPhrase24":"i want to leave","OptOutPhrase25":"i want to opt out","OptOutPhrase26":"i want to exit","OptOutPhrase27":"i want to exit out","OptOutPhrase28":"i want to stop","OptOutPhrase29":"take me back","OptOutPhrase30":"take me back to old toolbar","OptOutPhrase31":"take me back to classic toolbar","OptOutPhrase32":"take me back to regular excel","OptOutPhrase33":"take me back to old excel","OptOutPhrase34":"old excel","OptOutPhrase35":"regular excel","HelpQueryPhrase1":"what can i say","HelpQueryPhrase2":"what else","HelpQueryPhrase3":"what else can i say","HelpQueryPhrase4":"what do i do","HelpQueryPhrase5":"what do i say","HelpQueryPhrase6":"what do i type","HelpQueryPhrase7":"commands","HelpQueryPhrase8":"show commands","HelpQueryPhrase9":"show me","HelpQueryPhrase10":"show me how to use","HelpQueryPhrase11":"tell me how to use","HelpQueryPhrase12":"tell me","HelpQueryPhrase13":"search","HelpQueryPhrase14":"help","HelpQueryPhrase15":"help me","HelpQueryPhrase16":"help me use","HelpQueryPhrase17":"how","HelpQueryPhrase18":"how do i","HelpQueryPhrase19":"how do i use","HelpQueryPhrase20":"how do I use this","HelpQueryPhrase21":"how does this work","HelpQueryPhrase22":"im confused","HelpQueryPhrase23":"what works","HelpQueryPhrase24":"what can you do","UnsupportedQueryUndoPhrase1":"undo","UnsupportedQueryUndoPhrase2":"cancel","UnsupportedQueryUndoPhrase3":"revert","UnsupportedQueryUndoPhrase4":"that\'s wrong","UnsupportedQueryUndoPhrase5":"that\'s not what I wanted","UnsupportedQueryAltTextPhrase1":"alt text","UnsupportedQueryAltTextPhrase2":"alternative text","UnsupportedQueryAltTextPhrase3":"accessible text","UnsupportedQueryAltTextPhrase4":"accessibility text","UnsupportedQueryAddCommentPhrase1":"add a comment","UnsupportedQueryAddCommentPhrase2":"add comment","UnsupportedQueryAddCommentPhrase3":"comment","UnsupportedQueryDataValidationPhrase1":"validate data","UnsupportedQueryDataValidationPhrase2":"restrict input","UnsupportedQueryDataValidationPhrase3":"add a drop down","UnsupportedQueryWorksheetPhrase1":"add a sheet","UnsupportedQueryWorksheetPhrase2":"rename the sheet","UnsupportedQueryWorksheetPhrase3":"delete the sheet","UnsupportedQueryFreezePanePhrase1":"freeze","UnsupportedQueryFreezePanePhrase2":"lock","PromptMenuSectionTable":"Work with my table","PromptMenuItemAddFormulaColumn":"Add a formula column","PromptMenuItemHighlightData":"Highlight data","PromptMenuItemAnalyzeData":"Analyze this data","PromptMenuItemSortFilter":"Sort and filter data","PromptMenuItemAnalyzeUsingPython":"Python","PromptMenuItemHowCanCopilotHelp":"How can Copilot help?","LearnMoreResponsePrefix":"I can make calculations and help you understand more about your data by working with tables to:","LearnMoreResponseLinkText":"Learn more about Copilot","LearnMoreResponseContentFirst":"Add columns that include formulas for calculating and manipulating data","LearnMoreResponseContentSecond":"Sort, filter, and apply formatting to your table to organize and highlight data","LearnMoreResponseContentThird":"Find insights like trends, summaries, and comparisons","SuggestionPillAnotherColumnSuggestion":"Give me another column suggestion","SuggestionPillCreateColumn":"Create a \'{0}\' column","SuggestionPillPromptBasedAnotherSuggestion":"Give me another suggestion based on my prompt","SuggestionPillSeeInsight":"Can I see another insight?","SuggestionPillAddInsights":"Add all insights to grid","SuggestionPillOutliers":"Are there any outliers in my data?","SuggestionPillCompareColumns":"Add a column to compare \'{0}\' and \'{1}\'","SuggestionPillBoldColumn":"Bold the first column","SuggestionPillHowMany":"How many \'{0}\' of \'{DataFromColCell-0}\'?","SuggestionPillCombineColumns":"Add a column that combines \'{0}\' and \'{1}\'","SuggestionPillHighlightHighest":"Highlight the highest values in \'{0}\'","SuggestionPillShowItems":"Show items with \'{0}\' of \'{DataFromColCell-0}\'","SuggestionPillBold":"Bold the top 10 values in \'{0}\'","SuggestionPillSortColumn":"Sort \'{0}\' from smallest to largest","SuggestionPillInsights":"Give me insights on my data","SuggestionPillUpdatedInsights":"Give me updated insights on my data","SuggestionPillInsights2":"Show data insights","SuggestionPillUpdatedInsights2":"Show updated data insights","SuggestionPillShowPivotTables":"Show PivotTables","SuggestionPillAnotherPivotTable":"Can I see another PivotTable?","SuggestionPillShowCharts":"Show charts","SuggestionPillAnotherChart":"Can I see another chart?","SuggestionPillHighlightFilterSort":"How can I highlight, filter, and sort data?","HintCardAnalyzeDataSuggestionHeader":"Find trends, summaries, and insights","HintCardAnalyzeDataSuggestionMessage1":"For example, \\"Plot sales by category over time\\"","HintCardAnalyzeDataSuggestionMessage2":"For example, \\"Show total sales for each product\\"","HintCardAnalyzeDataSuggestionMessage3":"For example, \\"Plot the total units sold by category over time\\"","HintCardAnalyzeDataSuggestionMessage4":"For example, \\"Identify the highest month for sales in 2022\\"","HintCardAnalyzeDataSuggestionMessage5":"For example, \\"Identify the lowest price for each product in 2022\\"","HintCardMoonshotSuggestionHeader":"Quickly get new data using formulas","HintCardMoonshotSuggestionMessage1":"For example, \\"Add a column that calculates profit per marketing campaign\\"","HintCardMoonshotSuggestionMessage2":"For example, \\"Add a column that calculates the number of days after the product launch\\"","HintCardMoonshotSuggestionMessage3":"For example, \\"Add a column that tells me which reviewers left notes\\"","HintCardMoonshotSuggestionMessage4":"For example, \\"Add a column that calculates the ratio of the park boundary area to the total area of each park\\"","HintCardFormatDataSuggestionHeader":"Change the data\'s format and view","HintCardFormatDataSuggestionMessage1":"For example, \\"Bold the top 10 values in the Sales column\\"","HintCardFormatDataSuggestionMessage2":"For example, \\"Highlight the highest values in Units Sold\\"","HintCardFormatDataSuggestionMessage3":"For example, \\"Hide rows that are past due\\"","HintCardFormatDataSuggestionMessage5":"For example, \\"Filter to only show products made in Canada\\"","StopGeneratingResponseTableExplain":"OK, I stopped working on your question. If you want to analyze, I only work with data in a table or range with a single header row with different column names, no empty rows or columns, consistent data formatting per column, and no subtotals.\\n\\nTry selecting data that meets the criteria or is formatted as a table (go to Insert in the ribbon, and then select Table).","FluxWorkflowCancelledMessage":"My query was cancelled.","FluxWorkflowSucceededMessage":"I succeeded in my task.","FluxWorkflowFailedMessage":"I failed in my task.","FluxWorkflowColumnRecommendation":"I suggested adding a column named {0} that uses the formula, {1}, to calculate the results.","AnalyzeDataResponseTextInsights":"Here\'s a {0} that shows an insight about your data.","AnalyzeDataResponseTextSpecificAnswer":"Here\'s a {0} based on your prompt.","AnalyzeDataResponseTextNotFullyUnderstood":"This {0} may include some of the information you\'re looking for. If it doesn\'t show everything you requested, try another prompt.","AnalyzeDataResponseTextNotFullyUnderstoodEmptyAnswer":"I looked through your data for this criteria: {0}. There were no matches. If you want to try again, use another prompt.","AnalyzeDataResponseTextEmptyAnswer":"I looked through your data for this criteria: {0}. There are no matches.","CardTypeChart":"chart","CardTypePivotChart":"PivotChart","CardTypePivotTable":"PivotTable","CardTypeFormula":"formula","MapChartType":"a Map Chart","ScatterChartType":"a Scatter Chart","ClusteredComboChartType":"a Clustered Combo Chart","StackedComboChartType":"a Stacked Combo Chart","HundredPercentComboChartType":"a Hundred Percent Combo Chart","FunnelChartType":"a Funnel Chart","TreemapChartType":"a Treemap Chart","SunburstChartType":"a Sunburst Chart","ColorFilledMapChartType":"a Color Filled Map Chart","CircularTreemapChartType":"a Circular Treemap Chart","HeatMapChartType":"a Heat Map Chart","WaterfallChartType":"a Waterfall Chart","RoseChartType":"a Rose Chart","NetworkMapChartType":"a Network Map Chart","SmoothLineChartType":"a Smooth Line Chart","ComboChartType":"a Combo Chart","LineChartType":"a Line Chart","PieChartType":"a Pie Chart","DonutChartType":"a Donut Chart","AreaChartType":"an Area Chart","StackedAreaChartType":"a Stacked Area Chart","HundredPercentStackedAreaChartType":"a Hundred Percent Stacked Area Chart","ClusteredBarChartType":"a Clustered Bar Chart","StackedBarChartType":"a Stacked Bar Chart","HundredPercentStackedBarChartType":"a Hundred Percent Stacked Bar Chart","ClusteredColumnChartType":"a Clustered Column Chart","StackedColumnChartType":"a Stacked Column Chart","HundredPercentStackedColumnChartType":"a Hundred Percent Stacked Column Chart","UndefinedChartType":"that type of chart","SampleColumnHeaderCampaignOwner":"Campaign Owner","SampleColumnHeaderCampaignName":"Campaign Name","SampleColumnHeaderLaunchDate":"Launch Date","SampleColumnHeaderCampaignType":"Campaign Type","SampleColumnHeaderBudget":"Budget","SampleColumnHeaderRevenue":"Revenue","SampleColumnHeaderTotalUsersTargeted":"Total Users Targeted","SampleColumnHeaderEngagedUsers":"Engaged Users","SampleDataTextLateJanEmail":"Late Jan Email","SampleDataTextBillboardsSmall":"Billboards small","SampleDataTextBillboardsLarge":"Billboards large","SampleDataTextProductReview3x":"Product review 3x","SampleDataTextTargetedGroup1":"Targeted - Group 1","SampleDataTextIndustryConference":"Industry Conference","SampleDataTextTargetedGroup2":"Targeted - Group 2","SampleDataTextFebEmailNorth":"Feb email - North","SampleDataTextFebEmailSouth":"Feb email - South","SampleDataTextFebEmailWest":"Feb email - West","SampleDataTextProductMention5x":"Product mention 5x","SampleDataTextDigitalMarketing":"Digital marketing","SampleDataTextBrandMarketing":"Brand marketing","SampleDataTextCustomerExperience":"Customer Experience","TableSummaryGeneralNoResults":"Sorry, I can\'t summarize this table. Try again with some different data.","TableSummaryGeneralInsertFailed":"Sorry, I couldn\'t insert the comment.","TableSummaryInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert this comment. Unprotect this sheet for a moment and try again.","CalculatedColumnsFailureGeneral":"I\'m having trouble working on prompts right now. Try sending your prompt later.","CalculatedColumnsGeneralNoResults":"I can\'t generate any column suggestions right now. Try adding more columns or rows to the table.","CalculatedColumnsNLNoResults":"I need more information to start working on your request. Use these tips to write a new request:","CalculatedColumnsNLMultipleColumns":"I can only add one column at a time. Try again with a request about one column.","CalculatedColumnsNLNoResultSuggestionIdentifyColumnAndTable":"Mention specific columns or tables you want me to use.","CalculatedColumnsNLNoResultSuggestionIdentifyColumn":"Mention specific columns you want me to use.","CalculatedColumnsNLNoResultSuggestionCreateColumn":"State specific calculations you want me to do.","CalculatedColumnsTimeout":"Something went wrong. Try your formula column request again later.","CalculatedColumnsInsertFailedDeleteConflict":"I\'m working to insert the column, but it looks like there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","CalculatedColumnsInsertFailedConflict":"I can\'t add the new column because there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","CalculatedColumnsInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert any formula columns. Unprotect this sheet for a moment and try again.","CalculatedColumnsInsertFailedTableNotFound":"I can\'t insert any formula columns because it looks like no table is selected. Double check to make sure a table is selected and try again.","CalculatedColumnsInsertFailedGeneral":"I\'m having trouble inserting formula columns right now. Try sending your prompt later.","MultipleCalculatedColumnsInsertFailedConflict":"I\'m working to insert the columns, but it looks like there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","MultipleCalculatedColumnsInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert these columns. Unprotect this sheet for a moment and try again.","MultipleCalculatedColumnsInsertFailedTableNotFound":"I couldn\'t insert the columns. Double check to make sure a table is selected.","MultipleCalculatedColumnsInsertFailedGeneral":"I couldn\'t insert the columns.","MultipleCalculatedColumnsInsertPartiallyFailedConflict":"I can\'t add some of the new columns because there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","MultipleCalculatedColumnsInsertPartiallyFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert some of these columns. Unprotect this sheet for a moment and try again.","MultipleCalculatedColumnsInsertPartiallyFailedTableNotFound":"I couldn\'t insert some of the columns. Double check to make sure a table is selected.","MultipleCalculatedColumnsInsertPartiallyFailedGeneral":"I couldn\'t insert some of the columns.","FormulaSuggestion_PreviewOnGridButton_ShowPreview":"Preview on grid","FormulaSuggestion_PreviewOnGridButton_HidePreview":"Hide from grid","FormulaSuggestion_Description_NotAvailable":"No description available.","FormulaSuggestion_Preview_NotAvailable":"No image available.","FormulaSuggestion_Preview_AriaLabel":"Table preview","CalculatedRowsInsertFailedDeleteConflict":"I\'m working to insert the row, but it looks like there may be a PivotTable, an AutoFilter applied to a data range, or another Excel table in the way. Move any objects and try again.","CalculatedRowsInsertFailedProtectedSheet":"Looks like this is a password-protected sheet. I\'m unable to insert any rows. Unprotect this sheet for a moment and try again.","CalculatedRowsInsertFailedTableNotFound":"I can\'t insert any formulas because it looks like no table is selected. Double check to make sure a table is selected and try again.","CalculatedRowsNLMultipleRows":"I can only add one formula per column at a time. Edit your prompt accordingly and try again.","CalculatedRowsNLMultipleFormulaTypes":"I can only add one formula type at a time. Try again with a request about one formula type.","CalculatedRowsTimeout":"Something went wrong. Try your request again later.","CalculatedRowsInsertFailedGeneral":"I\'m having trouble inserting rows right now. Try sending your prompt later.","CalculatedRowsConfirmationTextForCell":"Done! I inserted the formula.","CalculatedRowsConfirmationTextForRow":"Done! I inserted the formulas.","CalculatedRowsConfirmationTextForUpdateCell":"Done! I updated the formula.","CalculatedRowsConfirmationTextForUpdateRow":"Done! I updated the formulas.","CalculatedRowsConfirmationTextForCellWithAddress":"Done! I inserted the formula in {0}.","CalculatedRowsConfirmationTextForRowWithAddress":"Done! I inserted the formulas in {0}.","CalculatedRowsConfirmationTextForUpdateCellWithAddress":"Done! I updated the formula in {0}.","CalculatedRowsConfirmationTextForUpdateRowWithAddress":"Done! I updated the formulas in {0}.","LoadingUIAddingCellStep":"Inserting formula...","LoadingUIAddingCellsStep":"Inserting formulas...","LoadingUIAddingCellWithAddressStep":"Inserting formula in {0}...","LoadingUIAddingCellsWithAddressStep":"Inserting formulas in {0}...","LoadingUIAddingCellUpdateWithAddressStep":"Updating formula in {0}...","LoadingUIAddingCellsUpdateWithAddressStep":"Updating formulas in {0}...","LoadingUIGeneratingFormulaRowSuggestionsStep":"Generating formula suggestions...","LoadingUIGeneratingFormulaRowSuggestionsTLRStep":"Generating formula suggestions for {0}...","LoadingUIAddingCellWithAddressStepWithSheet":"Inserting formula in {range} on \'{sheet}\'...","LoadingUIAddingCellsWithAddressStepWithSheet":"Inserting formulas in {range} on \'{sheet}\'...","LoadingUIAddingCellUpdateWithAddressStepWithSheet":"Updating formula in {range} on \'{sheet}\'...","LoadingUIAddingCellsUpdateWithAddressStepWithSheet":"Updating formulas in {range} on \'{sheet}\'...","LoadingUIGeneratingFormulaRowSuggestionsTLRStepWithSheet":"Generating formula suggestions for {range} on \'{sheet}\'...","LoadingUIAddingCellWithAddressStepWithNamedSheet":"Inserting formula in {range} on the \'{sheet}\' sheet...","LoadingUIAddingCellsWithAddressStepWithNamedSheet":"Inserting formulas in {range} on the \'{sheet}\' sheet...","LoadingUIAddingCellUpdateWithAddressStepWithNamedSheet":"Updating formula in {range} on the \'{sheet}\' sheet...","LoadingUIAddingCellsUpdateWithAddressStepWithNamedSheet":"Updating formulas in {range} on the \'{sheet}\' sheet...","LoadingUIGeneratingFormulaRowSuggestionsTLRStepWithNamedSheet":"Generating formula suggestions for {range} on the \'{sheet}\' sheet...","CalculatedRowsShowMorePill":"Give me another row suggestion","CalculatedRowsInsertCellTitle":"Insert cell","CalculatedRowsInsertRowTitle":"Insert row","CalculatedRowsUpdateCellTitle":"Update cell","CalculatedRowsUpdateRowTitle":"Update row","CalculatedRowsFormulaSuggestionHeader":"Here\'s 1 formula to review and insert:","CalculatedRowsCellHeader":"cell {cellAddress}","CalculatedRowsSelectedCellHeader":"the selected cell","CalculatedRowsRowHeader":"row {rowNumber}","CalculatedRowsSelectedCellNothingSelected":"I\'m working to insert the formula, but it looks like no cell is selected. Select a cell and try again.","CalculatedRowsSelectedCellPivotTableSelected":"I\'m working to insert the formula, but it looks like there may be a PivotTable in the way. Select a different cell and try again.","CalculatedRowsFormulaSuggestionHeaderSingular":"Looking at {tableRange}, here\'s 1 formula to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderSingularWithSheet":"Looking at {tableRange} on \'{sheet}\', here\'s 1 formula to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderSingularWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here\'s 1 formula to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderPlural":"Looking at {tableRange}, here are {formulasLength} formulas to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderPluralWithSheet":"Looking at {tableRange} on \'{sheet}\', here are {formulasLength} formulas to review and insert in {location}:","CalculatedRowsFormulaSuggestionHeaderPluralWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here are {formulasLength} formulas to review and insert in {location}:","CalculatedRowsFormulaTotalHeader":"Total","CalculatedRowsFormulaSuggestionHeaderUpdateSingular":"Looking at {tableRange}, here\'s 1 formula to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdateSingularWithSheet":"Looking at {tableRange} on \'{sheet}\', here\'s 1 formula to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdateSingularWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet\', here\'s 1 formula to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdatePlural":"Looking at {tableRange}, here are {formulasLength} formulas to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdatePluralWithSheet":"Looking at {tableRange} on \'{sheet}\', here are {formulasLength} formulas to review and update in {location}:","CalculatedRowsFormulaSuggestionHeaderUpdatePluralWithNamedSheet":"Looking at {tableRange} on the \'{sheet}\' sheet, here are {formulasLength} formulas to review and update in {location}:","FormulaExplanation_ShowExplanationButton":"Show explanation","FormulaExplanation_HideExplanationButton":"Hide explanation","CodeSnippetWithExplanation_ExplanationButton_Show":"Show explanation","CodeSnippetWithExplanation_ExplanationButton_Hide":"Hide explanation","CodeSnippetWithExplanation_ExplanationNotAvailable":"No explanation available","CodeSnippetWithExplanation_AriaLabel":"Code snippet","TableSummaryText":"Describe my data","CalculatedColumnsGeneral":"Show suggestions for formula columns","CalculatedColumnsGeneralSingular":"Show a suggestion for a formula column","AddAsCommentText":"Add as comment","UnsupportedOperationMessage":"I\'m not able to work on that. Try a new prompt or use a suggested one for ideas.","AugloopResponseTimeoutMessage":"Sorry, I\'m having some trouble right now. Try reopening the workbook and sending your prompt again later.","AugloopErrorOTE":"I\'m still working to support other languages. For now, please try your prompt again in English.","ChatSuggestionHeader":"Here\'s what I can do with data selected in Excel tables:","ChatSuggestionAddColumns":"Add formula columns","ChatSuggestionHighlight":"Highlight","ChatSuggestionFilterAndSort":"Filter and sort","ChatSuggestionAnalyze":"Analyze","DialogSheetUnsupportedTitle":"This workbook has a dialog sheet","DialogSheetUnsupportedMessage":"I can\'t work on files that contain dialog sheets. If you delete the dialog sheet and reopen the workbook or open a workbook without a dialog sheet, I can help you explore your data.","FileLocationUnsupportedTitle":"Unsupported file location","FileLocationUnsupportedMessage":"I only work with files saved to OneDrive or Microsoft 365 SharePoint locations with AutoSave turned on. Save the file to a supported location to continue.","FileStateUnsupportedTitle":"Unsupported file state","FileStateUnsupportedMessage":"I do not currently support this type of workbook.","FileStateUnsupportedLearnMoreLinkText":"Learn more","ChatSuggestionFooterText":"Describe what you\'d like help with, or use one of the suggestions to get started.","DashboardSourceDataLabel":"PivotTable sources for charts","UndoScopeName":"Copilot Action","AugloopSessionClosedTitle":"Something went wrong","AugloopSessionClosedDesktopMessage":"Sorry, I\'m having some trouble right now. Restart Excel and try sending the prompt again.","AugloopSessionClosedWebMessage":"Sorry, I\'m having some trouble right now. Try refreshing the webpage.","ZeroQueryHeader":"Select an option to learn how I can work with your data in Excel tables:","ZeroQueryHeaderAsk":"Ask Copilot","ZeroQueryFormulaTitle":"Add formula columns","ZeroQueryFormulaMessage":"I can quickly add new columns with formulas. Select a suggested prompt, or describe what columns you\'d like to add.","ZeroQueryHighlightingTitle":"Highlight","ZeroQueryHighlightingMessage":"Need to highlight portions of data? I can help with that! Select a suggested prompt, or describe what you\'d like to highlight.","ZeroQuerySortFilterTitle":"Sort and filter","ZeroQueryFilterSortMessage":"I can sort and filter data to keep things organized. Select a suggested prompt, or describe what you\'d like to do.","ZeroQueAnalyzingTitle":"Analyze","ZeroQueAnalyzingMessage":"I can analyze data and show insights in charts and PivotTables. Select a suggested prompt, or describe what you\'d like to know.","ZeroQueryInsightsTitle":"Summarize using PivotTables or charts","ZeroQueryFormulaActionTitle":"Suggest a formula column","ZeroQueryHighlightActionTitle":"Highlight all cells with [incomplete in red]","ZeroQuerySearchTitle":"Create a table for my recent emails about [sales targets]","ZeroQueryHowToSumTitle":"How do I sum values based on [criteria]","ZeroQueryDataShapingText":"Prepare data for analysis","ZeroQueryDataShapingText2":"Prepare my data for analysis","ZeroQueryDataShapingText3":"Transform my data for analysis","ZeroQueryDataShapingText4":"Ready my data for analysis","ZeroQueryDataShapingText5":"Organize data for analysis","ZeroQueryDataShapingHeader":"Data Preparation","ZeroQuerySuggestAColumnTitle":"Suggest a column","ZeroQuerySuggestAColumnMessage":"Suggest a formula column for my data","ZeroQueryWriteAFormulaTitle":"Write a formula","ZeroQueryWriteAFormulaMessage":"Write a formula that...","ZeroQueryAddAFormulaColumnTitle":"Add a formula column","ZeroQueryAddAFormulaColumnMessage":"Add a column that...","ZeroQueryExplainAFormulaTitle":"Explain a formula","ZeroQueryExplainAFormulaMessage":"Explain this formula: [paste formula here]","ZeroQueryInvestigateErrorTitle":"Investigate error","ZeroQueryInvestigateErrorMessage":"Investigate formula error: [paste formula here]","ZeroQuerySplitColumnsTitle":"Split columns","ZeroQuerySplitColumnsMessage":"Write a formula that creates new columns by splitting [column A]","ZeroQueryCombineColumnsTitle":"Combine columns","ZeroQueryCombineColumnsMessage":"Combine [column A and B] with a space","ZeroQueryCreateTotalRowTitle":"Create a total row","ZeroQueryCreateTotalRowMessage":"Create a row that calculates column [averages]","ZeroQueryWriteLookupFormulaTitle":"Write a lookup formula","ZeroQueryWriteLookupFormulaMessage":"Write a formula that combines two tables together by matching [product ID]","ZeroQueryGetDataInsightsTitle":"Get data insights","ZeroQueryGetDataInsightsMessage":"Give a unique data insight using Python","ZeroQueryGetDataInsightsAnswersMessage":"Give a unique insight using Python","ZeroQueryAdvancedAnalysisTitle":"Advanced analysis","ZeroQueryAdvancedAnalysisMessage":"Get deeper analysis results using Python","ZeroQueryEditPythonCodeTitle":"Edit Python code","ZeroQueryEditPythonCodeMessage":"Edit this Python code","ZeroQueryPerformForecastingTitle":"Perform forecasting","ZeroQueryPerformForecastingMessage":"Perform forecasting using Python","ZeroQueryCreateBoxplotTitle":"Create a boxplot","ZeroQueryCreateBoxplotMessage":"Create a boxplot of this data using Python","ZeroQuerySetOfChartsTitle":"Set of charts","ZeroQuerySetOfChartsMessage":"Create a set of charts using Python","ZeroQueryGenerateWordCloudTitle":"Generate a word cloud","ZeroQueryGenerateWordCloudMessage":"Generate a word cloud using Python","ZeroQueryCreateATableTitle":"Create a table","ZeroQueryCreateATableMessage":"Create a table comparing planets","ZeroQueryKeyboardShortcutsTitle":"Keyboard shortcuts","ZeroQueryKeyboardShortcutsMessage":"What are 15 intermediate level shortcuts?","ZeroQueryTipsAndTricksTitle":"Tips and tricks","ZeroQueryTipsAndTricksMessage":"What are some tricks for working with dates?","ZeroQueryFreezeColumnTitle":"Freeze column","ZeroQueryFreezeColumnMessage":"How do I freeze one column while scrolling?","ZeroQueryHowDoITitle":"How do I?","ZeroQueryHowDoIUnpivotMessage":"How do I unpivot a table?","ZeroQueryHowDoIDropdownMessage":"How do I create a dropdown menu?","ZeroQueryHowDoIFormulaMessage":"How do I write a formula that [forecasts sales]","ZeroQuerySummarizeColumnTitle":"Summarize column","ZeroQuerySummarizeColumnMessage":"Summarize [column A] in bullet points","ZeroQueryShowDataInsightsTitle":"Show data insights","ZeroQueryShowDataInsightsMessage":"Show a data insight","ZeroQuerySumByCategoryTitle":"Sum by category","ZeroQuerySumByCategoryMessage":"Sum [total revenue] for each [category]","ZeroQueryCreatePivotTableTitle":"Create a PivotTable","ZeroQueryCreatePivotTableMessage":"Create a PivotTable grouped by [category]","ZeroQueryCreatePieChartTitle":"Create a pie chart","ZeroQueryCreatePieChartMessage":"Create a pie chart for my data","ZeroQueryGenerateAGraphTitle":"Generate a graph","ZeroQueryGenerateAGraphMessage":"Generate a graph of [x against y]","ZeroQueryHighlightDuplicatesTitle":"Highlight duplicates in a column","ZeroQueryHighlightDuplicatesMessage":"Highlight duplicates in [column A]","ZeroQueryHighlightCellsTitle":"Highlight cells in the table","ZeroQueryHighlightCellsMessage":"Highlight cells in the table that are [complete]","ZeroQueryApplyColorCodingTitle":"Add a color scale to a column","ZeroQueryApplyColorCodingMessage":"Add a color scale to [column A]","ZeroQueryWebSearchCreateTableTitle":"Find financial data","ZeroQueryWebSearchCreateTableMessage":"Search the web for the top 10 stocks in the S&P 500 and their current market cap in a table format.","ZeroQueryWebSearchTravelTitle":"Create a travel itinerary","ZeroQueryWebSearchTravelMessage":"Search the web for an itinerary for a month trip to Europe in a table format","ZeroQueryWebSearchLearnTitle":"Learn in table form","ZeroQueryWebSearchLearnMessage":"Search the web for a list of 15 intermediate level vocabulary words in Spanish and their translations","ZeroQueryImportTableTitle":"Import table from file","ZeroQueryImportTableMessage":"Import the table from /[file]","ZeroQueryPrepareForMeetingsTitle":"Prepare for my meetings","ZeroQueryPrepareForMeetingsMessage":"Show me next week\'s meetings and to-do items in a table format","ZeroQueryRecapEmailsTitle":"Recap emails","ZeroQueryRecapEmailsMessage":"List yesterday\'s emails in a table, with sender, subject and importance","FluxWorkflowColumnRecommendationPrefix":"I suggested adding a column named {0} that uses the formula,","FluxWorkflowColumnRecommendationSuffix":", to calculate the results.","FluxWorkflowColumnsRecommendation":"I suggested adding the column named {columnName}, that uses the formula {formula}, to the column location {columnLocation} to calculate the results.","FluxWorkflowColumnsNoLocationsRecommendation":"I suggested adding the column named {columnName}, that uses the formula {formula}, to calculate the results.","FluxWorkflowMultipleColumnsRecommendation":"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to the column locations {columnLocations} to calculate the results.","FluxWorkflowMultipleColumnsNoLocationsRecommendation":"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to calculate the results.","ErrorScreenHeader":"We ran into an error.","ErrorScreenInstruction":"Please reopen the Copilot pane to try again.","ErrorScreenReopenButton":"Reopen","CommandingUndoWarningSuffix":"Do you want me to continue?","CommandingUndoWarningActionListHeader":"I am about to perform the following actions that cannot be undone by clicking \\"Undo\\":","CommandingUndoWarningConfirm":"Yes","CommandingUndoWarningReject":"No","CommandingExplanationPrefix":"Done! These are the steps I took:","OfficeJSResponseExplain":"Explain Result","OfficeJSErrorExplanationPrefix":"I couldn\'t complete that task, but here\'s what I tried to do:","OfficeJSExplanationPrefix":"I took the following actions to create the result:","OfficeJSSimpleSuccessResponse":"Done! What else can I help you with?","CopilotLicenseHelpPrefix":"We encountered a problem validating your Copilot license. For more information, see ","CopilotLicenseHelpHeader":"Validate your Copilot License","OfficeScriptRunScriptSuccessPrefix":"I\'ve successfully run \'{0}\' which performed the following steps:","OfficeScriptRunScriptFailPrefix":"I wasn\'t able to successfully run script \'{0}\'.","OfficeScriptSaveScriptSuccessPrefix":"Done! I just saved a script that does the following:","OfficeScriptSaveScriptFailPrefix":"Something went wrong while saving your script.","PromptGuideMenuTitle":"Prompts","PromptGuideMenuSelectionCreate":"Create formulas","PromptGuideMenuSelectionUnderstand":"Understand","PromptGuideMenuSelectionEdit":"Apply color and formatting","OfficeScriptSaveScriptFailPrefixAsk":"Ask","PromptGuideViewMorePrompts":"View more prompts","PromptGuideMenuSectionItemGenerateFormulaColumnSuggestion":"Generate a formula column suggestion","PromptGuideMenuSectionItemAddAColumnThatCombines":"Add a column that combines [the customer\'s first and last name]","PromptGuideMenuSectionItemAddAColumnToExtract":"Add a column to extract [the month from the date]","PromptGuideMenuSectionItemAddAColumnThatCalculates":"Add a column that calculates [the profit per order]","PromptGuideMenuSectionItemShowDataInsights":"Show insights about the data","PromptGuideMenuSectionItemPercentageCalculation":"What is the percentage of [total revenue from each region?]","PromptGuideMenuSectionItemHowManyDifferent":"How many different [teams are represented in this table]","PromptGuideMenuSectionItemWhichItems":"Which items [have the most remaining inventory?]","PromptGuideMenuSectionItemHighlight":"Highlight the [lowest 5 budgets]","PromptGuideMenuSectionItemSort":"Sort [engaged users from smallest to largest]","PromptGuideMenuSectionItemFilter":"Filter by [items from this month]","PromptGuideMenuSectionItemApplyRYG":"Apply a red-yellow-green color scale to [the \'Total\' column]","PromptGuideMenuSectionItemHelp":"How can Copilot help?","MicrophonePermissionErrorTitleWeb":"No Microphone Permission","MicrophonePermissionErrorTextWeb":"Copilot can\'t access your microphone. Click the lock icon in the browser address bar above, set your permissions to allow microphone access, and then try again.","MicrophonePermissionErrorTitleWin32":"Oops, unable to capture your audio","MicrophonePermissionErrorTextWin32":"There is a problem with your microphone. Please check your microphone permission settings.","CommandingFinishedResponseHeader":"Done! I made the following changes:","CommandingHumanInTheLoopApplyingChangesMessage":"Applying changes in {range}...","CommandingHumanInTheLoopApplyingChangesMessageWithSheet":"Applying changes in {range} on \'{sheet}\'...","CommandingHumanInTheLoopApplyingChangesMessageWithNamedSheet":"Applying changes in {range} on the \'{sheet}\' sheet...","CommandingHumanInTheLoopSingleChangeResponseMessage":"Done! I made the change in {0}.","CommandingHumanInTheLoopSingleChangeResponseMessageWithSheet":"Done! I made the change in {range} on \'{sheet}\'.","CommandingHumanInTheLoopSingleChangeResponseMessageWithNamedSheet":"Done! I made the change in {range} on the \'{sheet}\' sheet.","CommandingHumanInTheLoopMultipleChangesResponseMessage":"Done! I made the changes in {0}.","CommandingHumanInTheLoopMultipleChangesResponseMessageWithSheet":"Done! I made the changes in {range} on \'{sheet}\'.","CommandingHumanInTheLoopMultipleChangesResponseMessageWithNamedSheet":"Done! I made the changes in {range} on the \'{sheet}\' sheet.","CommandingHumanInTheLoopSingleChangeNoRangeResponseMessage":"Done! I made the change.","CommandingHumanInTheLoopMultipleChangesNoRangeResponseMessage":"Done! I made the changes.","CommandingHumanInTheLoopSingleEventHeader":"Sure! Looking at {0}, heres 1 change to review and apply:","CommandingHumanInTheLoopMultipleEventsHeader":"OK! Looking at {0}, here are {1} changes to review and apply:","CommandingHumanInTheLoopSingleCFEventHeader":"Sure! Looking at {0}, here\'s 1 conditional formatting rule to review and apply:","CommandingHumanInTheLoopMultipleCFEventsHeader":"OK! Looking at {0}, here are {1} conditional formatting rules to review and apply:","CommandingHumanInTheLoopSingleEventHeaderWithSheet":"Sure! Looking at {range} on \'{sheet}\', heres 1 change to review and apply:","CommandingHumanInTheLoopMultipleEventsHeaderWithSheet":"OK! Looking at {range} on \'{sheet}\', here are {numChanges} changes to review and apply:","CommandingHumanInTheLoopSingleCFEventHeaderWithSheet":"Sure! Looking at {range} on \'{sheet}\', here\'s 1 conditional formatting rule to review and apply:","CommandingHumanInTheLoopMultipleCFEventsHeaderWithSheet":"OK! Looking at {range} on \'{sheet}\', here are {numChanges} conditional formatting rules to review and apply:","CommandingHumanInTheLoopSingleEventHeaderWithNamedSheet":"Sure! Looking at {range} on the \'{sheet}\' sheet, heres 1 change to review and apply:","CommandingHumanInTheLoopMultipleEventsHeaderWithNamedSheet":"OK! Looking at {range} on the \'{sheet}\' sheet, here are {numChanges} changes to review and apply:","CommandingHumanInTheLoopSingleCFEventHeaderWithNamedSheet":"Sure! Looking at {range} on the \'{sheet}\' sheet, here\'s 1 conditional formatting rule to review and apply:","CommandingHumanInTheLoopMultipleCFEventsHeaderWithNamedSheet":"OK! Looking at {range} on the \'{sheet}\' sheet, here are {numChanges} conditional formatting rules to review and apply:","AnalyzeDataTooLargeError":"This table has over two million cells of data, which is too large for me to analyze. Select a table with less data and try again.","AnalyzeDataTooLargeErrorFourMillion":"This table has over four million cells of data, which is too large for me to analyze. Select a table with less data and try again.","AnalyzeDataCardHeader":"I analyzed data in {0}, and here\'s what I found:","AnalyzeDataCardHeaderWithSheet":"I analyzed data in {range} on \'{sheet}\', and here\'s what I found:","AnalyzeDataCardHeaderWithNamedSheet":"I analyzed data in {range} on the \'{sheet}\' sheet, and here\'s what I found:","GroundingSourcePrefix":"Using ","GroundingWithDocument":"This workbook","GroundingWithDocumentLabel":"Using this workbook","GroundingWithDocumentDescription":"Ask questions and work with data in a table","GroundingWithEnterpriseData":"Your organization\'s data","GroundingWithEnterpriseDataLabel":"Using your organization\'s data","GroundingWithEnterpriseDataDescription":"Ask questions regarding people and files across your organization","GroundingWithEnterpriseDataDescriptionV2":"Unrelated to working with data in a table, ask questions regarding people and files across your organization.","GroundingSourceInformationTooltip":"In addition to answering general questions, Copilot can respond to requests that pertain either to this workbook or to organizational data, such as files and people\'s contact info.","GroundingSourceInformationTooltipV2":"For general questions and working on your content, use \\"this workbook\\". For questions that pertain to your organization, not related to creating or editing content, use \\"your organization\'s data\\".","GroundingDocToWorkModeSwitchMessage":"I\'m using your organization\'s data to respond to you. Ask me questions regarding people and files across your organization. Note that I won\'t be able to work with your content while I\'m in this mode.","GroundingWorkToDocModeSwitchMessage":"I\'m using this workbook and general knowledge to respond to you. Ask me questions and make requests for working with your data.","PythonInsertCodeActiveSheetButtonText":"Insert","PythonInsertAllCodeActiveSheetButtonText":"Insert all","PythonInsertCodeNewSheetButtonText":"Insert in new sheet","PythonInsertProtectedSheetErrorText":"Looks like this is a password-protected sheet and Python in Excel can\'t automatically insert code into the sheet. Remove the password and try again, but we recommend adding the password back to keep this sheet protected when you\'re done.","PythonInsertProtectedSheetInstructionText":"{0} Unprotect this sheet and try inserting the code again.","PythonLicensingErrorText":"You need to have an active license to use Python in Excel.","PythonPlatformErrorText":"Sorry, Python isnt supported on this platform. Use another platform and try again.","PythonSelectedTableErrorResponseText":"Sorry, I cannot do that. Please select a table you want to work with.","PythonCodeCardBodyText":"Here\'s the Python code you can use:","PythonDataFrameSnippetBodyText":"First, create a DataFrame with your data.","PythonCodeSnippetBodyText":"Then, use this code.","PythonDataFrameCopySuccessText":"Copied! Paste the code in any cell to create a DataFrame.","PythonCodeInsertNewSheetSuccessText":"Done! The code was inserted in a new sheet.","PythonDataFrameAndCodeInsertNewSheetSuccessText":"Done! The DateFrame and code was inserted in a new sheet.","PythonDataFrameAndCodeInsertSameSheetSuccessText":"Done! The DataFrame and code were inserted.","PythonCodeInsertSameSheetSuccessText":"Done! The code was inserted.","PythonCodeCopySuccessText":"Copied! Paste the code in any cell below the selected Python cell.","PythonDataFrameCodeExplanationText":"We create a DataFrame in a variable referencing the Excel table using the xl() function.","PythonGenericErrorText":"Sorry, I\'m having trouble working on this request. Try a new prompt or view the suggested ones for ideas.","PythonDataFrameCodeComment":"Import data into a DataFrame","PythonRestartRuntimeErrorText":"The Python runtime is having issues. In order for me to continue working on your question, go to **Formulas** in the ribbon, and then select **Reset runtime**.","PythonRestartRuntimeFormulaCommandText":"Formulas","PythonRestartRuntimeResetCommandText":"Reset","PythonRestartRuntimeResetRuntimeCommandText":"Reset Runtime","PythonLoadingStartAnalysis":"Starting the analysis...","PythonAugloopCallsPerQueryMaximumHitErrorText":"I\'ll pause for now. Let me know if you want me to share more, or work on another prompt.","PythonAugloopResponseTimeoutMessage":"I\'m having trouble working on prompts right now. Try sending your prompt later.","ChatPlaceholderMessagePythonMode":"Type a message for advanced analysis","SuggestionPillPythonAAText":"Get deeper results using advanced analysis mode","ZeroQueryPythonTitle":"Get deeper analysis results using Python","ZeroQueryPythonHeader":"Advanced analysis","StopGeneratingResponsePythonMode":"OK, I stopped working on your question.","PrePythonModeErrorText":"I\'m having trouble running an advanced analysis. Try your prompt again or try another one.","PythonSelectTableOrPythonCellErrorText":"Looks like an empty grid cell was selected. In order to answer your question, select a range or a Python cell and try your question again.","PythonStartAnalysisEditModeErrorText":"Excel is in cell-editing mode. To start advanced analysis, exit the mode by selecting **Enter** or **Tab** and try your prompt again.","PythonGenericEditModeErrorText":"Excel is in cell-editing mode. To continue the analysis, exit the mode by selecting **Enter** or **Tab** and try your prompt again.","PythonBusyStateErrorText":"Python formulas are still calculating. Wait a moment and try again.","PythonAnalysisSheetWasDeletedDuringGenerationErrorText":"It looks like the sheet was deleted while I was generating code. Please send your question again or send a new one to continue.","PythonCodeRetryMaximumHitErrorText":"I\'m having trouble with this Python code, and I can\'t correct it after trying multiple times. You can tell me to try again or use another prompt.","PythonGeneralErrorTextWithLink":"An error happened with the Python cell that\'s not #PYTHON or #CONNECT. To resolve this issue, review some troubleshooting tips before trying again. {0}.","PythonGeneralErrorLinkText":"View troubleshooting tips","PythonNoSuggestionGenericErrorText":"I\'m having trouble working on this request. Try a new prompt or view the suggested ones for ideas.","PythonCodeRetryResponseText":"A #PYTHON error occurred while I tried to execute the code. I\'m generating new code to continue with the analysis.","PythonCodeRetryResponseWithAddressText":"A {0} error occurred while I tried to execute the code in **{1}**. I\'m generating new code to continue with the analysis.","PythonCodeDefaultErrorMessage":"An error occurred while I tried to execute the code. I\'m generating new code to continue with the analysis.","PythonStartAnalysisFirstBulletText":"Create a new sheet for the results","PythonStartAnalysisFirstBulletTextWithExistingSheet":"Use the existing sheet \'{sheet}\' for the results","PythonStartAnalysisSecondBulletText":"Automatically write and insert Python formulas","PythonStartAnalysisThirdBulletText":"Answer your prompt in multiple messages","PythonStartAnalysisFourthBulletText":"Calculate formulas, even in manual calculation mode","PythonStartAnalysisButtonText":"Start advanced analysis","PythonExistAnalysisConfirmationText":"OK, I stopped the advanced analysis.","PythonStartAnalysisRAIErrorText":"I can\'t start advanced analysis for the data in this sheet. Use another data set or Excel workbook and try again.","PythonErrorTryAgainSuggestionPillText":"Try again","PythonAnalysisSheetNameText":"Analysis","PythonAnalysisSheetHeaderText":"Advanced analysis","PythonAnalysisSheetDescriptionText":"This sheet will include all the Python formulas generated by Copilot.","PythonAnalysisSheetWasDeletedBeforeGenerationText":"It looks like the sheet was deleted or changed. I made a new one to continue the advanced analysis.","PythonPostviewHeaderText":"Here\'s what I inserted in {0}:","PythonPostviewLoadingHeaderText":"Here\'s what I\'m loading in {0} to run the analysis:","PythonPostviewNotSupportedText":"Sorry, results for this Python cell aren\'t supported.","PythonCodeButtonRoleDescription":"Button","PythonLabelFallbackText":"Python code","PythonDataframeLabelText":"Load data from {0}, {1}","PythonDataframeCodeExplanationText":"The code loads data from {0}, {1}","PythonPreviewLabelText":"Preview","PythonSuggestMoreIdeasPill":"Suggest more ideas","PythonWhatElseCanIDoPill":"What else can I do?","PythonRunningCodeText":"Running code...","PythonStartAnalysisFooterText":"Ready to get started?","PythonStartAnalysisHeaderTextFirst30s":"I can use advanced analysis for that. Here\'s what I\'ll do once you start the analysis:","PythonStartAnalysisButtonTextFirst30s":"Start advanced analysis","PythonAnalysisSheetHeaderTextFirst30s":"Analysis Sheet","PythonDetailSheetNameText":"Detail","PythonInsertToSheetButtonText":"Insert to sheet","PythonInsertDataConfirmationMessage":"Done! I added to {0}.","PythonAddResultsToAnotherSheetConfirmationText":"Done! I added the results to {0}.","PythonGoBackToAnalysisSheetButtonText":"Go back to analysis sheet","PythonAddResultsToAnotherSheetErrorText":"I\'m having trouble inserting your results into the sheet. Try again later.","PythonAddResultsToAnotherSheetButtonText":"Add results to new sheet","PythonDataframeTeachingCalloutHeaderText":"Reference with DataFrames","PythonDataframeTeachingCalloutBodyText":"When asking for deeper analysis with Python, Copilot references your original, source data in a DataFrame  never changing it. Any edits you make to the source data will be synced to analysis results.","PythonRowsText":"{0} rows","PythonColumnsText":"{0} columns","PythonBlankText":"(Blank)","PythonUnknownText":"UNKNOWN","PythonCellsStartAnalysisError":"I\'m having trouble loading all existing Python cells, so results may be less accurate.","PythonWorkbookLostFocusError":"Looks like another workbook has been opened. To continue working on your question, stay in this workbook before changing to another one.","PythonCellsCalculatingLoadingText":"Calculating Python formulas...","PythonLookingAtFormulasText":"Looking at Python formulas in this workbook...","PythonThinkDeeperButtonTitleText":"Think Deeper","PythonThinkDeeperButtonTooltipText":"Use advanced reasoning (~30sec)","PythonThinkDeeperStartAnalysisButtonText":"Start","PythonStartWithThinkDeeperButtonText":"Start with Think Deeper","PythonThinkDeeperStartingText":"With Think Deeper, I take longer to respond with more in-depth answers for complex tasks.","PythonPostviewImageUnavailableText":"This Python formula was deleted, so the results are no longer available.","PythonFormulaText":"Python formula","PythonFormulaSecondaryText":"Results will update when data referenced is changed.","PythonShowAnalysisText":"Show analysis","PythonHideAnalysisText":"Hide analysis","PythonOutputText":"Output:","PythonExecutionBlockedByAdminText":"Sorry, I cant complete the action. This action may be blocked by your administrator.","PythonTableExpand":"Expand","PythonTableCollapse":"Collapse","PythonAugloopLlmLoopLimitHitMessage":"I\'ll pause for now. Let me know if you want me to share more, or work on another prompt.","PythonElseFallbackMessage":"I\'m having trouble working on this answer. I\'ll try a different approach now.","PythonLargeDataMessage":"My answer is too long to show here in the chat. I\'ll try to summarize it for you.","ImportDataCardHeaderMultipleTables":"Here are {0} tables to import. You can refresh the imported data to see the latest updates in the source file:","ImportDataCardHeaderSingleTable":"Here\'s 1 table to import. You can refresh the imported data to see the latest updates in the source file:","ImportDataCardHeaderFallbackShowAll":"I am unable to find relevant tables to import, here are all the tables from the referred files that you can import:","ImportDataCardHeaderSomeFiltered":"I found relevant tables within the search results that you can import.\\nPlease note that I was not able to process some of the files.","ImportDataStaticSuggestionPillText":"Show tables import options for Excel files","ImportDataStaticSuggestionButtonText":"Show tables to import","ImportDataLoadQueryAddedToDocumentMessageText":"The table has been imported!\\nTo see the latest information, refresh your imported data by selecting \'Data\' in the ribbon, and then \'Refresh\'. ","ImportDataLoadQueryAddedToDocumentMessageNoBindingText":"Import request sent.\\nOnce the table is in the sheet, you can refresh the imported data to get the latest information.                         ","ImportDataShowImportQuery":"Show import query","ImportDataHideImportQuery":"Hide import query","ImportDataImportToNewSheet":"Import to new sheet","ImportDataSuccessButtonText":"Import requested","ImportDataQuerySnippetTitle":"Import query","ImportDataCaruselText":"{0} of {1}","ImportDataCaruselNext":"Next","ImportDataCaruselPrevious":"Previous","ImportDataExcelFileTooltip":".xlsx file","ImportDataNoTableFoundMessageText":"No tables from the cited files could be imported into the workbook. Open the cited files to manually import the data","ImportDataNoTableFoundAndSomeFilteredMessageText":"No tables from the cited files could be imported into the workbook.\\nPlease note that I was not able to process some of the files.\\n\\n You can open the cited files to manually import the data.","ImportDataFailureGeneralMessageText":"Sorry, something went wrong. Try your request again later.","ImportDataFailureNoAuthRefreshText":"Unfortunately, table refresh requests are not currently available on our web app. Please try again later or use our desktop app.","ImportDataShortFailureMessageText":"The table couldn\'t be imported.\\nTry again a bit later.","ImportDataPrepareImportOptions1":"Generating table previews...","ImportDataPrepareImportOptions2":"Almost there...","ImportDataToGridOption1":"Importing table...","ImportDataQueryExplanation":"This query imports data from the selected table to your workbook","LearnMoreLinkText":"Learn more","CommandingTellMeHeader1":"OK, here\'s how:","CommandingTellMeSuggestion1":"To highlight the data, try \\"Bold the top 10 values in the Sales column\\"","CommandingTellMeSuggestion2":"To filter and sort, try \\"Filter to items that are due next week\\"","CommandingTellMeHeader2":"Here are more things you can do:","CommandingTellMeSuggestion3":"To edit table properties, try \\"Add a Total row\\"","CommandingTellMeSuggestion4":"To adjust the number formatting, try \\"Show the Sales column in currency format\\"","CseSelfHelpSkillSourceLabel":"Excel Help","ShowPopupMessage":"Your Microsoft 365 account needs to be verified, but your browser settings are blocking this action. Select {0} to continue.","ShowPopupButton":"Verify","TableUsesTooMuchMemoryError2":"I can\'t work on this question because the content in the table exceeds the maximum memory load. Reduce the amount of content such as formulas, columns, or rows, and try again. You can also select another table with less content before retrying.","ElseFormulaBlocksError":"I\'m not able to do that. Try another request or use a suggested prompt.","ElseSecurityBlockedFormulaError":"A formula containing the {FunctionName} function won\'t be generated for this prompt to protect your privacy. Use another prompt and I\'ll try to help.","ElseExternalWorkbookFormulaError":"A formula containing external references to other Excel workbooks won\'t be generated for this prompt. Use another prompt and I\'ll try to help.","ElseSkillGeneralError":"I\'m having trouble answering your question right now. Try again later.","FallbackSkillLatencyMessage":"Still working on suggestions...","AugLoopSearchAndActionError":"I can\'t yet make changes that leverage information from your organization/from the web.","AugLoopSearchAndActionErrorImproved":"I can\'t yet make changes that leverage information from your organization/from the web, but here\'s some information that might help: ","AugLoopNoTableError":"I couldn\'t find a table or data range that answers your question. I only work with data in a table or range with a single header row with different column names, no empty rows or columns, consistent data formatting per column, and no subtotals.\\n\\nTry selecting data that meets the criteria or is formatted as a table (go to Insert in the ribbon, and then select Table).","AugLoopNoTableError2":"I couldn\'t find a table or data range that answers your question. I only work with data in a table or range with a single header row with different column names, no empty rows or columns, consistent data formatting per column, and no subtotals.\\n\\nTry selecting data that meets the criteria or is formatted as a table (go to **Insert** in the ribbon, and then select **Table**).","AugLoopImageChatError":"I can\'t yet use images for this request.","TabularRangeUnrecognizedTableError":"I can\'t identify the structure of the data range starting in **{range}**. Double check to ensure the range has a single row of headers on top. If the range meets the criteria, select the entire range. Then, go to **Insert** in the ribbon and select **Table**.","TabularRangeUnrecognizedTableDueToWorkbookSizeError":"Looks like this file has over one million cells or exceeds the amount of content I can work with. Try converting the data range to an Excel table or reducing the content in the workbook and reopen Excel.","TabularRangeRowMajorSingleError":"The headers in data range **{range}** should be in columns, as a single row on top of the data. Ask me how to use the TRANSPOSE() function to switch the format from columns to rows.","TabularRangeRowMajorMultipleError":"The headers should be in columns, as a single row on top of the data. Make sure all headers have different names. To quickly switch the format to columns and rows, ask me how to use the TRANSPOSE() function.","TabularRangeRowMajorErrorHeader":"Place headers in columns","TabularRangeMergedCellsSingleError":"There are merged cells in the data range **{range}**, but data in those cells won\'t be included in my answer. To get accurate results, follow these quick steps:\\n- Go to **Home** in the ribbon, and then select **Merge and Center** to choose the option to unmerge cells.\\n- Copy and paste the data into the unmerged cells.","TabularRangeMergedCellsMultipleError":"There are merged cells in the data range, but data in merged cells won\'t be included in my answer. To get accurate results, follow these quick steps:\\n- Go to **Home** in the ribbon, and then select **Merge and Center** to choose the option to unmerge cells.\\n- Copy and paste the data into the unmerged cells.","TabularRangeMergeCellsErrorHeader":"Unmerge cells","TabularRangeAggregationsSingleError":"It looks like the data range **{range}** may have subsections. I only work with ranges that have a single total row at the bottom, not ones with subtotals or grouped rows. Remove the grouped rows and subtotals and try again.","TabularRangeAggregationsMultipleError":"There may be subsections in the data range. Remove the grouped rows and subtotals.","TabularRangeAggregationsErrorHeader":"Remove grouped rows and subtotals","TabularRangeMultipleHeaderRowsSingleError":"The data range **{range}** has more than one row of headers. I only work with data ranges that have a single row of headers. Consolidate the headers into a single row and try your question again.","TabularRangeMultipleHeaderRowsMultipleError":"There are more than one row of headers. I only work with data ranges that have a single row of headers. Consolidate the headers into a single row.","TabularRangeMultipleHeaderRowsErrorHeader":"Consolidate headers into a single row","TabularRangeNoHeaderColumnsSingleError":"There are no headers in the data range **{range}**. Create a row of headers with different names on the top of the data range and try your question again.","TabularRangeNoHeaderColumnsMultipleError":"There are no headers. Create a row of headers with different names on the top of the data range.","TabularRangeNoHeaderColumnsErrorHeader":"Create a row of headers","TabularRangeInterpretationConfidenceSingleError":"I can\'t identify the structure of the data range starting in **{range}**. Double check to ensure the range has a single row of headers on top. If the range meets the criteria, select the entire range. Then, go to **Insert** in the ribbon and select **Table**.","TabularRangeInterpretationConfidenceMultipleError":"I can\'t identify the structure of the data range. Double check to ensure the range has a single row of headers on top. If the range meets the criteria, select the entire range. Then, go to **Insert** in the ribbon and select **Table**.","TabularRangeInterpretationConfidenceErrorHeader":"Check data structure","TabularRangeEmptyHeadersSingleError":"It looks like some of the headers in the data range **{range}** have empty cells. Make sure all columns have header names and are different before trying your question again. If the range already meets the criteria, select the entire range. Then, go to **Insert** and select **Table**.","TabularRangeEmptyHeadersMultipleError":"It looks like some of the headers have empty cells. Make sure all columns have header names.","TabularRangeEmptyHeadersErrorHeader":"Add header names","TabularRangeDuplicateHeadersSingleError":"It looks like there are headers with identical names in the data range **{range}**. Review and add different header names to each column before trying your question again.","TabularRangeDuplicateHeadersMultipleError":"It looks like there are headers with identical names. Review and add different header names to each column.","TabularRangeDuplicateHeadersErrorHeader":"Add different headers","TabularRangeCrosstabSingleError":"In the data range **{range}**, there are headers in rows and columns. Modify the range to have a single row of headers on top of the data or select another range that fits the criteria before trying your question again. If the range already meets the criteria, select the entire range. Then, go to **Insert** and select **Table**.","TabularRangeCrosstabMultipleError":"There are headers in rows and columns. Modify the range to have a single row of headers on top of the data or select another range that fits the criteria.","TabularRangeCrosstabErrorHeader":"Modify headers to be in a single row","TabularRangeMultipleErrorCardIntro":"In order to answer your question, the data range **{range}** needs some revisions:","TabularRangeMultipleErrorCardConclusion":"Once you\'ve made the recommended changes, try your question again.","TabularRangeMultipleErrorCardConvertToTableConclusion":"If the range already meets the criteria, select the entire range. Then, go to **Insert** and select **Table**. Once you\'ve made the recommended changes, try your question again.","SuggestionPillConditionalFormatting":"Suggest conditional formatting","ConditionalFormattingSuggestionResponse":"Okay! Here are some conditional formatting suggestions for data in {0}","ConditionalFormattingSuggestionResponseWithSheet":"Okay! Here are some conditional formatting suggestions for data in {range} on \'{sheet}\'","ConditionalFormattingSuggestionResponseWithNamedSheet":"Okay! Here are some conditional formatting suggestions for data in {range} on the \'{sheet}\' sheet","ConditionalFormattingSuggestionResponseError":"Sorry, something went wrong. Try asking for conditional formatting suggestions again later.","ConditionalFormattingSuggestionResponseNoTable":"Sorry, I can\'t find the data I need to generate conditional formatting suggestions. Try selecting the table with your data, then asking for conditional formatting suggestions again.","ConditionalFormattingSuggestionResponseNoSuggestion":"Sorry, I have no suggestions at this time. Try suggest conditional formatting again later.","ConditionalFormattingSuggestionResponseNoSuggestionForRange":"Sorry, I don\'t have any conditional formatting suggestions for data in {0}. Try adding more data or selecting a different table, then asking for conditional formatting suggestions again.","UnsupportedConditionalFormatEntityRangeText":"I\'m sorry, but I can only apply formatting to rows or columns within tables. Try asking me to apply formatting to the whole table instead.","ConditionalFormatFormulaInvalidErrorText":"Sorry, I can\'t create that conditional format rule right now. Is there anything else I can help you with?","ODSLGeneralError":"Sorry, I can\'t do that right now. Try again or select a suggestion.","VariableCacheEntityTypeMismatched":"Sorry, I can\'t modify the entity. Make sure the correct entity is selected and try again.","MultipleEventsExecutionErrorText":"I couldn\'t finish your request. If something isn\'t right, use Undo to remove my changes.","ColumnRowOutOfBoundaryErrorText":"I\'m not able to make changes in those cells because they\'re outside of the Excel Table. Try making changes to cells inside of the Excel Table.","UnsupportedCommandIntroductionText":"I need more practice before I can do that. For now, I\'ll share the steps you can follow.","SelectedColumnRowErrorText":"I don\'t currently have a way to know which cells you selected. Please specify the cells, columns, or rows you want me to work with.","ClearSortErrorText":"Sorry, I can\'t remove sorting from the table. Please tell me how you\'d like to sort the table, or make a new request.","NoSupportedNumberFormatCategoriesNumberErrorText":"Sorry, I can\'t apply conditional formatting to this range. Make sure it includes accounting, currency, fraction, number, percentage, or scientific formatting and try again.","NoSupportedNumberFormatCategoriesDateErrorText":"Sorry, I can\'t apply conditional formatting to this range. Make sure it includes a date or time format and try again.","NoSupportedNumberFormatCategoriesTextErrorText":"Sorry, I can\'t apply conditional formatting to this range. Make sure it includes a text, special, date, or time format and try again.","NoSupportedNumberFormatCategoriesOtherErrorText":"Sorry, I can\'t apply conditional formatting to this range. Remove any general, custom, or text formatting for the range and try again.","NumericFilterOnNonNumberErrorText":"Sorry, I can\'t apply a numeric filter (greater than, less than, between, or their negations) to a column that\'s not numeric. Make sure it doesn\'t contain text or true/false data, and try again.","TextualFilterOnNonTextErrorText":"Sorry, I can\'t apply a text filter (begins with, ends with, contains, or their negations) to a column that\'s not textual. Make sure it doesn\'t contain numeric or true/false data, and try again.","DeleteUnexpectedTableRowsErrorText":"Sorry, I can\'t delete the row(s). Is there anything else I can help you with?","DeleteWithInsertColumnsErrorText":"Sorry, I can\'t modify the column(s). Is there anything else I can help you with?","PivotTableChartPresentWithoutTableTLRError":"Currently, I don\'t analyze PivotTables and charts in sheets. I can continue to help if you select the source table and try your question again.","PivotTableChartPresentWithoutTableTLRError2":"To continue analyzing with more prompts, go back to the source table.","PivotTableChartSelectedError":"I don\'t analyze PivotTables or charts in sheets. Select a source table and ask me a question. If you\'d like to keep working with the PivotTable or chart, try asking me how to analyze these objects.","NoPatternsFoundError":"I couldn\'t find any insights from your data, but here but here are a few steps to follow if you\'d like to try.","FixItButtonText":"Fix it","TabularRangeAutoFixDuplicateHeadersSuccessfulResponse":"Thanks for changing the header names! You can try your question again.","TabularRangeAutoFixDuplicateHeadersUnsuccessfulResponse":"I couldn\'t fix the duplicate headers. Go to **Insert** in the ribbon, and then select **Table**.","TabularRangeAutoFixMergedCellsSuccessfulResponse":"Thanks for unmerging the cells! You can try your question again.","TabularRangeAutoFixMergedCellsUnsuccessfulResponse":"I couldn\'t unmerge the cells. Go to **Insert** in the ribbon, and then select **Table**.","TabularRangeAutoEmptyHeadersSuccessfulResponse":"Thanks for adding header names to the empty cells! You can try your question again.","TabularRangeAutoEmptyHeadersUnsuccessfulResponse":"I couldn\'t fix the empty headers. Go to **Insert** in the ribbon, and then select **Table**.","NoAutoFixCompleted":"No changes are needed. Try your question again.","TabularRangeAutoFixDuplicateHeaders":"Some headers have duplicate names. Review and change to different header names.","HeaderColumnLabel":"Column","HeaderRowLabel":"Row","TlrAutoFixConfirmationMultipleCases":"Thanks for making those changes! Try your question again.","TlrAutoFixUnsuccessful":"I couldn\'t make those changes. Go to **Insert** in the ribbon, and then select **Table**. ","ExplainTablesPill":"Tell me more about Excel tables","ExplainHeadersPill":"What are headers?","ExplainUnmergingCellsPill":"What are the benefits of unmerging cells?","AutoFixIntroduction":"In order to answer your question, the data range in **{range}** needs a revision:","AutoFixMoreThanTwoMergedCells":"Unmerge {count} cells","AutoFixOneMergedCells":"Unmerge cell in {range}","AutoFixTwoMergedCells":"Unmerge cells in {range1} and {range2}","AutoFixMultipleMergedCellsDescription":"Unmerge cells and paste the data","AutoFixMoreThanTwoEmptyCells":"Add {count} header names","AutoFixOneEmptyCells":"Add header name in {range}","AutoFixTwoEmptyCells":"Add header names in {range1} and {range2}","AutoFixMoreThanTwoDuplicateCells":"Add {count} different headers","AutoFixTwoDuplicateCells":"Add different headers in {range1} and {range2}","AnalyzeDataInsertErrorMessage":"Sorry, something went wrong. Try again.","InsertedWorksheetName":"Suggestion{0}","InsertedPivotTableName":"PivotTable{0}","NoValueAnswerTextForIdeas":"Based on your question, we didn\'t find a match for the answer in the data.","NoValueAnswerTextForNLInsight":"Based on your question, we didn\'t find any insights that would match the answer.","CopilotUnsupportedlanguageMessage":"Your request includes a language that Copilot doesn\'t currently support. ","CopilotUnsupportedLanguageError":"I don\'t yet support %s. For a list of supported languages, please visit ","CopilotSupportedLanguagesLearnMoreLink":"Supported languages for Microsoft Copilot","FeedbackPrompt":"If you feel I\'m mistaken, please send feedback.","SuggestFullThemeAnalysisPrompt":"The quick summary above considers only part of your data. Would you like a full theme analysis that you can insert in a new column? It may take a few minutes.","SuggestFullThemeAnalysisButton":"Run full theme analysis","SuggestFullThemeAnalysisQuery":"Run a full theme analysis on the \\"{columnName}\\" column","OperationProgress":"{percentProgress}% ({timeLeft} min left)","TextAnalysisSummayInsertionColumnName":"Themes","TextAnalysisSentimentInsertionColumnName":"Sentiment","ChartDesignRecommendationsCardText":"Chart Design Recommendations","ChartDesignRecommendationsPreviewDesignLabel":"I noticed that you are adding a chart to the sheet. Here are some additional ideas you can try.","ChartDesignRecommendationsPreviewDesignLabelViaOOUI":"Here are some designs you can try.","ChartDesignRecommendationsPreviewDesignSnowballChartLabel1":"Your chart has no data.","ChartDesignRecommendationsPreviewDesignSnowballChartLabel2":"Enter data into the grid and try again.","ChartDesignRecommendationsPreviewButtonLabel":"Preview design","ChartDesignRecommendationsCardFooterText":"Don\'t show me suggestions.","ChartDesignRecommendationsBackToResultsButtonLabel":"Back to results","ChartDesignRecommendationsApplyDesignLabel":"Here are the changes for you to review and apply.","ChartDesignRecommendationsApplyButtonLabel":"Apply design","ChartDesignRecommendationsCardErrorPreviewUnavailable":"Preview Unavailable","ChartDesignRecommendationsCardErrorFailedValidation":"Failed Validation","ChartDesignRecommendationsCardErrorInternalError":"Internal Error","ChartDesignRecommendationsCardErrorNoSuggestion":"Unavailable","ChartDesignRecommendationsCardInProgressText":"Chart recommendations are already in progress. Please wait before generating new ones.","ChartDesignRecommendationsAnalyzingCardText":"Analyzing your chart data to inform chart designs...","ChartDesignRecommendationsCardSelectingText":"Selecting relevant chart designs...","ChartDesignRecommendationsCardGeneratingText":"Generating design {chartNumber} of {chartTotal}...","ChartDesignRecommendationsCardProcessingText1":"Processing chart and axes titles...","ChartDesignRecommendationsCardProcessingText2":"Processing colors and styles...","ChartDesignRecommendationsCardProcessingText3":"Processing chart formatting...","ChartDesignRecommendationsCardProcessingText4":"Processing axes and gridlines...","ChartDesignRecommendationsCardProcessingText5":"Processing labels...","ChartDesignRecommendationCardErrorMessage":"I wasn\'t able to finish creating recommendations.","PythonInsertObjectProtectedSheetErrorText":"Looks like this is a password-protected sheet and I can\'t automatically insert objects into the sheet. Remove the password and try again, but I recommend adding the password back to keep this sheet protected when you\'re done."}');var s=a(22115);const c="X-NLInteractionId",d="https://ppe.insights.microsoft.com",u="https://insights.microsoft.com",m="https://dev.insights.microsoft.com",h="https://dev2.insights.microsoft.com",g="https://api.gcc.insights.usgovcloudapi.net",p="https://api.gcch.insights.usgovcloudapi.net",b="https://api.dod.insights.usgovcloudapi.net",f="shimmer",C="Taskpane",y="closeButton",v={OFFICEONLINE:"Excel.Web.Copilot_Lib",PC:"Excel.Win32.Copilot_Lib",MAC:"Excel.Mac.Copilot_Lib",IOS:"Excel.iPad.Copilot_Lib"},x="Excel",T="Copilot",S=150,w=18,E="ANNOTATION",I=.5,R=100*I,A="[]",L=5e3,k="div[data-testid='APIPluginCard']",F=5,_=1e3,P="ExcelSidepaneWorkCopilot",N="excel",M=2e3,O=18e4;let D=!1,B=!1;const $=function(e,t){D=e,B=t},H=function(e){return(0,o.yw9)("OfficeVSO_8940802_WrapNTierRtlUIStrings")&&B&&!D?""+e+"":e},U=i("ExcelCopilotStrings",l),q=i("ExcelCopilotStrings",l,(()=>{})),V=i("OfficeaicopilotStrings",s),G=function(){return"undefined"!=typeof ExcelCopilotStringsNTier},W={Columns:{SingleColumnRecommendation:"I suggested adding the column named {columnName}, that use the formula {formula}, to the column location {columnLocation} to calculate the results.",SingleColumnRecommendationWithNoLocation:"I suggested adding the column named {columnName}, that use the formula {formula}, to calculate the results.",MultipleColumnsRecommendation:"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to the column locations {columnLocations} to calculate the results.",MultipleColumnsRecommendationWithNoLocation:"I suggested adding the columns named {columnNames}, that use the formulas {formulas}, to calculate the results."},Rows:{SingleFormulaRecommendation:"I suggested adding the formula {formula}, that calculates {title}, under the column {location} to calculate the results.",SingleFormulaRecommendationWithNoLocation:"I suggested adding the formula {formula}, that calculates {title}, to calculate the results.",MultipleFormulaRecommendation:"I suggested adding the formulas {formulas}, that calculate {titles}, under the columns {columnLocations} to calculate the results.",MultipleFormulaRecommendationWithNoLocation:"I suggested adding the formulas {formulas}, that calculate {titles}, to calculate the results."},HumanInTheLoop:{Error:"There was an error while generating the human in the loop card.",CardShown:"I showed the human in the loop card, prompting to confirm application of commanding operation."}},z=function(){return[U.CommandingHumanInTheLoopApplyingChangesMessage]},j=function(){return[U.CommandingHumanInTheLoopApplyingChangesMessageWithSheet]},Q=function(){return U.CalculatedColumnsFailureGeneral},J=function(e){return[e?U.CalculatedColumnsNLNoResultSuggestionIdentifyColumn:U.CalculatedColumnsNLNoResultSuggestionIdentifyColumnAndTable,U.CalculatedColumnsNLNoResultSuggestionCreateColumn]},Y=function(){return U.CalculatedColumnsInsertFailedDeleteConflict},X=function(){return U.CalculatedRowsInsertFailedDeleteConflict},Z=function(){return U.CalculatedColumnsInsertFailedProtectedSheet},K=function(){return U.CalculatedRowsInsertFailedProtectedSheet},ee=function(){return U.CalculatedColumnsInsertFailedTableNotFound},te=function(){return U.CalculatedRowsInsertFailedTableNotFound},ae=function(){return U.CalculatedColumnsInsertFailedGeneral},ne=function(){return U.CalculatedRowsInsertFailedGeneral},oe=function(){return U.CalculatedColumnsColumnConfirmationMessage},re=function(){return U.CalculatedColumnsTableConfirmationMessage},ie=function(){return U.MultipleCalculatedColumnsAddedToColumnsConfirmationMessage},le=function(){return U.MultipleCalculatedColumnsAddedToTableConfirmationMessage},se=function(){return U.MoreThanThreeColumnsAddedToTableConfirmationMessage},ce=function(){return U.DataShapingEnterModeButton},de=function(){return U.DataShapingSuggestEnterModeHeaderText},ue=function(){return U.DataShapingSuggestEnterModeText1},me=function(){return U.DataShapingSuggestEnterModeTextBullet1},he=function(){return U.DataShapingSuggestEnterModeTextBullet2},ge=function(){return U.DataShapingSuggestEnterModeText3},pe=function(){return[U.DataShapingLoadingStartDataShapingMode]},be=function(){return[U.LoadingUIExitDataShapingMode]},fe=function(){return U.DataShapingPostEnterModeText1},Ce=function(){return U.DataShapingPostEnterModeText2},ye=function(){return[U.LoadingUIApplyDataShapingStep,U.LoadingUIApplyDataShapingStep2,U.LoadingUIApplyDataShapingStep3,U.LoadingUIApplyDataShapingStep4]},ve=function(){return U.DataShapingGenericError},xe=function(){return"An unexpected error occurred while preparing the data and we exit the mode. please try again."},Te=function(){return"Preparing data on query tables is not supported."},Se=function(){return U.EnterDataShapingNoTableError},we=function(){return U.DataShapingUnsupportedPromptError},Ee=function(){return U.EnterDataShapingGenericError},Ie=function(){return U.DataShapingDone},Re=function(){return U.DataShapingDone},Ae=function(){return U.DataShapingApplyOrExit},Le=function(){return U.DataShapingApplyToNewSheet},ke=function(){return U.DataShapingApplyToExistingTable},Fe=function(){return U.DataShapingDiscardChanges},_e=function(){return U.DataShapingDiscardChangesDone},Pe=function(){return U.DataShapingApplyToExistingTableDone},Ne=function(){return U.DataShapingApplyToNewSheetDone},Me=function(){return U.DataShapingGenericError},Oe=function(){return U.MultipleCalculatedColumnsInsertFailedConflict},De=["Saving your automation..."],Be=["Creating your automation..."],$e=function(){return[U.LoadingUIWorkingOnItStep,U.LoadingUiUnderstandingDataStep,U.LoadingUILookingAtDataRangeStep]},He=function(){return[U.LoadingUIWorkingOnItStep,U.LoadingUiUnderstandingDataStep,U.PythonLookingAtFormulasText]},Ue=function(){return[U.LoadingUIWorkingOnItStep,U.LoadingUiUnderstandingDataStep,U.LoadingUILookingAtDataRangeStepWithSheet]},qe=function(e){return e?[q.LoadingUIWorkingOnItStep,q.LoadingUiUnderstandingDataStep,q.LoadingUIAlmostThereStep]:[U.LoadingUIWorkingOnItStep,U.LoadingUiUnderstandingDataStep,U.LoadingUIAlmostThereStep]},Ve=function(){return[U.LoadingUIFinishingUpStep]},Ge=function(){return[U.LoadingUIAddingColumnStep]},We=function(){return[U.LoadingUIAddingColumnsStep]},ze=function(){return[U.LoadingUIInsertingContentStep]},je=function(){return[U.LoadingUIAnalyzingDataStep]},Qe=function(){return[U.LoadingUIMakingChangesStep]},Je=function(){return[U.LoadingUIMakingChangesChartStep]},Ye=function(){return[U.LoadingUIMakingChangesStepTableOfficeJSLikeRange]},Xe=function(){return[U.LoadingUIGeneratingFormulaColumnSuggestionsStep]},Ze=function(){return[U.LoadingUIGeneratingFormulaRowSuggestionsStep]},Ke=function(){return[U.LoadingUIAnalyzingDataTLRStep]},et=function(){return[U.LoadingUIAnalyzingDataTLRStepWithSheet]},tt=function(){return[U.LoadingUIMakingChangesTLRStep]},at=function(){return[U.LoadingUIMakingChangesTLRStepWithSheet]},nt=function(){return[U.LoadingUIGeneratingFormulaColumnSuggestionsTLRStep]},ot=function(){return[U.LoadingUIGeneratingFormulaColumnSuggestionsTLRStepWithSheet]},rt=function(){return[U.LoadingUIGeneratingFormulaRowSuggestionsTLRStep]},it=function(){return[U.LoadingUIGeneratingFormulaRowSuggestionsTLRStepWithSheet]},lt=function(){return[U.PythonLoadingStartAnalysis]},st=function(){return[U.PythonCellsCalculatingLoadingText]},ct=function(){return[U.LoadingUIWorkingOnItStep]},dt=function(e){return e?q.CalculatedColumnsGeneralSingular:U.CalculatedColumnsGeneralSingular},ut=function(){return U.SuggestionPillAnotherColumnSuggestion},mt=function(){return U.SuggestionPillPromptBasedAnotherSuggestion},ht=function(){return U.CalculatedRowsShowMorePill},gt=function(){return U.SuggestionPillCreateColumn},pt=function(){return U.RecommendationAddToNewSheet},bt=function(){return U.RecommendationAddToSheet},ft=function(){return U.RecommendationInsertColumn},Ct=function(){return U.RecommendationInsertMultipleColumns},yt=function(){return U.CalculatedRowsInsertCellTitle},vt=function(){return U.CalculatedRowsInsertRowTitle},xt=function(){return U.CalculatedRowsUpdateCellTitle},Tt=function(){return U.CalculatedRowsUpdateRowTitle},St=function(){return U.CalculatedRowsFormulaSuggestionHeader},wt={PreviewOnGridButton_ShowPreview:()=>U.FormulaSuggestion_PreviewOnGridButton_ShowPreview,PreviewOnGridButton_HidePreview:()=>U.FormulaSuggestion_PreviewOnGridButton_HidePreview},Et=function(){return U.UnsupportedOperationMessage},It=function(){return U.ServerErrorMessage},Rt=function(){return U.AugloopResponseTimeoutMessage},At=function(){return U.PythonAugloopResponseTimeoutMessage},Lt=function(){return U.QueryLengthTooShortError},kt=function(){return U.ThrottlingErrorMessage},Ft=function(){return U.LicensingErrorMessage},_t=function(){return U.RaiErrorUserMessage},Pt=function(){return U.ElseFormulaBlocksError},Nt=function(){return U.RaiErrorSuccessfulActionBlockedResponse},Mt=function(){return U.ErrorServerBusy},Ot=function(){return"Tag"},Dt=()=>[{error:"Blocked potentially offensive input",errorMessageUser:_t()},{error:"Output was blocked for offensive content",errorMessageUser:_t()},{error:"The query is too long, try again with a shorter query.",errorMessageUser:U.ErrorQueryTooLarge},{error:"Detected languages",errorMessageUser:U.AugloopErrorOTE},{error:"InferenceAPI: Too busy",errorMessageUser:Mt()},{error:"InferenceAPI: Timeout",errorMessageUser:Mt()},{error:"InferenceAPI: User throttled",errorMessageUser:kt()}],Bt=function(){return U.ChatSuggestionHeader},$t=function(){return U.ChatSuggestionAddColumns},Ht=function(){return U.ChatSuggestionHighlight},Ut=function(){return U.ChatSuggestionFilterAndSort},qt=function(){return U.ChatSuggestionAnalyze},Vt=function(){return U.ChatSuggestionFooterText},Gt=function(){return[U.HelpQueryPhrase1,U.HelpQueryPhrase2,U.HelpQueryPhrase3,U.HelpQueryPhrase4,U.HelpQueryPhrase5,U.HelpQueryPhrase6,U.HelpQueryPhrase7,U.HelpQueryPhrase8,U.HelpQueryPhrase9,U.HelpQueryPhrase10,U.HelpQueryPhrase11,U.HelpQueryPhrase12,U.HelpQueryPhrase13,U.HelpQueryPhrase14,U.HelpQueryPhrase15,U.HelpQueryPhrase16,U.HelpQueryPhrase17,U.HelpQueryPhrase18,U.HelpQueryPhrase19,U.HelpQueryPhrase20,U.HelpQueryPhrase21,U.HelpQueryPhrase22,U.HelpQueryPhrase23,U.HelpQueryPhrase24]},Wt=function(){return[U.UnsupportedQueryUndoPhrase1,U.UnsupportedQueryUndoPhrase2,U.UnsupportedQueryUndoPhrase3,U.UnsupportedQueryUndoPhrase4,U.UnsupportedQueryUndoPhrase5]},zt=function(){return[U.UnsupportedQueryAltTextPhrase1,U.UnsupportedQueryAltTextPhrase2,U.UnsupportedQueryAltTextPhrase3,U.UnsupportedQueryAltTextPhrase4]},jt=function(){return[U.UnsupportedQueryAddCommentPhrase1,U.UnsupportedQueryAddCommentPhrase2,U.UnsupportedQueryAddCommentPhrase3]},Qt=function(){return[U.UnsupportedQueryDataValidationPhrase1,U.UnsupportedQueryDataValidationPhrase2,U.UnsupportedQueryDataValidationPhrase3]},Jt=function(){return[U.UnsupportedQueryWorksheetPhrase1,U.UnsupportedQueryWorksheetPhrase2,U.UnsupportedQueryWorksheetPhrase3]},Yt=function(){return[U.UnsupportedQueryFreezePanePhrase1,U.UnsupportedQueryFreezePanePhrase2]},Xt="",Zt=function(){return U.ChatPlaceholderMessageV2},Kt=function(){return U.ChatPlaceholderMessagePythonMode},ea=function(){return U.ChatPlaceholderMessageRange},ta=function(){return U.ChatPlaceholderMessageSearch},aa=function(){return U.ChatPlaceholderMessageSearchWithRange},na=function(){return U.ChatRestShyPlaceholderMessage},oa=function(){return U.ChatRestShyPlaceholderMessageRange},ra=function(){return[U.SuggestionPillSeeInsight,U.SuggestionPillAddInsights]},ia=function(){return U.DashboardSourceDataLabel},la="#F0F0F0",sa="#595959",ca=25,da=60,ua=function(){return U.AnalyzeDataGenericError},ma=function(){return U.UndoScopeName},ha=function(){return G()?H(ExcelCopilotStringsNTier.AugloopSessionClosedTitle):"Something went wrong"},ga=function(){return G()?H(ExcelCopilotStringsNTier.AugloopSessionClosedDesktopMessage):"Sorry, I'm having some trouble right now. Restart Excel and try sending the prompt again."},pa=function(){return G()?H(ExcelCopilotStringsNTier.AugloopSessionClosedWebMessage):"Sorry, I'm having some trouble right now. Try refreshing the webpage."},ba=function(){return U.BlankWorksheetButtonText},fa=function(){return U.BlankWorksheetButtonSuccess},Ca=function(){return U.ActionButtonGoToData},ya=function(){return(0,o.iPS)("Microsoft.Office.Excel.FA000000124.OfficeVSO_9657578_LocalizeGoBackToSheetNameButton",!1)?"Go back to {0}":Ca()},va=function(){return U.ActionButtonUndo},xa=function(){return V.UndoCompletionOutputText},Ta=function(){return V.RebrandedChatPlaceHolderMessage??"Ask a question"},Sa=function(){return U.ActionButtonInsert},wa=function(){return U.InsertSingleTableSuccessMessage},Ea=function(){return U.InsertMultiTablesSuccessMessage},Ia=function(){return U.InsertTableErrorMessage},Ra=function(){return U.TableUsesTooMuchMemoryError2},Aa=function(){return U.ShowHeadersButtonTitle},La=function(){return U.ShowHeadersSuccessMessage},ka=function(){return G()?H(ExcelCopilotStringsNTier.WorksheetAutosaveOffTitle):"AutoSave is turned off"},Fa=function(){return G()?H(ExcelCopilotStringsNTier.WorksheetAutosaveOffMessage):"I only work with files that have AutoSave turned on. Turn it on to continue."},_a=function(){return G()?H(ExcelCopilotStringsNTier.EnableAutosaveButtonText):"Turn on AutoSave"},Pa=function(){return U.DialogSheetUnsupportedTitle},Na=function(){return U.DialogSheetUnsupportedMessage},Ma=function(){return U.FileLocationUnsupportedTitle},Oa=function(){return U.FileLocationUnsupportedMessage},Da="https://support.microsoft.com/office/frequently-asked-questions-about-copilot-in-excel-7a13758f-d61e-4a56-8440-f2c9a07802ec",Ba=function(){return U.WorksheetProtectedTitle},$a=function(){return U.WorksheetProtectedMessage},Ha=function(){return U.NonWorksheetActivatedTitle},Ua=function(){return U.NonWorksheetActivatedMessage},qa=function(){return U.ConvertToTableButtonSuccess},Va=function(){return U.InsertAllDataConfirmationMessage},Ga=function(){return U.InsertDataConfirmationMessage},Wa=function(){return U.ChartDesignRecommendationsCardInProgressText},za=function(e){return e?q.SuggestionPillInsights2:U.SuggestionPillInsights2},ja=function(){return U.SuggestionPillUpdatedInsights2},Qa=function(){return U.SuggestionPillShowPivotTables},Ja=function(){return U.SuggestionPillShowCharts},Ya=function(){return U.SuggestionPillAnotherPivotTable},Xa=function(){return U.SuggestionPillAnotherChart},Za=function(){return U.CommandingTellMeHeader1},Ka=function(){return U.CommandingTellMeSuggestion1},en=function(){return U.CommandingTellMeSuggestion2},tn=function(){return U.CommandingTellMeHeader2},an=function(){return U.CommandingTellMeSuggestion3},nn=function(){return U.CommandingTellMeSuggestion4},on=function(){return U.NoInsightsMessage},rn=function(){return U.NoAnalyzeDataMessage},ln=function(){return U.AnalyzeNotSupportedMessage},sn=function(){return U.AnalyzeDataGenericError2},cn=function(){return U.AccessDeniedMessage},dn=function(){return U.CellEditingMessage},un=function(){return U.AnalyzeDataTooLargeError},mn=function(){return U.AnalyzeDataTooLargeErrorFourMillion},hn=function(){return"There's too much content for me to summarize. Reduce the number of rows and try again."},gn=function(){return"I've run into a problem. Try asking me again later"},pn=function(){return"I've run into a problem. Try asking another question."},bn=function(){return"LLM throttled. Wait and retry may help"},fn=function(){return"LLM API issue. Wait and retry may help"},Cn=function(){return"There is an error in the network connection. Please check your network connection and try again."},yn=function(){return U.PromptMenuItemAddFormulaColumn},vn=function(){return U.PromptMenuItemHighlightData},xn=function(){return U.PromptMenuItemSortFilter},Tn=function(){return U.PromptMenuItemAnalyzeData},Sn=function(){return U.PromptMenuItemAnalyzeUsingPython},wn=function(){return U.SuggestionPillOutliers},En=function(){return U.SuggestionPillCompareColumns},In=function(){return U.SuggestionPillBoldColumn},Rn=function(){return U.SuggestionPillHowMany},An=function(){return U.SuggestionPillCombineColumns},Ln=function(){return U.SuggestionPillHighlightHighest},kn=function(){return U.SuggestionPillShowItems},Fn=function(){return U.SuggestionPillBold},_n=function(){return U.SuggestionPillSortColumn},Pn=function(){return U.ZeroQueryInsightsTitle},Nn=function(){return U.ZeroQueryFormulaActionTitle},Mn=function(){return U.ZeroQueryHighlightActionTitle},On=function(){return U.ZeroQuerySearchTitle},Dn=function(){return U.ZeroQueryPythonTitle},Bn=function(){return U.ZeroQueryPythonHeader},$n=function(){return U.ZeroQueryEditPythonCodeTitle},Hn=function(){return U.ZeroQueryEditPythonCodeMessage},Un=function(){return U.ZeroQueryDataShapingHeader},qn=function(){return U.ZeroQueryDataShapingText},Vn=function(){return[U.ZeroQueryDataShapingText,U.ZeroQueryDataShapingText2,U.ZeroQueryDataShapingText3,U.ZeroQueryDataShapingText4,U.ZeroQueryDataShapingText5]},Gn=function(){return U.ZeroQueryHowToSumTitle},Wn=function(){return U.ZeroQueryHeaderAsk},zn=function(){return U.ZeroQuerySuggestAColumnTitle},jn=function(){return U.ZeroQuerySuggestAColumnMessage},Qn=function(){return U.ZeroQueryWriteAFormulaTitle},Jn=function(){return U.ZeroQueryWriteAFormulaMessage},Yn=function(){return U.ZeroQueryAddAFormulaColumnTitle},Xn=function(){return U.ZeroQueryAddAFormulaColumnMessage},Zn=function(){return U.ZeroQueryExplainAFormulaTitle},Kn=function(){return U.ZeroQueryExplainAFormulaMessage},eo=function(){return U.ZeroQueryInvestigateErrorTitle},to=function(){return U.ZeroQueryInvestigateErrorMessage},ao=function(){return U.ZeroQuerySplitColumnsTitle},no=function(){return U.ZeroQuerySplitColumnsMessage},oo=function(){return U.ZeroQueryCreateTotalRowTitle},ro=function(){return U.ZeroQueryCreateTotalRowMessage},io=function(){return U.ZeroQueryWriteLookupFormulaTitle},lo=function(){return U.ZeroQueryWriteLookupFormulaMessage},so=function(){return U.ZeroQueryGetDataInsightsTitle},co=function(){return U.ZeroQueryGetDataInsightsMessage},uo=function(){return U.ZeroQueryGetDataInsightsAnswersMessage},mo=function(){return U.ZeroQueryAdvancedAnalysisTitle},ho=function(){return U.SuggestionPillPythonAAText},go=function(){return U.ZeroQueryAdvancedAnalysisMessage},po=function(){return U.ZeroQueryPerformForecastingTitle},bo=function(){return U.ZeroQueryPerformForecastingMessage},fo=function(){return U.ZeroQueryCreateBoxplotTitle},Co=function(){return U.ZeroQueryCreateBoxplotMessage},yo=function(){return U.ZeroQuerySetOfChartsTitle},vo=function(){return U.ZeroQuerySetOfChartsMessage},xo=function(){return U.ZeroQueryGenerateWordCloudTitle},To=function(){return U.ZeroQueryGenerateWordCloudMessage},So=function(){return U.ZeroQueryCreateATableTitle},wo=function(){return U.ZeroQueryCreateATableMessage},Eo=function(){return U.ZeroQueryKeyboardShortcutsTitle},Io=function(){return U.ZeroQueryKeyboardShortcutsMessage},Ro=function(){return U.ZeroQueryTipsAndTricksTitle},Ao=function(){return U.ZeroQueryTipsAndTricksMessage},Lo=function(){return U.ZeroQueryFreezeColumnMessage},ko=function(){return U.ZeroQueryHowDoITitle},Fo=function(){return U.ZeroQueryHowDoIDropdownMessage},_o=function(){return U.ZeroQuerySummarizeColumnTitle},Po=function(){return U.ZeroQuerySummarizeColumnMessage},No=function(){return U.ZeroQueryShowDataInsightsTitle},Mo=function(){return U.ZeroQueryShowDataInsightsMessage},Oo=function(){return U.ZeroQueryCreatePivotTableTitle},Do=function(){return U.ZeroQueryCreatePivotTableMessage},Bo=function(){return U.ZeroQueryCreatePieChartTitle},$o=function(){return U.ZeroQueryCreatePieChartMessage},Ho=function(){return U.ZeroQueryGenerateAGraphTitle},Uo=function(){return U.ZeroQueryGenerateAGraphMessage},qo=function(){return U.ZeroQueryHighlightCellsTitle},Vo=function(){return U.ZeroQueryHighlightCellsMessage},Go=function(){return U.ZeroQueryApplyColorCodingTitle},Wo=function(){return U.ZeroQueryApplyColorCodingMessage},zo=function(){return U.ZeroQueryWebSearchCreateTableTitle},jo=function(){return U.ZeroQueryWebSearchCreateTableMessage},Qo=function(){return U.ZeroQueryWebSearchLearnTitle},Jo=function(){return U.ZeroQueryWebSearchLearnMessage},Yo=function(){return U.ZeroQueryImportTableTitle},Xo=function(){return U.ZeroQueryImportTableMessage},Zo=function(){return U.ZeroQueryPrepareForMeetingsTitle},Ko=function(){return U.ZeroQueryPrepareForMeetingsMessage},er=function(){return U.ZeroQueryRecapEmailsTitle},tr=function(){return U.ZeroQueryRecapEmailsMessage},ar=function(){return U.PromptMenuItemHowCanCopilotHelp},nr=function(){return U.LoadingTableLikeRangesWarning},or=function(){return U.HintCardAnalyzeDataSuggestionHeader},rr=function(){return U.HintCardAnalyzeDataSuggestionMessage1},ir=function(){return U.HintCardAnalyzeDataSuggestionMessage2},lr=function(){return U.HintCardAnalyzeDataSuggestionMessage3},sr=function(){return U.HintCardAnalyzeDataSuggestionMessage4},cr=function(){return U.HintCardAnalyzeDataSuggestionMessage5},dr=function(){return U.HintCardMoonshotSuggestionHeader},ur=function(){return U.HintCardMoonshotSuggestionMessage1},mr=function(){return U.HintCardMoonshotSuggestionMessage2},hr=function(){return U.HintCardMoonshotSuggestionMessage3},gr=function(){return U.HintCardMoonshotSuggestionMessage4},pr=function(){return U.HintCardFormatDataSuggestionHeader},br=function(){return U.HintCardFormatDataSuggestionMessage1},fr=function(){return U.HintCardFormatDataSuggestionMessage2},Cr=function(){return U.HintCardFormatDataSuggestionMessage3},yr=function(){return U.HintCardFormatDataSuggestionMessage5},vr=function(){return U.StopGeneratingResponseTableExplain},xr=function(){return U.StopGeneratingResponsePythonMode},Tr=function(){return V.ChatHistoryHydrationError},Sr=function(){return V.TopicChangedResponseText},wr="https://support.microsoft.com/office/welcome-to-microsoft-365-copilot-in-excel-e5faf5c4-aa48-437a-b5b2-b35ac2c4a01b",Er=function(){return U.LearnMoreResponsePrefix},Ir=function(){return U.LearnMoreResponseLinkText},Rr=function(){return[U.LearnMoreResponseContentFirst,U.LearnMoreResponseContentSecond,U.LearnMoreResponseContentThird]},Ar=function(){return G()?H(ExcelCopilotStringsNTier.ErrorScreenHeader):"We ran into an error."},Lr=function(){return G()?H(ExcelCopilotStringsNTier.ErrorScreenInstruction):"Please reopen the Copilot pane to try again."},kr=function(){return G()?H(ExcelCopilotStringsNTier.ErrorScreenReopenButton):"Reopen"},Fr=function(){return U.CommandingUndoWarningSuffix},_r=function(){return"I am about to perform the following actions:"},Pr=function(){return"For {0}:"},Nr=function(){return U.CommandingUndoWarningConfirm},Mr=function(){return U.CommandingUndoWarningReject},Or=function(){return U.CommandingExplanationPrefix},Dr=function(){return U.OfficeJSResponseExplain},Br=function(){return U.OfficeJSErrorExplanationPrefix},$r=function(){return U.OfficeJSExplanationPrefix},Hr=function(){return U.OfficeJSSimpleSuccessResponse},Ur="https://aka.ms/copilotlicensecheck",qr="https://aka.ms/copilotlicensecheck",Vr=function(){return U.CopilotLicenseHelpPrefix},Gr=function(){return U.OfficeScriptSaveScriptFailPrefix},Wr=function(){return"I was not able to find an Office Script called '{0}'"},zr=function(){return"Something went wrong while trying to schedule your script"},jr=function(){return"Sure, I've created an Office Script called '{0}' to automate your previous requests. Click \"Save Script\" to keep it for future use."},Qr=function(){return"Schedule script '{0}' to run:"},Jr=function(){return"Sure. Based on your automation request, here is an option for you."},Yr=function(){return"Starting"},Xr=function(){return"Repeat every"},Zr=function(){return"I cannot run the script '{0}' for you. Please run it manually in Automate tab."},Kr=function(){return"Done! I saved your Office Script."},ei=function(){return"You can find it in the Gallery in the Automate tab to re-run later."},ti=function(){return"View Script"},ai=function(){return"Save Script"},ni=function(){return"Script name: '{0}'"},oi=function(){return"Delete Script"},ri=function(){return"I'm unable to delete your script '{0}'. Please try again later or delete it from the {1} folder in your OneDrive."},ii=function(){return'"Office Scripts"'},li=function(){return"Sure, I've deleted script '{0}'."},si=function(){return"Confirm or edit the flow"},ci=function(){return"Script"},di=function(){return"Your automation has been scheduled successfully."},ui=function(){return"The response is too large to be displayed. Please try a smaller dataset."},mi=function(){return"Similar cells referenced"},hi="EnterpriseSearch",gi="BingWebSearch",pi="acquired",bi={menuTitle:()=>U.PromptGuideMenuTitle,menuSectionCreate:()=>U.PromptGuideMenuSelectionCreate,menuSectionUnderstand:()=>U.PromptGuideMenuSelectionUnderstand,menuSectionEdit:()=>U.PromptGuideMenuSelectionEdit,menuSectionAsk:()=>U.OfficeScriptSaveScriptFailPrefixAsk,viewMorePrompts:()=>U.PromptGuideViewMorePrompts},fi={generateFormulaColumnSuggestion:()=>U.PromptGuideMenuSectionItemGenerateFormulaColumnSuggestion,addAColumnThatCombines:()=>U.PromptGuideMenuSectionItemAddAColumnThatCombines,addAColumnToExtract:()=>U.PromptGuideMenuSectionItemAddAColumnToExtract,addAColumnThatCalculates:()=>U.PromptGuideMenuSectionItemAddAColumnThatCalculates},Ci={showDataInsights:()=>U.PromptGuideMenuSectionItemShowDataInsights,percentageCalculation:()=>U.PromptGuideMenuSectionItemPercentageCalculation,howManyDifferent:()=>U.PromptGuideMenuSectionItemHowManyDifferent,whichItems:()=>U.PromptGuideMenuSectionItemWhichItems},yi={highlight:()=>U.PromptGuideMenuSectionItemHighlight,sort:()=>U.PromptGuideMenuSectionItemSort,filter:()=>U.PromptGuideMenuSectionItemFilter,applyRYG:()=>U.PromptGuideMenuSectionItemApplyRYG},vi={help:()=>ar()},xi=function(){return U.MicrophonePermissionErrorTitleWeb},Ti=function(){return U.MicrophonePermissionErrorTextWeb},Si=function(){return U.MicrophonePermissionErrorTitleWin32},wi=function(){return U.MicrophonePermissionErrorTextWin32},Ei=function(){return G()?H(ExcelCopilotStringsNTier.CopilotNotAvailableInYourLanguageOthersSupported):"Copilot isn't available in your language yet. For now, you can try Copilot in English."},Ii=function(){return G()?H(ExcelCopilotStringsNTier.LearnMoreLinkText):"Learn more"},Ri="https://go.microsoft.com/fwlink/?linkid=2247434",Ai=6e4,Li=3e6,ki=function(e){return(0,o.k64)()?e>1?U.CommandingHumanInTheLoopMultipleChangesResponseMessage:U.CommandingHumanInTheLoopSingleChangeResponseMessage:"Done! I made the following changes in range {0}:"},Fi=function(e){return(0,o.k64)()?e>1?U.CommandingHumanInTheLoopMultipleChangesNoRangeResponseMessage:U.CommandingHumanInTheLoopSingleChangeNoRangeResponseMessage:"Done! I made the following changes:"},_i=function(){return"Here's a {0} that shows an insight about your data."},Pi=function(){return"Here's a {0} based on your prompt."},Ni=function(){return"This {0} may include some of the information you're looking for. If it doesn't show everything you requested, try another prompt."},Mi=function(){return"I looked through your data for this criteria: {0}. There were no matches. If you want to try again, use another prompt."},Oi=function(){return"I looked through your data for this criteria: {0}. There are no matches."},Di=function(){return["chart","PivotChart","PivotTable","formula"]},Bi=function(){return"a Map Chart"},$i=function(){return"a Scatter Chart"},Hi=function(){return"a Clustered Combo Chart"},Ui=function(){return"a Stacked Combo Chart"},qi=function(){return"a Hundred Percent Combo Chart"},Vi=function(){return"a Funnel Chart"},Gi=function(){return"a Treemap Chart"},Wi=function(){return"a Sunburst Chart"},zi=function(){return"a Color Filled Map Chart"},ji=function(){return"a Circular Treemap Chart"},Qi=function(){return"a Heat Map Chart"},Ji=function(){return"a Waterfall Chart"},Yi=function(){return"a Rose Chart"},Xi=function(){return"a Network Map Chart"},Zi=function(){return"a Smooth Line Chart"},Ki=function(){return"a Combo Chart"},el=function(){return"a Line Chart"},tl=function(){return"a Pie Chart"},al=function(){return"a Donut Chart"},nl=function(){return"an Area Chart"},ol=function(){return"a Stacked Area Chart"},rl=function(){return"a Hundred Percent Stacked Area Chart"},il=function(){return"a Clustered Bar Chart"},ll=function(){return"a Stacked Bar Chart"},sl=function(){return"a Hundred Percent Stacked Bar Chart"},cl=function(){return"a Clustered Column Chart"},dl=function(){return"a Stacked Column Chart"},ul=function(){return"a Hundred Percent Stacked Column Chart"},ml=function(){return"that type of chart"},hl=function(){return U.PrePythonModeErrorText},gl=function(){return U.PythonCellsStartAnalysisError},pl=function(){return G()?H(ExcelCopilotStringsNTier.PythonUnsupportedLocaleErrorText):"I'm still working to support other languages when I help you with Python. For now, please try your prompt again in English."},bl=function(){return U.PythonInsertProtectedSheetErrorText},fl=function(){return U.PythonInsertObjectProtectedSheetErrorText},Cl=function(){return G()?ExcelCopilotStringsNTier.PythonPlatformErrorTextWithLink:"Python in Excel is only available for Excel for Windows. {0}."},yl=function(){return G()?ExcelCopilotStringsNTier.PythonAvailabilityErrorTextWithLink:"Python in Excel isn't available. {0}"},vl=function(){return G()?ExcelCopilotStringsNTier.PythonPrerequisiteValidationErrorLinkText:"View more information"},xl="https://go.microsoft.com/fwlink/?linkid=2279837",Tl=function(){return U.PythonStartAnalysisEditModeErrorText},Sl=function(){return U.PythonGenericEditModeErrorText},wl=function(){return U.PythonRestartRuntimeErrorText},El=function(){return U.PythonBusyStateErrorText},Il=function(){return U.PythonAnalysisSheetWasDeletedDuringGenerationErrorText},Rl=function(){return U.PythonCodeRetryMaximumHitErrorText},Al=function(){return U.PythonAugloopCallsPerQueryMaximumHitErrorText},Ll=function(){return U.PythonGeneralErrorTextWithLink},kl=function(){return U.PythonGeneralErrorLinkText},Fl="https://go.microsoft.com/fwlink/?linkid=2281206",_l=function(){return U.PythonNoSuggestionGenericErrorText},Pl=function(){return U.PythonWorkbookLostFocusError},Nl=function(){return U.PythonExecutionBlockedByAdminText},Ml=function(){return U.PythonAugloopLlmLoopLimitHitMessage},Ol=function(){return U.PythonElseFallbackMessage},Dl=function(){return U.PythonCodeRetryResponseWithAddressText},Bl=function(){return U.PythonCodeDefaultErrorMessage},$l=function(){return U.PythonCodeButtonRoleDescription},Hl=function(){return U.PythonStartAnalysisHeaderTextFirst30s},Ul=function(){return[U.PythonRunningCodeText]},ql=function(e){return e&&""!==e?U.PythonStartAnalysisFirstBulletTextWithExistingSheet.replace("{sheet}",e):U.PythonStartAnalysisFirstBulletText},Vl=function(){return U.PythonStartAnalysisSecondBulletText},Gl=function(){return U.PythonStartAnalysisThirdBulletText},Wl=function(){return U.PythonStartAnalysisFourthBulletText},zl=function(){return U.PythonStartAnalysisFooterText},jl=function(){return U.PythonStartAnalysisButtonTextFirst30s},Ql=function(){return U.PythonExistAnalysisConfirmationText},Jl=function(){return U.PythonStartAnalysisRAIErrorText},Yl=function(){return U.PythonErrorTryAgainSuggestionPillText},Xl=function(){return q.PythonAnalysisSheetNameText},Zl=function(){return U.PythonAnalysisSheetHeaderTextFirst30s},Kl=function(){return U.PythonAnalysisSheetDescriptionText},es=function(){return U.PythonAnalysisSheetWasDeletedBeforeGenerationText},ts=function(){return U.PythonDetailSheetNameText},as=function(){return U.PythonAddResultsToAnotherSheetConfirmationText},ns=function(){return U.PythonGoBackToAnalysisSheetButtonText},os=function(){return U.PythonAddResultsToAnotherSheetErrorText},rs=function(){return U.PythonAddResultsToAnotherSheetButtonText},is=function(){return U.PythonPostviewHeaderText},ls=function(){return U.PythonPostviewLoadingHeaderText},ss=function(){return U.PythonPostviewNotSupportedText},cs=function(){return U.PythonPostviewImageUnavailableText},ds=function(){return U.PythonRowsText},us=function(){return U.PythonColumnsText},ms=function(){return U.PythonBlankText},hs=function(){return U.PythonUnknownText},gs=function(){return U.PythonLabelFallbackText},ps=function(){return U.PythonDataframeLabelText},bs=function(){return U.PythonDataframeCodeExplanationText},fs=function(){return U.PythonPreviewLabelText},Cs=function(){return U.PythonSuggestMoreIdeasPill},ys=function(){return U.PythonWhatElseCanIDoPill},vs=function(){return U.PythonDataframeTeachingCalloutHeaderText},xs=function(){return U.PythonDataframeTeachingCalloutBodyText},Ts=function(){return U.PythonThinkDeeperButtonTitleText},Ss=function(){return U.PythonThinkDeeperButtonTooltipText},ws=function(){return U.PythonThinkDeeperStartAnalysisButtonText},Es=function(){return U.PythonStartWithThinkDeeperButtonText},Is=function(){return U.PythonThinkDeeperStartingText},Rs=function(){return U.PythonInsertToSheetButtonText},As=function(){return U.PythonInsertDataConfirmationMessage},Ls=function(){return U.PythonFormulaText},ks=function(){return U.PythonFormulaSecondaryText},Fs=function(){return U.PythonShowAnalysisText},_s=function(){return U.PythonHideAnalysisText},Ps=function(){return U.PythonOutputText},Ns=function(){return U.PythonTableExpand},Ms=function(){return U.PythonTableCollapse},Os=function(){return U.PythonLargeDataMessage},Ds=function(){return"Insert Python column"},Bs=function(){return"Sorry, something went wrong with Python calculated columns. Try your request again later."},$s=function(){return"Done! I inserted the new Python column to column {0}."},Hs=function(){return"I can't insert any Python columns because it looks like no table is selected. Double check to make sure a table is selected and try again."},Us=function(){return"Whoops! This code generated a {0} error. Please try again later."},qs=function(){return"Whoops! This feature only works on formatted tables. Please format your data as an Excel table and try again. (Hint: select the table and run CTRL+T)"},Vs=function(){return"My query was cancelled."},Gs=function(){return"I succeeded in my task."},Ws=function(){return"I failed in my task."},zs=function(){return U.AnalyzeDataCardHeader},js=function(){return U.AnalyzeDataCardHeaderWithSheet},Qs=function(){return G()?ExcelCopilotStringsNTier.ChartTypeArea:"Area"},Js=function(){return G()?ExcelCopilotStringsNTier.ChartTypeAreaStacked:"Stacked Area"},Ys=function(){return G()?ExcelCopilotStringsNTier.ChartTypeAreaStacked100:"100% Stacked Area"},Xs=function(){return G()?ExcelCopilotStringsNTier.ChartTypeBarClustered:"Clustered Bar"},Zs=function(){return G()?ExcelCopilotStringsNTier.ChartTypeBarStacked:"Stacked Bar"},Ks=function(){return G()?ExcelCopilotStringsNTier.ChartTypeBarStacked100:"100% Stacked Bar"},ec=function(){return G()?ExcelCopilotStringsNTier.ChartTypeColumnClustered:"Clustered Column"},tc=function(){return G()?ExcelCopilotStringsNTier.ChartTypeColumnStacked:"Stacked Column"},ac=function(){return G()?ExcelCopilotStringsNTier.ChartTypeColumnStacked100:"100% Stacked Column"},nc=function(){return G()?ExcelCopilotStringsNTier.ChartTypeLine:"Line"},oc=function(){return G()?ExcelCopilotStringsNTier.ChartTypeLineStacked:"Stacked Line"},rc=function(){return G()?ExcelCopilotStringsNTier.ChartTypeLineStacked100:"100% Stacked Line"},ic=function(){return G()?ExcelCopilotStringsNTier.ChartTypeDoughnut:"Doughnut"},lc=function(){return G()?ExcelCopilotStringsNTier.ChartTypePie:"Pie"},sc=function(){return G()?ExcelCopilotStringsNTier.ChartTypeScatter:"Scatter"},cc=function(){return G()?ExcelCopilotStringsNTier.ChartTypeHistogram:"Histogram"},dc=function(){return G()?ExcelCopilotStringsNTier.ChartTypeBubble:"Bubble"},uc=function(){return G()?ExcelCopilotStringsNTier.ThousandsUnitsLabel:"Thousands"},mc=function(){return G()?ExcelCopilotStringsNTier.MillionsUnitsLabel:"Millions"},hc=function(){return G()?ExcelCopilotStringsNTier.BillionsUnitsLabel:"Billions"},gc=function(){return G()?ExcelCopilotStringsNTier.TrillionsUnitsLabel:"Trillions"},pc=function(){return G()?ExcelCopilotStringsNTier.BlankCellValue:"(blank)"},bc=function(){return G()?ExcelCopilotStringsNTier.XAxisDescriptor:"X"},fc=function(){return G()?ExcelCopilotStringsNTier.YAxisDescriptor:"Y"},Cc=function(){return G()?ExcelCopilotStringsNTier.PrimaryXAxisDescriptor:"Primary X-Axis"},yc=function(){return G()?ExcelCopilotStringsNTier.PrimaryYAxisDescriptor:"Primary Y-Axis"},vc=function(){return G()?ExcelCopilotStringsNTier.SecondaryXAxisDescriptor:"Secondary X-Axis"},xc=function(){return G()?ExcelCopilotStringsNTier.SecondaryYAxisDescriptor:"Secondary Y-Axis"},Tc=function(){return G()?ExcelCopilotStringsNTier.SumAggregationLabel:"Sum"},Sc=function(){return G()?ExcelCopilotStringsNTier.AverageAggregationLabel:"Average"},wc=function(){return G()?ExcelCopilotStringsNTier.CountAggregationLabel:"Count"},Ec=function(){return G()?ExcelCopilotStringsNTier.MinAggregationLabel:"Min"},Ic=function(){return G()?ExcelCopilotStringsNTier.MaxAggregationLabel:"Max"},Rc=function(){return G()?ExcelCopilotStringsNTier.StdDevAggregationLabel:"StdDev"},Ac=function(){return G()?ExcelCopilotStringsNTier.VarAggregationLabel:"Var"},Lc=function(){return G()?ExcelCopilotStringsNTier.PivotTableRowLabels:"Row Labels"},kc=function(){return G()?ExcelCopilotStringsNTier.PivotTableColumnLabels:"Column Labels"},Fc=function(){return G()?ExcelCopilotStringsNTier.PivotTableGrandTotal:"Grand Total"},_c=function(){return G()?ExcelCopilotStringsNTier.ConcatenatedAriaLabel:"{0}, {1}"},Pc=function(){return G()?ExcelCopilotStringsNTier.ChartTypeAlternativeText:"Chart type: {0}."},Nc=function(){return G()?ExcelCopilotStringsNTier.ComboChartTypeAlternativeText:"Chart type: Combo: {0}; {1}."},Mc=function(){return G()?ExcelCopilotStringsNTier.AltTextDisclaimer:"Description automatically generated"},Oc=function(){return G()?ExcelCopilotStringsNTier.PivotTableDataFieldHeader:"{0} of {1}"},Dc=function(){return G()?ExcelCopilotStringsNTier.PivotTableGrandTotalWithDataField:"Total {0} of {1}"},Bc=function(){return G()?ExcelCopilotStringsNTier.PivotTableSubtotalWithDataField:"{0} {1} of {2}"},$c=function(){return G()?ExcelCopilotStringsNTier.TransformedColumnName:"{0}{1}"},Hc=function(){return G()?ExcelCopilotStringsNTier.FieldTitle:"Field{0}"},Uc=function(){return G()?ExcelCopilotStringsNTier.SubtitleNameUnits:"{0} ({1})"},qc=function(){return G()?ExcelCopilotStringsNTier.SubtitleNameUnits2:"{0} ({1}); {2} ({3})"},Vc=function(){return G()?ExcelCopilotStringsNTier.SubtitleWithSemicolon:"{0}; "},Gc=function(){return G()?ExcelCopilotStringsNTier.SubtitleUnits:"({0})"},Wc=function(){return G()?ExcelCopilotStringsNTier.AddPeriodToText:"{0}."},zc=function(){return G()?ExcelCopilotStringsNTier.SeriesCountAlternativeText:"{0} series."},jc=function(){return G()?ExcelCopilotStringsNTier.DatapointCountAlternativeText:"Series {0}: {1} datapoints."},Qc=function(){return G()?ExcelCopilotStringsNTier.PrimaryHorizontalAxisAlternativeText:"Primary Horizontal axis title: {0}."},Jc=function(){return G()?ExcelCopilotStringsNTier.PrimaryVerticalAxisAlternativeText:"Primary Vertical axis title: {0}."},Yc=function(){return G()?ExcelCopilotStringsNTier.SecondaryHorizontalAxisAlternativeText:"Secondary Horizontal axis title: {0}."},Xc=function(){return G()?ExcelCopilotStringsNTier.SecondaryVerticalAxisAlternativeText:"Secondary Vertical axis title: {0}."},Zc=function(){return G()?ExcelCopilotStringsNTier.XAxisAlternativeText:"X axis title: {0}."},Kc=function(){return G()?ExcelCopilotStringsNTier.YAxisAlternativeText:"Y axis title: {0}."},ed=function(){return G()?ExcelCopilotStringsNTier.PivotTableSingleRowTitle:"{0} as row"},td=function(){return G()?ExcelCopilotStringsNTier.PivotTableTwoRowTitle:"{0} and {1} as rows"},ad=function(){return G()?ExcelCopilotStringsNTier.PivotTableColumnTitle:"{0} as column"},nd=function(){return G()?ExcelCopilotStringsNTier.PivotTableDataTitle:"{0} as values"},od=function(){return G()?ExcelCopilotStringsNTier.PivotTableSubtotal:"{0} Total"},rd="This code was made by Copilot for your specific needs. Please review it before you use it in another workbook.",id=function(){return U.CommandingHumanInTheLoopSingleEventHeader},ld=function(){return U.CommandingHumanInTheLoopSingleEventHeaderWithSheet},sd=function(){return U.CommandingHumanInTheLoopMultipleEventsHeader},cd=function(){return U.CommandingHumanInTheLoopMultipleEventsHeaderWithSheet},dd=function(){return U.CommandingHumanInTheLoopSingleCFEventHeader},ud=function(){return U.CommandingHumanInTheLoopSingleCFEventHeaderWithSheet},md=function(){return U.CommandingHumanInTheLoopMultipleCFEventsHeader},hd=function(){return U.CommandingHumanInTheLoopMultipleCFEventsHeaderWithSheet},gd=function(){return U.ImportDataCardHeaderMultipleTables},pd=function(){return U.ImportDataCardHeaderSingleTable},bd=function(){return U.ImportDataCardHeaderFallbackShowAll},fd=function(){return U.ImportDataCardHeaderSomeFiltered},Cd=function(){return U.FluxWorkflowCancelledMessage},yd=function(){return U.ImportDataStaticSuggestionButtonText},vd=function(){return U.ImportDataImportToNewSheet},xd=function(){return U.ImportDataSuccessButtonText},Td=function(){return U.ImportDataQuerySnippetTitle},Sd=function(){return U.ImportDataCaruselText},wd=function(){return U.ImportDataCaruselNext},Ed=function(){return U.ImportDataCaruselPrevious},Id=function(){return U.ImportDataExcelFileTooltip},Rd=function(){return U.ImportDataQueryExplanation},Ad=function(){return U.ImportDataShowImportQuery},Ld=function(){return U.ImportDataHideImportQuery},kd=function(){return[U.ImportDataPrepareImportOptions1]},Fd=function(){return[U.ImportDataPrepareImportOptions2]},_d=function(){return[U.ImportDataToGridOption1]},Pd=function(){return U.ImportDataLoadQueryAddedToDocumentMessageNoBindingText},Nd=function(){return U.ImportDataNoTableFoundMessageText},Md=function(){return U.ImportDataNoTableFoundAndSomeFilteredMessageText},Od=function(){return U.ImportDataFailureGeneralMessageText},Dd=function(e){return e?q.SuggestionPillConditionalFormatting:U.SuggestionPillConditionalFormatting},Bd=function(){return U.ConditionalFormattingSuggestionResponse},$d=function(){return U.ConditionalFormattingSuggestionResponseWithSheet},Hd=function(){return U.ConditionalFormattingSuggestionResponseError},Ud=function(){return U.ConditionalFormattingSuggestionResponseNoSuggestionForRange},qd=function(){return U.ConditionalFormattingSuggestionResponseNoTable},Vd=function(){return U.ConditionalFormatFormulaInvalidErrorText},Gd=function(){return U.UnsupportedConditionalFormatEntityRangeText},Wd=function(){return U.ActionButtonApply};var zd;!function(e){e.CopilotChat="copilotChat",e.Reviewer="reviewerAgent",e.DirectSkill="directSkill",e.DevTools="devTools",e.AugloopDiagnostics="augloopDiagnostics",e.AugloopModelVisualizer="augloopModelVisualizer"}(zd||(zd={}));const jd={copilotChat:"Copilot",reviewerAgent:"Reviewer",directSkill:"Direct Skill",devTools:"Dev tools",augloopDiagnostics:"Augloop Diagnostics",augloopModelVisualizer:"Augloop Model Visualizer"},Qd=()=>V.CseSelfHelpSkillContentRetrievedQuickAnswer,Jd=()=>V.CseSelfHelpSkillContentRetrievedSingleArticle,Yd=()=>V.CseSelfHelpSkillErrorOrNoContentRetrieved,Xd=()=>U.CseSelfHelpSkillSourceLabel,Zd=()=>V.ChatInputCharacterLimitExceededMessage,Kd=()=>U.ODSLGeneralError,eu=function(){return U.ServerErrorWithNoRetry},tu=()=>U.ElseSkillGeneralError,au=()=>U.FallbackSkillLatencyMessage,nu=()=>U.AugLoopSearchAndActionError,ou=()=>U.AugLoopSearchAndActionErrorImproved,ru=()=>U.AugLoopImageChatError,iu=()=>U.AugLoopNoTableError,lu=()=>U.AugLoopNoTableError2,su=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorValueFormula:"How do I fix the #VALUE! error in my table when using the {formula} formula?",cu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorValue:"How do I fix the #VALUE! error in my table?",du=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorNameFormula:"How do I fix the #NAME! error in my table when using the {formula} formula?",uu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorName:"How do I fix the #NAME! error in my table?",mu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorRefFormula:"How do I fix the #REF! error in my table when using the {formula} formula?",hu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorRef:"How do I fix the #REF! error in my table?",gu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorSpillFormula:"How do I fix the #SPILL! error in my table when using the {formula} formula?",pu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorSpill:"How do I fix the #SPILL! error in my table?",bu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorDiv0Formula:"How do I fix the #DIV/0! error in my table when using the {formula} formula?",fu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorDiv0:"How do I fix the #DIV/0! error in my table?",Cu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorNumFormula:"How do I fix the #NUM! error in my table when using the {formula} formula?",yu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorNum:"How do I fix the #NUM! error in my table?",vu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorCalcFormula:"How do I fix the #CALC! error in my table when using the {formula} formula?",xu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorCalc:"How do I fix the #CALC! error in my table?",Tu=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorNAFormula:"How do I fix the #N/A error in my table when using the {formula} formula?",Su=()=>G()?ExcelCopilotStringsNTier.PromptFormulaErrorNA:"How do I fix the #N/A error in my table?",wu=()=>G()?ExcelCopilotStringsNTier.PromptNumbersStoredAsText:"How do I convert numbers stored as text to numbers?",Eu=()=>G()?ExcelCopilotStringsNTier.PromptSortData:"How do I sort data?",Iu=()=>G()?ExcelCopilotStringsNTier.PromptFormatNumbers:"How do I format numbers in Excel?",Ru=()=>G()?ExcelCopilotStringsNTier.PromptWrapText:"How do I wrap text in a cell?",Au=()=>G()?ExcelCopilotStringsNTier.PromptApplyDataValidation:"How do I apply data validation to cells?",Lu=()=>G()?ExcelCopilotStringsNTier.PromptFilerData:"How do I filter data in a table?",ku=()=>G()?ExcelCopilotStringsNTier.PromptMergeCells:"How do I merge and unmerge cells?",Fu=()=>G()?ExcelCopilotStringsNTier.PromptAccessibilityChecker:"How do I improve accessibility with the accessibility checker?",_u=()=>G()?ExcelCopilotStringsNTier.PromptConditionalFormattingHighlighting:"How do I use conditional formatting to highlight information?",Pu=()=>G()?ExcelCopilotStringsNTier.PromptSplitText:"How do I spilt text into different columns?",Nu=()=>G()?ExcelCopilotStringsNTier.PromptPageBreaks:"How do I insert, move, or delete page breaks?",Mu=()=>G()?ExcelCopilotStringsNTier.PromptInsertDeleteRowsColumns:"How do I insert or delete rows and columns?",Ou=()=>G()?ExcelCopilotStringsNTier.PromptInconsistentFormulaFormula:"How do I fix the inconsistent formula in my table when using the {formula} formula?",Du=()=>G()?ExcelCopilotStringsNTier.PromptInconsistentFormula:"How do I fix the inconsistent formula in my table?",Bu=()=>G()?ExcelCopilotStringsNTier.PromptUnprotectedFormulaFormula:'How do I fix the "Unprotected Formula" error when using the {formula} formula?',$u=()=>G()?ExcelCopilotStringsNTier.PromptUnprotectedFormula:'How do I fix the "Unprotected Formula" error?',Hu=()=>G()?ExcelCopilotStringsNTier.PromptInconsistentCalculatedColumnFormula:"How do I fix the inconsistent calculated column error when using {formula} formula?",Uu=()=>G()?ExcelCopilotStringsNTier.PromptInconsistentCalculatedColumn:"How do I fix the inconsistent calculated column error?",qu=()=>U.TabularRangeUnrecognizedTableError,Vu=()=>U.TabularRangeUnrecognizedTableDueToWorkbookSizeError,Gu=()=>U.TabularRangeRowMajorSingleError,Wu=()=>U.TabularRangeRowMajorMultipleError,zu=()=>U.TabularRangeRowMajorErrorHeader,ju=()=>U.TabularRangeMergedCellsSingleError,Qu=()=>U.TabularRangeMergedCellsMultipleError,Ju=()=>U.TabularRangeMergeCellsErrorHeader,Yu=()=>U.TabularRangeAggregationsSingleError,Xu=()=>U.TabularRangeAggregationsMultipleError,Zu=()=>U.TabularRangeAggregationsErrorHeader,Ku=()=>U.TabularRangeMultipleHeaderRowsSingleError,em=()=>U.TabularRangeMultipleHeaderRowsMultipleError,tm=()=>U.TabularRangeMultipleHeaderRowsErrorHeader,am=()=>U.TabularRangeNoHeaderColumnsSingleError,nm=()=>U.TabularRangeNoHeaderColumnsMultipleError,om=()=>U.TabularRangeNoHeaderColumnsErrorHeader,rm=()=>U.TabularRangeInterpretationConfidenceSingleError,im=()=>U.TabularRangeInterpretationConfidenceMultipleError,lm=()=>U.TabularRangeInterpretationConfidenceErrorHeader,sm=()=>U.TabularRangeEmptyHeadersSingleError,cm=()=>U.TabularRangeEmptyHeadersMultipleError,dm=()=>U.TabularRangeEmptyHeadersErrorHeader,um=()=>U.TabularRangeDuplicateHeadersSingleError,mm=()=>U.TabularRangeDuplicateHeadersMultipleError,hm=()=>U.TabularRangeDuplicateHeadersErrorHeader,gm=()=>U.TabularRangeCrosstabSingleError,pm=()=>U.TabularRangeCrosstabMultipleError,bm=()=>U.TabularRangeCrosstabErrorHeader,fm=()=>U.TabularRangeMultipleErrorCardIntro,Cm=()=>U.TabularRangeMultipleErrorCardConclusion,ym=()=>U.TabularRangeMultipleErrorCardConvertToTableConclusion,vm=()=>U.TLRTooSmallMessage,xm=()=>G()?ExcelCopilotStringsNTier.PromptPythonError:'Help with the Python error "{error}"',Tm=function(){return(0,o.k64)()&&(0,o.yw9)("OfficeVSO_9196996_LocalizeMultipleEventsError")?U.MultipleEventsExecutionErrorText:"I couldn't finish your request. If something isn't right, use Undo to remove my changes."},Sm=function(){return void 0!==ExcelCopilotCommandingHitlStrings?ExcelCopilotCommandingHitlStrings.TableClearSortLabel:"Remove sorting on table ${tableName}"},wm=()=>"Qtr1",Em=()=>"Qtr2",Im=()=>"Qtr3",Rm=()=>"Qtr4",Am=()=>"Jan",Lm=()=>"Feb",km=()=>"Mar",Fm=()=>"Apr",_m=()=>"May",Pm=()=>"Jun",Nm=()=>"Jul",Mm=()=>"Aug",Om=()=>"Sep",Dm=()=>"Oct",Bm=()=>"Nov",$m=()=>"Dec",Hm=function(){return"Sorry, I can't do multiple things at once. For the best experience, add one request at a time."},Um=function(){return"I'm not able to make changes in those cells because they're outside of the Excel Table. Try making changes to cells inside of the Excel Table."},qm=function(){return"I can only modify table structures relative to the visible cells in your table. Please unhide cells, clear filters, or phrase your prompt using a target location relative to the visible cells. If you need further assistance, let me know."},Vm=function(){return"I can't make those changes at the same time. The order of the changes would impact the cell locations and effect the target locations of the next changes. Please separate your changes into independent prompts, and try them again."},Gm=function(){return"I couldn't complete your request. Please restate the part of your request that needs to be finished."},Wm=function(){return"I couldn't create {0}, but here's an answer that may be helpful."},zm=function(){return"I need more practice before I can do that. For now, I'll share the steps you can follow."},jm=function(){return"Want to undo?  Here's how:"},Qm=function(){return'Select "Home" > "Undo"'},Jm=function(){return'Press "Ctrl"+ "Z" on your keyboard'},Ym=function(){return'Press "CMD"+ "Z" on your keyboard'},Xm=function(){return"Want to add alternative text (alt text) to this table? Here's how:"},Zm=function(){return"Right-click on the table."},Km=function(){return'Select "Table" > "Alt Text".'},eh=function(){return'Select "Table" > "Alternative Text".'},th=function(){return"Want to add a comment? Here's how:"},ah=function(){return"Right-click on the cell."},nh=function(){return'Select "New Comment".'},oh=function(){return"Enter your comment and mention people who need to view it if needed."},rh=function(){return'Select "Post".'},ih=function(){return"Want to apply data validation to cells? Here's how: "},lh=function(){return"Select one or more cells you want to create a rule for."},sh=function(){return'Select "Data" > "Data Validation".'},ch=function(){return'On the "Settings" tab, under Allow, select an option.'},dh=function(){return"Enter information for additional settings."},uh=function(){return'Select "Error Alert" to customize the error message.'},mh=function(){return'Select "OK".'},hh=function(){return"Want to create a pivot table? Here's how:"},gh=function(){return"Select the cells you want to use to create the pivot table."},ph=function(){return'Select "Insert" > "PivotTable" > "Select a table or range".'},bh=function(){return"Make sure the cell range is correct."},fh=function(){return'Select "New Woksheet" or "Existing Worksheet" to set where you want the pivot table to appear. '},Ch=function(){return'Select "OK".'},yh=function(){return"Want to add, delete, or rename a worksheet?"},vh=function(){return'To add a worksheet: Select the "New Sheet" icon or "Home" > "Insert" > "Insert Sheet".'},xh=function(){return'To delete a worksheet: Right-click the "Sheet" tab and select "Delete" or "Home" > "Delete" > "Delete Sheet".'},Th=function(){return'To rename a worksheet: Double-click the name on the "Sheet" tab. You can also right-click on the "Sheet" tab, select "Rename", and type a new name.'},Sh=function(){return"Want to freeze rows or columns?  Here's how:"},wh=function(){return"Select the cell below the rows, and to the right of the columns you want to freeze."},Eh=function(){return'Select "View" > "Freeze Panes" > "Freeze Panes". Or, choose another option depending on what you want to freeze.'},Ih=function(){return"I can't insert a table into the sheet. However, I can try to help you using a table that's already in the sheet."},Rh=function(){return"I don't currently have a way to know which cells you selected. Please specify the cells, columns, or rows you want me to work with."},Ah=function(){return"Sorry, I can't remove sorting from the table. Please tell me how you'd like to sort the table, or make a new request."},Lh=function(){return"Sorry, I can't apply conditional formatting to this range. Make sure it includes accounting, currency, fraction, number, percentage, or scientific formatting and try again."},kh=function(){return"Sorry, I can't apply conditional formatting to this range. Make sure it includes a date or time format and try again."},Fh=function(){return"Sorry, I can't apply conditional formatting to this range. Make sure it includes a text, special, date, or time format and try again."},_h=function(){return"Sorry, I can't apply conditional formatting to this range. Remove any general, custom, or text formatting for the range and try again."},Ph=function(){return"Sorry, I can't apply a numeric filter (greater than, less than, between, or their negations) to a column that's not numeric. Make sure it doesn't contain text or true/false data, and try again."},Nh=function(){return"Sorry, I can't apply a text filter (begins with, ends with, contains, or their negations) to a column that's not textual. Make sure it doesn't contain numeric or true/false data, and try again."},Mh=function(){return"Sorry, I can't delete the row(s). Is there anything else I can help you with?"},Oh=function(){return"Sorry, I can't modify the column(s). Is there anything else I can help you with?"},Dh=function(){return"Sorry, I can't modify the entity. Make sure the correct entity is selected and try again."},Bh=()=>U.PivotTableChartPresentWithoutTableTLRError,$h=()=>U.PivotTableChartPresentWithoutTableTLRError2,Hh=()=>U.NoPatternsFoundError,Uh=function(){return U.FixItButtonText},qh=function(){return U.TabularRangeAutoFixDuplicateHeadersSuccessfulResponse},Vh=function(){return U.TabularRangeAutoFixDuplicateHeadersUnsuccessfulResponse},Gh=function(){return U.TabularRangeAutoFixMergedCellsSuccessfulResponse},Wh=function(){return U.TabularRangeAutoFixMergedCellsUnsuccessfulResponse},zh=function(){return U.TabularRangeAutoEmptyHeadersSuccessfulResponse},jh=function(){return U.TabularRangeAutoEmptyHeadersUnsuccessfulResponse},Qh=function(){return U.NoAutoFixCompleted},Jh=function(){return U.TabularRangeAutoFixDuplicateHeaders},Yh=function(){return U.HeaderColumnLabel},Xh=function(){return U.HeaderRowLabel},Zh=function(){return U.TlrAutoFixConfirmationMultipleCases},Kh=function(){return U.TlrAutoFixUnsuccessful},eg=function(){return U.AutoFixMoreThanTwoMergedCells},tg=function(){return U.AutoFixTwoMergedCells},ag=function(){return U.AutoFixOneMergedCells},ng=function(){return U.AutoFixMultipleMergedCellsDescription},og=function(){return U.AutoFixMoreThanTwoEmptyCells},rg=function(){return U.AutoFixTwoEmptyCells},ig=function(){return U.AutoFixOneEmptyCells},lg=function(){return U.AutoFixMoreThanTwoDuplicateCells},sg=function(){return U.AutoFixTwoDuplicateCells},cg=function(){return U.AutoFixIntroduction},dg=()=>U.ExplainTablesPill,ug=()=>U.ExplainHeadersPill,mg=()=>U.ExplainUnmergingCellsPill,hg=()=>{switch((0,n.vI)()){case Office.PlatformType.OfficeOnline:return"cmmyfd4mgl3";case Office.PlatformType.Mac:return"cmmweb1zw6v";case Office.PlatformType.PC:return"cmml0h1c9sd";case Office.PlatformType.iOS:return"cmmuefjswpd";default:return}},gg=()=>(0,n.vI)()===Office.PlatformType.Mac?"excelmac":"excel",pg=()=>V.OutOfCreditsError,bg=()=>U.SuggestFullThemeAnalysisPrompt,fg=()=>U.SuggestFullThemeAnalysisButton,Cg=()=>U.SuggestFullThemeAnalysisQuery,yg=()=>"Insert Suggestion",vg=()=>["Inserting suggestion..."],xg=()=>"Done! I inserted the formula suggestion.",Tg=()=>"I'm having trouble inserting formula columns right now. Try sending your prompt later.",Sg=()=>U.TextAnalysisSummayInsertionColumnName,wg=()=>U.TextAnalysisSentimentInsertionColumnName,Eg=()=>"Unable to render the chart. Please try again later.",Ig=()=>V.DKEAndNotExtractLabelErrorString??"Copilot can't reference this content because your organization's policy doesn't allow it.",Rg={colorBrandForeground1:"#60BD82",colorBrandForegroundLink:"#60BD82",colorBrandForegroundLinkPressed:"#37A660",colorBrandForegroundLinkSelected:"#60BD82",colorBrandForegroundLinkHover:"#A0D8B9",colorNeutralForeground2BrandHover:"#60BD82",colorNeutralForeground2BrandPressed:"#37A660",colorBrandForeground2:"#A0D8B9",colorBrandForeground2Hover:"#FFFFFF"}},270750:(e,t,a)=>{"use strict";a.d(t,{Az:()=>m,BC:()=>h,D9:()=>g,Ei:()=>S,ON:()=>n,P6:()=>C,Pl:()=>F,QN:()=>L,Qi:()=>p,SB:()=>d,U$:()=>_,Vs:()=>E,Wn:()=>A,Wx:()=>y,Yg:()=>w,Zx:()=>c,e0:()=>R,gv:()=>k,hr:()=>u,iR:()=>v,kd:()=>T,r$:()=>x,tF:()=>f,vA:()=>s,w8:()=>i,wm:()=>o,yX:()=>I,z8:()=>b});const n="#FFFFFF",o="#D2D2D2",r="#ED7331",i="#595959",l="#0000FF",s=["#DD5A13",l],c=o,d=r,u=[r,l],m=50,h=33,g=3,p=7,b=-30,f=100,C=20,y=.33,v=.07,x=.1,T=3,S="#F0F0F0",w=i,E="Dot",I=2,R="inherit",A=8.25,L=7.4,k=["h:mm AM/PM","h:mm:ss AM/PM","AM/PM h:mm;","AM/PM h:mm:ss;","h:mm","h:mm:ss","m/d/yyyy h:mm","mm:ss","ms:ss.0","[h]:mm:ss","h:mm AM/PM;@","h:mm:ss AM/PM;@","AM/PM h:mm;@","AM/PM h:mm:ss;@","h:mm;@","h:mm:ss;@","mm:ss.0;@","[h]:mm:ss;@","m/d/yy h:mm;@"],F=255,_=255},272487:(e,t,a)=>{"use strict";a.d(t,{_fShowPreloadedCopilot:()=>Be,copilotPaneStartTimestampAfterPreload:()=>De,excelTaskPaneStartTime:()=>He,getHasPreloadedCopilotBeenShown:()=>Le,getPreloadCopilot:()=>Te,isSDXRenderingForPreload:()=>$e,useHasPreloadedCopilotBeenShown:()=>Ae,usePreloadCopilot:()=>xe,useUnifiedPromptPrivateApiMessage:()=>Pe});var n,o,r,i,l,s,c,d,u,m,h,g,p,b,f,C=a(725556);!function(e){e.Activated="Activated",e.Removed="Removed",e.ActivateCopilotAgent="activateCopilotAgent",e.RemoveCopilotAgent="removeCopilotAgent"}(n||(n={})),function(e){e[e.LaunchMos=2001]="LaunchMos",e[e.GetFullDocumentHtml=2003]="GetFullDocumentHtml",e[e.InvokeCanvasTool=2004]="InvokeCanvasTool",e[e.ReadAloud=2005]="ReadAloud",e[e.InvokeAugmentCanvasTool=2006]="InvokeAugmentCanvasTool"}(o||(o={})),function(e){e.BizchatHostContextUpdate="BizChatHostContextUpdate"}(r||(r={})),function(e){e.ChatType="ChatType",e.TaskPaneStart="TaskPane_Start",e.AppLoadStart="AppLoad_Start",e.OfficeJSReady="OfficeJS_Ready",e.PreloadCopilot="PreloadCopilot",e.LazyLoadCopilot="LazyLoadCopilot",e.FirstCopilotExperience="FirstCopilotExperience",e.ChatFirstRenderTime="ChatFirstRenderTime",e.IsPerfImprovementBizChatEnabled="IsPerfImprovementBizChatEnabled"}(i||(i={})),function(e){e.CHAT="chat",e.ERROR="error",e.LATENCY="latency",e.STK="stk"}(l||(l={})),function(e){e.ShowPreloadedCopilot="ShowPreloadedCopilot",e.PreloadCopilot="PreloadCopilot",e.TaskPaneVisibilityModeChanged="TaskPaneVisibilityModeChanged",e.TaskPaneVisibilityContextSwitch="TaskPaneVisibilityContextSwitch",e.PrivateAPIChatContextSwitch="PrivateAPIChatContextSwitch",e.CopilotEntryPointSelectorInfo="CopilotEntryPointSelectorInfo",e.BizChatDownloadFinishTime="BizChat_DownloadFinishTime",e.AppChatDownloadFinishTime="AppChat_DownloadFinishTime",e.ShowingPaneWhilePreloading="ShowingPaneWhilePreloading",e.MOSStoreDialogResponse="MOS_Store_Dialog_Response",e.OfficeAuthContextAccountType="OfficeAuthContextAccountType",e.BizChatInitialAppRunningState="BizChatInitialAppRunningState",e.BizChatAppRunningStateChange="BizChatAppRunningStateChange",e.HandoffFailed="HandoffFailed",e.BizChatAuthContextAccountInfoFetched="BizChat_Auth_Context_Account_Info_Fetched_By_SDX",e.BizChatHostContextAccountInfoFetched="BizChat_Host_Context_Account_Info_Fetched_By_SDX"}(s||(s={})),function(e){e.FeatureName="FeatureName",e.PPTUserCopilotPaneLoadTime="PPTUserCopilotPaneLoadTime",e.WordUserCopilotPaneLoadTime="WordUserCopilotPaneLoadTime",e.UserCopilotPaneLoadTime="UserCopilotPaneLoadTime",e.SDXResourcesLoadTime="SDXResourcesLoadTime"}(c||(c={})),function(e){e.ChatEventType="ChatEventType",e.ChatEventParameters="ChatEventParameters",e.CopilotSource="CopilotSource",e.ToolFunctionName="ToolFunctionName",e.RequestId="RequestId",e.ConversationId="ConversationId",e.DurationMs="DurationMs",e.DurationMsSinceHandoff="DurationMsSinceHandoff",e.ErrorMessage="ErrorMessage",e.IsSuccess="IsSuccess",e.EditSessionId="EditSessionId",e.HostEventType="HostEventType",e.IsSoftKeep="IsSoftKeep",e.IsLifecycleEvent="IsLifecycleEvent",e.OriginFeatureName="OriginFeatureName",e.OriginSubFeatureName="OriginSubFeatureName",e.NodesImpacted="NodesImpacted",e.Reason="Reason",e.LicenseType="LicenseType"}(d||(d={})),function(e){e.ErrorMessage="ErrorMessage",e.ErrorCode="ErrorCode",e.ErrorType="ErrorType",e.ErrorCategory="ErrorCategory",e.ErrorTag="ErrorTag",e.ErrorStack="ErrorStack",e.ErrorLevel="ErrorLevel"}(u||(u={})),function(e){e.FeatureActionType="FeatureActionType",e.FeatureName="FeatureName",e.SubFeatureName="SubFeatureName",e.EntryPoint="EntryPoint",e.InteractionId="InteractionId",e.ConversationId="ConversationId",e.IsUserInitiated="IsUserInitiated"}(m||(m={})),function(e){e.BizChatPaneLoad="BizChatPaneLoad",e.AppChatPaneLoad="AppChatPaneLoad"}(h||(h={})),function(e){e.M365CopilotChat="M365CopilotChat",e.AppChat="AppChat",e.Researcher="Researcher",e.Analyst="Analyst",e.AgentMode="AgentMode",e.DataShaping="DataShaping",e.Disabled="Disabled"}(g||(g={})),function(e){e.Success="Success",e.Failure="Failure"}(p||(p={})),function(e){e.AuthContextUndefined="AuthContext_Undefined",e.ErrorFetchingUserObject="Error_Fetching_User_Object_From_AuthContext",e.FailedToFetchUserObject="Failed_To_Fetch_User_Object_From_AuthContext",e.SucceededAllFieldsPresent="AuthContext_AccountInfo_Succeeded_All_Fields_Present",e.SucceededMissingFields="AuthContext_AccountInfo_Succeeded_With_Missing_Fields"}(b||(b={})),function(e){e.Warning="Warning",e.Error="Error",e.Info="Info",e.Debug="Debug"}(f||(f={}));var y=a(758651),v=function(e,t,a){if(a||2===arguments.length)for(var n,o=0,r=t.length;o<r;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},x=function(){function e(){this.queuedEvents=[]}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.logEvent=function(e,t){var a={type:e,data:t};this.telemetryHandler?this.sendTelemetryEvent(a):(this.queuedEvents.push(a),y.log("Telemetry event queued:",a))},e.prototype.setHandler=function(e){var t=this;this.telemetryHandler=e;var a=v([],this.queuedEvents,!0);this.queuedEvents=[],a.forEach((function(e){return t.sendTelemetryEvent(e)}))},e.prototype.getHandler=function(){return this.telemetryHandler},e.prototype.getQueuedEventCount=function(){return this.queuedEvents.length},e.prototype.clearQueue=function(){this.queuedEvents=[]},e.prototype.reset=function(){this.telemetryHandler=void 0,this.queuedEvents=[]},e.prototype.sendTelemetryEvent=function(e){if(this.telemetryHandler)try{switch(e.type){case l.STK:this.telemetryHandler.sendTelemetryCopilotChatData(e.data);break;case l.CHAT:this.telemetryHandler.sendTelemetryChatEventData(e.data);break;case l.ERROR:this.telemetryHandler.sendTelemetryErrorData(e.data);break;case l.LATENCY:this.telemetryHandler.sendTelemetryLatencyData(e.data)}}catch(e){}},e}(),T=function(){function e(){this.logEntries=[]}return e.prototype.addInitializationLogs=function(e){var t,a;return e.taskPaneStartTime&&this.logEntries.push({key:i.TaskPaneStart,value:e.taskPaneStartTime.toString()}),e.appLoadStartTime&&this.logEntries.push({key:i.AppLoadStart,value:e.appLoadStartTime.toString()}),e.officeOnReadyTime&&this.logEntries.push({key:i.OfficeJSReady,value:e.officeOnReadyTime.toString()}),e.firstCopilotExperience&&this.logEntries.push({key:i.FirstCopilotExperience,value:e.firstCopilotExperience}),e.chatFirstRenderTime&&this.logEntries.push({key:i.ChatFirstRenderTime,value:e.chatFirstRenderTime}),e.isPerfImprovementBizChatEnabled&&this.logEntries.push({key:i.IsPerfImprovementBizChatEnabled,value:e.isPerfImprovementBizChatEnabled}),e.preloadTime?this.logEntries.push({key:i.PreloadCopilot,value:e.preloadTime,copilotSource:e.isBizChat?"BizChat":"AppChat"}):this.logEntries.push({key:i.LazyLoadCopilot,value:null!==(a=null===(t=e.taskPaneStartTime)||void 0===t?void 0:t.toString())&&void 0!==a?a:"",copilotSource:e.isBizChat?"BizChat":"AppChat"}),this},e.prototype.enqueue=function(){var e=x.getInstance();this.logEntries.forEach((function(t){var a,n;e.logEvent(l.CHAT,[{key:d.ChatEventType,value:t.key},{key:d.ChatEventParameters,value:null!==(a=t.value)&&void 0!==a?a:""},{key:d.CopilotSource,value:null!==(n=t.copilotSource)&&void 0!==n?n:""}])}))},e}(),S=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},w=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function E(e){return e?"undefined"!=typeof Office&&Office.context&&Office.context.document?Office.context.document.settings:void 0:"undefined"!=typeof Office&&Office.context?Office.context.hostSettings:void 0}function I(e,t){var a,n=null===(a=E(t))||void 0===a?void 0:a.get(e.toString());return null==n?n:"object"==typeof n?JSON.stringify(n):n.toString()}var R=function(e){return((new Date).getTime()-e)/1e3},A=function(e){return(new Date).getTime()-e};var L,k,F=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},_=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function P(e,t){try{var a=e.context.document.settings.get("BizChatHostContext");"string"==typeof a&&(a=JSON.parse(a));var n=null==a?void 0:a.PrimaryUserAccountInfo;if(null==n?void 0:n.AccountType){var o=n.AccountType,r=n.ObjectId,i=n.TenantId;if(t){var c=[];r||c.push("userObjectId"),i||c.push("tenantId"),o||c.push("accountType"),t&&t.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.BizChatHostContextAccountInfoFetched},{key:d.ChatEventParameters,value:JSON.stringify({resultStatus:p.Success,resultCode:c.length>0?b.SucceededMissingFields:b.SucceededAllFieldsPresent,presentKeys:Object.keys(n),missingFields:c})}])}return{accountType:o,objectId:r,tenantId:i}}}catch(e){t&&(t.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.BizChatHostContextAccountInfoFetched},{key:d.ChatEventParameters,value:JSON.stringify({resultStatus:p.Failure,resultCode:b.ErrorFetchingUserObject,description:"Error fetching user object from OfficeJS: ".concat(e)})}]),t.logEvent(l.ERROR,[{key:u.ErrorCategory,value:"BizChatNativeRenderer"},{key:u.ErrorCode,value:"sdx-bizchat-host-context-fetch-account-info-error"},{key:u.ErrorMessage,value:"Error fetching user object from OfficeJS: ".concat(e)},{key:u.ErrorLevel,value:f.Error}]))}}!function(e){e.EnableBizchatHostContext="EnableBizchatHostContext",e.UseHandoffMessagePropertiesValue="UseHandoffMessagePropertiesValue",e.ShouldDefaultToBizChat="ShouldDefaultToBizChat",e.EnableInsecureHostAppSettings="EnableInsecureHostAppSettings",e.EnableM365UserClickTimePerformanceMark="EnableM365UserClickTimePerformanceMark",e.EnableAgentSwitchInCatalystViaEntryPoint="EnableAgentSwitchInCatalystViaEntryPoint",e.IsHandoffsToAppChatDisabled="IsHandoffsToAppChatDisabled",e.UseHandoffSettingNameInCaps="UseHandoffSettingNameInCaps",e.EnablePassingAppRunningStateToBizChat="EnablePassingAppRunningStateToBizChat",e.EnableUserAuthInfoFromBizChatHostContext="EnableUserAuthInfoFromBizChatHostContext",e.EnableOfficeAuthContextAccountTypeLog="EnableOfficeAuthContextAccountTypeLog",e.RemoveSDXConsumerFGCheck="RemoveSDXConsumerFGCheck",e.RemoveUppercaseHandoffMessage="RemoveUppercaseHandoffMessage",e.StopReturnAppChatWhenHandoffError="StopReturnAppChatWhenHandoffError"}(L||(L={})),function(e){e.FallbackHandoffsToAppChat="FallbackHandoffsToAppChat",e.ShouldCheckUserLicense="ShouldCheckUserLicense",e.EnableM365CopilotChatStarter="EnableM365CopilotChatStarter",e.EnableM365CopilotChat="EnableM365CopilotChat",e.UseInitialClickTimeFromContext="UseInitialClickTimeFromContext"}(k||(k={}));var N=function(){return N=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},N.apply(this,arguments)},M=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},O=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},D=function(){function e(){var t=this;this.initialState=null,this.state={isAppInForeground:!1,userOpenedCopilotUtcTime:void 0},this.listeners=new Set,this.isTimeFromContextAvailable=!1,this.getSnapshot=function(){return t.state},this.sendLog=function(a,n){var o={appRunningState:n};null!==t.isTimeFromContextAvailable&&(o.usedTimeFromContext=t.isTimeFromContextAvailable),e.telemetryEventManager.logEvent(l.CHAT,[{key:d.ChatEventType,value:a},{key:d.ChatEventParameters,value:JSON.stringify(o)}])}}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.setIntialValue=function(e,t,a){var n=this;void 0===a&&(a=null),this.isTimeFromContextAvailable=a,this.initialState=function(e){return S(this,void 0,void 0,(function(){var t,a,n,o;return w(this,(function(r){switch(r.label){case 0:if(!(null==e?void 0:e.addin))return[2,!0];if(t="Taskpane"===(null===(a=null==e?void 0:e.addin)||void 0===a?void 0:a.visibilityMode),"function"!=typeof(null===(o=null===(n=null===window||void 0===window?void 0:window.Office)||void 0===n?void 0:n.addin)||void 0===o?void 0:o._getState)||"OfficeOnline"===(null==e?void 0:e.platform))return[2,t];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,window.Office.addin._getState()];case 2:return[2,"Visible"===r.sent()];case 3:return r.sent(),[2,t];case 4:return[2]}}))}))}(e).then((function(e){n.doSetState({isAppInForeground:e,userOpenedCopilotUtcTime:t},!1),n.sendLog(s.BizChatInitialAppRunningState,n.state)}))},e.prototype.setState=function(e){return M(this,void 0,void 0,(function(){var t,a=this;return O(this,(function(n){return null===(t=this.initialState)||void 0===t||t.then((function(){a.doSetState(e)})),[2]}))}))},e.prototype.getState=function(){return this.state},e.prototype.subscribe=function(e){var t=this;return this.listeners.add(e),function(){t.listeners.delete(e)}},e.prototype.doSetState=function(e,t){var a=this;void 0===t&&(t=!0),this.state.isAppInForeground!==e.isAppInForeground&&(this.state=N(N({},this.state),e),t&&this.sendLog(s.BizChatAppRunningStateChange,this.state)),this.listeners.forEach((function(e){return e(a.state)}))},e.telemetryEventManager=x.getInstance(),e}(),B=a(403377),$=a(774791),H="Dogfood",U="GCC",q="MSIT",V="Prod",G="Test",W="Microsoft",z="Production",j="Automation";function Q(e){var t=e.audienceGroup,a=e.augloopServiceUrl,n=function(e){void 0===e&&(e=window.location.href);var t=e.toLowerCase();if(""===t)return B.RD.Unknown;if(t.indexOf("dod.cdn")>=0)return B.RD.DoD;if(t.indexOf("gcch.cdn")>=0)return B.RD.GCCHigh;if(t.indexOf("gcc.cdn")>=0)return B.RD.GCCModerate;if((t.indexOf("public.cdn")>=0||t.indexOf("public.onecdn")>=0||t.indexOf(".resources.office")>=0)&&t.indexOf("033f92d3-bc6d-439a-858a-a17acf70360a")>=0)return B.RD.Production;return B.RD.Unknown}();return n===B.RD.Unknown&&t&&(n=function(e){switch(e){case j:case G:case H:return B.RD.Dogfood;case q:case W:return B.RD.MSIT;case V:case z:return B.RD.Production;case U:return B.RD.GCCModerate;default:return B.RD.Unknown}}(t)),n===B.RD.Unknown&&a&&(n=function(e){if(!e)return B.RD.Unknown;var t=e.toLowerCase();return t.indexOf("augloop-msit.office.com")>=0||t.indexOf("msit.augloop.svc.cloud.microsoft")>=0?B.RD.MSIT:t.indexOf("augloop-gcc.office.com")>=0||t.indexOf("gcc.augloop.svc.cloud.microsoft")>=0?B.RD.GCCModerate:t.indexOf("augloop.gov.online.office365.us")>=0?B.RD.GCCHigh:t.indexOf("augloop.dod.online.office365.us")>=0?B.RD.DoD:t.includes("dogfood")?B.RD.Dogfood:B.RD.Production}(a)),n}function J(e){switch(e){case B.RD.Dev:case B.RD.Dogfood:return"Df";case B.RD.MSIT:return"Msit";case B.RD.Preview:case B.RD.Production:return"Prod";case B.RD.GCCModerate:return"GccModerate";case B.RD.GCCHigh:return"GccHigh";case B.RD.DoD:return"DoD";default:return"Unknown"}}function Y(e,t,a,n){var o=function(e,t,a){return function(){try{return a("".concat(e,"DensityVersion"),t)||t}catch(e){return t}}}(e,t,a);return{createRuntimeFactory:function(e){var t=o(),a=function(e){var t=J(e);return(0,$.p)({environment:t})}(Q(n));return e({allowUrlOverrides:!0,version:t,baseUrl:a})}}}var X,Z=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},K=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},ee=function(){function e(){this.apiHandlers=new Map}return e.getInstance=function(){return e.PrivateApi||(e.PrivateApi=new e),e.PrivateApi},e.prototype.initializePrivateApi=function(){return Z(this,arguments,void 0,(function(e){var t=this;return void 0===e&&(e=0),K(this,(function(a){switch(a.label){case 0:return a.trys.push([0,2,,3]),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(a){return Z(t,void 0,void 0,(function(){var t,n;return K(this,(function(o){switch(o.label){case 0:return e>0?[4,new Promise((function(t){return setTimeout(t,e)}))]:[3,2];case 1:o.sent(),o.label=2;case 2:0;try{t=JSON.parse(a)}catch(e){t=null}return(null==t?void 0:t.eventName)&&(n=this.apiHandlers.get(t.eventName))&&n instanceof Function&&(n(t),!0),[2]}}))}))}))];case 1:return a.sent(),[3,3];case 2:return a.sent(),[3,3];case 3:return[2]}}))}))},e.prototype.openMOSDialog=function(){return Z(this,void 0,void 0,(function(){var e;return K(this,(function(t){switch(t.label){case 0:return e={dispidMethod:o.LaunchMos},[4,this.execute(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getFullDocumentHtml=function(){return Z(this,void 0,void 0,(function(){var e;return K(this,(function(t){return e={dispidMethod:o.GetFullDocumentHtml},[2,this.execute(e)]}))}))},e.prototype.execute=function(e){return Z(this,void 0,void 0,(function(){return K(this,(function(t){return[2,OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))]}))}))},e.prototype.triggerReadAloud=function(){return Z(this,void 0,void 0,(function(){var e;return K(this,(function(t){return e={dispidMethod:o.ReadAloud},[2,this.execute(e)]}))}))},e.prototype.attachPrivateEventHandler=function(e,t){this.apiHandlers.has(e),this.apiHandlers.set(e,t)},e}();!function(e){e.TellMe="TellMe",e.WordCopilotComposeSelection="WordCopilotComposeSelection",e.ContextMenuRewriteClickAction="ContextMenuRewriteClickAction",e.WordCopilotRewriteSelection="WordCopilotRewriteSelection",e.SkittleContextMenuUserClickAction="SkittleContextMenuUserClickAction",e.WordCopilotComprehensionPodcast="WordCopilotComprehensionPodcast",e.ResearcherAgent="ResearcherAgent",e.CopilotContextMenuClickAction="CopilotContextMenuClickAction",e.WordCopilotVisualAssistantDescribeImage="WordCopilotVisualAssistantDescribeImage",e.PPTFileNameRenamed="PPTFileNameRenamed",e.CopilotTranslatedPPTInfo="CopilotTranslatedPPTInfo",e.ExcelCopilotExplainSelection="ExcelCopilotExplainSelection",e.CopilotDab="copilotdab"}(X||(X={}));X.WordCopilotComprehensionPodcast,X.WordCopilotVisualAssistantDescribeImage,X.PPTFileNameRenamed,X.CopilotTranslatedPPTInfo,new Map([[X.TellMe,g.M365CopilotChat],[X.WordCopilotComposeSelection,g.M365CopilotChat],[X.ContextMenuRewriteClickAction,g.M365CopilotChat],[X.WordCopilotRewriteSelection,g.M365CopilotChat],[X.SkittleContextMenuUserClickAction,g.M365CopilotChat],[X.ResearcherAgent,g.M365CopilotChat],[X.CopilotContextMenuClickAction,g.M365CopilotChat],[X.WordCopilotComprehensionPodcast,g.AppChat],[X.ExcelCopilotExplainSelection,g.M365CopilotChat],[X.CopilotDab,g.M365CopilotChat]]);var te=a(984691),ae=a(554556),ne=a(145143),oe=a(240908),re=a(722307),ie=a(293435),le=a(998781),se=a(99394),ce=a(255448);const de="Microsoft.Office.Excel.FA000000124.";function ue(e,t=""){const a=OfficeRuntime.experimentation.getStringFeatureGate(de+e);return void 0!==a?a:t}function me(e,t=!1){const a=OfficeRuntime.experimentation.getBooleanFeatureGate(de+e);return void 0!==a?a:t}function he(e,t=!1){const a=OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FA000000124."+e);if(void 0!==a)return a;const n=OfficeRuntime.experimentation.getBooleanFeatureGate("Microsoft.Office.Shared.fa000000124."+e);return void 0!==n?n:t}function ge(e){return me(e,!0)}var pe=a(507628),be=a(208520),fe=a(794329),Ce=a(758651);let ye,ve;function xe(){const[e,t]=(0,be.useState)(ye);return ve=t,[e,t]}function Te(){return ye}function Se(e){ye=e,ve&&ve(e)}let we,Ee,Ie,Re=!1;function Ae(){const[e,t]=(0,be.useState)(Re);return we=t,[e,t]}function Le(){return Re}function ke(e=!0){sessionStorage?.setItem("preloadCopilot",JSON.stringify({isPreloaded:!0,isHidden:e}))}function Fe(){const e=sessionStorage?.getItem("preloadCopilot");return!!e&&JSON.parse(e).isPreloaded}function _e(e){const t=sessionStorage?.getItem("preloadCopilot");t&&ke(e)}function Pe(){const[e,t]=(0,be.useState)(Ee),a=be.useCallback((e=>{t((t=>{const a="function"==typeof e?e(t):e;return Ee=a,a}))}),[]);return Ie=a,[e,a]}let Ne=!1,Me=!1;const Oe=(new Date).getTime().toString();let De,Be=!1,$e=!1;const He=window.excelTaskPaneStartTime;let Ue,qe,Ve=!1,Ge=!1,We=!1;var ze;!function(e){e.Verbose="verbose",e.Info="info",e.Warning="warning",e.Error="error"}(ze||(ze={}));const je="shimmer";function Qe(){window.document.getElementById(je)?.style.setProperty("display","none")}const Je=be.memo((e=>(be.useEffect((()=>(window.document.getElementById(je)?.style.setProperty("display","block"),()=>{e.hideOnUnmount&&Qe()})),[e.hideOnUnmount]),null)));function Ye(e,t){if(Office?.context){const a="string"==typeof t?t:JSON.stringify(t);Office.context.hostSettings.set(e,a)}}function Xe(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}function Ze(e){return me("DisableCopilotSuggestionAutoExecution")&&"object"==typeof e&&null!==e&&"queryOrigin"in e&&e.queryOrigin===ce.Rk.GridContextMenu}function Ke(){const e="undefined"!=typeof navigator?navigator.userAgent??"":"";return/firefox/i.test(e)}function et(){const e=Ke(),t=function(){const e="undefined"!=typeof navigator?navigator.userAgent??"":"",t=/AppleWebKit/i.test(e),a=/Macintosh|Mac OS X/i.test(e),n=/Chrome|Chromium|Edg/i.test(e);return t&&a&&!n}();return e||t&&ge("OfficeVSO_11014539_unmountBizChatWebKit")}function tt(){let e;return e=Office.context.hostSettings.get("BizChatHostContext"),rt(e)}function at(e){if(!e)return;const t=ge("OfficeVSO_9905250_expandExcelHandoffMessageProperties"),a=ge("passUserQueryGuidToExcelHandoffMessageProperties"),n=ge("passPromptIdToExcelHandoffMessageProperties"),o=t&&Boolean(e.agent?.name&&e.agent?.id),r={handoffStartTime:t?e.handoffStartTime:void 0,hydratedEntities:t&&Array.isArray(e.hydratedEntities)?e.hydratedEntities:void 0,manualSendPrompt:t?e.manualSendPrompt:void 0,query:e.sendPromptText,sourceApp:ie.Ww.EXCEL,destinationApp:ie.Ww.EXCEL,scenarioName:ie.Cu.INAPP,agent:o?{...e.agent}:void 0,context:JSON.stringify({featureName:t&&e.handoffFeatureName?e.handoffFeatureName:Ze(e)?X.CopilotContextMenuClickAction:X.ExcelCopilotExplainSelection,cmmid:e.handoffCmmid,promptId:n&&e.promptId?e.promptId:void 0}),queryId:a&&e.userQueryGuid?e.userQueryGuid:(0,pe.A)(),language:(0,re.Yd)()||"en-US"};return new le.uC({...r,properties:o?{...r}:void 0})}let nt=!1;function ot(e){if(e){return function(e){if(e)try{const t=JSON.parse(e),a=t?.items?.[0]?.body;if(a)return nt="string"==typeof a.context&&-1!==a.context.indexOf("AppHomePagesManual"),new le.uC(a)}catch(t){lt("error","Failed to parse HandoffMessage:",t,"Raw value:",e)}}(Office.context.hostSettings.get("HandoffMessage"))}const t=Office.context.hostSettings.get("CopilotInitialPrompt");return at(t?.promptProperties)}function rt(e){if("string"!=typeof e)return e;try{return JSON.parse(e)}catch(e){return void lt("error","Failed to parse BizChatHostContext:",e)}}const it=()=>function(){const e=Office.context.hostSettings.get("AudienceGroup");return["Automation","Dogfood","MSIT","Microsoft"].includes(e)}();function lt(e,...t){if(!it())return;let a="info";e&&Object.values(ze).includes(e)?a=e:e&&t.unshift(e);const n="Excel Copilot Chat";switch(a){case"verbose":Ce.debug(`${n}`,...t);break;case"warning":Ce.warn(`${n}`,...t);break;case"error":Ce.error(`${n}`,...t);break;default:Ce.log(`${n}:`,...t)}}function st(e){if(De){const t=parseFloat(Xe(De));if(!isNaN(t))return lt("info",`${e} using preloaded pane start time: ${t}`),t}const t=He||Date.now();return lt("info",`${e} using task pane start time: ${t}`),t}function ct(e){if(ge("OfficeVSO_11052504_EnableExcelAgentPLTUPLTLogging")&&(e&&Ue!==e&&(Ue=e,lt("info",`PLT session tracker updated to: ${e}`)),!Ve)){const e=st("PLT"),t=Date.now()-e;lt("info",`[Excel Agent by default] PLT logged: ${t}ms (start time: ${e}, current: ${Date.now()})`),x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:"ExcelAgentByDefaultPLT"},{key:d.ChatEventParameters,value:t.toString()}]),Ve=!0}}const dt=e=>{const t=(new Date).getTime(),n=be.useMemo((()=>be.lazy((()=>Promise.all([a.e("chunk1jsfluent","high"),a.e("augloop-chunk","high"),a.e("office-iss","high"),a.e("vendors-npm_store_sdx_officecopilot_parse5_6_0_1-6346061a9d49819048e1_node_modules_parse5_lib-b0e687","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-utils_5_5_3-80056aa94553011f54c1_node-37a59a","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-biz-native-utils_1_10_15-c70c59a66d40-e4c1b7","high"),a.e("vendors-npm_store_sdx_officecopilot_hoist-non-react-statics_3_3_2-2c5f76ff0fb3eca13720_node_m-889939","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-m365card-runtime-types_16_0_16-11280aee659226d5e733_n-e3bdce","high"),a.e("default~appchat-lazy~excelagentexperimental-lazy","high"),a.e("appchat-lazy","high")]).then(a.bind(a,233488)).then((e=>(x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:s.AppChatDownloadFinishTime},{key:d.ChatEventParameters,value:A(t).toString()}]),{default:e.EntryPoint})))))),[]);return(0,C.jsx)(be.Suspense,{fallback:(0,C.jsx)(Je,{hideOnUnmount:!1}),children:(0,C.jsx)(n,{...e})})},ut=e=>{const{shouldReset:t,...n}=e,[o,r]=be.useState(!1);be.useEffect((()=>{ge("OfficeVSO_10750624_AddLastAgentModeActivationTimestamp")||i()}),[t]);const i=be.useCallback((()=>{r((e=>!e))}),[]),s=me("AugLoop.EAELanguageSupport"),c=be.useCallback((()=>{s&&Qe(),function(){if(ge("OfficeVSO_11052504_EnableExcelAgentPLTUPLTLogging")&&We&&!Ge){const e=st("UPLT"),t=Date.now()-e;lt("info",`[Excel Agent by default] UPLT logged: ${t}ms (start time: ${e}, current: ${Date.now()}) - input ready`),x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:"ExcelAgentByDefaultUPLT"},{key:d.ChatEventParameters,value:t.toString()}]),Ge=!0}}()}),[s]),u=(new Date).getTime(),m=be.useMemo((()=>be.lazy((()=>Promise.all([a.e("chunk1jsfluent","high"),a.e("editor","high"),a.e("augloop-chunk","high"),a.e("office-iss","high"),a.e("vendors-npm_store_sdx_officecopilot_parse5_6_0_1-6346061a9d49819048e1_node_modules_parse5_lib-b0e687","high"),a.e("vendors~excelagentexperimental-lazy~sccserviceciq~sccciqv2plugin","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-biz-native-utils_1_10_15-c70c59a66d40-e4c1b7","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-scc-react-streaming-renderer_6_5_119-49b79e688c42bcda-6e7345","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-scc-service-ciq_5_5_543-ca8df83e87c35e172ae9_node_mod-80c080","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-fai-react-copilot-chat_1_0_65-fe848b5168e6d33c88ea_no-7679ae","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-fai-react-attachments_1_0_63-9b1cb461966f346470e5_nod-1da88d","high"),a.e("default~appchat-lazy~excelagentexperimental-lazy","high"),a.e("excelagentexperimental-lazy","high")]).then(a.bind(a,801336)).then((e=>(s||Qe(),x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:"ExcelAgentExperimentalDownloadFinishTime"},{key:d.ChatEventParameters,value:A(u).toString()}]),{default:e.AgentFrame})))))),[s]);return(0,C.jsx)(be.Suspense,{fallback:(0,C.jsx)(Je,{hideOnUnmount:!1}),children:(0,C.jsx)(m,{...n,onReady:c})})},mt=e=>{const t=(new Date).getTime(),n=be.useMemo((()=>be.lazy((()=>a.e("vendors~bizchat","high").then(a.t.bind(a,312874,23)).then((e=>(x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:"BizChatDownloadFinishTime"},{key:d.ChatEventParameters,value:A(t).toString()}]),{default:e.ExcelBizChatNativeRenderer})))))),[]);return(0,C.jsx)(be.Suspense,{fallback:(0,C.jsx)(Je,{hideOnUnmount:!0}),children:(0,C.jsx)(n,{...e})})},ht=be.memo((e=>{const t=be.useMemo((()=>Y("Excel","1.20260107.10.0",ue,{audienceGroup:I("AudienceGroup")}).createRuntimeFactory(ae.K)),[]),a=be.useMemo((()=>{const e=(new Date).getTime();try{const a=t({});return x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:"BizChatDensityRuntimeCreated"},{key:d.ChatEventParameters,value:A(e).toString()}]),a}catch(e){return lt("error","Error setting creating BizChatDensityRuntime: ",e),void x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:"BizChatDensityRuntimeCreationFailed"}])}}),[t]);return(0,C.jsx)(ne.p,{value:a,children:(0,C.jsx)(oe.E,{lazyComponentPlaceholder:(0,C.jsx)(Je,{hideOnUnmount:!0}),...e})})})),gt=me("EnableHandoffMessageSwitchToBizChat"),pt=be.memo((e=>{const[t,a]=be.useState(tt()),n=be.useRef(t),[o,r]=be.useState(),[i,c]=be.useState(ot(gt)),u=be.useMemo((()=>x.getInstance()),[]),m=ge("OfficeVSO_10534523_enablePassingAppRunningStateToBizChat"),h=m?D.getInstance():void 0,p=be.useRef({}),b=be.useCallback(((e,a)=>({appRunningStateStore:h,densityEnvironment:J(Q({audienceGroup:I("AudienceGroup")})),initTelemetryHandler:a=>{var n,o;Ne||(n={isBizChat:e,taskPaneStartTime:He,officeOnReadyTime:qe,appLoadStartTime:Oe,preloadTime:ye?.toString()??"",firstCopilotExperience:t?.PrimaryUserAccountInfo?.CopilotExperience,chatFirstRenderTime:(new Date).getTime().toString(),isPerfImprovementBizChatEnabled:"true"},(o=new T).addInitializationLogs(n),o.enqueue(),Ne=!0),u.setHandler(a)},...e&&!a&&{handoffMessage:i},...e&&ge("OfficeVSO_10539287_preventAutoFocusOnInput")&&{isPanePreloadingInBackground:Me},...e&&ge(L.EnableAgentSwitchInCatalystViaEntryPoint)&&{agentRequestHandler:o}})),[h,i,o]),f=be.useCallback((e=>{const t=he("EnableM365CopilotChatStarter",!1)||he("EnableM365CopilotChat",!1);if(!ge(L.EnableAgentSwitchInCatalystViaEntryPoint)||!t)return;let o;try{o=JSON.parse(e)}catch(t){o=e}lt("info","Received copilot agent event:",JSON.stringify({...o})),u.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.MOSStoreDialogResponse},{key:d.CopilotSource,value:"BizChat"}]);const i=n.current?.PrimaryUserAccountInfo?.CopilotExperience;i===g.AppChat&&a((e=>e?{...e,PrimaryUserAccountInfo:{...e.PrimaryUserAccountInfo,CopilotExperience:g.M365CopilotChat}}:e));r(o)}),[u,a]),y=e=>{if("Taskpane"!==e.visibilityMode)return void(m&&D.getInstance().setState({isAppInForeground:!1}));m&&D.getInstance().setState({isAppInForeground:!0,userOpenedCopilotUtcTime:(new Date).getTime()});const t=tt();lt("info","BizchatHostContext re-initialized: ",t);const o=t?.PrimaryUserAccountInfo?.CopilotExperience;o!==n.current?.PrimaryUserAccountInfo?.CopilotExperience&&(r(void 0),a(t),n.current=t,u.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.TaskPaneVisibilityContextSwitch},{key:d.ChatEventParameters,value:o??""},{key:d.CopilotSource,value:"BizChat"}]))};be.useEffect((()=>{const e=()=>{if(!n?.current?.PrimaryUserAccountInfo)return!1;const e=n.current.PrimaryUserAccountInfo.AggregatedLicensedFeatures??n.current.PrimaryUserAccountInfo.LicensedFeatures??void 0;return!!e&&(!e.includes("Copilot")&&(e.includes("CopilotStarter")||e.includes("CopilotChat")))},t=e=>e===ce.Rk.GridContextMenu,o=ee.getInstance();o.attachPrivateEventHandler("unifiedExternalTriggeredPrompt",(o=>{const r=o.promptProperties;if(r){const l=me("EnableCopilotSuggestionBizChat")&&"queryOrigin"in r?r.queryOrigin:void 0;if(((a,n)=>a===X.CopilotDab||e()&&me("EnableCopilotStarterBizChat")||me("EnableCopilotSuggestionBizChat")&&t(n))(r.handoffFeatureName,l))return n?.current?.PrimaryUserAccountInfo?.CopilotExperience!==g.M365CopilotChat&&a({PrimaryUserAccountInfo:{...n?.current?.PrimaryUserAccountInfo,CopilotExperience:g.M365CopilotChat}}),void c(at(r));n?.current?.PrimaryUserAccountInfo?.CopilotExperience!==g.AppChat&&a({PrimaryUserAccountInfo:{...n?.current?.PrimaryUserAccountInfo,CopilotExperience:g.AppChat}}),Ee=i=o,Ie&&Ie(i)}var i})),o.attachPrivateEventHandler("BizChatHostContextUpdate",(e=>{r(void 0);const t=rt(e.eventData),o=t?.PrimaryUserAccountInfo?.CopilotExperience;o!==n.current?.PrimaryUserAccountInfo?.CopilotExperience&&(a(t),n.current=t,t&&(Ye("BizChatHostContext",t),u.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.PrivateAPIChatContextSwitch},{key:d.ChatEventParameters,value:t?.PrimaryUserAccountInfo?.CopilotExperience??""},{key:d.CopilotSource,value:"BizChat"}])))})),o.initializePrivateApi(),Office.addin.onVisibilityModeChanged?.(y),ge(L.EnableAgentSwitchInCatalystViaEntryPoint)&&(async()=>{try{OfficeFirstParty.UnifiedStore.onCopilotAgentEvent(f)}catch(e){lt("error","Error setting up onCopilotAgentEvent: ",e),u.logEvent(l.CHAT,[{key:te.IC.ErrorCategory,value:s.MOSStoreDialogResponse}])}})()}),[]);const v=ge("RemoveSDXConsumerFGCheck")||"AAD"===e.accountInfo.accountType||he("EnableM365CopilotForConsumers"),S=t?.PrimaryUserAccountInfo?.CopilotExperience,w=me("EnableExcelAgentExperimental",!1),E=me("EnableExcelAgentClaude",!1),R=me("ExcelAgentEntry",!1)&&(ge("OfficeVSO_11014539_unmountBizChatWebKit")?!et():!Ke()),A=me("EnableEAEInFrontier",!1);be.useEffect((()=>{ge("OfficeVSO_10934137_ExcelAgentFlightTelemetry")&&function(e){const t={isExcelAgentEntryEnabled:me("ExcelAgentEntry",!1),isEnableEAEInFrontier:me("EnableEAEInFrontier",!1),excelAgentExperimentalEnabled:me("EnableExcelAgentExperimental",!1)};Object.entries(t).forEach((([t,a])=>{e.logEvent(l.CHAT,[{key:d.ChatEventType,value:t},{key:d.ChatEventParameters,value:a.toString()}])}))}(u)}),[u]),be.useEffect((()=>{if(!ge("OfficeVSO_11052504_EnableExcelAgentPLTUPLTLogging"))return;const e=st("PLT");x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:"ExcelAgentByDefaultPLTTimestamp"},{key:d.ChatEventParameters,value:e.toString()}])}),[]);const k=!!ge("OfficeVSO_10955533_OpenSpecificSelectedAgentsFromDefault")&&(o&&o.titleId?.length>0),F=R&&S===g.M365CopilotChat&&!k;F&&Office?.context?.document?.settings&&Office.context.document.settings.remove(se.z.HandoffMessage);const[_,P]=be.useState(F),[N,M]=be.useState(!1);be.useEffect((()=>{ge("OfficeVSO_11052504_EnableExcelAgentPLTUPLTLogging")&&F&&!i&&(We=!0,u.logEvent(l.CHAT,[{key:d.ChatEventType,value:"ExcelAgentByDefaultStarted"},{key:d.ChatEventParameters,value:Date.now().toString()}]),ct(void 0))}),[F,i,u]),be.useEffect((()=>{if(F&&i){We=!0,P(!0);const e=i?.queryId;ct(e)}else ge("OfficeVSO_10955533_OpenSpecificSelectedAgentsFromDefault")&&!F&&P(!1)}),[F,i,u]);const O=S===g.AgentMode&&A&&w,B=gt&&nt,$=!!S&&(S===g.M365CopilotChat||S===g.Researcher||S===g.Analyst||S===g.DataShaping||S===g.AgentMode||B&&S===g.Disabled),H=v&&$,U=me("EnabledDensityForBizChatExcel",!1)?ht:mt,[q,V]=be.useState(!1),[G,W]=be.useState(!0),[z,j]=be.useState(0),Y=be.useCallback((()=>{j(Date.now())}),[]),Z=be.useCallback((()=>{Ve=!1,Ge=!1,Ue=void 0,We=!1,ge("OfficeVSO_10739971_EnableExitAgentModeUsingSelectedCapability")&&!et()?(P(!1),M(!1),V(!0),W(!1),ge("OfficeVSO_10842707_CloseAuroraOnFixFmlaAppChatLaunch")?p.current?.setSelectedCapability&&p.current.setSelectedCapability({commandFiredTimestamp:Date.now(),capability:void 0,atMentionApp:void 0}):p.current?.setSelectedCapability({commandFiredTimestamp:Date.now(),capability:void 0,atMentionApp:void 0})):location.reload()}),[]);be.useEffect((()=>{ge("OfficeVSO_10842707_CloseAuroraOnFixFmlaAppChatLaunch")&&S===g.AppChat&&Z()}),[S,Z]);const K=O&&G||_,ae=be.useMemo((()=>R?{prompt:i?.query,queryId:i?.queryId}:void 0),[R,i?.query,i?.queryId]),ne=(O||_||q)&&(0,C.jsx)(ut,{shouldReset:G,exitAgentMode:Z,onReady:()=>{},hostAccountInfo:e.accountInfo,agentModeLastActivationTimestamp:z,claudeModeByDefault:N,initialPrompt:ae}),oe=me("EnableOfficeBerryExcelAgent",!1)&&E,re=H?(0,C.jsx)(U,{...b(!0,F),hostAccountInfo:e.accountInfo,commandingRef:p,claudeAvailable:oe,onAgentChanged:e=>{w&&"ExcelAgent"===e&&(M(!1),P(!0),ge("OfficeVSO_10750624_AddLastAgentModeActivationTimestamp")&&Y()),E&&"ExcelAgentClaude"===e&&(M(!0),P(!0),u.logEvent(l.CHAT,[{key:d.ChatEventType,value:"ExcelAgentClaude"},{key:d.ChatEventParameters,value:"true"}]),ge("OfficeVSO_10750624_AddLastAgentModeActivationTimestamp")&&Y())}}):(0,C.jsx)(dt,{...b(!1,!1),accountInfo:e.accountInfo},Ee?.promptProperties?.userQueryGuid||Ee?.promptProperties?.sendPromptText||"default");return et()?(0,C.jsx)("div",{children:K?ne:re}):(0,C.jsxs)(C.Fragment,{children:[(0,C.jsx)("div",{style:{display:K?"block":"none"},children:ne}),(0,C.jsx)("div",{style:{display:K?"none":"block"},children:re})]})}));pt.displayName="CopilotEntryPointSelector";let bt={accountType:"",objectId:"",tenantId:""};const ft=e=>{let t;var a,n;Be=!0,Me=!1,$e=!1,e?.copilotPaneStartTimestamp&&(De=e.copilotPaneStartTimestamp,t=parseFloat(Xe(e?.copilotPaneStartTimestamp)),x.getInstance().logEvent(l.LATENCY,[{key:c.FeatureName,value:"Preload_ChatPaneLoad"},{key:c.UserCopilotPaneLoadTime,value:R(t)}]),a=e,Object.keys(a).forEach((e=>{Ye(e,Xe(a[e]))}))),x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:s.ShowPreloadedCopilot},{key:d.ChatEventParameters,value:(new Date).getTime()}]),Re=n=!0,we&&we(n),Office.addin.showAsTaskpane(),ge("OfficeVSO_10534523_enablePassingAppRunningStateToBizChat")&&D.getInstance().setState({isAppInForeground:!0,userOpenedCopilotUtcTime:t});const o=performance.now()-(Date.now()-t);o>0&&performance.mark("bizchat-metaOS-app.UserClickTime",{startTime:o})};(async()=>{function e(e){const a=()=>{t(e)};"function"==typeof window.requestIdleCallback?requestIdleCallback(a,{timeout:5e3}):setTimeout(a,0)}function t(e){lt("info","renderUIToScreen"),qe=(new Date).getTime();const t=document.getElementById("container");t?fe.render((0,C.jsx)("div",{children:(0,C.jsx)(pt,{accountInfo:e})}),t):lt("error","Container element not found")}await new Promise((e=>{const t=()=>{"undefined"!=typeof Office?e():setTimeout(t,50)};t()})),Office.onReady().then((async a=>{if(Office.ExtensionLifeCycle.taskpane?.notifyHeaderLoaded(),ge("OfficeVSO_10534523_enablePassingAppRunningStateToBizChat"))if(me(k.UseInitialClickTimeFromContext)){const e=function(){try{var e=parseInt(I("copilotPaneStartTimestamp",!0));if(!isNaN(e))return e}catch(e){x.getInstance().logEvent(l.ERROR,[{key:u.ErrorMessage,value:"Failed to get initial click time from context. Error Message: ".concat(e.message)},{key:u.ErrorCategory,value:"AppRunningState"}])}}();D.getInstance().setIntialValue(a,e??parseInt(He),void 0!==e)}else D.getInstance().setIntialValue(a,He);if(bt=await function(e){return F(this,arguments,void 0,(function(e,t,a){var n,o,r,i,c,m,h,g,C,y,v,x;return void 0===t&&(t=!1),_(this,(function(T){switch(T.label){case 0:if(t&&(n=P(e,a)))return[2,n];o="",r="",i="",T.label=1;case 1:return T.trys.push([1,3,,4]),[4,new Promise((function(t){return e.context.auth.getAuthContextAsync(t)}))];case 2:return"succeeded"===(c=T.sent()).status?(m=c.value)?(o=null!==(y=null===(C=m.authorityType)||void 0===C?void 0:C.toUpperCase())&&void 0!==y?y:"",r=null!==(v=m.userObjectId)&&void 0!==v?v:"",i=null!==(x=m.tenantId)&&void 0!==x?x:"",h=[],m.userObjectId||h.push("userObjectId"),m.tenantId||h.push("tenantId"),m.authorityType||h.push("authorityType"),a&&a.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.BizChatAuthContextAccountInfoFetched},{key:d.ChatEventParameters,value:JSON.stringify({resultStatus:p.Success,resultCode:h.length>0?b.SucceededMissingFields:b.SucceededAllFieldsPresent,presentKeys:Object.keys(m),missingFields:h})}])):a&&a.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.BizChatAuthContextAccountInfoFetched},{key:d.ChatEventParameters,value:JSON.stringify({resultStatus:p.Success,resultCode:b.AuthContextUndefined})}]):a&&a.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.BizChatAuthContextAccountInfoFetched},{key:d.ChatEventParameters,value:JSON.stringify({resultStatus:p.Failure,resultCode:b.FailedToFetchUserObject,description:"Failed to fetch user object from OfficeJS with status: ".concat(c.status)})}]),[3,4];case 3:return g=T.sent(),a&&(a.logEvent(l.CHAT,[{key:d.ChatEventType,value:s.BizChatAuthContextAccountInfoFetched},{key:d.ChatEventParameters,value:JSON.stringify({resultStatus:p.Failure,resultCode:b.ErrorFetchingUserObject,description:"Error fetching user object from OfficeJS: ".concat(g)})}]),a.logEvent(l.ERROR,[{key:u.ErrorCategory,value:"BizChatNativeRenderer"},{key:u.ErrorCode,value:"sdx-bizchat-auth-context-fetch-account-info-error"},{key:u.ErrorMessage,value:"Error fetching user object from OfficeJS: ".concat(g)},{key:u.ErrorLevel,value:f.Error}])),[3,4];case 4:return[2,{accountType:o,objectId:r,tenantId:i}]}}))}))}(Office,ge("OfficeVSO_10776379_enableUserAuthInfoFromBizChatHostContext"),x.getInstance()),ge("EnableOfficeAuthContextAccountTypeLog")&&x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:s.OfficeAuthContextAccountType},{key:d.ChatEventParameters,value:bt.accountType}]),a.addin)"Hidden"===a.addin.visibilityMode?(lt("info","hostAndPlatform.addin.visibilityMode: Hidden"),$e=!0,lt("info","hostAndPlatform.addin.visibilityMode:"+a.addin.visibilityMode),lt("info",`Office.OnReady PreloadCopilot ${Fe()} ${ye}`),ye||(Se((new Date).getTime()),window.preloadCopilotTime=ye?.toString(),ke(),Me=!0,me("renderPreloadUIOnIdleOnly")?e(bt):t(bt))):"Taskpane"===a.addin.visibilityMode?t(bt):lt("error",`Office.OnReady None handled visibility mode ${a.addin.visibilityMode}`),Office.addin.onVisibilityModeChanged((function(e){x.getInstance().logEvent(l.CHAT,[{key:d.ChatEventType,value:s.TaskPaneVisibilityModeChanged},{key:d.ChatEventParameters,value:e.visibilityMode},{key:d.CopilotSource,value:"BizChat"}]),"Taskpane"===e.visibilityMode?(lt("info","Office.addin.onVisibilityModeChanged: Taskpane"),Be&&(Be=!1),$e=!1,_e(!1)):"Hidden"===e.visibilityMode&&(lt("info","Office.addin.onVisibilityModeChanged: Hidden"),_e(!0))}));else{lt("info","hostAndPlatform.addin is null"),t(bt);const e=performance.now()-(Date.now()-He);e>0&&performance.mark("bizchat-metaOS-app.UserClickTime",{startTime:e})}})).catch((e=>{lt("error","Office.onReady() error: "+e)})),Office.actions.associate("ShowPreloadedCopilot",(function(e){ft(e)})),Office.actions.associate("PreloadCopilot",(function(){lt("info",`Office actions PreloadCopilot ${Fe()} ${ye}`),ye||(Se((new Date).getTime()),window.preloadCopilotTime=ye?.toString(),Me=!0,ke(),me("renderPreloadUIOnIdleOnly")?e(bt):t(bt))}))})()},274483:(e,t,a)=>{"use strict";a.d(t,{O9:()=>m,OP:()=>g,Or:()=>d,mN:()=>c,xY:()=>u});var n=a(932367),o=a(754440),r=a(523999),i=a(697705),l=a(956258),s=a(9847);function c(){i.B.getInstance().logSeenEvent(s.q.Else)}function d(e){e.endTriedActivityFailure(s.q.Else)}function u(e,t){h(e)&&(e.chatResponseCode===r.Ay.OK?t.endTriedActivitySuccess(s.q.Else):d(t))}function m(e){return h(e)&&e.elseSkillStarted}function h(e){return e?.type===r.VF.ElseResponseMeta}function g(e){if(!h(e))return;const t=e.chatResponseCode;if(void 0!==t&&t!==r.Ay.OK)switch(t){case r.Ay.ServiceTimeout:return void a(o.W.Response_Delayed_Or_Timed_Out,n.c.Else_Service_Timed_Out);case r.Ay.RAICheckFailed:return void a(o.W.Responsible_AI_Filter_Blocked_Response,n.c.RAI_Validation_Failed);case r.Ay.FormulaError:return void a(o.W.Unable_To_Complete_Task,n.c.Else_Response_Blocked_Bad_Formula);case r.Ay.SearchAndActionNotAllowed:return void a(o.W.Unable_To_Complete_Task,n.c.Else_Response_Blocked_Unsupported_Chaining);case r.Ay.SecurityBlockedFormulaError:return void a(o.W.Unable_To_Complete_Task,n.c.Else_Response_Blocked_Security_Restricted_Formula);case r.Ay.ExternalWorkbookFormulaError:return void a(o.W.Unable_To_Complete_Task,n.c.Else_Response_Blocked_External_Workbook_Reference_Formula);case r.Ay.ServiceError:default:return void a(o.W.LLM_Service_Side_Issue_Prevents_Output,n.c.Else_Service_Error)}function a(e,t){l.M.getInstance().logStandardizedAshaErrorEvent(e,t,s.BJ.ExcelChatHelper)}}},274793:(e,t,a)=>{"use strict";async function n(){return await Promise.all([a.e("vendors-npm_store_sdx_officecopilot_typescript_5_0_4-007004e2f84938dc12ca_node_modules_typesc-351a83","high"),a.e("vendors-npm_store_sdx_officecopilot_office-script-synchronous_0_0_126-8c43e2bff2458e92cb38_no-9fc215","high"),a.e("oss","high")]).then(a.bind(a,522287))}async function o(){return(await n()).code}a.d(t,{J:()=>n,Q:()=>o})},278306:(e,t,a)=>{"use strict";a.d(t,{A:()=>g});var n=a(725556),o=a(740533),r=a(178502),i=a(267324),l=a(290766),s=a(14086),c=a(626128),d=a(880496),u=a(528804),m=a(593717);function h(e,t,a){const n=(0,c.iM)(e)?t?(0,d.hU)(e)?a?(0,u.ZAR)()?"RecommendationSuggestionHeaderGroundedWithSheet":"RecommendationSuggestionHeaderGrounded":"RecommendationAnotherSuggestionHeader":(0,u.ZAR)()?"RecommendationSuggestionMultipleColumnsHeaderGroundedWithSheet":"RecommendationSuggestionMultipleColumnsHeaderGrounded":(0,d.hU)(e)?a?"RecommendationSuggestionHeader":"RecommendationAnotherSuggestionHeader":"RecommendationSuggestionMultipleColumnsHeader":t?(0,u.ZAR)()?"RecommendationFormulaSuggestionHeaderGroundedWithSheet":"RecommendationFormulaSuggestionHeaderGrounded":null;return null===n?(0,i.SHb)():i.olU[n]}const g=({recommendation:e,targetAddress:t,targetSheet:a,isMainRecommendation:r,columnLetters:i,rowNumber:d})=>(0,c.iM)(e)&&i&&t&&a?(0,n.jsx)(b,{recommendation:e,targetAddress:t,columnLetters:i,sheetName:a}):(0,c.cY)(e)&&i&&d&&t&&a?(0,n.jsx)(p,{recommendation:e,targetAddress:t,columnLetters:i,rowNumber:d,sheetName:a}):(0,n.jsx)(o.c,{children:(0,n.jsx)(l.sA,{message:h(e,t,r),values:{range:t?(0,s.r)(t):"",columnLength:e.calculatedFormulas.length,sheet:a||(t?(0,s.w)(t):"")}})}),p=({recommendation:e,targetAddress:t,columnLetters:a,rowNumber:c,sheetName:m})=>{const h=(0,d.Z)(e),g=(0,d.XZ)(e),p=(0,d.th)(e),b=(0,s.r)(t),f=e.calculatedFormulas.reduce(((e,t)=>e+(t.insertionIndexes?.length??0)),0),C=e.allowReplacementOfExistingValue;let y,v;(0,d.By)(e)?(v={cellAddress:e.calculatedFormulas[0].fixedInsertionRange},y="CalculatedRowsCellHeader"):(y=h?"CalculatedRowsCellHeader":"CalculatedRowsRowHeader",v=h?{cellAddress:a[0]+c.toString()}:{rowNumber:c.toString()});const x=g?C?(0,u.ZAR)()?"CalculatedRowsFormulaSuggestionHeaderUpdateSingularWithSheet":"CalculatedRowsFormulaSuggestionHeaderUpdateSingular":(0,u.ZAR)()?"CalculatedRowsFormulaSuggestionHeaderSingularWithSheet":"CalculatedRowsFormulaSuggestionHeaderSingular":C?(0,u.ZAR)()?"CalculatedRowsFormulaSuggestionHeaderUpdatePluralWithSheet":"CalculatedRowsFormulaSuggestionHeaderUpdatePlural":(0,u.ZAR)()?"CalculatedRowsFormulaSuggestionHeaderPluralWithSheet":"CalculatedRowsFormulaSuggestionHeaderPlural";return(0,n.jsx)(o.c,{children:(0,n.jsx)(l.sA,{message:i.olU[x],values:{tableRange:(0,n.jsx)(r.V,{children:b}),sheet:m,location:p?i.olU.CalculatedRowsSelectedCellHeader:(0,n.jsx)(r.V,{children:(0,n.jsx)(l.sA,{message:i.olU[y],values:v})}),formulasLength:f}})})},b=({recommendation:e,targetAddress:t,columnLetters:a,sheetName:c})=>{const h=(0,d.hU)(e),g=(0,s.r)(t),p=h?(0,n.jsx)(l.sA,{message:i.olU.FormulaSuggestion_Header_Singular_Location,values:{columnLetter:a[0]}}):(0,n.jsx)(l.sA,{message:i.olU.FormulaSuggestion_Header_Plural_Location,values:{columnLetters:(0,m.q)(a)}});let b="";return b=(0,u.ZAR)()?h?i.olU.FormulaSuggestion_Header_SingularWithSheet:i.olU.FormulaSuggestion_Header_PluralWithSheet:h?i.olU.FormulaSuggestion_Header_Singular:i.olU.FormulaSuggestion_Header_Plural,(0,n.jsx)(o.c,{children:h?(0,n.jsx)(l.sA,{message:b,values:{tableRange:(0,n.jsx)(r.V,{children:g}),location:(0,n.jsx)(r.V,{children:p}),sheet:c}}):(0,n.jsx)(l.sA,{message:b,values:{tableRange:(0,n.jsx)(r.V,{children:g}),location:(0,n.jsx)(r.V,{children:p}),columnLength:e.calculatedFormulas.length,sheet:c}})})}},287761:(e,t,a)=>{"use strict";a.d(t,{lA:()=>n,zJ:()=>l});var n,o=a(47262);function r(e,t){return{x:e.x+t.x,y:e.y+t.y}}function i(e,{maxWidthBeforeOverflow:t=Number.POSITIVE_INFINITY,padding:a={x:0,y:0},startVector:n={x:0,y:0}}={}){const o=function(e,t,a={x:0,y:0},n={x:0,y:0}){const o=[],i={x:0,y:0},l=t;let s=0,c=0,d=0;const u=(e,t)=>{o.push({...e,position:r({x:s,y:c},n)}),d=Math.max(d,t.y),i.x=Math.max(i.x,s+t.x),i.y=Math.max(i.y,c+t.y),s+=t.x},m=()=>{c+=d,d=0,s=0};for(let n=0;n<e.length;++n){const o=e[n],i=r(o.dim,a);i.x>t?(0!==s&&m(),u(o,i)):i.x>l-s?(m(),--n):i.x===l-s?(u(o,i),m()):u(o,i)}return{placements:o,bbox:i}}(e,t,a,n),i={};return o.placements.forEach((e=>{i[e.id]=e})),{result:i,bbox:o.bbox}}function l(e,t){const a={x:1,y:1},n={x:0,y:0},l=e=>{if(e.pivotTableData&&e.pivotTableData.length>0){const t=(e.subTotalRowIndices?.length??0)>0?1:0,a=(e.filterFields.length>0?e.filterFields.length+1:0)+(e.grandTotalRowIndex?0:1)+(e.subTotalRowIndices?.length??0);return{x:e.pivotTableData.length+t,y:e.pivotTableData[0].length+a}}return{x:4,y:10}},s=[],c=[];e.forEach((e=>{switch(e.visual.visualType){case"ChartVisual":{const t={x:5,y:14};s.push({position:n,dim:t,id:e.id});break}case"PivotTableVisual":{const t=l(e.visual.pivotTable);c.push({position:n,dim:t,id:e.id});break}case"PivotChartVisual":{const t=l(e.visual.pivotTable),a={x:5,y:14};s.push({position:n,dim:a,id:e.id}),c.push({position:n,dim:t,id:e.id});break}case"QueryResultVisual":case"QueryChartVisual":case"ForecastVisual":case"TextAnalysisVisual":throw new Error(`insertAllRecommendations: Unsupported visualType=${e.visual.visualType}`);default:(0,o.x)(e.visual)}}));const d={x:2,y:2},u=i(s,{maxWidthBeforeOverflow:t,padding:a,startVector:d}),m=r(d,{y:u.bbox.y+5,x:0}),h=i(c,{padding:a,startVector:m}),g={};return e.forEach((e=>{const t=u.result[e.id],a=h.result[e.id];g[e.id]={chart:t,pivotTable:a}})),{layoutPlacementsById:g,mainDataLocation:{startRow:d.y,startColumn:d.x,rowCount:u.bbox.y,columnCount:u.bbox.x},supportingDataLocation:{startRow:m.y,startColumn:m.x,rowCount:h.bbox.y,columnCount:h.bbox.x}}}!function(e){e[e.none=0]="none",e[e.unknown=1]="unknown",e[e.findInterpretation=2]="findInterpretation",e[e.preFormatDashboardSheet=3]="preFormatDashboardSheet",e[e.insertRecommendations=4]="insertRecommendations",e[e.convertingDashboardArgs=5]="convertingDashboardArgs",e[e.insertPivotTables=6]="insertPivotTables",e[e.insertCharts=7]="insertCharts",e[e.insertPivotCharts=8]="insertPivotCharts",e[e.postFormatDashboardSheet=9]="postFormatDashboardSheet"}(n||(n={}))},290766:(e,t,a)=>{"use strict";a.d(t,{sA:()=>l});var n=a(725556),o=a(208520);function r(e,t,a){return e.split(t).map(((e,t)=>t%2==0?e:a(e,t))).filter((e=>null!==e&&""!==e))}function i(e,t){return function(e,t){const a=/\{(\d+)\}/,n=/\{(\w+)\}/;if(Array.isArray(t))return r(e,a,(e=>{const a=parseInt(e,10);return a>=0&&a<t.length?t[a]:`{${e}}`}));return r(e,n,(e=>e in t?t[e]:`{${e}}`))}(e,t)}const l=({message:e,values:t})=>(0,n.jsx)(n.Fragment,{children:o.Children.toArray(i(e,t))})},295767:(e,t,a)=>{"use strict";a.d(t,{JK:()=>se,hJ:()=>le,iT:()=>ce,ph:()=>$e,uX:()=>me,GZ:()=>he,QI:()=>Ie,Sf:()=>Re,iM:()=>Fe,Kr:()=>ke,UN:()=>ue,y1:()=>ge,P_:()=>de,jv:()=>Ee,aP:()=>Be,wK:()=>we});var n=a(267324),o=a(932367),r=a(754440),i=a(549768),l=a(373753),s=a(626128),c=a(79458);class d{addCleanupFunctions(e,...t){this.cleanupFunctionsByKey.has(e)?this.cleanupFunctionsByKey.get(e).push(...t):this.cleanupFunctionsByKey.set(e,t)}isTracking(e){return this.cleanupFunctionsByKey.has(e)}stopTracking(e){(0,c.cY)("BaseEventsTracker: stopTracking",e),this.cleanupFunctionsByKey.get(e)?.forEach((e=>e.remove())),this.cleanupFunctionsByKey.delete(e)}constructor(){this.cleanupFunctionsByKey=new Map}}var u=a(365319),m=a(632512),h=a(88994),g=a(9847),p=a(965634),b=a(937234),f=a(255448),C=a(959994),y=a(697705),v=a(476730),x=a(956258),T=a(4091),S=a(369169),w=a(235373),E=a(797639),I=a(875042),R=a(10021),A=a(910480),L=a(528804),k=a(318259),F=a(299512),_=a(348065),P=a(547131),N=a(83437);function M(e,t){return e.filter((e=>!t.includes(e)))}async function O(e){return e.context.load(e.columns,"items/name"),await e.context.sync(),e.columns.items.map((e=>e.name))}async function D(e,t,a){if(0===t.length)return!1;const{referencedColumns:n}=await(0,k.s_)(a,e.map((e=>e.nonLocalizedFormula??e.formula)),new Map);for(const e of t)if(n.includes(e))return!0;return!1}var B=a(984691),$=a(173339),H=a(906606),U=a(750927),q=a(880496),V=a(357781),G=a(471742),W=a(689534),z=a(593717),j=a(804672);const Q="en-US",J=(e,t,a)=>e?(0,s.iM)(e)?X(e,t,a):(0,s.cY)(e)?Y(e,t,a):"":JSON.stringify({publishPreference:W.f.Never}),Y=(e,t,a)=>{let o;const r=t().dataAI.tableName[a];r&&t().selection.selectionContexts[r]&&(o=(0,V.s6)(e,t().selection.selectionContexts[r]));const i=e.calculatedFormulas.map((e=>e.title??"")),l=e.calculatedFormulas.map((e=>e.formula));let s;return s=(0,q.hU)(e)?o?.[0]?(0,j.VY)(n.qbK.Rows.SingleFormulaRecommendation,{title:i[0],formula:l[0],location:o[0]}):(0,j.VY)(n.qbK.Rows.SingleFormulaRecommendationWithNoLocation,{title:i[0],formula:l[0]}):o?(0,j.VY)(n.qbK.Rows.MultipleFormulaRecommendation,{titles:(0,z.q)(i,Q),formulas:(0,z.q)(l,Q),columnLocations:(0,z.q)(o,Q)}):(0,j.VY)(n.qbK.Rows.MultipleFormulaRecommendationWithNoLocation,{titles:(0,z.q)(i,Q),formulas:(0,z.q)(l,Q)}),JSON.stringify({text:s,formulas:l,titles:i,location:o,publishPreference:W.f.Never})},X=(e,t,a)=>{let o;const r=t().dataAI.tableName[a];r&&t().selection.selectionContexts[r]&&(o=(0,V.GC)(e,t().selection.selectionContexts[r]));const i=e.calculatedFormulas.map((e=>e.columnName)),l=e.calculatedFormulas.map((e=>e.formula));let s;return s=(0,q.hU)(e)?o?.[0]?(0,j.VY)(n.qbK.Columns.SingleColumnRecommendation,{columnName:i[0]??"",formula:l[0]??"",columnLocation:o[0]}):(0,j.VY)(n.qbK.Columns.SingleColumnRecommendationWithNoLocation,{columnName:i[0]??"",formula:l[0]??""}):o?(0,j.VY)(n.qbK.Columns.MultipleColumnsRecommendation,{columnNames:(0,z.q)(i,Q),formulas:(0,z.q)(l,Q),columnLocations:(0,z.q)(o,Q)}):(0,j.VY)(n.qbK.Columns.MultipleColumnsRecommendationWithNoLocation,{columnNames:(0,z.q)(i,Q),formulas:(0,z.q)(l,Q)}),JSON.stringify({text:s,formula:l,columnName:i,locations:o,publishPreference:W.f.Never})};var Z=a(494554),K=a(940096);var ee=a(703227),te=a(53113),ae=a(495501),ne=a(343230),oe=a(389298);const re="success",ie=(e,t,n,i,l)=>async(c,d)=>{let u=re;try{if("inProgress"===d().dataAI.fetchRecommendationsState[e])return u="inProgress",Promise.resolve();const o=d().dataAI.tableName[e];if(!o)return u="noTableName",void Be(e,c);if(!l)return u="noQuery",void Be(e,c);c(R.m.startFetching(e)),c(w.m.startExecutingCommand({command:t,id:e}));const r=d().app.augloopModelWorkflowUnsupported,{localeCacheDeprecated:h}=d().selection;let b,C;try{b=d().selection.selectionContexts,C=await c((0,H.CQ)(o,e)),(0,L.yw9)("OfficeVSO_9610128_fixFailureToSendFormulaGenerationSignal")&&(b=d().selection.selectionContexts);const t=!r&&(0,L.rbw)();if(!b[o]||!C&&!t){if((0,L.yw9)("OfficeVSO_9693418_sendNoSelectionSignalV2"))throw new Error("send no selection signal");return u="noTableData",void Be(e,c)}}catch(e){if(!(0,L.yw9)("OfficeVSO_9693418_sendNoSelectionSignalV2"))throw e;x.M.getInstance().logErrorCode(m.O.FormulaGenerationGetSelectionContextsFailed,e,p.S2.FormulaGeneration,N.$b.Warning)}const y=$.R.getFormulaAITimeout();window.setTimeout((()=>{if("inProgress"===d().dataAI.fetchRecommendationsState[e]){const t=`Timeout on SDX after waiting ${y} seconds for calculated column suggestions from AL`;(0,te.CT)(e,c,t)}}),y),Promise.all([a.e("chunk1jsfluent","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81","high"),a.e("calc","high")]).then(a.bind(a,837051));let T=[];return(0,L._mi)()&&(T=function(e,t){if(!(0,L.yw9)("OfficeVSO_9506002_DedupeTablesInExcelIntelligenceContext"))return e;const a=new Set,n=[...e].reverse().filter((e=>{const t=function(e){return e.tableName?e.tableName:[e.sheetName||e.range.worksheetId,e.range.top,e.range.left,e.range.bottom,e.range.right].join("|")}(e);return!a.has(t)&&(a.add(t),!0)}));return n.length===e.length?e:(v.E.getInstance().updateTelemetryChatEventData({[g.h3.ChatEventType]:g.a5.FormulaSuggestionDedupedContextTables,[g.h3.ChatEventParameters]:JSON.stringify({requestId:t,before:e.length,after:n.length})},x.M.getInstance()),n.reverse())}(d().selection.excelRecognizedTablesAnnotationsCache,e)),await(0,s.uq)(b?b[o]:void 0,(0,L.LrR)()?c((0,K.Z)()):h,C,e,n,r,[f.Rk.ChatPill,f.Rk.ChatZQM].includes(d().chat.queryOriginByQueryId[e]),l,d().chat.queryOriginByQueryId[e],o,i,T,d().chat.onGridQueryCellAddressByQueryId[e])}catch(t){u=t,Be(e,c)}finally{u!==re&&(x.M.getInstance().logErrorCode(m.O.FormulaGenerationCreateFetchOperationFailed,(0,g.Jr)(u),p.S2.FormulaGeneration,N.$b.Error,{key:p.nn.Operation,value:t}),x.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Formula_Generation_Failed_To_Send_Signal,g.BJ.FormulaGeneration))}},le=(e,t,a)=>ie(e,g.OP.CalculatedColumns,I.az.ColumnSuggestion,t,a),se=(e,t,a)=>ie(e,g.OP.CalculatedCells,I.az.CellSuggestion,t,a),ce=(0,_.YQ)(((e,t,a)=>t().dataAI.fetchRecommendationsState[a])),de=(0,_.YQ)(((e,t,a)=>{const{activeRequestId:n,fetchRecommendationsState:o}=t().dataAI;return a===n&&"failed"!==o[a]})),ue=(e,t=s.VS.Column)=>async(a,o)=>{const r=o(),l=r.dataAI.activeRequestId;if(!(l&&"failed"===r.dataAI.fetchRecommendationsState[l]||l!==e.requestId)){if((0,L.cTR)()){const t=e.telemetry;t?.metrics&&t.metrics.length>0&&a(oe.m.addQueryMetrics({queryId:e.requestId,metrics:t.metrics}))}if(l){if(a(ge(l)),i.lL.typeGuard(e)||i.Dv.typeGuard(e)||i.sG.typeGuard(e)){const t=(0,s.aG)(e.requestId,e.suggestionId);i.lL.typeGuard(e)&&e.previewValues&&e.previewValuesForVisibleRows?a(R.m.setPreviewForSuggestionID({suggestionId:t,preview:(0,q.mg)(e.previewValues),visibleRowsPreview:(0,q.mg)(e.previewValuesForVisibleRows)})):i.Dv.typeGuard(e)&&e.previewValues?fe(a,o,t,e.previewValues,l):r.app.augloopModelWorkflowUnsupported&&void 0===r.dataAI.rawPreview[t]&&R.m.setPreviewForSuggestionID({suggestionId:t,preview:[],visibleRowsPreview:[]})}const n=(0,s.mZ)(e,l,t);await Ce(o,n,l),await ye(a,o,n,l)}else{const{message:t,telemetry:o}=ae.n.getFormulaSuggestionErrorResponse((0,n.HGr)(),{shouldShowFormulaDevButton:r.dataAI.shouldShowFormulaDevButton,debugInfo:e.debugInfo});u.$.getInstance().displayResponse(t,o);const i=JSON.stringify({text:(0,Z.N)(t),publishPreference:"Never"});a((0,T.nv)(i,b.Aw.failed,o))}}},me=(0,_.YQ)(((e,t,a)=>{const n=(0,s.aG)(a.requestId,a.suggestionId);if(i.lL.typeGuard(a)&&a.previewValues&&a.previewValuesForVisibleRows)e(R.m.setPreviewForSuggestionID({suggestionId:n,preview:(0,q.mg)(a.previewValues),visibleRowsPreview:(0,q.mg)(a.previewValuesForVisibleRows)}));else if(i.Dv.typeGuard(a)&&a.previewValues)fe(e,t,n,a.previewValues,a.requestId);else{const{app:e,dataAI:a}=t();e.augloopModelWorkflowUnsupported&&void 0===a.rawPreview[n]&&R.m.setPreviewForSuggestionID({suggestionId:n,preview:[],visibleRowsPreview:[]})}})),he=(0,_.YQ)((async(e,t,a,n)=>{const o={[i.lL.getTypeName()]:s.VS.Column,[i.Dv.getTypeName()]:s.VS.Cell,[i.sG.getTypeName()]:s.VS.Formula}[C.h.getTypeNameFor(a)],r=(0,s.mZ)(a,a.requestId,o);await Ce(t,r,a.requestId),await ye(e,t,r,a.requestId,n)})),ge=(0,_.YQ)((async(e,t,a)=>{const{dataAI:n}=t();if(0===n.recommendations[a].length){const t=n.tableName[a];if(t)try{await e((0,H.VW)(t,a))}catch(e){x.M.getInstance().logErrorCode(m.O.ResolveTableLikeEntityFailed,e,p.S2.FormulaGeneration,N.$b.Warning)}}}));var pe;!function(e){e[e.Never=0]="Never",e[e.Force=1]="Force",e[e.IfNeeded=2]="IfNeeded"}(pe||(pe={}));const be=(0,_.YQ)((async(e,t,a,n,o,r)=>{1===a&&await e((0,H.VW)(o,r));const i=2===a?await e((0,H.aM)(o,r)):e((0,H.cQ)(o)),l=await e((0,H.CQ)(o,r));if(!i||!n&&!l)throw new Error("getLatestContextForInsertion: latest context not found for table name");return{selectionContext:i,tableColumnHeaders:!n&&i.hasTableHeaders?l.values[0].map((e=>String(e))):void 0}})),fe=async(e,t,a,n,o)=>{const r=(0,S.cQ)(o,t());if(r){const{showTotals:a}=r,n=a?t().dataAI.currentTotalRowValues[o]??await x.M.getInstance().runTimedAsyncFunction("GetCurrentRowValues",(()=>(0,s.jI)(r)),o):void 0;e(R.m.setCurrentRowValuesForRequestId({requestId:o,currentTotalRowValues:n}))}e(R.m.setPreviewForSuggestionID({suggestionId:a,preview:[n],visibleRowsPreview:[]}))},Ce=async(e,t,a)=>{if(t?.success&&t?.result&&(0,s.$k)(t.result)){const n=e().dataAI.recommendations[a];if(-1===n.findIndex((e=>t.result.some((t=>t.id===e.id))))){t.result.forEach((e=>{e.isSingleFormula=(0,q.XZ)(e)}));const n=await Ae(e,t.result,a);t.result.forEach(((e,t)=>{e.allowReplacementOfExistingValue=n[t]}));const o=await Le(e,t.result,a);t.result.forEach(((e,t)=>{e.insertRowTitle=o[t]})),v.E.getInstance().updateTelemetryChatEventData({[g.h3.ChatEventType]:g.a5.CalculatedRowsSuggestionsReceived,[g.h3.ChatEventParameters]:JSON.stringify({isUpdateSuggestion:n})},x.M.getInstance())}else t.result.forEach((e=>{const t=n.find((t=>t.id===e.id));t&&(e.insertRowTitle=t.insertRowTitle)}))}},ye=async(e,t,a,i,l=!1)=>{if(a.success){if(a.result){if(!(0,s.L$)(a.result)&&!(0,s.$k)(a.result)&&!(0,s.s9)(a.result))return;if(e(R.m.fetchRecommendationsSucceeded({requestId:i,recommendation:a.result})),(0,s.s9)(a.result))return void ve(e,t,a.result,i,l);const[n]=a.result,o=t().dataAI.recommendations[i].find((e=>e.id===n.id));if(o&&void 0===o.preview&&e(De(i,n)),!t().dataAI.isVisible[i]){e(R.m.markVisible(i));const[n]=a.result;(0,L.Jhm)()&&x.M.getInstance().runTimedAsyncFunction("FormulaSuggestionInvalidatorTrack",(()=>Se.track(i,(0,S.cQ)(i,t()),n,((t,a)=>{e(R.m.markRecommendationAsInvalidated({reason:t,suggestionId:a}))}))),i,n.id),ve(e,t,a.result,i,l)}(0,L.yw9)("OfficeVSO_10041717_fixPillNotShow")&&xe(e,t,i)}}else{e(R.m.fetchRecommendationsFailed(i));const c=t().dataAI.recommendations[i].length;if(!c){const c=[f.Rk.ChatPill,f.Rk.ChatZQM].includes(t().chat.queryOriginByQueryId[i]);let d=c?n.olU.ServerErrorWithNoRetrySuggestionPill:n.olU.ServerErrorWithNoRetry,m=g.q0.ServiceError,p=r.W.Unable_To_Complete_Task,C=o.c.Service_Error_Unknown_Error;const y=a.suggestionMetadata.shouldFallbackToElse;switch(y&&h.s.getInstance().setLastFormulaRequestDebugInfo(a.debugInfo),a.suggestionMetadata.result){case I.sR.NoSuggestion:m=g.q0.NoSuggestions,c?(p=r.W.Unable_To_Complete_Task,C=o.c.Failed_Column_Suggestion_Generation_For_Suggestion_Pill):(d=n.olU.CalculatedColumnsNLNoResults,p=r.W.User_Input_Could_Not_Be_Processed,C=o.c.Failed_Column_Suggestion_Generation_For_User_Prompt);break;case I.sR.UserThrottled:p=r.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,C=o.c.LLM_Throttled,d=(0,n.UDz)(),m=g.q0.UserThrottled;break;case I.sR.MultipleFormulas:p=r.W.Missing_Copilot_Functionality,C=a.suggestionType===s.VS.Cell?o.c.Formula_Generation_Unsupported_Multiple_Rows:o.c.Formula_Generation_Unsupported_Multiple_Columns,c||(d=n.olU.CalculatedRowsNLMultipleRows),m=g.q0.NotSingleColumn;break;case I.sR.HarmfulContent:p=r.W.Responsible_AI_Filter_Blocked_Response,C=o.c.Suggestion_Blocked_Due_To_RAI,m=g.q0.RaiError;break;case I.sR.IrrelevantQuery:p=r.W.Missing_Copilot_Functionality,C=o.c.Calculated_Column_Out_Of_Scope_Scenarios,m=g.q0.IrrelevantQuery;break;case I.sR.LlmGeneralErrorFailure:p=r.W.LLM_Service_Side_Issue_Prevents_Output,C=o.c.Service_Error_Augloop,m=g.q0.LLMServiceError}y||x.M.getInstance().logStandardizedAshaErrorEvent(p,C,g.BJ.FormulaGeneration);const v=void 0,S=t().app.augloopModelWorkflowUnsupported;let E;switch(a.suggestionMetadata.result){case I.sR.MultipleFormulas:E=void 0;break;case I.sR.UserThrottled:E=(0,n.yUb)(S).map((e=>({text:e})));break;default:E=c?void 0:(0,n.yUb)(S).map((e=>({text:e})))}const{message:R,telemetry:A}=ae.n.getFormulaSuggestionErrorResponse(d,{shouldShowFormulaDevButton:t().dataAI.shouldShowFormulaDevButton,debugInfo:a.debugInfo},m,E);if(y||u.$.getInstance().displayResponse(R,A,v),l)y||e(w.m.stopExecuting({isSuccess:!1}));else{const t=JSON.stringify({text:(0,Z.N)(R),publishPreference:"Never",fallbackToElse:y}),a=!y,n=!y;e((0,T.nv)(t,b.Aw.failed,A,a,n))}}x.M.getInstance().logErrorCode(c?m.O.ExcelIntelligenceSignalFailedWithSuggestions:m.O.ExcelIntelligenceSignalFailed,(0,g.Jr)(a.suggestionMetadata.result),p.S2.FormulaGeneration,N.$b.Error)}},ve=async(e,t,a,n,o=!1)=>{const[r]=a;let i;i=(0,L.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)&&(0,s.s9)(a)?ae.n.getFormulaSuggestionMarkdownResponse(a[0],t().dataAI.shouldShowFormulaDevButton,e,n):ae.n.getFormulaSuggestionResponse(n,0,a);const{message:c,telemetry:d}=i;if(u.$.getInstance().displayResponse(c,d),o)e(w.m.stopExecuting({isSuccess:!0}));else{const a=J(r,t,n);e((0,T.nv)(a,b.Aw.success,d))}const m=r.calculatedFormulas[0]?.insertionMode;x.M.getInstance().logEvent((0,g.SV)(g.he.SuggestionShown,He(r),g.KZ.NLChatRequest,r.id,n,void 0!==m?l.PH[m]:void 0)),(0,L.yw9)("OfficeVSO_10041717_fixPillNotShow")||xe(e,t,n)},xe=(e,t,a)=>{if(!t().dataAI.hasShownSuggestionPrompt[a])if(t().dataAI.activeRequestId===a&&0===t().dataAI.currentShownSuggestionIndex[a]&&t().dataAI.recommendations[a].length>1){const n=t().dataAI.recommendations[a][1];e(R.m.setHasShownSuggestionPrompt(a)),e((0,T.Vf)(a,!n.isAlternativeSuggestion,n.suggestionType))}else{if(t().dataAI.activeRequestId===a&&0===t().dataAI.currentShownSuggestionIndex[a]&&(0,s.cY)(t().dataAI.recommendations[a][0]))return;e((0,T.Yx)(["CalculatedColumns_SpecificSuggestion"]))}},Te=new class extends d{track(e,t,a){if(this.isTracking(e))return void(0,c.cY)("ColumnPreviewInvalidator: already tracking",e);const{sheetId:n,sheetName:o,tableName:r}=t;if(!n||!o||!r)return void(0,c.cY)("ColumnPreviewInvalidator: invalid selection context");(0,c.cY)("ColumnPreviewInvalidator: tracking",e);const i=(t,n)=>{(0,c.cY)("ColumnPreviewInvalidator: invalidating",t,e,n),this.stopTracking(e),a()};Excel.run((async t=>{const a=t.workbook.worksheets.getItem(n),o=[a.onChanged.add((async e=>{i("sheetChanged",e)})),a.onDeactivated.add((async e=>{i("sheetDeactivated",e)}))];this.addCleanupFunctions(e,...o),await t.sync()}))}},Se=new class extends d{async track(e,t,a,n){if(this.isTracking(a.id))x.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:`FormulaSuggestionInvalidator: already tracking suggestion ${a.id}`,logLevel:N.$b.Warning});else if((0,S.k8)(t)){this.saveRequestId(a.id,e),this.addCleanupFunctions(a.id,{remove:()=>this.removeRequestId(a.id,e)}),this.invalidationCallbacks.set(a.id,n),this.addCleanupFunctions(a.id,{remove:()=>this.invalidationCallbacks.delete(a.id)});try{await this.startTracking(a,t)}catch(e){x.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:`FormulaSuggestionInvalidator: failed to start tracking suggestion ${a.id} with error ${e}`,logLevel:N.$b.Warning})}}else x.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:"FormulaSuggestionInvalidator: track called with invalid selection context",logLevel:N.$b.Warning})}async startTracking(e,t){const{sheetId:a,tableName:n}=t;return Excel.run((async o=>{const r=o.workbook.worksheets.getItem(a).tables.getItemOrNullObject(n);r.load("isNullObject"),await o.sync(),v.E.getInstance().updateTelemetryChatEventData({[g.h3.ChatEventType]:g.a5.FormulaSuggestionTrackedForInvalidation,[g.h3.ChatEventParameters]:JSON.stringify({suggestionId:e.id})},x.M.getInstance()),this.addCleanupFunctions(e.id,{remove:_.F_.startListening({actionCreator:w.m.setLatestRequestId,effect:(t,a)=>{const{latestRequestId:n}=a.getOriginalState().chat;t.payload!==n&&this.stopTracking(e.id)}})}),r.isNullObject?await this.registerTLREvents(e,t):await this.registerTableEvents(e,r),await o.sync()}))}invalidate(e,t,a=void 0){(0,c.cY)("FormulaSuggestionInvalidator: invalidating",e,t,a);const n=this.invalidationCallbacks.get(e);n&&n(t,e),this.stopTracking(e)}async registerTLREvents(e,t){this.addCleanupFunctions(e.id,{remove:_.F_.startListening({actionCreator:R.m.markRecommendationInserted,effect:(t,a)=>{const{requestId:n,suggestionId:o}=t.payload;if(o===e.id)return void(0,c.cY)("FormulaSuggestionInvalidator: markRecommendationInserted: suggestionId is the tracked suggestionId");const r=this.trackedSuggestionsByRequestId.get(n);(0,c.cY)("FormulaSuggestionInvalidator: markRecommendationInserted",{suggestionId:o,requestId:n,siblings:r}),r?.has(e.id)&&this.invalidate(e.id,"SiblingRecommendationInserted")}})});const{sheetId:a,address:n}=t;if(a&&n){const t=(0,F.py)(n),o=(0,A.debounce)((a=>{const n=a[t];(0,c.cY)("FormulaSuggestionInvalidator: TabularRangeChanged",{currentTable:t,sheetTables:a}),n||this.invalidate(e.id,"TabularRangeChanged",`Table ${t} not found in ${Object.keys(a)}`)}),2e3);this.addCleanupFunctions(e.id,{remove:_.F_.startListening({actionCreator:P.m.updateTableInterpretationsForSheet,effect:({payload:n},{getState:r})=>{if(n.sheetId!==a)return void(0,c.cY)("FormulaSuggestionInvalidator: updateTableInterpretationsForSheet: sheetId is different, skipping");const i=r().selection.tabularRanges;i?.[a]?(!function(e){v.E.getInstance().updateTelemetryChatEventData({[g.h3.ChatEventType]:g.a5.FormulaSuggestionInvalidationTrackingData,[g.h3.ChatEventParameters]:JSON.stringify(e)},x.M.getInstance())}({sheetId:a,currentTable:t,suggestionId:e.id,type:"tabularRangesChanged",tablesInSheet:Object.keys(i[a]),tablesInPayload:Object.keys(n.newInterpretations)}),o(i[a])):x.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:"FormulaSuggestionInvalidator: updateTableInterpretationsForSheet: tablesBySheet?.[sheetId] is undefined",logLevel:N.$b.Warning})}})})}else x.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:"FormulaSuggestionInvalidator: registerTLREvents: selectionContext is invalid",logLevel:N.$b.Warning})}async registerTableEvents(e,t){let a=await O(t);const n=t.id,o=[t.worksheet.tables.onDeleted.add((async t=>{(0,c.cY)("FormulaSuggestionInvalidator: tableDeleted",t),t.tableId===n&&this.invalidate(e.id,"TableDeleted",t)})),t.onChanged.add((async t=>{(0,c.cY)("FormulaSuggestionInvalidator: tableChanged",t),await Excel.run((async n=>{try{const o=n.workbook.tables.getItem(t.tableId);switch(t.changeType){case Excel.DataChangeType.rangeEdited:{const r=(0,L.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors")?t.getRangeOrNullObject(n):t.getRange(n),i=o.getHeaderRowRange(),l=r.getIntersectionOrNullObject(i);r.load("isNullObject"),l.load("isNullObject"),await n.sync();const s=await O(o),d=r.isNullObject;(d||!l.isNullObject)&&await async function(e,t,a,n){if(!n){const n=await D(e.calculatedFormulas,M(t,a),t);return(0,c.cY)(`shouldInvalidateOnHeaderEdit: ${n}, change is undefined (multiple cells were edited at once) tested by the removed columns`),n}if(n.valueTypeBefore===Excel.RangeValueType.empty)return(0,c.cY)("shouldInvalidateOnHeaderEdit: false because the header was empty before the change (the user is adding a new column)"),!1;if(await D(e.calculatedFormulas,[n.valueBefore],t))return(0,c.cY)("shouldInvalidateOnHeaderEdit: true because header was found in the formula"),!0;return!1}(e,a,s,d?void 0:t.details)&&this.invalidate(e.id,"ColumnHeaderEdited",t),a=s;break}case Excel.DataChangeType.columnInserted:a=await O(o);break;case Excel.DataChangeType.columnDeleted:{const n=await O(o),r=M(a,n);a=n,await D(e.calculatedFormulas,r,a)&&this.invalidate(e.id,"ColumnDeleted",t)}}}catch(e){x.M.getInstance().logError({eventType:p.S2.ChatEvents,errorMessage:`FormulaSuggestionInvalidator: tableChanged: ${e}`,logLevel:N.$b.Warning})}}))}))];(0,L.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors")?this.addCleanupFunctions(e.id,{remove:()=>{o.forEach((e=>{Excel.run(e.context,(async()=>{e.remove()})).catch((()=>{}))}))}}):this.addCleanupFunctions(e.id,...o)}saveRequestId(e,t){this.trackedSuggestionsByRequestId.has(t)||this.trackedSuggestionsByRequestId.set(t,new Set),this.trackedSuggestionsByRequestId.get(t).add(e)}removeRequestId(e,t){const a=this.trackedSuggestionsByRequestId.get(t);a&&(a.delete(e),0===a.size&&this.trackedSuggestionsByRequestId.delete(t))}constructor(...e){super(...e),this.invalidationCallbacks=new Map,this.trackedSuggestionsByRequestId=new Map}},we=(e,t,a)=>async(n,o)=>{const{previewId:r}=o().dataAI;r===t.id?n(Ie(e,r)):n(Ee(e,t,a))},Ee=(e,t,a={hidePreviewOnChange:!1,moveViewportToPreview:!1})=>async(n,i)=>{if(i().dataAI.previewId!==t.id&&(0,S.c5)(e,t,i()))try{const o=(0,S.cQ)(e,i());if(!o||!(0,S.k8)(o))return;null!=i().dataAI.previewId&&await(0,s.hK)(o.sheetName),n(R.m.startPreviewing(t.id));const r=async r=>{if(!(0,s.iM)(t))throw Error("showPreviewColumn called with non-column recommendation");i().dataAI.previewId===t.id&&(await x.M.getInstance().runTimedAsyncFunction("ShowPreviewColumn",(()=>(0,s.gA)(t.calculatedFormulas.map((e=>e.columnName)),o,r,(async()=>{(0,c.cY)("showPreviewColumn.previewDismissed"),Te.stopTracking(t.id),n(R.m.stopPreviewing())}),a.moveViewportToPreview,(0,S.py)(t,o))),e,t.id),a.hidePreviewOnChange&&Te.track(t.id,o,(()=>{n(Ie(e,t.id))})),null===i().dataAI.previewId&&o.sheetName&&await(0,s.hK)(o.sheetName))},l=async r=>{if(!(0,s.cY)(t))throw Error("showPreviewRow called with non-cell recommendation");if(i().dataAI.previewId===t.id){const l=(0,s.JM)(t),d=t.insertRowTitle?0:l?.[0],u=await(0,S.Fw)(t,o,d);await x.M.getInstance().runTimedAsyncFunction("showPreviewRow",(()=>(0,s.wr)(o,(0,q.XR)(r,l,t.insertRowTitle,i().dataAI.currentTotalRowValues[e]),d,(async()=>{(0,c.cY)("showPreviewRow.previewDismissed"),Te.stopTracking(t.id),n(R.m.stopPreviewing())}),a.moveViewportToPreview,u)),e,t.id),a.hidePreviewOnChange&&Te.track(t.id,o,(()=>{n(Ie(e,t.id))})),null===i().dataAI.previewId&&o.sheetName&&await(0,s.hK)(o.sheetName)}},d=async r=>{if(!(0,s.be)(t))throw Error("showPreviewFormula called with non-formula recommendation");if(t.calculatedFormulas.length>1)throw Error("showPreviewFormula currently only supported for single formula recommendations");if(i().dataAI.previewId===t.id){const{previewValues:r,anchorCellAddress:l}=await(0,S.gE)(t,o);if(!l)throw Error("Could not determine anchor cell for formula preview");await x.M.getInstance().runTimedAsyncFunction("showPreviewFormula",(()=>(0,s.fS)(l,r,(async()=>{(0,c.cY)("showPreviewFormula.previewDismissed"),Te.stopTracking(t.id),n(R.m.stopPreviewing())}))),e,t.id),a.hidePreviewOnChange&&Te.track(t.id,o,(()=>{n(Ie(e,t.id))})),null===i().dataAI.previewId&&await(0,s.hK)()}};let u;u=(0,s.be)(t)?d:(0,s.cY)(t)?l:r;const m=i().dataAI.rawPreview[t.id];m||(0,s.be)(t)?u(m):_.F_.startListening({actionCreator:R.m.setPreviewForSuggestionID,effect:(e,a)=>{a.unsubscribe();const n=a.getState().dataAI.rawPreview[t.id];n&&u(n)}})}catch(e){x.M.getInstance().logErrorCode(m.O.ShowPreviewColumnFailed,e,p.S2.FormulaGeneration,N.$b.ASHA,{key:g.un.SuggestionID,value:t.id}),x.M.getInstance().logStandardizedAshaErrorEvent(r.W.UI_Failed_To_Update_Or_Load,o.c.Preview_On_Grid_Failed_To_Display,g.BJ.FormulaGeneration),n(R.m.stopPreviewing())}},Ie=(e,t)=>async(a,n)=>{if(Te.stopTracking(t),null==n().dataAI.previewId)return;let o;if((0,L.yw9)("OfficeVSO_10207489_hidePreviewOnActiveSheet")&&(0,s.be)(n().dataAI.recommendations[e][0]))o=void 0;else{const t=(0,S.cQ)(e,n());if(!t||!(0,S.k8)(t))return;o=t.sheetName}try{a(R.m.stopPreviewing()),await x.M.getInstance().runTimedAsyncFunction("HidePreviewColumn",(()=>(0,s.hK)(o)),e,t)}catch(e){x.M.getInstance().logErrorCode(m.O.HidePreviewColumnFailed,e,p.S2.FormulaGeneration,N.$b.ASHA,{key:g.un.SuggestionID,value:t})}},Re=(e,t)=>async(a,o)=>{const r=t.calculatedFormulas[0]?.insertionMode;x.M.getInstance().logEvent((0,g.SV)(g.he.SuggestionApplied,g.q.CalculatedRows,g.KZ.AddButton,t.id,e,void 0!==r?l.PH[r]:void 0));const i=(0,q.Z)(t)?t.allowReplacementOfExistingValue?(0,n.KeO)():(0,n.E$x)():t.allowReplacementOfExistingValue?(0,n.ooE)():(0,n.EWN)();_e(a,o,e,t,i,s.fJ,s.jL,Me)},Ae=async(e,t,a)=>{const n=performance.now();(0,c.cY)("getShouldAllowReplacementOfExistingValueInTotalRow start",a,t,n);let o=t.map((()=>!1));const r=e().dataAI.tableName[a];if(r){const n=e().selection.selectionContexts[r];if(n?.showTotals){const e=t.map((e=>e.calculatedFormulas.flatMap((e=>e.insertionIndexes??[]))));let r=await(0,ne.U)(e,n,a)??e.map((()=>!0));(0,L.yw9)("OfficeVSO_9753947_insertCellToFixedRange")&&(r=await Promise.all(r.map((async(e,a)=>{const n=t[a];if((0,q.By)(n)){return await(0,q.Qy)(n.calculatedFormulas[0].fixedInsertionRange)}return e})))),o=r.map((e=>!e))}}return(0,c.cY)("getShouldAllowReplacementOfExistingValueInTotalRow end",a,t,performance.now()-n,o),o},Le=async(e,t,a)=>{const n=e().dataAI.tableName[a];if(!n)return t.map((()=>!1));const o=e().selection.selectionContexts[n];if(!o)return t.map((()=>!1));const r=o.showTotals;let i;return await Promise.all(t.map((async e=>{if((0,q.By)(e))return!1;if((0,q.th)(e))return!1;return!e.calculatedFormulas.some((e=>e.insertionIndexes.includes(0)))&&(!r||await(async()=>(void 0===i&&(i=(await(0,ne.U)([[0]],o,a))?.[0]??!1),i))())})))},ke=(e,t)=>async a=>{const i=e.calculatedFormulas[0]?.insertionMode;x.M.getInstance().logEvent((0,g.SV)(g.he.SuggestionApplied,He(e),g.KZ.AddButton,e.id,t,void 0!==i?l.PH[i]:void 0)),a(w.m.startInsertingFormulaSuggestion());const{message:c,telemetry:d}=ae.n.getInsertSuggestionUserChat((0,n.oOI)());u.$.getInstance().displayResponse(c,d),a((0,T.eM)(g.OP.InsertFormulaSuggestion)),a(Ie(t,e.id));try{await x.M.getInstance().runTimedAsyncFunction("InsertFormulaSuggestion",(()=>(0,s.g0)(e)),t,e.id),a((0,T.Nl)()),await a((0,T.L4)()),a((0,T._Z)({caller:"insertFormulaSuggestion"}));const{message:o,telemetry:r}=ae.n.getFormulaSuggestionInsertSuccessResponse((0,n.ZDb)(),e.id,(()=>a(P.m.restoreTableInterpretationsForUndo())));u.$.getInstance().displayResponse(o,r),a(w.m.stopInsertingFormulaSuggestion()),u.$.getInstance().setInputFocus(),y.B.getInstance().logKeptEvent(g.BJ.FormulaGeneration,He(e),B.RX.Create)}catch(t){const i=(0,n.ySS)();x.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion,g.BJ.FormulaGeneration);const{message:l,telemetry:s}=ae.n.getFormulaSuggestionErrorResponse(i,{shouldShowFormulaDevButton:!0,debugInfo:e.debugInfo});u.$.getInstance().displayResponse(l,s),a(w.m.stopInsertingFormulaSuggestion()),x.M.getInstance().logErrorCode(m.O.InsertFormulaSuggestionFailed,t,p.S2.FormulaGeneration,N.$b.Warning,{key:g.un.SuggestionID,value:e.id}),await a((0,T.L4)())}},Fe=(e,t)=>async(a,o)=>{const r=t.calculatedFormulas[0]?.insertionMode;x.M.getInstance().logEvent((0,g.SV)(g.he.SuggestionApplied,g.q.CalculatedColumns,g.KZ.AddButton,t.id,e,void 0!==r?l.PH[r]:void 0));const i=(0,q.hU)(t)?(0,n.aVz)():(0,n.BqH)();_e(a,o,e,t,i,s.xw,s.Fw,Ne)},_e=async(e,t,a,n,o,r,i,l)=>{const c=(0,s.iM)(n);(0,L.Jhm)()&&Se.stopTracking(n.id),e(w.m.startInsertingFormulaSuggestion());const{message:d,telemetry:h}=ae.n.getInsertSuggestionUserChat(o);if(u.$.getInstance().displayResponse(d,h),!(0,V.CU)(n))return void Oe(e,n.debugInfo);const f=t().dataAI.tableName[a];if(!f)return void Oe(e,n.debugInfo);const C=(0,L.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors");let{selectionContext:v,tableColumnHeaders:S}=await e(be(C?2:0,c,f,a));const I=(0,L.LrR)()?e((0,K.Z)()):t().selection.localeCacheDeprecated;if(!c)if((0,q.th)(n))try{E.CP.calculatedFormulaInsertLocation=await(0,q.a$)()}catch(t){Oe(e,n.debugInfo)}else(0,q.By)(n)?E.CP.calculatedFormulaInsertLocation=n.calculatedFormulas[0].fixedInsertionRange:E.CP.calculatedFormulaInsertLocation=function(e,t){const a=t.rowIndex+t.rowCount+1,n=(0,V.s6)(e,t);return`${1===n?.length?n[0]:""}${a}`}(n,v);const A=function(e){if((0,s.iM)(e))return(0,q.hU)(e)?g.OP.InsertCalculatedColumn:g.OP.InsertCalculatedColumns;return e.allowReplacementOfExistingValue?(0,q.Z)(e)?g.OP.UpdateCalculatedCell:g.OP.UpdateCalculatedCells:(0,q.Z)(e)?g.OP.InsertCalculatedCell:g.OP.InsertCalculatedCells}(n);e((0,T.eM)(A)),e(Ie(a,n.id));try{let{insertionAddresses:o,insertionError:d}=await r(n,f,v,a,I,S);if((0,L.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors")&&d&&"InvalidArgument"===d.code){const t=v.address;({selectionContext:v,tableColumnHeaders:S}=await e(be(1,c,f,a))),t!==v.address&&(x.M.getInstance().logErrorCode(m.O.InsertCalculatedColumnFailedWithInvalidArgTableRangeChanged,d,p.S2.FormulaGeneration,N.$b.Warning,{key:g.un.SuggestionID,value:n.id}),({insertionAddresses:o,insertionError:d}=await r(n,f,v,a,I,S)))}if(d){const t=!(0,q.hU)(n);if(Pe(e,d,n.id,c,t,(0,s.cY)(n)&&(0,q.th)(n),n.debugInfo),0===o.length)return void await e((0,T.L4)());t||x.M.getInstance().logErrorCode(m.O.CalculatedColumnInsertColumnError,(0,g.Jr)("Got insertion error but still have insertion addresses (but not for multi columns)"),p.S2.FormulaGeneration,N.$b.Warning,{key:g.un.SuggestionID,value:n.id})}else try{const{dataAI:e}=t();i(e.rawPreview[n.id],o,v,a)}catch(e){x.M.getInstance().logErrorCode(m.O.CalculatedColumnInsertColumnFailedVerifyPreview,e,p.S2.FormulaGeneration,N.$b.Warning,{key:g.un.SuggestionID,value:n.id})}v.sheetId?(e(P.m.cacheTableInterpretationsForUndo()),e((0,H.XT)(v.sheetId,f,o))):e(P.m.hideSelectionErrorOnRange((0,ee.G2)(f))),e((0,T.Nl)()),e(R.m.markRecommendationInserted({requestId:a,suggestionId:n.id}));try{e(P.m.clearTable(f)),await e((0,H.VW)(f,a))}catch(e){x.M.getInstance().logErrorCode(m.O.CalculatedColumnsInsertColumnFailedResolveTableLikeEntity,e,p.S2.FormulaGeneration,N.$b.Warning,{key:g.un.SuggestionID,value:n.id})}await e((0,T.L4)()),e((0,T._Z)({caller:"insertColumnsRecommendation"}));const h=l(n,o,f),{message:C,telemetry:E}=ae.n.getFormulaSuggestionInsertSuccessResponse(h,n.id,(()=>e(P.m.restoreTableInterpretationsForUndo())));u.$.getInstance().displayResponse(C,E);const A=(0,Z.N)(C);(0,L.yw9)("OfficeVSO_9598840_SkipRedundantSkillResponse")||e((0,T.nv)(A,b.Aw.success,E)),e(w.m.stopInsertingFormulaSuggestion()),u.$.getInstance().setInputFocus(),y.B.getInstance().logKeptEvent(g.BJ.FormulaGeneration,He(n),B.RX.Create)}catch(t){await Pe(e,t,n.id,c,!(0,q.hU)(n),(0,s.cY)(n)&&(0,q.th)(n),n.debugInfo),await e((0,T.L4)())}},Pe=async(e,t,a,i,l,s,c)=>{const d=t instanceof OfficeExtension.Error?t.code:null;let h="";s&&"PivotTableRangeConflict"===d?(h=n.olU.CalculatedRowsSelectedCellPivotTableSelected,x.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Conflict_In_The_Target_Range,g.BJ.FormulaGeneration)):"InsertDeleteConflict"===d||"PivotTableRangeConflict"===d||d===m.O.CalculatedColumnExpandFailedNotEmptyColumn?(h=i?l?(0,n.J0g)():(0,n.Goo)():(0,n.SXB)(),x.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Conflict_In_The_Target_Range,g.BJ.FormulaGeneration)):"AccessDenied"===d?(h=i?(0,n.YbA)():(0,n.wQR)(),x.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Protection_Settings,g.BJ.FormulaGeneration)):"ItemNotFound"===d?(h=i?(0,n.ZX_)():(0,n.Rc5)(),x.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion_Due_To_Target_Table_Error,g.BJ.FormulaGeneration)):(h=i?(0,n.u3x)():(0,n.mYV)(),x.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_Column_Insertion,g.BJ.FormulaGeneration));const{message:f,telemetry:C}=ae.n.getFormulaSuggestionErrorResponse(h,{shouldShowFormulaDevButton:!0,debugInfo:c});if(u.$.getInstance().displayResponse(f,C),!(0,L.yw9)("OfficeVSO_9598840_SkipRedundantSkillResponse")){const t=JSON.stringify({text:(0,Z.N)(f),publishPreference:"Never"});e((0,T.nv)(t,b.Aw.failed,C))}e(w.m.stopInsertingFormulaSuggestion()),x.M.getInstance().logErrorCode(m.O.InsertCalculatedColumnFailed,t,p.S2.FormulaGeneration,N.$b.Warning,{key:g.un.SuggestionID,value:a})},Ne=(e,t,a)=>{const o=t.map((e=>/:([A-Z]+)/.exec(e)?.[1])),r=o.every((e=>e));if(r||x.M.getInstance().logErrorCode(m.O.CalculatedColumnsInsertColumnFailedGetRange,(0,g.Jr)("Failed to get column letter"),p.S2.FormulaGeneration,N.$b.Warning,{key:g.un.SuggestionID,value:e.id}),1===o.length){const t=e.calculatedFormulas[0].columnName;return r?(0,U.L)((0,n.OfU)(),t,o[0]):(0,U.L)((0,n.q_f)(),t,a)}if(o.length>3)return(0,j.VY)((0,n.xau)(),{columnLength:o.length.toString()});{const t=o.map(((t,a)=>e.calculatedFormulas[a].columnName)),i=(0,z.q)(t?.map((e=>`'${e}'`))??[]);if(r){const e=(0,z.q)(o.filter((e=>"string"==typeof e)));return(0,j.VY)((0,n.L8i)(),{columnNames:i,columnHeaders:e})}return(0,j.VY)((0,n.AKP)(),{columnNames:i,tableName:a})}},Me=(e,t,a)=>{const o=(0,q.th)(e)&&t.length>0?(0,q.gx)(t[0])??"":E.CP.calculatedFormulaInsertLocation??"",r="CalculatedRowsConfirmationTextForCellWithAddress",i="CalculatedRowsConfirmationTextForUpdateCellWithAddress",l="CalculatedRowsConfirmationTextForRowWithAddress",s="CalculatedRowsConfirmationTextForUpdateRowWithAddress",c="CalculatedRowsCellHeader",d="CalculatedRowsRowHeader";let u;u=(0,q.XZ)(e)?e.allowReplacementOfExistingValue?i:r:e.allowReplacementOfExistingValue?s:l;return((e,t)=>{const a=n.olU[e],r=`**${n.olU[t]}**`,i=t===c?"cellAddress":"rowNumber";return a.replace("{0}",r).replace(`{${i}}`,o)})(u,(0,q.XZ)(e)?c:d)},Oe=(e,t)=>{const{message:a,telemetry:o}=ae.n.getFormulaSuggestionErrorResponse((0,n.u3x)(),{shouldShowFormulaDevButton:!0,debugInfo:t});if(u.$.getInstance().displayResponse(a,o),!(0,L.yw9)("OfficeVSO_9598840_SkipRedundantSkillResponse")){const t=JSON.stringify({text:(0,Z.N)(a),publishPreference:"Never"});e((0,T.nv)(t,b.Aw.failed,o))}e(w.m.stopInsertingFormulaSuggestion()),e(w.m.stopExecuting())},De=(e,t)=>async(a,o)=>{const r=(0,s.iM)(t);if(!t||!(0,V.CU)(t))return;const i=o().dataAI.tableName[e];if(!i)return;if(!o().selection.selectionContexts[i])return;const l=o().selection.selectionContexts[i],c=await a((0,H.CQ)(i,e));c&&(0,S.k8)(l)&&void 0!==o().dataAI.rawPreview[t.id]&&setTimeout((async()=>{try{const i=o().dataAI.rawPreview[t.id],d=o().dataAI.visibleRowPreviewValues[t.id],u=0===i.length||0===i[0].length;if(u&&(!d||0===d.length)||!r&&u)throw new Error("No preview values");const m=l.rowIndex+1;let h=(0,V._c)(t,l);const g=(0,s.cY)(t)?(0,S.YE)(t,c.texts):[];let p=i;t.insertRowTitle&&i.some((e=>e.length>0))&&(p=[[n.olU.CalculatedRowsFormulaTotalHeader,...i[0]],...i.slice(1)],h=[(0,G.z)(l.columnIndex+1),...h]);const b=(0,L.BOx)()?await x.M.getInstance().runTimedAsyncFunction("GetVisibleRows",(()=>(0,s.e1)(l)),e):void 0;a(R.m.updateFormulaRecommendationPreview({formulaSuggestionType:t.suggestionType,requestId:e,suggestionId:t.id,visibleRowsPreviewValues:d,preview:{previewValues:p,rowNumber:m,letters:h},tableValues:g,rowCount:(0,L.yw9)("OfficeVSO_9622925_fixRowPreviewMaxRow")?l.rowCount:void 0,visibleRows:b}))}catch(n){a(R.m.updateFormulaRecommendationPreview({formulaSuggestionType:t.suggestionType,requestId:e,suggestionId:t.id,preview:"Failed",visibleRowsPreviewValues:[],tableValues:[]})),x.M.getInstance().logErrorCode(m.O.SetFormulaPreviewFailed,n,p.S2.FormulaGeneration,N.$b.ASHA,{key:g.un.SuggestionID,value:t.id})}}),0)},Be=async(e,t,a,o,r=!1)=>{t(R.m.fetchRecommendationsFailed(e)),await t((0,T.L4)(!1));const{message:i,telemetry:l}=ae.n.getFormulaSuggestionErrorResponse(a??(0,n.HGr)(),{shouldShowFormulaDevButton:!1},o);if(u.$.getInstance().displayResponse(i,l),!r){const e=JSON.stringify({text:(0,Z.N)(i),publishPreference:"Never"});t((0,T.nv)(e,b.Aw.failed,l))}t((0,T.Nl)())},$e=(e,t)=>async(a,n)=>{const{recommendations:o}=n().dataAI,r=o[e],i=r[t];(0,L.Jhm)()&&x.M.getInstance().runTimedAsyncFunction("FormulaSuggestionInvalidatorTrack",(()=>Se.track(e,(0,S.cQ)(e,n()),i,((e,t)=>{a(R.m.markRecommendationAsInvalidated({reason:e,suggestionId:t}))}))),e,i.id);const{message:s,telemetry:c}=ae.n.getFormulaSuggestionResponse(e,t,r);u.$.getInstance().displayResponse(s,c);const d=J(i,n,e);(0,L.yw9)("OfficeVSO_9598840_SkipRedundantSkillResponse")||a((0,T.nv)(d,b.Aw.success,c));const m=o[e][t];a(De(e,m));const h=m.calculatedFormulas[0]?.insertionMode;if(x.M.getInstance().logEvent((0,g.SV)(g.he.SuggestionShown,He(i),g.KZ.FormulaGenerationSuggestionPill,m.id,e,void 0!==h?l.PH[h]:void 0)),a(R.m.setCurrentShownSuggestionIndex({requestId:e,suggestionIndex:t})),t+1<o[e].length){const n=o[e][t+1];a((0,T.Vf)(e,!n.isAlternativeSuggestion,n.suggestionType,t+1))}else a((0,T.Yx)(["CalculatedColumns_SpecificSuggestion"]))};const He=e=>(0,s.be)(e)?g.q.NLToFormula:(0,s.cY)(e)?g.q.CalculatedRows:g.q.CalculatedColumns},299512:(e,t,a)=>{"use strict";a.d(t,{$j:()=>z,AG:()=>N,Ah:()=>I,GT:()=>b,Ks:()=>F,M$:()=>f,MQ:()=>y,OK:()=>C,P9:()=>W,S5:()=>Q,TF:()=>A,TP:()=>T,Zv:()=>w,bp:()=>x,ey:()=>M,f0:()=>E,f_:()=>p,hd:()=>S,ie:()=>L,kB:()=>P,kw:()=>_,py:()=>v,xl:()=>R});var n=a(267324),o=a(103806),r=a(449650),i=a(255448),l=a(910480),s=a(797639),c=a(703227),d=a(79458),u=a(528804),m=a(479592),h=a(14086),g=a(804672);function p(e,t,a,n){const o=v(e),r=n?t[n]:t[o];if(!r)return t;const i=(0,l.cloneDeep)(t),s={...r,...a};return n&&o!==n&&(i[o]=i[n],delete i[n]),i[o]=s,i}function b(e){if(1===e.length&&!f(e[0]))throw new Error("Single range that is not fully specified");const t={topLeft:{row:Math.min(...e.map((e=>(e=>null!==e.topLeft.row?e.topLeft.row:1/0)(e)))),column:Math.min(...e.map((e=>(e=>null!==e.topLeft.column?e.topLeft.column:1/0)(e))))},bottomRight:{row:Math.max(...e.map((e=>(e=>null!==e.bottomRight.row?e.bottomRight.row:0)(e)))),column:Math.max(...e.map((e=>(e=>null!==e.bottomRight.column?e.bottomRight.column:0)(e))))}};if(!f(t))throw new Error("Bounding rect does not produce a fully specified range");return t}function f(e){return null!==e.topLeft.column&&null!==e.topLeft.row&&null!==e.bottomRight.column&&null!==e.bottomRight.row&&e.bottomRight.column>=e.topLeft.column&&e.bottomRight.row>=e.topLeft.row}function C(e,t,a,n){if(!f(e))throw new Error("Invalid TLR range");const o={worksheetId:n,left:e.topLeft.column+1,top:e.topLeft.row+1,right:e.bottomRight.column+1,bottom:e.bottomRight.row+1},r=t[a],i=(0,c.Jm)((0,c.zC)(r.name),o);return p(i,t,{range:e,name:i,interpretation:{...r.interpretation,location:o}},a)}function y(e){if(!f(e))throw new Error("Invalid TLR range");return`${e.topLeft.column+1}|${e.bottomRight.column+1}|${e.topLeft.row+1}|${e.bottomRight.row+1}`}function v(e){return y(r.ExcelCalc.addressToExcelRange((0,c.G2)(e)))}function x(e,t){let a=i.ye.None;t.hasMergedcells&&(a|=i.ye.HasMergedCells);const n=e.aggregationLines?.length,o=t.primaryTable?.hasTotalRow??!1;o&&(a|=i.ye.TotalsRow),n&&(n>1||1===n&&!o)&&(a|=i.ye.UnsupportedAggregations);return a|=[{check:"columnMajor"===e.orientation&&0===e.headerRowCount,flag:i.ye.NoHeaderRow},{check:"columnMajor"===e.orientation&&e.headerRowCount>1,flag:i.ye.MultipleHeaderRows},{check:"columnMajor"===e.orientation&&e.headerColumnCount>0,flag:i.ye.HeaderColumns},{check:"rowMajor"===e.orientation,flag:i.ye.RowMajor},{check:"rowMajor"===e.orientation&&0===e.headerColumnCount,flag:i.ye.NoHeaderColumn},{check:"rowMajor"===e.orientation&&e.headerColumnCount>1,flag:i.ye.MultipleHeaderColumns},{check:"rowMajor"===e.orientation&&e.headerRowCount>0,flag:i.ye.HeaderRows},{check:.5===e.confidence,flag:i.ye.Crosstab}].reduce(((e,t)=>t.check?e|t.flag:e),i.ye.None),{unsupportedFeatures:a,hasTotalRow:o}}function T(e,t){return"columnMajor"===e?!!(t&i.ye.NoHeaderRow):!!(t&i.ye.NoHeaderColumn)}function S(e){return function(e){const t=new Set(e);return e.some((e=>function(e,t){const a=G[e];return!!a&&a.every((e=>!t.has(e)))}(e,t)))}(e)?(0,n.nYf)():(0,n.VH3)()}function w(e){const t=D(e);return t?.singleErrorMessage??""}function E(e){const t=D(e);return t?.multipleErrorMessage??""}function I(e){const t=D(e);return t?.header??""}async function R(e){const t=O(e);return{header:await t.header(),description:t.description}}function A(e){if(1===e.length){return O(e[0]).successfulResponse}return(0,n.qPG)()}function L(e){if(1===e.length){return O(e[0]).unsuccessfulResponse}return(0,n.Py2)()}const k=(e,t,a)=>a.includes(t[0])&&a.includes(t[1])&&e===t[0];async function F(e){if(e=e.filter((t=>!V.some((a=>k(t,a,e))))),(0,u.yw9)("OfficeVSO_9858186_bug9828739tlrerrornotindicateemptyandduplicateheader")){const t=await(0,m.K4)();0!==(await(0,m.I1)()).length&&0===t.length&&(e=e.filter((e=>e!==i.ye.DuplicateHeaders)))}return e}function _(e){return Object.values(i.ye).filter((t=>"number"==typeof t&&t!==i.ye.All&&e&t))}function P(e){try{return e.reduce(((e,t)=>e|t[1]),i.ye.None)}catch(e){return(0,d.cY)("Error getting unsupported skill features:",e),i.ye.None}}function N(e){try{return e.reduce(((e,t)=>e|t[1]),0)}catch(e){return(0,d.cY)("Error getting unsupported context features:",e),0}}function M(e){switch(e){case i.b_.PayloadTooLarge:return(0,n.OX0)();case i.b_.PivotTableSelected:case i.b_.ChartSelected:default:return(0,u.yw9)("OfficeVSO_9364126_UpdateAnalyzeDataInsertResponse")?(0,n.zGM)():(0,n.FxF)()}}function O(e){switch(e){case i.ye.DuplicateHeaders:return{header:(0,u.yw9)("OfficeVSO_9858186_bug9828739tlrerrornotindicateemptyandduplicateheader")?q:async()=>(0,n.c_T)(),description:(0,n.P$N)(),successfulResponse:(0,n.MIy)(),unsuccessfulResponse:(0,n.bor)()};case i.ye.HasMergedCells:return{header:H,description:(0,n.Pqn)(),successfulResponse:(0,n.uvg)(),unsuccessfulResponse:(0,n.R3b)()};case i.ye.EmptyHeaders:return{header:(0,u.yw9)("OfficeVSO_9858186_bug9828739tlrerrornotindicateemptyandduplicateheader")?U:async()=>(0,n.mJ6)(),description:(0,n.z56)(),successfulResponse:(0,n.MuJ)(),unsuccessfulResponse:(0,n.VJh)()};default:return{header:async()=>{},description:void 0,successfulResponse:(0,n.qPG)(),unsuccessfulResponse:(0,n.Py2)()}}}function D(e){switch(e){case i.ye.RowMajor:return{singleErrorMessage:(0,n.DIq)(),multipleErrorMessage:(0,n.NXr)(),header:(0,n.L0V)()};case i.ye.HeaderColumns:return{singleErrorMessage:(0,n.ujQ)(),multipleErrorMessage:(0,n.kMm)(),header:(0,n.pOf)()};case i.ye.HasMergedCells:return{singleErrorMessage:(0,n.ZkE)(),multipleErrorMessage:(0,n.Thz)(),header:(0,n.C$7)()};case i.ye.UnsupportedAggregations:case i.ye.TotalsRow:return{singleErrorMessage:(0,n.qre)(),multipleErrorMessage:(0,n.Gp3)(),header:(0,n.Pxj)()};case i.ye.NoHeaderRow:return{singleErrorMessage:(0,n.ujQ)(),multipleErrorMessage:(0,n.kMm)(),header:(0,n.pOf)()};case i.ye.MultipleHeaderRows:return{singleErrorMessage:(0,n.nMc)(),multipleErrorMessage:(0,n.pP4)(),header:(0,n.mcb)()};case i.ye.EmptyHeaders:return{singleErrorMessage:(0,n.jLG)(),multipleErrorMessage:(0,n.z56)(),header:(0,n.mJ6)()};case i.ye.DuplicateHeaders:return{singleErrorMessage:(0,n.Tlk)(),multipleErrorMessage:(0,n.Dh1)(),header:(0,n.c_T)()};case i.ye.Crosstab:return{singleErrorMessage:(0,n.up8)(),multipleErrorMessage:(0,n.ev2)(),header:(0,n.h_t)()};case i.ye.MultipleHeaderColumns:case i.ye.NoHeaderColumn:case i.ye.HeaderRows:case i.ye.LowInterpretationConfidence:return{singleErrorMessage:(0,n.c7Y)(),multipleErrorMessage:(0,n.GIT)(),header:(0,n.vkL)()};case i.ye.Unrecognized:default:{const e=o.p.getInstance();if(e&&!e.isModelWorkflowSupported)return{singleErrorMessage:(0,n.YMx)(),multipleErrorMessage:void 0,header:void 0};{const e=s.CP.getActiveTable();return{singleErrorMessage:B(e),multipleErrorMessage:void 0,header:void 0}}}}}const B=e=>$(e)?(0,n.p8O)():(0,n.eGo)(),$=e=>!!e&&(e.numColumns<2||e.numRows<3);async function H(){const e=await(0,m.ge)(),t=e.length;let a;if(0===t)a=(0,g.VY)((0,n.yo8)(),{count:""});else if(t>2)a=(0,g.VY)((0,n.yo8)(),{count:t});else if(2===t){const[t,o]=e.map((e=>(0,h.r)(e)));a=(0,g.VY)((0,n.qp3)(),{range1:t,range2:o})}else{const t=(0,h.r)(e[0]);a=(0,g.VY)((0,n.ay0)(),{range:t})}return a}async function U(){const e=await(0,m.I1)(),t=e.length;let a;if(0===t)a=(0,g.VY)((0,n.z32)(),{count:""});else if(t>2)a=(0,g.VY)((0,n.z32)(),{count:t});else if(2===t){const[t,o]=e.map((e=>(0,h.r)(e)));a=(0,g.VY)((0,n.DqZ)(),{range1:t,range2:o})}else{const t=(0,h.r)(e[0]);a=(0,g.VY)((0,n.XD3)(),{range:t})}return a}async function q(){const e=await(0,m.K4)(),t=e.length;let a;if(0===t)a=(0,g.VY)((0,n.P13)(),{count:""});else if(t>2)a=(0,g.VY)((0,n.P13)(),{count:t});else if(2===t){const[t,o]=e.map((e=>(0,h.r)(e)));a=(0,g.VY)((0,n.H6H)(),{range1:t,range2:o})}else a=(0,g.VY)((0,n.P13)(),{count:t});return a}const V=[[i.ye.HeaderColumns,i.ye.NoHeaderRow],[i.ye.TotalsRow,i.ye.UnsupportedAggregations]],G={[i.ye.EmptyHeaders]:[i.ye.HasMergedCells,i.ye.UnsupportedAggregations,i.ye.MultipleHeaderRows],[i.ye.Crosstab]:[i.ye.HasMergedCells,i.ye.UnsupportedAggregations,i.ye.MultipleHeaderRows]};function W(e,t){if(e===t)return!0;if(!e.includes("!")||!t.includes("!"))return!1;if(r.ExcelCalc.sheetNameFromSheetAddresses(e)!==r.ExcelCalc.sheetNameFromSheetAddresses(t))return!1;return j(r.ExcelCalc.addressToExcelRange((0,c.G2)(e)),r.ExcelCalc.addressToExcelRange((0,c.G2)(t)))}function z(e,t){if(e===t.name)return!0;if(!e.includes("!"))return!1;if(r.ExcelCalc.sheetNameFromSheetAddresses(e)!==r.ExcelCalc.sheetNameFromSheetAddresses(t.name))return!1;return j(r.ExcelCalc.addressToExcelRange((0,c.G2)(e)),t.range)}function j(e,t){if(!f(e)||!f(t))return!1;if(!r.ExcelCalc.IExcelRangeIntersect(e,t))return!1;const a=Math.abs(e.topLeft.row-t.topLeft.row),n=Math.abs(e.bottomRight.row-t.bottomRight.row);return a<=1&&n<=1}function Q(e){const t=[i.ye.UnsupportedAggregations,i.ye.HeaderColumns,i.ye.Crosstab,i.ye.MultipleHeaderRows,i.ye.EmptyHeaders,i.ye.DuplicateHeaders,i.ye.HasMergedCells];return e.sort((function(e,a){let n=t.indexOf(e),o=t.indexOf(a);return-1===n&&(n=t.length),-1===o&&(o=t.length),n-o}))}},303943:(e,t,a)=>{"use strict";a.d(t,{r9:()=>me,sy:()=>ge,gT:()=>he,yu:()=>ue});var n=a(707314),o=a(78160),r=a(267324),i=a(47262),l=a(919654),s=a(750927),c=a(528804);const d="Forecast({0})",u="Lower Confidence Bound({0})",m="Upper Confidence Bound({0})",h="=FORECAST.ETS(A{0},{1},{2})",g="=C{0}-FORECAST.ETS.CONFINT(A{0},{1},{2})",p="=C{0}+FORECAST.ETS.CONFINT(A{0},{1},{2})",b="$A$2:$A$",f="$B$2:$B$",C="General";function y(e){const t=[...e.originalTimeValues,...e.resultTimeValues],a=e.originalValues.length,n=e.resultValues.length,o=a+n,r=e.originalValues[a-1],i=[...e.originalValues,...new Array(n).fill(null)],c=b+(a+1),y=f+(a+1),v=a+2,x=(0,l.Kz)(n,(e=>(0,s.L)(h,e+v,y,c))),S=(0,l.Kz)(n,(e=>(0,s.L)(g,e+v,y,c))),w=(0,l.Kz)(n,(e=>(0,s.L)(p,e+v,y,c))),E=[...new Array(a-1).fill(null),r,...x],I=[...new Array(a-1).fill(null),r,...S],R=[...new Array(a-1).fill(null),r,...w];return{fields:[T(1,t),T(2,i,new Array(o).fill(C)),T(3,E,new Array(o).fill(C)),T(4,I,new Array(o).fill(C)),T(5,R,new Array(o).fill(C))],fieldHeaders:[{runs:[{text:e.timeColumnName}]},{runs:[{text:e.valueColumnName}]},{runs:[{text:(0,s.L)(d,e.valueColumnName)}]},{runs:[{text:(0,s.L)(u,e.valueColumnName)}]},{runs:[{text:(0,s.L)(m,e.valueColumnName)}]}]}}function v(e){return{fields:[T(1,e.resultTimeValues.slice(0,5)),T(2,e.resultValues.slice(0,5))],fieldHeaders:[{runs:[{text:e.timeColumnName}]},{runs:[{text:(0,s.L)(d,e.valueColumnName)}]}]}}function x(e){const t=[{dimensionType:"categories",title:{runs:[{text:e.timeColumnName}]},axisGroup:"primary"},{dimensionType:"values",title:{runs:[{text:e.valueColumnName}]},axisGroup:"primary",linearValueScale:{zeroPolicy:"includeZero"}}],a=[...e.originalTimeValues,...e.resultTimeValues],n=e.originalValues.length,o=e.resultValues.length,r=n+o,i=e.originalValues[n-1],l=[...e.originalValues,...new Array(o).fill(null)],c=[...new Array(n-1).fill(null),i,...e.resultValues],h=[...new Array(n-1).fill(null),i,...e.lowerBound],g=[...new Array(n-1).fill(null),i,...e.upperBound],p={top:1,bottom:r,left:1,right:1},b={top:1,bottom:r,left:2,right:2},f={top:1,bottom:r,left:3,right:3},y={top:1,bottom:r,left:4,right:4};return{axes:t,data:{dimensions:[T(1,a,void 0,[{top:1,bottom:r,left:0,right:0}]),T(2,l,new Array(r).fill(C),[p]),T(3,c,new Array(r).fill(C),[b]),T(4,h,new Array(r).fill(C),[f]),T(5,g,new Array(r).fill(C),[y]),S(6,e.valueColumnName,[{top:0,bottom:0,left:1,right:1}]),S(7,(0,s.L)(d,e.valueColumnName),[{top:0,bottom:0,left:2,right:2}]),S(8,(0,s.L)(u,e.valueColumnName),[{top:0,bottom:0,left:3,right:3}]),S(9,(0,s.L)(m,e.valueColumnName),[{top:0,bottom:0,left:4,right:4}])]},series:[w(1,2,6),w(1,3,7),w(1,4,8),w(1,5,9)],showLegend:!0}}function T(e,t,a,n){return{id:e,values:{raw:t,strings:t.map((e=>e?.toString()??"")),formats:a},references:n}}function S(e,t,a){return{id:e,values:{raw:[t],strings:[t]},references:a}}function w(e,t,a){return{layout:"line",valueAxisGroup:"primary",exceptions:[],dataBindings:[{dimensionId:e,dimensionType:"categories"},{dimensionId:t,dimensionType:"values"},{dimensionId:a,dimensionType:"title"}]}}var E=a(805027),I=a(69284),R=a(534537),A=a(351779),L=a(56254),k=a(880496);const F="#VALUE!";async function _(e,t,a){const{name:n,nameReferences:o}=t;return n||(1===o.length&&void 0!==o[0].row&&void 0!==o[0].column?e.getText(o[0].row,o[0].column):(0,I.Hf)(e,t,a))}function P(e){const t=function(e){if(typeof e.rowFieldIndex==typeof e.columnFieldIndex)throw new Error(`ValueFilter: ${JSON.stringify(e)} should have exactly one of "rowFieldIndex" or "columnFieldIndex"`);return null==e.columnFieldIndex?{labelFieldIndex:e.rowFieldIndex,labelFieldType:"rowField"}:{labelFieldIndex:e.columnFieldIndex,labelFieldType:"columnField"}}(e);switch(e.filterType){case"equal":case"notEqual":case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"startsWith":case"notStartsWith":case"endsWith":case"notEndsWith":case"contains":case"notContains":return{...t,filterType:e.filterType,value:e.value};case"between":case"notBetween":return{...t,filterType:e.filterType,value:e.value,value2:e.value2};default:return(0,i.x)(e.filterType)}}function N(e){const t=e=>new Date(86400*(e-25569)*1e3),a=function(e){if(typeof e.rowFieldIndex==typeof e.columnFieldIndex)throw new Error(`DateFilterBase: ${JSON.stringify(e)} should have exactly one of "rowFieldIndex" or "columnFieldIndex"`);return null==e.columnFieldIndex?{fieldIndex:e.rowFieldIndex,fieldType:"rowField"}:{fieldIndex:e.columnFieldIndex,fieldType:"columnField"}}(e);switch(e.filterType){case"inDynamicPeriod":return{...a,filterType:e.filterType,periodType:e.periodType};case"between":case"notBetween":return{...a,filterType:e.filterType,value:t(e.value),value2:t(e.value2),wholeDays:e.wholeDays};case"equal":case"notEqual":case"before":case"beforeOrEqual":case"after":case"afterOrEqual":return{...a,filterType:e.filterType,value:t(e.value),wholeDays:e.wholeDays};default:return(0,i.x)(e.filterType)}}function M(e){if(typeof e.rowFieldIndex==typeof e.columnFieldIndex)throw new Error(`ValueFilter: ${JSON.stringify(e)} should have exactly one of "rowFieldIndex" or "columnFieldIndex"`);return null!=e.rowFieldIndex?{labelFieldIndex:e.rowFieldIndex,labelFieldType:"rowField"}:{labelFieldIndex:e.columnFieldIndex,labelFieldType:"columnField"}}function O(e){const t={...M(e),dataFieldIndex:e.dataFieldIndex};switch(e.filterType){case"bottomItems":case"bottomPercent":case"bottomSum":case"equal":case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"notEqual":case"topItems":case"topPercent":case"topSum":return{...t,filterType:e.filterType,value:e.value};case"between":case"notBetween":return{...t,filterType:e.filterType,value:e.value,value2:e.value2};default:return(0,i.x)(e.filterType)}}function D(e){return(e.columnFields||[]).length>0||0===(e.dataFields||[]).length}function B(e){return Math.max((e.rowFields||[]).length,1)}function $(e){const t=(e.rowFields||[]).length,a=(e.columnFields||[]).length,n=(e.dataFields||[]).length;return e.pivotTableData&&function(e){if(1===n&&(t>0&&a>0||0===t&&0===a)){return[[{dataFieldIndex:0},...e[0].slice(1)],...e.slice(1)]}return e}((o=function(t){const a=B(e);return a>1?[t.slice(0,a).reduce(((e,t)=>e.map(((e,a)=>e||t[a]))),t[0]),...t.slice(a)]:t}(e.pivotTableData),D(e)?o.map((e=>[null,...e])):o));var o}function H(e,t){return D(e)?t+1:t}function U(e,t){return Math.max(t-B(e)+1,0)}function q(e){const t=(e.rowFields||[]).length,a=(e.columnFields||[]).length,n=(e.dataFields||[]).length,o=null!=e.grandTotalRowIndex&&(0!==t||a>0&&1===n)?H(e,e.grandTotalRowIndex):void 0,r=null==e.grandTotalColumnIndex?e.grandTotalColumnIndex:U(e,e.grandTotalColumnIndex),i=e.grandTotalColumnIndices?.map((t=>U(e,t))),l=(e.dataFields||[]).map((t=>({...t,dataTableColumnIndices:t.dataTableColumnIndices?.map((t=>U(e,t)))}))),s=e.highlightCellReferences?.map((t=>{const{row:a,column:n}=t;return{row:null==a?a:H(e,a),column:null==n?n:U(e,n)}})),c=e.subTotalColumnIndices?.map((t=>U(e,t))),d=e.subTotalRowIndices?.map((t=>H(e,t)));return function(e){const t=e.pivotTableData.slice(0,I.y3).map((e=>e.slice(0,I.m6))),a=e=>void 0!==e&&e<I.m6,n=e=>void 0!==e&&e<I.y3,o=a(e.grandTotalRowIndex)?e.grandTotalRowIndex:void 0,r=n(e.grandTotalColumnIndex)?e.grandTotalColumnIndex:void 0,i=e.grandTotalColumnIndices?e.grandTotalColumnIndices.filter(n):void 0,l=e.subTotalRowIndices?e.subTotalRowIndices.filter(a):void 0,s=e.subTotalColumnIndices?e.subTotalColumnIndices.filter(n):void 0,c=e.dataFields.map((e=>({...e,dataTableColumnIndices:e.dataTableColumnIndices?.filter(n)})));return{...e,pivotTableData:t,dataFields:c,grandTotalRowIndex:o,grandTotalColumnIndex:r,grandTotalColumnIndices:i,subTotalRowIndices:l,subTotalColumnIndices:s}}({...e,pivotTableData:$(e),dataFields:l,subTotalColumnIndices:c,subTotalRowIndices:d,grandTotalRowIndex:o,grandTotalColumnIndex:r,grandTotalColumnIndices:i,highlightCellReferences:s})}async function V(e,t,a,n,o){return 0===t.pivotTableData.length||(0,L.RY)(t.pivotTableData)?[]:Promise.all((t.pivotTableData||[]).map(((i,l)=>Promise.all(i.map(((i,s)=>async function(e,t,a,n,o,i,l){const s=t.pivotTableData[n][a],{rowFields:d,columnFields:u,dataFields:m}=t,h=(d||[]).length,g=(u||[]).length,p=(m||[]).length,b=0===n?i[a]:0;if(s){if(null!=s.textValue&&(0,c.yw9)("OfficeVSO_10200297_UseTextValueForTAWithLoop"))return{value:s.textValue,isNumber:!1,indent:b};if((0,L.vL)(s)||(0,L.Bs)(s))return{value:await G(e,s,m,o),isNumber:!1,indent:b};if((0,L.ir)(s)){const t=e.getValue(s.row,s.column),a=e.getText(s.row,s.column),n=e.getFormat(s.row,s.column),o=e.formatSourceValue(s.row,s.column),[i,l,c,d]=await Promise.all([t,a,n,o]);if(i===F)return{value:l,isNumber:!1,indent:b};if(d){const e=s.datePartOverride;return e?{value:(0,E.xb)(i,e),isNumber:!1,indent:b}:{value:"General"===c?i:d,isNumber:!0,indent:b}}return{value:null==i?(0,r.Atw)():i,isNumber:!1,indent:b}}if((0,L.MB)(s)){const t=m.find((e=>e.dataTableColumnIndices.some((e=>e===n))));if(!!t&&!!t.showAsCalculation&&"percentOfGrandTotal"===t.showAsCalculation){return{value:`${s.value.toFixed(2)}%`,isNumber:!0,indent:b}}return t?.formatReference?W(e,s.value,t.formatReference,b):{value:s.value,isNumber:!0,indent:b}}throw new Error(`Invalid PivotTableDataValue. Provided entries: [${Object.entries(s)}]`)}if(h>0&&a===(0,I.HF)(t)-1&&0===n){if(l&&1===h){return{value:await _(e,d[0],o),isNumber:!1,indent:b}}return{value:(0,r.VDh)(),isNumber:!1,indent:b}}if(g>0&&0===a){if(n===(1===p||h>0?1:0)){if(l&&1===g){return{value:await _(e,u[0],o),isNumber:!1,indent:b}}return{value:(0,r.NRU)(),isNumber:!1,indent:b}}}return{value:"",isNumber:!1,indent:b}}(e,t,s,l,a,n,o)))))))}async function G(e,t,a,n){const o=t.dataFieldIndex;if(o<0||o>2*a.length)throw new Error(`Invalid PivotTableDataValue.dataFieldIndex: "${o}" for number of dataFields ${a.length}`);const i=a[o%(a.length+1)],l=i&&(0,R.i)(i.dataCalculation);let c,d=Promise.resolve(void 0),u=Promise.resolve(void 0);(0,L.Bs)(t)&&(d=e.getText(t.row,t.column)),o<a.length&&(u=_(e,i,n));const[m,h]=await Promise.all([d,u]);if(null!=m&&(c=(0,k.So)(m)?(0,r.Atw)():m),null!=h)return(0,s.L)((0,r.Gn5)(),l,h);if((0,L.Bs)(t)){if(o>a.length){const t=await _(e,i,n);return(0,s.L)((0,r.u6S)(),c,l,t)}return(0,s.L)((0,r.ZSg)(),c)}if(o>a.length){const t=await _(e,i,n);return(0,s.L)((0,r.ft7)(),l,t)}return(0,r.AZo)()}async function W(e,t,a,n){const o=e.getFormat(a.row,a.column),r=e.formatAggregateValue(a.row,a.column,t),[i,l]=await Promise.all([o,r]);return"General"===i?{value:t,isNumber:!0,indent:n}:{value:l,isNumber:!0,indent:n}}async function z(e,t,a,n,o,r){const i=Promise.all((t.dataFields||[]).map((t=>async function(e,t,a){const{formatReference:n}=t,o=(0,I.Hf)(e,t,a),r=n&&e.getFormatLocal(n.row,n.column),[i,l]=await Promise.all([o,r]);return{name:i,dataCalculation:t.dataCalculation,showAsCalculation:t.showAsCalculation,numberFormat:l}}(e,t,a)))),l=t=>async function(e,t,a,n){const o=(0,I.Hf)(e,t,n),[r,i]=await Promise.all([o,a]),l={name:r};t.sortOrder&&(l.sortOrder=t.sortOrder);const s=t.sortByDataField;if("number"==typeof s){if(!(s<i.length))throw new Error("Invalid sortByDataField.");l.sortBy=i[s].name}return t.datePartOverride&&(l.datePartOverride=t.datePartOverride),l}(e,t,i,a),s=Promise.all((t.rowFields||[]).map(l)),c=Promise.all((t.columnFields||[]).map(l)),d=Promise.all((t.filterFields||[]).map((t=>async function(e,t,a){const n=Promise.all((0,A.w)(t.valueReferences,((t,a)=>(0,I.Pe)(e,t,a)))),o=(0,I.Hf)(e,t,a);let r;const i=t.datePartOverride;let l,s;if(i){const a=async(t,a)=>{const n=await e.getValue(t,a);return"number"==typeof n?n:void 0},c=Promise.all((0,A.w)(t.valueReferences,a)),[d,u,m]=await Promise.all([n,o,c]);l=d,s=u,r={datePartOverride:i,values:m.filter((e=>void 0!==e))}}else[l,s]=await Promise.all([n,o]);return{name:s,values:l,datePart:r}}(e,t,a)))),u=n?V(e,t,a,r,o):Promise.resolve(void 0),[m,h,g,p,b]=await Promise.all([i,s,c,d,u]);return{rowFields:h,columnFields:g,filterFields:p,dataFields:m,valueFilters:(t.valueFilters||[]).map(O),labelFilters:(t.labelFilters||[]).map(P),dateFilters:(t.dateFilters||[]).map(N),pivotTableData:b,subTotalRowIndices:t.subTotalRowIndices,subTotalColumnIndices:t.subTotalColumnIndices,grandTotalRowIndex:t.grandTotalRowIndex,grandTotalColumnIndices:t.grandTotalColumnIndices,highlightCellReferences:t.highlightCellReferences||[]}}function j(e,t,a,n,o){return z(e,n?q(t):t,a,n,o,n?function(e){if(0===e.pivotTableData.length)return[];const t=B(e),a=e.pivotTableData.slice(0,t),n=a[0].map(((e,t)=>Math.max(a.map((e=>e[t])).findIndex((e=>!!e))-1,0)));return D(e)?[0,...n]:n}(t):void 0)}var Q=a(590572);const J=async(e,t,a)=>{const n=e.getFormat(t,a),r=e.getFormatLocal(t,a),[i,l]=await Promise.all([n,r]);return{format:i,formatLocal:l,isDateTime:o.P.getNumberFormatCache().isDateTime(l)}};async function Y(e,t,a,n){const o=[];t.forEach((e=>{for(let t=e.top;t<=e.bottom;t++)for(let n=e.left;n<=e.right;n++)o.push(a[n][t])}));const i=Promise.all(o.map(X.bind(null,e))),l=Promise.all(o.map(Z.bind(null,e))),[s,c]=await Promise.all([i,l]);return{raw:n?(0,Q.m9)(s):s,strings:n?c.map(((e,t)=>null===s[t]?(0,r.Atw)():e)):c}}async function X(e,t){return t?(0,L.ir)(t)?e.getValue(t.row,t.column):(0,L.MB)(t)?t.value:"":""}async function Z(e,t){return t?(0,L.ir)(t)?e.getText(t.row,t.column):(0,L.MB)(t)?t.value.toString():"":""}async function K(e,t,a,n){const[o,l]=await Promise.all([(async()=>{if(t.textValues&&(0,c.yw9)("OfficeVSO_10200297_UseTextValueForTAWithLoop"))return{raw:t.textValues,strings:t.textValues};if(!t.references)return t.values?async function(e,t,a){const n={raw:t,strings:t.map((e=>e.toString()))};if(a){const o=Promise.all(t.map((t=>W(e,t,a,0)))),r=e.getFormat(a.row,a.column),i=e.getFormatLocal(a.row,a.column),[l,s,c]=await Promise.all([o,r,i]);return{...n,formattedValues:l,formats:t.map((()=>s)),formatLocals:t.map((()=>c))}}return n}(e,t.values.map((e=>"number"==typeof e?e:parseFloat(e))),t.formatReference):{raw:[],strings:[]};switch(n.type){case"pivottable":return Y(e,t.references,n.dataValues,a);case"source":return async function(e,t,a){const n=Promise.all((0,A.w)(t,e.getValue.bind(e))),o=Promise.all((0,A.w)(t,e.getText.bind(e))),i=Promise.all((0,A.w)(t,((t,a)=>e.getFormat(t,a)))),l=Promise.all((0,A.w)(t,((t,a)=>e.getFormatLocal(t,a)))),[s,c,d,u]=await Promise.all([n,o,i,l]);return{raw:a?(0,Q.m9)(s):s,strings:a?c.map(((e,t)=>null===s[t]?(0,r.Atw)():e)):c,formats:d,formatLocals:u}}(e,t.references,a);case"queryResult":return async function(e,t,a){const n=Promise.all(a.fields.map((t=>K(e,t,!1,{type:"source"})))),o=await n;return{raw:(0,A.w)(t,((e,t)=>o[t].values.raw[e])),strings:(0,A.w)(t,((e,t)=>o[t].values.strings[e])),formats:(0,A.w)(t,((e,t)=>o[t].formatInfo?.format??null)),formatLocals:(0,A.w)(t,((e,t)=>o[t].formatInfo?.formatLocal??null))}}(e,t.references,n.queryResult);default:(0,i.x)(n)}})(),(async()=>{const a=t.formatReference;if(a){const{row:t,column:n}=a;if(void 0===t&&void 0===n)throw new Error("V3SourceCellReference is missing both row and column references.");return J(e,t,n)}const o=t.references;if(o&&o.length>0){const t=o[0],a=t.top,r=t.left;let l,s;switch(n.type){case"pivottable":{const e=n.dataValues[r][a];e&&(0,L.ir)(e)&&(l=e.row,s=e.column);break}case"source":l=a,s=r;break;case"queryResult":{const e=n.queryResult.fields[a].formatReference;l=e?.row,s=e?.column;break}default:(0,i.x)(n)}if(void 0!==l&&void 0!==s)return J(e,l,s)}})()]),s={id:t.id,values:o,formatInfo:l};return t.references&&(s.references=t.references),(e=>{const a=t.datePartOverride;if(null==a)return e;{const t=e.values.raw.map((e=>(0,E.xb)(e,a)));return{...e,formatInfo:void 0,values:{...e.values,raw:t,strings:t,formats:Array(t.length).fill(null),formatLocals:Array(t.length).fill(null)}}}})(s)}var ee=a(824737),te=a(270750);async function ae(e,t,a){return t?ce(e,t,a):void 0}async function ne(e,t,a,n){const o=t.axes&&function(e,t,a){return Promise.all(t.map((async t=>{const n=await ae(e,t.title,a);return{dimensionType:t.dimensionType,linearValueScale:t.linearValueScale,reversePlotOrder:t.reversePlotOrder,title:n,axisGroup:t.axisGroup?t.axisGroup:"primary"}})))}(e,t.axes,a),r=async function(e,t,a,n){return{dimensions:await Promise.all(t.dimensions.map((t=>K(e,t,a.has(t.id),n))))}}(e,t.data,function(e){const t=new Set;return e.series.forEach((e=>e.dataBindings.forEach((e=>{"categories"===e.dimensionType&&t.add(e.dimensionId)})))),t}(t),n),i=async function(e,t,a){const n=await Promise.all(t.map((async t=>{const n=await ae(e,t.title,a),o={dataBindings:t.dataBindings,exceptions:t.exceptions,highlightedLineSegments:t.highlightedLineSegments,layout:t.layout,binOptions:t.binOptions,title:n,valueAxisGroup:t.valueAxisGroup?t.valueAxisGroup:"primary"};return null!=t.highlightStyleIndex&&t.highlightStyleIndex>-1&&(o.highlightStyleIndex=t.highlightStyleIndex>=te.hr.length?0:t.highlightStyleIndex),t.trendlines&&(o.trendlines=t.trendlines),o}))),o=t.some((e=>"secondary"===e.valueAxisGroup)),r=t.some((e=>(0,ee.Y)(e.layout).isLine));return o&&r?n.sort(((e,t)=>{const a=(0,ee.Y)(e.layout).isLine,n=(0,ee.Y)(t.layout).isLine;return a&&!n?1:!a&&n?-1:0})):n}(e,t.series,a),l=ae(e,t.title,a),[s,c,d,u]=await Promise.all([o,r,i,l]),m={axes:s??[],data:c,series:d};return u&&(m.title=u),m}function oe(e){switch(e.exprType){case"and":case"or":case"contains":case"endsWith":case"equality":case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"startsWith":return{exprType:e.exprType,left:oe(e.left),right:oe(e.right)};case"columnName":return re(e);case"datePart":return{exprType:e.exprType,source:oe(e.source),datePartFunction:e.datePartFunction};case"dynamicColumn":return{exprType:e.exprType,kind:e.kind};case"distinct":return{exprType:e.exprType,exprs:e.exprs.map((e=>oe(e)))};case"inQuery":return{exprType:e.exprType,columnNameExpr:re(e.columnNameExpr),query:ie(e.query)};case"numberLiteral":case"dateTimeLiteral":case"stringLiteral":return{exprType:e.exprType,value:e.value};case"query":return ie(e);case"not":return{exprType:e.exprType,expr:oe(e.expr)};case"average":case"count":case"max":case"median":case"min":case"sum":return{exprType:e.exprType,expr:e.expr&&oe(e.expr)};default:(0,i.c)(e)}}function re(e){return{exprType:e.exprType,name:e.name,sourceDataReference:e.sourceDataReference}}function ie(e){return{exprType:e.exprType,projectClause:e.projectClause.map((e=>oe(e))),...e.whereClause&&{whereClause:oe(e.whereClause)},...e.groupClause&&{groupClause:e.groupClause.map((e=>oe(e)))},...e.havingClause&&{havingClause:oe(e.havingClause)},...e.sortClause&&{sortClause:e.sortClause.map((e=>le(e)))},...e.rankingClause&&{rankingClause:{order:e.rankingClause.order.map((e=>le(e))),filter:oe(e.rankingClause.filter),partitions:e.rankingClause.partitions.map((e=>oe(e)))}},...e.takeClause&&{takeClause:e.takeClause}}}function le(e){return{expr:oe(e.expr),order:e.order}}async function se(e,t){const a=t.columnReference,o=t.bulletList?await Promise.all(t.bulletList.map((t=>async function(e,t,a){const n=[];a&&a.top<=a.bottom&&a.left===a.right&&(t.reference.length>r.ifF?(t.reference.slice(0,r.ifF-2).map((async e=>{n.push(e)})),n.push(t.reference[t.reference.length-1])):t.reference.map((async e=>{n.push(e)})));const o=await Promise.all(n.map((t=>e.getText(t+1,a.left))));return{...t,perviewCitationValues:o}}(e,t,a)))):void 0;if(t.analysisType===n.uK.Tagging&&o){const n=await async function(e,t,a){let n=[];if(a&&a.top<=a.bottom&&a.left===a.right){const o=Math.min(t.reduce(((e,t)=>e+t.reference.length),0),I.m6),r=t.map((e=>e.reference.map((t=>({reference:t,tag:e.title}))))).flat().sort(((e,t)=>e.reference-t.reference)).slice(0,o),i=await Promise.all(r.map((async t=>e.getText(t.reference+1,a.left))));return n=r.map(((e,t)=>({reference:e.reference,tag:e.tag,originalData:i[t]}))),{tagFields:n}}return}(e,o,a);return{...t,bulletList:o,tagResult:n}}return{...t,bulletList:o}}async function ce(e,t,a){const n=a?.table,o=n&&(!!n.headerColumnCount&&n.headerColumnCount>1||!!n.headerRowCount&&n.headerRowCount>1),i=await Promise.all(t.runs.map((async t=>{if(void 0!==t.text)return{text:(0,k.So)(t.text)?(0,r.Atw)():t.text};if(null!=t.references){if(!o||1===t.references.length&&(null==t.references[0].column&&null==t.references[0].row||null!=t.references[0].column&&null!=t.references[0].row)){const n=await async function(e,t,a){const{row:n,column:o}=t,i=a?.table.tableLocation;if(void 0===n&&void 0===o)throw new Error("V3SourceCellReference is missing both row and column references.");return void 0===n?(0,s.L)((0,r.m1B)(),i?o-i.left+1:o+1):void 0===o?(0,s.L)((0,r.m1B)(),i?n-i.top+1:n+1):e.getText(n,o)}(e,t.references[0],a);return{text:(0,k.So)(n)?(0,r.Atw)():n.trim()}}throw new Error("Invalid TextRun")}if(t.formattedValue){const{value:a,formatReference:n}=t.formattedValue,o={text:""},i=await e.formatAggregateValue(n.row,n.column,a);return o.text=(0,k.So)(i)?(0,r.Atw)():i,o}throw new Error("Invalid TextRun")})));return{runs:i.map(((e,a)=>{const n=t.runs[a];if(null!=n.highlightStyleIndex&&n.highlightStyleIndex>-1){const t=n.highlightStyleIndex>=te.vA.length?0:n.highlightStyleIndex;e.highlightStyleIndex=t}return e}))}}async function de(e,t,a,n,o=!0){switch(t.visualType){case"ChartVisual":return{chart:await ne(e,t.chart,a,{type:"source"}),visualType:t.visualType,chartConfig:t.chartConfig};case"PivotTableVisual":return{pivotTable:await j(e,t.pivotTable,a,o,n),visualType:t.visualType};case"PivotChartVisual":{const r=ne(e,t.chart,a,t.pivotTable.pivotTableData?{type:"pivottable",dataValues:t.pivotTable.pivotTableData}:{type:"source"}),i=j(e,t.pivotTable,a,o,n),[l,s]=await Promise.all([r,i]);return{chart:l,pivotTable:s,visualType:t.visualType,chartConfig:t.chartConfig}}case"QueryResultVisual":{const n=t.query?function(e){return oe(e)}(t.query):void 0,o=async function(e,t,a){const n=Promise.all((t.fields||[]).map((t=>K(e,t,!1,{type:"source"})))),o=Promise.all((t.fieldHeaders||[]).map((t=>ce(e,t,a)))),[r,i]=await Promise.all([n,o]);return{fields:r,fieldHeaders:i}}(e,t.result,a),r=t.chart&&ne(e,t.chart,a,{type:"queryResult",queryResult:t.result}),[i,l]=await Promise.all([o,r]);return l?{query:n,result:i,chart:l,formula:t.formula,visualType:"QueryChartVisual"}:{query:n,result:i,formula:t.formula,visualType:"QueryResultVisual",isStagingTable:t.isStagingTable}}case"ForecastVisual":return function(e){if(!(0,c.iPS)("Microsoft.Office.Excel.FA000000124.EnableForecasting",!1))throw new Error("Forecasting is disabled but a forecast visual was generated");return{visualType:"ForecastVisual",chart:x(e),previewTable:v(e),formulasTable:y(e)}}(t.forecastResult);case"TextAnalysisVisual":return{textAnalysisResult:await se(e,t.textAnalysisResult),visualType:t.visualType};default:(0,i.c)(t)}}async function ue(e){const t=(0,E.SB)(e.data.formatRows);await o.P.getNumberFormatCache().addFormatPropertiesAsync(["General",...(0,E.SB)(e.data.formatLocalRows).values]);const a=t.positions.map((t=>{const a=e.data.formatLocalRows[t.row][t.column],n=o.P.getNumberFormatCache().data[a].metadata;return{excelFormatCode:a,isDateTime:n.isDateTime,hasMonth:n.hasMonth,hasDay:n.hasDayOfWeek,hasYear:n.hasYear,isPercent:n.isPercent,isCurrency:n.isCurrency,isNumeric:n.isNumeric,isText:n.isText}}));return{valueRows:e.data.valueRows,formatKeyRows:t.keys,formatInfos:a,mergedCells:e.data.mergedCells,formulas:e.data.formulas}}async function me(e,t){const a=function(e){return{...e}}(t.table),n=a.tableLocation.top;let o;if("columnMajor"===t.table.orientation&&1===t.table.headerRowCount){const a=Promise.all(t.fields.map((async(t,a)=>{const o=e.getValue(n,a),r=e.getText(n,a),i=e.getFormat(n,a),l=e.getFormatLocal(n,a),[s,c,d,u]=await Promise.all([o,r,i,l]);return{...t,headerValue:s,headerText:c,headerFormat:d,headerFormatLocal:u}})));o=await a}return{...t,fields:o,table:a}}async function he(e,t,a,n,o){const r=de(e,t.visual,a,n,o),i=t.title&&ce(e,t.title,a),[l,s]=await Promise.all([r,i]);return{id:t.id,interpretationId:a?a.id:t.interpretationId,title:s,visual:l,providerName:t.providerName,providerIndex:t.providerIndex}}async function ge(e,t,a,o){if(t.visualAnswer&&t.responseType===n.WZ.Answered){const n=t.visualAnswer.visual.refreshable,r=null==n||n,i=Promise.all(t.discoverInsights?.map((t=>he(e,t,a,!0)))??[]),l=he(e,t.visualAnswer,a,!0),s=pe(e,a,t.relatedQuestions),[c,d,u]=await Promise.all([i,l,s]);return{...t,visualAnswer:[d],relatedQuestions:u,refreshable:r,forceStaticAnswer:o,discoverInsights:c}}if(t.insightsVisuals){const n=Promise.all(t.insightsVisuals.map((t=>he(e,t,a,!0)))),r=Promise.all(t.discoverInsights?.map((t=>he(e,t,a,!0)))??[]),i=pe(e,a,t.relatedQuestions),[l,s,c]=await Promise.all([n,r,i]);return{...t,visualAnswer:l,relatedQuestions:c,refreshable:!0,forceStaticAnswer:o,discoverInsights:s}}{const n=Promise.all(t.discoverInsights?.map((t=>he(e,t,a,!0)))??[]),r=pe(e,a,t.relatedQuestions),[i,l]=await Promise.all([n,r]);return{...t,visualAnswer:[],relatedQuestions:l,refreshable:i.length>0,forceStaticAnswer:o,discoverInsights:i}}}async function pe(e,t,a){return a&&Promise.all(a.map((async a=>({query:{tokens:a.tokens},title:a.title?await ce(e,a.title,t):{runs:[{text:a.tokens.map((e=>e.token.text)).join("")}]}}))))}},308849:(e,t,a)=>{"use strict";a.d(t,{GZ:()=>C,Hr:()=>g,Sd:()=>v,TR:()=>f,iB:()=>y});var n=a(822606),o=a(660606),r=a(818067),i=a(423905),l=a(83437),s=a(297005),c=a(993821),d=a(795917),u=function(){return u=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},u.apply(this,arguments)},m=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},h=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},g=function(e){if(e)return[{id:"CopilotPlugins.".concat(e.appType,".").concat(e.appId),source:"MOS3"}]},p=function(){var e,t=n.ps;null===(e=null===window||void 0===window?void 0:window.open)||void 0===e||e.call(window,t,"_blank","noopener,noreferrer")};function b(e){return void 0===e||""===e}var f=function(e,t,a){var n=(0,s.Z)(e),r=t===a?void 0:t;return(0,o.cY)("AtMentioned GPT: ",n),(0,o.cY)("Selected menu GPT: ",r),null!=n?n:r};function C(e){return m(this,arguments,void 0,(function(e,t,a,n){var r,s,g,p=this;return void 0===t&&(t=0),void 0===n&&(n=!1),h(this,(function(b){switch(b.label){case 0:r=function(r){return m(p,void 0,void 0,(function(){var s,m,g;return h(this,(function(h){switch(h.label){case 0:return(0,o.cY)("handleCopilotAgentEvent in client",JSON.stringify(u(u({},r),{delayValue:t}))),o.EG.sendChatEventTelemetry((0,i.pN)(((g={})[l.h3.ChatEventType]=l.a5.MOSStoreDialogResponse,g[l.h3.ChatEventParameters]=JSON.stringify(u(u({},r),{delayValue:t})),g))),s=r,t>0?[4,new Promise((function(e){return setTimeout(e,t)}))]:[3,2];case 1:h.sent(),h.label=2;case 2:return n&&a&&(m=(0,c.dL)())&&a(u(u({},m),{PrimaryUserAccountInfo:u(u({},m.PrimaryUserAccountInfo),{CopilotExperience:d.$.M365CopilotChat})})),e(s),[2]}}))}))},b.label=1;case 1:return b.trys.push([1,3,,4]),[4,OfficeFirstParty.UnifiedStore.onCopilotAgentEvent(r)];case 2:return b.sent(),[3,4];case 3:return s=b.sent(),(0,o.cY)("Error in initializing CopilotAgent listener",s),o.EG.sendErrorTelemetry((0,i.pN)(((g={})[l.IC.ErrorMessage]="".concat(s),g[l.IC.ErrorCategory]=l.a5.MOSStoreDialogResponse,g))),[3,4];case 4:return[2]}}))}))}var y=function(e,t,a){return m(void 0,void 0,void 0,(function(){var s,c,d,u;return h(this,(function(m){switch(m.label){case 0:return m.trys.push([0,6,,7]),e?[4,OfficeFirstParty.UnifiedStore.launchStore(n.Bx)]:[3,2];case 1:return m.sent(),[3,5];case 2:return t?[4,r.B.getInstance().openMOSDialog()]:[3,4];case 3:return m.sent(),[3,5];case 4:p(),m.label=5;case 5:return s={RichAPI:e,PrivateAPI:t,Source:a},o.EG.sendChatEventTelemetry((0,i.pN)(((d={})[l.h3.ChatEventType]=l.a5.OpenMOSDialog,d[l.h3.ChatEventParameters]=JSON.stringify(s),d))),[3,7];case 6:return c=m.sent(),(0,o.cY)("Error in launching MOS dialog",c),p(),o.EG.sendErrorTelemetry((0,i.pN)(((u={})[l.IC.ErrorMessage]="".concat(c),u[l.IC.ErrorCategory]=l.a5.OpenMOSDialog,u))),[3,7];case 7:return[2]}}))}))},v=function(e,t){return!e||b(e)?n.u1:JSON.stringify({gptId:null!=e?e:n.u1,agentType:null!=t?t:n.u1})}},310681:(e,t,a)=>{"use strict";a.d(t,{Gr:()=>r,Y:()=>i,iN:()=>s,oO:()=>l});let n="",o="";function r(e){n=e}function i(){return n}function l(e){o=e}function s(){return o}},314998:(e,t,a)=>{"use strict";a.d(t,{Q0:()=>s,hs:()=>c,y3:()=>n});var n,o=a(83437),r=a(965634),i=a(956258),l=a(9847);!function(e){e.scriptNotFound="scriptNotFound",e.unknownScheduleType="unknownScheduleType"}(n||(n={}));class s extends Error{constructor(e,t){super(e),this.isOfficeScriptSkillHandlerError=!0,this.errorType=t}}const c=(e,t,a)=>{const n=i.M.getInstance(),s={eventType:r.S2.OfficeScriptSkillHandler,errorMessage:e.message,logLevel:o.$b.ASHA},c=e.isOfficeScriptSkillHandlerError?e.errorType:void 0,d=[{key:l.ib.OperationType,value:t},{key:l.ib.ErrorMessage,value:e.message},{key:l.ib.RequestId,value:a},...c?[{key:l.ib.ErrorType,value:c}]:[]];n.logError(s,void 0,d)}},318259:(e,t,a)=>{"use strict";async function n(e,t,n,o,r,i,l,s){return(await Promise.all([a.e("chunk1jsfluent","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81","high"),a.e("calc","high")]).then(a.bind(a,837051))).adjustFormulaReferencesToNewColAddition(e,t,n,o,r,i,l,s)}async function o(e,t,n){return(await Promise.all([a.e("chunk1jsfluent","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81","high"),a.e("calc","high")]).then(a.bind(a,837051))).substitution.getColumnsReferencedByFormula(e,t,n)}async function r(e){return(await Promise.all([a.e("chunk1jsfluent","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81","high"),a.e("calc","high")]).then(a.bind(a,837051))).configInstance.printConstantFormattedNumberValue(e)}a.d(t,{k0:()=>r,s_:()=>o,tn:()=>n})},319329:(e,t,a)=>{"use strict";a.d(t,{CE:()=>c,bN:()=>l,fL:()=>s});var n=a(449650),o=a(893763),r=a(743352),i=a(36604);const l=5.625;async function s(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const o=a.workbook.worksheets.getItem(t.sheet).getRange(n.ExcelCalc.IExcelRangeToAddress(t.range)).getCell(0,0).load("format");await a.sync();return d(o.format.rowHeight,u(e,"rowHeight"),1)}))}async function c(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const o=a.workbook.worksheets.getItem(t.sheet).getRange(n.ExcelCalc.IExcelRangeToAddress(t.range)).getCell(0,0).load("format");await a.sync();return d(o.format.columnWidth,u(e,"columnWidth"),l)}))}function d(e,t,a){return"Increase"===t?Math.ceil(e*(1+(0,r.Si)("scaleFactor"))):"Decrease"===t?Math.ceil(e*(1-(0,r.Si)("scaleFactor"))):(e=Number(t))*a}function u(e,t){const a=(0,i.Q4)(e,t);if("string"===a)return(0,i.Am)(e,t);if("number"===a)return(0,i.mT)(e,t);throw new o.Dd(`Argument ${t} type ${a} should be enum or number on ${e.name}`,o.vb.ArgumentTypeMismatch,a,"enum | number")}},328831:(e,t,a)=>{"use strict";a.d(t,{Gn:()=>s,Ld:()=>l,P7:()=>i});var n=a(105622),o=a(822606),r=o.u1,i=function(e){r=null!=e?e:o.u1},l=function(){return r};function s(){if(r)return(0,n.UD)(r)}},329739:(e,t,a)=>{"use strict";a.d(t,{j:()=>u});var n=a(660606),o=a(423905),r=a(83437),i=a(217425),l=a(801609),s=a(758651),c=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},d=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},u=function(){function e(e){this.params=e}return e.prototype.loadMsalBrowser=function(){return c(this,void 0,void 0,(function(){var e,t,n;return d(this,(function(o){switch(o.label){case 0:e=1,o.label=1;case 1:if(!(e<=3))return[3,6];o.label=2;case 2:return o.trys.push([2,4,,5]),t=this,[4,Promise.all([a.e("vendors~auth-msal-browser","high"),a.e("vendors-npm_store_sdx_officecopilot_azure-msal-common_15_8_0-5ddec09c577d7d05edc7_node_module-52eaa3","high"),a.e("vendors-npm_store_sdx_officecopilot_azure-msal-common_14_16_1-a642071c9e14ebf745be_node_modul-ef38e2","high")]).then(a.bind(a,599807))];case 3:return t.msalModule=o.sent(),this.publicClientApplication=this.createPublicClientApplication(this.msalModule.PublicClientApplication),[2];case 4:if(n=o.sent(),s.error("Attempt ".concat(e," to load @azure/msal-browser failed:"),n),3===e)throw n;return[3,5];case 5:return e++,[3,1];case 6:return[2]}}))}))},e.prototype.getAuthorityAsPerEnv=function(){var e;return!!(null===(e=this.params)||void 0===e?void 0:e.appEnvironment)&&this.params.appEnvironment.length>0&&this.params.appEnvironment===l.D.DOD?i.MA:i.mr},e.prototype.createPublicClientApplication=function(e){return c(this,void 0,void 0,(function(){var t,a,n,o,r;return d(this,(function(l){return t=null!==(r=null===(o=this.params)||void 0===o?void 0:o.clientId)&&void 0!==r?r:i.ky,a=this.params.redirectUri,n=this.getAuthorityAsPerEnv(),[2,new e({auth:{clientId:t,authority:n,redirectUri:new URL(a,window.location.origin).toString(),navigateToLoginRequestUrl:!1},cache:{cacheLocation:"sessionStorage"},system:{iframeHashTimeout:12e3}})]}))}))},e.prototype.getToken=function(e,t,a){return c(this,void 0,void 0,(function(){var t,i,l,s,c,u;return d(this,(function(d){switch(d.label){case 0:return(0,n.cY)("AppChatMsalTokenService.getToken called for resource: "+e),this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:d.sent(),d.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(t=d.sent()))throw new Error("Failed to acquire token - Could not load msal module");(null===(u=this.params)||void 0===u?void 0:u.logTelemetry)&&n.EG.sendChatEventTelemetry((0,o.pN)(((c={})[r.h3.ChatEventType]=r.a5.MSALTokenRequested,c))),i=void 0,d.label=4;case 4:return d.trys.push([4,10,,14]),[4,t.initialize()];case 5:return d.sent(),0!==(null==(l=t.getAllAccounts())?void 0:l.length)?[3,7]:[4,this.ssoSilentNoAccount(e,t)];case 6:return[2,d.sent()];case 7:return[4,this.getSelectedAccount(l,t)];case 8:if(!(i=d.sent()))throw this.logTokenAcquiredError("Failed to acquire token - No account found."),new Error("Failed to acquire token - No account found.");return[4,this.acquireTokenSilent(e,i,t,a)];case 9:return[2,d.sent()];case 10:return s=d.sent(),(0,n.cY)("Failed to get access token: ".concat(null==s?void 0:s.message)),this.msalModule&&s instanceof this.msalModule.InteractionRequiredAuthError?[4,this.acquireTokenPopup(e,i,t)]:[3,12];case 11:return[2,d.sent()];case 12:throw this.logTokenAcquiredError("Failed to acquire token - No token acquired."),s;case 13:return[3,14];case 14:return[2]}}))}))},e.prototype.getAccountInfoFromCache=function(){return c(this,void 0,void 0,(function(){var e,t,a=this;return d(this,(function(n){switch(n.label){case 0:return this.publicClientApplication?[3,2]:[4,this.loadMsalBrowser()];case 1:n.sent(),n.label=2;case 2:return[4,this.publicClientApplication];case 3:if(!(e=n.sent()))throw this.logTokenAcquiredError("Failed to get account info - Could not load msal module"),new Error("Failed to get account info - Could not load msal module");return[4,e.initialize()];case 4:return n.sent(),[2,null!==(t=e.getAllAccounts().find((function(e){var t,n,o;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(o=null===(n=a.params)||void 0===n?void 0:n.userPrincipalName)||void 0===o?void 0:o.toLowerCase())})))&&void 0!==t?t:null]}}))}))},e.prototype.getSelectedAccount=function(e,t){return c(this,void 0,void 0,(function(){var a,n,o,r,i=this;return d(this,(function(l){switch(l.label){case 0:return this.loginPopupPromise?[4,this.loginPopupPromise]:[3,2];case 1:return[2,null==(o=l.sent())?void 0:o.account];case 2:if(!e||0===e.length)return[2,null];if(a=this.params?null!==(r=e.find((function(e){var t,a,n;return(null===(t=e.username)||void 0===t?void 0:t.toLowerCase())===(null===(n=null===(a=i.params)||void 0===a?void 0:a.userPrincipalName)||void 0===n?void 0:n.toLowerCase())})))&&void 0!==r?r:null:e[0],a)return[2,a];n=this.params?{loginHint:this.params.userPrincipalName}:void 0,l.label=3;case 3:return l.trys.push([3,,5,6]),this.loginPopupPromise=t.loginPopup(n),[4,this.loginPopupPromise];case 4:return[2,null==(o=l.sent())?void 0:o.account];case 5:return this.loginPopupPromise=void 0,[7];case 6:return[2]}}))}))},e.prototype.ssoSilentNoAccount=function(e,t){return c(this,void 0,void 0,(function(){var a,n,o;return d(this,(function(r){switch(r.label){case 0:return a={scopes:["".concat(e,"/.default")],loginHint:null===(o=this.params)||void 0===o?void 0:o.userPrincipalName},[4,t.ssoSilent(a)];case 1:return(n=r.sent())||this.logTokenAcquiredError("Failed to acquire token using ssoSilent - No token acquired."),[2,n]}}))}))},e.prototype.acquireTokenSilent=function(e,t,a,n){return c(this,void 0,void 0,(function(){var o,r;return d(this,(function(i){switch(i.label){case 0:return o={scopes:null!=n?n:["".concat(e,"/.default")],account:t},[4,a.acquireTokenSilent(o)];case 1:return(r=i.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenSilent - No token acquired."),[2,r]}}))}))},e.prototype.acquireTokenPopup=function(e,t,a){return c(this,void 0,void 0,(function(){var n,o;return d(this,(function(r){switch(r.label){case 0:return n={scopes:["".concat(e,"/.default")],account:t},[4,a.acquireTokenPopup(n)];case 1:return(o=r.sent())||this.logTokenAcquiredError("Failed to acquire token using acquireTokenPopup - No token acquired."),[2,o]}}))}))},e.prototype.logTokenAcquiredError=function(e){var t,a;(null===(a=this.params)||void 0===a?void 0:a.logTelemetry)&&n.EG.sendErrorTelemetry((0,o.pN)(((t={})[r.IC.ErrorCategory]=r.S2.MSAL,t[r.IC.ErrorMessage]=e,t)))},e}()},340889:(e,t,a)=>{"use strict";a.d(t,{Pp:()=>p,hk:()=>b,YS:()=>L,EM:()=>x,iN:()=>T,NP:()=>v,KI:()=>y,N2:()=>R,Fp:()=>C,qM:()=>A,VF:()=>w,if:()=>S,F:()=>E,eo:()=>I,oG:()=>f});var n=a(267324),o=a(79458),r=a(528804),i=a(14086),l=a(395987),s=a(725556),c=a(278306),d=a(83437),u=a(965634),m=a(956258),h=(a(208520),a(794329));function g(e){const t=document.createElement("div");try{return h.render((0,s.jsx)(c.A,{...e}),t),t.innerText}catch(e){return m.M.getInstance().logError({eventType:u.S2.ChatEvents,errorMessage:`FormulaSuggestionTextForChatHistory: Failed to render header: ${e?.message}`,logLevel:d.$b.Critical}),""}finally{h.unmountComponentAtNode(t)}}function p(e,t){let a="";if(!e)return a;if("TextAnalysisVisual"===e.visual.visualType)return f(e.title,e.visual);if((0,r.ZAR)()){const e=(0,n.PDm)();e.includes("{range}")&&e.includes("{sheet}")?a=e.replace("{range}",(0,i.r)(t)).replace("{sheet}",(0,i.w)(t)):((0,o.cY)("Template placeholders for range or sheet are missing in ANALYZE_DATA_CONTEXT_HEADER_WITH_SHEET"),a=e)}else a=(0,n.I5y)().replace("{0}",(0,i.r)(t));return e.title?.runs&&(e.title.runs.forEach((e=>{e?.text&&(a+=e.text)})),a+="\n"),a+=(0,l.g)(e,!1)+"\n",a}function b(e){return e.body?.length>0?e.body.map((e=>e.text?e.text:"Carousel"===e.type?e.pages?.flatMap((e=>e.items?.map((e=>e.text??""))??[])).filter((e=>""!==e.trim())).join(" "):"")).filter((e=>""!==e.trim())).join(" "):""}function f(e,t){let a="";return e?.runs&&(e.runs.forEach((e=>{e?.text&&(a+=e.text)})),a+="\n"),t.textAnalysisResult.generalResponse&&(a+=t.textAnalysisResult.generalResponse,a+="\n"),t.textAnalysisResult.bulletList&&t.textAnalysisResult.bulletList.forEach((e=>{a+=`${e.title}: ${e.description}\n`})),a}function C(e,t,a,n,r,i){return t?function(e,t,a,n,r,i){return t?((0,o.cY)("FormulaSuggestionTextForChatHistory",{isMainRecommendation:e,model:t,targetAddress:a,columnLetters:r,rowNumber:i}),[g({isMainRecommendation:e,recommendation:t,targetAddress:a,targetSheet:n,columnLetters:r,rowNumber:i}),...t.calculatedFormulas.flatMap((e=>Array.from(function*(e){const{title:t,formula:a,description:n,formulaExplanation:o}=e;t&&(yield t),n&&(yield n),yield a,o&&(yield o)}(e))))].join("\n")):((0,o.cY)("FormulaSuggestionTextForChatHistory: No model passed"),"")}(e,t,a,n,r,i):((0,o.cY)("FormulaSuggestionTextForChatHistory: No model passed"),"")}function y(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.listItems)for(const a of e.listItems)a.title&&(t+=a.title+"\n"),a.text&&(t+=a.text+"\n");return e?.footer&&(t+=e?.footer),t}function v(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.events)for(const a of e.events)t+=a+"\n";return t}function x(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.eventIntents)for(const a of e.eventIntents)t+=a+"\n";if(e?.cfHitlItems)for(const a of e.cfHitlItems){if(t+=a.title+a.explanation+"\n",a.subExplanations)for(const e of a.subExplanations)t+=e+"\n";(0,r.ID5)()&&(0,r.yw9)("OfficeVSO_9197813_AddCFFormulaToChatHistory")&&a.conditionalFormatResponseCardData.customFormula&&(t+=a.conditionalFormatResponseCardData.customFormula+"\n")}return t}function T(e){let t="";if(e?.header&&(t+=e.header+"\n"),e?.suggestions)for(const a of e.suggestions)t+=a.Description+"\n",t+=a.Key+"\n";return t}function S(e,t){let a=`Code: ${e}`;return t&&(a+=`\nCode Explanation: ${t}`),a}function w(e){return e.filter((e=>e.value.text||e.value.code||e.value.finalText)).map((e=>{switch(e.type){case"text":return e.value.text;case"code":return S(e.value.code,e.value.codeExplanation);case"finalText":return e.value.finalText;default:return}})).filter((e=>void 0!==e)).join("\n")}function E(){return`${(0,n.XXH)()}\n${(0,n.zqN)()}\n${(0,n.lQ6)()}\n${(0,n.WQT)()}\n${(0,n.LMV)()}`}function I(){return`${(0,n.Y9M)()}\n${(0,n.O8z)()}\n${(0,n.vK1)()}\n${(0,n.m$v)()}\n${(0,n.AS_)()}`}function R(){return`${(0,n.i3R)()}\n${(0,n.pF5)()}`}function A(){return`${(0,n.BZb)()}\n${(0,n.h8D)()}`}function L(e){return`data:${function(e){switch(e.charAt(0)){case"/":return"image/jpeg";case"i":return"image/png";default:return"image"}}(e)};base64,${e}`}},343230:(e,t,a)=>{"use strict";a.d(t,{U:()=>s,_:()=>c});var n=a(632512),o=a(83437),r=a(9847),i=a(965634),l=a(956258);function s(e,t,a){return l.M.getInstance().runTimedAsyncFunction("GetIsCellsEmptyInTotalRow",(()=>async function(e,t,a){try{const{sheetName:a}=t;if(!a)throw new Error("getIsCellsEmpty: sheetName is undefined");return await async function(e,t,a){return Excel.run((async n=>{const{rowCount:o,rowIndex:r,columnIndex:i,columnCount:l}=e,{range:s,columnOffset:c}=function(e,t,a,n,o,r,i){const l=i.workbook.worksheets.getItem(o);if(1===r.length)return{range:l.getRangeByIndexes(a+e,n+r[0],1,1),columnOffset:r[0]};if(r.every(((e,t,a)=>0===t||e===a[t-1]+1)))return{range:l.getRangeByIndexes(a+e,n+r[0],1,r.length),columnOffset:r[0]};return{range:l.getRangeByIndexes(a+e,n,1,t),columnOffset:0}}(o,l,r,i,t,[...new Set(a.flat())].sort(((e,t)=>e-t)),n);return s.load("valueTypes"),await n.sync(),a.map((e=>e.map((e=>s.valueTypes[0][e-c]===Excel.RangeValueType.empty)).every((e=>e))))}))}(t,a,e)}catch(e){return void l.M.getInstance().logErrorCode(n.O.CalculatedCellsGetIsTotalRowCellsEmptyFailed,e,i.S2.FormulaGeneration,o.$b.Warning,{key:r.un.SuggestionID,value:a})}}(e,t,a)),a)}async function c(e,t){return 0===t.length?[]:Excel.run((async a=>{const n=a.workbook.worksheets.getItem(e),o=t.map((e=>n.getRange(e)));return o.forEach((e=>e.load("valueTypes"))),await a.sync(),o.map((e=>e.valueTypes[0][0]===Excel.RangeValueType.empty))}))}},345603:(e,t,a)=>{"use strict";a.d(t,{TC:()=>l,Md:()=>m,Cg:()=>h,BY:()=>u,CS:()=>d,k_:()=>c,Ay:()=>s});var n=a(65798),o=a(208520);const r=({children:e})=>o.createElement(o.Fragment,null,e),i=(0,n.m)(void 0,"SharedCopilotContext"),l=i.Provider;function s(){const e=o.useContext(i);if(!e)throw new Error("useSharedCopilotContext must be used within a SharedCopilotProvider");return e}function c(){return o.useContext(i)}function d(){var e;return null===(e=c())||void 0===e?void 0:e.serviceProvider.markdown}function u(){var e;return null===(e=d())||void 0===e?void 0:e.links}function m(){var e,t;return(null===(t=null===(e=c())||void 0===e?void 0:e.serviceProvider.react)||void 0===t?void 0:t.ErrorBoundary)||r}function h(){var e;return null===(e=c())||void 0===e?void 0:e.serviceProvider.hostAppSource}},348065:(e,t,a)=>{"use strict";a.d(t,{F_:()=>o,KA:()=>l,YQ:()=>r});var n=a(988013);const o=(0,a(644476).Nc)();function r(e){return(...t)=>(a,n)=>e(a,n,...t)}let i;function l(){return i||(i=(0,n.U)()),i}},351779:(e,t,a)=>{"use strict";function n(e,t){const a=[];return e.forEach((e=>{for(let n=e.top;n<=e.bottom;n++)for(let o=e.left;o<=e.right;o++)a.push(t(n,o))})),a}function o(e,t){return e.map((({row:e,column:a})=>t(e,a)))}a.d(t,{O:()=>o,w:()=>n})},352628:(e,t,a)=>{"use strict";a.d(t,{$9:()=>d,$n:()=>c,GN:()=>s,LJ:()=>l,b_:()=>r,h7:()=>n,k$:()=>o,zi:()=>i});var n=["de-DE","en-GB","en-US","es-ES","es-MX","fr-CA","fr-FR","it-IT","ja-JP","pt-BR","zh-CN"],o=["cs-CZ","da-DK","fi-FI","hu-HU","ko-KR","nl-NL","nb-NO","pl-PL","pt-PT","ru-RU","sv-SE","th-TH","tr-TR","uk-UA","zh-TW"],r=["ar-SA","he-IL"],i=["ca-ES","cy-GB"],l=["bg-BG","el-GR","et-EE","hr-HR","id-ID","lt-LT","lv-LV","ro-RO","sk-SK","sl-SI","sr-Latn-RS","vi-VN"],s=["sq-AL","fil-PH","is-IS","kk-KZ","ms-MY","mt-MT","sr-Cyrl-RS"],c=["ar-SA","fa-IR","he-IL","ug-CN","ur-PK"],d=["af-ZA","am-ET","ar-SA","as-IN","az-Latn-AZ","bg-BG","bn-IN","bs-Latn-BA","ca-ES","ca-Es-VALENCIA","cs-CZ","cy-GB","da-DK","de-DE","el-GR","en-GB","en-US","es-ES","es-MX","et-EE","eu-ES","fa-IR","fi-FI","fil-PH","fr-CA","fr-FR","ga-IE","gd-gb","gl-ES","gu-IN","he-IL","hi-IN","hr-HR","hu-HU","hy-AM","id-ID","is-IS","it-IT","ja-JP","ka-GE","kk-KZ","km-KH","kn-IN","ko-KR","kok-IN","lb-LU","lo-LA","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-MY","mt-MT","nb-NO","ne-NP","nl-NL","nn-NO","or-IN","pa-IN","pl-PL","pt-BR","pt-PT","quz-PE","ro-RO","ru-RU","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-RS","sr-Latn-RS","sv-SE","ta-IN","te-IN","th-TH","tr-TR","tt-RU","ug-CN","uk-UA","ur-PK","uz-Latn-UZ","vi-VN","zh-CN","zh-TW"]},353033:(e,t,a)=>{"use strict";a.d(t,{U:()=>o,p:()=>r});class n{constructor(e,t){this.finished=!1,this.reject=e=>{this.finished||(this.rejectFn(e),this.finished=!0)},this.resolve=e=>{this.finished||(this.resolveFn(e),this.finished=!0)},this.resolveFn=e,this.rejectFn=t}}class o{constructor(e){this.getPromise=()=>this.outerPromise,this.getOriginalPromise=()=>this.originalPromise,this.reject=e=>{this.pHolder&&this.pHolder.reject(e)},this.resolve=e=>{this.pHolder&&this.pHolder.resolve(e)},this.outerPromise=new Promise(((e,t)=>{this.pHolder=new n(e,t)})),this.originalPromise=e(),this.originalPromise.then((e=>{this.pHolder&&this.pHolder.resolve(e)})).catch((e=>{this.pHolder&&this.pHolder.reject(e)}))}}function r(){let e=null,t=null;return{promise:new Promise(((a,n)=>{e=a,t=n})),resolve:e,reject:t}}},357392:(e,t,a)=>{"use strict";a.d(t,{g:()=>c,z:()=>s});var n=a(449650),o=a(83437),r=a(965634),i=a(956258),l=a(528804);function s(){return(0,l.iPS)("Microsoft.Office.Excel.FA000000124.IsContextFoilEnabled",!1)||(0,l.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.IsContextFoilEnabled",!1)}class c{static getInstance(){return c.instance||(c.instance=new c),c.instance}async showGridFoil(e){this.sheetName&&(await this.removeGridFoil(),window.clearTimeout(this.timeout));const t=n.ExcelCalc.sheetNameFromSheetAddresses(e),a=n.ExcelCalc.localAddressesFromSheetAddresses(e);try{await Excel.run((async e=>{const n=e.workbook.worksheets.getItem(t),o=n.getRange(a);n.gridFoils.add(o,this.getCopilotFoilOptions()),await e.sync(),this.sheetName=t}))}catch{i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"GridFoil failed to show",logLevel:o.$b.Warning})}}async removeGridFoil(){if(!this.sheetName)return;const e=this.sheetName;try{await Excel.run((async t=>{t.workbook.worksheets.getItem(e).gridFoils.removeAll(),await t.sync(),this.sheetName=void 0}))}catch{i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"GridFoil failed to remove",logLevel:o.$b.Warning})}}async showGridFoils(e){this.sheetName&&(await this.removeGridFoil(),window.clearTimeout(this.timeout));try{await Excel.run((async t=>{const a=n.ExcelCalc.sheetNameFromSheetAddresses(e[0]),o=t.workbook.worksheets.getItem(a);e.forEach((e=>{const t=n.ExcelCalc.localAddressesFromSheetAddresses(e),a=o.getRange(t);o.gridFoils.add(a,this.getCopilotFoilOptions())})),await t.sync(),this.sheetName=a}))}catch(e){i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"GridFoil failed to show",logLevel:o.$b.Warning})}}static async removeGridFoilWithSheetName(e){if(e)try{await Excel.run((async t=>{t.workbook.worksheets.getItem(e).gridFoils.removeAll(),await t.sync()}))}catch{i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"GridFoil failed to remove",logLevel:o.$b.Warning})}}async highlightWithDuration(e,t){const a=n.ExcelCalc.sheetNameFromSheetAddresses(e[0]);await c.getInstance().showGridFoils(e),this.timeout=window.setTimeout((async()=>{await c.removeGridFoilWithSheetName(a)}),t)}getCopilotFoilOptions(){return{borderColor:"copilotBorder",tintColor:"copilotTint",gradientColor:"copilotGradient"}}}},357781:(e,t,a)=>{"use strict";a.d(t,{CU:()=>g,Ej:()=>C,GC:()=>f,LM:()=>s,PX:()=>d,_c:()=>b,c3:()=>l,ch:()=>h,fB:()=>u,g8:()=>c,gD:()=>m,s6:()=>p});var n=a(626128),o=a(707314),r=a(528804),i=a(471742);function l(e){let t="",a=e;for(;a>0;){const e=a%26;0===e?(t+="Z",a=Math.floor(a/26)-1):(t=String.fromCharCode(e-1+"A".charCodeAt(0))+t,a=Math.floor(a/26))}return t}function s(e,t){return`${l(t)}${e}`}const c=(e,t)=>{if(!m(e,t))return!1;if((0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)&&y(e?.visual))return!1;if("TextAnalysisVisual"===e?.visual?.visualType){if(!(0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",!1))return!1;if((0,r.iPS)("Microsoft.Office.Excel.FA000000124.EnableHideAddToSheetButton",!1)&&e?.visual?.textAnalysisResult?.analysisType===o.uK.Summary&&e?.visual?.textAnalysisResult?.resultType===o.rb.QuickSummary)return!1;const t=e?.visual?.textAnalysisResult?.bulletList?.some((e=>e.reference.length>0));if(!t)return!1}return!0},d=(e,t)=>{const a=e.map((e=>e.visualAnswer[0])).filter((e=>!!e&&c(e,t)));return a.some((e=>"TextAnalysisVisual"===e.visual?.visualType))&&a.length>=2?a:[]},u=e=>"TextAnalysisVisual"!==e?.visual?.visualType||!e?.visual?.textAnalysisResult?.bulletList,m=(e,t)=>t?.find((({id:t})=>t===e.interpretationId)),h=e=>{switch(e.visualType){case"PivotTableVisual":return e.pivotTable.pivotTableData&&0===e.pivotTable.pivotTableData.length;case"QueryResultVisual":return 0===e.result.fields.length||0===e.result.fields[0].values.raw.length;default:return!1}};function g(e){return e.calculatedFormulas.every((e=>e.formula))}function p(e,{columnIndex:t}){return(0,n.JM)(e).map((e=>(0,i.z)(t+e+1)))}function b(e,t){return(0,n.iM)(e)?f(e,t):(0,n.cY)(e)?p(e,t):[]}function f(e,{columnCount:t,columnIndex:a}){return e.calculatedFormulas.map(((e,n)=>{const o=(e.insertionIndex??t)+1+n;return(0,i.z)(a+o)}))}function C(e,t,a,n){return`${(0,i.z)(t+1)}${e+1}:${(0,i.z)(t+n)}${e+a}`}const y=e=>"QueryResultVisual"===e?.visualType&&!0===e?.isStagingTable},361292:(e,t,a)=>{"use strict";a.d(t,{W:()=>l});var n=a(83437),o=a(840574),r=a(516999),i=a(375485);class l{async getPrimaryIdentityEmail(){const e=new i.A("GetPrimaryIdentityEmail");try{const t=await this.authHost.providers.getCurrent().getPrimaryIdentityEmail();return e.succeed({}),t}catch(t){throw e.fail(n.$b.Warning,{},t),new Error}}async authorize(e,t,a){let r;for(;this.authHost.providers.hasMore();){const l=this.authHost.providers.getCurrent().getName(),s=new i.A("Authorize");s.sendStart({scope:JSON.stringify(e),parentCallId:t});try{const a=await this.getAccessTokenSilent(e,t);return s.succeed({parentCallId:t,usedPopup:!1,usedLastAttempt:!1,provider:l}),a}catch(e){r=r||e}if("WebOAuthApiProvider"!==l){if(!(0,o.f)())try{const a=await this.getAccessTokenInternal(e,!0,t);return s.succeed({parentCallId:t,usedPopup:!0,usedLastAttempt:!1,provider:l}),a}catch(e){}try{if(a){const n=await a(e,t);return s.succeed({parentCallId:t,usedPopup:!0,usedLastAttempt:!0,provider:l}),n}}catch(e){}}s.fail(n.$b.Warning,{parentCallId:t,usedPopup:!0,usedLastAttempt:!!a,provider:l},r),this.authHost.providers.removeCurrent()}throw new Error("Authorization Error")}async getAccessTokenSilent(e,t){return this.getAccessTokenInternal(e,!1,t)}async getAccessTokenInternal(e,t,a){return await this.authHost.ensureAuthLibraryLoaded(a),(0,r.U)((async()=>this.getAccessTokenFn(e,t,a)),(()=>!0),(()=>!1),1)}async getAccessTokenFn(e,t,a){const o=new i.A("GetAccessToken");try{const n=await this.authHost.providers.getCurrent().getToken(e,t);return o.succeed({parentCallId:a,usePopup:t}),n}catch(e){throw o.fail(n.$b.Warning,{parentCallId:a,usePopup:t},e),e}}constructor(e){this.authHost=e}}},365319:(e,t,a)=>{"use strict";a.d(t,{$:()=>w});var n=a(932367),o=a(754440),r=a(700853),i=a(63919),l=a(39609),s=a(74704),c=a(644737),d=a(9847),u=a(83437),m=a(476730),h=a(965634),g=a(956258),p=a(173339),b=a(797639),f=a(79458),C=a(528804),y=a(119202),v=a(911126),x=a(495501);const T=g.M.getInstance(),S=m.E.getInstance();class w{static getInstance(){return w.instance||(w.instance=new w),w.instance}setCopilotRef(e){this.copilotChatRef=e}getCopilotRef(){return this.copilotChatRef}getChatLog(){return this.chatLog}getChatHistory(){return this.chatLog.map((e=>this.convertResponseMessageToOCVChatHistoryMessage(e)))}setLastUserUtterance(e){this.lastUserUtterance=e,this.chatLog.push({chatCardType:r._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:e}}}})}setLastUserImage(e){e.length>0?this.lastUserImage=e[e.length-1]:this.lastUserImage=""}setIsSkillResponseRequired(e){this.isSkillResponseRequired=e}getIsSkillResponseRequired(){return this.isSkillResponseRequired}getLastUserUtterance(){return this.lastUserUtterance}getLastUserImage(){return this.lastUserImage}getHasMessageBeenShown(e,t=!1){return!!(this.displayedMessageIds.includes(e)||t&&e&&this.copilotChatRef?.current?.hasMessage(e))}getInputText(){return this.copilotChatRef?.current?.getInputText?.()??""}setInputText(e){(0,f.cY)("Setting input text"),this.copilotChatRef?.current?.setInputAreaText(e),this.setInputFocus()}scrollToBottom(){(0,f.cY)("scroll to bottom"),this.copilotChatRef?.current?.scrollToBottom()}shouldScrollToBottom(){return!b.CP.pythonContextManager.isPythonMode||b.CP.pythonContextManager.isAutoScrollingEnabled||!(0,C.LhK)()}addMessageIfNeeded(e,t,a){const n=!this.getHasMessageBeenShown(e);(0,f.cY)("Trying to add messageId: ",e),n&&(this.displayedMessageIds.push(e),this.displayResponse(t,a),(0,f.cY)("Added messageId: ",e))}displayResponse(e,t,a={}){const{shouldShowWhenFluxSkillResponseRequired:n=!0,logAshaError:o=!0}=a;if(t&&(this.submitChatMessageTelemetry(t,o),e.chatMessageBodyData&&(e.chatMessageBodyData.telemetryData=JSON.stringify(t))),!this.getShouldShowMessage(n))return void(0,f.cY)("Skipping response display : ",e);(0,f.cY)("Displaying response : ",e),this.addFeedbackDataToMessage(e),this.chatLog.push(e),a?.replaceExistingMessage?this.copilotChatRef?.current?.updateMessage(e):(this.copilotChatRef?.current?.addResponseMessage(e),(0,C.LhK)()&&b.CP.pythonContextManager.isPythonMode&&(b.CP.pythonContextManager.renderedCardCount+=1)),this.getIsHumanMessage(e)&&(0,c.s_)(c.H0.RemoveAll),this.getIsSkillResponseRequired()&&s.Q.getInstance().recordFluxCopilotStep({operation:d.OP.FluxSkillCardShown});const r=g.M.getInstance().getStandardizedFeatureForSubFeature(t?.featureName);l.Z.getInstance().endUserPerceivedLatency(!0!==e.chatMessageBodyData?.isFailure,r===d.BJ.CopilotChat?void 0:r,"displayResponse: Feature from telemetry.featureName does not match active feature.")}displayErrorResponseIfNeeded(e,t,a={}){return t?.errorType!==d.q0.BadToken&&t?.errorType!==d.q0.LicensingError||0!==this.chatLog.length&&this.getIsHumanMessage(this.chatLog[this.chatLog.length-1])?(this.displayResponse(e,t,a),!0):(T.logError({eventType:h.S2.ChatEvents,errorMessage:`Not showing the error message for ${t.errorType} as the last message is not from the user`,logLevel:u.$b.Warning}),!1)}updateLastMessage(e){(0,f.cY)("Updating response : ",e);const t=this.chatLog[this.chatLog.length-1]?.chatMessageBodyData?.messageId;this.updateChatLogMessage(t,e),this.copilotChatRef?.current?.updateLastMessage(e)}updateMessage(e){(0,f.cY)("Updating response : ",e),this.updateChatLogMessage(e?.chatMessageBodyData?.messageId,e),this.copilotChatRef?.current?.updateMessage(e)}resendChatHistorySignal(e,t){this.copilotChatRef?.current?.resendChatHistorySignal(e,t)}deleteMessage(e){(0,f.cY)("Deleting response : "+e),this.copilotChatRef?.current?.deleteMessage(e)}startReinitializeALSession(){(0,f.cY)("startReinitializeALSession"),this.copilotChatRef?.current?.startReinitializeALSession()}activateAugloopAnnotations(){(0,f.cY)("activate augloop anotations"),this.copilotChatRef?.current?.activateClientALAnnotations()}submitOperation(e){(0,f.cY)("Submitting signal : ",e),this.copilotChatRef?.current?.submitOperation(e)}updateLoadingComponentProps(e){(0,f.cY)("Updating loading component props"),this.copilotChatRef?.current?.updateLoadingComponentProps(e)}getIsHumanMessage(e){const t=e.chatMessageData;return t?.defaultMessageProps?.user===i.Q9.Human||t?.accordionCardProps?.user===i.Q9.Human||t?.chatCardWrapperProps?.user===i.Q9.Human||t?.contentCardProps?.user===i.Q9.Human||t?.copilotWorkflowsCardProps?.user===i.Q9.Human||t?.markDownCardProps?.user===i.Q9.Human||t?.paginatedCardProps?.user===i.Q9.Human||t?.proactiveSuggestionCardProps?.user===i.Q9.Human||t?.reviewAgentCardProps?.user===i.Q9.Human||t?.reviewerSummaryCardProps?.user===i.Q9.Human||t?.selfHelpAdaptiveCardProps?.user===i.Q9.Human||t?.streamingAdaptiveCardProps?.user===i.Q9.Human||t?.warningMessageCardProps?.user===i.Q9.Human}getLastMessage(e){return(0,f.cY)("Getting last message"),this.copilotChatRef?.current?.getLastMessage(e)}startLoadingPaneTimeout(e){(0,f.cY)("PaneBoot - Start loading pane"),this.startLoadingPaneId=window.setTimeout((()=>{(0,f.cY)(`PaneBoot - logging ASHA: ${o.W.Copilot_Chat_Pane_Failed_To_Load}; Hang ${e?"after disabled screen":""}`),g.M.getInstance().logStandardizedAshaErrorEvent(o.W.Copilot_Chat_Pane_Failed_To_Load,e?n.c.Pane_Taking_Too_Long_To_Load_After_Disabled_Screen:n.c.Pane_Taking_Too_Long_To_Load,d.BJ.CopilotChat,!1)}),p.R.getLoadPaneAshaTimeout())}clearLoadingPaneTimeout(){(0,f.cY)("PaneBoot - Stop loading pane"),this.startLoadingPaneId&&clearTimeout(this.startLoadingPaneId)}startLoadingUi(){(0,f.cY)("Start loading ui"),this.startLoadingUiId=window.setTimeout((()=>{this.startLoadingUiId=void 0,this.copilotChatRef?.current?.startLoadingUi()}),0),(0,C.yw9)("OfficeVSO_10215994_LogErrorIfLoadingUIRunningForOver1Min")&&(this.startLoadingUiIdTelemetryId=window.setTimeout((()=>{T.logError({eventType:h.S2.ChatEvents,errorMessage:"CopilotChatUIHelper: Loading UI has been running for over 1 minute.",logLevel:u.$b.Error})}),6e4))}setInputFocus(){(0,f.cY)("Setting input focus"),this.copilotChatRef?.current?.setInputFocus()}stopLoadingUi(){if((0,f.cY)("Stop loading ui"),(0,C.yw9)("OfficeVSO_10215994_LogErrorIfLoadingUIRunningForOver1Min")&&this.startLoadingUiIdTelemetryId&&clearTimeout(this.startLoadingUiIdTelemetryId),this.startLoadingUiId)return void clearTimeout(this.startLoadingUiId);const e=w.getInstance().getLastMessage();(0,C.yw9)("OfficeVSO_8923945_UpdateLastMessage")?w.getInstance().updateMessage({chatCardType:r._.Default,chatMessageBodyData:{messageId:e?.messageId},addCardToChatHistory:!1,stopLoadingUi:!0}):this.updateLastMessage({chatCardType:r._.Default,addCardToChatHistory:!1,stopLoadingUi:!0})}submitUserQuery(e){this.copilotChatRef?.current?.submitUserQuery({text:e})}displayChartStylesResponse(e,t,a){if((0,C.IU1)()){const n={queryId:e,initializeUpdateCallbackLogic:(e,t)=>{this.onChartNewRecommendationAvailable=e,this.onChartRecommendationPreprocessing=t},isTriggeredViaOOUI:t,onAllRecommendationsAdded:a},{message:o,telemetry:r}=x.n.getChartDesignRecommendationsResponseMessage(e,n);w.getInstance().displayResponse(o,r)}}getShouldShowMessage(e){return!this.isSkillResponseRequired||!!e}handleEndOfQuery(e){(0,C.yw9)("OfficeVSO_10021705_SendTelemetryForMultipleCardsOnError")&&this.validateExpectedResponseContentAndStructure(e)}validateExpectedResponseContentAndStructure(e){if(""===e)return;void 0===e&&(e=this.getRequestIdFromMessage(this.chatLog[this.chatLog.length-1]));const t=[];for(let a=this.chatLog.length-1;a>=0;a--){const n=this.chatLog[a],o=this.getRequestIdFromMessage(n);if(!o)continue;if(!("Copilot\\Else"===n.chatMessageBodyData?.feedbackData?.feedbackArea)||o!==e)if(o!==e){if(o!==e)break}else t.push(n)}let a=!1;if(a=t.length>1&&t.some((e=>!0===e.chatMessageBodyData?.isFailure)),a){const e=[{key:"numberOfMessages",value:t.length}];T.logError({eventType:h.S2.ChatEvents,errorMessage:"Unexpected response structure - multiple responses including one or more errors",logLevel:u.$b.Error},void 0,e)}}getRequestIdFromMessage(e){const t=e.chatMessageBodyData?.feedbackData?.contextData?.cardMetaData;let a="";try{a=JSON.parse(t??"{}")?.promptId}catch(e){return}return a}addFeedbackDataToMessage(e){e.chatMessageBodyData={...e.chatMessageBodyData??{},feedbackData:{contextData:{cardMetaData:JSON.stringify({prompt:this.lastUserUtterance,promptId:g.M.userQueryGuid,...(0,C.yw9)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")?JSON.parse(e.chatMessageBodyData?.feedbackData?.contextData?.cardMetaData??"{}")??{}:{}}),feedbackClientAppName:(0,y.f2)()},feedbackArea:e.chatMessageBodyData?.feedbackData?.feedbackArea??"Copilot"}}}isChatMessageError(e){return(e.eventType===d.a5.ErrorMessage||e.eventType===d.a5.HandoffMessageIdResponseError)&&!(0,v.$o)(e.errorType)}convertResponseMessageToOCVChatHistoryMessage(e){if(e.chatMessageBodyData?.telemetryData){const t=JSON.parse(e.chatMessageBodyData.telemetryData);if(t.errorType)return{user:i.Q9.Chat,message:e.chatMessageData?.defaultMessageProps?.messageHeader?.text,errorType:t.errorType}}let t="";switch(e.chatCardType){case r._.Default:t=e.chatMessageData?.defaultMessageProps?.messageHeader?.text;break;case r._.MarkdownCard:t=e.chatMessageData?.markDownCardProps?.message;break;case r._.ChatCardWrapper:t=e.chatMessageData?.chatCardWrapperProps?.textContent;break;case r._.SelfHelpAdaptiveCard:t="A SelfHelpAdaptiveCard was shown with the following props: "+JSON.stringify(e.chatMessageData?.selfHelpAdaptiveCardProps);break;case r._.StreamingAdaptiveCard:t="A StreamingAdaptiveCard was shown with the following props: "+JSON.stringify(e.chatMessageData?.streamingAdaptiveCardProps);break;case r._.WarningMessage:t="A WarningMessage was shown with the following props: "+JSON.stringify(e.chatMessageData?.warningMessageCardProps);break;default:t=JSON.stringify(e.chatMessageData)}return(0,C.eFk)()?{user:this.getIsHumanMessage(e)?i.Q9.Human:i.Q9.Chat,message:t,metadata:e.chatMessageBodyData?.aiResponseMetadata}:{user:this.getIsHumanMessage(e)?i.Q9.Human:i.Q9.Chat,message:t}}updateChatLogMessage(e,t){if(!e)return;const a=this.chatLog.find((t=>t?.chatMessageBodyData?.messageId===e));if(a?.chatCardType!==r._.MarkdownCard)return;const n=a?.chatMessageData?.markDownCardProps,o=t?.chatMessageData?.markDownCardProps;n&&o&&(n.message=o.message)}constructor(){this.chatLog=[],this.lastUserUtterance="",this.lastUserImage="",this.displayedMessageIds=[],this.isSkillResponseRequired=!1,this.doesLastResponseHaveTable=!1,this.onChartNewRecommendationAvailable=()=>{},this.onChartRecommendationPreprocessing=()=>{},this.submitChatMessageTelemetry=(e,t)=>{if((0,f.cY)("submitChatMessageTelemetry",e),e){if(S.updateTelemetryChatEventData({[d.h3.ChatEventType]:e.eventType,...(0,d.j)(b.CP),[d.h3.ChatEventParameters]:JSON.stringify({featureName:e.featureName,errorType:e.errorType,errorDetails:e.errorDetails})},T),this.isChatMessageError(e)&&t){const t=g.M.getInstance().getStandardizedFeatureForSubFeature(e?.featureName);g.M.getInstance().logStandardizedAshaErrorEvent(o.W.Unclassified_Chat_Failure,n.c.Chat_Error_Message_Shown,t)}}else(0,f.cY)("[ERROR] Failed to emit chat log telemetry!!!")}}}},369169:(e,t,a)=>{"use strict";a.d(t,{Fw:()=>S,Ne:()=>y,UN:()=>C,YE:()=>v,c5:()=>f,cQ:()=>b,gE:()=>w,k8:()=>p,kJ:()=>x,py:()=>T});var n=a(632512),o=a(373753),r=a(83437),i=a(965634),l=a(956258),s=a(880496),c=a(626128),d=a(528804),u=a(471742),m=a(343230),h=a(357781),g=a(820633);function p(e){return Boolean(e?.tableName&&e.sheetName&&e.address&&e.sheetId)}function b(e,t){const{dataAI:{tableName:a},selection:n}=t,o=a[e];return o?n.selectionContexts[o]:void 0}function f(e,t,a){if(!function(){if((0,d.yw9)("OfficeVSO_9625689_allowMacPreviewByClientVersion"))return(0,g.w0)(["Mac:89.823"],!0);return!(0,d.Te4)("Microsoft.Office.Excel.FA000000124.disableGridPreview",["Mac"]).includes(Office.PlatformType[Office.context.platform])}())return!1;if(!(0,h.CU)(t))return!1;if((0,c.be)(t)&&(1!==t.calculatedFormulas.length||!t.calculatedFormulas[0].insertionMode||[o.PH.ShiftDown,o.PH.ShiftRight].includes(t.calculatedFormulas[0].insertionMode)))return!1;if((0,c.iM)(t)&&C(t)){if(!(0,d.yw9)("OfficeVSO_9658083_enableInsertOverride"))return!1;if(!function(e){if(!C(e))return l.M.getInstance().logErrorCode(n.O.CalculatedColumnPreviewColumnInTheMiddleExpected,new Error("shouldShowGridPreviewForColumnInTheMiddle: don't have column in the middle"),i.S2.FormulaGeneration,r.$b.Warning),!0;const t=e.calculatedFormulas.every((e=>e.insertionMode===o.PH.ToTableWithOverride));if(!t)return!1;let{calculatedFormulas:a}=e;a=[...a],a.sort(((e,t)=>(e.insertionIndex??Number.MAX_SAFE_INTEGER)-(t.insertionIndex??Number.MAX_SAFE_INTEGER)));return a.every(((e,t,a)=>0===t||e.insertionIndex===(a[t-1].insertionIndex??Number.MAX_SAFE_INTEGER)+1))}(t))return!1}const s=b(e,a);if(!s||!p(s))return!1;return!!a.dataAI.tableName[e]&&!!a.selection.selectionContexts}function C(e){return e.calculatedFormulas.some((e=>void 0!==e.insertionIndex))}function y(e){if(0===e.length)return[];const t=[];let a=[];return e.forEach(((n,o)=>{0===o||n-e[o-1]===1?a.push(n):(t.push(a),a=[n])})),t.push(a),t}function v(e,t){let a=(0,c.JM)(e);e.insertRowTitle&&(a=[0,...a]);const n=a.map((e=>t.map((t=>t[e]??""))));return(0,s.mg)(n)}function x(e){return!(0,c.cY)(e)||!(0,s.th)(e)&&!(0,s.By)(e)}function T(e,t){const{columnIndex:a,rowIndex:n,columnCount:r,address:i}=t;if(!i)return;if(e.calculatedFormulas.every((e=>e.insertionMode===o.PH.ToTableWithOverride))){let{calculatedFormulas:t}=e;return t=[...t],t.sort(((e,t)=>(e.insertionIndex??Number.MAX_SAFE_INTEGER)-(t.insertionIndex??Number.MAX_SAFE_INTEGER))),(0,s.Tq)(a+1,n+1,r,t[0].insertionIndex??r)}return(0,s.cc)(i)??i}async function S(e,t,a){if((0,s.By)(e))return e.calculatedFormulas[0].fixedInsertionRange;if((0,s.th)(e))return await(0,s.a$)();const{address:n}=t;if(!n||void 0===a)return;return(0,s.K3)(n,a)??n}async function w(e,t){if(1!==e.calculatedFormulas.length)throw new Error("prepSingleFormulaPreviewValues expects exactly one calculatedFormula");const a=e.calculatedFormulas[0],{previewValues:o,fixedInsertionRange:c,titleTargetRange:d}=a;if(!o||!c)return{previewValues:[],anchorCellAddress:void 0};try{const e=(0,u.AW)((0,s.gx)(c)||c),h=e.top,g=e.left,p=o.length,b=p>0?o[0].length:0;if(0===p||0===b)return{previewValues:[],anchorCellAddress:void 0};let f,C=-1,y=-1;if(d?.address&&a.title)try{f=(0,u.AW)((0,s.gx)(d.address)||d.address),C=f.top,y=f.left}catch(e){f=void 0}let v=h,x=h+p-1,T=g,S=g+b-1;f&&(v=Math.min(v,C),x=Math.max(x,C),T=Math.min(T,y),S=Math.max(S,y));const w=x-v+1,E=S-T+1,I=Array(w).fill(null).map((()=>Array(E).fill("")));for(let e=0;e<p;e++)for(let t=0;t<b;t++){const a=h+e-v,n=g+t-T;if(a>=0&&a<w&&n>=0&&n<E){const r=o[e][t];I[a][n]=r}}if(f&&a.title){const e=C-v,t=y-T;e>=0&&e<w&&t>=0&&t<E&&(I[e][t]=a.title)}const R=await async function(e,t,a,o,s,c,d,h,g,p){if(!p)return!0;const b=[],f=(e,t,n,r)=>{if(!(e>n||t>r))for(let i=e;i<=n;i++)for(let e=t;e<=r;e++){const t=`${(0,u.z)(o+e)}${a+i}`;b.push(t)}},C=s-a,y=c-o,v=s+d-1-a,x=c+h-1-o,T=g?g.top-a:-1,S=g?g.left-o:-1,w=e=>{e.top<=e.bottom&&e.left<=e.right&&f(e.top,e.left,e.bottom,e.right)},E=(e,t,a)=>{if(t<e.top||t>e.bottom||a<e.left||a>e.right)return[e];const n=[];return n.push({top:e.top,left:e.left,bottom:t-1,right:e.right}),n.push({top:t+1,left:e.left,bottom:e.bottom,right:e.right}),n.push({top:t,left:e.left,bottom:t,right:a-1}),n.push({top:t,left:a+1,bottom:t,right:e.right}),n},I=((e,t,a)=>{const n=[];return a.top>0&&n.push({top:0,left:0,bottom:a.top-1,right:t-1}),a.bottom<e-1&&n.push({top:a.bottom+1,left:0,bottom:e-1,right:t-1}),a.left>0&&n.push({top:a.top,left:0,bottom:a.bottom,right:a.left-1}),a.right<t-1&&n.push({top:a.top,left:a.right+1,bottom:a.bottom,right:t-1}),n})(e,t,{top:C,left:y,bottom:v,right:x});for(const e of I)g?E(e,T,S).forEach(w):w(e);if(b.length>0)try{return!(await(0,m._)(p,b)).some((e=>!e))}catch(e){return l.M.getInstance().logErrorCode(n.O.CalculatedCellsGetIsTotalRowCellsEmptyFailed,e,i.S2.FormulaGeneration,r.$b.Warning),!0}return!0}(w,E,v,T,h,g,p,b,f,t?.sheetName);if(!R)return{previewValues:[],anchorCellAddress:void 0};return{previewValues:I,anchorCellAddress:`${(0,u.z)(T)}${v}`}}catch(e){try{const e=(0,u.AW)((0,s.gx)(c)||c);return{previewValues:o,anchorCellAddress:`${(0,u.z)(e.left)}${e.top}`}}catch(e){return{previewValues:[],anchorCellAddress:void 0}}}}},371616:(e,t,a)=>{"use strict";a.d(t,{So:()=>m,Ul:()=>g,tV:()=>h});var n=a(632512),o=a(83437),r=a(503079),i=a(965634),l=a(956258),s=a(79458),c=a(185610);const d={isLoaded:!1,isFeedbackEnabled:!0,feedbackInitializationData:""};async function u(){d.isLoaded||(d.isFeedbackEnabled=await async function(){let e=!1;try{e=await OfficeFirstParty.UserFeedback.CheckFeedbackEligibility("CanShowSingleClickCopilotFeedbackButton"),(0,s.cY)("OfficeFirstParty CheckFeedbackEligibility : "+e)}catch(t){l.M.getInstance().logErrorCode(n.O.FeedbackApiError,t,i.S2.Error,o.$b.Warning),(0,s.cY)("Error in UserFeedback CheckFeedbackEligibility : ",t),e=await async function(){let e=!1;try{e=await OfficeFirstParty.UserFeedback.CanCollectCopilotFeedback(),(0,s.cY)("OfficeFirstParty CanCollectCopilotFeedback : "+e)}catch(t){try{l.M.getInstance().logErrorCode(n.O.FeedbackApiError,t,i.S2.Error,o.$b.Warning),(0,s.cY)("Error in UserFeedback CanCollectCopilotFeedback : ",t),e=await OfficeFirstParty.UserFeedback.CanCollectUserFeedback(),(0,s.cY)("OfficeFirstParty CanCollectUserFeedback : ",e)}catch(e){l.M.getInstance().logErrorCode(n.O.FeedbackApiError,e,i.S2.Error,o.$b.Warning),(0,s.cY)("Error in UserFeedback CanCollectUserFeedback : ",e)}}return e}()}return e}(),d.isLoaded=!0)}const m=new r.d((async()=>{await u(),d.feedbackInitializationData=await(0,c.y)()}));const h=()=>d.isFeedbackEnabled,g=()=>d.feedbackInitializationData},371623:(e,t,a)=>{"use strict";a.d(t,{$c:()=>x,XX:()=>g,g4:()=>y,jc:()=>m,xP:()=>h,zH:()=>p});var n,o=a(267324),r=a(83437),i=a(255448),l=a(965634),s=a(956258),c=a(412504),d=a(528804),u=a(993384);!function(e){e.Number="Number",e.String="String",e.Any="Any"}(n||(n={}));const m=3,h=2,g=()=>{const e=!(0,d.H_5)();return[{suggestionText:(0,o.Dvy)(e),suggestionType:"AnalyzeData_Suggestion",alwaysInList:!0},{suggestionText:(0,o.qjK)(e),suggestionType:"CalculatedColumns_GeneralSuggestion",alwaysInList:!0},{suggestionText:(0,o.I77)(e),suggestionType:"ConditionalFormat_Suggestion",alwaysInList:!0}]},p=()=>[{suggestionText:(0,o.jmZ)(),suggestionType:"AnalyzeData_SpecificSuggestion"},{suggestionText:(0,o.lkD)(),suggestionType:"CalculatedColumns_SpecificSuggestion",numColsRequired:2,requiredColsType:"Number"},{suggestionText:(0,o.gZd)(),suggestionType:"Commanding_Suggestion"},{suggestionText:(0,o.gax)(),suggestionType:"AnalyzeData_SpecificSuggestion",numColsRequired:1,requiredColsType:"String"},{suggestionText:(0,o.hzZ)(),suggestionType:"CalculatedColumns_SpecificSuggestion",numColsRequired:2,requiredColsType:"String"},{suggestionText:(0,o.dYE)(),suggestionType:"Commanding_Suggestion",numColsRequired:1,requiredColsType:"Number"},{suggestionText:(0,o.EZu)(),suggestionType:"Commanding_Suggestion",numColsRequired:1,requiredColsType:"Any"},{suggestionText:(0,o.JEr)(),suggestionType:"Commanding_Suggestion",numColsRequired:1,requiredColsType:"Number"},{suggestionText:(0,o.PFs)(),suggestionType:"Commanding_Suggestion",numColsRequired:1,requiredColsType:"Number"},{suggestionText:(0,o.IyO)(),suggestionType:"AnalyzeData_ShowCharts",alwaysInList:!0},{suggestionText:(0,o.wYv)(),suggestionType:"AnalyzeData_ShowPivotTables",alwaysInList:!0}],b=(e,t)=>{let a=e;return t.forEach(((e,t)=>{a=a.replace(`{${t}}`,e.header),a=a.replace(`{DataFromColCell-${t}}`,e.firstCell.toString())})),a},f=e=>Math.floor(Math.random()*e),C=(e,t)=>{const a=[],n={Number:f(e.Number.length),String:f(e.String.length),Any:f(e.Any.length)};return t.forEach((t=>{const o=t.requiredColsType??"Any",r=e[o],i=t.numColsRequired??0;if(r.length<i)return;const l=((e,t,a)=>{const n=[],o=(0,d.yw9)("OfficeVSO_9675416_FixPromptSuggestionsCrash");if(o&&!e.length)return n;let r=o?t%e.length:t;for(let t=0;t<a;t++)(o?e[r]?.header?.trim().length:e[r].header.trim().length)&&(n.push(e[r]),r=(r+1)%e.length);return n})(r,n[o],i);l.length<i||(n[o]=(n[o]+l.length)%r.length,a.push({suggestionText:b(t.suggestionText,l),suggestionType:t.suggestionType,suggestionLanguage:t.suggestionLanguage}))})),a},y=(e,t,a=[])=>{try{if((0,c.K)(t,"AnalyzeData_RelatedQuestions")){const e=v(t,a),n=a.slice(-1*h),o=v(t,n),r=(0===e.length?o:e).slice(0,h);return{suggestionList:r,shouldResetRecentPrompts:0===e.length}}let n=!1;const o=C((e=>{const t={Number:[],String:[],Any:[]};if(!e)return t;try{const a=JSON.parse(e.firstRowValues),n=JSON.parse(e.headers),o=JSON.parse(e.numberFormats);return e.visibleColumns.forEach((e=>{const r=a[e],i=o[e],l={header:n[e],firstCell:r};"number"!=typeof r||(0,u.xs)(i)?"string"==typeof r&&r.length&&"true"!==r&&"false"!==r&&(t.String.push(l),t.Any.push(l)):(t.Number.push(l),t.Any.push(l))})),t}catch(e){return s.M.getInstance().logError({eventType:l.S2.ChatEvents,errorMessage:`Error sorting columns by type: ${e.message}`,logLevel:r.$b.Warning}),t}})(e),t);let i=v(o,a);i.length<=m&&(i=o,n=!0);return{suggestionList:i.slice(0,Math.min(m,o.length)),shouldResetRecentPrompts:n}}catch(e){return s.M.getInstance().logError({eventType:l.S2.ChatEvents,errorMessage:`Error generating prompt suggestions: ${e.message}`,logLevel:r.$b.Warning}),{suggestionList:g().slice(0,m).map((e=>({suggestionType:e.suggestionType,suggestionText:e.suggestionText})))}}},v=(e,t)=>e.filter((e=>!t.includes(e.suggestionText))),x=e=>{if(!e)return;const t=i.ye.EmptyHeaders|i.ye.DuplicateHeaders;return e&t&&!(e&~t)?[{suggestionText:(0,o.aDv)(),suggestionType:"Tlr_ExplainTables"},{suggestionText:(0,o.vvX)(),suggestionType:"Tlr_ExplainHeaders"}]:e===i.ye.Unrecognized||e===i.ye.Crosstab?[{suggestionText:(0,o.aDv)(),suggestionType:"Tlr_ExplainTables"}]:e===i.ye.HasMergedCells?[{suggestionText:(0,o.R7A)(),suggestionType:"Tlr_ExplainUnmergingCells"}]:void 0}},375485:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var n=a(83437),o=a(855391),r=a(965634),i=a(956258),l=a(9847),s=a(79458),c=a(507628);class d{succeed(e){this.endCalled&&this.sendError(`Telemetry already ended for ${this.operationType}.`,n.$b.Warning,0),(0,s.cY)(`MakerStorageTelemetry sending succeed for ${this.operationType}`,e,{id:this.id}),e.operationType=`${this.operationType}.Succeeded`,e.duration=Date.now()-this.createdTime,this.sendTelemetryEvent(e),this.endCalled=!0}fail(e,t,a){this.endCalled&&this.sendError(`Telemetry already ended for ${this.operationType}.`,n.$b.Warning,0),(0,s.cY)(`MakerStorageTelemetry sending fail for ${this.operationType}`,e,t,a,{id:this.id}),t.operationType=`${this.operationType}.Failed`,t.level=e,t.error=this.stringifyError(a),t.duration=Date.now()-this.createdTime,this.sendTelemetryEvent(t),this.endCalled=!0}sendStart(e){(0,s.cY)(`MakerStorageTelemetry sending start for ${this.operationType}`,e,{id:this.id}),e.operationType=`${this.operationType}.Start`,this.sendTelemetryEvent(e)}sendTelemetryEvent(e){e.Id=this.id;const t=[];Object.keys(e).forEach((a=>{t.push({key:a,value:e[a]})}));const a={eventType:this.eventType,eventData:t};i.M.getInstance().logEvent(a)}sendError(e,t,a){const o={eventType:r.S2.MakerStorageEvent,errorMessage:"",logLevel:n.$b.Error},s=[{key:l.dA.ErrorMessage,value:e},{key:l.dA.LogLevel,value:t},{key:l.dA.TimeOut,value:a},{key:l.dA.Id,value:this.id}];i.M.getInstance().logError(o,void 0,s)}stringifyError(e){return e instanceof Error?e.message:e instanceof o.qD?JSON.stringify({message:e.message,errorCode:e.errorCode}):e instanceof o.Je?JSON.stringify({message:e.message,status:e.status,errorCode:e.errorCode}):e.toString()}constructor(e,t=[]){this.eventType=r.S2.MakerStorageEvent,this.endCalled=!1,this.createTimeout=(e,t)=>{(0,s.uk)(t).then((()=>{this.endCalled||this.sendError(`Telemetry Activity timed out waiting for ${this.operationType}`,e,t)}))},this.id=(0,c.A)(),this.createdTime=Date.now(),this.operationType=e,t.forEach((e=>{this.createTimeout(e.level,e.timeout)}))}}},386552:(e,t,a)=>{"use strict";a.d(t,{Hg:()=>u,PE:()=>h,lW:()=>s,tx:()=>c,vH:()=>m,zz:()=>d});var n=a(725556),o=a(911280),r=a(568499),i=a(722307),l=a(79458);const s=async e=>{try{await navigator.clipboard.writeText(e)}catch(e){(0,l.cY)("Failed to copy text to clipboard:",e)}},c=(e,t)=>(0,n.jsxs)("div",{"aria-label":e,role:"button",tabIndex:0,children:[(0,n.jsx)(o.Q,{truncate:!0,wrap:!1,children:e}),(0,n.jsx)("br",{}),(0,n.jsxs)(r.M,{children:["[queryId: ",t,"]"]})]}),d=e=>{let t=`${e.serviceName}:${e.metricType}`;if("PolymerLLMImprovedNetworking"===e.serviceName||"DeepLeoImprovedNetworking"===e.serviceName){t=`Sydney:${e.tags.length>0?e.tags[0]:e.metricType}`}return(0,n.jsxs)("div",{children:[(0,n.jsx)("span",{children:t})," ",(0,n.jsxs)("span",{style:{color:"Success"===e.status?"green":"red"},children:["[",e.status,"]"]})," ",(0,n.jsxs)("span",{children:["[",e.latencyMilliseconds,"ms]"]})]})},u=e=>{try{const t=e.indexOf("{"),a=e.lastIndexOf("}"),n=-1!==t&&-1!==a?e.substring(t,a+1):e,o=JSON.parse(n);return o.prompt?o.prompt.replace(/\\n/g,"\n"):o.text?o.text.replace(/\\n/g,"\n"):o.choices&&o.choices.length>0?o.choices[0]?.text:JSON.stringify(o,null,2)}catch(t){return e}},m=()=>(0,i.vI)()!==Office.PlatformType.OfficeOnline&&!!window.showDirectoryPicker,h=async(e,t,a,n)=>{const o=new Blob([e],{type:t});if(a=(e=>e.replace(/[/?<>\\:*|"]/g,"").replace(/[\x00-\x1f\x80-\x9f]/g,"").replace(/^\.+$/,"").replace(/^(con|prn|aux|nul|com[0-9]|lpt[0-9])(\..*)?$/i,"").replace(/[. ]+$/,"").substring(0,255))(a),n&&m()){const e=await n.getFileHandle(a,{create:!0}),t=await e.createWritable();return await t.write(o),void t.close()}const r=window.URL.createObjectURL(o),i=document.createElement("a");i.href=r,i.download=a,i.click()}},388435:(e,t,a)=>{"use strict";function n(e,t){const a=e.getDataBodyRange();return t?e.getHeaderRowRange().getBoundingRect(a):a}function o(e){const t=e.getUsedRangeOrNullObject().getCell(0,0).load(["rowIndex","columnIndex"]),a=e.getUsedRangeOrNullObject().getLastColumn().getCell(0,0).load(["rowIndex","columnIndex"]),n=e.getUsedRangeOrNullObject().getLastRow().getCell(0,0).load(["rowIndex","columnIndex"]),o=e.getRange().getLastCell().load(["rowIndex","columnIndex"]);return()=>t.columnIndex-2>=0?t.getOffsetRange(0,-2):t.rowIndex-2>=0?t.getOffsetRange(-2,0):a.columnIndex+2<=o.columnIndex?a.getOffsetRange(0,2):n.rowIndex+2<=o.rowIndex?n.getOffsetRange(2,0):null}a.d(t,{U2:()=>n,wZ:()=>o})},389298:(e,t,a)=>{"use strict";a.d(t,{F:()=>d,m:()=>c});var n=a(644476),o=a(79458),r=a(528804);const i={alSessionKey:void 0,sydneyConversationId:void 0,sydneyEndpoint:void 0,queryMetrics:{},commandingResponses:{}},l=(e,t,a)=>(e[t]||((0,o.cY)(`Creating new telemetry entry for query ${t}`),e[t]=a),e[t]),s=(0,n.Z0)({name:"telemetry",initialState:i,reducers:{addQueryMetrics(e,t){const{queryId:a,metrics:n}=t.payload;if(!n||0===n.length)return;const o=l(e.queryMetrics,a,{metrics:[]}),r=n.filter((e=>(e=>!e.serviceName?.startsWith("ExtensionRunner:ext:")&&!(!e.input||!e.output)&&("PolymerLLMImprovedNetworking"===e.serviceName||"DeepLeoImprovedNetworking"===e.serviceName||e.isUsed))(e))).filter((e=>((e,t)=>{const a=e.tags?.find((e=>e?.startsWith("unique-id-")));return!a||!t.some((e=>e.tags.includes(a)))})(e,o.metrics)));o.metrics.push(...r)},setAugLoopSessionKey(e,t){e.alSessionKey=t.payload},setSydneyConversationId(e,t){e.sydneyConversationId=t.payload},setSydneyEndpoint(e,t){e.sydneyEndpoint=t.payload},setQueryUserUtterance(e,t){const{queryId:a,userUtterance:n}=t.payload;l(e.queryMetrics,a,{metrics:[]}).userUtterance=n},setCommandingResponseUtterance(e,t){if(!(0,r.geU)())return;const{queryId:a,userUtterance:n,context:o}=t.payload,i=l(e.commandingResponses,a,{context:o});i.userUtterance=n,i.context=o},setCommandingResponse(e,t){if(!(0,r.geU)())return;const{queryId:a,response:n}=t.payload;l(e.commandingResponses,a,{context:""}).response=n},setCommandingResponseCompletion(e,t){if(!(0,r.geU)())return;const{queryId:a,codeCompletedSuccessfully:n,returnedMessage:o}=t.payload,i=l(e.commandingResponses,a,{context:""});i.codeCompletedSuccessfully=n,i.returnedMessage=o}}}),{actions:c,reducer:d}=s},390624:(e,t,a)=>{"use strict";a.d(t,{$r:()=>h,F5:()=>b,TA:()=>g,tN:()=>p});var n=a(932367),o=a(754440),r=a(83437),i=a(528804),l=a(581431),s=a(965634),c=a(956258),d=a(9847),u=a(267324);let m=!1;async function h(e,{delayForCellEdit:t=!0,operationTimers:a=new l.q}={}){try{return await a.measure("openUndoScope",Excel.run({delayForCellEdit:t},(async t=>{await a.measure("undoScope.open",t.application.undoScope.open(e)),m=!0})))}catch(e){const t=[{key:d.qJ.FeatureName,value:c.M.getInstance().getActiveFeature()},{key:d.qJ.HasUndoScopeOpened,value:m}];c.M.getInstance().logError({eventType:s.S2.ChatEvents,errorMessage:`ctx.application.undoScope.open() failed with code ${e.code}`,logLevel:r.$b.Warning},void 0,(0,i.yw9)("OfficeVSO_8866568_UndoScopeErrors")?t:void 0)}}async function g({delayForCellEdit:e=!0,operationTimers:t=new l.q,ignoreIfNotOpened:a=!1,rollback:n}={}){if(!(0,i.yw9)("OfficeVSO_8866568_UndoScopeErrors")||!a||m)try{return await t.measure("closeUndoScope",Excel.run({delayForCellEdit:e},(async e=>{await t.measure("undoScope.close",e.application.undoScope.close(n)),m=!1})))}catch(e){const t=[{key:d.qJ.FeatureName,value:c.M.getInstance().getActiveFeature()},{key:d.qJ.HasUndoScopeOpened,value:m}];c.M.getInstance().logError({eventType:s.S2.ChatEvents,errorMessage:`ctx.application.undoScope.close() failed with code ${e.code}`,logLevel:r.$b.Warning},void 0,(0,i.yw9)("OfficeVSO_8866568_UndoScopeErrors")?t:void 0)}}async function p(e){try{return await Excel.run({delayForCellEdit:!0},(async e=>{await e.application.undo()}))}catch(t){let a;switch(c.M.getInstance().logError({eventType:s.S2.ChatEvents,errorMessage:`ctx.application.undo() failed with code ${t.code}`,logLevel:r.$b.Warning}),e){case d.q.CalculatedColumns:case d.q.CalculatedRows:case d.q.NLToFormula:a=n.c.Undo_Calculated_Columns_Error;break;case d.q.AnalyzeData:a=n.c.Analyze_Data_Undo_Failed;break;case d.q.Commanding:a=n.c.Command_Execution_Undo_Failed;break;case d.q.ConditionalFormatting:a=n.c.Conditional_Formatting_Undo_Failed;break;case d.q.ContextInference:a=n.c.TLR_Auto_Fix_Undo_Failed;break;case d.q.Python:a=n.c.Python_Undo_Failed;break;case d.q.Answers:a=n.c.Answers_Undo_Failed}a&&c.M.getInstance().logStandardizedAshaErrorEvent(o.W.User_Input_Could_Not_Be_Processed,a,c.M.getInstance().getStandardizedFeatureForSubFeature(e))}}async function b(e,{delayForCellEdit:t=!0,operationTimers:a=new l.q}={}){a.start("total");try{await h((0,u.Eyh)(),{delayForCellEdit:t,operationTimers:a});const n=await a.measure("batch",Excel.run({delayForCellEdit:t},e));return await a.measure("forcesOnUndoChanged",Excel.run({delayForCellEdit:t},(async e=>{await e.sync()}))),n}finally{await g({delayForCellEdit:t,operationTimers:a}),a.end("total")}}},395987:(e,t,a)=>{"use strict";a.d(t,{g:()=>h});var n=a(601301),o=a(553482),r=a(267324),i=a(750927),l=a(162134),s=a(590572),c=a(534537),d=a(707314),u=a(771496),m=a(586446);function h(e,t){const a=function(e,t){if(!e||!(0,d.J2)(e.visual))return;const a=e.visual.chart,h=(0,l.ip)(a),g=(e,t)=>("primary"===t?(0,n.lf)(e):(0,n.t7)(e)).filter((e=>(0,m.$)(e.dimension))),p=g(h.primary.insightsType,"primary");h.secondary&&p.push(...g(h.secondary.insightsType,"secondary"));switch(p.length){case 0:default:return;case 1:{const n=(0,o.q)(a,p[0].dimension,"primary");if("PivotChartVisual"!==e.visual.visualType||!t&&1!==e.visual.pivotTable.dataFields.length)return n&&n.languageUnitsValue!==o.YO.None?(0,i.L)((0,r.xKU)(),n.localizedUnitsValue):void 0;{const t=e.visual.pivotTable.dataFields,a=t.length;return t.map(((e,t)=>{const{name:l,dataCalculation:s}=e,d=(0,c.i)(s),u=(0,i.L)((0,r.Gn5)(),d,l),m=n&&n.languageUnitsValue!==o.YO.None?(0,i.L)((0,r.ZQs)(),u,n.localizedUnitsValue):u;return t===a-1?m:(0,i.L)((0,r.cFM)(),m)})).join("")}}case 2:{const e=p.map((e=>{const t=(0,o.q)(a,e.dimension,e.axisGroup);if(!t)return null;const i=function(e,t){const a=(e.axes||[]).find((e=>e.dimensionType===t.dimension&&e.axisGroup===t.axisGroup));if(a){const e=a.title?(0,s.HW)(a.title):null;if(e)return e}const o=(0,u.tJ)(e.series);switch(t.orientation){case n.UQ.Horizontal:return o?"primary"===t.axisGroup?(0,r.KdV)():(0,r.W9h)():(0,r.tdb)();case n.UQ.Vertical:return o?"primary"===t.axisGroup?(0,r.$98)():(0,r.JuZ)():(0,r.kfS)();default:throw new Error("Invalid orientation")}}(a,e);return{units:t.localizedUnitsValue,name:i}})).filter((e=>!!e));if(0===e.length)return;if(1===e.length)return(0,i.L)((0,r.ZQs)(),e[0].name,e[0].units);if(2===e.length&&e[0].units===e[1].units)return(0,i.L)((0,r.xKU)(),e[0].units);if(2===e.length)return(0,i.L)((0,r.iMG)(),e[0].name,e[0].units,e[1].name,e[1].units);throw new Error("Invalid number of descriptors.")}}}(e,t);return a?(0,r.kK2)(a):a}},397502:(e,t,a)=>{"use strict";a.d(t,{i:()=>w});var n=a(725556),o=a(576583),r=a(86240),i=a(11248),l=a(517741),s=a(210350),c=a(388949),d=a(208520);const u=({title:e,duration:t,trigger:a,withArrow:o})=>{const[r,i]=function(e){const[t,a]=(0,d.useState)(!1),n=(0,d.useRef)(void 0);return(0,d.useEffect)((()=>{if(t)return m(n),n.current=window.setTimeout((()=>{a(!1),m(n)}),e),()=>m(n)}),[t]),[t,a]}(t);return(0,n.jsxs)(l.A,{withArrow:o,closeOnIframeFocus:!0,closeOnScroll:!0,size:"small",open:r,onOpenChange:(e,{open:t})=>{i(t)},children:[(0,n.jsx)(s.W,{children:a}),(0,n.jsx)(c.H,{"aria-live":"assertive",role:"alert",children:e})]})};function m(e){e.current&&(clearTimeout(e.current),e.current=void 0)}var h=a(609029),g=a(38417),p=a(289307),b=a(267324),f=a(965634),C=a(804672),y=a(944563),v=a(528804),x=a(479504);const T=(0,h.A)(g.cAv,g.c2D),S=(0,o.n)({iconContainer:{[`&:hover .${p.ru}`]:{color:y.k1.themePrimary}}});function w({getClipboardItem:e,telemetryUsageData:t,ariaLabelSuffix:a=""}){const[o,l]=(0,d.useState)(null),s=!(0,x.dD)(),c=S();(0,d.useEffect)((()=>{(0,v.yw9)("OfficeVSO_10036667_CopyButtonLazyClipboardItem")||(async()=>{const t=await e();l(t)})()}),[e]);const m=(0,n.jsx)(r.$,{size:"small",appearance:"transparent",icon:(0,n.jsx)(T,{}),className:c.iconContainer,"aria-label":`${b.xxz.CopyButtonLabel} ${a}`.trim(),"aria-expanded":void 0,onClick:async a=>{(0,v.yw9)("OfficeVSO_9770243_MacCopyButtonFix")&&a.stopPropagation(),(0,C.Kv)((0,v.yw9)("OfficeVSO_10036667_CopyButtonLazyClipboardItem")?await e():o,f.S2.Error,t)}});return(0,n.jsx)(u,{duration:3e3,title:b.xxz.CopyButtonPopover,trigger:s?(0,n.jsx)(i.m,{content:b.xxz.CopyButtonLabel,relationship:"label",children:m}):m})}},397646:(e,t,a)=>{"use strict";a.d(t,{y:()=>d});var n=a(83437),o=a(78160),r=a(965634),i=a(956258),l=a(69284);const s="#".repeat(255);class c{get resolve(){return this._resolve}constructor(){this.promise=new Promise((e=>{this._resolve=e}))}}class d{getOrCreateCellJobs(e,t){const a=d.hash(e,t);let n=this.cellJobs[a];return n||(n={formatAggregatedValues:{}},this.cellJobs[a]=n),n}getValue(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to get deferred value after deferred jobs have resolved. This can impact performance",logLevel:n.$b.Error});const a=this.getOrCreateCellJobs(e,t);return a.value||(a.value=new c),a.value.promise}getText(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to get deferred text after deferred jobs have resolved. This can impact performance",logLevel:n.$b.Error});const a=this.getOrCreateCellJobs(e,t);return a.text||(a.text=new c),a.text.promise}getFormat(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to get deferred number format after deferred jobs have resolved. This can impact performance",logLevel:n.$b.Error});const a=this.getOrCreateCellJobs(e,t);return a.numberFormat||(a.numberFormat=new c),a.numberFormat.promise}getFormatLocal(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to get deferred local number format after deferred jobs have resolved. This can impact performance",logLevel:n.$b.Error});const a=this.getOrCreateCellJobs(e,t);return a.numberFormatLocal||(a.numberFormatLocal=new c),a.numberFormatLocal.promise}formatAggregateValue(e,t,a){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to format aggregated value after jobs have resolved. This can impact performance",logLevel:n.$b.Error}),this.getFormatLocal(e,t);const o=this.getOrCreateCellJobs(e,t);return o.formatAggregatedValues[a]||(o.formatAggregatedValues[a]=new c),o.formatAggregatedValues[a].promise}formatSourceValue(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to format source value after jobs have resolved. This can impact performance",logLevel:n.$b.Error}),this.getValue(e,t),this.getFormatLocal(e,t);const a=this.getOrCreateCellJobs(e,t);return a.formatSourceValue||(a.formatSourceValue=new c),a.formatSourceValue.promise}formatSourceDate(e,t){this.hasResolved&&i.M.getInstance().logError({eventType:r.S2.Error,errorMessage:"Attempted to format date after jobs have resolved. This can impact performance",logLevel:n.$b.Error}),this.getValue(e,t);const a=this.getOrCreateCellJobs(e,t);return a.formatSourceDate||(a.formatSourceDate=new c),a.formatSourceDate.promise}getTranslations(e,t){return{getValue:this.translate(this.getValue,e,t),getText:this.translate(this.getText,e,t),getFormat:this.translate(this.getFormat,e,t),getFormatLocal:this.translate(this.getFormatLocal,e,t),formatAggregateValue:this.translate(this.formatAggregateValue,e,t),formatSourceValue:this.translate(this.formatSourceValue,e,t),formatSourceDate:this.translate(this.formatSourceDate,e,t)}}translate(e,t,a){return(n,o,...r)=>e.call(this,n+t,o+a,...r)}async resolveJobs(){this.hasResolved=!0;const{sheetId:e}=this;for(;Object.keys(this.cellJobs).length>0;){const{cellJobs:t}=this;this.cellJobs={},await d.resolveJobs(t,e)}}static async resolveJobs(e,t){await Excel.run((async a=>{const n={},r=a.workbook.worksheets.getItem(t);for(const[t,a]of Object.entries(e)){const{row:e,column:o}=d.unhash(t),i=[];a.text&&i.push("text"),a.value&&i.push("values"),a.numberFormat&&i.push("numberFormat"),a.numberFormatLocal&&i.push("numberFormatLocal"),n[t]=r.getCell(e,o).load(i)}await a.sync();for(const t in n){const a=e[t],o=n[t];a.text&&a.text.resolve(o.text[0][0]),a.value&&a.value.resolve(o.values[0][0]),a.numberFormat&&a.numberFormat.resolve(o.numberFormat[0][0]),a.numberFormatLocal&&a.numberFormatLocal.resolve(o.numberFormatLocal[0][0])}const i=Excel.NumberFormattingService.newObject(a),c=[];function u(e,t,a,n){if(Number.isNaN(e)||o.P.getNumberFormatCache().isDateTime(a)&&!function(e){return!(e<0||e>2958465.99999999)}(e))n(s);else{const a=t.format(e);c.push((()=>n(a.value)))}}for(const t in e){const a=e[t],o=n[t];if(a.formatSourceValue||Object.keys(a.formatAggregatedValues).length>0){const e=o.numberFormatLocal[0][0],t=i.getFormatter(e);if(a.formatSourceValue){const n=o.values[0][0];"number"==typeof n?u(n,t,e,a.formatSourceValue.resolve):a.formatSourceValue.resolve(void 0)}for(const n in a.formatAggregatedValues){const{resolve:o}=a.formatAggregatedValues[n];u(Number.parseFloat(n),t,e,o)}}if(a.formatSourceDate){const e=o.values[0][0];if("number"==typeof e){u(e,i.getFormatter(l.D4),l.D4,a.formatSourceDate.resolve)}else a.formatSourceDate.resolve(void 0)}}0!==c.length&&(await a.sync(),c.forEach((e=>e())))}))}static hash(e,t){return`${e},${t}`}static unhash(e){const[t,a]=e.split(",");return{row:Number.parseInt(t),column:Number.parseInt(a)}}constructor(e){this.sheetId=e,this.cellJobs={},this.hasResolved=!1}}},399589:(e,t,a)=>{"use strict";a.d(t,{X:()=>l,j:()=>r});var n=a(993384);const o={General:e=>"General",Number:e=>i(e),Currency:e=>"$#,##"+i(e),Accounting:e=>{const t=i(e);return`_($* #,##${t}_);_($* (#,##${t};_($* "-"??_);_(@_)`},"Short Date":e=>"m/d/yyyy","Long Date":e=>"[$-x-sysdate]dddd, mmmm dd, yyyy",Time:e=>"[$-x-systime]h:mm:ss AM/PM",Comma:e=>{const t=i(e);return`_(* #,##${t}_);_(* (#,##${t});_(* "-"??_);_(@_)`},Percentage:e=>`${i(e)}%`,Fraction:e=>"# ?/?",Scientific:e=>`${i(e)}E+00`,Text:e=>"@"};function r(e,t){try{return o[e](t)}catch{return e}}function i(e){if(void 0===e||e<0)return"0.00";if(0===e)return"0";{let t="0.";for(let a=0;a<e;a++)t+="0";return t}}function l(e,t){let a=(t?{General:ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionGeneral,"m/d/yyyy":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionShortDate,"[$-x-sysdate]dddd, mmmm dd, yyyy":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionLongDate,"[$-x-systime]h:mm:ss AM/PM":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionTime,"# ?/?":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionFraction,"@":ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionText}:{General:"a general format","m/d/yyyy":"a short date format","[$-x-sysdate]dddd, mmmm dd, yyyy":"a long date format","[$-x-systime]h:mm:ss AM/PM":"a time format","# ?/?":"a fraction format","@":"a text format"})[e];return void 0===a?(e.startsWith("[$-")||(0,n.xs)(e)?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionDateTime:"a date/time format":e.startsWith("_($")||e.startsWith("_(")||e.startsWith("_(")||e.startsWith("_(")||e.startsWith("_(")||e.startsWith("_(")||e.startsWith("_(")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionAccounting:"an accounting format":e.includes("$")||e.includes("")||e.includes("")||e.includes("")||e.includes("")||e.includes("")||e.includes("")||e.includes("kr")||e.includes("")||e.includes("")||e.includes("z")||e.includes("")||e.includes("")||e.includes("K")||e.includes("Ft")||e.includes("Rp")||e.includes("")||e.includes("kn")||e.includes("lei")||e.includes("")||e.includes("din")||e.includes("")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionCurrency:"a currency format":e.startsWith("_(* #,##")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionComma:"a comma format":e.endsWith("%")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionPercentage:"a percentage format":e.endsWith("E+00")?a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionScientific:"a scientific format":e.startsWith("0")&&(a=t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionNumber:"a number format"),void 0!==a?a:(t?ExcelCopilotCommandingHitlStrings.NumberFormatDescriptionCustom:"a custom format")+"("+e+")"):a}},401227:(e,t,a)=>{"use strict";a.d(t,{Ns:()=>Ea,RU:()=>La,h7:()=>Ra,q:()=>Ia,Ms:()=>Fa});var n,o=a(707314),r=a(632512),i=a(47262);class l{toString(){return this.address}constructor(e){this.address=e}}class s{toString(){return null==this.value?'""':`"${we(this.value)}"`}getValue(){return this.value&&we(this.value)}constructor(e){this.value=e}}class c{toString(){return null==this.value?"":this.value?"TRUE":"FALSE"}constructor(e){this.value=e}}class d{toString(){return null==this.value?"":this.value.toString()}constructor(e){this.value=e}}class u{toString(){return null==this.valueOrArray?"":"number"==typeof this.valueOrArray?`${this.valueOrArray}`:this.valueOrArray.length>0&&"number"==typeof this.valueOrArray[0]?1===this.valueOrArray.length?`${this.valueOrArray[0]}`:`{${this.valueOrArray.join(",")}}`:`{${this.valueOrArray.map((e=>e.join(","))).join(";")}}`}constructor(e){this.valueOrArray=e}}class m{toString(){return null==this.valueOrArray?"":"string"==typeof this.valueOrArray?new s(this.valueOrArray).toString():this.valueOrArray.length>0&&"string"==typeof this.valueOrArray[0]?1===this.valueOrArray.length?new s(this.valueOrArray[0]).toString():`{${this.valueOrArray.map((e=>new s(e).toString())).join(",")}}`:`{${this.valueOrArray.map((e=>e.map((e=>new s(e).toString())).join(","))).join(";")}}`}constructor(e){this.valueOrArray=e}}class h{toString(){return this.brackets?`(${this.left.toString()}${this.op}${this.right.toString()})`:`${this.left.toString()}${this.op}${this.right.toString()}`}constructor(e,t,a,n){this.op=e,this.left=t,this.right=a,this.brackets=n}}class g{toString(){return this.brackets?`(${this.left.toString()}${this.op}${this.right.toString()})`:`${this.left.toString()}${this.op}${this.right.toString()}`}constructor(e,t,a,n){this.op=e,this.left=t,this.right=a,this.brackets=n}}class p{toString(){let e=this.params.length;for(;e>=1&&(null===this.params[e-1]||void 0===this.params[e-1]);e--);return`${this.functionName}(${this.params.slice(0,e).map((e=>null==e?"":e.toString())).join(",")})`}constructor(...e){this.params=e}}class b extends p{constructor(...e){super(...e),this.functionName="ROUND"}}class f extends p{constructor(...e){super(...e),this.functionName="CEILING.MATH"}}class C extends p{toString(){const[e,t]=this.params;return null==t?`${this.functionName}(${e.toString()})`:super.toString()}constructor(...e){super(...e),this.functionName="FLOOR.MATH"}}class y extends p{constructor(...e){super(...e),this.functionName="MEDIAN"}}class v extends p{constructor(...e){super(...e),this.functionName="TRANSPOSE"}}class x extends p{constructor(...e){super(...e),this.functionName="SUBSTITUTE"}}class T extends p{toString(){const[e,t,a]=this.params;return null==a?null==t?`${this.functionName}(${e.toString()},,)`:`${this.functionName}(${e.toString()},${t.toString()})`:super.toString()}constructor(...e){super(...e),this.functionName="INDEX"}}class S extends p{constructor(...e){super(...e),this.functionName="ISBLANK"}}class w extends p{constructor(...e){super(...e),this.functionName="ISNUMBER"}}class E extends p{constructor(...e){super(...e),this.functionName="ISTEXT"}}class I extends p{constructor(...e){super(...e),this.functionName="ISERROR"}}class R extends p{constructor(...e){super(...e),this.functionName="ISLOGICAL"}}class A extends p{constructor(...e){super(...e),this.functionName="MATCH"}}class L extends p{constructor(...e){super(...e),this.functionName="XMATCH"}}class k extends p{constructor(...e){super(...e),this.functionName="XLOOKUP"}}class F extends p{constructor(...e){super(...e),this.functionName="MUNIT"}}class _ extends p{constructor(...e){super(...e),this.functionName="AVERAGEIFS"}}class P extends p{constructor(...e){super(...e),this.functionName="MAXIFS"}}class N extends p{constructor(...e){super(...e),this.functionName="MINIFS"}}class M extends p{constructor(...e){super(...e),this.functionName="COUNTIFS"}}class O extends p{constructor(...e){super(...e),this.functionName="SUMIFS"}}class D{toString(){const e=this.formula instanceof s||this.formula instanceof d||this.formula instanceof c,t=this.formula instanceof s?this.formula.getValue():this.formula.toString();switch(this.op){case"startWith":return e?`"=${t}*"`:`"="&${t}&"*"`;case"endWith":return e?`"=*${t}"`:`"=*"&${t}`;case"contain":return e?`"=*${t}*"`:`"=*"&${t}&"*"`;default:return e?`"${this.op}${t}"`:`"${this.op}"&${t}`}}constructor(e,t){this.op=e,this.formula=t}}class B{toString(){return`${this.range.toString()},${this.criteria.toString()}`}constructor(e,t){this.range=e,this.criteria=t}}class $ extends p{constructor(...e){super(...e),this.functionName="SUM"}}class H extends p{constructor(...e){super(...e),this.functionName="AVERAGE"}}class U extends p{constructor(...e){super(...e),this.functionName="MAX"}}class q extends p{constructor(...e){super(...e),this.functionName="MIN"}}class V extends p{constructor(...e){super(...e),this.functionName="MOD"}}class G extends p{constructor(...e){super(...e),this.functionName="COUNTA"}}class W extends p{constructor(...e){super(...e),this.functionName="COLUMN"}}class z extends p{constructor(...e){super(...e),this.functionName="ROW"}}class j extends p{constructor(...e){super(...e),this.functionName="COLUMNS"}}class Q extends p{constructor(...e){super(...e),this.functionName="ROWS"}}class J extends p{constructor(...e){super(...e),this.functionName="SEQUENCE"}}class Y extends p{constructor(...e){super(...e),this.functionName="SORTBY"}}class X{toString(){return`${this.array.toString()},${this.order}`}constructor(e,t){this.array=e,this.order=t}}class Z extends p{toString(){const[e,t,a]=this.params;return t?a?`${this.functionName}(${e.toString()},${t.toString()},${a.toString()})`:`${this.functionName}(${e.toString()},${t.toString()})`:`${this.functionName}(${e.toString()})`}constructor(...e){super(...e),this.functionName="SORT"}}class K{}class ee extends K{toString(){return`(TRUE)-(${this.condition.toString()})`}constructor(e){super(),this.condition=e}}class te extends K{toString(){return`${this.left instanceof te||this.left instanceof p?this.left.toString():`(${this.left.toString()})`}*${this.right instanceof te||this.right instanceof p?this.right.toString():`(${this.right.toString()})`}`}constructor(e,t){super(),this.left=e,this.right=t}}class ae extends K{toString(){return`${this.left instanceof ae||this.left instanceof te||this.left instanceof p?this.left.toString():`(${this.left.toString()})`}+${this.right instanceof ae||this.right instanceof te||this.right instanceof p?this.right.toString():`(${this.right.toString()})`}`}constructor(e,t){super(),this.left=e,this.right=t}}class ne extends p{constructor(...e){super(...e),this.functionName="FILTER"}}class oe extends p{constructor(...e){super(...e),this.functionName="CHOOSE"}}class re extends p{toString(){const[e,t,a]=this.params;return t||a?super.toString():`${this.functionName}(${e.toString()})`}constructor(...e){super(...e),this.functionName="UNIQUE"}}class ie extends p{constructor(...e){super(...e),this.functionName="MMULT"}}class le extends p{constructor(...e){super(...e),this.functionName="FIND"}}class se extends p{constructor(...e){super(...e),this.functionName="SEARCH"}}class ce extends p{constructor(...e){super(...e),this.functionName="IF"}}class de extends p{constructor(...e){super(...e),this.functionName="IFERROR"}}class ue extends p{constructor(...e){super(...e),this.functionName="LEN"}}class me extends p{constructor(...e){super(...e),this.functionName="RIGHT"}}class he extends p{constructor(...e){super(...e),this.functionName="DATE"}}class ge extends p{constructor(...e){super(...e),this.functionName="TIME"}}class pe extends p{constructor(...e){super(...e),this.functionName="NA"}}class be extends p{constructor(...e){super(...e),this.functionName="YEAR"}}class fe extends p{constructor(...e){super(...e),this.functionName="MONTH"}}class Ce extends p{constructor(...e){super(...e),this.functionName="DAY"}}class ye extends p{constructor(...e){super(...e),this.functionName="HOUR"}}class ve extends p{constructor(...e){super(...e),this.functionName="MINUTE"}}class xe extends p{constructor(...e){super(...e),this.functionName="SECOND"}}class Te extends p{constructor(...e){super(...e),this.functionName="TEXT"}}class Se{static formulaRound(e,t){return new b(e,new d(t))}static formulaCeilingMath(e){return new f(e)}static formulaFloorMath(e,t){return new C(e,t?new d(t):null)}static formulaMedian(e){return new y(e)}static formulaTranspose(e){return new v(e)}static formulaSubstitute(e,t,a){return new x(e,"string"==typeof t?new s(t):t,"string"==typeof a?new s(a):a)}static formulaIndex(e,t,a){let n,o;return n=null==t?null:"number"==typeof t||t instanceof Array?new u(t):t,o=null==a?null:"number"==typeof a||a instanceof Array?new u(a):a,new T(e,n,o)}static formulaIsBlank(e){return new S(e)}static formulaIsNumber(e){return new w(e)}static formulaIsText(e){return new E(e)}static formulaIsError(e){return new I(e)}static formulaIsLogical(e){return new R(e)}static formulaMatch(e,t,a){return new A(e,t,new d(null==a?1:a))}static formulaXMatch(e,t,a,n){return new L(e,t,new d(null==a?0:a),new u(null==n?1:n))}static formulaXLookup(e,t,a,n,o,r){return new k(e,t,a,n,new d(o||0),new d(null==r?1:r))}static formulaMunit(e){return new F("number"==typeof e?new d(e):e)}static formulaAverageifs(e,t){return new _(e,...t)}static formulaMaxifs(e,t){return new P(e,...t)}static formulaMinifs(e,t){return new N(e,...t)}static formulaCountifs(e){return new M(...e)}static formulaSumifs(e,t){return new O(e,...t)}static formulaSum(e){return e instanceof Array?new $(...e):new $(e)}static formulaAverage(e){return new H(e)}static formulaCountA(e){return new G(e)}static formulaMax(e){return new U(e)}static formulaMin(e){return e instanceof Array?new q(...e):new q(e)}static formulaMod(e,t){return new V(e,new u(t))}static formulaColumn(e){return new W(e)}static formulaRow(e){return new z(e)}static formulaColumns(e){return new j(e)}static formulaRows(e){return new Q(e)}static formulaSequence(e,t,a,n){const o="number"==typeof e?new d(e):e;let r,i,l;return r=null==n?null:"number"==typeof n?new d(n):n,i=null==a?null:"number"==typeof a?new d(a):a,l=null==t?null:"number"==typeof t?new d(t):t,new J(o,l,i,r)}static formulaSortBy(e,t){return new Y(e,...t)}static formulaSort(e,t,a){return null==(t||a)?new Z(e,null,null):new Z(e,"number"==typeof t||t instanceof Array?new u(t):t,null==a?null:new u(a))}static formulaFilter(e,t){return new ne(e,t)}static formulaChoose(e,...t){return new oe(e,...t)}static formulaUnique(e,t,a){return new re(e,null==t?null:new c(t),null==a?null:new c(t))}static formulaMmult(e,t){return new ie(e,t)}static formulaFind(e,t){return new le("string"==typeof e?new s(e):e,t)}static formulaSearch(e,t){return new se("string"==typeof e?new s(e):e,t)}static formulaIf(e,t,a){return new ce(e,t,a)}static formulaIfError(e,t){return new de(e,t)}static formulaLen(e){return new ue(e)}static formulaRight(e,t){return new me(e,t)}static formulaDate(e,t,a){const n="number"==typeof e?new d(e):e,o="number"==typeof t?new d(t):t,r="number"==typeof a?new d(a):a;return new he(n,o,r)}static formulaTime(e,t,a){const n="number"==typeof e?new d(e):e,o="number"==typeof t?new d(t):t,r="number"==typeof a?new d(a):a;return new ge(n,o,r)}static formulaNA(){return new pe}static formulaYear(e){return new be("number"==typeof e?new d(e):e)}static formulaMonth(e){return new fe("number"==typeof e?new d(e):e)}static formulaDay(e){return new Ce("number"==typeof e?new d(e):e)}static formulaHour(e){return new ye("number"==typeof e?new d(e):e)}static formulaMinute(e){return new ve("number"==typeof e?new d(e):e)}static formulaSecond(e){return new xe("number"==typeof e?new d(e):e)}static formulaText(e,t){return new Te(e,new s(t))}}function we(e){return e.replace(/"/g,'""')}function Ee(e){return e.replace(/~/g,"~~").replace(/\*/g,"~*").replace(/\?/g,"~?")}function Ie(e,t){return Se.formulaSubstitute(Se.formulaSubstitute(Se.formulaSubstitute(e,"~",t?"~~":Se.formulaIf(new g(">",Se.formulaMmult(Se.formulaIfError(Se.formulaFind(new m(["*","?"]),e),new d(0)),new u([[1],[1]])),new d(0)),new s("~~"),new s("~"))),"*","~*"),"?","~?")}function Re(e){const t=/^([0-9]+)-([0-9]+)-([0-9]+)T([0-9]+):([0-9]+):([0-9]+\.[0-9]+)/.exec(e);if(7!==t.length)throw new Error("wrong datetime structure");const[a,n,o,r,i,l]=t.filter(((e,t)=>t>0)).map((e=>parseFloat(e)));return new h("+",Se.formulaDate(a,n,o),Se.formulaTime(r,i,l))}class Ae extends Error{constructor(e,t){super(t||""),this.errorCode=e,Object.setPrototypeOf(this,Ae.prototype)}}function Le(e,t,a){const[n,o,r,s,c,u]=(e=>{if(Me(e)){const t=new l(a(e.sourceDataReference.left));return[Se.formulaYear(t),Se.formulaMonth(t),Se.formulaDay(t),Se.formulaHour(t),Se.formulaMinute(t),Se.formulaSecond(t)]}{const t=/^([0-9]+)-([0-9]+)-([0-9]+)T([0-9]+):([0-9]+):([0-9]+\.[0-9]+)/.exec(e.value);if(7!==t.length)throw new Error("wrong datetime structure");return t.filter(((e,t)=>t>0)).map((e=>new d(parseFloat(e))))}})(t);switch(e){case"date":return Se.formulaDate(n,o,r);case"decade":return Se.formulaFloorMath(Se.formulaMod(n,100),10);case"year":return n;case"quarter":return Se.formulaCeilingMath(new h("/",o,new d(3)));case"month":return o;case"dayOfMonth":return r;case"hour":return s;case"minute":return c;case"hourAndMinute":return Se.formulaTime(s,c,0);case"hourMinuteAndSecond":return Se.formulaTime(s,c,u);case"dateAndHour":return new h("+",Se.formulaDate(n,o,r),Se.formulaTime(s,0,0));case"dateHourAndMinute":return new h("+",Se.formulaDate(n,o,r),Se.formulaTime(s,c,0));case"dateHourMinuteAndSecond":return new h("+",Se.formulaDate(n,o,r),Se.formulaTime(s,c,u));case"monthAndDay":return Se.formulaDate(0,o,r);case"yearAndMonth":return Se.formulaDate(n,o,1);case"yearAndQuarter":return Se.formulaCeilingMath(new h("/",new h("+",new h("*",n,new d(12)),o),new d(3)));default:return(0,i.x)(e)}}function ke(e,t){if(!Me(e.source))throw new Ae("TranslationFailure","only column name expressions are supported as source of Date Function in project or group columns");switch(e.datePartFunction){case"date":return Se.formulaText(t,"yyyy-mm-dd");case"decade":return Se.formulaText(Se.formulaFloorMath(Se.formulaMod(Se.formulaYear(t),100),10),"00");case"year":return Se.formulaText(t,"yyyy");case"quarter":return Se.formulaText(Se.formulaCeilingMath(new h("/",Se.formulaMonth(t),new d(3))),'"Q"0');case"month":return Se.formulaText(t,"mm");case"dayOfMonth":case"hour":return Se.formulaText(t,"dd");case"minute":return Se.formulaText(Se.formulaMinute(t),"00");case"hourAndMinute":return Se.formulaText(t,"hh:mm AM/PM");case"hourMinuteAndSecond":return Se.formulaText(t,"hh:mm:ss AM/PM");case"dateAndHour":return Se.formulaText(t,"yyyy-mm-dd h AM/PM");case"dateHourAndMinute":return Se.formulaText(t,"yyyy-mm-dd h:mm AM/PM");case"dateHourMinuteAndSecond":return Se.formulaText(t,"yyyy-mm-dd h:mm:ss AM/PM");case"monthAndDay":return Se.formulaText(t,"mm-dd");case"yearAndMonth":return Se.formulaText(t,"yyyy-mm");case"yearAndQuarter":return new h("&",Se.formulaYear(t),Se.formulaText(Se.formulaCeilingMath(new h("/",Se.formulaMonth(t),new d(3))),'" Q"0'));default:return(0,i.x)(e.datePartFunction)}}!function(e){e.ProactiveLimitation="ProactiveLimitation",e.ValidationIssue="ValidationIssue",e.TranslationFailure="TranslationFailure",e.ExceedLengthLimitation="ExceedLengthLimitation",e.ContentTooLarge="ContentTooLarge",e.Unknown="Unknown"}(n||(n={}));class Fe{getTableAddress(){return this.isFake?null:this.address}getColumnAddress(e){return this.isFake?null:this.columns[e].columnAddress}getColumnLength(){return this.isFake?-1:this.columns.length}constructor(e,t,a){this.isFake=e,this.columns=t,this.address=a}}function _e(e){return!!e&&"query"===e.exprType}function Pe(e){return!!e&&"inQuery"===e.exprType}function Ne(e){return!!e&&"distinct"===e.exprType}function Me(e){return!!e&&"columnName"===e.exprType}function Oe(e){return!!e&&"datePart"===e.exprType}function De(e){return!!e&&["average","count","max","median","min","sum"].some((t=>t===e.exprType))}function Be(e){return!!e&&["and","or"].some((t=>t===e.exprType))}function $e(e){return!!e&&"not"===e.exprType}function He(e){return!!e&&["contains","equality","greaterThan","greaterThanOrEqual","lessThan","lessThanOrEqual","startsWith","endsWith"].some((t=>t===e.exprType))}function Ue(e){return!!e&&"numberLiteral"===e.exprType}function qe(e){return!!e&&"booleanLiteral"===e.exprType}function Ve(e){return!!e&&("dateTimeLiteral"===e.exprType||"stringLiteral"===e.exprType)}function Ge(e,t){return JSON.stringify(e)===JSON.stringify(t)}const We=8e5,ze=5e4,je=1e3,Qe=3e4,Je=5e4;class Ye{translate(){const{projectClause:e,whereClause:t,havingClause:a,sortClause:o,takeClause:r,groupClause:i,rankingClause:l}=this.queryResult;if(l)throw new Ae(n.TranslationFailure,"ranking clause is not supported at present");const s=e.length;let d=!1;if(o&&o.length>0)for(let t=0;t<o.length;t++)e.findIndex((e=>Ge(o[t].expr,e)))<0&&(d=!0,e.push(o[t].expr));if(e.length>254)throw new Ae(n.TranslationFailure,"length of project clause can not be larger than 254");const m=e.some((e=>De(e))),h=e.some((e=>Me(e)||Oe(e)));let g;const p=e.map((e=>Me(e)?e.sourceDataReference.left:null)),b=this.calculateColumnIndexNeedNumberCheckForFilter(t),f=this.includeNumberCheckInFilterCondition(b,t&&this.calculateFilterInclude(g,t));let C;if(!m&&h?g=this.calculateOnlyNonAggregations(p,f):(C=this.calculateBothColumnsAndAggregations(f,b),g=1===C.valueList.length?C.valueList[0]:Se.formulaChoose(new u(C.indexStartFromOneList),...C.valueList)),a&&(g=Se.formulaFilter(g,Se.formulaIfError(this.calculateFilterInclude(g,a),new c(!1)))),o){const t=o.map((t=>e.findIndex((e=>Ge(t.expr,e)))+1)),a=o.map((e=>"asc"===e.order?1:-1));g=Se.formulaSort(g,t,a)}else i&&(g=Se.formulaSort(g,1===e.length?null:e.map(((e,t)=>Me(e)||Oe(e)?t+1:null)).filter((e=>null!=e))));return r&&(g=Se.formulaIndex(g,Se.formulaSequence(r),Se.formulaSequence(1,e.length))),d&&(g=Se.formulaIndex(g,Se.formulaSequence(Se.formulaRows(g)),Se.formulaSequence(1,s))),g}calculateColumnIndexNeedNumberCheckForFilter(e){if(!e)return[];if(He(e)){const t=[];return!Me(e.left)||"greaterThanOrEqual"!==e.exprType&&"greaterThan"!==e.exprType&&"lessThanOrEqual"!==e.exprType&&"lessThan"!==e.exprType||t.push(e.left.sourceDataReference.left),!Me(e.right)||"greaterThanOrEqual"!==e.exprType&&"greaterThan"!==e.exprType&&"lessThanOrEqual"!==e.exprType&&"lessThan"!==e.exprType||t.push(e.right.sourceDataReference.left),t.filter(((e,t,a)=>a.indexOf(e)===t))}return $e(e)?this.calculateColumnIndexNeedNumberCheckForFilter(e.expr):Be(e)?[...this.calculateColumnIndexNeedNumberCheckForFilter(e.left),...this.calculateColumnIndexNeedNumberCheckForFilter(e.right)].filter(((e,t,a)=>a.indexOf(e)===t)):[]}includeNumberCheckInFilterCondition(e,t){let a=t;for(let t=0;t<e.length;t++)a=a?new te(Se.formulaIsNumber(new l(this.content.getColumnAddress(e[t]))),a):Se.formulaIsNumber(new l(this.content.getColumnAddress(e[t])));return a}calculateBothColumnsAndAggregations(e,t){const{projectClause:a,groupClause:o,whereClause:r}=this.queryResult,i=[],s=new l(this.content.getTableAddress()),c=Se.formulaUnique(this.calculateNonAggregatedPart(o||[],s,e)),d=[];let u=0;const m=!!o&&Ge(o,a.slice(0,o.length));return m&&(i.push(c),u=1),a.forEach((a=>{if(Me(a)||Oe(a)){if(!o)throw new Ae(n.TranslationFailure,"non-aggregated columns must be in the group clause if there are aggregations");m?d.push(1):(i.push(1===o.length?c:Se.formulaIndex(c,null,o.findIndex((e=>Ge(e,a)))+1)),u+=1,d.push(u))}else{if(!De(a))throw new Error;i.push(this.calculateAggregationWithCustomFunction(a,e,t)),u+=1,d.push(u)}})),{indexStartFromOneList:d,valueList:i}}calculateNonAggregatedPart(e,t,a){const n=this.calculateNonAggregatedPartWithoutFilter(e,t),o=1===n.valueList.length?n.valueList[0]:Se.formulaChoose(new u(n.indexStartFromOneList),...n.valueList);return a?Se.formulaFilter(o,a):o}calculateNonAggregatedPartWithoutFilter(e,t,a){const o=[];let r=0;const i=[],l=e.filter((e=>Me(e))).length,s=e.length-l,c=!a&&(l>3||0===s);if(c){const a=e.map((e=>Me(e)?e.sourceDataReference.left:0)),n=this.getSubTableWithSeveralColumns(a,t,!0);o.push(n),r=1}for(let a=0;a<e.length;a++){const l=e[a];if(Me(l))if(c)i.push(1);else{r+=1,i.push(r);const e=this.getSubTableWithSeveralColumns([l.sourceDataReference.left],t,!0);o.push(e)}else{if(r+=1,i.push(r),!Me(l.source))throw new Ae(n.TranslationFailure,"only columnName expressions are supported as the source of date part function in project or group clause");const e=this.getSubTableWithSeveralColumns([l.source.sourceDataReference.left],t,!0);o.push(ke(l,e))}}return{indexStartFromOneList:i,valueList:o}}calculateDatePartComparison(e){const{left:t,right:a,exprType:o}=e;if(!Oe(t)||!Oe(a)||t.datePartFunction!==a.datePartFunction)throw new Ae(n.TranslationFailure,"only two date part expressions with the same date part function could be compared");const r={greaterThan:">",greaterThanOrEqual:">=",lessThan:"<",lessThanOrEqual:"<=",equality:"="};if(!Object.prototype.hasOwnProperty.call(r,o))throw new Ae(n.TranslationFailure,"only >,>=,<,<=,= are supported in date part comparison");const i=Le(t.datePartFunction,t.source,this.content.getColumnAddress.bind(this.content)),l=Le(a.datePartFunction,a.source,this.content.getColumnAddress.bind(this.content));return new g(r[o],i,l)}calculateOnlyNonAggregations(e,t){const{groupClause:a,projectClause:n}=this.queryResult,o=new l(this.content.getTableAddress());let r=this.calculateNonAggregatedPart(n,o,t);return e&&e.length===this.content.getColumnLength()&&e.every(((e,t)=>e===t))&&(r=t?Se.formulaFilter(o,t):o),a&&(r=Se.formulaUnique(r)),r}calculateAggregationWithNativeFunction(e,t,a){const n=[...t||[],...a||[]],o=null!=(t||a),r=e.expr;if(Me(r)){const t=new l(this.content.getColumnAddress(r.sourceDataReference.left));switch(e.exprType){case"sum":return o?Se.formulaSumifs(t,n):Se.formulaSum(t);case"average":return o?Se.formulaAverageifs(t,n):Se.formulaAverage(t);case"count":{const e=(this.queryResult.groupClause||[]).map((e=>e.sourceDataReference.left));if(this.queryResult.groupClause&&!e.some((e=>e===r.sourceDataReference.left)))throw new Error("use custom calculation when there are group columns but the counted column is not one of them");return o?Se.formulaCountifs(n):Se.formulaCountA(t)}case"max":return o?Se.formulaMaxifs(t,n):Se.formulaMax(t);case"min":return o?Se.formulaMinifs(t,n):Se.formulaMin(t);case"median":if(!o)return Se.formulaMedian(t);break;default:(0,i.x)(e.exprType)}}if(null==r&&"count"===e.exprType)return o?Se.formulaCountifs(n):Se.formulaRows(new l(this.content.getTableAddress()));throw new Error}calculateAggregationWithCustomFunction(e,t,a){const{whereClause:n,groupClause:o}=this.queryResult,r=(o||[]).length,s=e.expr,c=new l(this.content.getTableAddress());if(!o||0===r){if(Me(s)){const a=new l(this.content.getColumnAddress(s.sourceDataReference.left)),n=t?Se.formulaFilter(a,t):a;switch(e.exprType){case"sum":return Se.formulaSum(n);case"count":{const e=t?Se.formulaFilter(a,new te(new ee(Se.formulaIsBlank(a)),t)):a;return Se.formulaCountA(e)}case"average":return Se.formulaAverage(n);case"median":return Se.formulaMedian(n);case"min":return Se.formulaMin(n);case"max":return Se.formulaMax(n);default:(0,i.x)(e.exprType)}}else{if(Ne(s)){if(s.exprs&&0!==s.exprs.length){if(1!==s.exprs.length)throw Error("doesn't support more than 1 expression in Distinct Expression");{const e=s.exprs[0],a=new l(this.content.getColumnAddress(e.sourceDataReference.left)),n=t?Se.formulaFilter(a,t):a;return t?Se.formulaSum(Se.formulaIf(Se.formulaIsError(Se.formulaUnique(n)),new d(0),new d(1))):Se.formulaCountA(Se.formulaUnique(n))}}throw Error("invalid arguments")}if(null==s&&"count"===e.exprType){const e=t?Se.formulaFilter(c,t):c;return Se.formulaRows(e)}}throw new Error("currently not support such expression")}const u=this.calculateNonAggregatedPart(o,c,t),m=this.calculateNonAggregatedPartWithoutFilter(o,c,!0),h=Ye.concatColumns(r,m.valueList,m.indexStartFromOneList);if(Me(s)){const g=new l(this.content.getColumnAddress(s.sourceDataReference.left)),p=n?this.includeNumberCheckInFilterCondition([...a,s.sourceDataReference.left].filter(((e,t,a)=>a.indexOf(e)===t)),this.calculateFilterInclude(c,n)):Se.formulaIsNumber(g),b=this.calculateNonAggregatedPart([...o||[],s],c,p),f=Se.formulaSort(b,Se.formulaSequence(1,r+1)),C=this.calculateNonAggregatedPart(o,c,p),y=Se.formulaSort(u,Se.formulaSequence(1,r)),v=t?Se.formulaFilter(h,t):h,x=Se.formulaSortBy(v,m.valueList.map((e=>new X(t?Se.formulaFilter(e,t):e,1)))),T=Se.formulaSort(C,Se.formulaSequence(1,r)),S=Se.formulaFilter(h,p),w=Se.formulaSortBy(S,m.valueList.map((e=>new X(Se.formulaFilter(e,p),1)))),E=Ye.getHelperMatrix(r,u,r),I=t?Se.formulaFilter(g,t):g,R=Se.formulaIndex(f,null,r+1),A=Se.formulaSortBy(Se.formulaSequence(Se.formulaRows(Se.formulaUnique(u))),(o||[]).map(((e,t)=>new X(r>1?Se.formulaIndex(Se.formulaUnique(u),null,t+1):Se.formulaUnique(u),1))));switch(e.exprType){case"sum":return Ye.customSumGroupBy(E,Se.formulaIf(Se.formulaIsNumber(I),I,new d(0)));case"count":return Ye.customCountGroupBy(E,I,!1,!1);case"average":{const e=Ye.customSumGroupBy(E,Se.formulaIf(Se.formulaIsNumber(I),I,new d(0))),t=Ye.customCountGroupBy(E,I,!0,!1);return Ye.customAverageGroupBy(e,t)}case"median":return Se.formulaSortBy(Ye.customMedianGroupBy(r,y,T,R,x,w),[new X(A,1)]);case"min":return Se.formulaSortBy(Ye.customMinMaxGroupBy(r,y,T,R,!1),[new X(A,1)]);case"max":return Se.formulaSortBy(Ye.customMinMaxGroupBy(r,y,T,R,!0),[new X(A,1)]);default:(0,i.x)(e.exprType)}}else if(Ne(s)){if(!s.exprs||0===s.exprs.length)throw Error("invalid arguments");if(1!==s.exprs.length)throw Error("doesn't support more than 1 expression in Distinct Expression");{const e=s.exprs[0];if(Me(e)){const a=Se.formulaUnique(this.calculateNonAggregatedPart([...o||[],e],c,t)),n=Ye.getHelperMatrix(r,a,r+1);return Ye.customCountGroupBy(n,Se.formulaIndex(a,null,r+1),!1,!0)}}}else if(null==s&&"count"===e.exprType){const e=Ye.getHelperMatrix(r,u,r),a=t?Se.formulaFilter(c,t):c,n=Se.formulaSequence(Se.formulaRows(a),1,1,0);return Se.formulaMmult(e,n)}throw new Error("currently not support such expression")}getSubTableWithSeveralColumns(e,t,a){return a&&1===e.length?new l(this.content.getColumnAddress(e[0])):Se.formulaIndex(t,1===e.length?null:Se.formulaSequence(Se.formulaRows(t)),1===e.length?e[0]+1:e.map((e=>e+1)))}static getHelperMatrix(e,t,a){const n=Ye.joinColumnText(e,t,a),o=Se.formulaUnique(n);return new h("+",new g("=",o,Se.formulaTranspose(n),!0),new d(0),!0)}static concatColumns(e,t,a){if(e<2)return t[0];let n=Se.formulaSubstitute(Se.formulaSubstitute(t[a[0]-1],"\\","\\\\"),",","\\,");for(let o=1;o<e;o++)n=new h("&",new h("&",n,new s(",")),Se.formulaSubstitute(Se.formulaSubstitute(t[a[o]-1],"\\","\\\\"),",","\\,"));return n}static joinColumnText(e,t,a){if(e<2)return a<2?t:Se.formulaIndex(t,null,1);let n=Se.formulaSubstitute(Se.formulaSubstitute(Se.formulaIndex(t,null,1),"\\","\\\\"),",","\\,");for(let a=1;a<e;a++)n=new h("&",new h("&",n,new s(",")),Se.formulaSubstitute(Se.formulaSubstitute(Se.formulaIndex(t,null,a+1),"\\","\\\\"),",","\\,"));return n}static customSumGroupBy(e,t){return Se.formulaMmult(e,t)}static customAverageGroupBy(e,t){return new h("/",e,t)}static customCountGroupBy(e,t,a,n){let o;return o=a?new h("+",Se.formulaIsNumber(t),new d(0)):n?Se.formulaSequence(Se.formulaRows(t),1,1,0):new h("-",new d(1),Se.formulaIsBlank(t)),Se.formulaMmult(e,o)}static customMedianGroupBy(e,t,a,n,o,r){const i=e>1?o:Ye.joinColumnText(e,t,e),l=Se.formulaUnique(i),s=e>1?r:Ye.joinColumnText(e,a,e),c=Se.formulaXMatch(l,s,0,1),m=Se.formulaXMatch(l,s,0,[1,-1]),g=Se.formulaMmult(Se.formulaIfError(m,new d(1)),new u([[.5],[.5]])),p=Se.formulaRound(new h("+",new h("*",g,new u([1,1])),new u([0,-.5])),0);return Se.formulaIf(Se.formulaIsNumber(c),Se.formulaMmult(Se.formulaIndex(n,p),new u([[.5],[.5]])),Se.formulaNA())}static customMinMaxGroupBy(e,t,a,n,o){const r=Ye.joinColumnText(e,t),i=Se.formulaUnique(r),l=Ye.joinColumnText(e,a),s=Se.formulaXMatch(i,l,0,1),c=Se.formulaXMatch(i,l,0,-1),u=o?c:s;return Se.formulaIfError(Se.formulaIndex(n,u),new d(0))}calculateWhereCriteria(e){if(Be(e)){if("or"===e.exprType)throw new Error('aggregation-ifs function could only deal with "AND" logic, fall back to custom function');return[...this.calculateWhereCriteria(e.left),...this.calculateWhereCriteria(e.right)]}if(He(e)){if(!Me(e.left)||(!(t=e.right)||!["numberLiteral","stringLiteral","booleanLiteral","dateTimeLiteral"].some((e=>e===t.exprType))))throw new Error("aggregation-ifs function could only deal with comparison of column and literals");const a=new l(this.content.getColumnAddress(e.left.sourceDataReference.left)),n=Ye.calculateLiteralPartInCriteria(e.right,!1),o=Ye.calculateLiteralPartInCriteria(e.right,!0);switch(e.exprType){case"greaterThan":return[new B(a,new D(">",n))];case"greaterThanOrEqual":return[new B(a,new D(">=",n))];case"lessThan":return[new B(a,new D("<",n))];case"lessThanOrEqual":return[new B(a,new D("<=",n))];case"equality":return[new B(a,new D("=",n))];case"contains":return[new B(a,new D("contain",o))];case"startsWith":return[new B(a,new D("startWith",o))];case"endsWith":return[new B(a,new D("endWith",o))];default:throw new Error("unsupported comparison type")}}var t;throw new Error}static calculateLiteralPartInCriteria(e,t){return Ve(e)?"dateTimeLiteral"===e.exprType?Re(e.value):new s(function(e,t){let a=t||e.includes("*")||e.includes("?")?e.replace(/~/g,"~~"):e;return a=a.replace(/\*/g,"~*").replace(/\?/g,"~?"),a}(e.value,t)):Ue(e)?new d(e.value):qe(e)?new c(e.value):(0,i.x)(e)}calculateGroupCriteria(e){const{groupClause:t,whereClause:a}=this.queryResult;let n=new l(this.content.getTableAddress());const o=(t||[]).map((e=>e.sourceDataReference.left+1));if(a){const t=this.calculateFilterInclude(n,a);n=Se.formulaFilter(n,this.includeNumberCheckInFilterCondition(e,t))}if(n=Se.formulaUnique(Se.formulaIndex(n,Se.formulaSequence(Se.formulaRows(n)),o)),1===t.length&&!a){const e=t[0],a=this.content.getColumnAddress(e.sourceDataReference.left);return[new B(new l(a),new h("&",new s("="),Ie(Se.formulaUnique(new l(a)))))]}return t.map(((e,t)=>{const a=e.sourceDataReference.left,o=this.content.getColumnAddress(a);return new B(new l(o),new h("&",new s("="),Se.formulaIndex(Ie(n),null,t+1)))}))}calculateFilterInclude(e,t){if(Be(t))switch(t.exprType){case"and":return new te(this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"or":return new ae(this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));default:(0,i.x)(t)}if($e(t))return new ee(this.calculateFilterInclude(e,t.expr));if(He(t)){if(["startsWith","endsWith","contains"].includes(t.exprType)&&!Ve(t.right))throw new Ae(n.TranslationFailure,"only string literals are supported as the right operator in startWith/endWith/contain.");if(Oe(t.left)&&Oe(t.right))return this.calculateDatePartComparison(t);switch(t.exprType){case"greaterThan":return new g(">",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"greaterThanOrEqual":return new g(">=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"lessThan":return new g("<",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"lessThanOrEqual":return new g("<=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));case"equality":{const a=new g("=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,t.right));return!Ve(t.right)||"true"!==t.right.value.toLowerCase()&&"false"!==t.right.value.toLowerCase()?a:new ae(a,new g("=",this.calculateFilterInclude(e,t.left),this.calculateFilterInclude(e,{exprType:"booleanLiteral",value:"true"===t.right.value.toLowerCase()})))}case"startsWith":return new g("=",Se.formulaIfError(Se.formulaSearch(new s(Ee(t.right.value)),this.calculateFilterInclude(e,t.left)),new d(-1)),new d(1));case"endsWith":return new g("=",Se.formulaIfError(Se.formulaSearch(new s(Ee(t.right.value)),Se.formulaRight(this.calculateFilterInclude(e,t.left),Se.formulaLen(this.calculateFilterInclude(e,t.right)))),new d(-1)),new d(1));case"contains":return Se.formulaIsNumber(Se.formulaSearch(new s(Ee(t.right.value)),this.calculateFilterInclude(e,t.left)));default:(0,i.x)(t)}}if(De(t))return Se.formulaIndex(e,null,this.queryResult.projectClause.findIndex((e=>Ge(e,t)))+1);if(Me(t))return new l(this.content.getColumnAddress(t.sourceDataReference.left));if(Ve(t))return"dateTimeLiteral"===t.exprType?Re(t.value):new s(t.value);if(Ue(t))return new d(t.value);if(qe(t))return new c(t.value);if(Pe(t)){const e=this.content.getColumnAddress(t.columnNameExpr.sourceDataReference.left);return Se.formulaIsNumber(Se.formulaXMatch(new l(e),Se.formulaIndex(new Ye(t.query,this.content).translate(),null,t.query.projectClause.findIndex((e=>Me(e)&&e.sourceDataReference.left===t.columnNameExpr.sourceDataReference.left))+1),0,1))}if(_e(t))return new Ye(t,this.content).translate();throw new Error}constructor(e,t){this.queryResult=e,this.content=t}}var Xe=a(287761),Ze=a(83437),Ke=a(677871),et=a(267324),tt=a(9847),at=a(965634),nt=a(956258),ot=a(906606),rt=a(64292);async function it(e,t,a){const o=t.getTable(e),r=(o?o.getRange():t.getRange(e)).load(["rowIndex","columnIndex","rowCount","columnCount","address"]),i=o?.getHeaderRowRange().load("values"),l=o?.getDataBodyRange().load(["address","rowCount","columnCount"]);await e.sync();const{rowIndex:s,columnIndex:c,rowCount:d,columnCount:u}=r,m=Office.context.platform===Office.PlatformType.OfficeOnline;if(d*u>(m?ze:We))throw new Ae(n.ContentTooLarge,"exceed max supported cell count"+(m?" in XLO":""));const h=l||t.getSheet(e).getRangeByIndexes(s+1,c,d-1,u).load(["address","rowCount","columnCount"]),g=i||t.getSheet(e).getRangeByIndexes(s,c,1,u).load("values"),p=Array(u).fill(0).map(((e,t)=>h.getColumn(t).load(["address","valueTypes"]))),b=e=>{const t=/(^.+!)([a-zA-Z]+)([0-9]+:)([a-zA-Z]+)([0-9]+)$/.exec(e);if(6!==t.length)throw new Error("wrong address structure");return t.map(((e,t)=>t>1?`$${e}`:t>0?e:"")).join("")};return await e.sync(),function(e,t,a){const o=st(e),r=ct(e);if(o.length>0&&r.length>0){if(a.rowCount>je)throw new Ae(n.ContentTooLarge,"exceed max supported row count for queries with aggregation group-by")}else if(o.length>0){if(a.rowCount>Qe)throw new Ae(n.ContentTooLarge,"exceed max supported row count for queries with group-by")}else if(a.rowCount>Je)throw new Ae(n.ContentTooLarge,"exceed max supported row count");t.forEach((e=>{if(e.valueTypes.filter((e=>e.some((e=>e===Excel.RangeValueType.error||e===Excel.RangeValueType.richValue||e===Excel.RangeValueType.unknown)))).length>0)throw new Ae(n.ValidationIssue,"errors or rich values or unknown values in source are not supported")})),r.map((e=>e.index)).filter(((e,t,a)=>a.indexOf(e)===t)).forEach((e=>{if(t[e].valueTypes.filter((e=>e.some((e=>e===Excel.RangeValueType.string||e===Excel.RangeValueType.empty)))).length>0)throw new Ae(n.ValidationIssue,"strings or blanks in aggregated columns are not supported")})),o.forEach((e=>{const a=t[e].valueTypes.every((e=>e.some((e=>e===Excel.RangeValueType.double||e===Excel.RangeValueType.integer)))),o=t[e].valueTypes.every((e=>e.some((e=>e===Excel.RangeValueType.string))));if(!a&&!o)throw new Ae(n.ValidationIssue,"only support all numbers or all strings in group column")}))}(a,p,h),new Fe(!1,p.map(((e,a)=>{return{index:a,columnName:String(g.values[0][a]),columnAddress:o?(n=t.tableName,r=g.values[0][a],`${n}[${r.replace(/'/g,"''").replace(/#/g,"'#").replace(/\[/g,"'[").replace(/\]/g,"']").replace(/@/g,"'@")}]`):b(e.address),columnIndex:c+a,rowStartIndex:s+1,rowEndIndex:s+d-1};var n,r})),o?t.tableName:b(h.address))}function lt(e){const{whereClause:t,projectClause:a,havingClause:n,groupClause:o}=e;return[...[...a,...o||[]].filter((e=>Oe(e)&&Me(e.source))).map((e=>e.source.sourceDataReference.left)),...t?mt(t):[],...t?mt(n):[]].filter(((e,t,a)=>a.indexOf(e)===t))}function st(e){const{whereClause:t,groupClause:a,havingClause:n}=e;return[...a?a.filter((e=>Me(e))).map((e=>e.sourceDataReference.left)):[],...t?dt(t):[],...n?dt(n):[]].filter(((e,t,a)=>a.indexOf(e)===t))}function ct(e){const{projectClause:t,whereClause:a,havingClause:n,sortClause:o}=e;return[...t.filter((e=>De(e)&&Me(e.expr))).map((e=>({index:e.expr.sourceDataReference.left,aggregationType:e.exprType}))),...o?o.filter((e=>De(e.expr)&&Me(e.expr.expr))).map((e=>({index:e.expr.expr.sourceDataReference.left,aggregationType:e.expr.exprType}))):[],...a?ut(a):[],...n?ut(n):[]].filter(((e,t,a)=>a.findIndex((t=>t.index===e.index&&t.aggregationType===e.aggregationType))===t))}function dt(e){const t=ht(e);let a=[];return t.forEach((e=>{a=[...a,...st(e)]})),a}function ut(e){const t=ht(e);let a=[];return t.forEach((e=>{a=[...a,...ct(e)]})),a}function mt(e){return e?.exprType?Be(e)?[...mt(e.left),...mt(e.right)]:$e(e)?mt(e.expr):He(e)?[...mt(e.left),...mt(e.right)]:Pe(e)?lt(e.query):_e(e)?lt(e):Oe(e)&&Me(e.source)?[e.source.sourceDataReference.left]:[]:[]}function ht(e){return e?.exprType?Be(e)?[...ht(e.left),...ht(e.right)]:$e(e)?ht(e.expr):He(e)?[...ht(e.left),...ht(e.right)]:Pe(e)?[e.query]:_e(e)?[e]:[]:[]}var gt=a(390624),pt=a(357781),bt=a(919654),ft=a(471742),Ct=a(528804),yt=a(590572),vt=a(162134),xt=a(71475),Tt=a(388435),St=a(880496),wt=a(553482),Et=a(270750),It=a(750927),Rt=a(601301),At=a(777179),Lt=a(824737);const kt=8;function Ft(e,t,a){!function(e,t,a){const n=t.title;if(!1===a?.title?.visible)return void(e.title.visible=!1);if(a?.title?.text)return void(e.title.text=a.title.text);if(void 0===n)return;!function(e,t){const a=t.title;if(!a)throw new Error("Unsupported title type.");const n=255;let o=!1;e.title.text=Pt(a,n,(()=>{o=!0}));let r=0;const i=o?n-1:n;a.runs.every((t=>{const a=Math.min(t.text.length,i-r);if(null!=t.highlightStyleIndex&&a>0){e.title.getSubstring(r,a).font.color=Et.vA[t.highlightStyleIndex]}return r+=t.text.length,r<=i}))}(e,t)}(e,t,a),function(e,t,a){!function(e,t,a){const n=t.series,o=n.length,r=n.some((e=>"secondary"===e.valueAxisGroup)),i=n.some((e=>null!=e.highlightStyleIndex));n.forEach(((t,n)=>{const l=e.series.getItemAt(n),{hasDoughnutHoleSize:s,hasGapWidth:c,hasDataMarkers:d,hasSeriesOverlap:u,isClustered:m}=(0,Lt.Y)(t.layout),h=!!t.highlightedLineSegments&&t.highlightedLineSegments.length>0,g=t.exceptions&&t.exceptions.length>0,p=(0,vt.Pg)(t.layout);!(0,vt.iZ)(p.excelType)&&r&&(l.chartType=p.excelType);"secondary"===t.valueAxisGroup&&(l.axisGroup=Excel.AxisGroup.secondary),h&&(l.format.line.color=Et.Zx),i&&function(e,t){const{hasDataMarkers:a,isLine:n}=(0,Lt.Y)(t.layout),o=null!=t.highlightStyleIndex?Et.hr[t.highlightStyleIndex]:Et.wm;a?(e.markerBackgroundColor=o,e.markerForegroundColor=Et.ON):n?e.format.line.color=o:e.format.fill.setSolidColor(o)}(l,t),g&&function(e,t){const{hasDataMarkers:a,isLine:n}=(0,Lt.Y)(t.layout);a?e.markerBackgroundColor=Et.Zx:n?e.format.line.color=Et.Zx:e.format.fill.setSolidColor(Et.Zx)}(l,t),s&&(l.doughnutHoleSize=Et.Az),c&&(l.gapWidth=m&&o>1?Math.min(Et.tF+o*Et.P6,500):Et.BC),d&&(l.markerStyle=Excel.ChartMarkerStyle.circle,l.markerSize=Et.Qi,l.markerForegroundColor=Et.ON),l.hasDataLabels=a?.series?.[n]?.dataLabels?.visible??!1;u&&!r&&(l.overlap=Et.z8)}))}(e,t,a)}(e,t,a),function(e,t,a){const n=t.series,o=n.some((e=>null!=e.highlightStyleIndex));n.forEach(((t,n)=>{if(t.trendlines&&t.trendlines.length>0){if("linear"===t.trendlines[0].trendType){const r=t.exceptions&&t.exceptions.length>0,i=e.series.getItemAt(n).trendlines.add(Excel.TrendlineType.linear);i.format.line.lineStyle=Excel.ChartLineStyle.roundDot,o&&(null!=t.highlightStyleIndex?i.format.line.color=Et.hr[t.highlightStyleIndex]:i.format.line.color=Et.wm),r&&(i.format.line.color=Et.Zx),null!=a?.series?.[n]?.trendline?.showEquation&&(i.showEquation=a.series[n]?.trendline?.showEquation??!1)}}}))}(e,t,a),function(e,t,a){const n=t.series.length,o=t.series[0],r=o.exceptions&&o.exceptions.length>0,i=(0,vt.Pg)(o.layout).hasCategoryLegend,l=null!=a?.legend?.visible?a.legend.visible:n>1||i&&!r;e.legend.visible=l,l&&(e.legend.position=n<=kt?Excel.ChartLegendPosition.bottom:Excel.ChartLegendPosition.right)}(e,t,a),function(e,t,a){if(!t.axes)return;(function(e,t){const a=(0,vt.ip)(t);t.axes.forEach((t=>{if(t.reversePlotOrder){const n=t.dimensionType,o="secondary"===t.axisGroup&&a.secondary?a.secondary.insightsType:a.primary.insightsType,r=(0,Rt.C$)(o,n),i=e.axes.getItem(r.excelAxisType,Nt(t.axisGroup));i.crosses=Excel.AxisCrosses.maximum,i.reversePlotOrder=!0}}))})(e,t),function(e,t,a){const n=(0,vt.ip)(t);t.axes.forEach((t=>{const o=t.title;if(o){const r=t.dimensionType,i="secondary"===t.axisGroup&&n.secondary?n.secondary.insightsType:n.primary.insightsType,l=(0,Rt.C$)(i,r),s=e.axes.getItem(l.excelAxisType,Nt(t.axisGroup));s.title.text=Pt(o,255),l.excelAxisType===Excel.AxisType.category&&"primary"===t.axisGroup?(a?.primaryCategoryAxis?.title?.text&&(s.title.text=a.primaryCategoryAxis.title.text),null!=a?.primaryCategoryAxis?.title?.visible&&(s.title.visible=a.primaryCategoryAxis.title.visible)):l.excelAxisType===Excel.AxisType.value&&"primary"===t.axisGroup&&(a?.primaryValueAxis?.title?.text&&(s.title.text=a.primaryValueAxis.title.text),null!=a?.primaryValueAxis?.title?.visible&&(s.title.visible=a.primaryValueAxis.title.visible))}}))}(e,t,a),function(e,t){const a=(0,vt.ip)(t),n=a.secondary?a.primary.positionAxisOnTick&&a.secondary.positionAxisOnTick:a.primary.positionAxisOnTick;Office.context.requirements.isSetSupported("ExcelApi","1.8")&&n&&(e.axes.categoryAxis.isBetweenCategories=!1)}(e,t),function(e,t,a){if(null==a?.primaryCategoryAxis?.minimum&&null==a?.primaryCategoryAxis?.maximum&&null==a?.primaryValueAxis?.minimum&&null==a?.primaryValueAxis?.maximum)return;const n=(0,vt.ip)(t);t.axes.forEach((t=>{const o="secondary"===t.axisGroup&&n.secondary?n.secondary.insightsType:n.primary.insightsType,r=t.dimensionType,i=(0,Rt.C$)(o,r),l=e.axes.getItem(i.excelAxisType,Nt(t.axisGroup));i.isValue&&"primary"===i.axisGroup&&(i.excelAxisType===Excel.AxisType.category&&(null!=a.primaryCategoryAxis?.minimum&&(l.minimum=a.primaryCategoryAxis.minimum),null!=a.primaryCategoryAxis?.maximum&&(l.maximum=a.primaryCategoryAxis.maximum)),i.excelAxisType===Excel.AxisType.value&&(null!=a.primaryValueAxis?.minimum&&(l.minimum=a.primaryValueAxis.minimum),null!=a.primaryValueAxis?.maximum&&(l.maximum=a.primaryValueAxis.maximum)))}))}(e,t,a)}(e,t,a);(0,vt.ip)(t).primary.excelType===Excel.ChartType.histogram?function(e,t){if(1!==t.series.length)return;const a=e.series.getItemAt(0);a.format.fill.setSolidColor(Et.w8);const n=t.series[0].binOptions;n&&(n.usingBinCount?(a.binOptions.type=Excel.ChartBinType.binCount,a.binOptions.count=n.binCount):(a.binOptions.type=Excel.ChartBinType.binWidth,a.binOptions.width=n.binWidth),n.overflow&&(a.binOptions.overflowValue=n.overflow),n.underflow&&(a.binOptions.underflowValue=n.underflow),a.gapWidth=Et.Wx);e.axes.valueAxis.majorGridlines.visible=!0}(e,t):function(e,t,a){if(!a)return;const n=(0,vt.ip)(t);t.axes.forEach((t=>{const o=t.dimensionType,r="secondary"===t.axisGroup&&n.secondary?n.secondary.insightsType:n.primary.insightsType,i=(0,Rt.C$)(r,o),l=e.axes.getItem(i.excelAxisType,Nt(t.axisGroup));i.excelAxisType===Excel.AxisType.category&&"primary"===t.axisGroup&&null!=a.primaryCategoryAxis?.majorGridlines?.visible?l.majorGridlines.visible=a.primaryCategoryAxis.majorGridlines.visible:i.excelAxisType===Excel.AxisType.value&&"primary"===t.axisGroup&&null!=a.primaryValueAxis?.majorGridlines?.visible&&(l.majorGridlines.visible=a.primaryValueAxis.majorGridlines.visible)}))}(e,t,a)}function _t(e,t,a){!function(e,t){const a=t.series;a.forEach(((t,a)=>{const n=e.series.getItemAt(a);t.exceptions&&t.exceptions.length>0&&function(e,t){const{hasDataMarkers:a,isLine:n}=(0,Lt.Y)(t.layout);t.exceptions.forEach((t=>{const o=e.points.getItemAt(t);n||a?(o.markerStyle=Excel.ChartMarkerStyle.circle,o.markerSize=Et.Qi,o.markerBackgroundColor=Et.SB,o.markerForegroundColor=Et.ON):o.format.fill.setSolidColor(Et.SB)}))}(n,t),(0,o.o_)(t,["highlightedLineSegments"])&&t.highlightedLineSegments.length>0&&function(e,t){t.highlightedLineSegments.forEach((a=>{const n=e.points.getItemAt(a+1),o=null!=t.highlightStyleIndex?t.highlightStyleIndex:0;n.format.border.color=Et.hr[o],n.format.border.weight=Et.D9}))}(n,t)})),function(e,t){const a=t.series,n=(o=a,o.every((e=>e.dataBindings.some((e=>"title"===e.dimensionType)))));var o;a.forEach(((a,o)=>{const r=e.series.getItemAt(o),i=a.title;if(!i)return;const l=(0,vt.ip)(t);(0,vt.iZ)(l.primary.excelType)||l.secondary&&(0,vt.iZ)(l.secondary.excelType)||n||(r.name=Pt(i,255))}))}(e,t)}(e,t),function(e,t){if(Office.context.requirements.isSetSupported("ExcelApi","1.9")){const a=t.title,n=a?(0,yt.HW)(a):"",o=(0,vt.ip)(t),r=o.secondary?(0,It.L)((0,et.$0s)(),o.primary.localizedName,o.secondary.localizedName):o.primary.localizedName,i=`${(0,It.L)((0,et.eZ0)(),r)} ${n}`,l=(0,et.AXy)();e.worksheet.shapes.getItem(e.id).altTextDescription=`${i}\n\n${l}`}}(e,t);const n=function(e,t,a){if(!t.axes)return()=>{};const n=function(e,t){const a=(0,vt.ip)(t),n=t.axes.filter((e=>!!e.linearValueScale&&"includeZero"===e.linearValueScale.zeroPolicy)).map((t=>{const n=t.dimensionType,o="secondary"===t.axisGroup&&a.secondary?a.secondary.insightsType:a.primary.insightsType,r=(0,Rt.C$)(o,n);return e.axes.getItem(r.excelAxisType,Nt(t.axisGroup)).load(["minimum","maximum"])}));return()=>{n.forEach((e=>{Math.sign(e.minimum)===Math.sign(e.maximum)&&(e.minimum>0?e.minimum=0:e.maximum=0)}))}}(e,t),o=function(e,t){const a=(0,vt.ip)(t);return()=>{t.axes.forEach((n=>{const o="secondary"===n.axisGroup&&a.secondary?a.secondary.insightsType:a.primary.insightsType;if("histogram"===o||"areaStacked100"===o||"barStacked100"===o||"columnStacked100"===o||"lineStacked100"===o)return;const r=n.dimensionType,l=(0,Rt.C$)(o,r);if(l.isValue){const a=(0,At.r)(t,r,n.axisGroup);if(!a)return;const o=e.axes.getItem(l.excelAxisType,Nt(n.axisGroup)),s=(0,wt.wM)(a.min,a.max);if(!s)return void(o.displayUnit=Excel.ChartAxisDisplayUnit.none);const c=s.languageUnitsValue;switch(c){case wt.YO.Thousands:o.displayUnit=Excel.ChartAxisDisplayUnit.thousands;break;case wt.YO.Millions:o.displayUnit=Excel.ChartAxisDisplayUnit.millions;break;case wt.YO.Billions:o.displayUnit=Excel.ChartAxisDisplayUnit.billions;break;case wt.YO.Trillions:o.displayUnit=Excel.ChartAxisDisplayUnit.trillions;break;case wt.YO.None:o.displayUnit=Excel.ChartAxisDisplayUnit.none;break;default:(0,i.c)(c)}}}))}}(e,t),r=function(e,t,a){const n=(0,vt.ip)(t),o=[...(0,Rt.lf)(n.primary.insightsType)];if(n.secondary){const e=(0,Rt.C$)(n.secondary.insightsType,"values");e&&o.push(e)}const r=o.map(((t,a)=>t.isValue?{valueAxis:n.secondary&&a===o.length-1?e.axes.getItem(t.excelAxisType,Excel.ChartAxisGroup.secondary).load(["minimum","maximum"]):e.axes.getItem(t.excelAxisType,Excel.ChartAxisGroup.primary).load(["minimum","maximum"]),crossingAxis:n.secondary&&a===o.length-1?void 0:e.axes.getItem(o[1-a].excelAxisType)}:null)).filter((e=>null!==e));return()=>{if(2===o.length||3===o.length){if(r.forEach((e=>{const t=e.valueAxis.maximum>0,a=e.valueAxis.minimum<0;a&&!t&&(e.valueAxis.position=Excel.ChartAxisPosition.maximum),a&&t&&e.crossingAxis&&(e.crossingAxis.tickLabelPosition=Excel.AxisTickLabelPosition.low)})),!1===a?.primaryCategoryAxis?.tickLabel?.visible){e.axes.getItem(Excel.AxisType.category,Excel.AxisGroup.primary).tickLabelPosition=Excel.AxisTickLabelPosition.none}if(!1===a?.primaryValueAxis?.tickLabel?.visible){e.axes.getItem(Excel.AxisType.value,Excel.AxisGroup.primary).tickLabelPosition=Excel.AxisTickLabelPosition.none}}}}(e,t,a);return()=>{n(),o(),r()}}(e,t,a);return()=>{n()}}function Pt(e,t=-1,a){const n=e.runs.map((e=>e.text)).join("");return n.length<=t||-1===t?n:(a&&a(),`${n.slice(0,t-1)}`)}function Nt(e){if(void 0!==e)switch(e){case"primary":return Excel.AxisGroup.primary;case"secondary":return Excel.AxisGroup.secondary;default:(0,i.c)(e)}}var Mt=a(507628);const Ot=250,Dt=250;function Bt(e,t,a){const n=a.indexOf("!"),o=a.lastIndexOf(":");if(-1!==n&&o>n){const r=e.getRange(a.substring(n+1,o)),i=e.getRange(a.substring(o+1));t.setPosition(r,i)}else t.setPosition(a)}async function $t(e,t,a,n,o){const r=a.getSheet(e),i=await async function(e,t,a,n,o,r){const i=(0,vt.ip)(t);if((0,vt.iZ)(i.primary.excelType)||i.secondary&&(0,vt.iZ)(i.secondary.excelType)){const i=await function(e,t,a,n){return async o=>{const r=(0,vt.ip)(e),i=e.data;if(1!==e.series.length)return Promise.reject(new Error("Ivy Chart contains incorrect series."));const l=e.series[0];if(1!==l.dataBindings.length)return Promise.reject(new Error("Ivy Chart contains incorrect dataBindings."));const s=l.dataBindings[0];if("values"!==s.dimensionType)return Promise.reject(new Error("Unrecognized dimension type."));const c=Ut(i,s.dimensionId),d=t.getRangeFromReferences(o,c.references);Office.context.platform===Office.PlatformType.OfficeOnline&&d.getCell(0,0).select();const u=a.charts.add(r.primary.excelType,d);u.top=Ot,u.left=Dt,Ft(u,e,n);const m=(0,Mt.A)();o.trace(m);const h=(0,xt.U)((()=>u.delete()),m);a.load("name"),u.load(["name","id"]);try{await o.sync()}catch(e){await h(e)}const g=e=>(e.workbook.worksheets.getItem(a.name).charts.getItem(u.name).delete(),e.sync());return await o.sync(),{result:u,undo:g}}}(t,a,o,r)(e);return n.push(i.undo),i.result}{const i=await function(e,t){return async a=>{const n=(0,Tt.wZ)(t);await a.sync();const o=(0,vt.ip)(e),r=n()||t.getCell(0,0),i=t.charts.add(o.primary.excelType,r);i.top=Ot,i.left=Dt;const l=(0,Mt.A)();a.trace(l);const s=(0,xt.U)((()=>i.delete()),l);i.series.load("count"),t.load("name"),i.load(["name","id"]);try{await a.sync()}catch(e){await s(e)}const c=e=>(e.workbook.worksheets.getItem(t.name).charts.getItem(i.name).delete(),e.sync());for(let e=i.series.count-1;e>=0;e--)i.series.getItemAt(e).delete();return await a.sync(),{result:i,undo:c}}}(t,o)(e);return n.push(i.undo),async function(e,t,a,n,o){const r=a.data,i=a.series,l=[];i.forEach((()=>{t.series.add()})),Ft(t,a,o),i.forEach(((a,o)=>{const i=t.series.getItemAt(o);a.dataBindings.forEach((t=>{const a=Ut(r,t.dimensionId),s=n.getRangeFromReferences(e,a.references);switch(t.dimensionType){case"values":case"yValues":i.setValues(s);break;case"categories":case"xValues":i.setXAxisValues(s);break;case"title":s.load("address"),l.push({index:o,range:s});break;default:throw new Error("Unrecognized dimension type.")}}))})),0!==l.length&&await e.sync();return l.forEach((e=>{t.series.getItemAt(e.index).name=`=${e.range.address}`})),t}(e,i.result,t,a,r)}}(e,t,a,n,r,o),l=_t(i,t,o);return i.worksheet.load("name"),await e.sync(),l(),i.activate(),i}async function Ht(e,t,a){const n=[];a.forEach((t=>{const a=(0,St.dn)(e,t.destination);n.push({visualChart:t.visualChart,dataProvider:t.dataProvider,insertionSheet:a,chartConfig:t.chartConfig,destination:t.destination})}));const o=await async function(e,t,a){const n=Array(a.length),o=[],r=[],i=[],l=[];for(let e=0;e<a.length;++e){const t=a[e],n=(0,vt.ip)(t.visualChart);(0,vt.iZ)(n.primary.excelType)||n.secondary&&(0,vt.iZ)(n.secondary.excelType)?(o.push(t),r.push(e)):(i.push(t),l.push(e))}if(o.length>0){const a=await function(e){return async t=>{const a=[],n=[];for(const o of e){const e=(0,vt.ip)(o.visualChart),r=o.visualChart.data;if(1!==o.visualChart.series.length)return Promise.reject(new Error("Ivy Chart contains incorrect series."));const i=o.visualChart.series[0];if(1!==i.dataBindings.length)return Promise.reject(new Error("Ivy Chart contains incorrect dataBindings."));const l=i.dataBindings[0];if("values"!==l.dimensionType)return Promise.reject(new Error("Unrecognized dimension type."));const s=Ut(r,l.dimensionId),c=o.dataProvider.getRangeFromReferences(t,s.references),d=o.insertionSheet.charts.add(e.primary.excelType,c);Bt(o.insertionSheet,d,o.destination),Ft(d,o.visualChart,o.chartConfig),o.insertionSheet.load("name"),d.load(["name","id"]),a.push(d);const u=(0,Mt.A)();t.trace(u),n.push(u)}try{await t.sync()}catch(e){for(let e=0;e<a.length;++e)(0,xt.U)((()=>a[e].delete()),n[e])}const o=t=>{for(let n=0;n<a.length;++n){t.workbook.worksheets.getItem(e[n].insertionSheet.name).charts.getItem(a[n].name).delete()}return t.sync()};return await t.sync(),{result:a,undo:o}}}(o)(e);t.push(a.undo);const i=a.result;for(let e=0;e<i.length;++e)n[r[e]]=i[e]}if(i.length>0){const a=[];for(let e=0;e<i.length;++e)a.push({visualChart:i[e].visualChart,insertionSheet:i[e].insertionSheet,destination:i[e].destination});const o=await function(e){return async t=>{const a=[];e.forEach((e=>{const t=(0,Tt.wZ)(e.insertionSheet);a.push(t)})),await t.sync();const n=[],o=[];for(let r=0;r<e.length;++r){const i=e[r],l=(0,vt.ip)(i.visualChart),s=(0,a[r])()||i.insertionSheet.getCell(0,0),c=i.insertionSheet.charts.add(l.primary.excelType,s);Bt(i.insertionSheet,c,i.destination),c.series.load("count"),i.insertionSheet.load("name"),c.load(["name","id"]),n.push(c);const d=(0,Mt.A)();t.trace(d),o.push(d)}try{await t.sync();const a=t=>{for(let a=0;a<n.length;++a){t.workbook.worksheets.getItem(e[a].insertionSheet.name).charts.getItem(n[a].name).delete()}return t.sync()};return n.forEach((e=>{for(let t=e.series.count-1;t>=0;t--)e.series.getItemAt(t).delete()})),await t.sync(),{result:n,undo:a}}catch(e){for(let e=0;e<n.length;++e)(0,xt.U)((()=>n[e].delete()),o[e]);throw e}}}(a)(e);t.push(o.undo);const r=[];for(let e=0;e<i.length;++e)r.push({chart:o.result[e],visualChart:i[e].visualChart,dataProvider:i[e].dataProvider,chartConfig:i[e].chartConfig});const s=await async function(e,t){const a=[],n=[];for(let o=0;o<t.length;++o){const r=t[o],i=r.visualChart.data,l=r.visualChart.series;for(let e=0;e<l.length;++e)r.chart.series.add();Ft(r.chart,r.visualChart,r.chartConfig),l.forEach(((t,a)=>{const l=r.chart.series.getItemAt(a);t.dataBindings.forEach((t=>{const s=Ut(i,t.dimensionId),c=r.dataProvider.getRangeFromReferences(e,s.references);switch(t.dimensionType){case"values":case"yValues":l.setValues(c);break;case"categories":case"xValues":l.setXAxisValues(c);break;case"title":c.load("address"),n.push({chartIndex:o,seriesIndex:a,range:c});break;default:throw new Error("Unrecognized dimension type.")}}))})),a.push(r.chart)}0!==n.length&&await e.sync();return n.forEach((e=>{a[e.chartIndex].series.getItemAt(e.seriesIndex).name=`=${e.range.address}`})),a}(e,r);for(let e=0;e<s.length;++e)n[l[e]]=s[e]}return n}(e,t,n),r=[];for(let e=0;e<o.length;++e){const t=_t(o[e],n[e].visualChart,n[e].chartConfig);r.push(t)}return await e.sync(),r.forEach((e=>{e()})),o}function Ut(e,t){const a=e.dimensions.find((e=>e.id===t));if(void 0===a)throw new Error("Cannot find dimension by id.");return a}function qt(e,t,a,n,o,r){const i=t.length>0?t[0].length:0;if(r>0&&i>0){const l=e.getRangeByIndexes(n,o,r,i);l.numberFormat=t.slice(0,r),l.numberFormatLocal=a.slice(0,r)}for(let l=0;l<i;l++){const i=t.slice(r).map((e=>[e[l]])),s=a.slice(r).map((e=>[e[l]]));let c=0;for(let t=0;t<=i.length;t++)if(t===i.length&&i.length>=1||0!==t&&i[t-1][0]!==i[t][0]){const a=e.getRangeByIndexes(n+r+c,o+l,t-c,1);a.numberFormat=i.slice(c,c+1),a.numberFormatLocal=s.slice(c,c+1),c=t}}}function Vt(e,t,a,n,o,r,i){const l=function(e,t,a,n,o,r,i){const l=t.length,s=l>0?t[0].length:0,c=e.getRangeByIndexes(o,r,l,s);return c.values=t,qt(e,a,n,o,r,i),c}(e,t,a,n,o,r,i);l.format.autofitColumns();const s=e.tables.add(l,!0),c=e.id;return{result:s,undo:async e=>{e.workbook.worksheets.getItem(c).tables.getItemAt(0).delete()}}}const Gt=1,Wt=0,zt="A";var jt=a(534537),Qt=a(805027);function Jt(e,t){const{is29Feb1900:a,adjustedRaw:n,date:o}=(0,Qt.f9)(e);if(Number.isNaN(o.getDay()))return n.toString();const r=o.getFullYear().toString(),l=o.getMonth(),s=function(e){switch(e){case 0:return(0,et.DIE)();case 1:return(0,et.Fsb)();case 2:return(0,et.KBQ)();case 3:return(0,et.ds$)();case 4:return(0,et.I53)();case 5:return(0,et.pRP)();case 6:return(0,et.jpr)();case 7:return(0,et.sY1)();case 8:return(0,et.sGO)();case 9:return(0,et.NeW)();case 10:return(0,et.JGR)();case 11:return(0,et.kTv)();default:throw new Error(`invalid month in date part month grouping, month = ${e}`)}}(l),c=function(e){switch(Math.floor(e/3)){case 0:return(0,et.vKl)();case 1:return(0,et.CNP)();case 2:return(0,et.v$B)();case 3:return(0,et.C2X)();default:throw new Error(`invalid month in date part quarter grouping, month = ${e}`)}}(l),d=a?"29":o.getDate().toString();switch(t){case Excel.PivotTableDateGroupBy.bySeconds:case Excel.PivotTableDateGroupBy.byMinutes:case Excel.PivotTableDateGroupBy.byHours:case Excel.PivotTableDateGroupBy.byDays:return`${d}-${s}`;case Excel.PivotTableDateGroupBy.byMonths:return s;case Excel.PivotTableDateGroupBy.byQuarters:return`Qtr${c}`;case Excel.PivotTableDateGroupBy.byYears:return r;case Excel.PivotTableDateGroupBy.invalid:return"";default:return(0,i.x)(t)}}function Yt(e,t,a){const n=function(e,t,a){const n=new Map,o=new Map;if(t.filterFields.forEach((t=>{const r=t.datePart;if(r){const i=[],l=a.get(t.name)||t.name;Xt(r.datePartOverride).forEach((t=>{const a=e.hierarchies.getItem(l).fields.getItem(l),n=e.addDateGroup(a,t);n.load("name"),i.push(n);const s=r.values.map((e=>Jt(e,t)));o.set(n,s)})),i.length>0&&n.set(t,i)}})),0===n.size)return;const r=e=>{const t=[];return e.forEach((e=>{const a=n.get(e);a?a.forEach((e=>{t.push({name:e.name,datePart:void 0,values:o.get(e)||[]})})):t.push(e)})),t};return()=>({...t,filterFields:r(t.filterFields)})}(e,t,a),o=function(e,t,a){const n=new Map;if(t.rowFields.concat(t.columnFields).forEach((t=>{if(t.datePartOverride){const o=[],r=a.get(t.name)||t.name;Xt(t.datePartOverride).forEach((t=>{const a=e.hierarchies.getItem(r).fields.getItem(r),n=e.addDateGroup(a,t);n.load("name"),o.push(n)})),o.length>0&&n.set(t,o)}})),0===n.size)return;const o=e=>{const t=[];return e.forEach((e=>{const a=n.get(e);a?a.forEach((a=>{t.push({...e,name:a.name,datePartOverride:void 0})})):t.push(e)})),t};return()=>({...t,rowFields:o(t.rowFields),columnFields:o(t.columnFields)})}(e,t,a);if(n||o)return()=>{const e=n?n():t,a=o?o():t;return{...t,filterFields:e.filterFields,rowFields:a.rowFields,columnFields:a.columnFields}}}function Xt(e){switch(e){case"year":case"quarter":return[Excel.PivotTableDateGroupBy.byYears];case"yearAndQuarter":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byQuarters];case"yearAndMonth":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths];case"month":return[Excel.PivotTableDateGroupBy.byMonths];case"date":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths,Excel.PivotTableDateGroupBy.byDays];case"dateAndHour":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths,Excel.PivotTableDateGroupBy.byDays,Excel.PivotTableDateGroupBy.byHours];case"dateHourAndMinute":return[Excel.PivotTableDateGroupBy.byYears,Excel.PivotTableDateGroupBy.byMonths,Excel.PivotTableDateGroupBy.byDays,Excel.PivotTableDateGroupBy.byHours,Excel.PivotTableDateGroupBy.byMinutes];default:return[]}}const Zt={rowFields:[],columnFields:[],filterFields:[],dataFields:[],valueFilters:[],labelFilters:[],dateFilters:[],highlightCellReferences:[]};async function Kt(e,t,a){const n=[];a.forEach((e=>{n.push({visualPivotTable:e.visualPivotTable,dataProvider:e.dataProvider,interpretation:e.interpretation})}));const o=function(e,t){const a=e.workbook.pivotTables,n=e.workbook.worksheets.getActiveWorksheet().protection.load("protected"),o=[];t.forEach((t=>{const a=t.dataProvider.getTopLeftCell(e).load(["rowIndex","columnIndex"]);o.push(a)})),a.load({name:!0,worksheet:{id:!0,protection:{protected:!0}}});const i=[];return t.forEach((t=>{let a=null;t.dataProvider.tableName&&(a=e.workbook.worksheets.getItem(t.dataProvider.sheetId).tables.getItemOrNullObject(t.dataProvider.tableName)),i.push(a)})),e=>async l=>{const s=a.items.filter((e=>e.worksheet.protection.protected));if(n.protected&&Office.context.platform!==Office.PlatformType.OfficeOnline)throw new r.u(r.O.InsertionFailedCurrentWorksheetProtected);if(s.length>0&&Office.context.requirements.isSetSupported("ExcelApi","1.15")){const e=s.map((e=>({type:e.getDataSourceType(),sourceString:e.getDataSourceString()})));await a.context.sync();const n=e.map((e=>({type:e.type.value,sourceString:e.sourceString.value})));t.forEach((e=>{if(n.filter((t=>t.sourceString.length>0&&(t.type===Excel.DataSourceType.localTable&&t.sourceString===e.dataProvider.tableName||t.type===Excel.DataSourceType.localRange&&t.sourceString===`${e.dataProvider.sheetName}!${e.dataProvider.address}`))).length>0)throw new r.u(r.O.InsertionFailedPivotCacheProtected)}))}const c=new Set(a.items.map((e=>e.name)));let d=1;const u=[],m=[],h=[];for(let n=0;n<e.length;++n){const r=i[n],s=t[n],g=e[n],p=o[n],b=!r||r.isNullObject?va(l,s.interpretation,s.dataProvider,p):r;let f;do{f=(0,It.L)(et.olU.InsertedPivotTableName,d.toString()),++d}while(c.has(f));c.add(f),h.push(f);const C=a.add(f,b,g),y=new Map,v=oa(C,s.visualPivotTable,y);ia(C,s.visualPivotTable,v,y),C.refresh(),Office.context.requirements.isSetSupported("TableStyle","1.1")&&C.layout.setStyle("PivotStyleLight16"),u.push(C);const x=(0,Mt.A)();l.trace(x),m.push(x)}await l.sync();const g=e=>{for(let t=0;t<u.length;++t){const a=e.workbook.pivotTables.getItem(h[t]),n=Office.context.requirements.isSetSupported("ExcelApi","1.9")&&Office.context.platform!==Office.PlatformType.OfficeOnline,o=e.workbook.worksheets.getActiveWorksheet();n&&(e.application.suspendScreenUpdatingUntilNextSync(),a.worksheet.activate()),a.delete(),n&&o.activate()}return e.sync()},p=[];for(let e=0;e<u.length;++e)p.push({pivotTable:u[e],hierarchyNameMap:new Map});return{result:p,undo:g}}}(e,n),i=[];for(let t=0;t<a.length;++t){const n=a[t];i.push((0,St.dn)(e,n.destination).getRange((0,St.gx)(n.destination)))}await e.sync();const l=await o(i)(e);t.push(l.undo);const s=[];let c=!1;for(let e=0;e<l.result.length;++e){const t=a[e],n=Yt(l.result[e].pivotTable,t.visualPivotTable,l.result[e].hierarchyNameMap);n&&(c=!0),s.push(n)}c&&await e.sync();const d=[];for(let e=0;e<l.result.length;++e){const t=a[e],n=s[e];n&&(t.visualPivotTable=n());const o=aa(l.result[e].pivotTable,t.visualPivotTable,l.result[e].hierarchyNameMap);d.push(o)}await e.sync(),d.forEach((e=>{e()}));const u=[];return l.result.forEach((e=>{e.pivotTable.load({name:!0,worksheet:{id:!0}}),u.push(e.pivotTable)})),u}async function ea(e,t,a,n,o,r,i){const l=await async function(e,t,a,n,o){const r=ta(e,a,o);await e.sync();const i=await(0,St.oc)(e,n),l=await r(i.getCell(ya(t),0))(e);n.push(l.undo);const s=l.result.pivotTable,c=Yt(s,t,l.result.hierarchyNameMap);let d=t;c&&(await e.sync(),d=c());const u=na(s,d,l.result.hierarchyNameMap);return await e.sync(),u(),s}(e,t,n,o,r),s=await function(e,t,a){return async n=>{const o=(0,vt.ip)(t).primary,r=e.layout.getRange(),i=e.worksheet,l=r.getColumnsAfter(2).getEntireColumn().getCell(3,1);l.select();const s=i.charts.add(o.excelType,l);s.setPosition(l),s.setData(r),s.showAllFieldButtons=!1,Ft(s,t,a);const c=(0,Mt.A)();n.trace(c);const d=(0,xt.U)((()=>{s.delete()}),c);i.load("name"),s.load(["name","id"]),i.getRange("A1").select();try{await n.sync()}catch(e){await d(e)}return{result:s,undo:e=>(e.workbook.worksheets.getItem(i.name).charts.getItem(s.name).delete(),e.sync())}}}(l,a,i)(e);o.push(s.undo);const c=_t(s.result,a,i),d=(0,rt.x)(e,s.result.worksheet);s.result.worksheet.load("name"),await e.sync(),c();const u=await d()(e);return o.push(u.undo),s.result}function ta(e,t,a){const n=e.workbook.pivotTables,o=e.workbook.worksheets.getActiveWorksheet().protection.load("protected"),i=t.getTopLeftCell(e).load(["rowIndex","columnIndex"]);n.load({name:!0,worksheet:{id:!0,protection:{protected:!0}}});let l=null;return t.tableName&&(l=e.workbook.worksheets.getItem(t.sheetId).tables.getItemOrNullObject(t.tableName)),e=>async s=>{const c=n.items.filter((e=>e.worksheet.protection.protected));if(o.protected&&Office.context.platform!==Office.PlatformType.OfficeOnline)throw new r.u(r.O.InsertionFailedCurrentWorksheetProtected);if(c.length>0&&Office.context.requirements.isSetSupported("ExcelApi","1.15")){const e=c.map((e=>({type:e.getDataSourceType(),sourceString:e.getDataSourceString()})));await n.context.sync();if(e.map((e=>({type:e.type.value,sourceString:e.sourceString.value}))).filter((e=>e.sourceString.length>0&&(e.type===Excel.DataSourceType.localTable&&e.sourceString===t.tableName||e.type===Excel.DataSourceType.localRange&&e.sourceString===`${t.sheetName}!${t.address}`))).length>0)throw new r.u(r.O.InsertionFailedPivotCacheProtected)}const d=!l||l.isNullObject?va(s,a,t,i):l,u=new Set(n.items.map((e=>e.name)));let m,h=1;do{m=(0,It.L)(et.olU.InsertedPivotTableName,h.toString()),++h}while(u.has(m));const g=n.add(m,d,e);g.refresh();const p=function(e,t,a){const n=e.hierarchies,o=t.getRange(a).getRow(0).load("text,rowCount");return n.load("items/name"),()=>{const e=new Set(n.items.map((e=>e.name.toUpperCase()))),t=new Set,a=new Map;let r=[];return o.rowCount>0&&(r=o.text[0]),r.forEach((n=>{const o=n.toUpperCase();if(e.has(o)&&!t.has(o))t.add(o);else{let r=2,i=(0,It.L)((0,et.fhV)(),o,r);for(;e.has(i);){if(!t.has(i)){a.set(n,i),t.add(i);break}++r,i=(0,It.L)((0,et.fhV)(),o,r)}}})),a}}(g,t,s);e.worksheet.showGridlines=!1,Office.context.requirements.isSetSupported("TableStyle","1.1")&&g.layout.setStyle("PivotStyleLight16");const b=(0,Mt.A)();s.trace(b);const f=(0,xt.U)((()=>g.delete()),b);try{await s.sync()}catch(e){await f(e)}const C=p();return{result:{pivotTable:g,hierarchyNameMap:C},undo:e=>{const t=e.workbook.pivotTables.getItem(m),a=Office.context.requirements.isSetSupported("ExcelApi","1.9")&&Office.context.platform!==Office.PlatformType.OfficeOnline,n=e.workbook.worksheets.getActiveWorksheet();return a&&(e.application.suspendScreenUpdatingUntilNextSync(),t.worksheet.activate()),t.delete(),a&&n.activate(),e.sync()}}}}function aa(e,t,a){(t.valueFilters.length>0||t.labelFilters.length>0||t.dateFilters.length>0)&&(e.allowMultipleFiltersPerField=!0),e.layout.layoutType=Excel.PivotLayoutType.tabular;const n=[];t.filterFields&&t.filterFields.forEach((t=>{const o=a.get(t.name)||t.name,r=e.hierarchies.getItem(o),i=e.filterHierarchies.add(r);0!==t.values.length&&(n.push({filterField:i.fields.getItem(o),visibleItemNames:t.values}),i.enableMultipleFilterItems=!0)}));const o=ra(n);return()=>{o(),ca(e,t,a),ua(e,t,a),pa(e,t,a),ba(e,t),fa(e,t)}}function na(e,t,a){(t.valueFilters.length>0||t.labelFilters.length>0||t.dateFilters.length>0)&&(e.allowMultipleFiltersPerField=!0),e.layout.layoutType=Excel.PivotLayoutType.tabular;const n=[];t.filterFields&&t.filterFields.forEach((t=>{const o=a.get(t.name)||t.name,r=e.hierarchies.getItem(o),i=e.filterHierarchies.add(r);0!==t.values.length&&(n.push({filterField:i.fields.getItem(o),visibleItemNames:t.values}),i.enableMultipleFilterItems=!0)}));const o=ra(n);return()=>{o();const n=oa(e,t,a);ia(e,t,n,a),ca(e,t,a),ua(e,t,a),pa(e,t,a),ba(e,t),fa(e,t)}}function oa(e,t,a){return t.dataFields.map((t=>{const n=e.hierarchies.getItem(a.get(t.name)||t.name),o=e.dataHierarchies.add(n);o.summarizeBy=function(e){switch(e){case"sum":return Excel.AggregationFunction.sum;case"count":return Excel.AggregationFunction.count;case"average":return Excel.AggregationFunction.average;case"min":return Excel.AggregationFunction.min;case"max":return Excel.AggregationFunction.max;case"distinctCount":return Excel.AggregationFunction.countNumbers;case"stdDev":return Excel.AggregationFunction.standardDeviation;case"variance":return Excel.AggregationFunction.variance;default:throw new Error("Unsupported calculation function")}}(t.dataCalculation),t.numberFormat&&(o.numberFormat=t.numberFormat);const r=function(e){if(void 0===e)return Excel.ShowAsCalculation.none;switch(e){case"percentOf":return Excel.ShowAsCalculation.percentOf;case"percentOfColumnTotal":return Excel.ShowAsCalculation.percentOfColumnTotal;case"percentOfRowTotal":return Excel.ShowAsCalculation.percentOfRowTotal;case"percentOfGrandTotal":return Excel.ShowAsCalculation.percentOfGrandTotal;case"percentOfParentTotal":return Excel.ShowAsCalculation.percentOfParentTotal;case"percentOfParentColumnTotal":return Excel.ShowAsCalculation.percentOfParentColumnTotal;case"percentOfParentRowTotal":return Excel.ShowAsCalculation.percentOfParentRowTotal;case"percentRunningTotal":return Excel.ShowAsCalculation.percentRunningTotal;case"rankAscending":return Excel.ShowAsCalculation.rankAscending;case"rankDecending":return Excel.ShowAsCalculation.rankDecending;case"runningTotal":return Excel.ShowAsCalculation.runningTotal;case"none":return Excel.ShowAsCalculation.none;default:(0,i.c)(e)}}(t.showAsCalculation);return o.showAs={calculation:r},{dataPivotHierarchy:o,visualDataField:t}}))}function ra(e){const t={name:!0,items:{name:!0}};return e.forEach((e=>{e.filterField.load(t)})),()=>{e.forEach((e=>{e.filterField.items.items.forEach((t=>{t.visible=e.visibleItemNames.includes(t.name)}))}))}}function ia(e,t,a,n){t.rowFields&&t.rowFields.forEach((t=>{const o=n.get(t.name)||t.name,r=e.hierarchies.getItem(o);e.rowHierarchies.add(r),Ca(r.fields.getItem(o),a,t)})),t.columnFields&&t.columnFields.forEach((t=>{const o=n.get(t.name)||t.name,r=e.hierarchies.getItem(o);e.columnHierarchies.add(r),Ca(r.fields.getItem(o),a,t)}))}function la(e){switch(e.filterType){case"between":case"notBetween":return{condition:Excel.ValueFilterCondition.between,exclusive:"notBetween"===e.filterType,lowerBound:e.value,upperBound:e.value2};case"bottomItems":return{condition:Excel.ValueFilterCondition.bottomN,selectionType:Excel.TopBottomSelectionType.items,threshold:e.value};case"bottomPercent":return{condition:Excel.ValueFilterCondition.bottomN,selectionType:Excel.TopBottomSelectionType.percent,threshold:e.value};case"bottomSum":return{condition:Excel.ValueFilterCondition.bottomN,selectionType:Excel.TopBottomSelectionType.sum,threshold:e.value};case"equal":case"notEqual":return{condition:Excel.ValueFilterCondition.equals,exclusive:"notEqual"===e.filterType,comparator:e.value};case"greaterThan":return{condition:Excel.ValueFilterCondition.greaterThan,comparator:e.value};case"greaterThanOrEqual":return{condition:Excel.ValueFilterCondition.greaterThanOrEqualTo,comparator:e.value};case"lessThan":return{condition:Excel.ValueFilterCondition.lessThan,comparator:e.value};case"lessThanOrEqual":return{condition:Excel.ValueFilterCondition.lessThanOrEqualTo,comparator:e.value};case"topItems":return{condition:Excel.ValueFilterCondition.topN,selectionType:Excel.TopBottomSelectionType.items,threshold:e.value};case"topPercent":return{condition:Excel.ValueFilterCondition.topN,selectionType:Excel.TopBottomSelectionType.percent,threshold:e.value};case"topSum":return{condition:Excel.ValueFilterCondition.topN,selectionType:Excel.TopBottomSelectionType.sum,threshold:e.value};default:(0,i.c)(e,`Invalid ValueFilter type: ${e.filterType}`)}}function sa(e,t){switch(e){case"rowField":return t.rowFields;case"columnField":return t.columnFields;default:return(0,i.x)(e)}}function ca(e,t,a){t.valueFilters.forEach((n=>{const o=sa(n.labelFieldType,t)[n.labelFieldIndex],r=a.get(o.name)||o.name,i=t.dataFields[n.dataFieldIndex],l=a.get(i.name)||i.name;e.hierarchies.getItem(r).fields.getItem(r).applyFilter({valueFilter:{...la(n),value:(0,It.L)((0,et.Gn5)(),(0,jt.i)(i.dataCalculation),l)}})}))}function da(e){const t=e.value.toString();switch(e.filterType){case"equal":case"notEqual":return{condition:Excel.LabelFilterCondition.equals,comparator:t,exclusive:"notEqual"===e.filterType};case"greaterThan":return{condition:Excel.LabelFilterCondition.greaterThan,comparator:t};case"greaterThanOrEqual":return{condition:Excel.LabelFilterCondition.greaterThanOrEqualTo,comparator:t};case"lessThan":return{condition:Excel.LabelFilterCondition.lessThan,comparator:t};case"lessThanOrEqual":return{condition:Excel.LabelFilterCondition.lessThanOrEqualTo,comparator:t};case"between":case"notBetween":return{condition:Excel.LabelFilterCondition.between,exclusive:"notBetween"===e.filterType,lowerBound:t,upperBound:e.value2.toString()};case"startsWith":case"notStartsWith":return{condition:Excel.LabelFilterCondition.beginsWith,substring:t,exclusive:"notStartsWith"===e.filterType};case"endsWith":case"notEndsWith":return{condition:Excel.LabelFilterCondition.endsWith,substring:t,exclusive:"notEndsWith"===e.filterType};case"contains":case"notContains":return{condition:Excel.LabelFilterCondition.contains,substring:t,exclusive:"notContains"===e.filterType};default:return(0,i.x)(e)}}function ua(e,t,a){t.labelFilters.forEach((n=>{const o=sa(n.labelFieldType,t)[n.labelFieldIndex],r=a.get(o.name)||o.name;e.hierarchies.getItem(r).fields.getItem(r).applyFilter({labelFilter:da(n)})}))}function ma(e,t){switch(e){case"equal":case"notEqual":return{condition:Excel.DateFilterCondition.equals,exclusive:"notEqual"===e};case"after":return{condition:Excel.DateFilterCondition.after};case"afterOrEqual":return{condition:Excel.DateFilterCondition.afterOrEqualTo};case"before":return{condition:Excel.DateFilterCondition.before};case"beforeOrEqual":return{condition:Excel.DateFilterCondition.beforeOrEqualTo};case"between":case"notBetween":return{condition:Excel.DateFilterCondition.between,exclusive:"notBetween"===e};case"inDynamicPeriod":return{condition:ha(t)};default:return(0,i.x)(e)}}function ha(e){switch(e){case"tomorrow":return Excel.DateFilterCondition.tomorrow;case"today":return Excel.DateFilterCondition.today;case"yesterday":return Excel.DateFilterCondition.yesterday;case"nextWeek":return Excel.DateFilterCondition.nextWeek;case"thisWeek":return Excel.DateFilterCondition.thisWeek;case"lastWeek":return Excel.DateFilterCondition.lastWeek;case"nextMonth":return Excel.DateFilterCondition.nextMonth;case"thisMonth":return Excel.DateFilterCondition.thisMonth;case"lastMonth":return Excel.DateFilterCondition.lastMonth;case"nextQuarter":return Excel.DateFilterCondition.nextQuarter;case"thisQuarter":return Excel.DateFilterCondition.thisQuarter;case"lastQuarter":return Excel.DateFilterCondition.lastQuarter;case"nextYear":return Excel.DateFilterCondition.nextYear;case"thisYear":return Excel.DateFilterCondition.thisYear;case"lastYear":return Excel.DateFilterCondition.lastYear;case"yearToDate":return Excel.DateFilterCondition.yearToDate;case"quarter1":return Excel.DateFilterCondition.allDatesInPeriodQuarter1;case"quarter2":return Excel.DateFilterCondition.allDatesInPeriodQuarter2;case"quarter3":return Excel.DateFilterCondition.allDatesInPeriodQuarter3;case"quarter4":return Excel.DateFilterCondition.allDatesInPeriodQuarter4;case"january":return Excel.DateFilterCondition.allDatesInPeriodJanuary;case"february":return Excel.DateFilterCondition.allDatesInPeriodFebruary;case"march":return Excel.DateFilterCondition.allDatesInPeriodMarch;case"april":return Excel.DateFilterCondition.allDatesInPeriodApril;case"may":return Excel.DateFilterCondition.allDatesInPeriodMay;case"june":return Excel.DateFilterCondition.allDatesInPeriodJune;case"july":return Excel.DateFilterCondition.allDatesInPeriodJuly;case"august":return Excel.DateFilterCondition.allDatesInPeriodAugust;case"september":return Excel.DateFilterCondition.allDatesInPeriodSeptember;case"october":return Excel.DateFilterCondition.allDatesInPeriodOctober;case"november":return Excel.DateFilterCondition.allDatesInPeriodNovember;case"december":return Excel.DateFilterCondition.allDatesInPeriodDecember;default:return(0,i.x)(e)}}function ga(e){return(0,o.S$)(e)?{...ma(e.filterType),comparator:{date:e.value.toISOString(),specificity:Excel.FilterDatetimeSpecificity.second},wholeDays:e.wholeDays}:(0,o.kp)(e)?{...ma(e.filterType),lowerBound:{date:e.value.toISOString(),specificity:Excel.FilterDatetimeSpecificity.second},upperBound:{date:e.value2.toISOString(),specificity:Excel.FilterDatetimeSpecificity.second},wholeDays:e.wholeDays}:(0,o.vr)(e)?ma(e.filterType):(0,i.x)(e)}function pa(e,t,a){t.dateFilters.forEach((n=>{const o=sa(n.fieldType,t)[n.fieldIndex],r=a.get(o.name)||o.name;e.hierarchies.getItem(r).fields.getItem(r).applyFilter({dateFilter:ga(n)})}))}function ba(e,t){(t.subTotalRowIndices||t.subTotalColumnIndices)&&(e.layout.subtotalLocation=Excel.SubtotalLocationType.atTop)}function fa(e,t){const a=e.worksheet;if(t.highlightCellReferences){const e=ya(t);t.highlightCellReferences.forEach((t=>{a.getCell(t.row+e,t.column).format.font.color="#ED7331"}))}}function Ca(e,t,a){const n=a.sortOrder;if(!n||"default"===n)return;const o=function(e){switch(e){case"ascending":return Excel.SortBy.ascending;case"descending":return Excel.SortBy.descending;case"default":throw new Error("Unsupported sort order");default:return(0,i.x)(e)}}(n);if(a.sortBy){const n=t.find((e=>e.visualDataField.name===a.sortBy)).dataPivotHierarchy;e.sortByValues(o,n)}else e.sortByLabels(o)}function ya(e){const t=(e.filterFields||[]).length;return t>0?t+2:1}function va(e,t,a,n){const o=e.workbook.worksheets.getItem(a.sheetId);if(t){const{top:e,left:a,bottom:r,right:i}=t.table.tableLocation;return o.getRangeByIndexes(e+n.rowIndex,a+n.columnIndex,r-e+1,i-a+1)}return a.getRange(e)}const xa=1,Ta=0,Sa=0,wa=0;function Ea(e,t,a){return Excel.run((n=>{const{type:r}=e;switch(r){case"ChartVisual":case"PivotChartVisual":case"QueryChartVisual":t.some((t=>t.sheetId===e.sheetId&&(0,o.VZ)(t.type)))||n.workbook.worksheets.getItem(e.sheetId).charts.onDeleted.add((e=>a(e.chartId,ot.D0.Chart,e.source)));break;case"PivotTableVisual":t.some((e=>"PivotTableVisual"===e.type))||n.workbook.worksheets.onDeleted.add((e=>a(e.worksheetId,ot.D0.Sheet,e.source)));break;case"QueryResultVisual":if(!e.sheetId)break;e.sheetId&&!t.some((t=>"QueryResultVisual"===t.type&&t.sheetId===e.sheetId))&&(e.isFormulaInsertion?n.workbook.worksheets.onDeleted.add((e=>a(e.worksheetId,ot.D0.Sheet,e.source))):n.workbook.worksheets.getItem(e.sheetId).tables.onDeleted.add((e=>a(e.tableId,ot.D0.Table,e.source))));break;case"ForecastVisual":case"TextAnalysisVisual":break;default:(0,i.x)(r)}return Promise.resolve()}))}async function Ia(e,t,a,n,o){const l=[];try{const r=[],s=[],c=[];o.failureLocation=Xe.lA.convertingDashboardArgs,t.forEach((e=>{const t=e=>(0,pt.LM)(1+e.position.y,1+e.position.x),o=(e,t)=>{const a=e.filterFields.length>0?e.filterFields.length+1:0;return(0,pt.LM)(1+t.position.y+a,1+t.position.x)},l=e=>(0,pt.LM)(1+e.position.y+e.dim.y-1,1+e.position.x+e.dim.x-1);switch(e.recommendation.visual.visualType){case"ChartVisual":{const o=e.layoutPlacement.chart;if(!o)throw new Error("Chart layout rectangle not found for ChartVisual");const i=t(o),s=l(o),c=`'${a}'!${i}:${s}`;r.push({recommendation:e.recommendation,dataProvider:n,destination:c});break}case"PivotTableVisual":{const t=e.layoutPlacement.pivotTable;if(!t)throw new Error("Pivot table layout rectangle not found for PivotTableVisual");const r=o(e.recommendation.visual.pivotTable,t),i=`'${a}'!${r}`;s.push({recommendation:e.recommendation,dataProvider:n,interpretation:e.interpretation,destination:i,layoutPlacement:t});break}case"PivotChartVisual":{const r=e.layoutPlacement.pivotTable,i=e.layoutPlacement.chart;if(!i)throw new Error("Chart layout rectangle not found for PivotChartVisual");if(!r)throw new Error("Pivot table layout rectangle not found for PivotChartVisual");const d=t(i),u=l(i),m=o(e.recommendation.visual.pivotTable,r),h=`'${a}'!${m}`,g=`'${a}'!${d}:${u}`;c.push({recommendation:e.recommendation,dataProvider:n,destination:g,pivotTableSheetId:null,pivotTableRange:null}),s.push({recommendation:e.recommendation,dataProvider:n,interpretation:e.interpretation,destination:h,layoutPlacement:r});break}case"QueryResultVisual":case"QueryChartVisual":case"ForecastVisual":case"TextAnalysisVisual":throw new Error(`Unsupported dashboard visual type: ${e.recommendation.visual.visualType}`);default:(0,i.x)(e.recommendation.visual)}})),o.failureLocation=Xe.lA.insertCharts;const d=await async function(e,t,a){if(a.length<=0)return[];const n=[];a.forEach((e=>{const t=e.recommendation.visual;let a=t.chart;void 0===a.title&&(a={...a,title:e.recommendation.title}),n.push({visualChart:a,dataProvider:e.dataProvider,chartConfig:t.chartConfig,destination:e.destination})}));const o=await Ht(e,t,n),r=[];for(let e=0;e<o.length;++e)r.push({objectId:o[e].id,sheetId:o[e].worksheet.id,recommendationId:a[e].recommendation.id,type:"ChartVisual"});return r}(e,l,r);o.failureLocation=Xe.lA.insertPivotTables;const u=await async function(e,t,a){if(a.length<=0)return[];const n=a.sort(((e,t)=>e.layoutPlacement.position.y>t.layoutPlacement.position.y?1:e.layoutPlacement.position.y<t.layoutPlacement.position.y?-1:e.layoutPlacement.position.x-t.layoutPlacement.position.x)),o=n.map((e=>{const t=e.recommendation.visual;return{dataProvider:e.dataProvider,interpretation:e.interpretation,destination:e.destination,visualPivotTable:t.pivotTable}})),r=await Kt(e,t,o);await e.sync();return r.map(((e,t)=>({objectId:e.id,sheetId:e.worksheet.id,range:e.layout.getRange(),recommendationId:n[t].recommendation.id,type:"PivotTableVisual"})))}(e,l,s);c.forEach((e=>{const t=u.find((t=>t.recommendationId===e.recommendation.id));e.pivotTableRange=t?.range,e.pivotTableSheetId=t?.sheetId})),o.failureLocation=Xe.lA.insertPivotCharts;const m=await async function(e,t,a){if(a.length<=0)return[];const n=[];a.forEach((e=>{if(!e.pivotTableRange)throw new Error(`Pivot table range not provided for recommendation: ${e.recommendation.id}`);if(!e.pivotTableSheetId)throw new Error(`Pivot table sheet id not provided for recommendation: ${e.recommendation.id}`);let t=e.recommendation.visual.chart;void 0===t.title&&(t={...t,title:e.recommendation.title}),n.push({visualChart:t,dataProvider:e.dataProvider,destination:e.destination,pivotTableRange:e.pivotTableRange,pivotTableSheetId:e.pivotTableSheetId})}));const o=await async function(e,t,a){const n=[],o=[];a.forEach((t=>{const a=(0,vt.ip)(t.visualChart).primary;let r,i,l=!1;const s=(0,St.dn)(e,t.destination);try{const e=(0,St.gx)(t.destination);if(e){const t=(0,ft.AW)(e);r=s.getCell(t.top-1,t.left-1),t.top===t.bottom&&t.left===t.right||(i=s.getCell(t.bottom-1,t.right-1),l=!0)}}catch(e){l=!1}if(!r)throw new Error("Starting cell not found.");r.select();const c=s.charts.add(a.excelType,r);l?c.setPosition(r,i):c.setPosition(r),c.setData(t.pivotTableRange),c.showAllFieldButtons=!1,Ft(c,t.visualChart,t.chartConfig),s.load("name"),c.load(["name","id"]),s.getRange("A1").select(),n.push(c);const d=(0,Mt.A)();e.trace(d),o.push(d)})),await e.sync();const r=[];for(let e=0;e<n.length;++e){const t=_t(n[e],a[e].visualChart,a[e].chartConfig);r.push(t)}try{await e.sync(),r.forEach((e=>{e()}))}catch(e){for(let e=0;e<n.length;++e)(0,xt.U)((()=>n[e].delete()),o[e])}return t.push((e=>{for(let t=0;t<n.length;++t)e.workbook.worksheets.getItem(a[t].pivotTableSheetId).charts.getItem(n[t].name).delete();return e.sync()})),n}(e,t,n),r=[];for(let e=0;e<o.length;++e)r.push({objectId:o[e].id,sheetId:o[e].worksheet.id,recommendationId:a[e].recommendation.id,type:"PivotChartVisual"});return r}(e,l,c);return d.concat(u.concat(m))}catch(e){try{await(0,xt.q)(l)}catch(e){nt.M.getInstance().logErrorCode(r.O.InsertionCleanupFailed,e,at.S2.Undo,Ze.$b.Error)}throw e}}async function Ra(e,t,a){const o=[];try{return await(0,gt.$r)((0,et.Eyh)()),await Excel.run({delayForCellEdit:!0},(async s=>{const c=e.visual;switch(c.visualType){case"ChartVisual":{const a=await async function(e,t,a,n){const o=t.visual;let r=o.chart;void 0===r.title&&(r={...r,title:t.title});Office.context.platform===Office.PlatformType.OfficeOnline&&a.getSheet(e).getRange("A1").select();const i=await $t(e,r,a,n,o.chartConfig);return{objectId:i.id,sheetId:i.worksheet.id,recommendationId:t.id,type:"ChartVisual",sheetName:i.worksheet.name}}(s,e,t,o);return a}case"PivotTableVisual":{const n=await async function(e,t,a,n,o){const r=t.visual,i=await async function(e,t,a,n,o=Zt){const r=ta(e,t,n),i=(0,rt.d)(e);await e.sync();const l=await i()(e);a.push(l.undo);const s=await r(l.result.getCell(ya(o),0))(e),c=s.result.pivotTable;a.push(s.undo);const d=Yt(c,o,s.result.hierarchyNameMap);let u=o;d&&(await e.sync(),u=d());const m=na(c,u,s.result.hierarchyNameMap),h=(0,rt.x)(e,c.worksheet);c.worksheet.load("name"),await e.sync(),m();const g=await h()(e);return a.push(g.undo),c}(e,a,n,o,r.pivotTable);return{objectId:i.id,sheetId:i.worksheet.id,recommendationId:t.id,type:"PivotTableVisual",sheetName:i.worksheet.name}}(s,e,t,o,a);return n}case"PivotChartVisual":{const n=await async function(e,t,a,n,o){const r=t.visual;let i=r.chart;const l=r.pivotTable;void 0===i.title&&(i={...i,title:t.title});const s=await ea(e,l,i,a,n,o,r.chartConfig);return{objectId:s.id,sheetId:s.worksheet.id,recommendationId:t.id,type:"PivotChartVisual",sheetName:s.worksheet.name}}(s,e,t,o,a);return n}case"QueryResultVisual":try{return await async function(e,t,a,o){const r=t.visual;if(void 0===r.query)throw new Error("The recommendation is not a query result visual.");const i=function(e){const{projectClause:t,groupClause:a}=e;return!(t&&t.length>1||!t.some((e=>De(e)))||a)}(r.query);let s;if((0,Ct.iPS)("Microsoft.Office.Excel.FA000000124.UseLLMFormula",!1)&&r.formula&&r.formula.length>0)s=r.formula;else{new Ye(r.query,new Fe(!0)).translate();const t=await it(e,a,r.query);try{const e=new Ye(r.query,t).translate();s=`=${function(e,t,a){const n=st(e),o=ct(e).filter((e=>"average"===e.aggregationType)).map((e=>e.index)),r=lt(e),i=[new h("*",Se.formulaIsError(new l(t.getTableAddress())),new d(1))];if(n.forEach((e=>{const a=new l(t.getColumnAddress(e));i.push(Se.formulaMin([Se.formulaSum(new h("-",new d(1),Se.formulaIsNumber(a))),Se.formulaSum(new h("-",new d(1),Se.formulaIsText(a)))]))})),o.length>0){const e=1===o.length?new l(t.getColumnAddress(o[0])):Se.formulaIndex(new l(t.getTableAddress()),Se.formulaSequence(Se.formulaRows(new l(t.getTableAddress()))),o.map((e=>e+1)));i.push(new h("*",Se.formulaIsBlank(e),new d(1)))}if(r.length>0){const e=1===r.length?new l(t.getColumnAddress(r[0])):Se.formulaIndex(new l(t.getTableAddress()),Se.formulaSequence(Se.formulaRows(new l(t.getTableAddress()))),r.map((e=>e+1)));i.push(new h("*",Se.formulaIsError(Se.formulaYear(e)),new d(1)))}return Se.formulaIf(new g(">",Se.formulaSum(i),new d(0)),Se.formulaNA(),a)}(r.query,t,e).toString()}`}catch(e){throw e instanceof Ae?e:new Ae(n.TranslationFailure)}}if(s.length>8192)throw new Ae(n.ExceedLengthLimitation);const c=await(0,St.oc)(e,o);await function(e,t,a,n,o){const r=n.fields,i=n.fieldHeaders.map(yt.HW),l=r.length,s=r[0].values.raw.length,c=(0,bt.Kz)(s,(e=>r.map((t=>t.values.formats?.[e])))),d=(0,bt.Kz)(s,(e=>r.map((t=>t.values.formatLocals?.[e])))),u=new Array(l).fill(null),m=[u,...c],h=[u,...d];t.showGridlines=!1;const g=Gt,p=Wt,b=zt;t.getRangeByIndexes(g,p,1,l).set({values:[i],format:{font:{color:"white",bold:!0,size:11},fill:{color:"4472C4"}}});const{formulaCellAddress:f,formulaCellTop:C,formulaCellLeft:y}=function(e,t,a,n){return{formulaCellAddress:e?`${n}${t+2}`:`${n}${t+3}`,formulaCellTop:e?t:t+1,formulaCellLeft:a}}(o,g,p,b),v=o?s+1:s+2;return t.getRange(f).formulas=[[a]],qt(t,m,h,C,y,1),t.getRangeByIndexes(3,2,v,l).format.autofitColumns(),e.sync()}(e,c,s,r.result,i);const u=(0,rt.x)(e,c);c.load("name"),await e.sync();const m=await u()(e);return o.push(m.undo),{objectId:null,sheetId:c.id,recommendationId:t.id,type:"QueryResultVisual",isFormulaInsertion:!0,sheetName:c.name}}(s,e,t,o)}catch(t){return nt.M.getInstance().logErrorCode(t instanceof Ae?function(e){switch(e){case"ContentTooLarge":return r.O.FormulaErrorContentTooLarge;case"ExceedLengthLimitation":return r.O.FormulaErrorExceedLengthLimitation;case"ProactiveLimitation":return r.O.FormulaErrorProactiveLimitation;case"TranslationFailure":return r.O.FormulaErrorTranslationFailure;case"Unknown":return r.O.FormulaErrorUnknown;case"ValidationIssue":return r.O.FormulaErrorValidationIssue;default:return(0,i.x)(e)}}(t.errorCode):r.O.FormulaErrorUnknown,t,at.S2.AnalyzeDataError,Ze.$b.Warning,{key:tt.un.RecommendationId,value:e.id}),await(0,xt.q)(o),async function(e,t,a){const n=t.visual,o=n.result,{targetSheet:r,table:i}=await Aa(e,o,a,xa,Ta);return r.getRange("A1").select(),r.load("name"),await e.sync(),{objectId:i.id,sheetId:r.id,recommendationId:t.id,type:"QueryResultVisual",isFormulaInsertion:!1,sheetName:r.name}}(s,e,o)}case"QueryChartVisual":return async function(e,t,a){const n=t.visual,o=n.result,{targetSheet:r,table:i}=await Aa(e,o,a,xa,Ta);r.load("name"),i.load("name"),await e.sync();const l=await $t(e,n.chart,new Ke.N(r.id,r.name,(0,ft.XK)({top:3,left:1,bottom:n.result.fields[0].values.raw.length+3,right:n.result.fields.length}),i.name),a);return{objectId:l.id,sheetId:r.id,recommendationId:t.id,type:"QueryChartVisual",isFormulaInsertion:!1,sheetName:r.name}}(s,e,o);case"ForecastVisual":return async function(e,t,a){const n=t.visual,o=n.formulasTable,{targetSheet:r,table:i}=await Aa(e,o,a,Sa,wa);r.getRange("A1").select();const l=r.getUsedRange();l.load("address"),await e.sync();const s=new Ke.N(r.id,r.name,l.address),c=await $t(e,n.chart,s,a);return c.width=500,c.height=300,await e.sync(),{objectId:i.id,sheetId:r.id,recommendationId:t.id,type:"ForecastVisual",isFormulaInsertion:!0,sheetName:r.name}}(s,e,o);case"TextAnalysisVisual":return async function(e,t,a){const n=a.getTable(e),o=(n?n.getRange():a.getRange(e)).load(["rowIndex","columnIndex","rowCount","columnCount","address"]);await e.sync();const{rowIndex:r,columnIndex:i,rowCount:l,columnCount:s}=o,c=r,d=i+s,u=t.visual,{header:m,values:h}=La(u.textAnalysisResult),g=a.sheetName,p=e.workbook.worksheets.getItem(g),b=[m,...h];if(n)n.columns.add(void 0,new Array(b.length).fill(new Array(m.length).fill("")));else{p.getRangeByIndexes(c,d,l,m.length).insert(Excel.InsertShiftDirection.right)}await e.sync();const f=p.getRangeByIndexes(c,d,l,m.length);return f.values=b,p.load(["name","id"]),f.load(["values","columnIndex"]),await e.sync(),{objectId:null,sheetId:p.id,recommendationId:t.id,type:"TextAnalysisVisual",isFormulaInsertion:!1,sheetName:p.name,range:f}}(s,e,t);default:return(0,i.x)(c)}}))}catch(e){try{await(0,xt.q)(o)}catch(e){nt.M.getInstance().logErrorCode(r.O.InsertionCleanupFailed,e,at.S2.Undo,Ze.$b.Error)}throw e}finally{await(0,gt.TA)()}}async function Aa(e,t,a,n,o){const r=t.fields,i=r[0].values.raw.length,l=(0,bt.Kz)(i,(e=>r.map((t=>t.values.raw[e])))),s=t.fieldHeaders.map(yt.HW);l.unshift(s);const c=l[0].length,d=(0,bt.Kz)(i,(e=>r.map((t=>t.values.formats?.[e])))),u=(0,bt.Kz)(i,(e=>r.map((t=>t.values.formatLocals?.[e])))),m=new Array(c).fill(null),h=[m,...d],g=[m,...u],p=await(0,St.oc)(e,a),{result:b,undo:f}=Vt(p,l,h,g,n,o,1);return b.load("id"),a.push(f),{targetSheet:p,table:b}}function La(e){const t=e.bulletList;if(!t)throw new Error("Invalid text analysis result to insert. Only result with bulletList can be inserted.");const a=e.columnReference.bottom-e.columnReference.top+1,{augmentedColumnNames:n,augmentedColumnValues:o}=function(e,t){const a=e.map((e=>e.title)),n=[];for(let e=0;e<t;e++)n.push(Array(a.length).fill(!1));for(let t=0;t<a.length;t++){const a=e[t].reference;if(a)for(let e=0;e<a.length;e++){const o=a[e];if(o<0||o>=n.length)throw new Error("Invalid BulletResult. Reference out of range.");n[o][t]=!0}}return{augmentedColumnNames:a,augmentedColumnValues:n}}(t,a),{success:r,columnValues:i,columnName:l}=function(e,t,a,n){const o=[],r=(0,Ct.yw9)("OfficeVSO_10200801_UseInsertionColumnHeaderForTextAnalysis")?n??ka(a):ka(a);for(const a of t){const t=a.filter((e=>!0===e)).length;if(1===t)o.push(e[a.indexOf(!0)]);else{if(0!==t)return{success:!1};o.push(null)}}return{success:!0,columnValues:o,columnName:r}}(n,o,e.analysisType,e.insertionColumnHeader);if(r){if(void 0===l||void 0===i)throw new Error("Invalid result. When success is true, columnName and columnValues should not be undefined.");return{header:[l],values:i.map((e=>[e]))}}return{header:n,values:o}}function ka(e){return e===o.uK.Sentiment?(0,et.Moz)():(0,et.$sl)()}async function Fa(e){const t=[];try{return await(0,gt.$r)((0,et.Eyh)()),await Excel.run({delayForCellEdit:!0},(async a=>{const n=await(0,St.oc)(a,t),o=[];if(0===e.series.length)throw new Error("At least one series is required");if(!e.series[0].data.categoryNames)throw new Error("Category names are required for the first series");e.series[0].data.categoryNames[0].forEach((e=>{o.push([e])})),e.series.forEach(((e,t)=>{e.data.values&&e.data.values[0].forEach(((e,a)=>{if(!o[a]){o[a]=[`Category${a+1}`];for(let e=0;e<t;e++)o[a].push(null)}o[a].push(e)}))}));const r=[];for(let e=0;e<o[0].length;e++)r.push(`Column ${e+1}`);o.unshift(r);const{result:i,undo:l}=Vt(n,o,[],[],0,0,1);t.push(l);const s=(0,vt.oe)(e.series[0].layout??"");n.charts.add(s.excelType,i.getRange()).activate()}))}catch(e){try{await(0,xt.q)(t)}catch(e){nt.M.getInstance().logErrorCode(r.O.InsertionCleanupFailed,e,at.S2.Undo,Ze.$b.Error)}throw e}finally{await(0,gt.TA)()}}},408185:(e,t,a)=>{"use strict";a.d(t,{$:()=>d,b:()=>s});var n=a(117910),o=a(79458),r=a(290786),i=a(207545),l=a(910480);const s="unknown";class c{constructor(e){this.activatedAnnotationTypes=new Map,this.releasedAnnotationTypes=new Map,this.annotationActivationStatus=new Map,this.clientSentMessages=new Map,this.annotationsReceived=new Map,this.connectionMessages=[],this.isActive=!0,this.sessionKey=e}}class d{static getInstance(){return d.instance||(d.instance=new d),d.instance}getSessionsMap(){return this.sessionsMap}registerUIUpdater(e){this.updateUi=e}isAugloopSessionActive(e){return void 0!==e?.getConnectParams()}async onWebSocketActivity(){this.isAugloopSessionActive(this.activeSession)?(await this.refreshSessionDiagnosticsData(),this.updatesFromAugloopCount++,this.updateUi()):(0,o.cY)(o.SA.Info,"AugloopDiagnosticsManager.onWebSocketActivity: not sending request as augloop session is inactive.")}async syncCachedActiveSessionKey(){const e=this.getActiveSessionKeyFromConnectPramas();e!==this.cachedActiveSessionKey&&(this.createSessionDiagnosticsEntryIfNotExists(e),await this.refreshSessionDiagnosticsData())}getActiveSessionKey(){return this.debouncedSyncCachedActiveSessionKey(),this.cachedActiveSessionKey}setActiveSessionKey(e){this.cachedActiveSessionKey=e}setActiveSession(e){this.activeSession=e}getActiveSession(){return this.activeSession}init(e){if(!(0,i.I_)())return void(0,o.cY)(o.SA.Error,"AugloopDiagnosticsManager.init: Not initializing in dogfood or dev build or without feature flag");this.setActiveSession(e);const t=this.getActiveSessionKeyFromConnectPramas();this.createSessionDiagnosticsEntryIfNotExists(t);const a=e;a.messageBridge={...a.messageBridge,originalSendMessage:a.messageBridge.sendMessage},a.originalHandleSessionInitResponse=a.handleSessionInitResponse,a.handleSessionInitResponse=e=>{this.onSessionInitResponse(e),a.originalHandleSessionInitResponse(e)},a.originalHandleAnnotationResults=a.handleAnnotationResults,a.handleAnnotationResults=(e,t)=>{this.onAnnotationReceived(e,t),a.originalHandleAnnotationResults(e,t)},a.messageBridge.sendMessage=e=>{this.blockAnnotationReleaseMessageEnabled&&this.isAnnotationReleaseMessage(e)||(this.onSendMessage(e),a.messageBridge.originalSendMessage(e))},a.originalHandleSessionCloseMessage=a.handleSessionCloseMessage,a.handleSessionCloseMessage=e=>{this.onSessionCloseMessage(e),a.originalHandleSessionCloseMessage(e)},a.originalHandleSessionConnectMessage=a.handleSessionConnectMessage,a.handleSessionConnectMessage=e=>{this.onSessionConnectMessage(e),a.originalHandleSessionConnectMessage(e)},a.originalHandleSessionReconnectMessage=a.handleSessionReconnectMessage,a.handleSessionReconnectMessage=e=>{this.onSessionReconnectMessage(e),a.originalHandleSessionReconnectMessage(e)},a.originalHandleSessionDisconnectMessage=a.handleSessionDisconnectMessage,a.handleSessionDisconnectMessage=e=>{this.onSessionDisconnectMessage(e),a.originalHandleSessionDisconnectMessage(e)}}isAnnotationReleaseMessage(e){return e.includes(n.GA.getTypeName())}getActiveSessionKeyFromConnectPramas(){const e=this.getActiveSession()?.getConnectParams(),t=e?.sessionUrl.split("/").pop();return t??s}async retrieveModelFromAugloop(){const e=this.getActiveSession();if(!this.isAugloopSessionActive(e))return(0,o.cY)(o.SA.Info,"AugloopDiagnosticsManager.onWebSocketActivity: not sending request as augloop session is inactive."),Promise.reject(new Error("No active session found"));const t=await e.submitCustomMessage(new r.IW);return 0===t.itemsCount?Promise.reject(new Error("Failed to retrieve model. No items found in the model response")):t}async retrieveSessionDiagnosticsFromAugloop(){const e=this.getActiveSession();return e?e.submitCustomMessage(new r.pw):Promise.reject(new Error("No active session found"))}async refreshSessionDiagnosticsData(){this.sessionsMap.forEach((e=>{e.isActive=!1}));try{const e=await this.retrieveSessionDiagnosticsFromAugloop();if(void 0===e||void 0===e.sessionKey)throw new Error("sessionKey not found in response");const t=e.sessionKey;this.createSessionDiagnosticsEntryIfNotExists(t);const a=this.sessionsMap.get(t);if(!a)throw new Error("diagnosticsSession not found for sessionKey");a.isActive=!0,a.sessionKey=e.sessionKey,a.clientMetadata=e.clientMetadata,a.sessionMode=e.sessionMode,a.isCopilotLicensed=e.isCopilotLicensed,a.isCopilotActivated=e.isCopilotActivated,a.activatedAnnotationTypes=new Map(JSON.parse(e.activatedAnnotations)),a.releasedAnnotationTypes=new Map(JSON.parse(e.releasedAnnotations)),a.annotationActivationStatus=new Map(JSON.parse(e.annotationStatus)),a.annotationsReceived=new Map(JSON.parse(e.sentAnnotations)),a.clientSentMessages=new Map(JSON.parse(e.clientSubmittedMessages)),a.observerSessionType=e.observerSessionType,a.ecsSessionId=e.ecsSessionId,a.ecsStateId=e.ecsStateId}catch(e){(0,o.cY)(o.SA.Error,"AugloopDiagnosticsManager.refreshSessionDiagnosticsData: error:",e)}}onSessionInitResponse(e){if(!this.autoRefreshEnabled)return;this.createSessionDiagnosticsEntryIfNotExists(e.sessionKey);this.sessionsMap.get(e.sessionKey).sessionInitResponse=e,this.storeConnectivityMessage(e),this.debouncedOnWebSocketActivity()}onSendMessage(e){this.autoRefreshEnabled&&(e.includes(r.pw.getTypeName())||e.includes(r.Lm.getTypeName())||this.debouncedOnWebSocketActivity())}onAnnotationReceived(e,t){this.autoRefreshEnabled&&this.debouncedOnWebSocketActivity()}onSessionDisconnectMessage(e){this.handleConnectivityMessage(e)}onSessionReconnectMessage(e){this.handleConnectivityMessage(e)}onSessionConnectMessage(e){this.handleConnectivityMessage(e)}onSessionCloseMessage(e){this.handleConnectivityMessage(e)}handleConnectivityMessage(e){this.storeConnectivityMessage(e),this.autoRefreshEnabled&&this.debouncedOnWebSocketActivity()}storeConnectivityMessage(e){if(JSON.stringify(e).includes(n.uN.getTypeName())){const t=e.sessionKey;this.createSessionDiagnosticsEntryIfNotExists(t)}const t=this.getActiveSessionKey(),a=this.sessionsMap.get(t);a?a.connectionMessages.unshift(JSON.stringify(e)):(0,o.cY)(o.SA.Error,"AugloopDiagnosticsManager.storeConnectivityMessage: sessionKey not found in sessions collection")}createSessionDiagnosticsEntryIfNotExists(e){e!==this.cachedActiveSessionKey&&(this.cachedActiveSessionKey===s&&this.sessionsMap.has(s)?(this.sessionsMap.set(e,this.sessionsMap.get(s)),this.sessionsMap.delete(s)):this.sessionsMap.set(e,new c(e)),this.setActiveSessionKey(e))}constructor(){this.debounceIntervalForOnWebSocketActivityMs=2e3,this.debounceIntervalForSyncingActiveSessionKeyMs=5e3,this.sessionsMap=new Map,this.cachedActiveSessionKey=s,this.updatesFromAugloopCount=0,this.autoRefreshEnabled=!1,this.blockAnnotationReleaseMessageEnabled=!1,this.updateUi=()=>{},this.debouncedOnWebSocketActivity=(0,l.debounce)(this.onWebSocketActivity,this.debounceIntervalForOnWebSocketActivityMs,{leading:!0,trailing:!0}),this.debouncedSyncCachedActiveSessionKey=(0,l.debounce)(this.syncCachedActiveSessionKey,this.debounceIntervalForSyncingActiveSessionKeyMs,{leading:!0,trailing:!1})}}},412504:(e,t,a)=>{"use strict";function n(e,t){return e.every((e=>e.suggestionType===t))}a.d(t,{K:()=>n})},413563:(e,t,a)=>{"use strict";a.d(t,{D:()=>r});var n=a(79458),o=a(528804);function r(e){let t,a,r,i,l;if(e.json)try{const n=JSON.parse(e.json);i=n.code,(0,o.yw9)("OfficeVSO_9748131_ASHAErrorLoggingForAugLoopLicensingErrors")&&(l=n.reason),t=n.tabularRangeUnsupportedFeatureSkillFailures,a=n.unsupportedContextFeatures,(0,o.ZAR)()&&(r=n.inferredTableName)}catch(e){(0,n.cY)(n.SA.Error,"Failed to parse augloop error JSON: ",e)}return{errorCode:i,errorReason:l,tlrSkillSupport:t,contextFailures:a,inferredTableName:r}}},413848:(e,t,a)=>{"use strict";a.d(t,{GF:()=>i,dr:()=>l,vq:()=>s});var n=a(632512),o=a(703227),r=a(202051);async function i(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const n=a.workbook.tables.getItemOrNullObject(e).load("isNullObject");if(await a.sync(),n.isNullObject)return[];const o=n.getDataBodyRange().load("rowCount");return await a.sync(),l(a,o,t)}))}async function l(e,t,a){t.rowCount<a&&(a=t.rowCount);const n=[];for(let e=0;e<a;e++){const a=t.getRow(e).load(["isEntireRow","isEntireColumn","text"]);n.push(a)}await e.sync();const o=[];for(let e=0;e<n.length;e++){if(n[e].isEntireColumn||n[e].isEntireRow||!n[e].text)throw(0,r._s)("Range is null due to payload size limit.",void 0);o.push(n[e].text[0])}return o}async function s(e,t,a,l,s,c){let d=[];if(!0!==e.tableLikeRange)d=await i(e.name,c);else{if(!t){throw(0,r.Uc)(n.O.PythonContextUndefinedParameter,"Undefined Parameter: sheetId, Function: getSampleRowsForPythonAda",void 0)}d=await async function(e,t,a,n,r){const i=(0,o.R1)(e,a,n);if(i){const e=(0,o.K7)(i),a=t.workbook.worksheets.getItem(e.worksheetId);return await(0,o.m)(t,a,e,r)}return[]}(l,s,t,a,c)}return d}},416223:(e,t,a)=>{"use strict";a.d(t,{u:()=>l});var n=a(725556),o=a(632927),r=a(108235),i=a.n(r);const l=a(208520).memo((({text:e,...t})=>e?(0,n.jsx)("div",{...t,dangerouslySetInnerHTML:{__html:i().sanitize(e)}}):(0,n.jsx)(o.Q,{})))},423905:(e,t,a)=>{"use strict";a.d(t,{CI:()=>h,IT:()=>u,YI:()=>d,Zy:()=>s,d_:()=>p,jC:()=>f,js:()=>b,mQ:()=>l,pN:()=>c,ys:()=>g});var n=a(83437),o=a(660606),r=a(426689),i=function(){var e=0,t=a(95151);if(void 0!==(null==t?void 0:t.querySubmitTime))return e=t.querySubmitTime;var n=a(319186);return void 0!==(null==n?void 0:n.querySubmitTime)?e=n.querySubmitTime:e},l=function(e,t,a){var r;o.EG.sendErrorTelemetry(c(((r={})[n.IC.ErrorMessage]="".concat(e),r[n.IC.ErrorCategory]=n.S2.CLP,r[n.IC.ErrorCode]=t,r[n.IC.ErrorStack]=a,r)))},s=function(e){var t;o.EG.sendChatEventTelemetry(c(((t={})[n.h3.ChatEventType]=n.a5.OfficeJsApiCallForCLP,t[n.h3.ChatEventParameters]="CLP_OfficeJsApi : ".concat(e),t)))},c=function(e){return Object.keys(e).map((function(t){return{key:t,value:e[t]}}))};var d=function(e){return e||(e=n.CC.CopilotChat),JSON.stringify({featureName:e})};function u(e,t,a){var l,s;void 0===a&&(a=!0);var d={};if(t){o.EG.sendChatEventTelemetry(c(((l={})[n.h3.ChatEventType]=t.chatEventType,l[n.h3.ChatEventParameters]=t.chatEventParam,l[n.h3.ChatErrorType]=t.chatErrorType,l))),(s={})[n.CT.ErrorType]=n.T_.Client,s[n.CT.ErrorParameter]=t.chatEventType,s[n.CT.ErrorChatEventType]=t.chatEventType,s[n.CT.ErrorChatEventParameter]=t.chatEventParam,d=s;var u=t.ashaErrorDetails;u&&m(u)}e&&((0,o.cY)("User Perceived Latency :  ".concat((0,r.W)(i())," sec")),d[n.CT.UserPerceivedLatency]=(0,r.W)(i()),d[n.CT.IsQuerySuccess]=!1,o.EG.sendLatencyTelemetry(c(d),a))}function m(e){o.EG.logAshaErrorEvent(e.vetoName,e.errorString,e.featureName)}function h(e,t){return e+" "+t}var g=function(e){var t;o.EG.sendChatEventTelemetry(c(((t={})[n.h3.ChatEventType]=n.a5.ApiPluginDataReceived,t[n.h3.ChatEventParameters]=e.toString(),t)))},p=function(e){var t;o.EG.sendChatEventTelemetry(c(((t={})[n.h3.ChatEventType]=n.a5.MsgExtDataReceived,t[n.h3.ChatEventParameters]=e.toString(),t)))},b=function(e,t,a){var r;o.EG.sendLatencyTelemetry(c(((r={})[n.CT.FeatureName]="ExtensibilityDialogLoad",r[n.CT.UserPerceivedLatency]=e,r[n.CT.IsQuerySuccess]=t,r[n.CT.ErrorChatEventType]=t?"":n.a5.ExtensibilityDialogLoad,r[n.CT.ErrorChatEventParameter]=t?"":a,r)),!0)},f=function(e){var t;o.EG.sendErrorTelemetry(c(((t={})[n.IC.ErrorMessage]=e,t[n.IC.ErrorCategory]=n.S2.ExtensibilityDialog,t[n.IC.ErrorCode]="ExtensibilityDialogLoadError",t)))}},425903:(e,t,a)=>{"use strict";a.d(t,{SL:()=>g,Xh:()=>f,a2:()=>b,q1:()=>h});var n=a(702864),o=a(507628),r=a(322466),i=a(700853),l=a(63919),s=a(423905),c=a(660606),d=a(83437),u=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},m=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},h=function(e){return u(void 0,void 0,void 0,(function(){return m(this,(function(t){switch(t.label){case 0:return e&&n.xP.getCurrentAddinState()===n.aB.HasAction?[4,e()]:[3,2];case 1:t.sent(),n.xP.transitionAddinState(n.aB.Idle),t.label=2;case 2:return[2]}}))}))},g=function(e){try{var t=JSON.parse(e);if(p(t))return{id:(0,o.A)(),type:"text/adaptivecardtemplate",data:e,description_for_model:e}}catch(e){}return{id:(0,o.A)(),type:"text/plain",data:e,description_for_model:e}},p=function(e){return!(!e||"object"!=typeof e)&&("type"in e&&"AdaptiveCard"===e.type&&("body"in e&&"object"==typeof e.body))};function b(e,t,a){void 0===t&&(t=!0),void 0===a&&(a=!0);var n={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:void 0},o={chatCardType:i._.Default,chatMessageData:{defaultMessageProps:{user:l.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:n,stopLoadingUi:a,startAugloopTimerForStreaming:!1,addCardToChatHistory:t};return(0,c.cY)("Add in invocation error response message: ".concat(o)),o}function f(e){var t;c.EG.sendErrorTelemetry((0,s.pN)(((t={})[d.IC.ErrorCategory]=d.S2.LocalAddinActionExecution,t[d.IC.ErrorMessage]=e,t))),(0,c.cY)("Error executing client skill from TriggerPlugin message: \n",e)}},426689:(e,t,a)=>{"use strict";a.d(t,{W:()=>n,x:()=>o});var n=function(e){return o(e)/1e3},o=function(e){return(new Date).getTime()-e}},439720:(e,t,a)=>{"use strict";async function n(){return await Promise.all([a.e("vendors-npm_store_sdx_officecopilot_typescript_5_0_4-007004e2f84938dc12ca_node_modules_typesc-351a83","high"),a.e("ts","high")]).then(a.t.bind(a,508479,23))}async function o(e){const t=await async function(e){const t=await n(),a=t.ScriptTarget.ES2019,o=t.transpileModule(e,{reportDiagnostics:!0,compilerOptions:{target:a,lib:["dom","es2019"],allowJs:!0}});if(o.diagnostics.length)return{compileErrorMessage:o.diagnostics.map((t=>{const a=e.substr(0,t.start),n=e.substr(t.start+1),o=a.split("\n").length,r=a.lastIndexOf("\n"),i=e.substring(r,t.start+Math.max(n.indexOf("\n"),0)).trim();return function(e,t){return`Line #${e}: ${t}`}(o,`${t.messageText}\n ${i}`)})).join("\n\n")};return{outputText:o.outputText.replace('Object.defineProperty(exports, "__esModule", { value: true });',"")}}(e),a=t.compileErrorMessage,o=t.outputText;if(a)throw new SyntaxError(a);if(o)return o;throw new SyntaxError("No Code")}a.d(t,{V:()=>s});var r=a(274793);function i(e){return e.map((({name:e,version:t})=>({name:e,version:t,support:Office.context.requirements.isSetSupported(e,t)})))}var l=a(530495);async function s(e,t,a,s){let c="";const d=function(e){if(e){const t=e.storageScript.apiInfo;return!!t&&JSON.parse(t).variant===l.MH}return!0}(t),u={apiInfo:t.storageScript.apiInfo,storageId:t.storageScript.id,cacheHit:!1,parentCallId:s};JSON.parse(JSON.stringify(a)).cachedVersion=3;try{c=d?await async function(e,t,a){const o=await(0,r.J)(),l=!1;let s;try{const r=e=>e;s=await o.transformSynchronousCodeForBatchExecutionLegacy(e,{logger:void 0,scan:l,getSetSupport:i,mergeOverride:r,...t});const c=await n();if(s.outputText){const n=(e,t)=>{const n=[1107,1123,1155,1157,1182,1184,1188,1232,1312,1344,2300,2364,2393,2451,2481,2792],r=c.getPreEmitDiagnostics(t);a.syntaxErrorCodes=JSON.stringify(r.map((e=>e.code)));const i=r.filter((e=>n.indexOf(e.code)>=0)).filter((e=>e.file));return o.diagnosticsToErrorMessage(e,i)},d=o.transformSynchronousCodeForBatchExecution(e,{logger:void 0,scan:l,getSetSupport:i,mergeOverride:r,syntaxOverride:n,...t});d.outputText||(s=d)}}catch(e){throw e}const{outputText:c,failureStage:d,failureMessage:u}=s;if(d&&u)throw new SyntaxError(u);if(c)return c;throw new SyntaxError("No Code")}(e,a,u):await o(e)}catch(e){throw e.isCompileError=!0,e}return c}},448514:(e,t,a)=>{"use strict";a.d(t,{W:()=>n,x:()=>o});var n=function(e){return((new Date).getTime()-e)/1e3},o=function(e){return(new Date).getTime()-e}},448526:(e,t,a)=>{"use strict";a.d(t,{v:()=>c});var n=a(329739),o=a(660606),r=a(217425),i=a(632197),l=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},s=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},c=function(e,t){return l(void 0,void 0,void 0,(function(){var a,l;return s(this,(function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),a=void 0,e instanceof n.j?[4,e.getToken(null!=t?t:r.w8.graph)]:[3,2];case 1:return a=s.sent(),[3,4];case 2:return[4,e.getToken(null!=t?t:r.w8.graph,"graph")];case 3:a=s.sent(),s.label=4;case 4:return[2,(0,i.t)(a)];case 5:throw l=s.sent(),(0,o.cY)("Error fetching Graph token:",l),l;case 6:return[2]}}))}))}},450501:(e,t,a)=>{"use strict";e.exports=a.p+"assets/mic-permission-dialog.svg"},451373:(e,t,a)=>{"use strict";a.d(t,{P1:()=>m,XT:()=>h,o8:()=>g});var n=a(654845),o=a(964747),r=a(361292),i=a(855391),l=a(89477),s=a(691097),c=a(888810);const d={resource:i.Vs},u={resource:i.U4};class m{async authorizeStorageService(e){const t=m.getStorageScope();return this.authorizeScope(t,e)}async authorizeScope(e,t){const a=this.tokenCache;if(a){if(!(Date.now()>a.expirationTime))return a.token;this.clearStorageToken()}return this.pendingPromise||(this.pendingPromise=this.auth.authorize(e,t,m.fallbackFn).then((e=>(this.pendingPromise=void 0,this.cacheStorageToken(e,Date.now()+m.getExpirationTime()),e)))),this.pendingPromise}static putFallbackFn(e){m.fallbackFn=e}static getStorageScope(){return"makerserviceint"===g()?u:d}cacheStorageToken(e,t){Number.isInteger(t)&&(this.tokenCache={token:e,expirationTime:t})}getCachedStorageToken(){return this.tokenCache}static getExpirationTime(){return 864e5}clearStorageToken(){this.tokenCache=void 0}static getAuthProviders(){return[new l.f]}static instance(){const e=m.getAuthProviders();return m._instance||(m._instance=new m(new r.W(new n.N(new o.f(e))))),m._instance}constructor(e){this.auth=e}}var h;function g(){const e=(0,s.P)("StorageModePreference");if(e)return e;return"Dogfood"===(0,c.A)()?"makerserviceint":"makerserviceprodnew"}!function(e){e.makerserviceprodnew="makerserviceprodnew",e.makerserviceint="makerserviceint"}(h||(h={}))},463345:(e,t,a)=>{"use strict";a.d(t,{i:()=>L,G:()=>k});var n=a(725556),o=a(576583),r=a(705730),i=a(678934),l=a(276126),s=a(373971),c=a(546762),d=a(944563);const u=(0,o.n)({inlineCode:{border:`1px solid ${d.k1.colorNeutralStroke1}`,borderRadius:`${d.k1.borderRadiusMedium}`,backgroundColor:`${d.k1.colorNeutralBackground4}`,padding:"0em 0.2em",margin:"1px"}});function m({code:e}){const t=u();return(0,n.jsx)(c.E,{font:"monospace",className:t.inlineCode,children:e})}var h=a(267324),g=a(654417),p=a(9847),b=a(476730),f=a(956258),C=a(653984);a(208520);function y({className:e,children:t,featureName:a}){const o=function(e){const t=(0,C.decode)(e);return t!==e&&b.E.getInstance().updateTelemetryChatEventData({[p.h3.ChatEventType]:p.a5.FormulaSnippetData,[p.h3.ChatEventParameters]:JSON.stringify({decoding:!0,original:e.length,decoded:t.length})},f.M.getInstance()),t}("string"==typeof t[0]?t[0]:"");if(o)switch(e){case"language-formula-signature":case"language-number-format":return(0,n.jsx)(m,{code:o});case"language-excel":return(0,n.jsx)(g.$,{icon:"math",content:o,copyButtonAriaLabelSuffix:o,telemetryUsageFeatureName:a,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([o],{type:"text/plain"})}),ariaAttributes:{"aria-label":h.olU.FormulaSuggestion_FormulaSnippet_AriaLabel}})}return(0,n.jsx)("code",{className:e,children:t})}var v=a(852853),x=a(215592),T=a(486092);const S="markdown-table",w=(0,o.n)({table:{[`&.${S}`]:{fontSize:v.L.fontSizeBase200,"& thead, & th, & td":{...x.shorthands.border("1px","solid",v.L.colorNeutralStroke1)},"& th":{backgroundColor:v.L.colorNeutralBackground4},"& th:first-child":{width:"1px"},"& td:first-child":{whiteSpace:"nowrap"}}}}),E=({node:e,className:t,...a})=>{const o=w();return(0,n.jsx)("table",{...a,className:(0,T.z)(o.table,S,t)})};var I=a(416223),R=a(528804);const A=(0,o.n)({accordionPanel:{marginBottom:"6px"}});function L(e){return{...(0,R.yw9)("OfficeVSO_10219135_GridTableInMarkdown")&&e===p.q.CalculatedColumns&&{table:E},code:t=>(0,n.jsx)(y,{...t,featureName:e})}}function k(e){return{li:({index:t})=>(0,n.jsx)(F,{...e[t]}),ul:({children:e})=>(0,n.jsx)(r.n,{collapsible:!0,multiple:!0,children:e})}}function F(e){const t=function(e){let t=e.replace(/\*\*(.*?)\*\*/g,"<b>$1</b>").replace(/^-\s+(.*)/gm,"<li>$1</li>");if(/<li>/.test(t)){const e=t.indexOf("<li>"),a=t.lastIndexOf("</li>")+5;t=`${t.slice(0,e)}\n    <ul>${t.slice(e,a)}</ul>\n    ${t.slice(a)}`}return t}(e.description),a=A();return(0,n.jsxs)(i.A,{value:e.header,children:[(0,n.jsx)(l.u,{expandIconPosition:"end",children:` ${e.header}`}),(0,n.jsx)(s.v,{className:a.accordionPanel,children:(0,n.jsx)(I.u,{text:t})})]})}},464216:(e,t,a)=>{"use strict";a.d(t,{C:()=>i,p:()=>l});var n=a(380049),o=a(495501),r=a(507628);function i(e,t=!1){const a={chunks:e,isUpdatedCodeChunk:t};return{type:n.Rq.Python,metadata:JSON.stringify(a)}}class l{static getInstance(e){return l.instance||(l.instance=new l(e)),l.instance}updateCard(e,t){this.pythonResponseChunks=[...this.pythonResponseChunks,t];const a=this.pythonResponseChunks.length>1;o.n.displayPythonMergedCardResponse(this.dispatch,this.pythonResponseChunks,a,"finalText"===t.type,e,this.messageId),"finalText"===t.type&&(this.pythonResponseChunks=[],this.messageId=(0,r.A)())}dismissLoadingUI(e){const t=this.pythonResponseChunks.length>1;o.n.displayPythonMergedCardResponse(this.dispatch,this.pythonResponseChunks,t,!0,e,this.messageId),this.pythonResponseChunks=[],this.messageId=(0,r.A)()}resetCard(){this.pythonResponseChunks=[],this.messageId=(0,r.A)()}constructor(e){this.pythonResponseChunks=[],this.messageId=(0,r.A)(),this.dispatch=e}}},469069:(e,t,a)=>{"use strict";a.d(t,{j:()=>i,z:()=>l});var n=a(725556),o=a(208520);const r=(0,o.createContext)(void 0),i=()=>(0,o.useContext)(r),l=({children:e})=>{const[t]=(0,o.useState)(new Map),a=(0,o.useCallback)((e=>(t.has(e)||t.set(e,(0,o.createRef)()),t.get(e))),[t]),i=(0,o.useCallback)((e=>t.get(e)),[t]);return(0,n.jsx)(r.Provider,{value:{chartRefs:t,registerChartRef:a,getChartRef:i},children:e})}},471742:(e,t,a)=>{"use strict";a.d(t,{$Y:()=>c,AW:()=>i,XK:()=>r,vt:()=>l,z:()=>s});const n=16384,o=1048576;function r(e){const t=function(e){let t=e;if(e.left<=e.right&&e.top<=e.bottom)return e;e.left>e.right&&(t={...t,left:e.right,right:e.left});e.top>e.bottom&&(t={...t,top:e.bottom,bottom:e.top});return t}(e);return`${`${s(t.left)}${t.top}`}:${`${s(t.right)}${t.bottom}`}`}function i(e){const t=e.split(":");if(1===t.length){const t=l(e);if(0===t.row||0===t.column)throw new Error(0===t.row?"wrong cell address format with no row value":"wrong cell address format with no column value");return{left:t.column,top:t.row,right:t.column,bottom:t.row}}const a=l(t[0]),r=l(t[1]);if(0===a.column!=(0===r.column))throw new Error("wrong range address format with column value missing");if(0===a.row!=(0===r.row))throw new Error("wrong range address format with row value missing");if(a.column*r.column===0&&a.row*r.row===0)throw new Error("wrong range address format with row & column value missing");return 0===a.column&&0===r.column?{left:1,top:a.row,right:n,bottom:r.row}:0===a.row&&0===r.row?{left:a.column,top:1,right:r.column,bottom:o}:{left:a.column,top:a.row,right:r.column,bottom:r.row}}function l(e){if(e.length<1)throw new Error("Empty cell address error");let t=0,a=0;for(let n=0;n<e.length;n++)e[n]>="A"&&e[n]<="Z"?t=26*t+(e[n].charCodeAt(0)-"A".charCodeAt(0))+1:a=10*a+Number(e[n]);return{row:a,column:t}}function s(e){if(e<1)throw new Error("wrong excel column index");const t=[];let a=e;for(;0!==a;)a--,t.push(String.fromCharCode(a%26+"A".charCodeAt(0))),a=Math.floor(a/26);return t.reverse().join("")}function c(e){return l(e).column}},472096:(e,t,a)=>{"use strict";a.d(t,{$$:()=>i,Gt:()=>n,QK:()=>o,fU:()=>r});var n=function(){function e(){}return e.isWebPlatform=function(){return Office.context.platform===Office.PlatformType.OfficeOnline},e.isMacPlatform=function(){return Office.context.platform===Office.PlatformType.Mac},e.isIOSPlatform=function(){return Office.context.platform===Office.PlatformType.iOS},e.isWin32Platform=function(){return Office.context.platform===Office.PlatformType.PC},e}(),o=n.isWebPlatform,r=n.isMacPlatform,i=n.isIOSPlatform},472500:(e,t,a)=>{"use strict";a.d(t,{D:()=>f,J:()=>b});var n=a(725556),o=a(700853),r=a(856656),i=a(38417),l=a(63919),s=a(365319),c=a(207545),d=a(528804),u=a(479504),m=a(887648);const h="FormulaDev",g=(e,t)=>(0,d.yw9)("OfficeVSO_9205837_formulasDevButton")&&e&&Boolean(t)&&((0,c.I_)()||(0,d.iPS)("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)),p=async e=>{const t={chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:l.Q9.Chat,message:`\`\`\`json\n${JSON.stringify(JSON.parse(e),null,2)}\n\`\`\``}},addCardToChatHistory:!1};s.$.getInstance().displayResponse(t)};function b(e,t){if(g(e,t))return{type:r.jA.Default,title:h,text:(0,u.dD)()?void 0:h,iconRegular:i.SFT,iconHover:i.qTo,handleButtonOnClick:async()=>{p(t)}}}function f(e){const t=(0,m.d4)((e=>e.dataAI.shouldShowFormulaDevButton));if(g(t,e))return{buttonTitle:h,buttonText:h,icon:(0,n.jsx)(i.SFT,{}),handleButtonOnClick:async()=>{p(e)}}}},476730:(e,t,a)=>{"use strict";a.d(t,{E:()=>m});var n=a(965634),o=a(9847),r=a(448514),i=a(83437),l=a(956258),s=a(46566);let c=null,d=null,u=0;class m{static getInstance(){return m.telemetryEventHandler||(m.telemetryEventHandler=new m),m.telemetryEventHandler}initTelemetryLatencyObject(){d=(()=>{const e={};return Object.keys(o.CT).forEach((t=>{e[t]=0})),e})()}initTelemetryChatEventObject(){c=function(){const e={};return Object.keys(o.h3).forEach((t=>{e[t]=""})),e}()}updateTelemetryChatEventData(e,t){null===c&&this.initTelemetryChatEventObject(),Object.keys(e).forEach((t=>{c[t]=e[t]})),t&&this.sendTelemetryChatEventData(t)}logUserPerceivedLatencyTelemetry(e,t,a=!1,n,i,l){null===d&&this.initTelemetryLatencyObject(),d&&n&&this.updateTelemetryLatencyData({[o.CT.OperationName]:e?o.OP.FirstChunkFinalResponse:o.OP.LastChunkFinalResponse,[o.CT.UserPerceivedLatency]:(0,r.W)(n),[o.CT.IsQuerySuccess]:t,[o.CT.IsSuccessful]:t,[o.CT.IsFromCache]:a??"",[o.CT.FeatureName]:i?l??i.getActiveFeature():""},i)}logStopGeneratingLatencyTelemetry(e,t,a){null===d&&this.initTelemetryLatencyObject(),d&&e&&(d[o.CT.StopGeneratingTime]=(0,r.W)(e),t&&(d[o.CT.FeatureName]=a??t.getActiveFeature(),this.sendTelemetryLatencyData(t)))}updateTelemetryLatencyData(e,t){null===d&&this.initTelemetryLatencyObject(),Object.keys(e).forEach((t=>{d&&(d[t]=e[t])})),t&&this.sendTelemetryLatencyData(t)}sendTelemetryLatencyData(e){null!=e&&null!=d&&(e.logEvent(h(d),e.getDefaultEventFlags()),this.initTelemetryLatencyObject())}logLatency(e,t,a=!0,n=""){const r={[o.CT.Duration]:e,[o.CT.OperationName]:t,[o.CT.IsSuccessful]:a,[o.CT.FeatureName]:n};l.M.getInstance().logEvent(h(r))}sendTelemetryChatEventData(e){null!=e&&c&&(e.logEvent(function(e){return e[o.h3.UserQueryGuid]=l.M.userQueryGuid,e[o.h3.UserQueryOrder]=l.M.userQueryOrder,{eventType:n.S2.ChatEvents,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}}(c)),this.initTelemetryChatEventObject())}static redactUrl(e,t){switch(e){case"spoppe-b.azureedge.net":return t.endsWith("assets/icons/fabric-icons-a13498cf.woff")?e+t:"";case"fa000000124.resources.office.net":return t.endsWith("taskpane.css")||t.endsWith("officethemes.css")||t.endsWith("assets/office-js/excel.js")||t.endsWith("taskpane.js")||t.endsWith("office_strings.js")||t.endsWith("assets/office-js/webauth/webauth.browserauth.js")||t.endsWith("favicon.ico")||t.endsWith("calc.js")||t.endsWith("oss.js")||t.endsWith("ts.js")||t.endsWith("vendors~calc.js")||t.endsWith("vendors~oss.js")?e+t:"";case"login.microsoftonline.com":return"/common/discovery/instance"===t||"/organizations/oauth2/v2.0/authorize"===t||"/organizations/oauth2/v2.0/token"===t||"/organizations/v2.0/.well-known/openid-configuration"===t?e+t:"";case"alcdn.msauth.net":return t.endsWith("js/msal-browser-1p.min.js")?e+t:"";case"browser.events.data.microsoft.com":return"/OneCollector/1.0/"===t?e+t:"";default:return e.endsWith("officescripts.microsoftusercontent.com")&&"/eed0a086-3498-4f91-a377-1e0265ecc0cc"===t?`officescripts.microsoftusercontent.com${t}`:""}}logPerformanceEntries(e){try{for(const t of e)switch(t.entryType){case"navigation":this.logLatency(t.duration,o.OP.Navigation);break;case"resource":if("xmlhttprequest"!==t.initiatorType){const e=new URL(t.name),a={[o.CT.Duration]:t.duration,[o.CT.OperationName]:o.OP.FetchResource,[o.CT.IsSuccessful]:!0,FullUrl:m.redactUrl(e.hostname,e.pathname),SafeDomain:e.hostname.split(".").slice(-2).join("."),StartTime:t.startTime};l.M.getInstance().logEvent(h(a))}}}catch(e){l.M.getInstance().logError({eventType:n.S2.Latency,errorMessage:e instanceof Error?e.message:"Unknown error encountered logging performance entries",logLevel:i.$b.Error})}}setInitContextTime(){u=performance.now()}logTableRecognized(){0!==u&&(u=0,this.logLatency(performance.now()-u,o.OP.RecognizeTable))}logTableMetadata(e){l.M.getInstance().logEvent({eventType:n.S2.TabularRange,eventData:[{key:n.Wg.TableMetadata,value:JSON.stringify(e)}]})}}function h(e){return e[o.CT.UserQueryGuid]=l.M.userQueryGuid,e[o.CT.AugloopSessionGuid]=s.O,{eventType:n.S2.Latency,eventData:Object.keys(e).map((t=>({key:t,value:e[t]})))}}},479504:(e,t,a)=>{"use strict";a.d(t,{OK:()=>l,Ok:()=>r,dD:()=>s,mw:()=>i});var n=a(545892),o=a(95151);function r(){switch(Office.context.platform){case Office.PlatformType.PC:(0,o.setClientPlatformType)(n.Y.win32);break;case Office.PlatformType.iOS:(0,o.setClientPlatformType)(n.Y.IOS);break;case Office.PlatformType.Mac:(0,o.setClientPlatformType)(n.Y.MACOS);break;default:(0,o.setClientPlatformType)(n.Y.web)}}function i(){return{[Office.PlatformType.iOS]:n.Y.IOS,[Office.PlatformType.Mac]:n.Y.MACOS,[Office.PlatformType.PC]:n.Y.win32}[Office.context.platform]??n.Y.web}const l=()=>Office.context.platform===Office.PlatformType.iOS||Office.context.platform===Office.PlatformType.Mac,s=()=>Office.context.platform===Office.PlatformType.iOS},479592:(e,t,a)=>{"use strict";a.d(t,{Be:()=>T,I1:()=>y,K4:()=>v,Xs:()=>n,f6:()=>f,ge:()=>C});var n,o,r=a(632512),i=a(392210),l=a(267324),s=a(255448),c=a(956258),d=a(9847),u=a(797639),m=a(357781),h=a(14086),g=a(299512),p=a(528804),b=a(390624);async function f(e){if(!(0,p.qTy)()||!e)return!1;if(0===(e&(s.ye.DuplicateHeaders|s.ye.HasMergedCells|s.ye.EmptyHeaders)))return!1;const t=s.ye.RowMajor|s.ye.TotalsRow|s.ye.DuplicateHeaders,a=t|s.ye.HasMergedCells|s.ye.EmptyHeaders;return 0===(e&~t)||!(!Office.context.requirements.isSetSupported("excelapiundo","1.31")||0!==(e&~a))&&(!(e&s.ye.EmptyHeaders)||await async function(){try{return await Excel.run((async e=>{const t=u.CP.getActiveTable();if(!t)throw new Error("NoActiveTable");const a=e.workbook.worksheets.getItemOrNullObject(t.sheetRange.sheet),n=a.getRange((0,h.r)(t.address)),o=I(t),r=E(n,o);if(r.load("valueTypes, isNullObject"),await e.sync(),r.isNullObject||a.isNullObject)throw new Error("NoHeaderRange");const i=r.valueTypes,l="rowMajor"===o,s=i.flatMap(((e,t)=>e.map(((e,a)=>e===Excel.RangeValueType.empty?l?t:a:void 0)))).filter((e=>void 0!==e));if(0===s.length)return!1;const c=s.map((e=>{const t=l?n.getRow(e):n.getColumn(e);return t.load("isNullObject, valueTypes"),t}));await e.sync();return 0===c.filter((e=>!e.isNullObject&&e.valueTypes.every((e=>e.every((e=>e===Excel.RangeValueType.empty)))))).length}))}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRValidateEmptyHeadersFailed,e),!1}}())}async function C(){try{return await Excel.run((async e=>{const t=u.CP.getActiveTable();if(!t)throw new Error("NoActiveTable");const a=S(e,t).tableRange.getMergedAreasOrNullObject();return a.load("areas/items/addressLocal"),await e.sync(),a.isNullObject?[]:a.areas.items.map((e=>e.addressLocal))}))}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRRetrieveMergeCellsFailed,e),[]}}async function y(){return R("EmptyHeaders")}async function v(){return R("DuplicateHeaders")}async function x(e){let t=1;try{const{context:a,tableRange:n,orientation:o}=e,r=E(n,o),i="rowMajor"===o;let l;if(r.load("values"),await a.sync(),l=i?r.values.flat():r.values[0],w(l)){const e=function(e,t){const a=new Map;let n=2;return e.map((e=>{const o=a.get(e)||0;if(a.set(e,o+1),0===o)return e;let r=`${e}${n}`;for(;t.has(r);)n++,r=`${e}${n}`;return n++,r}))}(l,function(e){const t=new Map;return e.forEach((e=>{const a=t.get(e)||0;t.set(e,a+1)})),t}(l));w(e)?t=2:(r.values=i?e.map((e=>[e])):[e],await a.sync(),t=0)}return t}catch(e){t=2,c.M.getInstance().logErrorCode(r.O.TLRFixDuplicatesFailed,e)}return t}async function T(e){await u.CP.fetchAndSetActiveTableLikeEntity(e);const t=u.CP.getActiveTable();if(!t||!(0,g.P9)(e,t.name))return c.M.getInstance().logErrorCode(r.O.AutoFixTLRFailed,new Error("NoActiveTable")),2;try{return await(0,b.F5)((async e=>{const a=S(e,t),n=t.tableLikeRangeFeatures;if(!n)return 1;if(n===s.ye.DuplicateHeaders)return await x(a);if(Office.context.requirements.isSetSupported("excelapiundo","1.31")){const e=await async function(e,t){const a=[];t&s.ye.HasMergedCells&&a.push(await async function(e){try{const{context:t,tableRange:a}=e,n=a.getMergedAreasOrNullObject();return n.load("areas/items/values"),await t.sync(),n.isNullObject?(a.unmerge(),await t.sync(),0):(n.areas.items.forEach((e=>{const t=e.values.flat().find((e=>e!==Excel.RangeValueType.empty));e.unmerge(),e.values=e.values.map((e=>e.map((()=>t))))})),a.unmerge(),await t.sync(),0)}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRFixMergedCellsFailed,e),2}}(e));t&s.ye.EmptyHeaders&&a.push(await async function(e){try{const{context:t,tableRange:a,orientation:n}=e,o=E(a,n);if(o.load("valueTypes, isNullObject"),await t.sync(),o.isNullObject)throw new Error("NoHeaderRange");const r=o.valueTypes,i="rowMajor"===n,s=r.flatMap(((e,t)=>e.map(((e,n)=>{if(e===Excel.RangeValueType.empty){const e=a.getCell(t,n),o=i?`${(0,l.yfY)()}${t+1}`:`${(0,l.AWH)()}${n+1}`;return e.values=[[o]],e}})))).filter((e=>void 0!==e));return await t.sync(),s.length>0?0:1}catch(e){return c.M.getInstance().logErrorCode(r.O.TLRFixEmptyHeadersFailed,e),2}}(e));return a.push(await x(e)),a}(a,n);if(e.includes(2))throw new Error("AutoFixUnsuccessful");if(e.includes(0))return n&s.ye.HasMergedCells&&u.CP.clearMergedCellsFromActiveTable(),0}return 1}))}catch(e){return"AutoFixUnsuccessful"===e.message?await(0,b.tN)(d.q.ContextInference):c.M.getInstance().logErrorCode(r.O.AutoFixTLRFailed,e),2}}function S(e,t){const a=e.workbook.worksheets.getItem(t.sheetRange.sheet),n=a.getRange((0,h.r)(t.address));return{context:e,sheet:a,tableRange:n,orientation:I(t)}}function w(e){return new Set(e).size!==e.length}function E(e,t=i.YV.ColumnMajor){return t===i.YV.RowMajor?e.getColumn(0):e.getRow(0)}function I(e){return e?.tableLikeRangeFeatures&&e.tableLikeRangeFeatures&s.ye.RowMajor?i.YV.RowMajor:i.YV.ColumnMajor}async function R(e){try{const t=u.CP.getActiveTable();if(!t)throw new Error("NoActiveTable");return await Excel.run((async a=>{const n=S(a,t),o=E(n.tableRange,n.orientation);o.load("values"),await a.sync();const r=o.values[0],i=t.sheetRange.range.topLeft;if("EmptyHeaders"===e)return r.map(((e,t)=>{if(!e){if(!i.column||!i.row)throw new Error("Invalid table address format");return(0,m.LM)(i.row+1,i.column+t+1)}return null})).filter((e=>null!==e));{const e=new Map;return r.forEach(((t,a)=>{if(t){if(!i.column||!i.row)throw new Error("Invalid table address format");const n=(0,m.LM)(i.row+1,i.column+a+1);e.has(t)?e.get(t)?.push(n):e.set(t,[n])}})),Array.from(e.values()).filter((e=>e.length>1)).flat()}}))}catch(t){return"EmptyHeaders"===e?c.M.getInstance().logErrorCode(r.O.TLRRetrieveEmptyHeaderCellsFailed,t):c.M.getInstance().logErrorCode(r.O.TLRRetrieveDuplicateHeaderCellsFailed,t),[]}}!function(e){e[e.Success=0]="Success",e[e.NoChangeMade=1]="NoChangeMade",e[e.Unsuccessful=2]="Unsuccessful"}(n||(n={})),function(e){e.NoActiveTable="NoActiveTable",e.NoHeaderRange="NoHeaderRange",e.AutoFixUnsuccessful="AutoFixUnsuccessful"}(o||(o={}))},480591:(e,t,a)=>{"use strict";a.d(t,{BI:()=>f,jX:()=>n});var n,o=a(700853),r=a(104450),i=a(660606),l=a(423905),s=a(83437),c=a(638753),d=a(702864),u=a(425903),m=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},h=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},g=new Set([r.n3.TriggerConfirmation,r.n3.TriggerPluginAuth,r.n3.TriggerPlugin]),p=function(e){return g.has(null==e?void 0:e.messageType)},b=function(e,t,a,n,r){return m(void 0,void 0,void 0,(function(){var i,l;return h(this,(function(s){switch(s.label){case 0:return d.xP.setIsAddinFlow(!0,(function(){(0,c.An)(e,!0)})),[4,null!==(l=null===(i=e.current)||void 0===i?void 0:i.executeClientSkillFromInterstitialMessage({chatCardType:o._.InterstitialMessage,stopLoadingUi:!1,chatMessageData:{interstitialMessageProps:{user:"chat",interstitialMessages:r?n:[t],skillRequest:1===a.length?a[0]:void 0,skillRequests:a.length>1?a:void 0}},chatMessageBodyData:{messageId:t.messageId},addCardToChatHistory:!1}))&&void 0!==l?l:Promise.resolve()];case 1:return s.sent(),[2]}}))}))},f=function(e,t,a){return m(void 0,void 0,void 0,(function(){var m,g,f,C,y,v;return h(this,(function(h){switch(h.label){case 0:return m=null!==(y=e.messages)&&void 0!==y?y:[],g=m[m.length-1],0!==m.length&&p(g)?g.messageType===r.n3.TriggerPlugin?[3,1]:[3,6]:[2,!1];case 1:if(!a.enableAddinLocalPluginActions)return[3,5];f=function(e){for(var t,a=null!==(t=e.messages)&&void 0!==t?t:[],n=[],o=a.length-1;o>=0;o--){var i=a[o];if((null==i?void 0:i.messageType)!==r.n3.TriggerPlugin)break;n.push(i)}return n.reverse()}(e),(0,i.cY)("TriggerPlugin messages:",f),C=function(e){return e.map((function(e){var t,a;return{correlationId:null===(t=e.localTransportRequest)||void 0===t?void 0:t.correlation_id,localEndpoint:"InvokeAddInLocalPlugin/TriggerPlugin/"+(null==e?void 0:e.pluginInfo.data.MetaOSTitleId),payload:null===(a=e.localTransportRequest)||void 0===a?void 0:a.invocation.payload,sourceRequestId:e.sourceRequestId,actionId:e.actionId}}))}(f),function(e){var t;n=Date.now(),i.EG.sendChatEventTelemetry((0,l.pN)(((t={})[s.h3.ChatEventType]=s.a5.LocalAddinActionInvoked,t[s.h3.ChatEventParameters]=JSON.stringify({numberOfTriggerPluginMessages:e}),t)))}(f.length),h.label=2;case 2:return h.trys.push([2,4,,5]),[4,b(t,g,C,m,a.passAllMessages)];case 3:return h.sent(),[3,5];case 4:return function(e,t){var a,o;d.xP.setIsAddinFlow(!1,(function(){(0,c.An)(t,!1)})),n=void 0,o=e instanceof Error?e.message:"string"==typeof e?e:"Unknown error",(0,u.Xh)(o),null===(a=t.current)||void 0===a||a.addResponseMessage((0,u.a2)(o))}(h.sent(),t),[3,5];case 5:return[3,7];case 6:null===(v=t.current)||void 0===v||v.addResponseMessage({chatCardType:o._.InterstitialMessage,stopLoadingUi:!0,chatMessageData:{interstitialMessageProps:{user:"chat",interstitialMessages:a.passAllMessages?m:[g]}},chatMessageBodyData:{messageId:g.messageId},addCardToChatHistory:!1}),h.label=7;case 7:return[2,!0]}}))}))}},494554:(e,t,a)=>{"use strict";a.d(t,{N:()=>o});var n=a(79458);function o(e){if(!e.chatMessageData?.defaultMessageProps)return(0,n.cY)("Message provided to getFluxProgramResponseFromDefaultMessage had no defaultMessageProps"),"";const t=e.chatMessageData.defaultMessageProps;let a="";if(t?.messageHeader&&(a=a+r(t.messageHeader)+"\n"),t?.embeddedLists)for(const e of t.embeddedLists){if(e.listHeader&&(a=a+e.listHeader+"\n"),e.listItems)for(const t of e.listItems)a+=t.title?`${t.title}: ${t.text+"\n"}`:""+(t.text+"\n");e.listFooter&&(a=a+r(e.listFooter)+"\n")}return t?.messageFooter&&(a+=r(t.messageFooter)),a}function r(e){let t="";return e?.text&&(t+=e.text),e?.linkText&&(t=t+e.linkText.text+e.linkText.linkSuffix??""),t}},495501:(e,t,a)=>{"use strict";a.d(t,{n:()=>ue});var n=a(644082),o=a(700853),r=a(322466),i=a(63919),l=a(626128),s=a(9847),c=a(797639),d=a(49236),u=a(79458),m=a(472500),h=a(357781),g=a(340889),p=a(949404),b=a(208442),f=a(463345),C=a(644737),y=a(119202),v=a(369169),x=a(528804);const T=s.q.CalculatedColumns,S="Copilot\\Formula Generation";const w={getFormulaSuggestionErrorResponse:function(e,t,a,n){const o=(0,m.J)(t.shouldShowFormulaDevButton,t.debugInfo),{message:r,telemetry:i}=(0,p.v)(e,{errorType:a??s.q0.ClientError,featureName:T},{embeddedLists:[{listItems:n}]},{feedbackData:{feedbackArea:S},...o?{actionButtonList:[o]}:{}});return{message:r,telemetry:i}},getFormulaSuggestionInsertSuccessResponse:function(e,t,a){return{message:{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:i.Q9.Chat,message:e}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:S},actionButtonList:(0,x.BAK)()?[(0,C.FW)(T,t,a)]:[]}},telemetry:{featureName:T,eventType:s.a5.ActionConfirmationMessage}}},getFormulaSuggestionResponse:function(e,t,a){const n=a[t],i=0===t,m=c.CP.getActiveTable(),p=m?.address,b=m?.sheetRange.sheet,f="number"==typeof m?.sheetRange.range.topLeft.column?(0,h._c)(n,{columnCount:m.numColumns,columnIndex:m.sheetRange.range.topLeft.column}):void 0,C=(0,l.cY)(n)&&null!=m?.sheetRange.range.bottomRight.row?m.totalRow?m.sheetRange.range.bottomRight.row+1:m.sheetRange.range.bottomRight.row+2:void 0,x=(0,g.Fp)(i,n,p,b,f,C),T=(0,v.kJ)(n);return(0,u.cY)("getFormulaSuggestionResponse",{requestId:e,requestIndex:t,recommendation:n,recommendationModels:a,textForChatHistory:x}),n||(0,u.cY)("formulaSuggestionModels: no recommendation"),{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:(0,d.IM)("FormulaSuggestion_V2",{requestId:e,isMainRecommendation:i,recommendation:n,targetAddress:p,targetSheet:b,columnLetters:f,rowNumber:C,showPreview:T}),textContent:x}},chatMessageBodyData:{messageId:n.id,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:S,contextData:{cardMetaData:JSON.stringify({suggestionId:a[0]?.id}),feedbackClientAppName:(0,y.f2)()}}}},telemetry:{featureName:(0,l.cY)(n)?s.q.CalculatedRows:s.q.CalculatedColumns,eventType:s.a5.SuggestionMessage}}},getFormulaSuggestionMarkdownResponse:function(e,t,a,n){return{message:{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e.response,horizontalTableScroll:!0,componentsOverride:(0,f.i)(s.q.CalculatedColumns),disableLinksProcessing:!1}},chatMessageBodyData:{messageId:e.id,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:S,contextData:{cardMetaData:JSON.stringify({suggestionId:e.id}),feedbackClientAppName:(0,y.f2)()}},actionButtonList:(0,b.v)(t,e,a,n)},addCardToChatHistory:!0},telemetry:{featureName:s.q.CalculatedColumns,eventType:s.a5.SuggestionMessage}}},getInsertSuggestionUserChat:function(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:T,eventType:s.a5.HumanInput}}}};var E=a(549815),I=a(365319),R=a(267324),A=a(380049);const L=s.q.DataShaping,k="Copilot\\Data Shaping";function F(e,t,a){const n="StartDataShaping_V1"===e?(0,g.eo)():(0,g.N2)(),l={chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:i.Q9.Chat,renderData:(0,d.IM)(e,a),textContent:n}},chatMessageBodyData:{aiResponseMetadata:{metadata:t,type:A.Rq.ContentCreation},shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:k}},stopLoadingUi:!0},c={featureName:L,eventType:s.a5.SuggestionMessage};return I.$.getInstance().displayResponse(l,c),{message:l,telemetry:c}}const _={getDataShapingSuccessResponse:function(e,t,a){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{aiResponseMetadata:{metadata:t,type:A.Rq.ContentCreation},shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:k},actionButtonList:a&&(0,x.BAK)()?[(0,C.yq)(a,L)]:[]}},telemetry:{featureName:L,eventType:s.a5.ActionConfirmationMessage}}},getDataShapingErrorResponse:function(e,t){const a=e||(0,R.$oZ)(),n=JSON.stringify({requestJson:t});return(0,p.v)(a,{featureName:L,errorType:s.q0.ClientError},{},{aiResponseMetadata:{metadata:n,type:A.Rq.ContentCreation},feedbackData:{feedbackArea:k}})},getExitModeResponse:function(e,t){const a="replace"===e?(0,R.K1Z)():"newSheet"===e?(0,R.gXw)():(0,R.lp5)();return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:a}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,aiResponseMetadata:{metadata:t,type:A.Rq.ContentCreation},feedbackData:{feedbackArea:k},actionButtonList:[]}},telemetry:{featureName:L,eventType:s.a5.ActionConfirmationMessage}}},displayStartDataShapingResponse:function(e,t,a,n,o,r,i){return F("StartDataShaping_V1",JSON.stringify({queryScript:r,requestJson:i}),{requestId:e,sessionId:a,tableName:t,mashupDocument:n,queryName:o,queryScript:r})},displayDataShapingIntroResponse:function(e,t){return F("DataShapingIntro_V1",e,{requestId:t})}};var P=a(73915),N=a(956933),M=a(113033);const O={getExternalMessageResponse:function(e){return e.isHuman?function(e){const t={chatCardType:e.isMarkdownText?o._.MarkdownCard:o._.Default,chatMessageData:e.isMarkdownText?{markDownCardProps:{user:P.Q9.Human,message:e.text}}:{defaultMessageProps:{user:P.Q9.Human,messageHeader:{text:e.text}}},chatMessageBodyData:{messageId:e.messageId},stopLoadingUi:!1,addCardToChatHistory:e.addToChatHistory},a={featureName:s.q.ExternalTriggeredQuery,eventType:s.a5.DisplayExternalMessages};return{message:t,telemetry:a}}(e):function(e){const t=(0,M.u)(e.contentOrigin,!1),a=t.feedbackData?.feedbackArea,n={chatCardType:e.isMarkdownText?o._.MarkdownCard:o._.Default,chatMessageData:e.isMarkdownText?{markDownCardProps:{user:P.Q9.Chat,message:e.text,horizontalTableScroll:!0,componentsOverride:(0,M.X)(t)}}:{defaultMessageProps:{user:P.Q9.Chat,messageHeader:{text:e.text}}},chatMessageBodyData:{messageId:e.messageId,shouldShowAIGeneratedIndicator:e.aiGenerated,showAnimation:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:a??"Copilot",contextData:{feedbackClientAppName:(0,y.f2)()}},clpSensitivityIndicatorData:e.clpData?(0,N.Q9)(e.clpData):void 0,shouldShowCopyButton:!0,shouldShowHandoffButton:!0,shouldShowReadAloudButton:!0},stopLoadingUi:!1,addCardToChatHistory:e.addToChatHistory},i={featureName:t.telemetryFeatureName,eventType:s.a5.DisplayExternalMessages};return{message:n,telemetry:i}}(e)}};var D=a(31118),B=a(651537),$=a(922873),H=a(956258),U=a(299512),q=a(911126),V=a(804672),G=a(593717),W=a(507628);var z=a(413563);const j=async e=>{e&&window.open(e,"_blank")};function Q(e,t){return{linkText:{text:e,linkOnClick:j,linkUrl:t}}}function J(){return{messageHeader:{text:(0,R.eII)(),linkText:{text:R.Klw,linkOnClick:j,linkUrl:R.COL}}}}const Y={getJunkQueryResponse:function(){const e=(0,R.AWW)();return(0,p.v)(e,{errorType:s.q0.DetectedJunkQuery})},getHelpQueryResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.svm)()},embeddedLists:[{listItems:[{text:(0,R.L1E)()},{text:(0,R.UVk)()},{text:(0,R.$cm)()},{text:(0,R.UGc)()}]}],messageFooter:{text:(0,R.aXL)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.HelpMessage}}},getLearnMoreResponse:function(){const e=[];for(const t of(0,R.BU1)())e.push({text:t});return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.bcx)()},embeddedLists:[{listItems:e}],messageFooter:Q((0,R.VHx)(),R.wZB)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.HowCanCopilotHelpSuggestionClicked}}},getAugloopTimeoutResponse:function(e){const t=H.M.getInstance(),a=c.CP.pythonContextManager.isPythonMode?(0,R.ZgC)():(0,R.CY_)();return(0,p.v)(a,{errorType:s.q0.AugloopTimeout,featureName:(0,x.yw9)("OfficeVSO_9771900_ErrorFeatureAttribution")?t.getUsageFeatureForStandardizedFeature(e):s.q.CopilotChat})},getStopGeneratingResponse:function(e){const t=c.CP.pythonContextManager.isPythonMode?(0,R.lJi)():e===s.OP.ImportDataGenerateSuggestion||e===s.OP.ImportDataRelevancyCheck?(0,R.Vd6)():(0,R.s_X)(),a={chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:t}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,messageAttributionProps:(0,y.qN)()}};let n=s.q.CopilotChat;return e===s.OP.AnalyzeData?n=s.q.AnalyzeData:e===s.OP.CalculatedColumns?n=s.q.CalculatedColumns:e===s.OP.CalculatedCells&&(n=s.q.CalculatedRows),{message:a,telemetry:{featureName:n,eventType:s.a5.StopButtonClicked}}},getChangeTopicResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.pH2)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.ChangeTopicButtonClicked}}},getAugloopErrorResponse:async function(e,t,a){const n=(0,V.uN)(e);let l=n,d=s.q0.ServiceError,u=!0,m={};const h=e.category;let g,b=!0;const{errorCode:f,tlrSkillSupport:y,contextFailures:v,inferredTableName:T}=(0,z.D)(e),S=v?(0,U.AG)(v):void 0;switch(h){case B.E.LicensingError:l=(0,R.iUs)(),d=s.q0.LicensingError,u=!1,m=J();break;case B.E.OffensiveContent:l=R.olU.ServerErrorWithNoRetry,d=s.q0.DetectedOffensiveContent;break;case B.E.TokenCountError:l=n,d=s.q0.TokenCount;break;case B.E.UnsupportedLanguageError:{d=s.q0.DetectedUnsupportedLanguage;const e=t?.outputAnswerLanguage,a=(0,G.w)(e);m={messageHeader:{text:a?R.olU.CopilotUnsupportedLanguageError.replace("%s",a):R.olU.CopilotUnsupportedlanguageMessage,linkText:{text:R.olU.CopilotSupportedLanguagesLearnMoreLink,linkUrl:R.JF4,linkSuffix:"\n\n"+R.olU.FeedbackPrompt}}};break}case B.E.InputQueryError:e.json?"unsupported-multi-agent"===f?(l=n,d=s.q0.DetectedMultipleIntents):"out-of-scope"===f?(l=(0,R.AWW)(),d=s.q0.DetectedOutOfScope):"bad-token"===f?(l=(0,R.iUs)(),d=s.q0.BadToken,u=!1,m=J()):"too-short"===f?(l=(0,R.l_I)(),d=s.q0.DetectedTooShort):(l=n,d=s.q0.ServiceError):(l=n,d=s.q0.ServiceError);break;case B.E.ExcelTabularSkillFailedError:T&&await c.CP.fetchAndSetActiveTableLikeEntity(T),S?g=(0,q.rE)(S):y?g=await(0,q.X$)(y):(l=n,d=s.q0.ServiceError);break;case B.E.InferenceAPIError:(0,x.yw9)("OfficeVSO_9076919_ShowThrottlingErrorMessage")&&"user-throttled"===f?(l=(0,R.UDz)(),d=s.q0.UserThrottled):(l=n,d=s.q0.ServiceError);break;case B.E.IgnorableError:case B.E.SydneyError:"out-of-credits"===f&&(l=(0,R.R_I)());break;case B.E.OfficeJsSkillFailedError:l=n,d=s.q0.ServiceError;break;case B.E.PythonSkillFailedError:{l=n,d=s.q0.ServiceError;const t=e.json?JSON.parse(e.json):void 0,a=(0,x.yw9)("OfficeVSO_10393641_UpdateAASkillName")&&(0,x.EJJ)()?$.w.NewPythonSkillName:$.w.PythonSkillName,c=t?.code===$.w.AnswersName?$.w.AnswersName:a;H.M.getInstance().setActiveFeatureWithContentOrigin(c),g=function(e,t={},a={},n={},l={}){const c=(0,W.A)(),d=H.M.getInstance().getActiveFeature(),u=H.M.getInstance().getUsageFeatureForStandardizedFeature(d),m=H.M.getInstance().featureNameToFeedbackArea(u);return{message:{...l,chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e},...a}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:m},isFailure:!0,messageId:c,actionButtonList:(0,x.jHv)()?[(0,C.yo)(c)]:void 0,...n}},telemetry:{featureName:u,eventType:s.a5.ErrorMessage,...t}}}(l,{errorType:d},m);break}default:l=n,d=s.q0.ServiceError,b=!1}return g||(g=(0,p.v)(l,{errorType:d,featureName:(0,x.yw9)("OfficeVSO_10350403_AddErrorParamToGenericErrorResponse")&&a?H.M.getInstance().getUsageFeatureForStandardizedFeature(a):s.q.CopilotChat},m)),!b&&(0,x.thH)()||(0,D.y)(e,H.M.getInstance().getActiveFeature()),g.telemetry.useClientSideErrorMessage=b,g.message.addCardToChatHistory=u,(0,x.jHv)()&&(g.telemetry.devInfo={category:e.category,message:e.message,json:JSON.parse(e.json??"{}")}),g},getZeroQueryResponse:function(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.ZeroQueryMessageSuggestionClicked}}},getStreamingResponse:function({basin:e,uniqueId:t,accessPath:a,value:n,actionButtonList:l}){return{message:{chatCardType:o._.StreamingAdaptiveCard,chatMessageData:{streamingAdaptiveCardProps:{user:i.Q9.Chat,basin:e,uniqueId:t,accessPath:a,value:n}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,actionButtonList:l}},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.ConversationMessage}}},getLanguageUnavailableResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.rZm)()},messageFooter:Q((0,R.Amo)(),R.JF4)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1},addCardToChatHistory:!1},telemetry:{featureName:s.q.CopilotChat,eventType:s.a5.LanguageNotAvailableMessage}}},getExternalTriggeredQueryResponse:function(e,t){return{message:!0===t?{chatCardType:o._.MarkdownCard,chatMessageData:{markDownCardProps:{user:i.Q9.Human,message:e}}}:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:s.q.ExternalTriggeredQuery,eventType:s.a5.SuggestionMessage}}},getChatHistoryHydrationFailed:function(){return(0,p.v)((0,R.Bjy)(),{errorType:s.q0.ChatHistoryHydrationFailed},void 0,{messageId:"chatHistoryHydrationFailed"},{addCardToChatHistory:!1})},getDisengagedErrorResponse:function(e){const t=H.M.getInstance();return(0,p.v)((0,R.KC)(),{errorType:s.q0.OrchestratorDisengaged,featureName:(0,x.yw9)("OfficeVSO_9771900_ErrorFeatureAttribution")?t.getUsageFeatureForStandardizedFeature(e):s.q.CopilotChat},void 0,void 0,{addCardToChatHistory:!0})},getTableLikeRangesLoadingResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.C3N)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer}},telemetry:{featureName:s.q.ContextInference,eventType:s.a5.LoadingTableLikeRangesWarning}}},getChartRecommendationsInProgressResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.tOz)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1}},telemetry:{featureName:s.q.ChartDesignRecommendations,eventType:s.a5.ChartDesignRecommendationsInProgress}}}},X="Copilot\\Import Data";function Z(e){return e.length>0?(0,R.h9u)().replace("{0}",e.length.toString()):(0,R.u1U)()}const K={getImportDataResponse:function({importType:e,requestId:t,dataSources:a,messageId:n,userQueryGuid:l,clpData:c,performedFallbackToAllTables:u}){return{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:i.Q9.Chat,renderData:(0,d.IM)("ImportData_V1",{requestId:t,dataSources:a,messageId:n,userQueryGuid:l,performedFallbackToAllTables:u}),textContent:Z(a)}},chatMessageBodyData:{messageId:t,shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:X},clpSensitivityIndicatorData:c&&""!==c.labelId?c:void 0}},telemetry:{featureName:e,eventType:s.a5.ImportDataCard}}},getImportDataSimpleMessage:function(e,t){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{actionButtonList:[],shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:X}}},telemetry:{featureName:t,eventType:s.a5.ActionConfirmationMessage}}}},ee=s.q.InsertTable,te="Copilot\\Insert Table";const ae={getInsertTableErrorResponse:function(e,t,a){const{message:n,telemetry:o}=(0,p.v)(e,{errorType:t??s.q0.ClientError,featureName:ee},{embeddedLists:[{listItems:a}]},{feedbackData:{feedbackArea:te}});return{message:n,telemetry:o}},getInsertTableSuccessResponse:function(e,t){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:te},actionButtonList:(0,x.BAK)()?[(0,C.FW)(ee)]:[]}},telemetry:{featureName:ee,eventType:s.a5.ActionConfirmationMessage}}}};var ne=a(648870),oe=a(46445);const re=s.q.PythonCalculatedColumns,ie="Copilot\\Python Calculated Columns";const le={getPythonCalculatedColumnSuggestionResponse:function(e,t,a,n,i,l){return{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{renderData:(0,d.IM)("PythonCalculatedColumn_V1",{requestId:e,recommendation:t,targetAddress:a,columnLetters:n,sheetId:i,insertCallback:l})}},chatMessageBodyData:{messageId:t?.id,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ie,contextData:{cardMetaData:JSON.stringify({suggestionId:t.id}),feedbackClientAppName:(0,y.f2)()}}}},telemetry:{featureName:s.q.PythonCalculatedColumns,eventType:s.a5.SuggestionMessage}}},getPythonColumnInsertResponse:function(e,t){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ie},actionButtonList:(0,x.BAK)()?[(0,C.FW)(re,t)]:[]}},telemetry:{featureName:s.q.PythonCalculatedColumns,eventType:s.a5.ActionConfirmationMessage}}},getPythonColumnSuggestionErrorResponse:function(e,t,a){const{message:n,telemetry:o}=(0,p.v)(e,{errorType:t??s.q0.ClientError,featureName:re},{embeddedLists:[{listItems:a}]},{feedbackData:{feedbackArea:ie}});return{message:n,telemetry:o}},getPythonColumnInsertErrorResponse:function(e,t){const a={featureName:s.q.PythonCalculatedColumns,eventType:s.a5.ErrorMessage,errorType:s.q0.PythonCalculatedColumnsError,devInfo:void 0},{message:n,telemetry:o}=(0,p.v)(t,a);return{message:n,telemetry:o}}};var se=a(254359);const ce="Copilot\\Commanding";const de={getRangeConvertToTableSuccessResponse:function(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.H6b)().replace("{0}",e??"")}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:(0,x.BAK)()?[(0,C.FW)(s.q.ConvertToTable)]:[],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ce}}},telemetry:{featureName:s.q.ConvertToTable,eventType:s.a5.ActionConfirmationMessage}}},getShowHeaderButtonResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:(0,R.QCY)()}}}},telemetry:{featureName:s.q.ShowHeaders,eventType:s.a5.HumanSuggestionApplied}}},getShowHeaderButtonSuccessResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R.ZOE)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ce}}},telemetry:{featureName:s.q.ConvertToTable,eventType:s.a5.ActionConfirmationMessage}}},getSampleTableDataResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Human,messageHeader:{text:(0,R.px2)()}}}},telemetry:{featureName:s.q.SampleData,eventType:s.a5.HumanInput}}},getSampleTableDataSuccessResponse:function(){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:i.Q9.Chat,messageHeader:{text:(0,R._J3)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:(0,x.BAK)()?[(0,C.FW)(s.q.ConvertToTable)]:[],feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:ce}}},telemetry:{featureName:s.q.SampleData,eventType:s.a5.ActionConfirmationMessage}}}},ue={...Y,...se.n,...le,...E.n,...w,...n.n,...de,...oe.n,...ae,..._,...K,...O,...ne.n}},498736:(e,t,a)=>{"use strict";a.d(t,{W:()=>f});var n=a(725556),o=a(267324),r=a(886866),i=a(392029),l=a(686576),s=a(762542);const c=e=>(0,n.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 2048 2048",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M 512.0,731.0 L 658.0,731.0 Q 702.0,731.0 742.0,747.5 Q 782.0,764.0 813.0,795.0 Q 845.0,826.0 861.5,866.0 Q 878.0,906.0 878.0,950.0 Q 878.0,994.0 861.5,1034.0 Q 845.0,1074.0 813.0,1105.0 Q 782.0,1136.0 742.0,1152.5 Q 702.0,1169.0 658.0,1169.0 L 585.0,1169.0 L 585.0,1389.0 Q 585.0,1420.0 564.0,1441.0 Q 541.0,1462.0 512.0,1462.0 Q 483.0,1462.0 460.0,1441.0 Q 439.0,1420.0 439.0,1389.0 L 439.0,804.0 Q 439.0,773.0 460.0,752.0 Q 481.0,731.0 512.0,731.0 M 585.0,1023.0 L 658.0,1023.0 Q 687.0,1023.0 710.0,1002.0 Q 731.0,981.0 731.0,950.0 Q 731.0,919.0 710.0,898.0 Q 687.0,877.0 658.0,877.0 L 585.0,877.0 L 585.0,1023.0 M 1668.0,848.0 L 1463.0,1120.0 L 1463.0,1389.0 Q 1463.0,1419.0 1441.0,1441.0 Q 1420.0,1462.0 1390.0,1462.0 Q 1361.0,1462.0 1338.0,1441.0 Q 1317.0,1420.0 1317.0,1389.0 L 1317.0,1120.0 L 1112.0,848.0 Q 1104.0,838.0 1099.0,822.0 Q 1097.0,814.0 1096.5,807.5 Q 1096.0,801.0 1098.0,793.0 Q 1099.0,780.0 1107.0,766.0 Q 1111.0,760.0 1116.0,755.0 Q 1121.0,750.0 1126.0,745.0 Q 1138.0,737.0 1152.0,733.0 Q 1166.0,729.0 1181.0,731.0 Q 1211.0,736.0 1229.0,760.0 L 1390.0,974.0 L 1551.0,760.0 Q 1568.0,736.0 1599.0,731.0 Q 1613.0,729.0 1627.5,733.0 Q 1642.0,737.0 1653.0,745.0 Q 1677.0,763.0 1682.0,793.0 Q 1685.0,823.0 1668.0,848.0 M 439.0,292.0 L 146.0,292.0 L 146.0,1901.0 L 439.0,1901.0 L 439.0,2047.0 L 0.0,2047.0 L 0.0,145.0 L 439.0,145.0 L 439.0,292.0 M 1609.0,1901.0 L 1902.0,1901.0 L 1902.0,292.0 L 1609.0,292.0 L 1609.0,145.0 L 2048.0,145.0 L 2048.0,2047.0 L 1609.0,2047.0 L 1609.0,1901.0",fill:e.theme.black,stroke:e.theme.black})});var d=a(96994),u=a(202051),m=a(528804),h=a(108869),g=a(390624),p=a(887648),b=a(208520);function f(e){const t=(0,p.wA)(),{styles:a,linkTheme:f,requestId:C,code:y,output:v,outputType:x,isPythonOutputCollapsable:T,codeExplanation:S,codeLabel:w,isLargeOutput:E,tableHasHeader:I}=e,R=!v||!x||'""'===v,[A,L]=b.useState(!1),k=(0,m.DBQ)()?(0,b.useMemo)((()=>({shouldFocusOnMount:!0,items:[{key:"Python formula",text:(0,o.o7M)(),secondaryText:(0,o.lL1)(),onClick:()=>{!function(e){try{(0,g.F5)((async t=>{const a=t.workbook.worksheets.add();a.activate();const n=a.getRange("A1"),o=(0,h.ZK)(e,!0,0);n.values=[[o]],await t.sync()}))}catch(e){const a=(0,u.GI)(e);(0,u.Kx)(t,a,"pythonCollapsableCodeOnClick",!1)}}(y)}}]})),[y]):void 0;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:"8px",marginBottom:"8px"},children:[(0,n.jsx)(c,{theme:f}),(0,n.jsx)(d.f,{"aria-roledescription":(0,o.qcV)(),checked:A,size:"small",appearance:"transparent",iconPosition:"after",onClick:()=>{L(!A)},className:a.showPythonCodeToggleButtonStyle,icon:A?(0,n.jsx)(r.g4$,{className:a.showPythonCodeToggleButtonStyle}):(0,n.jsx)(r.rLf,{className:a.showPythonCodeToggleButtonStyle}),children:(0,n.jsxs)("span",{className:a.showPythonCodeToggleButtonStyle,children:[A?(0,o.Lw5)():(0,o.gU_)()," "]})})]}),A?(0,n.jsx)("div",{style:{margin:"10px 2px 16px"},children:(0,n.jsx)(s.m,{requestId:C,code:y,codeExplanation:S,codeLabel:w})}):null,(A||!T)&&(E&&(0,m.yw9)("OfficeVSO_10346383_AnswersShowLargeDataMessage")?(0,n.jsx)("div",{style:{paddingTop:"12px"},children:(0,n.jsx)(l.e,{output:(0,o.pKU)(),outputType:l.z.String,tableHasHeader:I})}):R?null:(0,n.jsxs)("div",{style:{paddingTop:"12px"},children:[(0,n.jsx)("p",{className:a.outputText,children:(0,o.V8T)()}),(0,n.jsx)(l.e,{output:v,outputType:x,tableHasHeader:I})]})),(0,m.DBQ)()?(0,n.jsx)(i.Y,{text:(0,o.J40)(),menuProps:k}):null]})}},502582:(e,t,a)=>{"use strict";a.d(t,{n:()=>o,r:()=>y});var n,o,r=a(504003),i=a(755005),l=a(449650),s=a(136609),c=a(267324),d=a(875136),u=a(108869),m=a(797639),h=a(202051),g=a(528804),p=a(977055),b=a(131778),f=a(495501),C=a(390624);!function(e){e.Label="Label",e.Content="Content"}(n||(n={})),function(e){e.PythonDataFrameInserter="PythonDataFrameInserter",e.PythonCodeAndPreviewInserter="PythonCodeAndPreviewInserter",e.PythonCalculatedColumnInserter="PythonCalculatedColumnInserter",e.PythonDetailSheetInserter="PythonDetailSheetInserter"}(o||(o={}));class y{conditionallySelect(e){((0,g.vEQ)()||(0,g.o2C)())&&m.CP.pythonContextManager.disableAutoScroll||e.select()}addCodeAndOutputToBuilder(e){e.codeExplanation=this.codeExplanation,e.codeLabel=this.codeLabel,m.CP.pythonContextManager.pythonContextBuilder.setCodeAndOutput(e)}getDiagnosticEntryForCell(e,t,a){try{const n=(0,r.q)(e,t,a);return m.CP.pythonContextManager.diagnosticsEntriesMap.get(n)}catch(e){(0,h.QX)(null,(0,h.pJ)(e),!1)}}async onCalculatedHandler(e,t){m.CP.pythonContextManager.shouldGenerate?await Excel.run((async n=>{try{const o=Promise.all([a.e("chunk1jsfluent","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81","high"),a.e("calc","high")]).then(a.bind(a,837051)),r=n.workbook.worksheets.getItem(e.worksheetId).load("id"),i=e.address.split(",");for(const e of i){const a=r.getRange(e).load(["formulasLocal","valuesAsJson"]);await n.sync();const i=(0,u.o7)(t);for(let t=0;t<a.formulasLocal.length&&!this.onCalculatedFinished;t++)for(let l=0;l<a.formulasLocal[t].length&&!this.onCalculatedFinished;l++)await this.onAddressCalculateHandler(n,o,r,a,e,i,a.formulasLocal[t][l],t,l)}}catch(e){this.onCalculatedFinished||((0,d.i5)(!1),(0,d.$k)(this.dispatch)),f.n.updatePythonCodeAndPostViewCardWithError(this.dispatch),(0,h.Kx)(this.dispatch,e,"onCalculatedHandler",!0)}})):this.onCalculatedHandlerShouldNotGenerate()}onCalculatedHandlerShouldNotGenerate(){f.n.updatePythonCodeAndPostViewCardWithError(this.dispatch)}async onAddressCalculateHandler(e,t,a,n,o,r,s,c,h){const p=(0,u.o7)(s),b=await this.mutex.waitFor();if(this.onCalculatedFinished)b.release();else if(r===p){(0,d.i5)(!0),(0,d.$k)(this.dispatch),this.onCalculatedFinished=!0,b.release(),this.onCalculatedResult?.remove(),await(this.onCalculatedResult?.context.sync()),this.onCalculatedResult=null;const r=l.ExcelCalc.addressToExcelRange(o).topLeft;r.column=(r.column??0)+h,r.row=(r.row??0)+c;const s={topLeft:r,bottomRight:r},p=l.ExcelCalc.IExcelRangeToAddress(s),C=await m.CP.pythonContextManager.getPythonCellContextWithTimeout(a.id,p);if(!this.skipInsertPostView){const n=C.output,o=n?.errorType;if("Error"!==C.outputType&&"Python"!==o){let n;C.outputType===i.qf.None&&(n=this.getDiagnosticEntryForCell(r.row,r.column,a.id)),await(0,d.ek)((async()=>{await f.n.updatePythonCodeAndPostViewCardWithPostView(this.dispatch,p,t,a,e,n,(0,g.EJJ)()?C:void 0)}),d.xk.InsertPostView)}else f.n.updatePythonCodeAndPostViewCardWithError(this.dispatch)}this.skipInsertPreView||(0,u.LX)(C)&&await(0,d.ek)((async()=>{await this.insertPreViewInGrid(a,p,C,e)}),d.xk.InsertPreview,!0),await this.handlePythonCellExecutionResult(C,n,p),(0,g.EeR)()&&await(0,u.ZD)(a,e,C)}else b.release()}async insertImageForPreview(e,t,a,n,o){const r=t.shapes.addLocalImageReference(n);return r.incrementTop(a.height),r.lineFormat.color="#000000",(0,u.U6)()&&(r.name=`image-${a.address}`),r.altTextTitle=this.codeLabel??(0,c.XZh)(),o&&(r.load("height"),await e.sync(),r.lockAspectRatio=!0,r.scaleHeight(a.height*this.imageHeightInCells/r.height,Excel.ShapeScaleType.currentSize,Excel.ShapeScaleFrom.scaleFromTopLeft)),await e.sync(),(0,g.o2C)()&&(0,u.lE)("ShowPythonAdvancedAnalysisFreA2"),r}async insertPreViewInGrid(e,t,a,n){try{if("Error"===a.outputType||(0,u.Hq)(a.outputType)){if((0,u.Hq)(a.outputType)&&(!(0,u.U6)()||a.outputType!==i.qf.PythonPlot)){const a=e.getRange(t).load("width, height, address");a.track(),await n.sync(),await(0,C.F5)((async o=>{await this.insertImageForPreview(n,e,a,t,!0)}));const o=e.getRange(t).getOffsetRange(this.imageHeightInCells,0);this.conditionallySelect(o),await n.sync(),this.conditionallySelect(a),a.untrack(),await n.sync()}}else{const e=await(0,u.WH)(n,this.sheetId);await(0,d.ek)((async()=>{await this.insertLabelAndContentForPreviewOrFormula(n,e,(0,c.ZOw)(),`=IFERROR(${t}.arrayPreview,${t}.Python_str)`,!1,!1)}),d.xk.InsertContentToGrid)}}catch(e){const t=`class: AbstractPythonInserter, method: "insertPreViewInGrid, outputType: ${a.outputType}`,n=(0,h.MF)(e,"AbstractPythonInserter","insertPreViewInGrid","PythonDataFrameInserter"===this.inserterType,t);throw(0,h.Kx)(this.dispatch,n,"insertPreViewInGrid",!0),e}}getOffsetRange(e,t,a,n,o){try{const n=t.rowIndex+(t.rowCount-1);return e.getRangeByIndexes(n+a,t.columnIndex,1,1)}catch(e){const t=`isPythonFormula: ${o} offset: ${a} rangeType: ${n}`;throw(0,h.MF)(e,"AbstractPythonInserter","getOffsetRange","PythonDataFrameInserter"===this.inserterType,t)}}async getUsedRange(e,t){const a=t.protection.load("protected"),n=t.getUsedRangeOrNullObject();if(await e.sync(),!n.isNullObject){if(n.load(["rowIndex","rowCount","columnIndex","address"]),n.track(),await e.sync(),a.protected)throw(0,h.Eu)();return n}}async logHiddenRowsAndColumns(e,t,a){t.load("rowHidden, columnHidden"),a.load("rowHidden, columnHidden"),await e.sync(),(t.rowHidden||t.columnHidden||a.rowHidden||a.columnHidden)&&(0,p.XB)(t.rowHidden,t.columnHidden,a.rowHidden,a.columnHidden)}async checkIsPythonErrorCell(e,t,a){const[n,o]=(0,u.Jy)(a);o&&(a=o);const r=t.getRange(a);r.load(["valuesAsJson","formulas"]),await e.sync();const l=r.formulas[0][0],s=u.sy.test(l),c=r.valuesAsJson[0][0],d=String(c.type??"");return s&&d===i.qf.Error}async checkIsPythonCellImageType(e,t,a){const[n,o]=(0,u.Jy)(a);o&&(a=o);const r=t.getRange(a);r.load(["valuesAsJson","formulas"]),await e.sync();const i=r.formulas[0][0],l=u.sy.test(i),s=r.valuesAsJson[0][0],c=String(s.Python_type??"");return l&&(0,u.Hq)(c)}getRanges(e,t,a,n=0){if(void 0===t){return{labelRange:e.getRange("A1"),contentRange:e.getRange("A3")}}{let o,r;a?(o=this.codeLabelOffset,r=this.codeContentOffset):a?(o=this.labelOffset,r=this.contentOffset):(o=this.previewLabelOffset,r=this.previewContentOffset);return{labelRange:this.getOffsetRange(e,t,o+n,"Label"),contentRange:this.getOffsetRange(e,t,r+n,"Content")}}}async updateExcelRangesIfPythonError(e,t,a,n,o){let r=n,i=o,s=!1;const c=m.CP.pythonContextManager.getLastPythonCell(!0);if(c){const n=c.sheetAddress,o=c.sheetId===this.sheetId;if(e&&o&&await this.checkIsPythonErrorCell(t,a,n??"")){const e=l.ExcelCalc.sheetAddressToICellRange(n??""),t=e.FirstRow,o=e.FirstColumn;r=a.getRangeByIndexes(t-1,o,1,1),i=a.getRangeByIndexes(t,o,1,1),c.wasDeleted=!0,s=!0}}return{labelAndContentRangesUpdated:s,labelRange:r,contentRange:i}}async setLabelAndContent(e,t,a,n,o,r,i,l){try{let s,c,d=!1;const h=this.getRanges(t,a,r);if(s=h.labelRange,c=h.contentRange,({labelAndContentRangesUpdated:d,labelRange:s,contentRange:c}=await this.updateExcelRangesIfPythonError(r,e,t,s,c)),!d&&r){let n=m.CP.pythonContextManager.getLastPythonCell(!1);!n&&(0,g.EeR)()&&(n=await(0,u.dd)(t,e));const o=!n||n.sheetId===this.sheetId;if(n&&o){if(await this.checkIsPythonCellImageType(e,t,n.sheetAddress??"")){const{labelRange:e,contentRange:n}=this.getRanges(t,a,r,this.imageHeightInCells);s=e,c=n,d=!0}}}if(s.track(),c.track(),await e.sync(),s.values=[[n]],l)s.format.font.size=l;else{const e=r?14:12;s.format.font.size=e,r&&(s.format.font.color=b.e)}if(s.format.font.bold=!0,i?c.formulasLocal=[[o]]:c.values=[[o]],await e.sync(),(0,g.o2C)()&&!r){const e="PythonDataFrameInserter"===this.inserterType,t="PythonCodeAndPreviewInserter"===this.inserterType;let a="";e?a="ShowPythonAdvancedAnalysisFre":t&&(a="ShowPythonAdvancedAnalysisFreA2Plot"),""!==a&&(0,u.lE)(a)}else(0,g.vEQ)()&&r&&await(0,u.jC)(c,"ShowPythonAdvancedAnalysisWave1");return await this.logHiddenRowsAndColumns(e,s,c),{contentRange:c,labelRange:s}}catch(e){throw(0,h.MF)(e,"AbstractPythonInserter","setLabelAndContent","PythonDataFrameInserter"===this.inserterType,void 0,{lastInsertedFormula:o})}}async insertLabelAndContentForPreviewOrFormula(e,t,a,n,o,r,i){const l=await this.getUsedRange(e,t);o&&(this.onCalculatedResult=t.onCalculated.add((async e=>this.onCalculatedHandler(e,n))),(0,p.BA)(this.requestId));const{contentRange:s,labelRange:c}=await this.setLabelAndContent(e,t,l,a,n,o,r,i);s.load("address"),await e.sync();await(0,u.eU)()===Excel.CalculationMode.manual&&(await Excel.run((async e=>{e.application.calculate(Excel.CalculationType.full)})),(0,p.$J)(o)),o&&(this.conditionallySelect(s),m.CP.isPythonCellSelected=!0,m.CP.selectedPythonSheetId=this.sheetId,m.CP.selectedPythonAddress=s.address),await e.sync();const d=s.address;void 0!==l&&l.untrack(),s.untrack(),c.untrack(),await e.sync();const h=await this.getUsedRange(e,t);if(void 0!==h){if(!o){const t=h.getLastRow().getOffsetRange(1,0).getCell(0,0);try{const a=e.workbook.getSelectedRange();this.conditionallySelect(t),await e.sync(),this.conditionallySelect(a),await e.sync()}catch(e){this.conditionallySelect(t)}await e.sync()}await(0,u.t2)(e,h,this.dispatch)}return d}constructor(e,t,a,n,o,r=!1,i=!1){this.labelOffset=2,this.contentOffset=3,this.codeLabelOffset=3,this.codeContentOffset=4,this.previewLabelOffset=2,this.previewContentOffset=3,this.imageHeightInCells=16,this.mutex=new s.e,this.onCalculatedFinished=!1,this.onCalculatedResult=null,this.dispatch=e,this.sheetId=t,this.codeExplanation=n,this.codeLabel=o,this.skipInsertPreView=r,this.skipInsertPostView=i,this.inserterType=a}}},503079:(e,t,a)=>{"use strict";a.d(t,{d:()=>n});class n{promise(){return this.cachedPromise||(this.cachedPromise=this.initFn().then((e=>(this.cachedPromise&&(this.cachedValue=e),e)))),this.cachedPromise}forget(){this.cachedPromise=void 0,this.cachedValue=void 0}isStarted(){return void 0!==this.cachedPromise}value(){return this.cachedValue}get(){return()=>this.promise()}constructor(e){this.initFn=e}}},504003:(e,t,a)=>{"use strict";a.d(t,{q:()=>o,w:()=>r});var n=a(797639);function o(e,t,a){return`${e},${t},${a}`}function r(e){const t=e.row,a=e.column,r=e.worksheetId,i={stdErr:e.stderr,stdOut:e.stdout};return function(e,t){n.CP.pythonContextManager.diagnosticsEntriesMap.set(e,t)}(o(t,a,r),i),Promise.resolve()}},507481:(e,t,a)=>{"use strict";a.d(t,{Y:()=>z});var n,o=a(998781),r=a(647347),i=a(293435),l=a(207545),s=a(507628),c=a(477543),d=a(265167),u=a(795917);!function(e){e.NoGeneratedLinks="NoGeneratedLinks",e.NoQuery="NoQuery",e.NoResponse="NoResponse",e.OutboundMessageResponse="OutboundMessageResponse",e.HandoffMessageResponse="HandoffMessageResponse"}(n||(n={}));var m,h,g="I ran into a problem while completing your request. Please try again.";!function(e){e.CrossAppCanvasHandoff="CrossAppCanvasHandoff",e.CrossAppHandoff="CrossAppHandoff",e.InAppHandoff="InAppHandoff"}(m||(m={})),function(e){e.TellMe="TellMe",e.WordCopilotComposeSelection="WordCopilotComposeSelection",e.ContextMenuRewriteClickAction="ContextMenuRewriteClickAction",e.WordCopilotRewriteSelection="WordCopilotRewriteSelection",e.SkittleContextMenuUserClickAction="SkittleContextMenuUserClickAction",e.WordCopilotComprehensionPodcast="WordCopilotComprehensionPodcast",e.ResearcherAgent="ResearcherAgent",e.CopilotContextMenuClickAction="CopilotContextMenuClickAction",e.WordCopilotVisualAssistantDescribeImage="WordCopilotVisualAssistantDescribeImage",e.PPTFileNameRenamed="PPTFileNameRenamed",e.CopilotTranslatedPPTInfo="CopilotTranslatedPPTInfo",e.ExcelDataShapingAgent="ExcelDataShapingAgent",e.ExcelCopilotExplainSelection="ExcelCopilotExplainSelection",e.CopilotDab="copilotdab"}(h||(h={}));var p=[h.WordCopilotComprehensionPodcast,h.WordCopilotVisualAssistantDescribeImage,h.PPTFileNameRenamed,h.CopilotTranslatedPPTInfo],b=new Map([[h.TellMe,u.$.M365CopilotChat],[h.WordCopilotComposeSelection,u.$.M365CopilotChat],[h.ContextMenuRewriteClickAction,u.$.M365CopilotChat],[h.WordCopilotRewriteSelection,u.$.M365CopilotChat],[h.SkittleContextMenuUserClickAction,u.$.M365CopilotChat],[h.ResearcherAgent,u.$.M365CopilotChat],[h.CopilotContextMenuClickAction,u.$.M365CopilotChat],[h.WordCopilotComprehensionPodcast,u.$.AppChat],[h.ExcelCopilotExplainSelection,u.$.M365CopilotChat],[h.CopilotDab,u.$.M365CopilotChat]]),f=function(){return f=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},f.apply(this,arguments)};function C(e,t){return void 0===t&&(t=!1),!!e&&(!(!t&&e.toLowerCase()===i.Ww.NONE)&&Object.values(i.Ww).some((function(t){return t===e.toLowerCase()})))}function y(e){var t;return f(f({scenarioName:i.Cu.NONE},e),null!==(t=e.properties)&&void 0!==t?t:{})}function v(e,t,a,n){var o,r,i,l,s;if(!e.isBizChatinSDXEnabled||e.fallbackHandoffsToAppChat||!a)return t&&t("[Handoff] Switching to AppChat - BizChat is not enabled"),u.$.AppChat;var c=null!==(l=null!==(r=null===(o=null==n?void 0:n.PrimaryUserAccountInfo)||void 0===o?void 0:o.AggregatedLicensedFeatures)&&void 0!==r?r:null===(i=null==n?void 0:n.PrimaryUserAccountInfo)||void 0===i?void 0:i.LicensedFeatures)&&void 0!==l?l:void 0;return e.shouldCheckUserLicense&&!(null==c?void 0:c.includes("Copilot"))&&!(null==c?void 0:c.includes("CopilotStarter"))?(t&&t("[Handoff] User is not licensed to use BizChat"),u.$.AppChat):e.isHandoffsToAppChatDisabled?u.$.M365CopilotChat:e.shouldDefaultToBizChat?(t&&t("[Handoff] Defaulting to BizChat unless specified"),a.featureName===h.SkittleContextMenuUserClickAction&&a.contextMenuSelection&&"TriggerAnalyzeImage"===a.contextMenuSelection||p.includes(a.featureName)?u.$.AppChat:u.$.M365CopilotChat):null!==(s=b.get(a.featureName))&&void 0!==s?s:u.$.AppChat}var x=a(423905),T=a(83437),S=a(380049),w=a(986984),E=a(297005),I=function(e,t,a,n){var o,r;return a?!!n||(e("Conversation ID handoff unsucessful - no submitOperation function defined"),null==t||t.sendChatEventTelemetry((0,x.pN)(((r={})[T.h3.ChatEventType]=T.a5.SubmitOperationUndefined,r))),!1):(e("Unable to update chat session ID, updateChatSessionId is undefined"),null==t||t.sendChatEventTelemetry((0,x.pN)(((o={})[T.h3.ChatEventType]=T.a5.CannotUpdateChatSessionId,o))),!1)},R=function(e,t){var a,n,o={pageSize:L,syncState:void 0},r={type:S.S5.GetMessagesOperation,chatSessionId:e,paging:o,setSessionAsCurrent:!0,gptId:(0,E.Z)()};return new w.T({operation:r,documentURLOrLocalPath:null===(a=t.properties)||void 0===a?void 0:a.destinationDocUrl,timestamp:Date.now(),documentSensitivity:null===(n=t.properties)||void 0===n?void 0:n.sensitivityLabel,orchestratorGroundingMode:void 0,isFluxChatHistoryAnnotationActivated:!1,caller:k})},A=function(e,t){return{operation:new c.g0({parentPath:["Signal",w.T.getTypeName()],items:[{id:d.r.generateId(),body:R(e,t)}]}),workflowAnnotationType:w.T.getTypeName()}},L=10,k="handoff",F=function(){return F=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},F.apply(this,arguments)},_=function(){function e(e,t){this.HandoffOperations=e,this.executingHandoffMessageIds=new Map,this.pendingHandoffMessageIds=new Set,this.flights={};var a=this.getDocumentHandoffMessageId();a&&this.pendingHandoffMessageIds.add(a),this.flights=e.getFlights(),this.telemetryHandler=t}return e.prototype.getDocumentHandoffMessageId=function(){var e=l.kH.getSettingAsString(l.zj.HandoffMessageId);if(e)return e;this.HandoffOperations.logDebug("HandoffMessageId was not found in host app settings")},e.prototype.sendHandoffMessageId=function(e,t){try{if(!t||!this.shouldExecuteHandoffMessageId(t))return;var a=(0,s.A)(),n=this.getHandoffMessageIdSignal(a,t,e),i=new c.g0({parentPath:["Signal",o.uC.getTypeName()],items:[{id:d.r.generateId(),body:n}]});e===r.Q.GET&&this.trackHandoffMessageIdSignal(a,t),this.handoffMessageIdRequestSubmitTime=(new Date).getTime(),this.HandoffOperations.submitSignal(n.H_.T_,{operation:i,workflowAnnotationType:o.uC.getTypeName()}),this.HandoffOperations.onHandoffMessageIdSubmitted(n)}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to send HandoffMessageId signal. "+e.message),e}},e.prototype.getBizChatProperties=function(e){return e},e.prototype.switchChatExperienceIfNeeded=function(e,t,a){this.flights.isBizChatinSDXEnabled&&this.flights.enableBizchatHostContext&&(this.HandoffOperations.logDebug("[Handoff] Switching chat pane experience"),function(e,t,a,n){var o,r=a.useHandoffMessagePropertiesValue?y(e):e,i=void 0;try{i=r.context?JSON.parse(r.context):void 0}catch(e){return void(n&&n("Handoff context could not be parsed - unable to switch chat experience"))}t.setBizChatHostContext&&t.setBizChatHostContext({PrimaryUserAccountInfo:f(f({},null===(o=t.bizChatHostContext)||void 0===o?void 0:o.PrimaryUserAccountInfo),{CopilotExperience:v(a,n,i,t.bizChatHostContext)})})}(e,{setBizChatHostContext:t,bizChatHostContext:a},this.flights,this.HandoffOperations.logDebug))},e.prototype.receiveHandoffAnnotation=function(e,t){this.HandoffOperations.logDebug("[Handoff] Receiving handoff annotation"),this.HandoffOperations.onAnnotationReceived(o.uC.getTypeName(),e,this.handoffMessageIdRequestSubmitTime,t)},e.prototype.handleBizChatHandoffIfEnabled=function(e,t,a){var n;if(this.flights.handoffToBizChatEnabled&&this.flights.isBizChatinSDXEnabled&&a&&e){var o=void 0;if(this.flights.useHandoffMessagePropertiesValue)this.HandoffOperations.logDebug("[Handoff] converting handoff response to BizChat handoff properties"),o=this.getBizChatProperties(y(e));else{var r=F({scenarioName:i.Cu.NONE},e);if(e.properties)for(var l=0,s=Object.keys(e.properties);l<s.length;l++){var c=s[l];void 0===r[c]&&(r[c]=e.properties[c])}o=this.getBizChatProperties(r)}try{var d=JSON.parse(null!==(n=null==o?void 0:o.context)&&void 0!==n?n:"");if(function(e,t,a,n){return v(e,t,a,n)===u.$.M365CopilotChat}(this.flights,this.HandoffOperations.logDebug,d,t))return this.HandoffOperations.logDebug("[Handoff] Setting BizChat handoff properties"),a(o),!0}catch(e){return this.HandoffOperations.logDebug("[Handoff] BizChat handoff failed: "+e),!0}}return this.HandoffOperations.logDebug("[Handoff] BizChat handoff not enabled"),!1},e.prototype.handleHandoffMessage=function(e,t,a,n,r,l,s){void 0===a&&(a=!1);try{if(!(null==e?void 0:e.body)||!o.uC.typeGuard(e.body))throw new Error("Service response not of type HandoffMessage");var c=e.body;if(this.switchChatExperienceIfNeeded(c,r,l),this.receiveHandoffAnnotation(c,t),this.handleBizChatHandoffIfEnabled(c,l,s))return void this.HandoffOperations.logDebug("[Handoff] Completed BizChat handoff");var d=function(e,t){var a;return void 0===t&&(t=!1),e.scenarioName===i.Cu.INAPP||(null===(a=e.properties)||void 0===a?void 0:a.scenarioName)===i.Cu.INAPP?m.InAppHandoff:t?m.CrossAppCanvasHandoff:m.CrossAppHandoff}(c,a);switch(d){case m.InAppHandoff:return void this.processHandoffMessage(c);case m.CrossAppCanvasHandoff:return this.renderChatHistory(c,n),this.renderClosingBookending(c),void this.processHandoffMessage(c);case m.CrossAppHandoff:default:return void(this.isHandoffMessageIdSignalTracked(c.queryId)&&this.validateResponse(c)&&(this.renderChatHistory(c,n),this.renderClosingBookending(c),this.processHandoffMessage(c),this.cleanupHandoff(c)))}}catch(e){throw this.HandoffOperations.logDebug("[Handoff] Failed to handle HandoffMessage. "+e.message),e}},e.prototype.validateResponse=function(e){return!e.error||(this.HandoffOperations.logDebug("[Handoff] Failed to retrieve handoff message. "+e.error),e.error.includes("Unable to download content. The specified blob does not exist")||e.error.includes("Unable to download content. Request failed with status code 500")||this.HandoffOperations.onError(n.HandoffMessageResponse,g),!1)},e.prototype.renderClosingBookending=function(e){var t,a,n;if((null===(t=e.properties)||void 0===t?void 0:t.sourceApp)&&(null===(a=e.properties)||void 0===a?void 0:a.destinationApp)&&(null===(n=e.properties)||void 0===n?void 0:n.scenarioName)&&(!this.flights.appValueChecksForBookendingEnabled||C(e.properties.sourceApp)&&C(e.properties.destinationApp)))switch(e.properties.scenarioName){case i.Cu.OPEN:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Opened");break;case i.Cu.NEW:case i.Cu.GENERATE:this.HandoffOperations.renderBookending(e.properties.sourceApp,e.properties.destinationApp,"Closing","Created")}},e.prototype.cleanupHandoff=function(e){var t=this.getHandoffMessageIdFromSignal(e.queryId);this.sendHandoffMessageId(r.Q.PROCESSED,t),this.completeTrackedHandoffMessageIdSignal(e.queryId)},e.prototype.renderChatHistory=function(e,t){var a,n,o;if(this.flights.renderChatHistoryInHandoffDestination){var r=null===(n=e.properties)||void 0===n?void 0:n.conversationId;r?function(e,t,a,n,o){var r,i,l,s,c,d;I(a,n,null===(l=null==o?void 0:o.current)||void 0===l?void 0:l.updateChatSessionId,null===(s=null==o?void 0:o.current)||void 0===s?void 0:s.submitOperation)&&(a("Updating chat session ID with conversationId from source"),null==n||n.sendChatEventTelemetry((0,x.pN)(((r={})[T.h3.ChatEventType]=T.a5.UpdateChatSessionId,r))),null===(c=null==o?void 0:o.current)||void 0===c||c.updateChatSessionId(e),a("Conversation ID handoff successful - submitting chat history signal"),null==n||n.sendChatEventTelemetry((0,x.pN)(((i={})[T.h3.ChatEventType]=T.a5.ChatHistorySignalSubmitted,i))),null===(d=null==o?void 0:o.current)||void 0===d||d.submitOperation(A(e,t)))}(r,e,this.HandoffOperations.logDebug,this.telemetryHandler,t):(this.HandoffOperations.logDebug("Cannot render chat history - conversation ID is undefined"),null===(o=this.telemetryHandler)||void 0===o||o.sendChatEventTelemetry((0,x.pN)(((a={})[T.h3.ChatEventType]=T.a5.ConversationIdUndefined,a))))}},e.prototype.autoExecuteQuery=function(e){if(!this.isHandoffAutoSubmitPromptsEnabled())throw this.HandoffOperations.logDebug("[Handoff] Query auto execution was not allowed, change gate of isHandoffAutoSubmitPromptsEnabled has been disabled."),new Error("query auto execution was not allowed");this.HandoffOperations.submitQuery(e)},e.prototype.trackHandoffMessageIdSignal=function(e,t){this.executingHandoffMessageIds.set(e,t)},e.prototype.isHandoffMessageIdSignalTracked=function(e){return this.executingHandoffMessageIds.has(e)},e.prototype.shouldExecuteHandoffMessageId=function(e){return this.pendingHandoffMessageIds.has(e)},e.prototype.getHandoffMessageIdFromSignal=function(e){return this.executingHandoffMessageIds.get(e)},e.prototype.completeTrackedHandoffMessageIdSignal=function(e){var t=this.getHandoffMessageIdFromSignal(e);this.pendingHandoffMessageIds.delete(t),this.executingHandoffMessageIds.delete(e)},e}(),P=a(448514),N=a(365319),M=a(742633),O=a(322466),D=a(697705),B=a(9847),$=a(956258),H=a(79458),U=a(528804),q=a(95151),V=a(949404);class G{onError(e,t){switch(e){case n.HandoffMessageResponse:this.renderError(g);break;case n.NoQuery:(0,H.cY)("Handoff error type: The query in handoff message is empty or undefined.");break;default:throw(0,H.cY)("Unhandled Handoff error type: "+e+(t?` Error: ${JSON.stringify(t)}`:"")),new Error(g)}}renderError(e){const{message:t,telemetry:a}=(0,V.v)("HandoffMessageIdResponseHandlerError: "+e,{errorType:B.q0.ClientError,featureName:B.q.HandOff},{},{feedbackData:{feedbackArea:O.O.Footer}});N.$.getInstance().displayErrorResponseIfNeeded(t,a),D.B.getInstance().sendChatEventTelemetry((0,B.pN)({[B.h3.ChatEventType]:B.a5.HandoffMessageIdResponseError,[B.h3.ChatErrorType]:B.q0.ClientError,[B.h3.ChatErrorParameters]:e})),z.getInstance().sendHandoffUserPerceivedLatency(!0)}onAnnotationReceived(e,t,a,n){if(e===o.uC.getTypeName()){D.B.getInstance().recordCheckPoint(B._R.HandoffMessageReceived);const n=t;n.queryId&&($.M.userQueryGuid=n.queryId,D.B.userQueryGuid=n.queryId),D.B.getInstance().sendLatencyTelemetry((0,B.pN)({[B.CT.HandoffMessageResponseTime]:(0,P.W)(a),[B.CT.AnnotationType]:e,[B.CT.FeatureName]:B.BJ.Handoff}))}D.B.getInstance().sendChatEventTelemetry((0,B.pN)({[B.h3.ChatEventType]:B.a5.ResponseReceivedFromAL,[B.h3.ChatEventParameters]:e,[B.h3.Cv]:n??""}))}onHandoffMessageIdSubmitted(e){let t,a;switch(e.handoffOperation){case r.Q.GET:t=B.a5.HandoffMessageIdGetOperationSubmitted,a=B._R.HandoffMessageIdSent;break;case r.Q.PROCESSED:t=B.a5.HandoffMessageIdProcessedOperationSubmitted,a=B._R.HandoffMessageIdProcessed}t&&((0,H.cY)("Update telemetry for handoff message id submitted: ",t),D.B.getInstance().sendChatEventTelemetry((0,B.pN)({[B.h3.ChatEventType]:t}))),a&&D.B.getInstance().recordCheckPoint(a)}logDebug(...e){(0,H.cY)(e)}submitSignal(e,t){N.$.getInstance().submitOperation(t),D.B.getInstance().sendLatencyTelemetry((0,B.pN)({[B.CT.RequestSignalType]:e}))}submitQuery(e){N.$.getInstance().submitUserQuery(e)}renderBookending(e,t,a,n){if((0,U.Skv)()){const o=(0,q.generateAppCopilotHandoffResponseSystemMessage)(e,t,a,n);N.$.getInstance().displayResponse(o)}}getFlights(){return{renderChatHistoryInHandoffDestination:(0,U.yqt)(),isALHookEnabled:(0,U.UTV)(),appValueChecksForBookendingEnabled:(0,U.KT8)(),handoffToBizChatEnabled:(0,U.o94)(),enableHandoffALBridge:(0,U.sSY)(),enableBizchatHostContext:(0,U.UW0)(),fallbackHandoffsToAppChat:(0,U.ZNg)(),shouldCheckUserLicense:(0,U.iAi)(),isBizChatinSDXEnabled:(0,U.xCw)(),shouldDefaultToBizChat:(0,U.lYv)(),useHandoffMessagePropertiesValue:(0,U.aFB)()}}}var W=a(99394);class z extends _{static getInstance(){return z._instance||(z._instance=new z),z._instance}async handleHandoffMessageHostAppSettings(e,t,a){try{a?.()}catch(e){D.B.getInstance().sendChatEventTelemetry((0,B.pN)({[B.h3.ChatEventType]:B.a5.HandoffMessageFromHostAppSettingsError,[B.h3.ChatErrorParameters]:"Failed to handle CopilotInitialPrompt from HostAppSettings"}))}const n=W.V.getSetting(W.z.HandoffMessage);if(n)try{const a=JSON.parse(n)?.items?.[0];e&&t?this.handleHandoffMessage(a,"",!0,N.$.getInstance().getCopilotRef(),e,t,this.bizChatHandoffPropertiesHandler):this.handleHandoffMessage(a,"",!0,N.$.getInstance().getCopilotRef())}catch(e){D.B.getInstance().sendChatEventTelemetry((0,B.pN)({[B.h3.ChatEventType]:B.a5.HandoffMessageFromHostAppSettingsError,[B.h3.ChatErrorParameters]:"Failed to handle HandoffMessage from HostAppSettings"}))}}getHandoffMessageIdSignal(e,t,a){return new M.aO({queryId:e,handOffMessageId:t,handoffOperation:a})}isHandoffAutoSubmitPromptsEnabled(){return(0,U.yw9)("OfficeVSO_9277674_isHandoffAutoSubmitPromptsEnabled")}processHandoffMessage(e){(0,U.yw9)("OfficeVSO_10210356_FixHandoffClientMetrics")?(e.query&&e.query.trim().length>0?this.handleUserQuery(e):N.$.getInstance().setInputFocus(),this.onHandoffQueryPerceivedByUser(e)):(e.query&&0!==e.query.length||this.HandoffOperations.onError(n.NoQuery),this.handleUserQuery(e))}handleUserQuery(e){try{e.manualSendPrompt?N.$.getInstance().setInputText(e.query):this.autoExecuteQuery(e.query),(0,U.yw9)("OfficeVSO_10210356_FixHandoffClientMetrics")||this.onHandoffQueryPerceivedByUser(e)}catch(e){this.HandoffOperations.logDebug("[Handoff] Has caught error in excel: "+e.message)}}onHandoffQueryPerceivedByUser(e){let t,a;(0,U.yw9)("OfficeVSO_10210356_FixHandoffClientMetrics")&&!e.query?(t=B.a5.HandoffComplete,a=B._R.HandoffComplete):e.manualSendPrompt?(t=B.a5.HandoffQueryPerceivedByUser,a=B._R.HandoffQueryPerceivedByUser,e.query&&D.B.getInstance().setInitialHandoffQuery(e.query)):(t=B.a5.HandoffQueryAutoSubmitted,a=B._R.HandoffQueryAutoSubmitted),this.sendHandoffUserPerceivedLatency();const n={};if(e.sourceApp&&(n[B.CD.SourceApp]=e.sourceApp),e.context)try{const t=JSON.parse(e.context);t.promptType&&(n[B.CD.PromptType]=t.promptType),t.featureName&&(n[B.CD.FeatureName]=t.featureName)}catch(e){(0,H.cY)("Could not parse context to JSON from handoff message.")}e.scenarioName&&(n[B.CD.ScenarioName]=e.scenarioName),(0,H.cY)("Handoff query perceived by user: ",n),D.B.getInstance().sendChatEventTelemetry((0,B.pN)({[B.h3.ChatEventType]:t,[B.h3.ChatEventParameters]:JSON.stringify(n)})),e.handoffStartTime&&D.B.getInstance().recordCheckPoint(B._R.HandoffStart,e.handoffStartTime),D.B.getInstance().recordCheckPoint(a),D.B.getInstance().sendLatencyTelemetryForCheckPoints(!0)}sendHandoffUserPerceivedLatency(e){D.B.getInstance().sendLatencyTelemetry((0,B.pN)({[B.CT.UserPerceivedLatency]:(0,P.W)(this.handoffMessageIdRequestSubmitTime)}),e)}setBizChatHandoffPropertiesHandler(e){this.bizChatHandoffPropertiesHandler=e}getBizChatHandoffPropertiesHandler(){return this.bizChatHandoffPropertiesHandler}constructor(){super(new G,D.B.getInstance())}}},509779:(e,t,a)=>{"use strict";a.d(t,{t:()=>s});var n=a(944563),o=a(528804),r=a(576583);const i=(0,r.n)({columnRecommendation:{backgroundColor:n.k1.neutralLight,color:n.k1.black,forcedColorAdjust:"auto"},text:{}}),l=(0,r.n)({columnRecommendation:{backgroundColor:n.k1.neutralLight,color:n.k1.black},text:{}});function s(){return(0,o.yw9)("OfficeVSO_9625778_fixFormulaCardsHighContrast")?i():l()}},512238:(e,t,a)=>{"use strict";a.d(t,{I2:()=>w,Nl:()=>E,yU:()=>I});var n,o=a(932367),r=a(754440),i=a(365319),l=a(831310),s=a(267324),c=a(9847),d=a(83437),u=a(4091),m=a(937234),h=a(553373),g=a(476730),p=a(965634),b=a(956258),f=a(235373),C=a(528804),y=a(494554),v=a(555454),x=a(495501),T=a(507628);!function(e){e.GetImportOptionsCancelled="GetImportOptionsCancelled",e.QueryRefreshFailure="QueryRefreshFailure",e.AuthenticateRefreshDisabled="AuthenticateRefreshDisabled"}(n||(n={}));class S extends Error{toString(){return`SignalError: ${this.message} (ErrorCode: ${this.errorCode})`}constructor(e,t){super(e),this.errorCode=t}}function w(e,t,a,n,l,m=b.M.getInstance(),h=g.E.getInstance(),y=x.n,T=f.m,S=c.xJ,w=v.rc){return async g=>{let b,f=!1;const v=(new Date).getTime();a(T.startExecutingCommand({command:c.OP.ImportDataLoadQuery,id:t}));try{const t=(0,C.iPS)("Microsoft.Office.Excel.FA000000124.AttachQueryRefreshCallback",!0),a=`{${e}_${l}}`;b=await w(g.powerQueryScript,g.sourceName,t,a),f=!0;const{message:o,telemetry:r}=y.getImportDataSimpleMessage((0,s.k0o)(),n);i.$.getInstance().displayResponse(o,r)}catch(e){m.logError({eventType:p.S2.ImportData,errorMessage:`failed to load query with error:  ${e} ${JSON.stringify(e)}`,logLevel:d.$b.Error});const{message:t,telemetry:a}=y.getImportDataSimpleMessage((0,s.pZZ)(),n);i.$.getInstance().displayResponse(t,a),m.logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Import_Data_Load_Query_Error,c.BJ.ImportData)}finally{h.updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.ImportDataLoadQuery,[c.h3.ChatEventParameters]:JSON.stringify({success:f,loadQueryResult:b,messageId:e,duration:S(v)})},m),a((0,u.L4)(f)),a(T.clearSuggestionList())}}}async function E(e,t,a,n,o,r=h.qx.getInstance(),i=b.M.getInstance(),l=g.E.getInstance(),s=x.n,d=f.m,u=c.xJ){await A(c.q.ImportDataSkill,e,t,a,n,i,l,s,d,u,(async()=>({requestId:t,dataSources:o})),r)}async function I(e,t,a,n,o=h.qx.getInstance(),r=b.M.getInstance(),i=g.E.getInstance(),l=x.n,s=f.m,d=c.xJ){r.startTriedActivity(c.q.ImportDataFromSearch);const u=(0,C.Z8j)("Microsoft.Office.Excel.FA000000124.MaxTimeWaitingForCitations",3e4),m=(0,C.Z8j)("Microsoft.Office.Excel.FA000000124.MaxTimeWaitingForRelevancy",3e4);await A(c.q.ImportDataFromSearch,e,t,a,n,r,i,l,s,d,(async()=>await o.fetchRelevantTablesForMessageId(e,u,m,a,t,s)),o)}function R(e,t,a,n){const o=(0,y.N)(a);e((0,u.nv)(o,t?m.Aw.success:m.Aw.failed,n,!1,!0))}async function A(e,t,a,n,m,h,g,b,f,y,v,x){const w=(new Date).getTime(),E={success:!1,isCardShown:!1,resolvedDataSources:0,shownDataSources:0,messageId:t,duration:0},I=(0,T.A)();n(f.setLatestRequestId(I));let A=!1;try{const g=await v();let y=g.dataSources;if(E.resolvedDataSources=y.length,x.isMessageCancelled(t))throw new S(`Message is cancelled. will ignore the ${E.resolvedDataSources} dataSources`,"GetImportOptionsCancelled");if(g.error&&g.error?.errorCode!==l.O.Timeout)throw g.error.errorCode===l.O.RAI&&h.logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Import_Data_RAI_Error,c.BJ.ImportData),new S(g.error.errorMessage,g.error.errorCode);const T=(0,C.iPS)("Microsoft.Office.Excel.FA000000124.ImportDataShowAllTables",!0);if((0===y.length&&T||g.error?.errorCode===l.O.Timeout)&&(A=!0,y=await x.getAllResolvedDataSourcesForMessageId(t,0),h.logError({eventType:p.S2.ImportData,errorMessage:`falling back to show all tables for message id: ${t}. errorCode?: ${g.error?.errorCode}`,logLevel:d.$b.Warning})),0===y.length){const a=x.doesMessageHaveFilteredExcelFiles(t)?(0,s.uLY)():(0,s.kM)(),{message:o,telemetry:r}=b.getImportDataSimpleMessage(a,e);i.$.getInstance().displayResponse(o,r),n((0,u.Nl)()),R(n,!0,o,r)}else{const{message:o,telemetry:r}=b.getImportDataResponse({importType:e,requestId:I,dataSources:y,messageId:t,userQueryGuid:a,clpData:m,performedFallbackToAllTables:A});i.$.getInstance().displayResponse(o,r),E.isCardShown=!0,E.shownDataSources=y.length,n(f.clearSuggestionList()),R(n,!0,o,r)}E.success=!0,h.endTriedActivitySuccess(e)}catch(a){if(h.logError({eventType:p.S2.ImportData,errorMessage:`got error during handling import data: ${a} ${JSON.stringify(a)}`,logLevel:d.$b.Error}),h.endTriedActivityFailure(e),h.logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Import_Data_Card_Rendering_Error,c.BJ.ImportData),!x.isMessageCancelled(t)){const t=function(e){return e instanceof S&&e.errorCode===l.O.RAI?(0,s.KC)():(0,s.pZZ)()}(a),{message:o,telemetry:r}=b.getImportDataSimpleMessage(t,e);i.$.getInstance().displayResponse(o,r),R(n,!1,o,r)}}finally{E.duration=y(w),g.updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.ImportDataShowCard,[c.h3.ChatEventParameters]:JSON.stringify(E)},h),n((0,u.L4)(E.success))}}},516999:(e,t,a)=>{"use strict";a.d(t,{or:()=>c,U:()=>l,Y:()=>s});var n=a(755005),o=a(620316),r=a(60398);function i(e){return new Promise((t=>setTimeout(t,e)))}async function l(e,t,a,o=3,l,s=!1,c=0,d){let u,m;do{o--;try{if(d?.signal.aborted){const e=new Error;throw e.name=n.UW.AbortError,e}const a=await e(l);if(m=a,t(a,l))return a}catch(e){if(u=e,a(e,l))throw e;if(e instanceof r.H)throw e}if(c>0){if(d?.signal.aborted){const e=new Error;throw e.name=n.UW.AbortError,e}await i(c)}}while(o>0);if(s&&m)return m;throw u}async function s(e,t){let a;const n=new Promise(((e,t)=>{a=new o.c(e,t)}));return e().then(a.resolve).catch(a.reject),i(t).catch(a.reject),n}function c(...e){return function(e,...t){return t.reduce(((t,a)=>e(t,a)))}(((e,t)=>a=>e(a)||t(a)),...e)}},518826:(e,t,a)=>{"use strict";a.d(t,{K:()=>Zt});var n=a(999963),o=a(893763),r=a(551499),i=a(267324),l=a(83437),s=a(9847),c=a(965634),d=a(956258),u=a(449650),m=a(830166),h=a(797639);function g(e){const t=h.CP.getActiveTable();if(!t)throw new o.tF("Failed to resolve selected tables!",e);return t}function p(e,t){const a=g(t).sheetRange,n=a.range.topLeft,r=n.row,i=n.column,l=a.range.bottomRight,s=l.row,c=l.column,d=e.range.range.topLeft,u=d.row,m=d.column,h=e.range.range.bottomRight,p=h.row,b=h.column;if(null===r||null===i||null===s||null===c)throw new o.tF("Table range is null",t,o.tJ.ColumnRowOutOfBoundary);if(null===u||null===m||null===p||null===b)throw new o.tF("Range is null",t,o.tJ.ColumnRowOutOfBoundary);if(r>u||s<p)throw new o.tF("Row is out of bounds of the table",t,o.tJ.ColumnRowOutOfBoundary);if(i>m||c<b)throw new o.tF("Column is out of bounds of the table",t,o.tJ.ColumnRowOutOfBoundary);return e}const b=(e,t)=>{e=e.toLowerCase();for(const a of t)if(a.test(e))return!0;return!1};var f=a(528804);const C=[/\(/,/\)/,/\{/,/\}/,/\\\\/,/\/\//,/=/,/#/,/!/,/div\/0/,/.*\|.*/],y=[/^(0?[1-9]|1\d|2\d|3[01])[/-](0?[1-9]|1[0-2])[/-](\d{4}|\d{2})$/,/^(0?[1-9]|1[0-2])[/-](0?[1-9]|1\d|2\d|3[01])[/-](\d{4}|\d{2})$/,/^(?:jan(?:uary)?|feb(?:ruary)?|mar(?:ch)?|apr(?:il)?|may|jun(?:e)?|jul(?:y)?|aug(?:ust)?|sep(?:tember)?|oct(?:ober)?|nov(?:ember)?|dec(?:ember)?)\s(?:0?[1-9]|[12]\d|3[01]),?(?:\s\d{2}(?:\d{2})?)?$/,/^(0[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])$|^(0[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])\/$|^(0[1-9]|1[0-2])\/(0?[1-9]|[12]\d|3[01])$|^(0[1-9]|1[0-2])\/(0?[1-9]|[12]\d|3[01])\/(0?[1-9]|[12]\d|3[01])$|^(0?[1-9]|1[0-2])\/(0[1-9]|[12]\d|3[01])$/],v=[/^-?[\d,. ']+%?$/],x=[/\b(odd|even)\s*(rows?|row)\b/i,/every\s+\b\w+\b\s*(rows?|row)/i],T=(0,f.yw9)("OfficeVSO_9193005_NegativeRowIndexEnglishFix")?[/\b(first|last|top|bottom|beginning|ending)([\w\d\s]*)(rows?)\b/i,/\b(rows?)([\w\d\s]*)(top|bottom|beginning|end)\b/i,/\b(rows?)([\w\d\s]*)(above|below|under)$/i,/\b(headers?)\b/i]:[/\b(first|last|top|bottom|beginning|ending)\s*([\w\d]*)\s*(rows?)\b/i,/\b(row?|rows?)\s*([\w\d]*)\s*(top|bottom|beginning|end)\b/i,/\b(row?|rows?)\s*(above|below|under)$/,/\b(headers?)\b/],S=[/\b(last|bottom|ending)\s*([\w\d]*)\s*(rows?)\b/i,/\b(row?|rows?)\s*([\w\d]*)\s*(bottom|end)\b/i,/\b(row?|rows?)\s*(below|under)\b/i],w=[/\b(this|these|selected)\s+(row|rows)\b/gi,/\b(row|rows)\s+(selected)\b/gi],E=[/\b(clear|remove|delete|erase)\s+sort/gi],I=[/^(?!.*format)\b(clear|delete|eliminate|empty|erase|remove).*?(cell|cells|content|contents|data|text|value|values)\b/i,/\b(clear|delete|eliminate|empty|erase|remove)\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(format|formats|formatting)\s+and\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(cell|cells|content|contents|data|text|value|values)\b/i,/\b(clear|delete|eliminate|empty|erase|remove)\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(cell|cells|content|contents|data|text|value|values)\s+and\s+(|all\s|all\s+of\s+the\s|all\s+the\s|cell\s|the\s)+(format|formats|formatting)\b/i],R=[/^(clear|delete|eliminate|empty|erase|remove) all(?!.*format)/i],A=[/^(remove|delete)/i];function L(e,t){if(t<0)throw new Error("Row index can bot be smaller than 0!");return{sheet:e,range:{topLeft:{row:t,column:null},bottomRight:{row:t,column:null}}}}function k(e,t){if(t<0)throw new Error("Column index can bot be smaller than 0!");return{sheet:e,range:{topLeft:{row:null,column:t},bottomRight:{row:null,column:t}}}}async function F(){try{return await Excel.run((async e=>{const t=e.workbook.worksheets.getActiveWorksheet();return t.load("name"),await e.sync(),t.name}))}catch{throw new o.tF("Failed to get active worksheet name","getActiveWorkSheetName")}}function _(e,t){const a=[];for(let n=e;n<=t;n++)a.push(n);return a}function P(e,t,a,n,r){if(null===e.range.topLeft.column||null===e.range.topLeft.row)throw new o.tF("Bad Column from TableContext","getFullTableEntityColumnRangeByIndex");const i=e.range.topLeft.column+t,l={row:e.range.topLeft.row,column:i},s={row:e.range.topLeft.row+1,column:i},c={row:e.range.bottomRight.row,column:i},d={sheet:e.sheet,range:{topLeft:s,bottomRight:c}},m={sheet:e.sheet,range:{topLeft:l,bottomRight:c}};return(0,f.avT)()&&n?{columnRange:{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.ColumnsBody,tableName:a,gridRange:d,subRangeValues:r?{columnNames:[r]}:{firstIndex:t,count:1}}},fullColumnRange:{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Columns,tableName:a,gridRange:m,subRangeValues:r?{columnNames:[r]}:{firstIndex:t,count:1}}}}:{columnRange:{rangeType:u.RangeType.ExcelSheetRange,range:d},fullColumnRange:{rangeType:u.RangeType.ExcelSheetRange,range:m}}}var N=a(36604);function M(e,t){let a=[];const n=(0,N.dc)(e,"worksheetRowNumbers");return n&&n.length>0?n.map((e=>{if(e<=t)throw new o.tF("worksheetRowNumber specified out of boundary.","getRowNumber",o.tJ.ColumnRowOutOfBoundary);a.push(e-t-1)})):a=(0,N.dc)(e,"rowNumbers"),a}async function O(){if((0,f.yw9)("OfficeVSO_9194315_Selection")){const e=h.CP.getActiveRangeAddresses();if(0===e.length)return[];try{return e.map((e=>u.ExcelCalc.sheetAddressToGeneralExcelSheetRange(e))).map((e=>e.range))}catch{throw new o.tF("Failed to get selected ranges.","getSelectedRanges",o.tJ.ColumnRowBySelection)}}try{return await Excel.run((async e=>{const t=e.workbook.getSelectedRanges(),a=t.areas;a.load("items/address"),t.load("address"),await e.sync();return a.items.map((e=>e.address)).map((e=>u.ExcelCalc.sheetAddressToGeneralExcelSheetRange(e))).map((e=>e.range))}))}catch{throw new o.tF("Failed to get selected ranges.","getSelectedRanges")}}var D=a(947621);function B(e,t,a,n,r,i){let l=[];if(t.length>0)l=U(e,t,i);else if(a.length>0||n.length>0)l=$(e,a.length>0?a:n,i);else if(r.length>0)l=function(e,t,a){const n=e.sheetRange,r=n.range.topLeft.column;if(null===r)throw new o.tF("Left column index of the table is null.",a);const i=t.map((t=>{if(t<0)return $(e,[t],a)[0];const n=t-1;if((0,f.yw9)("OfficeVSO_8385154_ColumnByWorksheetNumberBugFix")){if(n>r+e.numColumns-1||n<r)throw new o.tF("Worksheet index received is outside of the table.",a,o.tJ.ColumnRowOutOfBoundary);return n-r}if(t>r+e.numColumns-1||t<r)throw new o.tF("Worksheet index received is outside of the table.",a,o.tJ.ColumnRowOutOfBoundary);return t-r}));return i}(e,r,i);else{if("filterTables"===i||"sortTables"===i)throw new o.tF("No column argument specified.",i);if("insertColumns"===i)return[];if("clearFilters"===i)throw new o.tF("No column argument specified.",i,o.tJ.NoColumnArgument);l=Array.from({length:e.numColumns},((e,t)=>t))}const c=[];if(l.map((t=>{-1===e.visibleColumns.indexOf(t)&&c.push(t)})),c.length>0){m.g.instance().setHiddenColumnSuffixMessage(e,c);const t=[{key:s.xL.NumOfColumnHidden,value:c.length}];(0,D.R)(new o.tF("User selected a column that is hidden.",i,o.tJ.General,t))}return l}function $(e,t,a){return t.map((t=>{let n;if(n=t<0?e.numColumns+t:t-1,n>=e.numColumns||n<0)throw new o.tF("Column index specified out of boundary.",a,o.tJ.ColumnRowOutOfBoundary);return n}))}function H(e){return String.raw`${e}`.replace(/\\n/g," ").replace(/\\r/g," ").replace(/\\t/g," ").replace(/\\v/g," ").replace(/\\(.)/g,"$1").replace(/\s+/g," ").trim().toLowerCase()}function U(e,t,a){const n=JSON.parse(e.headers);return t.map((e=>{let t=n.indexOf(e);if(-1===t){if((0,f.yw9)("OfficeVSO_8432116_CleaningColumnName")){const a=H(e);t=n.findIndex((e=>H(e)===a))}if(-1===t)throw new o.tF("Column name specified not found.",a,o.tJ.ColumnRowOutOfBoundary)}return t}))}function q(e,t,a=!1){const n=[];let r=t.sheetRange;if(h.CP.isTableHeaderShown()){if(null===r.range.topLeft.row)throw new o.tF("Row range has incorrect format","getTableRowIndicesFromRanges");r={sheet:r.sheet,range:{topLeft:{row:r.range.topLeft.row+1,column:r.range.topLeft.column},bottomRight:r.range.bottomRight}}}for(const t of e){if(t.range.topLeft.row!==t.range.bottomRight.row)throw new o.tF("Row range has incorrect format","getTableRowIndicesFromRanges");if(null===t.range.topLeft.row||null===r.range.topLeft.row||null===r.range.bottomRight.row)throw new o.tF("Row not available (e.g. range address might refer to a full column)","getTableRowIndicesFromRanges",o.tJ.ColumnRowOutOfBoundary);if(t.range.topLeft.row<r.range.topLeft.row||t.range.topLeft.row>r.range.bottomRight.row+(a?1:0))throw new o.tF("Row out of boundary","getTableRowIndicesFromRanges",o.tJ.ColumnRowOutOfBoundary);const e=t.range.topLeft.row-r.range.topLeft.row;n.push(e)}if(0===n.length)throw new o.tF("No matched row index found","getTableRowIndicesFromRanges");return n}async function V(e){return await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.worksheets.getActiveWorksheet().load("name"),n=a.getRange(u.ExcelCalc.IExcelRangeToAddress(e.sheetRange.range)).getVisibleView();n.load("cellAddresses"),await t.sync();return n.cellAddresses.map((e=>{if((0,f.yw9)("OfficeVSO_9322539_InsertAtTableEnd")&&0===e.length)throw new o.tF("No visible table row.","getVisibleRowRanges",o.tJ.NoVisibleRange);const t=a.name+"!"+e[0]+":"+e[e.length-1];return u.ExcelCalc.sheetAddressToExcelSheetRange(t)}))}))}var G=a(299512),W=a(380644),z=a.n(W);class j{static async getSelectedWorksheets(e){let t=[];if(t=(0,N.Lb)(e,"worksheetNames"),0===t.length){const a=(0,N.dc)(e,"worksheetNumbers");if(a&&a.length>0){const e=await async function(){return Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.worksheets.load("items");return await e.sync(),t.items.map((e=>e.name))}))}();t=a.map((t=>{if(t<1||t>e.length)throw new o.tF("Worksheet number can not be 0 or greater than number of worksheets!","getSelectedWorksheets");return e[t-1]}))}else t=[await F()]}if(0===t.length)throw new o.tF("No worksheet has been selected!","getSelectedWorksheets");return t}static async getSelectedRanges(e,t){let a=await j.getWorksheetScopeVariable(e,t);void 0===a&&(a=await F());let n=[];const r=(0,N.Lb)(e,"addresses");if(n=r&&r.length>0?r.map((t=>p({rangeType:u.RangeType.ExcelSheetRange,range:{sheet:a,range:u.ExcelCalc.addressToExcelRange(t)}},e.name))):(await O()).map((t=>{if((0,f.yw9)("OfficeVSO_8973949_CheckSelectionOutsideOfTable")){return p({rangeType:u.RangeType.ExcelSheetRange,range:{sheet:a,range:t.range}},e.name)}return{rangeType:u.RangeType.ExcelSheetRange,range:t}})),(0,f.avT)()){let e={};await Excel.run((async t=>{e=await z().getTablesNameToRangeMapOnSheet(t,a)})),n=n.map((t=>{for(const a of Object.keys(e)){const n=u.ExcelEventConverter.makeTableRangeOperation(a,e[a],t.range);if(n){return{rangeType:u.RangeType.TableRange,range:n}}}return t}))}if(0===n.length)throw new o.tF("No ranges has been selected!","getSelectedRanges");return n}static async getSelectedTables(e,t){let a=await j.getWorksheetScopeVariable(e,t);void 0===a&&(a=await F());const n=(0,N.Lb)(e,"tableNames"),r=j.tryGetSelectedTableContext(e.name);if(0===n.length){if(!r)throw new o.tF("Failed to resolve selected tables!","getSelectedTables",o.tJ.NoActiveTable);return[r]}const i=[];for(let e=0;e<n.length;e++){const t=n[e];if(r&&(0,G.P9)(r.name,t))i.push(r);else{await h.CP.fetchAndSetActiveTableLikeEntity(t);const e=h.CP.getActiveTable();e&&i.push(e)}}if(0===i.length)throw new o.tF("No table has been selected!","getSelectedTables",o.tJ.NoActiveTable);return i}static async getSelectedColumns(e,t){const a=t.tryGetScopeChainedVariableArgument(e),n=t.tryGetScopeVariableArgumentName(e);if(!a||!n)return await j.getTableScopeSelectedColumns(e);if("Table"===a.entityType){const t=a.values[0];return await j.getTableColumnRanges(t,e,n)}throw"Worksheet"===a.entityType?new o.tF("Worksheet column is not currently supported.","getSelectedColumns",o.tJ.ColumnRowOutOfBoundary):new o.tF(`Scope ${a.entityType} is not supported`,"getSelectedColumns")}static async getTableColumnRanges(e,t,a){let n=(0,N.Lb)(t,"columnNames");const o=B(e,n,(0,N.dc)(t,"columnNumbers"),(0,N.dc)(t,"tableColumnNumbers"),(0,N.dc)(t,"worksheetColumnNumbers"),t.name);if(0===n.length&&(0,f.avT)()){const t=JSON.parse(e.headers);n=o.map((e=>t[e]))}return await j.getTableColumnRangesBase(o,e,n,a)}static async getTableColumnRangesBase(e,t,a,n){if((0,f.xyg)("AutofitSelectedRowsColumns")){const r=await Promise.all(e.map((async(e,n)=>{const o=0===a.length?void 0:a[n];return P(t.sheetRange,e,t.name,(0,h.En)(t),o)})));if(0===r.length)throw new o.tF("No column is selected!","getTableColumnRangesBase");return{ranges:r.map((e=>e.columnRange)),fullRanges:r.map((e=>e.fullColumnRange)),indices:e,tableKey:n}}{const r=await Promise.all(e.map((async(e,n)=>{const o=0===a.length?void 0:a[n],{columnRange:r}=P(t.sheetRange,e,t.name,(0,h.En)(t),o);return r})));if(0===r.length)throw new o.tF("No column is selected!","getTableColumnRangesBase");return{ranges:r,indices:e,tableKey:n}}}static getTableColumnNames(e,t){const a=(0,N.Lb)(t,"columnNames"),n=(0,N.dc)(t,"columnNumbers"),o=(0,N.dc)(t,"tableColumnNumbers"),r=(0,N.dc)(t,"worksheetColumnNumbers"),i=JSON.parse(e.headers);return B(e,a,n,o,r,t.name).map((e=>i[e]))}static getTableColumnName(e,t){const a=(0,N.Ru)(t,"columnName"),n=(0,N.lI)(t,"columnNumber"),o=(0,N.lI)(t,"tableColumnNumber"),r=(0,N.lI)(t,"worksheetColumnNumber");return JSON.parse(e.headers)[B(e,a?[a]:[],n?[n]:[],o?[o]:[],r?[r]:[],t.name)[0]]}static getTableColumnNumber(e,t){const a=(0,N.Ru)(e,"columnName"),n=(0,N.lI)(e,"columnNumber"),o=(0,N.lI)(e,"tableColumnNumber"),r=(0,N.lI)(e,"worksheetColumnNumber");return B(t,a?[a]:[],n?[n]:[],o?[o]:[],r?[r]:[],e.name)[0]}static getTableColumnNumbers(e,t){const a=(0,N.dc)(e,"tableColumnNumbers");return B(t,[],(0,N.dc)(e,"columnNumbers"),a,(0,N.dc)(e,"worksheetColumnNumbers"),e.name)}static async getTableScopeSelectedColumns(e){const t=e.name,a=g(t),n=(await O())[0],r=n.range.topLeft.column,i=n.range.bottomRight.column;if(null===r||null===i)throw new o.tF("selected range is invalid","getTableScopeSecelectedColumns");const l=_(r,i),s=l.map((e=>e+1)),c=B(a,[],[],[],(0,f.yw9)("OfficeVSO_8385154_ColumnByWorksheetNumberBugFix")?s:l,t);let d=[];if((0,f.avT)()){const e=JSON.parse(a.headers);d=c.map((t=>e[t]))}const u=(0,N.iA)(e);u&&(u.type="var",u.name="tables",e.arguments.tableColumnNumbers={type:"numberList",numberList:c});const m=u?.name??"Selection";return await j.getTableColumnRangesBase(c,a,d,m)}static async getSelectedColumnsDeprecated(e,t,a){const n=(0,N.NW)(e,"scope");if(!n)return this.getTableScopeSelectedColumns(e);const r=n.name,i=t.tryGetChainedVariableArgument(r);if(!i)return this.getTableScopeSelectedColumns(e);let l=(0,N.dc)(e,"columnNumbers"),s=(0,N.Lb)(e,"columnNames");if("Table"===i.entityType){const t=i.values[0],n=JSON.parse(t.headers),c=t.visibleColumns;if(l=0===l.length?l.concat(s.map((e=>{const t=n.indexOf(e);if(-1===t)throw new o.tF("Column name specified not found.","getSelectedColumnsDeprecated",o.tJ.ColumnRowOutOfBoundary);return t}))):l.map((t=>function(e,t,a){let n;if(n=e<0?t.length+e:e-1,n>=t.length||n<0)throw new o.tF("Column index specified out of boundary.",a,o.tJ.ColumnRowOutOfBoundary);return t[n]}(t,c,e.name))),0===s.length&&(0,f.avT)()){const e=JSON.parse(t.headers);s=l.map((t=>e[t]))}if((0,f.xyg)("AutofitSelectedRowsColumns")){0===l.length&&0===s.length&&(l=[...c]);const e=await Promise.all(l.map((async(e,a)=>{const n=s.length>0?s[a]:void 0;return P(t.sheetRange,e,t.name,!t.tableLikeRange,n)})));if(0===e.length)throw new o.tF("No column is selected!","getSelectedColumnsDeprecated");return m.g.instance().setIsFirstColumnEntityResolved(t.headers,a),{ranges:e.map((e=>e.columnRange)),fullRanges:e.map((e=>e.fullColumnRange)),indices:l,tableKey:r}}{const e=await Promise.all(l.map((async(e,a)=>{const n=await async function(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const n=a.workbook.tables.getItem(e).columns.getItemAt(t).getDataBodyRange().load("address");return await a.sync(),n}))}(t.name,e);if((0,f.avT)()&&(0,h.En)(t)){const o=s.length>0?s[a]:void 0;return{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.ColumnsBody,gridRange:u.ExcelCalc.sheetAddressToExcelSheetRange(n.address),tableName:t.name,subRangeValues:o?{columnNames:[o]}:{firstIndex:e,count:1}}}}return{rangeType:u.RangeType.ExcelSheetRange,range:u.ExcelCalc.sheetAddressToExcelSheetRange(n.address)}})));if(0===e.length)throw new o.tF("No column is selected!","getSelectedColumnsDeprecated");return m.g.instance().setIsFirstColumnEntityResolved(t.headers,a),{ranges:e,indices:l,tableKey:r}}}if("Worksheet"===i.entityType){const t=i.values[0];let a=[];if(0===l.length){a=(0,N.Lb)(e,"columnNames").map((e=>{const a=e+":"+e;return{rangeType:u.RangeType.ExcelSheetRange,range:{sheet:t,range:u.ExcelCalc.addressToExcelRange(a)}}}))}else a=l.map((e=>({rangeType:u.RangeType.ExcelSheetRange,range:k(t,e-1)})));if(0===a.length)throw new o.tF("No column is selected!","getSelectedColumnsDeprecated");return{ranges:a,worksheetKey:r,indices:l}}throw new o.tF("invalid entity type","getSelectedColumnsDeprecated")}static async getSelectedRows(e,t,a){if(void 0===a)throw new o.tF("No query string",e.name);const n=(0,N.NW)(e,"scope");if(!n||"Selection"===n.name)return j.getTableSelectedRows(e);const r=n.name,i=t.tryGetChainedVariableArgument(r);if(!i)throw new o.tF("No cached upper variable","getSelectedRows");let l=[];const s=(0,f.yw9)("OfficeVSO_9436607_WorksheetRowNumber");if(s||(l=(0,N.dc)(e,"rowNumbers")),"Table"===i.entityType){const t=i.values[0];if(!s&&null==t.sheetRange.range.topLeft.row)throw new o.tF("Table row range has incorrect format","getSelectedRows");const n=t.sheetRange.range.topLeft.row??0;if(s&&(l=M(e,n)),(0,f.yw9)("OfficeVSO_8375706_SelectAllRows")&&0===l.length)return this.getAllRows(t,r);const c=[...l],d=[],u=[],m=t.numRows;for(let e=0;e<l.length;e++)if(l[e]<0)if((0,f.yw9)("OfficeVSO_9279053_SelectRowRegExpRemoval")||b(a,T))d.push(l[e]+n+m+1),u.push(c[e]+m);else{if((0,f.yw9)("OfficeVSO_8532526_DeleteEmptyRows")&&-1===l[e]&&b(a,A))throw new o.tF("Deleting unexpected negative rows is a blocked scenario","deleteRows",o.tJ.DeleteUnexpectedTableRows);if(!t.totalRow)throw new o.tF("invalid negative row number expected","getSelectedRows");d.push(n+m+1),u.push(m)}else if(0===l[e])d.push(n),u.push(-1);else{if(l[e]>m+(t.totalRow?1:0))throw new o.tF("row numbers is greater than expected","getSelectedRows");d.push(l[e]+n),u.push(c[e]-1)}return{ranges:await j.getTableRowRangesCommon(t,d,!0),tableKey:r,indices:u}}if("Worksheet"===i.entityType){s&&(l=(0,N.dc)(e,"worksheetRowNumbers"));return{ranges:j.getWorksheetRowRangeCommon(i,l,a),worksheetKey:r,indices:l}}throw new o.tF("invalid entity type","getSelectedRows")}static async getTableSelectedRows(e){const t=g(e.name),a=(await O())[0],n=a.range.topLeft.row,r=a.range.bottomRight.row;if(null===n||null===r)throw new o.tF("selected range is invalid","getTableScopeSelectedColumns");const i=_(n,r),l=await j.getTableRowRangesCommon(t,i,!0);let s=[];if(s=q(l.map((e=>u.ExcelCalc.getIGeneralRangeOperationRange(e))),t),(0,f.avT)()){const t=(0,N.iA)(e);t&&(t.type="var",t.name="tables",e.arguments.rowNumbers={type:"numberList",numberList:s})}return{ranges:l,tableKey:"Selection",indices:s}}static async getAllRows(e,t){const a=(await V(e)).map((t=>{let a;return a=(0,f.avT)()&&(0,h.En)(e)?{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Rows,gridRange:t,tableName:e.name,subRangeValues:{firstIndex:e.sheetRange.range.topLeft.row-t.range.topLeft.row-1,count:1}}}:{rangeType:u.RangeType.ExcelSheetRange,range:t},a})),n=(e.sheetRange.range.topLeft.row??0)+1,o=a.map((e=>(u.ExcelCalc.getIGeneralRangeOperationRange(e).range.topLeft.row??0)-n));return h.CP.isTableHeaderShown()&&(o.shift(),a.shift()),{ranges:a,tableKey:t,indices:o,allRows:!0}}static getWorksheetRowRangeCommon(e,t,a){(0,f.yw9)("OfficeVSO_9279066_RemoveRegExForRowBySelection")||function(e){if(b(e,w))throw new o.tF("Blocked phrase for referencing rows by selection","getSelectedRows",o.tJ.ColumnRowBySelection)}(a);const n=e.values[0],r=t.map((e=>({rangeType:u.RangeType.ExcelSheetRange,range:L(n,e-1)})));if(0===r.length)throw new o.tF("No row is selected!","getSelectedRows");return r}static async getTableRowRangesCommon(e,t,a=!1){const n=await V(e);let r=[];if(r=a?j.getTableRowsByWorksheetIndices(n,t,e):await j.getTableRowsByTableIndices(e,n,t),0===r.length)throw new o.tF("No row is selected!","getSelectedRows");return r}static getTableRowsByWorksheetIndices(e,t,a){const n=[];j.throwIfRowsOutOfBoundary(t,a);for(const o of t){const t=e.find((e=>e.range.topLeft.row===o));if(t)if((0,f.avT)()&&(0,h.En)(a)){const e={rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Rows,tableName:a.name,gridRange:t,subRangeValues:{firstIndex:t.range.topLeft.row-a.sheetRange.range.topLeft.row-1,count:1}}};n.push(e)}else{const e={rangeType:u.RangeType.ExcelSheetRange,range:t};n.push(e)}}return n}static async getTableRowsByTableIndices(e,t,a){e.totalRow&&t.pop();const n=(0,f.yw9)("OfficeVSO_9322539_InsertAtTableEnd");if(n){if(0===t.length)throw new o.tF("No visible table row.","getTableRowsByTableIndices",o.tJ.NoVisibleRange);t.push({sheet:t[t.length-1].sheet,range:{topLeft:{row:t[t.length-1].range.topLeft.row+1,column:t[t.length-1].range.topLeft.column},bottomRight:{row:t[t.length-1].range.bottomRight.row+1,column:t[t.length-1].range.bottomRight.column}}})}return(a=a.map((e=>{let a=e;if(e<0?a=n?-1===e?t.length-1:t.length+e-1:t.length+e:h.CP.isTableHeaderShown()||(a=e-1),a>=t.length||a<0)throw new o.tF("Row index specified out of boundary.","getSelectedRows",o.tJ.ColumnRowOutOfBoundary);return a}))).map((a=>{if((0,f.avT)()&&(0,h.En)(e)){let n;return n=0===a?{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.HeaderRow,tableName:e.name,gridRange:t[a]}}:{rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Rows,tableName:e.name,gridRange:t[a],subRangeValues:{firstIndex:t[a].range.topLeft.row-e.sheetRange.range.topLeft.row-1,count:1}}},n}return{rangeType:u.RangeType.ExcelSheetRange,range:t[a]}}))}static async getWorksheetScopeVariable(e,t){const a=t.tryGetVariableArgumentValue(e,"scope");if(a&&"Worksheet"===a.entityType){const e=a.values;if(1===e.length)return e[0]}}static tryGetSelectedTableContext(e){try{return g(e)}catch{return}}static throwIfRowsOutOfBoundary(e,t){const a=t.sheetRange.range.topLeft.row,n=t.sheetRange.range.bottomRight.row;if(a&&e[0]<a||n&&e[e.length-1]>n)throw new o.tF("Row index specified out of boundary.","getSelectedRows",o.tJ.ColumnRowOutOfBoundary)}}class Q{async cacheVariable(e,t){const a=this._variableCacheMap[e.name];await a(e,t)}isSelectStatement(e){return!!this._variableCacheMap[e.name]}isRowColumnSelectStatementWithSelectionScope(e){return!!(0,N.iA)(e)&&("selectColumns"===e.name||"selectRows"===e.name)}isDeleteColumnsStatement(e){return"deleteColumns"===e.name}isInsertColumnsStatement(e){return"insertColumns"===e.name}isSelectColumnsStatement(e){return"selectColumns"===e.name}isDeleteRowsStatement(e){return"deleteRows"===e.name}isInsertRowsStatement(e){return"insertRows"===e.name}isSelectRowsStatement(e){return"selectRows"===e.name}tryGetVariableArgumentValue(e,t){try{return this.getVariableArgumentValue(e,t)}catch{return}}getVariableArgumentValue(e,t){const a=(0,N.YL)(e,t),n=this.returnVariableCache[a];if(void 0===n)throw new o.tF("Cannot find variable in the cache dictionary!",t);return n}getChainedVariableArgument(e){const t=this.returnVariableCache[e];if(void 0===t)throw new o.tF("Chained variable cache is not found.","getChainedVariableArgument");return t}tryGetChainedVariableArgument(e){try{return this.getChainedVariableArgument(e)}catch{return}}getScopeChainedVariableArgument(e){const t=(0,N.l$)(e).name;return this.getChainedVariableArgument(t)}tryGetScopeChainedVariableArgument(e){try{return this.getScopeChainedVariableArgument(e)}catch{return}}getScopeVariableArgumentName(e){const t=(0,N.l$)(e);if(void 0===t.name)throw new o.tF("Scope name is undefined.","getScopeVariableArgumentName");return t.name}tryGetScopeVariableArgumentName(e){try{return this.getScopeVariableArgumentName(e)}catch{return}}getTableContext(e,t,a){const n=t.getVariableArgumentValue(e,a).values;if(!n.tableKey)throw new o.tF("Table key not found!",a);const r=t.getChainedVariableArgument(n.tableKey);if("Table"!==r.entityType)throw new o.tF("Variable cache entity type mismatched!","getTableContext: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return r.values[0]}UpdateVariableCache(e,t,a){void 0!==e&&(this.returnVariableCache[e]={entityType:t,values:a})}fillVariableCacheMap(){this._variableCacheMap.selectWorksheets=async(e,t)=>{const a=await j.getSelectedWorksheets(e);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Worksheet",values:a}},this._variableCacheMap.selectRanges=async(e,t)=>{const a=await j.getSelectedRanges(e,this);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Range",values:a}},this._variableCacheMap.selectTables=async(e,t)=>{const a=await j.getSelectedTables(e,this);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Table",values:a}},this._variableCacheMap.selectColumns=async(e,t)=>{const a=await j.getSelectedColumns(e,this);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Column",values:a}},this._variableCacheMap.selectRows=async(e,t)=>{const a=await j.getSelectedRows(e,this,t);this.returnVariableCache[(0,N.nZ)(e)]={entityType:"Row",values:a}}}constructor(){this.returnVariableCache={},this._variableCacheMap={},this.fillVariableCacheMap()}}function J(e){return e.replace(/\\n/g,"\n").replace(/\\'/g,"'")}function Y(e,t){return J((0,N.C3)(e,t))}function X(e,t){const a=(0,N.Ru)(e,t);return a?J(a):a}function Z(e,t=[]){for(let a=0;a<e.length;a++)Array.isArray(e[a])?Z(e[a],t):t.push(e[a]);return t}function K(e){if(null===e.range.topLeft.row)throw new o.tF("no sheet range associated with table");return{rangeType:u.RangeType.ExcelSheetRange,range:{sheet:e.sheet,range:{topLeft:{row:e.range.topLeft.row+1,column:e.range.topLeft.column},bottomRight:e.range.bottomRight}}}}async function ee(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","conditionalFormatTables");const a=t.getVariableArgumentValue(e,"tables");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedTableRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const n=a.values,r=[];for(const e of n){let t;t=K(e.sheetRange),((0,f.avT)()||(0,f.yw9)("OfficeVSO_9266813_CommandingConvertTableRangeToName"))&&(0,h.En)(e)&&(t={rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Body,tableName:e.name,gridRange:u.ExcelCalc.getIGeneralRangeOperationRange(t)}}),r.push(t)}return r}function te(e,t){if(void 0===e.arguments.columns)throw new o.tF("No columns specified.",e.name);const a=t.getVariableArgumentValue(e,"columns");if("Column"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedColumnRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return a.values.ranges}function ae(e,t){if(void 0===e.arguments.rows)throw new o.tF("No rows specified.",e.name);const a=t.getVariableArgumentValue(e,"rows");if("Row"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedRowRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return a.values.ranges}function ne(e,t){if(void 0===e.arguments.ranges)throw new o.tF("No range specified.",e.name);const a=t.getVariableArgumentValue(e,"ranges");if("Range"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getResolvedRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return a.values}function oe(e,t){const a=t.getVariableArgumentValue(e,"columns").values;if(!a?.tableKey)throw new o.tF("No table specified","columns");const n=t.tryGetChainedVariableArgument(a.tableKey);if(!n||!Array.isArray(n.values)||0===n.values.length)throw new o.tF("Table not found","columns");const r=n.values[0];if(!r?.headers)throw new o.tF("Invalid table data");const i=JSON.parse(r.headers);if(!Array.isArray(i)||0===i.length)throw new o.tF("Invalid table headers");const l=a.indices.map((e=>`'${i[e]}'`)).join(", ");if(!l)throw new o.tF("Invalid column name(s)");return l}function re(e){const t={...e,bottomRight:{...e.bottomRight,row:e.bottomRight.row?e.bottomRight.row-1:e.bottomRight.row}};return u.ExcelCalc.IExcelRangeToAddress(t)}var ie=a(874858),le=a(542375);function se(e,t){const a={rangeType:u.RangeType.ExcelSheetRange,range:t,values:e};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.Edited,t.sheet,a)}function ce(e,t){const a={rangeType:u.RangeType.ExcelSheetRange,range:t,value:e};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.SingleValueEdited,t.sheet,a)}function de(e,t,a,n){const o={rangeType:a.rangeType,range:a.range,value:t,columnName:n},r=u.ExcelCalc.getIGeneralRangeOperationRange(a).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,r,o)}function ue(e,t,a){return ie.ExcelEventConverter.makeGenericEvent(e,a,t)}function me(e,t,a){const n={direction:a,rangeType:t.rangeType,range:t.range},o=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,o,n)}function he(e,t,a,n){const o={name:t,index:a,count:n};return ie.ExcelEventConverter.makeGenericEvent(e,t,o)}function ge(e,t,a,n){const o={name:e,index:t,count:a,columnNames:n};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.ColumnInserted,e,o)}function pe(e,t){const a={rangeType:t.rangeType,range:t.range},n=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,n,a)}function be(e,t){const a={rangeType:t.rangeType,range:t.range},n=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,n,a)}function fe(e,t,a,n,o){const r={searchString:e,replaceWith:t,completeMatch:a,matchCase:n,rangeType:o.rangeType,range:o.range},i=u.ExcelCalc.getIGeneralRangeOperationRange(o).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.ReplacedAll,i,r)}function Ce(e,t){const a={command:e,rangeType:t.rangeType,range:t.range},n=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.Cleared,n,a)}function ye(e,t,a,n,o){const r={tableName:e,columnName:t,top:a,type:n,count:o};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.Top10FilterApplied,e,r)}function ve(e,t,a,n){const o={tableName:t,columnName:a,color:n};return ie.ExcelEventConverter.makeGenericEvent(e,t,o)}function xe(e,t,a,n,o){const r={range:t.range,columnName:n,rangeType:t.rangeType,formatType:le.default.Custom,rule:a,customFormat:o},i=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,i,r)}function Te(e){const t={wholeSheet:!0,rangeType:e.rangeType,range:e.range},a=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.Deleted,a,t)}async function Se(e,t){let a=[],n=(0,N.BO)(e,"validationType");["date","decimal","textLength","time","wholeNumber"].includes(n)&&(n="basic");const o=we[n];a=await o(t,e);const i=[];if(a.length>0){const e={agent:r.w2.OfficeScripts,items:a};i.push(e)}return i}const we={list:async(e,t)=>{let a;const n=(0,N.Ru)(t,"source");if(void 0===n)throw new o.tF("Source is empty",t.name);void 0===(0,N.Ak)(t,"inCellDropDown")&&(a=!0);const r=Z(await Promise.all(e.map((async e=>{const t=function(e,t,a){const n={range:e.range,rangeType:e.rangeType,source:t,inCellDropDown:a},o=u.EventMethods.Range.DataValidationRuleListChanged,r=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(o,r,n)}(e,n,a);return[t]}))));return r},custom:async(e,t)=>{const a=(0,N.Ru)(t,"customFormula");if(void 0===a)throw new o.tF("Formula is empty",t.name);const n=Z(await Promise.all(e.map((async e=>{const t=function(e,t){const a={range:e.range,rangeType:e.rangeType,formula:t},n=u.EventMethods.Range.DataValidationRuleCustomChanged,o=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(n,o,a)}(e,a);return[t]}))));return n},basic:async(e,t)=>{let a;switch((0,N.BO)(t,"validationType")){case"date":a=u.EventMethods.Range.DataValidationRuleDateChanged;break;case"decimal":a=u.EventMethods.Range.DataValidationRuleDecimalChanged;break;case"textLength":a=u.EventMethods.Range.DataValidationRuleTextLengthChanged;break;case"time":a=u.EventMethods.Range.DataValidationRuleTimeChanged;break;case"wholeNumber":a=u.EventMethods.Range.DataValidationRuleWholeNumberChanged}const n=(0,N.Ru)(t,"formula1"),r=(0,N.Ru)(t,"formula2")??"",i=(0,N.BO)(t,"operator");if(void 0===n||void 0===i)throw new o.tF("Formula1 or Operator is empty",t.name);if(("Between"===i||"NotBetween"===i)&&""===r)throw new o.tF("Operator is ternary but formula2 is empty",t.name);const l=Z(await Promise.all(e.map((async e=>{const t=function(e,t,a,n,o){const r={range:t.range,rangeType:t.rangeType,formula1:a,formula2:n,operator:o},i=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(e,i,r)}(a,e,n,r,i);return[t]}))));return l}};var Ee=a(972677);function Ie(e,t,a){const n=(0,N.Ak)(t,"content")??!1,i=(0,N.Ak)(t,"format")??!1,l={agent:r.w2.OfficeScripts,items:[]};if((0,f.yw9)("OfficeVSO_9448487_fixClearContentFormatAndHyperlink")){for(const a of e)Re(l,t,a);return 0===l.items.length&&(0,o.VD)(t,e.length,[]),[l]}for(const t of e)n&&a&&(b(a,I)||b(a,R))&&l.items.push(Ce(Ee.default.ClearCells,t)),i&&l.items.push(Ce(Ee.default.ClearCellsFormat,t));return 0===l.items.length&&(0,o.VD)(t,e.length,[]),[l]}function Re(e,t,a){const n=(0,N.Ak)(t,"content")??!1,o=(0,N.Ak)(t,"format")??!1,r=(0,N.Ak)(t,"hyperlink")??!1,i=(0,N.Ak)(t,"all")??!1;n&&e.items.push(Ce(Ee.default.ClearCells,a)),o&&e.items.push(Ce(Ee.default.ClearCellsFormat,a)),r&&e.items.push(function(e,t){const a={command:e,rangeType:t.rangeType,range:t.range},n=u.ExcelCalc.getIGeneralRangeOperationRange(t).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.HyperlinkRemoved,n,a)}(Ee.default.ConvertLinkedEntitiesToText,a)),i&&e.items.push(Ce(Ee.default.ClearCellsAll,a))}async function Ae(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showHeaders=e.value,await t.sync()})),`I ${e.value?"set":"unset"} the header row on the table`}async function Le(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showTotals=e.value,await t.sync()})),`I ${e.value?"added":"removed"} a total row from the table`}async function ke(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showBandedRows=e.value,await t.sync()})),`I ${e.value?"added":"removed"} banded rows`}async function Fe(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showBandedColumns=e.value,await t.sync()})),`I ${e.value?"added":"removed"} banded columns`}async function _e(e){return await Excel.run({delayForCellEdit:!0},(async t=>{t.workbook.tables.getItem(e.tableName).showFilterButton=e.value,await t.sync()})),`I ${e.value?"added":"removed"} the filter button`}async function Pe(e){const{tableName:t,columnName:a,color:n}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const o=e.workbook.tables.getItem(t),r=o.getHeaderRowRange();r.load("values"),await e.sync();const i=r.values[0].indexOf(a);o.autoFilter.apply(o.getRange(),i,{filterOn:"CellColor",color:n}),await e.sync()})),`I applied a cell color filter on ${a} to show only rows that are highlighted ${n}`}async function Ne(e){const{tableName:t,columnName:a,color:n}=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const o=e.workbook.tables.getItem(t),r=o.getHeaderRowRange();r.load("values"),await e.sync();const i=r.values[0].indexOf(a);o.autoFilter.apply(o.getRange(),i,{filterOn:"FontColor",color:n}),await e.sync()})),`I applied a font color filter on ${a} to show only rows that contain ${n} text `}async function Me(e){const t=e;let a=[];await Excel.run({delayForCellEdit:!0},(async e=>{const n=e.workbook.tables.getItem(t.tableName);n.sort.apply(t.fields,t.caseMatch,t.method);const o=n.getHeaderRowRange();o.load("values"),await e.sync(),a=o.values[0]}));const n=[];return t.fields.forEach((e=>((e,t)=>{if(e.key<a.length){let n=`${a[e.key]} column in `;"FontColor"===e.sortOn?n+="font color":"CellColor"===e.sortOn?n+="cell color":e.ascending?n+="ascending":n+="descending",n+=" order",t.push(n)}})(e,n))),0===n.length?"I sorted the table":`I sorted the table by ${n.join(", ")}`}async function Oe(e){const t=e;return await Excel.run({delayForCellEdit:!0},(async e=>{const a=e.workbook.tables.getItem(t.tableName),n=t.tableStyle;a.style="None"===n?null:t.tableStyle,await e.sync()})),`I applied the ${t.tableStyle} style to the table`}var De=a(236348),Be=a(827508);function $e(e,t){if(void 0===e)throw new o.tF("Limit1 is undefined!","filterTables");if(b(e,C))throw new o.tF("Invalid characters for custom filter in limit1","limit1");if(void 0!==t&&b(t,C))throw new o.tF("Invalid characters for custom filter in limit2","limit2")}function He(e,t){let a="";switch(e){case Be.default.Equals:a=`=${t}`;break;case Be.default.DoesNotEqual:a=`<>${t}`;break;case Be.default.BeginsWith:a=`=${t}*`;break;case Be.default.DoesNotBeginWith:a=`<>${t}*`;break;case Be.default.EndsWith:a=`=*${t}`;break;case Be.default.DoesNotEndWith:a=`<>*${t}`;break;case Be.default.Contains:a=`=*${t}*`;break;case Be.default.DoesNotContain:a=`<>*${t}*`;break;case Be.default.IsGreaterThan:a=`>${t}`;break;case Be.default.IsGreaterThenOrEqualTo:a=`>=${t}`;break;case Be.default.IsLessThen:a=`<${t}`;break;case Be.default.IsLessThanOrEqualTo:a=`<=${t}`;break;default:throw new Error(`CustomFilterCompareType '${e}' not implemented.`)}return a}function Ue(e,t,a){const n=""!==a;switch(e){case"equalTo":return{compareType:"N/A",value1:{valueCompareType:Be.default.Equals,value:t}};case"notEqualTo":return{compareType:"N/A",value1:{valueCompareType:Be.default.DoesNotEqual,value:t}};case"beginsWith":return{compareType:n?"Or":"N/A",value1:{valueCompareType:Be.default.BeginsWith,value:t},value2:n?{valueCompareType:Be.default.BeginsWith,value:a}:void 0};case"notBeginsWith":return{compareType:n?"And":"N/A",value1:{valueCompareType:Be.default.DoesNotBeginWith,value:t},value2:n?{valueCompareType:Be.default.DoesNotBeginWith,value:a}:void 0};case"endsWith":return{compareType:n?"Or":"N/A",value1:{valueCompareType:Be.default.EndsWith,value:t},value2:n?{valueCompareType:Be.default.EndsWith,value:a}:void 0};case"notEndsWith":return{compareType:n?"And":"N/A",value1:{valueCompareType:Be.default.DoesNotEndWith,value:t},value2:n?{valueCompareType:Be.default.DoesNotEndWith,value:a}:void 0};case"contains":return{compareType:n?"Or":"N/A",value1:{valueCompareType:Be.default.Contains,value:t},value2:n?{valueCompareType:Be.default.Contains,value:a}:void 0};case"notContains":return{compareType:n?"And":"N/A",value1:{valueCompareType:Be.default.DoesNotContain,value:t},value2:n?{valueCompareType:Be.default.DoesNotContain,value:a}:void 0};case"greaterThan":return{compareType:"N/A",value1:{valueCompareType:Be.default.IsGreaterThan,value:t}};case"greaterThanOrEqual":return{compareType:"N/A",value1:{valueCompareType:Be.default.IsGreaterThenOrEqualTo,value:t}};case"lessThan":return{compareType:"N/A",value1:{valueCompareType:Be.default.IsLessThen,value:t}};case"lessThanOrEqual":return{compareType:"N/A",value1:{valueCompareType:Be.default.IsLessThanOrEqualTo,value:t}};case"between":if(!a)throw new o.tF("Limit2 is undefined!","filterTables");return{compareType:"And",value1:{valueCompareType:Be.default.IsGreaterThenOrEqualTo,value:t},value2:{valueCompareType:Be.default.IsLessThanOrEqualTo,value:a}};case"notBetween":if(!a)throw new o.tF("Limit2 is undefined!","filterTables");return{compareType:"Or",value1:{valueCompareType:Be.default.IsLessThen,value:t},value2:{valueCompareType:Be.default.IsGreaterThan,value:a}};default:throw new Error(`Operator '${e}' not implemented.`)}}function qe(e){switch(e){case"Or":return Excel.FilterOperator.or;case"And":return Excel.FilterOperator.and;case"N/A":return}}var Ve=a(187990);const Ge={allDatesInPeriodJanuary:Ve.default.M1,allDatesInPeriodFebruary:Ve.default.M2,allDatesInPeriodMarch:Ve.default.M3,allDatesInPeriodApril:Ve.default.M4,allDatesInPeriodMay:Ve.default.M5,allDatesInPeriodJune:Ve.default.M6,allDatesInPeriodJuly:Ve.default.M7,allDatesInPeriodAugust:Ve.default.M8,allDatesInPeriodSeptember:Ve.default.M9,allDatesInPeriodOctober:Ve.default.M10,allDatesInPeriodNovember:Ve.default.M11,allDatesInPeriodDecember:Ve.default.M12,allDatesInPeriodQuarter1:Ve.default.Q1,allDatesInPeriodQuarter2:Ve.default.Q2,allDatesInPeriodQuarter3:Ve.default.Q3,allDatesInPeriodQuarter4:Ve.default.Q4,aboveAverage:Ve.default.AboveAverage,belowAverage:Ve.default.BelowAverage,lastMonth:Ve.default.LastMonth,lastQuarter:Ve.default.LastQuarter,lastWeek:Ve.default.LastWeek,lastYear:Ve.default.LastYear,nextMonth:Ve.default.NextMonth,nextQuarter:Ve.default.NextQuarter,nextWeek:Ve.default.NextWeek,nextYear:Ve.default.NextYear,thisMonth:Ve.default.ThisMonth,thisQuarter:Ve.default.ThisQuarter,thisWeek:Ve.default.ThisWeek,thisYear:Ve.default.ThisYear,today:Ve.default.Today,tomorrow:Ve.default.Tomorrow,yesterday:Ve.default.Yesterday,yearToDate:Ve.default.YearToDate,unknown:Ve.default.Nil};var We=a(818977),ze=a(79458);var je=a(593688);async function Qe(e,t,a,n){let r=!1,i=e;const l=await async function(e,t){try{return await Excel.run({delayForCellEdit:!0},(async a=>{const n=a.workbook.tables.getItem(e).columns.getItemAt(t).getDataBodyRange();return n.conditionalFormats.load("items"),await a.sync(),n.conditionalFormats.items.length>0}))}catch(e){throw(0,ze.cY)(ze.SA.Error,e),new o.tF("Failed to read if there is any conditional formatting applied to a range","hasConditionalFormattingApplied")}}(t,a);if(!l){const o=await(0,je.B)(t,a,n);try{i=(0,We.xq)(o,e),r=!0}catch{}}const c=[{key:s.Dh.EventType,value:s.Mv.GetFilterOrSortColor},{key:s.Dh.ColumnCFRApplied,value:l},{key:s.Dh.SortFilterColorFound,value:r}];return(0,D.j)(c),i}async function Je(e,t,a,n,r,i){let l=!1,c=n;const d=await async function(e,t,a){try{return await Excel.run({delayForCellEdit:!0},(async n=>{const o=n.workbook.worksheets.getItem(e).getRange(t).getColumn(a);return o.conditionalFormats.load("items"),await n.sync(),o.conditionalFormats.items.length>0}))}catch(e){throw(0,ze.cY)(ze.SA.Error,e),new o.tF("Failed to read if there is any conditional formatting applied to a range","getHasConditionalFormattingApplied")}}(e,t,a);if(!d){let s=await async function(e,t,a,n){const r="font"===n?"#000000":"#FFFFFF";try{return await Excel.run({delayForCellEdit:!0},(async o=>{const i=o.workbook.worksheets.getItem(e).getRange(t).getColumn(a),l={format:{[n]:{color:!0}}},s=i.getCellProperties(l);return await o.sync(),s.value.map((e=>e[0].format?.[n]?.color??r))}))}catch{throw new o.tF(`Failed to read the ${n} colors from table column.`,"getRangeColors")}}(e,t,a,r);try{s=i?s.slice(1):s,c=(0,We.xq)(s,n),l=!0}catch{}}const u=[{key:s.Dh.EventType,value:s.Mv.GetFilterOrSortColor},{key:s.Dh.ColumnCFRApplied,value:d},{key:s.Dh.SortFilterColorFound,value:l}];return(0,D.j)(u),c}var Ye=a(481484);const Xe=(0,f.k64)()&&(0,f.yw9)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS");function Ze(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","filterTables");const a=t.getVariableArgumentValue(e,"tables");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","clearFilters: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const n=a.values[0],i=n.name,l=n.sheetRange.sheet,s=u.ExcelCalc.IExcelRangeToAddress(n.sheetRange.range),c=JSON.parse(n.headers),d=[];if(n.tableLikeRange){let t=[],a=[];try{t=j.getTableColumnNames(n,e),a=U(n,t,e.name)}catch(e){const t=e;if(!t.isConverterError||t.failureType!==o.tJ.NoColumnArgument)throw e;d.push(function({sheetName:e,rangeAddress:t}){const a={entityName:e,entityType:"worksheets",changedDataDisplayName:t};return{method:r.wv.Worksheet.ClearFilter,args:a,func:De.We}}({sheetName:l,rangeAddress:s}))}return a.map((e=>{const t=Xe?u.ExcelCalc.IExcelRangeToAddress(u.ExcelCalc.columnFromIExcelAddress(n.sheetRange.range,e)):"";d.push(function({sheetName:e,rangeAddress:t,columnAddress:a,columnName:n,columnNumber:o}){const i={entityName:e,entityType:"worksheets",changedDataDisplayName:Xe?a:`column ${n||o+1} of ${t}`,columnIndex:o};return{method:r.wv.Worksheet.ClearColumnFilter,args:i,func:De.hf}}({sheetName:l,rangeAddress:s,columnAddress:t,columnNumber:e,columnName:c[e]}))})),0===d.length&&(0,o.VD)(e,a.length,[]),[{agent:r.w2.OfficeJS,items:d}]}let m=[];try{m=j.getTableColumnNames(n,e)}catch(e){const t=e;if(!t.isConverterError||t.failureType!==o.tJ.NoColumnArgument)throw e;d.push(function(e){return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.AutoFilterCleared,e,{})}(i))}return m.map((e=>d.push(function(e,t){const a={tableName:e,columnName:t};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.FilterCleared,e,a)}(i,e)))),0===d.length&&(0,o.VD)(e,m.length,[]),[{agent:r.w2.OfficeScripts,items:d}]}const Ke={CellColor:async(e,t,a,n)=>{const o=await Qe((0,N.wM)(n,"color"),e,a,"cell");return(0,f.avT)()||(0,f.k64)()?ve(u.EventMethods.Table.CellColorFilterApplied,e,t,o):{method:r.wv.Table.FilterColor,args:{tableName:e,columnName:t,color:o},func:Pe}},FontColor:async(e,t,a,n)=>{const o=await Qe((0,N.wM)(n,"color"),e,a,"font");return(0,f.avT)()||(0,f.k64)()?ve(u.EventMethods.Table.FontColorFilterApplied,e,t,o):{method:r.wv.Table.FilterColor,args:{tableName:e,columnName:t,color:await Qe((0,N.wM)(n,"color"),e,a,"font")},func:Ne}}};const et={Icon:()=>{throw new o.tF("Icon Not Implemented","FilterType")},BottomItems:(e,t,a)=>{const n=(0,N.mT)(a,"count");return Promise.resolve(ye(e,t,!1,Ye.default.Items,String(n)))},BottomPercent:(e,t,a)=>{const n=(0,N.mT)(a,"count");return Promise.resolve(ye(e,t,!1,Ye.default.Percent,String(n)))},TopItems:(e,t,a)=>{const n=(0,N.mT)(a,"count");return Promise.resolve(ye(e,t,!0,Ye.default.Items,String(n)))},TopPercent:(e,t,a)=>{const n=(0,N.mT)(a,"count");return Promise.resolve(ye(e,t,!0,Ye.default.Percent,String(n)))},Values:(e,t,a)=>{const n=(0,N.W7)(a,"values");return Promise.resolve(function(e,t,a){const n={tableName:e,columnName:t,values:a};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.ValuesFilterApplied,e,n)}(e,t,n))},Custom:async(e,t,a)=>{const n=ot(a,"limit1"),r=ot(a,"limit2")??"",i=(0,N.Am)(a,"operator");$e(n,r);const{compareType:l,value1:s,value2:c}=Ue(i,String(n),String(r)),d=await async function(e,t){return Excel.run((async a=>{try{let n=a.workbook.tables.getItem(e).columns.getItem(t).getDataBodyRange().load("rowCount");await a.sync();const o=100;n.rowCount>o&&(n=n.getResizedRange(o-n.rowCount,0)),n.load("values"),await a.sync();const r=n.values;let i=0,l=0,s=0;for(let e=0;e<r.length;++e){const t=r[e][0];i+="number"==typeof t?1:0,l+="string"==typeof t&&t.length>0?1:0,s+="boolean"==typeof t?1:0}const c=i+l+s;if(c<=0)return Promise.resolve("none");const d=.9;let u="none";return i/c>=d?u="number":l/c>=d?u="string":s/c>=d&&(u="bool"),Promise.resolve(u)}catch(e){return Promise.reject(new o.tF("Unable to determine if the column is string/numeric/bool","columnName"))}}))}(e,t);return"none"!==d&&function(e,t){switch(e){case"equalTo":case"notEqualTo":break;case"beginsWith":case"notBeginsWith":case"endsWith":case"notEndsWith":case"contains":case"notContains":if("string"!==t)throw new o.tF(`Applying a textual filter ${e} to a column that's not textual.`,"operandType",o.tJ.TextualFilterOnNonTextError);break;case"greaterThan":case"greaterThanOrEqual":case"lessThan":case"lessThanOrEqual":case"between":case"notBetween":if("number"!==t)throw new o.tF(`Applying a numeric filter ${e} to a column that's not numeric.`,"operandType",o.tJ.NumericFilterOnNonNumberError);break;default:throw new Error(`Operator '${e}' not implemented.`)}}(i,d),Promise.resolve(function(e,t,a,n,o){const r={tableName:e,columnName:t,compareType:a,value1:n,value2:o};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.CustomFilterApplied,e,r)}(e,t,l,s,c))},Dynamic:(e,t,a)=>{const n=function(e){if(void 0!==Ge[e])return Ge[e];throw new Error(`Criteria type '${e}' not supported`)}((0,N.Am)(a,"dynamicCriteria"));return Promise.resolve(function(e,t,a){const n={tableName:e,columnName:t,criteriaType:a};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.DynamicFilterApplied,e,n)}(e,t,n))}};function tt({filterType:e,sheetName:t,rangeAddress:a,columnAddress:n,columnIndex:o,columnName:i,filterCriteria:l}){const s={sheetName:t,rangeAddress:a,columnIndex:o,entityName:t,entityType:"worksheets",filteredDataDisplayName:Xe?n:`column ${i||o+1} of ${a}`,filterCriteria:{filterOn:e,...l}};return{method:r.wv.Worksheet.Filter[e],args:s,func:De.$h}}const at={CellColor:e=>({color:(0,N.wM)(e,"color")}),FontColor:e=>({color:(0,N.wM)(e,"color")}),Icon:()=>{throw new o.tF("Icon Not Implemented","FilterType")},BottomItems:e=>{const t=(0,N.mT)(e,"count");return{criterion1:String(t)}},BottomPercent:e=>{const t=(0,N.mT)(e,"count");return{criterion1:String(t)}},TopItems:e=>{const t=(0,N.mT)(e,"count");return{criterion1:String(t)}},TopPercent:e=>{const t=(0,N.mT)(e,"count");return{criterion1:String(t)}},Custom:e=>{const t=ot(e,"limit1"),a=ot(e,"limit2")??"",n=(0,N.Am)(e,"operator");$e(t,a);const{compareType:o,value1:r,value2:i}=Ue(n,String(t),String(a));return{criterion1:He(r.valueCompareType,r.value),criterion2:i?He(i.valueCompareType,i.value):void 0,operator:qe(o)}},Dynamic:e=>{const t=function(e){let t=Excel.DynamicFilterCriteria[e];if(void 0!==t)return t;if("allDatesInPeriodFebruary"===e){const e="allDatesInPeriodFebruray";t=Excel.DynamicFilterCriteria[e]}return t}((0,N.Am)(e,"dynamicCriteria"));return{dynamicCriteria:t}},Values:e=>({values:(0,N.W7)(e,"values")})},nt={Icon:()=>{throw new o.tF("Icon Not Implemented","FilterType")},BottomItems:()=>{throw new o.tF("BottomItems Not Implemented","FilterType")},BottomPercent:()=>{throw new o.tF("BottomPercent Not Implemented","FilterType")},TopItems:()=>{throw new o.tF("TopItems Not Implemented","FilterType")},TopPercent:()=>{throw new o.tF("TopPercent Not Implemented","FilterType")},Values:()=>{throw new o.tF("Values Not Implemented","FilterType")},Dynamic:()=>{throw new o.tF("Dynamic Not Implemented","FilterType")},CellColor:()=>{throw new o.tF("CellColor Not Implemented","FilterType")},FontColor:()=>{throw new o.tF("FontColor Not Implemented","FilterType")},Custom:async(e,t,a,n)=>{const o=ot(n,"limit1"),r=ot(n,"limit2")??"",i=(0,N.Am)(n,"operator");$e(o,r);const{compareType:l,value1:s,value2:c}=Ue(i,String(o),String(r));return Promise.resolve(function(e,t,a,n,o,r){const i={column:t,compareType:n,value1:o,value2:r,range:a};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Worksheet.CustomFilterApplied,e,i)}(e,t,a,l,s,c))}};function ot(e,t){let a;try{const n=(0,N.Q4)(e,t);if("string"===n)a=(0,N.Ru)(e,t);else if("number"===n){const n=(0,N.lI)(e,t);a=n?.toString()}}catch{}return a}var rt=a(48494),it=a(743352),lt=a(812328);async function st(e){const t=e,a=u.ExcelCalc.IExcelRangeToAddress(t.range.range);return Excel.run({delayForCellEdit:!0},(async e=>{const n=t.range;e.workbook.worksheets.getItem(n.sheet).getRange(a).load("format").format.adjustIndent(t.indentChange),await e.sync()})),`I adjusted in the indent on ${a} by ${t.indentChange} `}async function ct(e){const t=e,a=t.range,n=t.iconStyle,r=u.ExcelCalc.IExcelRangeToAddress(a.range);Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.worksheets.getItem(a.sheet).getRange(r).conditionalFormats.add(Excel.ConditionalFormatType.iconSet),i=function(e){switch(e){case Excel.IconSet.threeArrows:case Excel.IconSet.threeArrowsGray:case Excel.IconSet.threeFlags:case Excel.IconSet.threeTrafficLights1:case Excel.IconSet.threeTrafficLights2:case Excel.IconSet.threeSigns:case Excel.IconSet.threeSymbols:case Excel.IconSet.threeSymbols2:case Excel.IconSet.threeStars:case Excel.IconSet.threeTriangles:return[{formula:"=0",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=33",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=67",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent}];case Excel.IconSet.fourArrowsGray:case Excel.IconSet.fourArrows:case Excel.IconSet.fourTrafficLights:case Excel.IconSet.fourRedToBlack:case Excel.IconSet.fourRating:return[{formula:"=0",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=25",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=50",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=75",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent}];case Excel.IconSet.fiveArrowsGray:case Excel.IconSet.fiveArrows:case Excel.IconSet.fiveQuarters:case Excel.IconSet.fiveRating:case Excel.IconSet.fiveBoxes:return[{formula:"=0",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=20",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=40",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=60",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent},{formula:"=80",operator:"GreaterThan",type:Excel.ConditionalFormatIconRuleType.percent}];default:return[]}}(n);if(0===i.length)throw new o.tF("No icon set match to generate criteria","applyIconSetConditionalFormatting");t.iconSet.style=n,t.iconSet.criteria=i,t.iconSet.reverseIconOrder=!1,t.iconSet.showIconOnly=!1,await e.sync()}));return`I created an icon set conditional formatting rule using ${lt.IJ[n]} on ${r}.`}async function dt(e){const t=e;await Excel.run({delayForCellEdit:!0},(async e=>{e.workbook.worksheets.getItem(t.sheetName).getRange(t.rangeAddress).sort.apply(t.fields,t.caseMatch,t.hasHeaders,t.orientationString,t.method)}));const a=[],n=[];if(t.fields.forEach((e=>((e,a,n)=>{if((0,f.yw9)("OfficeVSO_9173844_AddSortRangeTelemetry")?e.key>=0:e.key){let o=`${t.headers?.[e.key]} column in `;"FontColor"===e.sortOn?o+="font color":"CellColor"===e.sortOn?o+="cell color":e.ascending?o+="ascending":o+="descending",o+=" order",a.push(o),(0,f.yw9)("OfficeVSO_9173844_AddSortRangeTelemetry")&&n.push(e.key)}})(e,a,n))),(0,f.yw9)("OfficeVSO_9173844_AddSortRangeTelemetry")){const e=[{key:s.Dh.EventType,value:s.Mv.LogSortRangeAddress},{key:s.Dh.SortRangeAddress,value:t.rangeAddress},{key:s.Dh.SortColumnIndex,value:n.join(", ")}];(0,D.j)(e)}return 0===a.length?"I sorted the table":`I sorted the table by ${a.join(", ")}`}async function ut(e,t,a,n){if(n&&b(n,E))throw new o.tF("Clear sort is not supported",e.name,o.tJ.ClearSortUnsupported);if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const i=t.getVariableArgumentValue(e,"tables").values[0];let l=u.ExcelCalc.IExcelRangeToAddress(i.sheetRange.range);const s=i.sheetRange.sheet,c=a.length>0?a[a.length-1]:void 0,d=c&&c.items.length>0?c.items[c.items.length-1]:void 0;let m=!1;if(d)if(d.method===r.wv.Range.Sort){const e=d.args;m=e.rangeAddress===l&&e.sheetName===i.sheetRange.sheet}else if((0,f.avT)()&&d.method===u.EventMethods.Table.CustomSorted)m=d.entityId===i.name;else if(d.method===r.wv.Table.Sort){m=d.args.tableName===i.name}const h=(0,N.Ak)(e,"ascending")??(0,it.VL)("isAscending"),g=(0,N.Ak)(e,"caseMatch")??(0,it.VL)("caseMatch"),p=(0,N.Jh)(e,"fontColor"),C=(0,N.Jh)(e,"cellColor"),y=j.getTableColumnNumber(e,i),v={key:y,ascending:h},x=(0,N.Ru)(e,"columnName"),T={columnIndex:y,columnName:x||"",isAscending:h};if(p&&C)throw new o.tF("Cannot sort by both font and cell color for a column!","color");if(p){let e;e=i.tableLikeRange?await Je(s,l,y,p,"font",!0):await Qe(p,i.name,y,"font"),v.color=e,v.sortOn="FontColor",T.sortOnColor={sortOn:rt.SortOn.fontColor,color:e}}else if(C){let e;e=i.tableLikeRange?await Je(s,l,y,C,"fill",!0):await Qe(C,i.name,y,"cell"),v.color=e,v.sortOn="CellColor",T.sortOnColor={sortOn:rt.SortOn.cellColor,color:e}}if(m){if((0,f.avT)()&&!i.tableLikeRange){d.parameters.sharedSortConditions.push(T)}else{const e=d.args;if(g!==e.caseMatch)throw new o.tF("Cannot have different caseMatch settings while sorting by multiple columns!","caseMatch");e.fields.push(v)}return[]}{let t;if(i.tableLikeRange){const e=JSON.parse(i.headers);if(!(0,f.yw9)("OfficeVSO_9136744_HiTLTLRSortOfficeJS")&&(0,f.yw9)("OfficeVSO_9080495_FixTLRWithHiTL")&&(0,f.k64)()){const a=i.sheetRange.range.topLeft.row,n=i.sheetRange.range.bottomRight.row,o={sheet:s,range:{topLeft:{row:e.length>0&&null!==a?a+1:a,column:i.sheetRange.range.topLeft.column},bottomRight:{row:i.totalRow&&null!==n?n-1:n,column:i.sheetRange.range.bottomRight.column}}},l=i.sheetRange.range.topLeft.column?i.sheetRange.range.topLeft.column+y:y,c=e.length>0&&null!==a?a+1:a,d={hasHeader:!1,caseSensitive:g,ascending:h,activeCell:{sheet:s,range:{topLeft:{row:c,column:l},bottomRight:{row:c,column:l}}},rangeType:u.RangeType.ExcelSheetRange,range:o};t={agent:r.w2.OfficeScripts,items:[u.ExcelEventConverter.makeGenericEvent(u.EventMethods.Range.Sorted,s,d)]}}else l=(0,f.tgf)()&&i.totalRow?re(i.sheetRange.range):l,t={agent:r.w2.OfficeJS,items:[{method:r.wv.Range.Sort,args:{sheetName:s,rangeAddress:l,fields:[v],caseMatch:g,hasHeaders:e.length>0,orientationString:Excel.SortOrientation.rows,headers:e},func:dt}]}}else if((0,f.avT)()||(0,f.k64)()){const e={tableName:i.name,isCaseSensitive:g,sharedSortConditions:[T]};t={agent:r.w2.OfficeScripts,items:[u.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.CustomSorted,i.name,e)]}}else t={agent:r.w2.OfficeJS,items:[{method:r.wv.Table.Sort,args:{tableName:i.name,fields:[v],caseMatch:g},func:Me}]};return 0===t.items.length&&(0,o.VD)(e,1,[]),[t]}}function mt(e,t){const a=t.getVariableArgumentValue(e,"tables");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","clearingSort: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const n=a.values[0],i=n.name,l=[];if(n.tableLikeRange)throw new o.tF("Clear sort is not supported for Table like Ranges",e.name,o.tJ.ClearSortUnsupported);return((0,f.avT)()||(0,f.k64)())&&l.push(function(e){return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.Table.SortCleared,e,{})}(i)),0===l.length&&(0,o.VD)(e,1,[]),[{agent:r.w2.OfficeScripts,items:l}]}function ht(e){const t=function(e){const t=function(e){let t;try{const a=(0,N.Q4)(e,"underline");"boolean"===a?t=(0,N.Ak)(e,"underline"):"string"===a&&(t=(0,N.BO)(e,"underline"))}catch{}return t}(e);let a=(0,it.sR)("defaultCustomFormat").IsTextUnderlined,n=(0,it.sR)("defaultCustomFormat").IsTextDoubleUnderlined;switch(t){case!0:case"Single":a=!0,n=!1;break;case"Double":a=!1,n=!0;break;case!1:a=!1,n=!1}const o={isTextUnderlined:a,isTextDoubleUnderlined:n};return o}(e),a=function(e){const t=(0,N.Lb)(e,"borderEdges"),a=(0,N.BO)(e,"borderStyle"),n=a?u.BorderLineStyle[a]:(0,it.sR)("BorderStyle"),o=(0,N.Jh)(e,"borderColor"),r=o?(0,We.yc)(o):(0,it.sR)("defaultCustomFormat").borderColor,i=(0,We.EQ)(r);let l=[u.BorderLineStyle.None,u.BorderLineStyle.None,u.BorderLineStyle.None,u.BorderLineStyle.None],s=[0,0,0,0];for(let e=0;e<t.length;e++){switch(t[e]){case"Top":l[0]=n,s[0]=i;break;case"Bottom":l[1]=n,s[1]=i;break;case"Left":l[2]=n,s[2]=i;break;case"Right":l[3]=n,s[3]=i;break;case"Horizontal":l[0]=n,s[0]=i,l[1]=n,s[1]=i;break;case"Vertical":l[2]=n,s[2]=i,l[3]=n,s[3]=i;break;case"Inside":case"Outside":case"All":s=[i,i,i,i],l=[n,n,n,n]}}const c={Position:(0,it.sR)("defaultCustomFormat").BorderFormat.Position,LineStyle:l,Color:s,ThemeBorderColor:(0,it.sR)("defaultCustomFormat").BorderFormat.ThemeBorderColor,ColorTypeOption:(0,it.sR)("defaultCustomFormat").BorderFormat.ColorTypeOption,Thickness:(0,it.sR)("defaultCustomFormat").BorderFormat.Thickness};return c}(e),n=(0,N.Jh)(e,"fillColor"),o=(0,N.Jh)(e,"fontColor"),r=(0,N.Ak)(e,"bold"),i=(0,N.Ak)(e,"italic"),l=(0,N.Ak)(e,"strikethrough"),s=t.isTextUnderlined,c=t.isTextDoubleUnderlined,d={BackgroundColor:n??null,TextColor:o??(0,it.sR)("defaultCustomFormat").TextColor,IsTextBold:r??(0,it.sR)("defaultCustomFormat").IsTextBold,IsTextItalic:i??(0,it.sR)("defaultCustomFormat").IsTextItalic,IsTextStrikethrough:l??(0,it.sR)("defaultCustomFormat").IsTextStrikethrough,IsTextUnderlined:s,IsTextDoubleUnderlined:c,BorderFormat:a,PreserveBackgroundColor:(0,it.sR)("defaultCustomFormat").PreserveBackgroundColor,PreserveTextColor:(0,it.sR)("defaultCustomFormat").PreserveTextColor};let m=!0;const h=a.LineStyle,g=a.Color;for(let e=0;e<h.length;e++)h[e]===u.BorderLineStyle.None&&0===g[e]||(m=!1);return void 0!==n||void 0!==o||r||i||l||s||c||!m||(d.BackgroundColor=(0,it.sR)("defaultBackgroundColor")),d}function gt(e,t){let a;try{const n=(0,N.Q4)(e,t);"string"===n?a=(0,N.Ru)(e,t):"number"===n&&(a=(0,N.lI)(e,t))}catch{}return a}function pt(e){return"number"==typeof e?[`=${e}`,lt.c$.Number]:b(e,y)?[`=DATEVALUE("${e}")`,lt.c$.Date]:b(e,v)?[`=${e}`,lt.c$.Number]:[`="${e}"`,lt.c$.Text]}function bt(e){const t=(0,N.BO)(e,"icon");if(void 0===t)throw new o.tF("Icon style is undefined!");const a=lt.Yl[t];if(!a)throw new o.tF(`Could not find matching ConditionalFormattingCommand for icon style: ${t}!`);return a}function ft(e){return{unique:e,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}function Ct(e){const t=lt.FN[e];if(!t)throw new o.tF(`Cannot find ConditionalFormattingTimePeriodType for preset criterion: ${e}`);return{timePeriodType:t,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}function yt(e){const t=lt.t0[e];if(!t)throw new o.tF(`Cannot find ConditionalFormattingCommand for preset criterion: ${e}`);return{criterion:t,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}async function vt(e,t){return function(e,t,a){let n;if(t){const t=e.map((e=>Te(e)));n={agent:r.w2.OfficeScripts,items:t},0===t.length&&(0,o.VD)(a,e.length,[])}else n={agent:r.w2.UnsupportedEvent,items:[r.DH.Formatting]};return[n]}(ne(e,t),(0,N.Ak)(e,"clearConditionalFormat")??!1,e)}async function xt(e,t,a){let n=(0,N.BO)(e,"conditionalFormatType");!n&&(0,N.BO)(e,"formulaString")&&(n="Formula");const i=(0,N.Ak)(e,"clearConditionalFormat")??!1,l=[];let c=[],d=[];!function(e,t){return!Tt[e]&&!St[e]&&!t}(n,i)?i?c=t.map((e=>Te(e))):(Object.keys(Tt).includes(n)&&(c=Z(await Promise.all(t.map((async t=>{const o=Tt[n](t,e,a),r=await async function(e){const t=await async function(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const n=u.ExcelCalc.IExcelRangeToAddress(u.ExcelCalc.getIGeneralRangeOperationRange(e).range),o=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet,r=a.workbook.worksheets.getItem(o).getRange(n).load("conditionalFormats");await a.sync();const i=r.conditionalFormats;return t?i.items.filter((e=>e.type===t)).map((e=>e.priority)):i.items.map((e=>e.priority))}))}(e);let a=0;t&&0!==t.length&&(a=t[t.length-1]+1);return function(e,t){const a=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet,n={oldIndex:t,newIndex:0,isCurrentFilterWorksheet:!1,filterRange:[e]};return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.PriorityEdited,a,n)}(e,a)}(t);return[o,r]}))))),!(0,f.avT)()&&(0,f.k64)()||!Object.keys(St).includes(n)||(d=Z(t.map((t=>St[n](t,e,a)))))):(l.push(n),function(e){const t=[{key:s.Dh.EventType,value:s.Mv.LogUnsupportConditionalFormatType},{key:s.Dh.UnsupportedConditionalFormatType,value:e}];(0,D.j)(t)}(n));const m=[];if(c.length>0){const e={agent:r.w2.OfficeScripts,items:c};m.push(e)}if(d.length>0){const e={agent:r.w2.OfficeJS,items:d};m.push(e)}!function(e,t,a,n,r){const i=e.every((e=>0===e.items.length));i&&(0,o.VD)(t,a.length,n?[]:r)}(m,e,t,!1,l);const h=[{key:s.Dh.EventType,value:s.Mv.ConditionalFormatEvent},{key:s.Dh.CFRuleType,value:n}];return(0,D.j)(h),m}const Tt={CellValue:(e,t,a)=>{const n=function(e){const t=gt(e,"cellValue1"),a=gt(e,"cellValue2"),n=void 0===t?gt(e,"limit1"):t,r=void 0===a?gt(e,"limit2"):a,i=(0,N.BO)(e,"cellValueOperator");if(void 0===n)throw new o.tF("Limit 1 is undefined!");if(void 0===i)throw new o.tF("Cell value operator is undefined!");const l=lt.RR[i];if(!l)throw new o.tF(`Cannot find matching ConditionalFormatCommand for operator: ${i}!`);if(b(String(n),C))throw new o.tF("Invalid characters for cell value conditional formatting in limit1","limit1");if(void 0!==r&&b(String(r),C))throw new o.tF("Invalid characters for cell value conditional formatting in limit2","limit2");const s=pt(n),c=s[0],d=void 0!==r?pt(r):void 0;return{cellValueRule:{formula1:c,formula2:d?d[0]:void 0,operator:l,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")},formulaCategory:s[1]}}(t).cellValueRule,r=ht(t);return xe(u.EventMethods.ConditionalFormatting.CellValueCreated,e,n,a,r)},ContainsText:(e,t,a)=>{const n=function(e){const t=(0,N.BO)(e,"textOperator"),a=(0,N.Ru)(e,"text");if(void 0===t)throw new o.tF("composeTextComparisonRule: operator is undefined!");if(void 0===a)throw new o.tF("composeTextComparisonRule: text is undefined!");const n=lt.$J[t];if(!n)throw new o.tF(`Cannot find matching ConditionalFormatCommand for text operator: ${t}!`);if(b(a,C))throw new o.tF("Invalid characters for text comparison conditional formatting!",e.name);return{operator:n,text:a,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}(t),r=ht(t);return xe(u.EventMethods.ConditionalFormatting.TextComparisonCreated,e,n,a,r)},Preset:(e,t,a)=>{const n=function(e){const t=(0,N.BO)(e,"presetCriterion");if(!t)throw new o.tF("No presetCriterion on statement!");let a,n={};switch(t){case"uniqueValues":n={method:u.EventMethods.ConditionalFormatting.UniqueCreated,rule:ft(!0)},a=lt.fP.UniqueDuplicate;break;case"duplicateValues":n={method:u.EventMethods.ConditionalFormatting.UniqueCreated,rule:ft(!1)},a=lt.fP.UniqueDuplicate;break;case"lastMonth":case"lastSevenDays":case"lastWeek":case"nextMonth":case"nextWeek":case"thisMonth":case"thisWeek":case"today":case"tomorrow":n={method:u.EventMethods.ConditionalFormatting.DatesCreated,rule:Ct(t)},a=lt.fP.TimePeriod;break;case"aboveAverage":case"belowAverage":case"equalOrAboveAverage":case"equalOrBelowAverage":n={method:u.EventMethods.ConditionalFormatting.PresetCreated,rule:yt(t)},a=lt.fP.OtherPresetsNumber;break;case"blanks":case"nonBlanks":case"errors":case"nonErrors":case"invalid":n={method:u.EventMethods.ConditionalFormatting.PresetCreated,rule:yt(t)},a=lt.fP.OtherPresetsGeneral;break;default:throw new o.tF(`Cannot find matching rule composer for criteria: ${t}!`)}return[n,a]}(t),r=ht(t),i=n[0];return xe(i.method,e,i.rule,a,r)},TopBottom:(e,t,a)=>{const n=function(e){const t=(0,N.BO)(e,"topBottomType")??(0,it.sR)("topBottomType"),a=(0,N.lI)(e,"topBottomRank")??(0,it.sR)("topBottomRank"),n=lt.ZA[t];if(!n)throw new o.tF(`Cannot find matching ConditionalFormatCommand for top/bottom type: ${t}!`);return{rank:a,type:n,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}(t),r=ht(t);return xe(u.EventMethods.ConditionalFormatting.TopBottomCreated,e,n,a,r)},ColorScale:(e,t,a)=>{const n=function(e){const t=(0,N.Jh)(e,"minimumColor"),a=(0,N.Jh)(e,"midpointColor"),n=(0,N.Jh)(e,"maximumColor");if((0,f.yw9)("DefaultColorScales"))return{minimumColor:t?(0,it.L7)(t):(0,it.sR)("minimumColor"),midpointColor:a?(0,it.L7)(a):(0,it.sR)("midpointColor"),maximumColor:n?(0,it.L7)(n):(0,it.sR)("maximumColor"),maximumCFObjectValues:(0,it.sR)("maximumCFObjectValues"),midpointCFObjectValues:a?(0,it.sR)("midpointCFObjectValues"):null,minimumCFObjectValues:(0,it.sR)("minimumCFObjectValues")};return{minimumColor:t??(0,it.sR)("minimumColorDeprecated"),midpointColor:a??(0,it.sR)("midpointColor"),maximumColor:n??(0,it.sR)("maximumColorDeprecated"),maximumCFObjectValues:(0,it.sR)("maximumCFObjectValues"),midpointCFObjectValues:a?(0,it.sR)("midpointCFObjectValuesDeprecated"):null,minimumCFObjectValues:(0,it.sR)("minimumCFObjectValues")}}(t);return function(e,t,a){const n={range:e.range,columnName:a,rangeType:e.rangeType,colorScaleFormat:t},o=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.ColorScaleCustomCreated,o,n)}(e,n,a)},DataBar:(e,t,a)=>{const n=function(e){const t=(0,N.Jh)(e,"dataBarColor");return{isGradientFill:(0,N.Ak)(e,"dataBarGradient")??(0,it.sR)("isGradientFill"),borderColor:(0,it.sR)("borderColor"),fillColor:t??(0,it.sR)("fillColor"),isLTRDirection:(0,it.sR)("isLTRDirection"),isNegativeValuesFillColorCustom:(0,it.sR)("isNegativeValuesFillColorCustom"),negativeValuesFillColor:t??(0,it.sR)("negativeValuesFillColor"),isNegativeValuesBorderColorCustom:(0,it.sR)("isNegativeValuesBorderColorCustom"),negativeValuesBorderColor:(0,it.sR)("negativeValuesBorderColor"),isShowValueEnabled:(0,it.sR)("isShowValueEnabled"),axisColor:(0,it.sR)("axisColor"),axisPositionType:(0,it.sR)("axisPositionType"),minBoundCFObjectValues:(0,it.sR)("minBoundCFObjectValues"),maxBoundCFObjectValues:(0,it.sR)("maxBoundCFObjectValues")}}(t);return function(e,t,a){const n={range:e.range,columnName:a,rangeType:e.rangeType,dataBarFormat:t},o=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.DataBarCustomCreated,o,n)}(e,n,a)},IconSet:(e,t,a)=>{const n=function(e){const t=(0,N.BO)(e,"icon");if(void 0===t)throw new o.tF("Icon style is undefined!");const a=lt.nr[t];if(!a)throw new o.tF(`Could not find matching ConditionalFormattingCommand for icon style: ${t}!`);return a}(t);return function(e,t){const a={range:e.range,rangeType:e.rangeType,style:t},n=u.ExcelCalc.getIGeneralRangeOperationRange(e).sheet;return ie.ExcelEventConverter.makeGenericEvent(u.EventMethods.ConditionalFormatting.IconSetCreated,n,a)}(e,n)},Formula:(e,t,a)=>{const n=function(e){const t=(0,N.BO)(e,"formulaString"),a=(0,N.BO)(e,"formulaExplanation");if(!t||""===t)throw new o.tF("Cannot compose custom rule with undefined or empty formula",e.name,o.tJ.ConditionalFormatFormulaInvalid);if((0,f._NB)()&&(!a||""===a))throw new o.tF("Cannot compose custom rule with formula explanation",e.name,o.tJ.ConditionalFormatFormulaExplanationInvalid);return{formula:t,localFormula:!0,formulaExplanation:a,shouldGenerateGetRule:(0,it.sR)("shouldGenerateGetRule")}}(t),r=ht(t);return xe(u.EventMethods.ConditionalFormatting.CustomCreated,e,n,a,r)}},St={IconSet:(e,t,a)=>({method:r.wv.ConditionalFormatting.ApplyIconSetConditionalFormatting,args:{range:u.ExcelCalc.getIGeneralRangeOperationRange(e),iconStyle:bt(t)},func:ct})};async function wt(e,t,a){if(void 0===e.arguments.tables)throw new o.tF("No table specified.","tables");const n={func:"conditionalFormatSuggestion",args:[t.getVariableArgumentValue(e,"tables").values[0].name,a]};return[{agent:r.w2.ConditionalFormatSuggestion,items:[n]}]}var Et=a(747207),It=a(399589);function Rt(e,t){return e.map((e=>e.map((e=>""===e?t:e))))}function At(e,t){const a=e.range.topLeft,n=e.range.bottomRight;if(null===a.column||null===n.column)return null;if((t=t>=0?t:n.column-a.column+t+1)<0||a.column+t>n.column)return null;return{rangeType:u.RangeType.ExcelSheetRange,range:{sheet:e.sheet,range:{topLeft:{row:a.row,column:a.column+t},bottomRight:{row:n.row,column:a.column+t}}}}}async function Lt(e){return Excel.run({delayForCellEdit:!0},(async t=>{const a=u.ExcelCalc.IExcelRangeToAddress(e.range),n=t.workbook.worksheets.getItem(e.sheet).getRange(a);return n.load("values"),await t.sync(),n.values}))}function kt(e,t){const a=e.range.topLeft,n=e.range.bottomRight;if(null===a.row||null===n.row)return null;if((t=t>=0?t:n.row-a.row+t+1)<0||a.row+t>n.row)return null;return{rangeType:u.RangeType.ExcelSheetRange,range:{sheet:e.sheet,range:{topLeft:{row:a.row+t,column:a.column},bottomRight:{row:a.row+t,column:n.column}}}}}async function Ft(e,t){const a=function(e){try{const t=(0,N.Q4)(e,"searchString");if("string"===t)return(0,N.C3)(e,"searchString");if("number"===t){return(0,N.mT)(e,"searchString").toString()}throw new o.Dd(`Argument "searchString" type ${t} should be string or number on ${e.name}`,o.vb.ArgumentTypeMismatch,t,"string | number")}catch(e){if(e.isStatementArgumentError&&e.reason===o.vb.ArgumentUndefined)return;throw e}}(e)??"",n=function(e){const t=(0,N.dQ)(e,"replaceWith");if(void 0===t)return"";if("string"===t)return(0,N.C3)(e,"replaceWith");if("number"===t){return(0,N.mT)(e,"replaceWith").toString()}throw new o.Dd(`Argument "replaceWith" type ${t} should be string or number on ${e.name}`,o.vb.ArgumentTypeMismatch,t,"string | number")}(e),i=(0,N.Ak)(e,"completeMatch")??!1,l=(0,N.Ak)(e,"matchCase")??!1,s={agent:r.w2.OfficeScripts,items:[]};for(const e of t)try{if((0,f.yw9)("OfficeVSO_9033826_SearchReplaceEmptyCellStrings")||(0,f.avT)()||""!==a)s.items.push(fe(a,n,i,l,e));else{const t=Rt(await Lt(u.ExcelCalc.getIGeneralRangeOperationRange(e)),n);s.items.push(se(t,u.ExcelCalc.getIGeneralRangeOperationRange(e)))}}catch{(0,D.R)(new o.tF("Failed to compose replace all event for range.","replaceRangesCommon"))}return 0===s.items.length&&(0,o.VD)(e,t.length,[]),[s]}function _t(e,t){let a=0;const n=e[t];for(let o=0;o<t;o++)e[o]===n&&a++;return a}var Pt=a(755005);async function Nt(e){const t=e,a=u.ExcelCalc.IExcelRangeToAddress(t.range.range);return Excel.run({delayForCellEdit:!0},(async e=>{const n=t.range;e.workbook.worksheets.getItem(n.sheet).getRange(a).load("format/useStandardHeight").format.useStandardHeight=!0,await e.sync()})),`I removed the autofit on rows(s) in ${a}.`}async function Mt(e){const t=e,a=u.ExcelCalc.IExcelRangeToAddress(t.range.range);return Excel.run({delayForCellEdit:!0},(async e=>{const n=t.range;e.workbook.worksheets.getItem(n.sheet).getRange(a).load("format/useStandardWidth").format.useStandardWidth=!0,await e.sync()})),`I removed the autofit on column(s) in ${a}.`}async function Ot(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{const n=a.workbook.worksheets.getItem(t.sheet).getRange(u.ExcelCalc.IExcelRangeToAddress(t.range)).getCell(0,0).load("format/font");await a.sync();const r=n.format.font.size,i=function(e,t){const a=(0,N.Q4)(e,t);if("string"===a)return(0,N.Am)(e,t);if("number"===a)return(0,N.mT)(e,t);throw new o.Dd(`Argument ${t} type ${a} should be enum or number on ${e.name}`,o.vb.ArgumentTypeMismatch,a,"enum | number")}(e,"size");return function(e,t){return"Increase"===t?e+(0,it.Si)("fontSizeChange"):"Decrease"===t?e-(0,it.Si)("fontSizeChange"):t}(r,i)}))}const Dt={true:"single",false:"none",None:"none",Single:"single",Double:"double",SingleAccountant:"singleAccountant",DoubleAccountant:"doubleAccountant"};var Bt=a(319329),$t=a(774581),Ht=a(528403),Ut=a(54947);async function qt(e,t,a){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const n=t.getVariableArgumentValue(e,"tables");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","formatTables: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const i=n.values[0];let l;l=K(i.sheetRange);const s=i.tableLikeRange?Pt.lp.TableLikeRange:Pt.lp.StandardTable;if(((0,f.avT)()||(0,f.yw9)("OfficeVSO_9404079_FixFormattingIntentStringTableWithTotalRow"))&&(0,h.En)(i)&&(l={rangeType:Et.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Body,tableName:i.name,gridRange:l.range}}),!i?.headers)throw new o.tF("Invalid table data");const c=JSON.parse(i.headers);if(!Array.isArray(c)||0===c.length)throw new o.tF("Invalid table headers");const{topLeft:d,bottomRight:m}=u.ExcelCalc.getIGeneralRangeOperationRange(l).range,{column:g,row:p}=d,{column:b,row:C}=m,y=i.numColumns,v=i.numRows;let x="";if(null===g||null===b||null===p||null===C)throw null!==g&&(x+=c[g]),new o.tF("Range having incomplete row and/or column data.");if(y===b-g+1&&v===C-p+1)x=(0,f.yw9)("OfficeVSO_9125590_bugFixTLRWholeTableLabel")&&(0,f.k64)()&&i.tableLikeRange?"":Ut.G.O;else{const e=[];for(let t=g;t<=b;t++)e.push(`'${c[t]}'`);x+=e.join(", ")}const T=await Qt(e,[l],!1,x);return T.push(...function(e,t,a,n){const o=[];if((0,f.avT)()||(0,f.k64)()){if(a===Pt.lp.TableLikeRange&&void 0!==(0,N.Ak)(e,"totalRow")){const t={agent:r.w2.UnsupportedEvent,items:[r.DH.Formatting]};o.push(t),delete e.arguments.totalRow}const i=Object.keys(jt).filter((t=>void 0!==e.arguments[t])).map((a=>jt[a](t,e,n))),l={agent:r.w2.OfficeScripts,items:Z(i)};l.items.length>0&&o.push(l)}else{const a=Object.keys(zt).filter((t=>void 0!==e.arguments[t])).map((a=>(0,zt[a])(t,e,a,n))),i={agent:r.w2.OfficeJS,items:a};i.items.length>0&&o.push(i)}return o}(e,i.name,s,a)),Jt(T,e,[l]),T}async function Vt(e,t){const a=function(e,t){if(void 0===e.arguments.columns)throw new o.tF("No columns specified.",e.name);const a=t.getVariableArgumentValue(e,"columns");if("Column"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","getFullResolvedColumnRanges: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);return{columnRanges:a.values.ranges,fullColumnRanges:a.values.fullRanges}}(e,t),n=a.columnRanges,r=a.fullColumnRanges,i=function(e,t){try{return oe(e,t)}catch{return}}(e,t),l=await Qt(e,n,!0,i,r);return Jt(l,e,n),l}const Gt={autofit:(e,t,a)=>{void 0!==t&&(t="autofit_defaultValue");return(0,N.zI)(a,"autofit")?function(e,t){switch(t.name){case"formatColumns":return[pe(u.EventMethods.Range.ColumnsAutoFit,e)];case"formatRows":return[pe(u.EventMethods.Range.RowsAutoFit,e)];default:{const t=[];return t.push(pe(u.EventMethods.Range.ColumnsAutoFit,e)),t.push(pe(u.EventMethods.Range.RowsAutoFit,e)),t}}}(e,a):(0,f.avT)()||(0,f.k64)()?function(e,t){switch(t.name){case"formatColumns":return[be(u.EventMethods.Range.UseStandardWidth,e)];case"formatRows":return[be(u.EventMethods.Range.UseStandardHeight,e)];default:{const t=[];return t.push(be(u.EventMethods.Range.UseStandardWidth,e)),t.push(be(u.EventMethods.Range.UseStandardHeight,e)),t}}}(e,a):[]},bold:(e,t,a)=>{const n=(0,N.zI)(a,"bold");return de(u.EventMethods.Font.Bolded,n,e,t)},borderEdges:(e,t,a)=>{const n=(0,N.Lb)(a,"borderEdges"),o=[];if(0!==n.length){const r=function(e,t,a){const n=[],o=t||(0,it.Si)("borderColor"),r=(0,We.EQ)((0,We.yc)(o));let i=u.BorderLineStyle[a];void 0===i&&(i=(0,it.Si)("borderStyle"));for(const t of e){const e={border:u.BorderTypes[t],color:r,lineStyle:i};n.push(e)}return n}(n,(0,N.Jh)(a,"borderColor"),(0,N.BO)(a,"borderStyle"));r.map((a=>o.push(de(u.EventMethods.Border.BorderChanged,a,e,t))))}return o},cellStyle:(e,t,a)=>{const n=(0,N.Am)(a,"cellStyle");return de(u.EventMethods.Range.CellStyleApplied,n,e,t)},columnWidth:async(e,t,a)=>{const n=await(0,Bt.CE)(a,u.ExcelCalc.getIGeneralRangeOperationRange(e));return de(u.EventMethods.CellDimensions.ColumnWidthSet,n,e,t)},orientation:(e,t,a)=>{const n=(0,N.mT)(a,"orientation");return de(u.EventMethods.CellText.OrientationChanged,n,e,t)},fillColor:(e,t,a)=>{const n=(0,N.wM)(a,"fillColor");return de("None"===n?u.EventMethods.Fill.ColorCleared:u.EventMethods.Fill.Colored,n,e,t)},fontColor:(e,t,a)=>{const n=(0,N.wM)(a,"fontColor");return de(u.EventMethods.Font.Colored,"None"===n?(0,it.Si)("fontColor"):n,e,t)},fontName:(e,t,a)=>{const n=(0,N.Am)(a,"fontName");return de(u.EventMethods.Font.Named,n,e,t)},size:async(e,t,a)=>{const n=await Ot(a,u.ExcelCalc.getIGeneralRangeOperationRange(e));return de(u.EventMethods.Font.Sized,n,e,t)},hide:(e,t,a)=>{const n=(0,N.zI)(a,"hide");if("formatColumns"===a.name)return de(u.EventMethods.CellDimensions.ColumnsHidden,n,e,t);if("formatRows"===a.name)return de(u.EventMethods.CellDimensions.RowsHidden,n,e,t);{const a=[];return a.push(de(u.EventMethods.CellDimensions.ColumnsHidden,n,e,t)),a.push(de(u.EventMethods.CellDimensions.RowsHidden,n,e,t)),a}},horizontalAlignment:(e,t,a)=>{const n=(0,N.Am)(a,"horizontalAlignment");return de(u.EventMethods.Alignment.HorizontalAlignmentSet,$t.default[n],e,t)},indentChange:(e,t,a)=>{const n=(0,N.mT)(a,"indentChange");return de(u.EventMethods.Indent.Incremented,n,e,t)},italic:(e,t,a)=>{const n=(0,N.zI)(a,"italic");return de(u.EventMethods.Font.Italicized,n,e,t)},numberFormat:(e,t,a)=>{const n=(0,N.C3)(a,"numberFormat"),o=(0,N.lI)(a,"decimalPlaces");return[de(u.EventMethods.Range.NumberFormatChanged,(0,f.yw9)("OfficeVSO_9374683_RemoveDecimalPlacesHandling")?n:(0,It.j)(n,o),e,t),pe(u.EventMethods.Range.ColumnsAutoFit,e)]},rowHeight:async(e,t,a)=>{const n=await(0,Bt.fL)(a,u.ExcelCalc.getIGeneralRangeOperationRange(e));return de(u.EventMethods.CellDimensions.RowHeightSet,n,e,t)},strikethrough:(e,t,a)=>{const n=(0,N.zI)(a,"strikethrough");return de(u.EventMethods.Font.StrikeThrough,n,e,t)},underline:(e,t,a)=>{const n=function(e){const t=(0,N.Q4)(e,"underline");if("string"===t)return(0,N.Am)(e,"underline");if("boolean"===t)return(0,N.zI)(e,"underline");throw new o.Dd(`Argument "underline" type ${t} should be enum or number on ${e.name}`,o.vb.ArgumentTypeMismatch,t,"enum | boolean")}(a);return de(u.EventMethods.Font.UnderlineStyle,Dt[n],e,t)},verticalAlignment:(e,t,a)=>{const n=(0,N.Am)(a,"verticalAlignment");return de(u.EventMethods.Alignment.VerticalAlignmentSet,Ht.default[n],e,t)},wrapText:(e,t,a)=>{const n=(0,N.zI)(a,"wrapText");return de(u.EventMethods.CellText.WrapChanged,n,e,t)}},Wt={autofit:(e,t,a)=>(0,N.zI)(e,t)?[]:function(e,t){const a={method:r.wv.Format.RemoveAutofitColumns,args:{range:e},func:Mt},n={method:r.wv.Format.RemoveAutofitRows,args:{range:e},func:Nt};switch(t.name){case"formatColumns":return[a];case"formatRows":return[n];default:return[a,n]}}(a,e),indentChange:(e,t,a)=>({method:r.wv.Format.IndentChange,args:{range:a,indentChange:(0,N.mT)(e,t)},func:st})},zt={totalRow:(e,t,a,n)=>({method:r.wv.Table.TotalRow,args:{tableName:e,value:(0,N.zI)(t,a)},func:Le}),headerRow:(e,t,a,n)=>({method:r.wv.Table.HeaderRow,args:{tableName:e,value:(0,N.zI)(t,a)},func:Ae}),bandedRows:(e,t,a,n)=>{if(!(0,f.yw9)("OfficeVSO_9279636_RemoveBandedRowRegex")&&n&&b(n,x))throw new o.tF("Detected unsupported banded rows query!",t.name);return{method:r.wv.Table.BandedRows,args:{tableName:e,value:(0,N.zI)(t,a)},func:ke}},bandedColumns:(e,t,a,n)=>({method:r.wv.Table.BandedColumns,args:{tableName:e,value:(0,N.zI)(t,a)},func:Fe}),filterButton:(e,t,a,n)=>({method:r.wv.Table.FilterButton,args:{tableName:e,value:(0,N.zI)(t,a)},func:_e}),tableStyle:(e,t,a,n)=>({method:r.wv.Table.ApplyStyle,args:{tableName:e,tableStyle:(0,N.C3)(t,a)},func:Oe})},jt={totalRow:(e,t,a)=>{const n=(0,N.zI)(t,"totalRow");return ue(u.EventMethods.Table.TotalRowToggled,n,e)},headerRow:(e,t,a)=>{const n=(0,N.zI)(t,"headerRow");return ue(u.EventMethods.Table.HeaderRowToggled,n,e)},bandedRows:(e,t,a)=>{if(a&&b(a,x))throw new o.tF("Detected unsupported banded rows query!",t.name);const n=(0,N.zI)(t,"bandedRows");return ue(u.EventMethods.Table.BandedRowsVisibilityChanged,n,e)},bandedColumns:(e,t,a)=>{const n=(0,N.zI)(t,"bandedColumns");return ue(u.EventMethods.Table.BandedColumnsVisibilityChanged,n,e)},filterButton:(e,t,a)=>{const n=(0,N.zI)(t,"filterButton");return ue(u.EventMethods.Table.FilterButtonVisibilityChanged,n,e)},tableStyle:(e,t,a)=>{let n=(0,N.C3)(t,"tableStyle");return"None"===n&&(n=null),ue(u.EventMethods.Table.StyleApplied,n,e)}};async function Qt(e,t,a,n,o){const i=[];void 0===n&&(n="");const l=await async function(e,t,a,n,o){const i=await Promise.all(e.map((async(e,r)=>{const i=Object.keys(Gt).filter((e=>!(!(0,f.avT)()&&!(0,f.k64)()&&"indentChange"===e)&&void 0!==a.arguments[e]));return function(e){const t=[{key:s.Dh.EventType,value:s.Mv.LogStatmentInformation},{key:s.Dh.FormattingTypes,value:e.toString()}];(0,D.j)(t)}(i),await Promise.all(i.map((i=>{let l=e;n&&"autofit"===i&&o&&(l=o[r]);const s=!(0,f.yw9)("OfficeVSO_9277386_FixEmptyColumnName")||""!==t,c=(0,f.k64)()&&s?function(e,t){let a=e.split(",")[t].trim();"'"===a[0]&&(a=a.slice(1));"'"===a[a.length-1]&&(a=a.slice(0,a.length-1));return a}(t,r):t;return Gt[i](l,c,a)})))}))),l={agent:r.w2.OfficeScripts,items:Z(i)};return l}(t,n,e,a,o);if(l.items.length>0&&i.push(l),!(0,f.avT)()&&!(0,f.k64)()){const a=await async function(e,t){const a=await Promise.all(e.map((async e=>Z(Object.keys(Wt).filter((e=>void 0!==t.arguments[e])).map((a=>(0,Wt[a])(t,a,e))))))),n={agent:r.w2.OfficeJS,items:Z(a)};return n}(t.map((e=>u.ExcelCalc.getIGeneralRangeOperationRange(e))),e);a.items.length>0&&i.push(a)}return i}function Jt(e,t,a){e.every((e=>0===e.items.length))&&(0,o.VD)(t,a.length,[],a.length>0)}async function Yt(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const a=t.getVariableArgumentValue(e,"tables").values[0],n=(0,N.Ru)(e,"instruction"),i=[a.name];void 0!==n&&i.push(n);const l={func:e.name,args:i};return[{agent:r.w2.FormulaGeneration,items:[l]}]}var Xt=a(804672);class Zt{async convert(e,t){const a=(new Date).getTime(),n=(0,f.yw9)("OfficeVSO_9408716_BlockInsertDeleteScenarios");let o=!1,r=!1,i=!1,l=!1,s=!1,c=!1;for(let t=0;t<e.length;t++){const a=e[t];o=o||this.variableCache.isDeleteColumnsStatement(a),r=r||this.variableCache.isInsertColumnsStatement(a),n&&(i=i||this.variableCache.isDeleteRowsStatement(a),l=l||this.variableCache.isInsertRowsStatement(a),s=s||this.variableCache.isSelectColumnsStatement(a)&&(o||r),c=c||this.variableCache.isSelectRowsStatement(a)&&(i||l))}n?(o&&r||i&&l||s||c)&&this.logUnsupportedTableStructureChangesStatementsAndThrow(e):o&&r&&this.logUnsupportedStatementsAndThrow(e),e=this.checkSelectRowsShouldBeSelectTables(e),this.insertOfSelectTablesIfNeeded(e);for(let a=0;a<e.length;a++){const n=e[a];this.variableCache.isSelectStatement(n)?await this.processSelectStatement(n,e,t):await this.handleNonSelectStatement(n,e,t)}return this.logConverterSucceeded(e,a),this.executableItems}insertOfSelectTablesIfNeeded(e){for(let t=0;t<e.length;t++)if(this.variableCache.isRowColumnSelectStatementWithSelectionScope(e[t])){const a=h.CP.getActiveTable().name;e.splice(t,0,{name:"selectTables",returns:"tables",arguments:{tableNames:{type:"stringList",stringList:[a]}}}),t++}}async processSelectStatement(e,t,a){const n=(new Date).getTime();try{await this.variableCache.cacheVariable(e,a)}catch(a){this.logVariableCacheFailureAndRethrow(a,t,e,n)}}async handleNonSelectStatement(e,t,a){let n=!1;if(!this.variableCache.isSelectStatement(e)){const o=(new Date).getTime(),r=this.eventConverterMap[e.name];if(r){n=!0;try{this.executableItems=this.executableItems.concat(await r(e,a))}catch(a){this.logConverterFailureAndRethrow(a,t,e,o)}}}n||this.logUnsupportedStatement(e)}checkFreezePanes(e,t){if(e.dismissedArguments?.freezePane||t&&(0,Xt.WS)(t,(0,i.u1Q)())){const t={agent:r.w2.UnsupportedEvent,items:[r.DH.FreezePanes]};return this.logUnsupportedStatement(e),[t]}}checkSelectRowsShouldBeSelectTables(e){if(!e.some((e=>"conditional_format_rows"===e.name||"conditionalFormatRows"===e.name)))return e;let t=!1;for(let a=0;a<e.length;a++)switch(e[a].name){case"select_rows":case"selectRows":if(0===e[a].arguments?.rowNumbers?.numberList?.length){t=!0;const n=e.slice(0,a),o=e.slice(a+1);e=n.concat(o),a--}break;case"conditional_format_rows":case"conditionalFormatRows":t&&(e[a].name="conditionalFormatTables",e[a].arguments.rows&&delete e[a].arguments.rows,e[a].arguments.tables={type:"var",name:"tables"})}return e}logConverterSucceeded(e,t){const a=(0,s.b6)();a[s.Dh.EventState]=s.DD.ConvertSucceeded,a[s.Dh.StatementNames]=JSON.stringify(e.map((e=>e.name))),a[s.Dh.TimeDurationInMs]=(0,s.xJ)(t),this.telemetryLogger.logEvent((0,s.gY)(a))}logUnsupportedStatement(e){const t=(0,s.b6)();t[s.Dh.EventState]=s.DD.UnsupportedStatement,t[s.Dh.CurrentStatement]=e.name,this.telemetryLogger.logEvent((0,s.gY)(t))}logUnsupportedStatementsAndThrow(e){const t=(0,s.b6)();throw t[s.Dh.EventState]=s.DD.UnsupportedStatement,t[s.Dh.StatementNames]=JSON.stringify(e.map((e=>e.name))),this.telemetryLogger.logEvent((0,s.gY)(t)),new o.tF("Delete + Insert columns (could be move columns) is a blocked scenario","DeleteColumns and InsertColumns",o.tJ.DeleteWithInsertColumns)}logUnsupportedTableStructureChangesStatementsAndThrow(e){const t=(0,s.b6)();throw t[s.Dh.EventState]=s.DD.UnsupportedStatement,t[s.Dh.StatementNames]=JSON.stringify(e.map((e=>e.name))),this.telemetryLogger.logEvent((0,s.gY)(t)),new o.tF("Multiple steps with potential table structure changes","Inserts and Deletes",o.tJ.MultipleTableStructureChanges)}logVariableCacheFailureAndRethrow(e,t,a,n){e.isStatementArgumentError&&this.logStatementArgumentError(e),e.isConverterError&&(0,D.R)(e);const o=(0,s.b6)();throw o[s.Dh.EventState]=s.DD.VariableCacheFailed,o[s.Dh.CurrentStatement]=a.name,o[s.Dh.StatementNames]=JSON.stringify(t.map((e=>e.name))),o[s.Dh.TimeDurationInMs]=(0,s.xJ)(n),this.telemetryLogger.logEvent((0,s.gY)(o)),e}logConverterFailureAndRethrow(e,t,a,n){if(e.isNoEventGeneratedError)return void this.logNoEventGeneratedError(e);e.isStatementArgumentError&&this.logStatementArgumentError(e),e.isConverterError&&(0,D.R)(e);const o=(0,s.b6)();throw o[s.Dh.EventState]=s.DD.ConverterFailed,o[s.Dh.CurrentStatement]=a.name,o[s.Dh.StatementNames]=JSON.stringify(t.map((e=>e.name))),o[s.Dh.TimeDurationInMs]=(0,s.xJ)(n),this.telemetryLogger.logEvent((0,s.gY)(o)),e}logNoEventGeneratedError(e){const t={eventType:c.S2.NoEventGenerated,errorMessage:e.message,logLevel:l.$b.ASHA},a=[{key:s.iq.Reason,value:e.reason},{key:s.iq.CurrentStatement,value:e.statementName},{key:s.iq.ArgumentNames,value:JSON.stringify(e.argumentNames)},{key:s.iq.UnsupportedArgumentTypes,value:JSON.stringify(e.unsupportedArgumentTypes)},{key:s.xL.ErrorMessage,value:e.message}];this.telemetryLogger.logError(t,void 0,a)}logStatementArgumentError(e){const t={eventType:c.S2.StatementArgumentError,errorMessage:e.message,logLevel:l.$b.Warning},a=[{key:s._4.Reason,value:e.reason},{key:s._4.ArgumentType,value:e.argumentType},{key:s._4.ExpectedType,value:e.expectedType},{key:s.xL.ErrorMessage,value:e.message}];this.telemetryLogger.logError(t,void 0,a)}fillEventConverterMap(){this.eventConverterMap.formatRanges=async(e,t)=>{const a=this.checkFreezePanes(e,t);return a||async function(e,t){const a=ne(e,t),n=await Qt(e,a,!1);return Jt(n,e,a),n}(e,this.variableCache)},this.eventConverterMap.insertTables=async(e,t)=>{this.logUnsupportedStatement(e);return[{agent:r.w2.UnsupportedEvent,items:[r.DH.InsertTables]}]},this.eventConverterMap.formatColumns=async(e,t)=>{const a=this.checkFreezePanes(e,t);return a||Vt(e,this.variableCache)},this.eventConverterMap.formatRows=async(e,t)=>{const a=this.checkFreezePanes(e,t);return a||async function(e,t){const a=ae(e,t),n=await Qt(e,a,!1);return Jt(n,e,a),n}(e,this.variableCache)},this.eventConverterMap.formatTables=async(e,t)=>{const a=this.checkFreezePanes(e,t);return a||qt(e,this.variableCache)},(0,f.yw9)("OfficeVSO_9577939_CleanUpReplaceCodes")||(this.eventConverterMap.replaceTables=async(e,t)=>async function(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const a=t.getVariableArgumentValue(e,"tables").values,n=[];for(const e of a)try{const t=e.sheetRange;if((0,f.avT)()&&(0,h.En)(e)){const a={rangeType:Et.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.WholeTable,tableName:e.name,gridRange:t}};n.push(a)}else n.push({rangeType:Et.RangeType.ExcelSheetRange,range:t})}catch{}return await Ft(e,n)}(e,this.variableCache),this.eventConverterMap.replaceColumns=async(e,t)=>async function(e,t){const a=te(e,t);return await Ft(e,a)}(e,this.variableCache),this.eventConverterMap.replaceRows=async(e,t)=>async function(e,t){const a=ae(e,t);return await Ft(e,a)}(e,this.variableCache),this.eventConverterMap.replaceRanges=async(e,t)=>async function(e,t){const a=ne(e,t);return await Ft(e,a)}(e,this.variableCache)),this.eventConverterMap.clearRanges=async(e,t)=>function(e,t,a){return Ie(ne(e,t),e,a)}(e,this.variableCache,t),this.eventConverterMap.clearTables=async(e,t)=>async function(e,t,a){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const n=t.getVariableArgumentValue(e,"tables").values,i=(0,N.Ak)(e,"content")??!1,l=(0,N.Ak)(e,"format")??!1,s={agent:r.w2.OfficeScripts,items:[]};if((0,f.yw9)("OfficeVSO_9448487_fixClearContentFormatAndHyperlink")){for(const t of n){let a;a=K(t.sheetRange),(0,f.avT)()&&(0,h.En)(t)&&(a={rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Body,tableName:t.name,gridRange:u.ExcelCalc.getIGeneralRangeOperationRange(a)}}),Re(s,e,a)}return 0===s.items.length&&(0,o.VD)(e,n.length,[]),[s]}for(const t of n){let n;if(n=K(t.sheetRange),(0,f.avT)()&&(0,h.En)(t)&&(n={rangeType:u.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Body,tableName:t.name,gridRange:u.ExcelCalc.getIGeneralRangeOperationRange(n)}}),(0,f.yw9)("OfficeVSO_9285634_RemoveClearContentRegex")){const t=(0,N.Ak)(e,"hyperlink")??!1,a=(0,N.Ak)(e,"all")??!1;i&&s.items.push(Ce(Ee.default.ClearCells,n)),t&&s.items.push(Ce(Ee.default.ConvertLinkedEntitiesToText,n)),a&&s.items.push(Ce(Ee.default.ClearCellsAll,n))}else i&&a&&(b(a,I)||b(a,R))&&s.items.push(Ce(Ee.default.ClearCells,n));l&&s.items.push(Ce(Ee.default.ClearCellsFormat,n))}return 0===s.items.length&&(0,o.VD)(e,n.length,[]),[s]}(e,this.variableCache,t),this.eventConverterMap.clearColumns=async(e,t)=>function(e,t,a){return Ie(te(e,t),e,a)}(e,this.variableCache,t),this.eventConverterMap.clearRows=async(e,t)=>function(e,t,a){return Ie(ae(e,t),e,a)}(e,this.variableCache,t),this.eventConverterMap.filterTables=async(e,t)=>async function(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","filterTables");const a=t.getVariableArgumentValue(e,"tables");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","filterTables: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const n=a.values[0],i=JSON.parse(n.headers),l=j.getTableColumnName(n,e),s=(0,N.BO)(e,"filterType");if(void 0===s)throw new o.tF("No filter type specified",e.name);const c=[];let d=!1;const m=[];if(n.tableLikeRange){const t=at[s],a=j.getTableColumnNumber(e,n);let o=u.ExcelCalc.IExcelRangeToAddress(n.sheetRange.range),l=Xe?u.ExcelCalc.IExcelRangeToAddress(u.ExcelCalc.columnFromIExcelAddress(n.sheetRange.range,a)):"";if(t){d=!0;const u=t(e);if(u.color&&(u.color=await Je(n.sheetRange.sheet,o,a,u.color,"CellColor"===s?"fill":"font",!0)),!(0,f.yw9)("OfficeVSO_9122912_HiTLTLRFilterOfficeJS")&&(0,f.yw9)("OfficeVSO_9115888_TLRFiltering")&&(0,f.k64)()){const t=nt[s],o={sheet:n.sheetRange.sheet,range:{topLeft:n.sheetRange.range.topLeft,bottomRight:{column:n.sheetRange.range.bottomRight.column,row:n.totalRow&&n.sheetRange.range.bottomRight.row?n.sheetRange.range.bottomRight.row-1:n.sheetRange.range.bottomRight.row}}};c.push({agent:r.w2.OfficeScripts,items:[await t(n.sheetRange.sheet,a+1,o,e)]})}else(0,f.tgf)()&&n.totalRow&&(o=re(n.sheetRange.range),l=o),c.push({agent:r.w2.OfficeJS,items:[tt({filterType:s,sheetName:n.sheetRange.sheet,rangeAddress:o,columnAddress:l,columnIndex:a,columnName:i[a],filterCriteria:u})]})}else m.push(s)}else{const t=et[s],a=Ke[s];d=!1;const o=[];t||a?(d=!0,t&&c.push({agent:r.w2.OfficeScripts,items:[await t(n.name,l,e)]}),a&&c.push({agent:r.w2.OfficeJS,items:[await a(n.name,l,i.indexOf(l),e)]})):o.push(s)}return 0===c.length&&(0,o.VD)(e,1,d?[]:m),c}(e,this.variableCache),this.eventConverterMap.clearFilters=async(e,t)=>Ze(e,this.variableCache),this.eventConverterMap.insertRows=async(e,t)=>async function(e,t,a){const n=t.getVariableArgumentValue(e,"scope");if("Table"!==n.entityType)throw new o.tF("Variable cache entity type mismatched!","insertTableRows: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const i=n.values[0];let l=[];l=(0,f.yw9)("OfficeVSO_9436607_WorksheetRowNumber")?M(e,i.sheetRange.range.topLeft.row??0):(0,N.dc)(e,"rowNumbers");const s={agent:r.w2.OfficeScripts,items:[]};let c=!1;const d=t.tryGetChainedVariableArgument("rows");if(d){const e=d.values.indices[0];if(e&&(l.fill(e),c=!0),c)for(let e=0;e<l.length;e++)l[e]++}const m=await j.getTableRowRangesCommon(i,l,!1);if(i.tableLikeRange){const a=[];if((0,f.yw9)("OfficeVSO_9408399_InsertBelowFixes")){const t=(0,N.Ak)(e,"insertBelow")??!1;l.sort(((e,t)=>e-t));for(let e=0;e<m.length;e++){const n=u.ExcelCalc.getIGeneralRangeOperationRange(m[e]);c&&t&&n.range.topLeft.row<i.sheetRange.range.bottomRight.row+(i.totalRow?0:1)&&(n.range.topLeft.row++,n.range.bottomRight.row++,m[e]={rangeType:Et.RangeType.ExcelSheetRange,range:n});const o=e>0?_t(l,e):0,r={rangeType:Et.RangeType.ExcelSheetRange,range:{sheet:n.sheet,range:{topLeft:{row:n.range.topLeft.row+o,column:n.range.topLeft.column},bottomRight:{row:n.range.topLeft.row+o,column:n.range.bottomRight.column}}}};a.push(r)}}m.map((e=>{s.items.push(me(u.EventMethods.Range.Inserted,e,u.IDirection.Down))})),(0,f.yw9)("OfficeVSO_9377931_InsertRowReturnVariable")&&t.UpdateVariableCache(e.returns,"Row",{ranges:(0,f.yw9)("OfficeVSO_9408399_InsertBelowFixes")?a:m})}else{const n=q(m.map((e=>u.ExcelCalc.getIGeneralRangeOperationRange(e))),i,(0,f.yw9)("OfficeVSO_9322539_InsertAtTableEnd"));if(!(0,f.yw9)("OfficeVSO_9279072_RowBelowQueryRegExp_IncrementFix")||c)if((0,f.yw9)("OfficeVSO_9279072_RowBelowQueryRegExpRemoval")){if((0,N.Ak)(e,"insertBelow"))for(let e=0;e<n.length;e++)n[e]<i.numRows&&n[e]++}else if(a&&b(a,S))for(let e=0;e<n.length;e++)n[e]<i.numRows&&n[e]++;const o=[];if(n.sort(((e,t)=>e-t)),s.items=s.items.concat(n.map((e=>he(u.EventMethods.Table.RowInserted,i.name,e,1)))),(0,f.yw9)("OfficeVSO_9377931_InsertRowReturnVariable")){const a=i.sheetRange;for(let e=0;e<n.length;e++){const t=e>0?_t(n,e):0,r={rangeType:Et.RangeType.ExcelSheetRange,range:{sheet:a.sheet,range:{topLeft:{row:a.range.topLeft.row+n[e]+1+t,column:a.range.topLeft.column},bottomRight:{row:a.range.topLeft.row+n[e]+1+t,column:a.range.bottomRight.column}}}};o.push(r)}t.UpdateVariableCache(e.returns,"Row",{ranges:o})}}return[s]}(e,this.variableCache,t),this.eventConverterMap.deleteRows=async(e,t)=>async function(e,t){const a=t.getVariableArgumentValue(e,"rows").values;if((0,f.yw9)("OfficeVSO_8460617_BlockDeleteAllRows")&&a.allRows)throw new o.tF("Deleting all rows is a blocked scenario",e.name,o.tJ.DeleteUnexpectedTableRows);const n=g(e.name),i=a.indices??[],l=n.numRows,s={agent:r.w2.OfficeScripts,items:[]};if(0===i.length){if((0,D.R)(new o.tF("Executing delete row on table with no row number")),(0,f.avT)()&&(0,h.En)(n))s.items.push(he(u.EventMethods.Table.RowsDeleted,n.name,l-1,1));else{const e=kt(n.sheetRange,l-1);if(null===e)throw new o.tF("Failed to resolve selected tables!");s.items.push(me(u.EventMethods.Range.Deleted,e,u.IDirection.Up))}return[s]}if((0,f.avT)()&&(0,h.En)(n)){const e=[],t=[];i.sort(((e,t)=>e-t)).forEach((t=>{e.push(t)}));for(let t=e.length-1;t>=0;t--){const a=e[t];a>=-1&&a<n.numRows&&s.items.push(he(u.EventMethods.Table.RowsDeleted,n.name,a,1))}for(let e=t.length-1;e>=0;e--){const a=n.numRows+t[e];a>=0&&a<n.numRows&&s.items.push(he(u.EventMethods.Table.RowsDeleted,n.name,a,1))}}else i.sort(((e,t)=>t-e)).forEach((e=>{const t=kt(n.sheetRange,e+1);if(null===t)throw new o.tF("Failed to resolve selected tables!");s.items.push(me(u.EventMethods.Range.Deleted,t,u.IDirection.Up))}));return 0===s.items.length&&(0,o.VD)(e,1,[]),[s]}(e,this.variableCache),this.eventConverterMap.insertColumns=async(e,t)=>function(e,t){const a=t.getVariableArgumentValue(e,"scope");if("Table"!==a.entityType)throw new o.tF("Variable cache entity type mismatched!","insertColumns: "+e.name,o.tJ.VariableCacheEntityTypeMismatched);const n=a.values[0];let i=[];i=j.getTableColumnNumbers(e,n),i=i.map((e=>e+1));const l=(0,N.Lb)(e,"columnNames"),s=(0,N.Lb)(e,"numberFormats"),c={agent:r.w2.OfficeScripts,items:[]},d=n.sheetRange,m=n.numColumns;if(l.length!==s.length&&0!==l.length&&0!==s.length)throw new o.tF("mismatch between columnNames and numberFormat dimensions","scope");if(0===i.length||-1===i[0]&&1===i.length){const e=0===l.length?0===s.length?1:s.length:l.length;i=Array(e).fill(m+1)}if(1===i.length&&i[0]>-1&&l.length>1){const e=l.length;i=Array(e).fill(i[0])}if(i.length!==l.length&&0!==l.length)throw new o.tF("mismatch between columnNames, columnNumbers, numberFormat, and columnValues","columns");const g=(p=m,i.map((e=>e<0?p+1+e:e-1)).sort(((e,t)=>e-t)));var p;for(let e=g.length-1;e>=0;e--){const t=g[e];if(t>=0&&t<=m){if(n.tableLikeRange){const e=At(n.sheetRange,t);if(null===e)throw new o.tF("Failed to resolve selected tables!");c.items.push(me(u.EventMethods.Range.Inserted,e,u.IDirection.Right))}else(0,f.avT)()?c.items.push(ge(n.name,t,1,l.length>e?[l[e]]:void 0)):c.items.push(he(u.EventMethods.Table.ColumnInserted,n.name,t,1));const a=d.range.topLeft.row??0,r=(d.range.bottomRight.row??0)+1,i=(d.range.topLeft.column??0)+t;if(0!==s.length){const o={range:{topLeft:{row:a,column:i},bottomRight:{row:r,column:i}},sheet:d.sheet},l="";(0,f.avT)()&&(0,h.En)(n)?c.items.push(de(u.EventMethods.Range.NumberFormatChanged,(0,It.j)(s[e],void 0),{rangeType:Et.RangeType.TableRange,range:{subRange:u.TableRangeOperationSubRange.Columns,tableName:n.name,gridRange:o,subRangeValues:{firstIndex:t,count:1}}},l)):c.items.push(de(u.EventMethods.Range.NumberFormatChanged,(0,It.j)(s[e],void 0),{rangeType:Et.RangeType.ExcelSheetRange,range:o},l))}if(!(0,f.avT)()&&0!==l.length){const t={range:{topLeft:{row:a,column:i},bottomRight:{row:a,column:i}},sheet:d.sheet};c.items.push((0,f.yw9)("OfficeVSO_9056836_useRangeSingleValueEdited")?ce(l[e],t):se([[l[e]]],t))}}}return 0===c.items.length&&(0,o.VD)(e,1,[]),[c]}(e,this.variableCache),this.eventConverterMap.deleteColumns=async(e,t)=>async function(e,t){const a=t.getVariableArgumentValue(e,"columns").values,n=g(e.name),i=a.indices??[],l=n.numColumns,s={agent:r.w2.OfficeScripts,items:[]};if(0===i.length){if((0,D.R)(new o.tF("Executing delete column on table with no column number")),(0,f.avT)()&&(0,h.En)(n))s.items.push(he(u.EventMethods.Table.ColumnsDeleted,n.name,l-1,1));else{const e=At(n.sheetRange,l-1);if(null===e)throw new o.tF("Failed to resolve selected tables!");s.items.push(me(u.EventMethods.Range.Deleted,e,u.IDirection.Left))}return[s]}if((0,f.avT)()&&(0,h.En)(n)){const e=[],t=[];i.sort(((e,t)=>e-t)).forEach((a=>{a<0?t.push(a):e.push(a)}));for(let t=e.length-1;t>=0;t--){const a=e[t];a>=0&&a<l&&s.items.push(he(u.EventMethods.Table.ColumnsDeleted,n.name,a,1))}for(let e=t.length-1;e>=0;e--){const a=l+t[e];a>=0&&a<l&&s.items.push(he(u.EventMethods.Table.ColumnsDeleted,n.name,a,1))}}else i.sort(((e,t)=>t-e)).forEach((e=>{const t=At(n.sheetRange,e);if(null===t)throw new o.tF("Failed to resolve selected tables!");s.items.push(me(u.EventMethods.Range.Deleted,t,u.IDirection.Left))}));return 0===s.items.length&&(0,o.VD)(e,1,[]),[s]}(e,this.variableCache),this.eventConverterMap.addCalculatedColumns=async(e,t)=>Yt(e,this.variableCache),this.eventConverterMap.aggregateColumns=async(e,t)=>Yt(e,this.variableCache),this.eventConverterMap.getInsights=async(e,t)=>async function(e,t){if(!e.arguments.tables)throw new o.tF("No table specified.","tables");const a=t.getVariableArgumentValue(e,"tables").values[0],n=(0,N.Ru)(e,"instruction")??"get insights",i={func:"getTableInsights",args:[a.name,n]};return[{agent:r.w2.Insights,items:[i]}]}(e,this.variableCache),(0,f.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.ImportDataAsSkill",!1)&&(this.eventConverterMap.insertDatasource=async(e,t)=>async function(e){if(!e.arguments.preview)throw new o.tF("no preview context","preview");const t={func:"insertDatasource",args:[(0,N.Ru)(e,"preview")]};return[{agent:r.w2.ImportData,items:[t]}]}(e,this.variableCache)),(0,f.eFk)()&&(this.eventConverterMap.addDataShapingTransformationSteps=async(e,t)=>async function(e){const t={kind:"addDataShapingTransformationSteps",args:{sessionId:(0,N.C3)(e,"sessionId"),transformationStepsJson:Y(e,"transformationSteps"),transformationStepsExplanation:Y(e,"transformationStepsExplanation"),requestJson:X(e,"requestJson")}};return[{agent:r.w2.DataShaping,items:[t]}]}(e,this.variableCache),this.eventConverterMap.editDataShapingQuery=async(e,t)=>async function(e){const t={kind:"editDataShapingQuery",args:{sessionId:(0,N.C3)(e,"sessionId"),instruction:Y(e,"instruction"),queryScript:Y(e,"queryScript"),explanation:Y(e,"explanation"),requestJson:X(e,"requestJson")}};return[{agent:r.w2.DataShaping,items:[t]}]}(e,this.variableCache),this.eventConverterMap.dataShapingFailure=async(e,t)=>async function(e){const t=(0,N.C3)(e,"sessionId"),a=(0,N.BO)(e,"errorSource"),n=(0,N.BO)(e,"errorCode"),o=X(e,"requestJson");if(!a||!["EnterMode","AddStep","CreatePlan"].includes(a))throw new Error(`Invalid errorSource: ${a}`);if(!n||!["BaseQueryFailure","ExplanationFailure","NoRange","PowerQueryApiFailure","QueryTable","StepFromNLFailure","TableNotFound","UnexpectedError"].includes(n))throw new Error(`Invalid errorCode: ${n}`);const i={kind:"dataShapingFailure",args:{sessionId:t,errorSource:a,errorCode:n,requestJson:o}};return[{agent:r.w2.DataShaping,items:[i]}]}(e,this.variableCache),this.eventConverterMap.enterDataShapingMode=async(e,t)=>async function(e){const t={kind:"enterDataShapingMode",args:{tableName:(0,N.C3)(e,"tableName"),sessionId:(0,N.C3)(e,"sessionId"),mashupDocument:Y(e,"mashupDocument"),queryName:(0,N.C3)(e,"queryName"),queryScript:Y(e,"queryScript"),requestJson:X(e,"requestJson")}};return[{agent:r.w2.DataShaping,items:[t]}]}(e,this.variableCache)),this.eventConverterMap.sortTables=async(e,t)=>ut(e,this.variableCache,this.executableItems,t),this.eventConverterMap.clearSort=async(e,t)=>(0,f.yw9)("OfficeVSO_9217762_SupportClearSorting")?mt(e,this.variableCache):ut(e,this.variableCache,this.executableItems,t),this.eventConverterMap.conditionalFormatRanges=async(e,t)=>vt(e,this.variableCache),this.eventConverterMap.conditionalFormatTables=async(e,t)=>async function(e,t){return xt(e,await ee(e,t))}(e,this.variableCache),this.eventConverterMap.conditionalFormatColumns=async(e,t)=>async function(e,t){return xt(e,te(e,t),oe(e,t))}(e,this.variableCache),this.eventConverterMap.conditionalFormatRows=async(e,t)=>async function(e,t){return xt(e,ae(e,t))}(e,this.variableCache),this.eventConverterMap.conditionalFormatSuggestionPill=async(e,t)=>wt(e,this.variableCache,n.i.SuggestionPill),this.eventConverterMap.conditionalFormatSuggestion=async(e,t)=>wt(e,this.variableCache,n.i.Chat),this.eventConverterMap.insertWorksheets=async(e,t)=>{this.logUnsupportedStatement(e);return[{agent:r.w2.UnsupportedEvent,items:[r.DH.InsertWorksheets]}]},this.eventConverterMap.deleteWorksheets=async(e,t)=>{this.logUnsupportedStatement(e);return[{agent:r.w2.UnsupportedEvent,items:[r.DH.DeleteWorksheets]}]},(0,f.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.EnableDataValidation",!1)&&(this.eventConverterMap.addDataValidationColumns=async(e,t)=>async function(e,t){const a=te(e,t);return await Se(e,a)}(e,this.variableCache),this.eventConverterMap.addDataValidationRows=async(e,t)=>async function(e,t){const a=ae(e,t);return await Se(e,a)}(e,this.variableCache),this.eventConverterMap.addDataValidationTables=async(e,t)=>async function(e,t){return Se(e,await ee(e,t))}(e,this.variableCache),this.eventConverterMap.addDataValidationRanges=async(e,t)=>async function(e,t){const a=ne(e,t);return await Se(e,a)}(e,this.variableCache))}constructor(){this.variableCache=new Q,this.telemetryLogger=d.M.getInstance(),this.executableItems=[],this.eventConverterMap={},this.fillEventConverterMap()}}},520107:(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{z:()=>getOfficeJSClientProps});var _utils__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(79458),_insights_api_excel_flighting__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(528804);function getOfficeJSClientProps(){if(!(0,_insights_api_excel_flighting__WEBPACK_IMPORTED_MODULE_1__.NbV)())return;const officeJSTool={name:"OfficeJSExecutor",description:"Executor for OfficeJS code",inputSchema:{type:"object",properties:{officejs:{type:"string",description:(0,_insights_api_excel_flighting__WEBPACK_IMPORTED_MODULE_1__.qMK)()||'OfficeJS code in format "{(async () => {<insert code here>); resolve(<result>)})();}". Should always resolve result that can be used as input for jsonify. No output to console or use of return. No data processing or mix of document set/gets in a script.'}},required:["officejs"],additionalProperties:!1,$schema:"https://json-schema.org/draft-07/schema#"}},getOfficeJSTools=()=>({tools:[officeJSTool]}),callOfficeJSTool=async(toolName,args)=>{if(toolName!==officeJSTool.name)throw new Error(`Unknown tool name: ${toolName}`);const executeOfficeJSCodeForChatInput=async officejs=>{const waitEval=ev=>new Promise(((resolve,reject)=>{eval(ev)})),transpileTypeScript=async function(e){return(await Promise.all([__webpack_require__.e("vendors-npm_store_sdx_officecopilot_typescript_5_0_4-007004e2f84938dc12ca_node_modules_typesc-351a83","high"),__webpack_require__.e("ts","high")]).then(__webpack_require__.t.bind(__webpack_require__,508479,23))).transpile(e)},jsCode=await transpileTypeScript(officejs),result=await(async()=>{try{return await waitEval(jsCode)}catch(e){const t=e instanceof Error?e.message:String(e);return(0,_utils__WEBPACK_IMPORTED_MODULE_0__.cY)(`Syntax Error jsCode: ${jsCode}\n Error: ${t}`),t}})();return result};return await executeOfficeJSCodeForChatInput(args.officejs)};return{getLocalTools:getOfficeJSTools,callLocalTool:callOfficeJSTool}}},522667:(e,t,a)=>{"use strict";a.d(t,{A7:()=>A,VQ:()=>y,px:()=>E});var n=a(632512),o=a(78160),r=a(755005),i=a(956258),l=a(880496),s=a(528804),c=a(993384),d=a(388435),u=a(703227);const m=4,h=5e6,g=5e5,p=5e8,b={maxCellCount:1e4,entryLimit:1e3};class f{log(){i.M.getInstance().logGetSelectionContext(this.columnCount,this.rowCount,this.selectionExpanded,this.tableSelectionContext,this.isSmallSelection,this.areaCount)}constructor(){this.selectionExpanded=!1,this.columnCount=0,this.rowCount=0,this.tableSelectionContext={isTable:!1,hasTableHeaders:!1,showTotals:!1},this.isSmallSelection=!1,this.areaCount=0}}function C(e){e.load(["isNullObject","cellCount","isEntireRow","isEntireColumn","worksheet/id","worksheet/name","address","columnCount","rowCount","rowIndex","columnIndex","rowHidden"])}async function y(e,t,a,n,o,r){r&&i.M.getInstance().addAnalyzeDataStep(r,"getSelectionDataForFormulas");const l=Date.now(),s=Math.min(b.entryLimit,Math.ceil(b.maxCellCount/a)),c=await Excel.run((async r=>{const i=r.workbook.worksheets.getItem(o),l=i.getRangeByIndexes(t,n,e,a),c=v(l),d=T(i,Math.min(s,e),t,a,n);await l.context.sync();return{...c(),formulas:d()}}));return i.M.getInstance().logLoadFormulaData(Date.now()-l,e,a),r&&i.M.getInstance().removeAnalyzeDataStep(r,"getSelectionDataForFormulas"),c}function v(e){return e.load(["values","numberFormat","numberFormatLocal","text","valueTypes"]),()=>{let t=!1;const a=e.values.map(((a,n)=>a.map(((a,o)=>"#VALUE!"===a?(t=!0,e.text[n][o]):e.valueTypes[n][o]===Excel.RangeValueType.empty?null:e.values[n][o]))));return i.M.getInstance().logGetDataFromRange(t),{values:a,formats:e.numberFormat,formatLocals:e.numberFormatLocal,text:e.text}}}function x(e,t,a,n,o){const r=e.getRangeByIndexes(a,o,t,n).getMergedAreas(),i=r.areas;return i.load(["columnIndex","rowIndex","columnCount","rowCount"]),()=>r.isNullObject?[]:i.items.map((e=>{const{columnIndex:t,rowIndex:n,columnCount:r,rowCount:i}=e,l=n-a,s=t-o;return{top:l,left:s,bottom:l+i-1,right:s+r-1}}))}function T(e,t,a,n,o){const r=e.getRangeByIndexes(a,o,t,n);return r.load(["formulas","rowCount","columnCount"]),()=>r.formulas}function S(e,t,a,n,o){let r;if(t*n<h)r=e.getRangeByIndexes(a,o,t,n).getNumberFormatProperties().load("items/*");else{const i=Math.min(t,b.entryLimit),s=Math.min(n,b.maxCellCount/i),c=(0,l.uT)(a,o,i,s),d=e.getRange(c);r=d.getNumberFormatProperties().load("items/*")}return()=>r.items}function w(e){const t=e.map((e=>e.values)),a=e.map((e=>e.text)),n=e.map((e=>e.formats)),o=e.map((e=>e.formatLocals));return{values:[].concat(...t),formats:[].concat(...n),formatLocals:[].concat(...o),text:[].concat(...a)}}async function E(e,t){t&&i.M.getInstance().addAnalyzeDataStep(t,"getSelectionContextAndData");const a=new f,y=performance.now();let E;const L=()=>(E=performance.now(),E);try{return await Excel.run((async f=>async function(e,t,a,f,y,E){E&&i.M.getInstance().addAnalyzeDataStep(E,"getSelectionContextAndDataImp");const L=(0,c.dI)(e),k=A(e),F=await async function(e,t,a,o){o&&i.M.getInstance().addAnalyzeDataStep(o,"getNewSelectedRange");const c=e.workbook.getSelectedRanges().load("areaCount"),h=c.getUsedRangeAreasOrNullObject(!0);let g;if(a.type===r.lp.StandardTable)g=e.workbook.tables.getItem(a.name).getRange();else{if(a.type!==r.lp.TableLikeRange)throw new Error("InvalidTableLikeEntityType");{const t=(0,u.G2)(a.name);g=e.workbook.worksheets.getItem(a.sheetId).getRange(t),a.showTotals&&(g=g.getResizedRange(-1,0))}}g.load(["cellCount","rowCount"]);const p=g.getUsedRangeOrNullObject(!0).load(["cellCount","rowCount"]),b={selected:{range:g},usedSelected:{range:p}};!function(e){const t=e.selected.range.worksheet;t.tables.load(["items","showHeaders","showTotals","name"]),t.pivotTables.load("items"),t.load("id"),[e.selected.range,e.usedSelected.range].forEach((e=>C(e)))}(b);const f=function(e){const t=e.getTables().load({name:!0,showHeaders:!0,showTotals:!0});return async()=>{if(1!==t.items.length)return;const e=t.items[0],a=(0,d.U2)(e,e.showHeaders);return C(a),await e.context.sync(),{range:a,isPivotTable:!1,getTableData:()=>({tableName:e.name,hasTableHeaders:e.showHeaders,showTotals:e.showTotals}),getHasHiddenRows:()=>!1!==a.rowHidden}}}(g),y=function(e){const t=function(e){const t=e.getSurroundingDataRegion();return C(t),{range:t,usedRange:t}}(e.selected.range),a=function(e){return C(e.selected.range),{range:e.selected.range,usedRange:e.usedSelected.range}}(e),n=R(t.range,t.usedRange),o=R(a.range,a.usedRange);return n.next(),o.next(),{smallSelectionGenerator:n,largeSelectionGenerator:o}}(b);try{let n;await e.sync();const o=g.isEntireRow||g.isEntireColumn;t.areaCount=c.areaCount;const i=h.isNullObject,d=e=>e.usedSelected.range.isNullObject||i||e.usedSelected.range.cellCount<=m||e.usedSelected.range.rowCount<2||1===e.usedSelected.range.columnCount;if(a.type!==r.lp.TableLikeRange&&((0,s.yw9)("OfficeVSO_9858693_fixCalculatedRowPostioningForTableWithEmptyRows")||d(b))){t.selectionExpanded=!0,t.isSmallSelection=!0;const a=await f(),r=!a||o?await(0,l.H)(e,y.smallSelectionGenerator):a;n=a??r}else n=await(0,l.H)(e,y.largeSelectionGenerator);return{selected:n}}catch(e){if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode)throw new n.u(n.O.CellEditModeError,e);if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidSelection)throw new n.u(n.O.InvalidSelection,e);throw e}finally{o&&i.M.getInstance().removeAnalyzeDataStep(o,"getNewSelectedRange")}}(e,t,y,E),_=F.selected,P=L(),N=k();if(!_)return i.M.getInstance().logDuration("GetSelectionContext",performance.now()-a,E),E&&i.M.getInstance().removeAnalyzeDataStep(E,"getSelectionContextAndDataImp"),{context:I,localeDeprecated:P,theme:N,dataGenerator:async function*(){}()};try{!function(e){if(e.range.isEntireRow||e.range.isEntireColumn)throw new n.u(n.O.UnboundedRange)}(_)}catch(e){throw E&&i.M.getInstance().removeAnalyzeDataStep(E,"getSelectionContextAndDataImp"),e}i.M.getInstance().logDuration("GetSelectionContext",f()-a,E);const{rowCount:M,rowIndex:O,columnCount:D,columnIndex:B,worksheet:$}=_.range,H=async function*(e,t,a,n,r,l){const c=Office.context.platform===Office.PlatformType.OfficeOnline?h:g;let d=Math.floor(Math.min(e,c/a));const u=2**(0,s.Z8j)("Microsoft.Office.Excel.FA000000124.MaxPayloadSizeRetries",7),m=Math.min(b.entryLimit,Math.ceil(b.maxCellCount/a));let f=t,C=t;for(;f<t+e;){l&&i.M.getInstance().addAnalyzeDataStep(l,"getSelectionDataFromSelectedRangeInfo");const s=Date.now(),h=[],g=[];let y,E,I=0;try{const R=await Excel.run((async i=>{const l=i.workbook.worksheets.getItem(r);for(;f<t+e&&f-C<Math.floor(c/a);){let r=0;if(h.length===u||r>=p){const e=w(h),t=[].concat(...g);return{...e,mergedCells:E,formulas:t}}const i=l.getRangeByIndexes(f,n,Math.min(d,t+e-f),a),s=v(i);let c,C,R=()=>[];f===t&&(c=x(l,e,t,a,n),R=S(l,e,t,a,n));const A=f-t;A<m&&A*a<b.maxCellCount&&(C=T(l,Math.min(m-A,d),f,a,n)),I++;try{await i.context.sync();const e=s();h.push(e),void 0!==C&&g.push(C()),f===t&&(E=c(),y=R(),o.P.getNumberFormatCache().addNumberFormatPropertiesToCache(y)),r+=JSON.stringify(e).length,f+=d}catch(e){if(!(e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded||e.code===OfficeExtension.ErrorCodes.generalException)&&d>1))throw e;d=Math.ceil(d/2)}}const s=w(h),R=[].concat(...g);return{...s,mergedCells:E,formulas:R}}));i.M.getInstance().logLoadDataWithChunking("GetSelectionData",Date.now()-s,e,a,!0,h.length,I,d),C+=R.values.length,l&&i.M.getInstance().removeAnalyzeDataStep(l,"getSelectionDataFromSelectedRangeInfo"),yield R}catch(t){throw i.M.getInstance().logLoadDataWithChunking("GetSelectionData",Date.now()-s,e,a,!1,h.length,I,d),t}}}(M,O,D,B,$.id,E);let U=function(e,t){if(!e)return;return function(e,t){const a=t.range;e.columnCount=a.columnCount,e.rowCount=a.rowCount;const n=t.getTableData();let o;o=n?n.tableName:void 0;const r={isTable:!!n,hasTableHeaders:!!n&&n.hasTableHeaders,showTotals:!!n&&n.showTotals,tableName:o,hasHiddenRows:t.getHasHiddenRows()};return e.tableSelectionContext=r,i.M.getInstance().logDuration("GenerateSelectionContext",0),{address:(0,l.gx)(a.address),sheetId:a.worksheet.id,sheetName:a.worksheet.name,rowCount:a.rowCount,rowIndex:a.rowIndex,columnCount:a.columnCount,columnIndex:a.columnIndex,...r}}(t,e)}(_,t)??I;y.type===r.lp.TableLikeRange&&(U={...U,tableName:y.name,showTotals:y.showTotals,hasTableHeaders:y.hasTableHeaders});t.log(),E&&i.M.getInstance().removeAnalyzeDataStep(E,"getSelectionContextAndDataImp");return{context:U,dataGenerator:H,localeDeprecated:P,theme:N}}(f,a,y,L,e,t)))}catch(e){throw e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.inactiveWorkbook?new n.u(n.O.InactiveWorkbook,e):e instanceof n.u?e:new n.u(n.O.SelectionFailed,e)}finally{E&&i.M.getInstance().logDuration("GetSelectionData",performance.now()-E,t),t&&i.M.getInstance().removeAnalyzeDataStep(t,"getSelectionContextAndData")}}const I={rowCount:0,rowIndex:0,columnCount:0,columnIndex:0,isTable:!1,hasTableHeaders:!1,showTotals:!1};function*R(e,t){const a=e.getTables().load("items"),o=e.getPivotTables(!1).getFirstOrNullObject(),r=o.layout.getRange();C(r);const i={range:t,getTableData:()=>{},getHasHiddenRows:()=>!1!==r.rowHidden};if(yield,o.isNullObject&&0===a.items.length)return i;a.items.forEach((e=>{e.load(["showHeaders","name","showTotals"])}));const l=a.items.map((e=>{const t=e.getRange();return C(t),t}));if(o.isNullObject){if(a.items.length>0){let e=t;if(1===l.length&&(yield,function(e,t){return null!==e&&null!==t&&e.rowIndex>=t.rowIndex&&e.columnIndex>=t.columnIndex&&e.rowIndex+e.rowCount<=t.rowIndex+t.rowCount&&e.columnIndex+e.columnCount<=t.columnIndex+t.columnCount}(l[0],t)&&(e=l[0])),a.items.some((e=>e.showTotals))){const t=a.items.map((e=>e.getTotalRowRange().load(["rowIndex","columnIndex","columnCount"]))),n=1===e.rowCount?void 0:e.getResizedRange(-1,0);n&&(C(n),yield,t.some(((t,n)=>a.items[n].showTotals&&t.columnIndex>=e.columnIndex&&t.columnIndex+t.columnCount<=e.columnIndex+e.columnCount&&t.rowIndex===e.rowIndex+e.rowCount-1))&&(e=n))}return{range:e,getTableData:()=>{const t=l.findIndex((t=>function(e,t){return e.rowIndex<=t.rowIndex&&e.columnIndex<=t.columnIndex&&e.rowIndex+e.rowCount>=t.rowIndex+t.rowCount&&e.columnIndex+e.columnCount>=t.columnIndex+t.columnCount}(t,e)));return-1===t?void 0:{hasTableHeaders:a.items[t].showHeaders,tableName:a.items[t].name,showTotals:a.items[t].showTotals}},getHasHiddenRows:()=>!1!==e.rowHidden}}return i}throw new n.u(n.O.PivotTableSelection)}function A(e){if(Office.context.requirements.isSetSupported("ExcelApi","1.17")){const t=e.workbook.getThemeColors();return()=>{const e={accentColors:[]},a=t.value;if(a.length<10)return e;for(let t=4;t<10;t++)e.accentColors.push(L(a[t]));return e.lightColor=L(a[0]),e.darkColor=L(a[1]),e}}const t={accentColors:[]};return()=>t}function L(e){return{r:(255&e)/255,g:(e>>8&255)/255,b:(e>>16&255)/255,a:1}}},525463:(e,t,a)=>{"use strict";a.d(t,{BG:()=>s,LS:()=>c,do:()=>l});var n=a(632512),o=a(83437),r=a(965634),i=a(956258);const l=5;function s(e,t,a,s,c,u){if(c=function(e,t,a,s){if(s&&s.length>0||!a)return s;const c=t+1,d=c+e.length-1,u=a.filter((e=>e>=c&&e<=d)).map((t=>e[t-c].map((e=>({value:e,row:t})))));if(a.length===u.length||u.length>=l-1)return u;return i.M.getInstance().logErrorCode(n.O.CalculatedColumnVisibleRowsOutOfRange,new Error(`Not enough visible rows to generate visibleRowsPreviewValues, generated ${u.length} rows out of ${a.length} visible rows`),r.S2.FormulaGeneration,o.$b.Warning),function(e,t){const a=e.slice(0,l).map(((e,a)=>e.map((e=>({value:e,row:t+a})))));return a}(e,c)}(s,e,u,c),c&&c.length>0)return function(e,t,a,n){const o={headerRow:e,columnLetters:t,columnHeaders:a,rows:[]},r=n[0].length,i=d(n,l);o.rows=i.map((e=>({row:e[0].row,values:d(e,r).map((e=>e.value))}))),n.length>i.length&&o.rows.splice(-1,1,{row:"...",values:Array(r).fill("...")});return o}(e,t,a,c);const m={headerRow:e,columnLetters:t,columnHeaders:a,rows:[]},h=s[0].length,g=d(s,l);return m.rows=g.map(((t,a)=>({row:e+1+a,values:d(t,h)}))),s.length>g.length&&m.rows.splice(-2,2,{row:"...",values:Array(h).fill("...")},{row:e+s.length,values:s[s.length-1]}),m}function c(e,t,[a],n,o){const r={headerRow:e,columnLetters:t,columnHeaders:n[0],rows:[],headerPreviewValue:a.at(-1)},i=n.slice(1),s=a.length,c=d(i,l-1);return r.rows=c.map(((t,a)=>({row:e+1+a,values:d(t,s)}))),i.length>c.length&&r.rows.splice(-1,1,{row:"...",values:Array(s).fill("...")}),r.rows.push({row:e+(o??i.length+1),values:a}),r}function d(e,t){return e.slice(0,t)}},527691:(e,t,a)=>{"use strict";a.d(t,{o:()=>p,r:()=>b});var n=a(725556),o=a(267324),r=a(980214),i=a(135973),l=a(202051),s=a(940096),c=a(528804),d=a(988013),u=a(848403),m=a(887648),h=a(208520);const g=async(e,t,n,o,r,i,c,d,u,m,h,g,p,b,f,C,y)=>await Excel.run((async v=>{try{const x=await Promise.all([a.e("chunk1jsfluent","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81","high"),a.e("calc","high")]).then(a.bind(a,837051)),T=c((0,s.Z)());let S={context:v,requestId:e,cellAddress:n,sheetId:o,calc:x,linkTheme:r,styles:i,valOper:void 0,isPythonCodeShown:h,setIsPythonCodeShown:g,dispatch:c,isLoadingUIShown:d,pythonUserRequestId:u,isInitialDataFrame:m,code:t,codeExplanation:f,codeLabel:C,isPythonExecutionSuccess:y,diagnosticsEntry:p,localeCache:T};S=await(async(e,t,a,n)=>{const o=n?e.extractOper(n):void 0;if(n&&!o){const e=`getValOperAndAddToProps: valOper is ${o?"defined":"undefined"} and pythonCell is ${n?"defined":"undefined"}.`,r=(0,l.pz)(e,void 0);(0,l.QX)(t,r,!1),a.isPythonExecutionSuccess=!1}return a.valOper=o,a})(x,c,S,b);const w=x.renderCodeAndPostView(S)??void 0;if(!w){const e="getCodeAndPostView: CodeAndPostView is undefined after renderCodeAndPostView.",t=(0,l.pz)(e,void 0);return(0,l.QX)(c,t,!1),S.isPythonExecutionSuccess=!1,x.renderCodeAndPostView(S)??void 0}return w}catch(b){return(async(e,t,n,o,r,i,c,d,u,m,h,g,p,b,f,C,y)=>{const v=(0,l.pz)((0,l.MQ)(t,"getCodeAndPostView"),t);(0,l.QX)(u,v,!1);try{const t=await Promise.all([a.e("chunk1jsfluent","high"),a.e("vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81","high"),a.e("calc","high")]).then(a.bind(a,837051)),l=u((0,s.Z)()),v={context:e,requestId:n,cellAddress:r,sheetId:i,calc:t,linkTheme:c,styles:d,valOper:void 0,isPythonCodeShown:p,setIsPythonCodeShown:b,dispatch:u,isLoadingUIShown:m,pythonUserRequestId:h,isInitialDataFrame:g,code:o,codeExplanation:C,codeLabel:y,isPythonExecutionSuccess:!1,diagnosticsEntry:f,localeCache:l};return t.renderCodeAndPostView(v)??void 0}catch(t){const e=(0,l.pz)((0,l.MQ)(t,"getCodeAndPostView"),t);return void(0,l.QX)(u,e,!1)}})(v,b,e,t,n,o,r,i,c,d,u,m,h,g,p,f,C)}}));function p({requestId:e,cellAddress:t,sheetId:a,pythonCell:r,code:i,codeExplanation:l,codeLabel:s,isPythonExecutionSuccess:p,diagnosticsEntry:f,pythonUserRequestId:C,isInitialDataFrame:y}){const v=(0,d.j)(),x=(0,m.d4)((e=>e.chat.showLoadingUI)),T=(0,m.d4)((e=>e.chat.lastPythonQueryId));let S=(0,m.d4)((e=>e.chat.isPythonMode));(0,c.cGu)()||(S=void 0);const[w,E]=h.useState(),{linkTheme:I,getStyles:R,sdxTheme:A,isHighContrast:L}=(0,u.X)();return(0,h.useEffect)((()=>{(async()=>{const c=await g(e,i,t,a,I,R(),v,x,C,y,void 0,void 0,f,r,l,s,p);E(c||(0,n.jsx)("i",{children:(0,o.csN)()}))})()}),[A,x,L,r,p,T,S]),w??(0,n.jsx)(b,{})}function b(){return(0,n.jsx)(r.E,{animation:"wave",appearance:"translucent",style:{width:"100%",height:12,marginLeft:4,marginRight:4},children:(0,n.jsx)(i.H,{size:12})})}},528804:(e,t,a)=>{"use strict";a.d(t,{aJZ:()=>Ta,v2n:()=>J,vNc:()=>X,$Xf:()=>Z,DU1:()=>Y,DDL:()=>K,K7T:()=>ee,ljm:()=>At,NBG:()=>Lt,UxI:()=>P,Xfp:()=>Lo,Qyj:()=>vt,kRR:()=>Vo,HSC:()=>q,gr8:()=>V,K5:()=>Pt,WIm:()=>ra,CDX:()=>Ca,IdM:()=>za,hrE:()=>Fa,VDk:()=>ka,Wmj:()=>_a,i9S:()=>yo,vPK:()=>en,jjh:()=>an,P5X:()=>pn,$Cf:()=>hn,TS5:()=>tn,qcw:()=>Co,UW0:()=>fn,g92:()=>jt,VKb:()=>on,OUH:()=>zo,mXJ:()=>Hn,LUs:()=>zn,DI8:()=>Rn,vcx:()=>Un,uPG:()=>nn,I3H:()=>Kt,dw_:()=>Zt,e7E:()=>On,PrP:()=>Da,_k_:()=>In,tO4:()=>gn,mdc:()=>ae,v5R:()=>Pa,Lzg:()=>Vt,CUx:()=>qt,eh5:()=>$n,NbV:()=>No,fnY:()=>te,Cpg:()=>Ft,wOV:()=>_t,FFf:()=>Ut,Wo:()=>Qa,Oc9:()=>Bn,afi:()=>Wa,o25:()=>La,LNg:()=>Aa,jEg:()=>Ao,BOx:()=>ya,cjy:()=>_o,CyP:()=>Mo,iPS:()=>x,yw9:()=>y,Wp2:()=>ko,LKL:()=>Va,l9B:()=>_n,wOI:()=>vo,yjA:()=>un,xyg:()=>C,AmF:()=>Nn,Oo4:()=>Ra,lCC:()=>E,Z8j:()=>T,eHf:()=>Po,Jqb:()=>rn,UjX:()=>sn,b13:()=>ln,OSh:()=>lo,n7$:()=>Zn,tsg:()=>Ka,bzg:()=>Za,xtK:()=>Ct,qMK:()=>Do,sK$:()=>Fo,bdK:()=>rt,beW:()=>S,Te4:()=>ft,UTV:()=>ga,NT7:()=>Sa,u5T:()=>Oo,_7P:()=>Kn,LhK:()=>Me,TGR:()=>To,Fz9:()=>oe,UBP:()=>ye,nmB:()=>Ze,l6e:()=>Jt,uPA:()=>So,de5:()=>Ht,KT8:()=>ua,N6k:()=>z,cMx:()=>Vn,DnQ:()=>xn,$ii:()=>vn,uEU:()=>An,ThR:()=>Mn,IfU:()=>Sn,xCw:()=>$t,KxH:()=>Jn,zn0:()=>Gn,Qq4:()=>En,O74:()=>Tn,ddP:()=>wn,XPY:()=>Xn,Ak0:()=>Ln,IQJ:()=>Wn,OWE:()=>eo,AJD:()=>bn,_NB:()=>ve,H_b:()=>G,eUQ:()=>$o,Jym:()=>ut,bx9:()=>ie,jGm:()=>wa,K$3:()=>xt,osS:()=>W,cts:()=>Ha,Shf:()=>j,_bw:()=>ne,LSW:()=>Na,DtK:()=>Ma,jxV:()=>Oa,IU1:()=>se,ID5:()=>Ee,GIC:()=>we,Ap6:()=>Ke,Lap:()=>R,avT:()=>I,UIZ:()=>fo,Pz_:()=>Ot,Om4:()=>$a,CLb:()=>na,MNq:()=>aa,lht:()=>Re,eFk:()=>Ie,jHv:()=>mt,Ton:()=>to,cTR:()=>ht,rbw:()=>xe,sx$:()=>kn,cpQ:()=>jn,pv3:()=>Ba,lDp:()=>B,t9T:()=>de,oJj:()=>H,ULj:()=>U,U4g:()=>Pn,KV_:()=>dt,dl3:()=>Yt,xLF:()=>Ae,Jhm:()=>Et,Y$0:()=>ct,vIj:()=>D,thH:()=>bt,sSY:()=>mo,Skv:()=>da,oaD:()=>la,WFw:()=>Tt,KWs:()=>pa,dOo:()=>ba,HHv:()=>ha,gQ_:()=>sa,o94:()=>uo,UDM:()=>$,eOl:()=>qn,Pol:()=>Xa,A9c:()=>Q,Hvn:()=>ao,f7I:()=>Uo,PiX:()=>Ho,Sdn:()=>wo,lJI:()=>cn,Kuk:()=>yn,i3k:()=>Cn,QI_:()=>qo,dru:()=>ro,YAc:()=>io,_Ij:()=>Fn,sDe:()=>co,fFf:()=>oo,FsT:()=>so,LaH:()=>Eo,SAS:()=>no,_dF:()=>at,pS6:()=>nt,EJJ:()=>qe,DBQ:()=>Ve,ggM:()=>Ge,rFv:()=>xo,kkU:()=>It,CpS:()=>lt,iYf:()=>Ro,k64:()=>Se,geU:()=>re,uze:()=>Qe,lSN:()=>Mt,At2:()=>Go,vEQ:()=>Pe,o2C:()=>Ne,iq2:()=>Xe,RNg:()=>De,H2A:()=>ke,$0$:()=>Oe,G7K:()=>Be,gnD:()=>Ue,EeR:()=>Je,vom:()=>$e,GqX:()=>He,tMD:()=>Fe,g6K:()=>tt,UaO:()=>Ye,w9F:()=>_e,cGu:()=>et,L_n:()=>ze,Xsz:()=>je,pRQ:()=>Ce,tmD:()=>oa,wQA:()=>Nt,Wuj:()=>Ya,_SP:()=>St,wBl:()=>wt,dA9:()=>qa,FYS:()=>Qn,GKX:()=>zt,SBS:()=>mn,BCo:()=>Yn,pBW:()=>Xt,vzv:()=>Dt,gPg:()=>Bt,GBi:()=>ce,v1l:()=>Le,REo:()=>_,LrR:()=>Rt,s9k:()=>Qt,$bq:()=>ja,ZAR:()=>it,qTy:()=>pt,tgf:()=>gt,JZX:()=>ia,am:()=>Bo,usH:()=>w,cz7:()=>Ea,GpD:()=>pe,vK$:()=>he,vCb:()=>ge,oVT:()=>be,J_:()=>Ja,O8_:()=>Ia,C6:()=>dn,etf:()=>Wo,jI5:()=>Io,TyP:()=>O,Dl1:()=>k,s2L:()=>Gt,zd8:()=>Wt,CGU:()=>ue,qJy:()=>kt,zf$:()=>Dn,kh6:()=>fa,AFi:()=>ta,tCt:()=>Ga,wyh:()=>le,rY0:()=>ca,yqt:()=>ma,_mi:()=>Te,Awf:()=>L,wpe:()=>ot,iAi:()=>go,lYv:()=>po,ZNg:()=>ho,T$f:()=>N,H_5:()=>fe,JMu:()=>st,BAK:()=>me,aFB:()=>bo,xZX:()=>ea,B8x:()=>We,Q11:()=>xa,B0c:()=>va,Slc:()=>Ua});var n=a(79458),o=a(99394),r=a(207545),i=a(241273),l=a(993821),s=a(47262),c=a(691097),d=a(479504);const u=!1,m={showDiscoverInsightsForShortQueries:{featureName:"Microsoft.Office.Excel.ShowDiscoverInsightsForShortQueries",defaultValue:!0},ConditionalFormattingConverter:{featureName:"Microsoft.Office.Excel.ConditionalFormattingConverter",defaultValue:!1},ExcelWorkflow:{featureName:"Microsoft.Office.Excel.ExcelWorkflow",defaultValue:!1},InsightsEndpointOverride:{featureName:"Microsoft.Office.Excel.InsightsEndpointOverride",defaultValue:""},CopilotUxRailsOverride:{featureName:"Microsoft.Office.Excel.CopilotUxRailsOverride",defaultValue:!0},CannedOdslDropdown:{featureName:"Microsoft.Office.Excel.CannedOdslDropdown",defaultValue:!1},CalculatedColumnsMaxRows:{featureName:"Microsoft.Office.Excel.CalculatedColumnsMaxRows",defaultValue:200},CalculatedColumnsMaxCells:{featureName:"Microsoft.Office.Excel.CalculatedColumnsMaxCells",defaultValue:2e3},CalculatedColumnsMaxPreviewRows:{featureName:"Microsoft.Office.Excel.CalculatedColumnsMaxPreviewRows",defaultValue:1024},AutofitSelectedRowsColumns:{featureName:"Microsoft.Office.Excel.AutofitSelectedRowsColumns",defaultValue:!0},NeverTimeout:{featureName:"Microsoft.Office.Excel.NeverTimeout",defaultValue:!1},CopilotInsertTable:{featureName:"Microsoft.Office.Excel.CopilotInsertTable",defaultValue:!1}},h="Microsoft.Office.SharedOnline.FA000000124.",g="Microsoft.Office.Shared.fa000000124.",p={AugLoopSessionClosedMessageCard:"OfficeVSO_8253114_AugLoopSessionClosedMessageCard",DefaultColorScales:"OfficeVSO_8317167_DefaultColorScales",CalculatedColumnsTLRSupport:"OfficeVSO_8329492_CalculatedColumnsTLRSupport"},b={showDiscoverInsightsForShortQueries:{featureName:"Microsoft.Office.Excel.FA000000124.ShowDiscoverInsightsForShortQueries",defaultValue:!0},enableForecasting:{featureName:"Microsoft.Office.Excel.FA000000124.EnableForecasting",defaultValue:!1},enableTextAnalysisCitation:{featureName:"Microsoft.Office.Excel.FA000000124.EnableTextAnalysisCitation",defaultValue:!1},enableQuickSummarization:{featureName:"Microsoft.Office.Excel.FA000000124.EnableQuickSummarization",defaultValue:!1},enableFullTheming:{featureName:"Microsoft.Office.Excel.FA000000124.EnableFullTheming",defaultValue:!1},enableHideAddToSheetButton:{featureName:"Microsoft.Office.Excel.FA000000124.EnableHideAddToSheetButton",defaultValue:!1},enableSentimentAnalysis:{featureName:"Microsoft.Office.Excel.FA000000124.EnableSentimentAnalysis",defaultValue:!1},useMetadataV2:{featureName:"Microsoft.Office.Excel.FA000000124.UseMetadataV2",defaultValue:!1},enableAdvancedTextAnalysis:{featureName:"Microsoft.Office.Excel.FA000000124.EnableAdvancedTextAnalysis",defaultValue:!1},enableDynamicPlanner:{featureName:"Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",defaultValue:!1},enableGPT4o20241120Model:{featureName:"Microsoft.Office.Excel.FA000000124.EnableGPT4o20241120Model",defaultValue:!1},useMetadataAML:{featureName:"Microsoft.Office.Excel.FA000000124.UseMetadataAML",defaultValue:!1},enableTextAnalysisSuggestionPill:{featureName:"Microsoft.Office.Excel.FA000000124.EnableTextAnalysisSuggestionPill",defaultValue:!1},useLLMFormula:{featureName:"Microsoft.Office.Excel.FA000000124.UseLLMFormula",defaultValue:!1}},f="Microsoft.Office.Excel.FA000000124.";function C(e){const{featureName:t,defaultValue:a}=m[e];if(u)switch(typeof a){case"boolean":return!0;case"string":return"";case"number":return 0;default:throw new Error("Flighting type must be a string, boolean, or integer")}const n=t.split(".").pop(),o=`${f}${n}`;switch(typeof a){case"boolean":return x(o,a);case"string":return S(o,a);case"number":return T(o,a);default:throw new Error("Flighting type must be a string, boolean, or integer")}}function y(e){return/^OfficeVSO_\d+_/.test(e)?x(`${f}${e}`,!0):x(`${f}${p[e]}`,!0)}function v(e,t=!1){return OfficeRuntime.experimentation.getBooleanFeatureGate(h+e,t)||OfficeRuntime.experimentation.getBooleanFeatureGate(g+e,t)}function x(e,t){return OfficeRuntime.experimentation.getBooleanFeatureGate(e,t)}function T(e,t){return OfficeRuntime.experimentation.getIntFeatureGate(e,t)}function S(e,t){return OfficeRuntime.experimentation.getStringFeatureGate(e,t)}function w(){return((0,r.I_)()||(0,r.B2)())&&(x("Microsoft.Office.Excel.FA000000124.EnableTestUi",!1)||x("Microsoft.Office.Excel.FA000000124.EnableUsingFluxSkillsDirectly",!1))}function E(){const e=Object.fromEntries(Object.entries(b).map((([e,t])=>{const{defaultValue:a,featureName:n}=t;switch(typeof a){case"boolean":return[e,x(n,a)];case"number":return[e,T(n,a)];case"string":return[e,S(n,a)];default:(0,s.x)(a)}})));return e.enableGPT4o20241120Model=function(){const e=o.V.getSettingAsString(o.z.InsightsEndpoint);return!("Insights.Https.GCC.Bundle"===e||"Insights.Https.DOD.Bundle"===e||"Insights.Https.GCCH.Bundle"===e)}(),function(e){const t=Microsoft.Office.WebExtension.FeatureGates;Object.keys(t).filter((e=>e.toLowerCase().startsWith("microsoft.office.excel.fa000000124.insights."))).forEach((a=>{const n=a.split(".").pop(),o=t[a];"true"===o.toLowerCase()||"false"===o.toLowerCase()?e[n]="true"===o.toLowerCase():isNaN(Number(o))?e[n]=o:e[n]=Number(o)}))}(e),e.enableLLMChartReco=!0,JSON.stringify(e)}const I=()=>!u&&"true"===(0,c.P)("CopilotSaveAutomation"),R=()=>!u&&"true"===(0,c.P)("CopilotPAIntegration");let A;const L=e=>{A=e},k=()=>A?A===i.ut.Enterprise:((0,n.cY)(n.SA.Warning,"isUserTypeOrganization: userType is not defined. Returning false."),!1),F=()=>A?A===i.ut.Consumer:((0,n.cY)(n.SA.Warning,"isUserTypeConsumer: userType is not defined. Returning false."),!1);function _(){return k()&&!(0,r.TB)()}function P(){return x("Microsoft.Office.Excel.FA000000124.AddinLocalPluginActionsEnabled",!1)}const N=()=>!1;function M(){return y("OfficeVSO_8910862_IsGroundingPhase2UxEnabled")}function O(){return M()&&y("OfficeVSO_8910862_isUserTypeCheckEnabled")}function D(){return M()&&k()||F()&&y("OfficeVSO_8910862_IsGroundingPhase2UxEnabledForConsumer")}function B(){return x("Microsoft.Office.Excel.FA000000124.IsEnableAppGptsInCIQ",!1)&&J()&&k()}function $(){return D()&&!(0,d.dD)()&&x("Microsoft.Office.Excel.FA000000124.ImportDataEnabledForSearch",!1)}function H(){return x("Microsoft.Office.Excel.FA000000124.EnableEnterpriseToggleInPhase2Ux",!1)}function U(){return x("Microsoft.Office.Excel.FA000000124.EnterpriseToggleInPhase2UxHiddenAndDisabled",!1)}function q(){return y("OfficeVSO_8910862_IsEnterpriseSearchDefaultOn")}function V(){return y("OfficeVSO_8910862_IsWebSearchDefaultOn")}function G(){return M()&&k()&&x("Microsoft.Office.Excel.FA000000124.IsCIQEnabled",!1)}function W(){return x("Microsoft.Office.Excel.FA000000124.IsCiqEnabledInDAs",!1)}function z(){return x("Microsoft.Office.Excel.FA000000124.CIQAttachmentList",!1)}function j(){return G()&&x("Microsoft.Office.Excel.FA000000124.IsCloudFileUploadEnabled",!1)}function Q(){return G()&&x("Microsoft.Office.Excel.FA000000124.IsLocalFileUploadEnabled",!1)}function J(){return x("Microsoft.Office.Excel.FA000000124.IsEnableAppGptsInCIQ",!1)}function Y(){return x("Microsoft.Office.Excel.FA000000124.IsEnableAppPluginsInCIQ",!1)}function X(){return x("Microsoft.Office.Excel.FA000000124.IsEnableAppMsgExtInCIQ",!1)}function Z(){return x("Microsoft.Office.Excel.FA000000124.IsEnableAppPPInCIQ",!1)}function K(){return x("Microsoft.Office.Excel.FA000000124.IsEnableAppTypeBInCIQ",!1)}function ee(){return x("Microsoft.Office.Excel.FA000000124.IsEnableTopicECC",!1)}function te(){return G()&&x("Microsoft.Office.Excel.FA000000124.EnablePluginSearchInFlyout",!1)}function ae(){return G()&&x("Microsoft.Office.Excel.FA000000124.EnableMorePluginHyperLinkInFlyout",!1)}function ne(){return M()&&"OfficeFirstParty"in window&&"Sensitivity"in OfficeFirstParty}function oe(){return y("OfficeVSO_9988652_IsAgentsLoggingEnabledInShared")}const re=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.OfficeJsCommanding",!1),ie=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.ChartContextJsonDOM",!1),le=()=>S("Microsoft.Office.Excel.FA000000124.ForceOfficeJsCommandingSkill",""),se=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.CommandingScratchpad",!1),ce=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.ScratchpadPassiveTesting",!1),de=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.EnableScratchpadInExcelAgent",!1),ue=()=>!(0,d.dD)(),me=()=>x("Microsoft.Office.Excel.FA000000124.showUndoButton",!0),he=()=>x("Microsoft.Office.Excel.FA000000124.IsTierTwoLocalizationEnabled",!1),ge=()=>x("Microsoft.Office.Excel.FA000000124.IsTierTwoRTLLocalizationEnabled",!1),pe=()=>x("Microsoft.Office.Excel.FA000000124.IsTierTwoPointFiveLocalizationEnabled",!1),be=()=>x("Microsoft.Office.Excel.FA000000124.IsTierThreeLocalizationEnabled",!1),fe=()=>y("OfficeVSO_9680114_LoadStringsEarly"),Ce=()=>y("OfficeVSO_8996286_reenablingRehydration"),ye=()=>y("OfficeVSO_9043928_AlwaysSendCellsToCCSignal"),ve=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.CFResponseCardShowFormulaExplanation",!1),xe=()=>x("Microsoft.Office.Excel.FA000000124.doNotResolveTableForHybridCCEnabled",!1),Te=()=>y("OfficeVSO_9117932_calculatedColumnsUseTablesFromSignal"),Se=()=>y("OfficeVSO_9473972_OdslCommandingHumanInTheLoop"),we=()=>y("OfficeVSO_9473973_ConditionalFormattingResponseCardWithSample"),Ee=()=>y("OfficeVSO_9473975_ConditionalFormattingCustomFormula"),Ie=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.DataShaping",!1),Re=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.DataShapingAgent",!1),Ae=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaRepairExplainContext",!1),Le=()=>x("Microsoft.Office.Excel.FA000000124.SelfHelpSearchRenderingEnabled",!1),ke=()=>F()&&x("Microsoft.Office.Excel.FA000000124.AugLoop.EnablePythonAaForConsumers",!1)||x("Microsoft.Office.Excel.FA000000124.PythonAdaInCopilot",!1),Fe=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.EnablePythonInteractiveCharts",!1),_e=()=>x("Microsoft.Office.Excel.FA000000124.EnablePythonManualPrompt",!1),Pe=()=>!Ne()&&x("Microsoft.Office.Excel.FA000000124.IsPython30SecondsWave1",!1),Ne=()=>x("Microsoft.Office.Excel.FA000000124.IsPython30SecondsWave2",!1),Me=()=>x("Microsoft.Office.Excel.FA000000124.PythonAAAddScrollingFreeze",!1),Oe=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAdaInExcelOnline",!1),De=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAASuggestionState",!1),Be=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAdaInMac",!1),$e=()=>x("Microsoft.Office.Excel.FA000000124.PythonCalculatedColumns",!1),He=()=>x("Microsoft.Office.Excel.FA000000124.PythonEditInPlace",!1),Ue=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.PythonAdaO1AsPlanner",!1),qe=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAAFallback",!1),Ve=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAAInsert",!1),Ge=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAAZQM",!1),We=()=>Ge(),ze=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.EnablePythonStatusResponseChunk",!1),je=()=>x("Microsoft.Office.Excel.FA000000124.EnablePythonStatusResponseChunkShowMessage",!1);function Qe(){return x("Microsoft.Office.Excel.FA000000124.OtherPythonAACellsOptimization",!1)}const Je=()=>x("Microsoft.Office.Excel.FA000000124.PythonAnalysisSheetMetadataEnabled",!1),Ye=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.PythonLosslessChatHistoryConversion",!0),Xe=()=>x("Microsoft.Office.Excel.FA000000124.PythonAAStartAnalysisButtonGreenExperiment",!1);function Ze(){return qe()&&x("Microsoft.Office.Excel.FA000000124.AugLoop.AnalyzeDataFallbackToPython",!1)}function Ke(){return x("Microsoft.Office.Excel.FA000000124.ConnectOfficePySvcToExecutePythonCode",!1)}function et(){return x("Microsoft.Office.Excel.FA000000124.PythonRemoveInsertToDetailSheetButtonEnabled",!1)}const tt=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.EnablePythonInteractiveChartsMaa",!1),at=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.IsMAAOutputMetadataFormatEnabled",!1),nt=()=>{const e=x("Microsoft.Office.Excel.FA000000124.AugLoop.IsDiceBerryForMAAEnabled",!1),t=y(" OfficeVSO_10354151_FormatDiceberryOutput_ChangeGate"),a=x("Microsoft.Office.Excel.FA000000124.AugLoop.ModelessPythonAA",!1);return(qe()||a)&&e&&t},ot=()=>qe()&&y("OfficeVSO_10356778_AddAnswersZQM");function rt(){const e={IsPythonAdaInCopilotEnabled:ke(),IsPythonManualPromptEnabled:_e(),IsPython30SecondsWave1:Pe(),IsPython30SecondsWave2:Ne(),IsAddScrollingFreezeEnabled:Me(),IsPythonAdaInExcelOnlineEnabled:Oe(),IsPythonAASuggestionStateEnabled:De(),IsPythonAdaInMacEnabled:Be(),IsPythonAdaO1AsPlannerEnabled:Ue(),IsPythonInteractiveChartEnabled:Fe(),IsPythonEditInPlaceEnabled:He(),IsModelessPythonAAFallbackFlightEnabled:qe(),IsPythonAAStartAnalysisButtonGreenExperimentEnabled:Xe(),IsAnalyzeDataFallbackToPythonEnabled:Ze(),IsConnectOfficePySvcToExecutePythonCodeEnabled:Ke(),IsPythonRemoveInsertToDetailSheetButtonEnabled:et(),isModelessPythonAAInsertFlightEnabled:Ve(),isOtherPythonCellsOptimizationEnabled:Qe(),IsPythonAnalysisSheetMetadataEnabled:Je(),isPythonInteractiveChartsEnabledMaa:tt(),isModelessPythonAAZQMEnabled:Ge(),isMAAOutputMetadataFormatEnabled:at(),isModelessPythonAADiceBerryEnabled:nt()};return JSON.stringify(e)}const it=()=>gt()&&x("Microsoft.Office.Excel.FA000000124.AugLoop.TableFreeCopilot",!1),lt=()=>it(),st=()=>it(),ct=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.Copilot.WholeWorkbookContext",!1),dt=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.Copilot.ExcelAgent",!1),ut=()=>x("Microsoft.Office.Excel.FA000000124.AugLoop.CatalystExcelAgentDirectJS",!1),mt=()=>x("Microsoft.Office.Excel.FA000000124.DevDiagButton",!1),ht=()=>y("OfficeVSO_9412591_telemetryDevButton")&&(0,r.I_)(),gt=()=>y("OfficeVSO_9694412_CleanUpTLRImprovementsGate")||x("Microsoft.Office.Excel.FA000000124.AugLoop.TLRImprovements",!1),pt=()=>y("OfficeVSO_9796513_CleanUpTLRAutoFixGate")||x("Microsoft.Office.Excel.FA000000124.TLRAutoFix",!1),bt=()=>y("OfficeVSO_9876590_SendAugLoopErrorAnnotationWithChatResponse");function ft(e,t){return yt(e,t)}function Ct(e,t){return yt(e,t)}function yt(e,t){const a=S(e,JSON.stringify(t));try{return JSON.parse(a)}catch(e){return t}}function vt(){return y("OfficeVSO_9231431_ElseZQM")}const xt=()=>k()||x("Microsoft.Office.Excel.FA000000124.isChatHistoryV2EnabledForConsumer",!1)&&F(),Tt=()=>y("OfficeVSO_9489189_xlCopilotAppChatHandoff");function St(){return x("Microsoft.Office.Excel.FA000000124.isReviewerAgentEnabled",!1)}function wt(){return St()&&x("Microsoft.Office.Excel.FA000000124.isReviewerAgentToggleEnabled",!1)}function Et(){return y("OfficeVSO_9845131_FormulaSuggestionsInvalidation")}function It(){return x("Microsoft.Office.Excel.FA000000124.IsMsgExtEnabled",!1)&&k()}function Rt(){return y("OfficeVSO_9298835_SeparateLocaleInfoFromSelection")}const At=()=>x("Microsoft.Office.Excel.FA000000124.IsImageInputEnabled",!1),Lt=()=>x("Microsoft.Office.Excel.FA000000124.IsPasteFromClipboardButtonEnabled",!1);function kt(){return x("Microsoft.Office.Excel.FA000000124.IsZQMEarlyLoadAndSessionStorageForChatHistoryEnabled",!1)}function Ft(){return x("Microsoft.Office.Excel.FA000000124.enableProactiveZQMWith3SAPISuggestions",!1)}function _t(){return x("Microsoft.Office.Excel.FA000000124.enableProactiveZQMWithSuggestedQnA",!1)}function Pt(){return x("Microsoft.Office.Excel.FA000000124.disableALAnnotationsOnPreload",!1)}function Nt(){return x("Microsoft.Office.Excel.FA000000124.isRenderOnPreloadEnabled",!0)}function Mt(){return x("Microsoft.Office.Excel.FA000000124.isPrefetchOnPreloadEnabled",!1)}function Ot(){return x("Microsoft.Office.Excel.FA000000124.IsCustomGPTsEnabled",!1)&&k()}function Dt(){return x("Microsoft.Office.Excel.FA000000124.IsSccReadAloudAugloopEnabled",!0)}function Bt(){if(!(0,r.I_)()&&!(0,r.B2)()&&!(0,r.xC)())return!1;return!!x("Microsoft.Office.Excel.FA000000124.IsSccReadAloudEnabled",!0)&&(k()||Dt())}function $t(){return v("EnableM365CopilotChatStarter",!1)||v("EnableM365CopilotChat",!1)}function Ht(){return($t()||tn())&&v("IsAppChatRebrandingEnabled",!1)}function Ut(){return x("Microsoft.Office.Excel.FA000000124.EnableQueryEndOnGptSwitch",!1)&&k()}function qt(){return k()}function Vt(){return k()}function Gt(){return x("Microsoft.Office.Excel.FA000000124.IsViewMorePromptsIconV2Enabled",!1)}function Wt(){return x("Microsoft.Office.Excel.FA000000124.IsViewMorePromptsOneClickEnabled",!0)}function zt(){return x("Microsoft.Office.Excel.FA000000124.RotatingZQM",!1)}function jt(){return x("Microsoft.Office.Excel.FA000000124.EnableCIQGlowUpVisualRefresh",!1)}function Qt(){return x("Microsoft.Office.Excel.FA000000124.IsSettingsPanelOnSwitcherMenuEnabled",!1)}function Jt(){return y("OfficeVSO_3557215_IsApiPluginsCardsEnabled")}function Yt(){return y("OfficeVSO_9446244_IsFluentV9TaskPaneTabBehaviorEnabled")}function Xt(){return x("Microsoft.Office.Excel.FA000000124.IsSavePromptEnabled",!1)}function Zt(){return y("OfficeVSO_3557154_EnableInterstitialConfirmation")}function Kt(){return y("OfficeVSO_3557154_EnableInterstitialAuthentication")}function ea(){return y("OfficeVSO_3557154_ShouldUseMsalGetTokenRequestCaching")}function ta(){return y("OfficeVSO_3557154_LoadGptListOnCopilotIconClick")}function aa(){return y("OfficeVSO_3557154_IsDAOutputV2Enabled")}function na(){return y("OfficeVSO_3557154_IsDACopilotBrandingEnabled")}function oa(){return y("OfficeVSO_3557417_RenameToAgentsEnabled")}function ra(){return y("OfficeVSO_3557417_DisableClientConfigQueryCharacterForEditorService")}function ia(){return x("Microsoft.Office.Excel.FA000000124.IsTableLikeRangeProgressEnabled",!1)}function la(){return x("Microsoft.Office.Excel.FA000000124.IsHandoffButtonEnabled",!1)}function sa(){return y("OfficeVSO_10105240_IsHandoffRTLEnabled")}function ca(){return e="Microsoft.Office.Excel.FA000000124.OpenInWordMinimumForHeuristic",t=5,OfficeRuntime.experimentation.getIntFeatureGate(e,t);var e,t}function da(){return x("Microsoft.Office.Excel.FA000000124.IsHandoffBookendingEnabled",!1)}function ua(){return y("OfficeVSO_10082702_AppValueChecksForBookending")}function ma(){return x("Microsoft.Office.Excel.FA000000124.RenderChatHistoryInHandoffDestination",!1)}function ha(){return x("Microsoft.Office.Excel.FA000000124.IsHandoffLoadingPageEnabled",!1)}function ga(){return x("Microsoft.Office.Excel.FA000000124.isALHookEnabled",!1)}function pa(){return x("Microsoft.Office.Excel.FA000000124.IsHandoffGetAnnotationsEnabled",!1)}function ba(){return x("Microsoft.Office.Excel.FA000000124.IsHandoffInteractiveSummaryAndContentCallbackEnabled",!1)}function fa(){return S("Microsoft.Office.Excel.FA000000124.LaunchThisVersionOfSDX","")}const Ca=()=>x("Microsoft.Office.Excel.FA000000124.DisableFooterActionsForAdaptiveCard",!1);function ya(){return y("OfficeVSO_9628072_GenerateVisibleRow")}const va=()=>x("Microsoft.Office.Excel.FA000000124.ShowAgentMenuNudgeAndTooltip",!1),xa=()=>x("Microsoft.Office.Excel.FA000000124.ShowAgentMenuExploreBadge",!0);function Ta(){return x("Microsoft.Office.Excel.FA000000124.IsCitationSupportForAvalonEnabled",!1)&&k()}function Sa(){return x("Microsoft.Office.Excel.FA000000124.IsALRequestResponseEnabled",!1)}function wa(){return x("Microsoft.Office.Excel.FA000000124.ChartStylesRecommendation",!1)}function Ea(){return x("Microsoft.Office.Excel.FA000000124.isTextDirectionEnabled",!1)}function Ia(){return x("Microsoft.Office.Excel.FA000000124.IsUploadImageFromPhoneEnabled",!1)}function Ra(){return S("Microsoft.Office.Excel.FA000000124.ImageUploadEndpoint","")}function Aa(){return x("Microsoft.Office.Excel.FA000000124.EnableSystemMessageActions",!1)&&k()}function La(){return y("OfficeVSO_10172346_enableSwitcherMenuV2")}function ka(){return x("Microsoft.Office.Excel.FA000000124.EnableAgentsBasedOnSkill",!1)}function Fa(){return x("Microsoft.Office.Excel.FA000000124.EnableAgentWithBizChatProfileType",!1)}function _a(){return x("Microsoft.Office.Excel.FA000000124.EnableAgentsWithFluxV3",!1)}function Pa(){return x("Microsoft.Office.Excel.FA000000124.EnableMultiAccessDisablementCheck",!1)}function Na(){return y("OfficeVSO_9623025_IsCodeInterpreterEnabled")}function Ma(){return x("Microsoft.Office.Excel.FA000000124.IsCodeInterpreterEnabledForDefaultCopilot",!1)}function Oa(){return y("OfficeVSO_9623025_IsCodePreviewEnabled")&&Na()}function Da(){return x("Microsoft.Office.Excel.FA000000124.EnableLocalCUAAgent",!1)}function Ba(){return y("OfficeVSO_10172346_IsEnableAppAgentsInCiqOverride")}const $a=()=>y("OfficeVSO_9473972_IsDABrandingRefactorEnabled");function Ha(){return x("Microsoft.Office.Excel.FA000000124.IsClickButtonStyleHamburgerEnabled",!1)}function Ua(){return x("Microsoft.Office.Excel.FA000000124.showPromptSuggestionsWithOutput",!1)}function qa(){return x("Microsoft.Office.Excel.FA000000124.IsRichAPIForAcquirePluginsEnabled",!1)&&Office.context.requirements.isSetSupported("unifiedstoreservice","1.1")}function Va(){return qa()?T("Microsoft.Office.Excel.FA000000124.DelayTimeForAgentSwitch",2e3):0}function Ga(){return qa()?T("Microsoft.Office.Excel.FA000000124.MosAgentInstallTimeout",7e3):0}function Wa(){return y("OfficeVSO_9623025_EnableSwitchToAgentPostLoad")&&qa()}function za(){return Ua()&&x("Microsoft.Office.Excel.FA000000124.DisableSuggestionPromptsWithZeroQueryInteraction",!1)}function ja(){return x("Microsoft.Office.Excel.FA000000124.EnableStopGeneratingButtonInChatInput",!1)}function Qa(){return y("OfficeVSO_9987285_UseResponsiveSystemMessage")}const Ja=()=>x("Microsoft.Office.Excel.FA000000124.IsTierFourLocalizationEnabled",!1);function Ya(){return x("Microsoft.Office.Excel.FA000000124.isResponseDoubleBrandingHidden",!1)}function Xa(){return x("Microsoft.Office.Excel.FA000000124.IsLatencyArrowEnabled",!1)}function Za(){return T("Microsoft.Office.Excel.FA000000124.MaxDocumentSearchPivotTableCount",250)}function Ka(){return T("Microsoft.Office.Excel.FA000000124.MaxDocumentSearchChartCount",500)}function en(){return k()&&x("Microsoft.Office.Excel.FA000000124.EnableBizChat",!1)}function tn(){return x("Microsoft.Office.Excel.FA000000124.EnableBizChatInAppChat",!1)}function an(){return y("OfficeVSO_10250099_EnableBizChatAgentsInAppChat")}function nn(){return x("Microsoft.Office.Excel.FA000000124.EnableImplicitContextForBizChatInAppChat",!0)}function on(){return x(f+"EnableCatalystContextualPrompts",!1)}function rn(){return S(f+"M365ChatCdnVersion","")}function ln(){return S(f+"M365ChatDeploymentRing","")}function sn(){return S(f+"M365ChatDeploymentEnvironment","")}function cn(){return x(f+"EnableM365EcsProvidedProps",!1)}function dn(){return x(f+"UseM365ChatAppVersionEcsProject",!1)}function un(){return y("OfficeVSO_10250099_EnableBizInAppChatScenarioName")}function mn(){return x("Microsoft.Office.Excel.FA000000124.IsSafeLinksEnabled",!1)}function hn(){return x("Microsoft.Office.Excel.FA000000124.EnableBizChatInAppAuthDialog",!0)}function gn(){return x("Microsoft.Office.Excel.FA000000124.EnableM365ChatLogger",!0)}function pn(){return x("Microsoft.Office.Excel.FA000000124.EnableBizChatHideShimmerMessageEvent",!0)}function bn(){return x(f+"EnableBizchatNestedAppAuthSupport",!0)}function fn(){return x(f+"EnableBizchatHostContext",!0)}function Cn(){return x(f+"EnableM365ChatEligibilityCheck",!0)}function yn(){return x(f+"EnableM365ChatEligibilityCache",!0)}function vn(){return x(f+"EnableBizChatFeedbackCompliancePolicyFetching",!0)}function xn(){return x(f+"EnableBizChatDefaultFeedbackAppId",!0)}function Tn(){return y("OfficeVSO_10271447_EnableOcpsPolicyFetching")}function Sn(){return x(f+"EnableBizChatInAppSettings",!1)}function wn(){return x(f+"EnableBizChatOtelLogger",!0)}function En(){return x(f+"EnableBizChatInteractiveApiOnTtfr",!0)}function In(){return y("OfficeVSO_10293336_EnableLocalFileMessageBanner")}function Rn(){return y("OfficeVSO_10293342_EnableFileAccessMessageBanner")}function An(){return x(f+"EnableBizChatIdsInOtelLog",!0)}function Ln(){return x(f+"EnableBizChatPerfOtelLog",!0)}function kn(){return x(f+"EnableWaitForM365ChatEcsSettings",!0)}function Fn(){return x(f+"EnableM365ChatRehydration",!0)}function _n(){return T(f+"M365ChatEcsSettingTimeout",2e3)}function Pn(){return x(f+"EnableIsEuCheck",!0)}function Nn(){return S(f+"HrdServiceProviderId","174")}function Mn(){return x(f+"EnableBizChatInAppAuthDialogV2",!0)}function On(){return x(f+"EnableKeepAliveForALSessionV2",!1)}function Dn(){return T(f+"KeepAliveForALSessionIntervalInSecond",60)}function Bn(){return x("Microsoft.Office.Excel.FA000000124.EnableSPOFileIdForCloudFiles",!1)}function $n(){return x(f+"EnableOcpsLogging",!0)}function Hn(){return x(f+"EnableEligibilityTelemetry",!0)}function Un(){return x(f+"ForceDfSydney",!1)}function qn(){return x(f+"IsInsertImageEnabledForDesignerInCatalyst",!1)}function Vn(){return x(f+"EnableBizChatAuthTelemetry",!0)}function Gn(){return x(f+"EnableBizChatInfiniteAuthShimmerFix",!0)}function Wn(){return x(f+"EnableBizChatPuidCompliantCheck",!0)}function zn(){return y("OfficeVSO_10315251_EnableFetchImplicitQueryAnnotations")}function jn(){return x(f+"EnableEcsSettingWaitOnExpiredCache",!0)}function Qn(){return x(f+"EnableBizChatRingSwitcher",!1)}function Jn(){return x(f+"EnableBizChatInactiveLog",!0)}function Yn(){return x("Microsoft.Office.Excel.FA000000124.IsSafeLinksNonLegacyUrlEnabled",!1)}function Xn(){return x(f+"EnableBizChatPairwiseBrokerSupport",!1)}function Zn(){return T(f+"M365ChatPairwiseBrokerHandshakeTimeout",5e3)}function Kn(){return y("OfficeVSO_10267314_EnableAccessibilityContrastColorTheme")}function eo(){return x(f+"EnableBizchatEcsSettingsTelemetry",!0)}function to(){return x(f+"EnableIsDevLog",!0)}function ao(){return x(f+"EnableM365AuthLiveUrlHandling",!0)}function no(){return x(f+"EnableM365ChatWaitForBroker",!0)}function oo(){return x(f+"EnableM365ChatTokenPrefetch",!0)}function ro(){return x(f+"EnableM365ChatHandleAuthBackgroundVisibility",!0)}function io(){return x(f+"EnableM365ChatHandleBackgroundVisibilityForRequests",!0)}function lo(){return T(f+"M365ChatPairwiseBrokerConnectionTimeout",3e3)}function so(){return x(f+"EnableM365ChatTrustedDomainForPairwise",!0)}function co(){return x(f+"EnableM365ChatReuseSameRedirectUriForNaa",!0)}function uo(){return x(f+"IsHandoffToBizChatEnabled",!0)}function mo(){return x(f+"HandoffPrivateApiEnabled",!1)&&k()&&((0,l.gt)()||en()||tn())&&x(f+"HandoffALBridgeEnabled",!0)}function ho(){return x(f+"FallbackHandoffsToAppChat",!1)}function go(){return x(f+"ShouldCheckUserLicense",!1)}function po(){return x(f+"ShouldDefaultToBizChat",!0)}function bo(){return x(f+"UseHandoffMessagePropertiesValue",!0)}function fo(){return x(f+"EnableCopilotStarterBizChat",!1)}function Co(){return x(f+"EnableBizChatNativePerfMark",!1)}function yo(){return x(f+"EnableAppChatMsalUpnFix",!1)}function vo(){return T(f+"EligibilityCacheDurationMs",864e5)}function xo(){return v("EnableM365CopilotForConsumers",!1)}function To(){return $t()&&y("OfficeVSO_10391844_EnableAgentSwitchInCatalyst")}function So(){return x(f+"EnableNovaEventingProvider",!1)}function wo(){return x(f+"EnableM365ChatAuthWaitForRaf",!1)}function Eo(){return x(f+"enableM365ChatUseBackupResourceScopes",!0)}function Io(){return x(f+"EnableUsePlumbedHostAccountInfo",!0)}function Ro(){return x(f+"EnableOcpsTokenProviderLogFix",!0)}function Ao(){return x(f+"FallbackToastEnabled",!1)}function Lo(){return x(f+"BizChatFallbackToastDisabled",!1)}function ko(){const e=T(f+"CommandingChatLogLevel",0);return Math.max(0,Math.min(e,2))}function Fo(){return S(f+"OpenAIApiKey","")}function _o(){return S(f+"AnthropicClaudeModel","3.7")}function Po(){return S(f+"LocalMCPServerURL","")}function No(){return x(f+"EnableOfficeJSTool",!1)}function Mo(){return S(f+"AnthropicKeyTicket","")}function Oo(){return x(f+"AWSAnthropic",!0)}function Do(){const e=S(f+"OfficeJSToolDescription","");if(e.length>0)return e}function Bo(){return x(f+"EnableTeamsDeeplyNestedAppAuthSupport",!1)}function $o(){return x(f+"EnableCatalystConsumerToPacman",!1)}function Ho(){return x(f+"EnableM365ChatAuthTreatFallbackAsFatalError",!0)}function Uo(){return x(f+"EnableM365ChatAuthHandleNonInteractiveFatalErrors",!0)}function qo(){return x(f+"EnableM365ChatFatalErrorCallback",!0)}function Vo(){return T(f+"ChartDesignsRecommendationsResponseTimeoutInMillisecond",6e4)}function Go(){return x(f+"EnableProvideDynamicScreenshot",!0)}function Wo(){return x(f+"EnableUseM365ChatDevMode",!0)}function zo(){return x(f+"EnableClientSelectionContext",!1)}},530495:(e,t,a)=>{"use strict";a.d(t,{MH:()=>n,Ml:()=>o,Tq:()=>c,uS:()=>d});const n="synchronous";function o(e){if(e){const t=e.storageScript.apiInfo;if(t){return JSON.parse(t)}}}const r=1,i=1,l=2;function s(e){if(e){const{variantVersion:a}=e;if(void 0!==a&&"number"==typeof(t=a)&&Number.isInteger(t)&&t>=0)return a}var t;return 0}async function c(e){const t=s(e);return{enableNoImplicitAny:t>=r,enableNoIdentifiersPassedToArrayMethodCallbacks:t>=i,enableNoImplicitAnyAssignment:t>=l}}async function d(e){return c(o(e))}},533972:(e,t,a)=>{"use strict";a.d(t,{g:()=>n});class n{static hslFromRgb(e){const t=(e>>16&255)*this.maxHslValue/this.maxRGBValue,a=(e>>8&255)*this.maxHslValue/this.maxRGBValue,n=(255&e)*this.maxHslValue/this.maxRGBValue,o=Math.max(t,Math.max(a,n)),r=Math.min(t,Math.min(a,n)),i=o+r,l=o-r;let s,c;const d=i/2;return 0===l?(s=0,c=0):(c=l*this.maxHslValue/(d<=this.maxHslValue/2?i:2*this.maxHslValue-i),s=t===o?(a-n)*(this.maxHslValue/6)/l:a===o?this.maxHslValue/3+(n-t)*(this.maxHslValue/6)/l:2*this.maxHslValue/3+(t-a)*(this.maxHslValue/6)/l,s<0?s+=this.maxHslValue:s>this.maxHslValue&&(s-=this.maxHslValue)),[s,c,d]}static colorNameFromHEX(e,t=!1){if(!e)return;if(!t&&e in n.HexColorMap)return n.HexColorMap[e]();let a,o,r;const i=parseInt("0x"+e.slice(1,7),16);if([a,o,r]=this.hslFromRgb(i),a=255*a/this.maxHslValue,r=255*r/this.maxHslValue,o=255*o/this.maxHslValue,r>240)return ExcelCopilotCommandingHitlStrings.ColorWhite;if(r<20)return ExcelCopilotCommandingHitlStrings.ColorBlack;if(o<=20)return t?ExcelCopilotCommandingHitlStrings.ColorGray:r>170?ExcelCopilotCommandingHitlStrings.ColorLightGray:r>100?ExcelCopilotCommandingHitlStrings.ColorGray:ExcelCopilotCommandingHitlStrings.ColorDarkGray;let l;l=o>20&&o<=75?n.HueLimitsForSatLevel1:o>75&&o<=115?n.HueLimitsForSatLevel2:o>115&&o<=150?n.HueLimitsForSatLevel3:o>150&&o<=240?n.HueLimitsForSatLevel4:n.HueLimitsForSatLevel5;let s=0;for(;s<l.length&&a>=l[s];)s++;return s!==l.length?t?n.ColorNamesMid[s]():r>n.LumLimitsForHueIndexHigh[s]?n.ColorNamesLight[s]():r<n.LumLimitsForHueIndexLow[s]?n.ColorNamesDark[s]():n.ColorNamesMid[s]():void 0}}n.HexColorMap={"#FFBF00":()=>ExcelCopilotCommandingHitlStrings.ColorAmber,"#F5F5DC":()=>ExcelCopilotCommandingHitlStrings.ColorBeige,"#000000":()=>ExcelCopilotCommandingHitlStrings.ColorBlack,"#5A8AC6":()=>ExcelCopilotCommandingHitlStrings.ColorBlue,"#73d8ff":()=>ExcelCopilotCommandingHitlStrings.ColorBlue,"#CD7F32":()=>ExcelCopilotCommandingHitlStrings.ColorBronze,"#964B00":()=>ExcelCopilotCommandingHitlStrings.ColorBrown,"#c45100":()=>ExcelCopilotCommandingHitlStrings.ColorBrown,"#E1C699":()=>ExcelCopilotCommandingHitlStrings.ColorBrown,"#3B2F2F":()=>ExcelCopilotCommandingHitlStrings.ColorBrunette,"#800020":()=>ExcelCopilotCommandingHitlStrings.ColorBurgundy,"#36454F":()=>ExcelCopilotCommandingHitlStrings.ColorCharcoal,"#4B3621":()=>ExcelCopilotCommandingHitlStrings.ColorMocha,"#FF7F50":()=>ExcelCopilotCommandingHitlStrings.ColorCoral,"#DC143C":()=>ExcelCopilotCommandingHitlStrings.ColorCrimson,"#00FFFF":()=>ExcelCopilotCommandingHitlStrings.ColorCyan,"#00008B":()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlue,"#A9A9A9":()=>ExcelCopilotCommandingHitlStrings.ColorDarkGray,"#006400":()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,"#4B0082":()=>ExcelCopilotCommandingHitlStrings.ColorDarkPurple,"#8B0000":()=>ExcelCopilotCommandingHitlStrings.ColorDarkRed,"#50C878":()=>ExcelCopilotCommandingHitlStrings.ColorEmerald,"#FFD700":()=>ExcelCopilotCommandingHitlStrings.ColorGold,"#808080":()=>ExcelCopilotCommandingHitlStrings.ColorGray,"#194d33":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#63BE7B":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#808900":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#b0bc00":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#b0bf1a":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#cddf19":()=>ExcelCopilotCommandingHitlStrings.ColorGreen,"#E6E6FA":()=>ExcelCopilotCommandingHitlStrings.ColorLavender,"#FFF44F":()=>ExcelCopilotCommandingHitlStrings.ColorLemonYellow,"#ADD8E6":()=>ExcelCopilotCommandingHitlStrings.ColorLightBlue,"#D3D3D3":()=>ExcelCopilotCommandingHitlStrings.ColorLightGray,"#DABDE4":()=>ExcelCopilotCommandingHitlStrings.ColorLightPurple,"#C8A2C8":()=>ExcelCopilotCommandingHitlStrings.ColorLilac,"#00FF00":()=>ExcelCopilotCommandingHitlStrings.ColorLime,"#FF00FF":()=>ExcelCopilotCommandingHitlStrings.ColorMagenta,"#800000":()=>ExcelCopilotCommandingHitlStrings.ColorMaroon,"#E0B0FF":()=>ExcelCopilotCommandingHitlStrings.ColorMauve,"#FFDB58":()=>ExcelCopilotCommandingHitlStrings.ColorMustard,"#000080":()=>ExcelCopilotCommandingHitlStrings.ColorNavyBlue,"#808000":()=>ExcelCopilotCommandingHitlStrings.ColorOliveGreen,"#fb9e00":()=>ExcelCopilotCommandingHitlStrings.ColorOrange,"#FCBF7B":()=>ExcelCopilotCommandingHitlStrings.ColorOrange,"#fe9200":()=>ExcelCopilotCommandingHitlStrings.ColorOrange,"#FFDAB9":()=>ExcelCopilotCommandingHitlStrings.ColorPeach,"#CCCCFF":()=>ExcelCopilotCommandingHitlStrings.ColorPeriwinkle,"#fda1ff":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#FF9994":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#FFC0CB":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#FFC7CE":()=>ExcelCopilotCommandingHitlStrings.ColorPink,"#DDA0DD":()=>ExcelCopilotCommandingHitlStrings.ColorPlum,"#58427C":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#800080":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#9370DB":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#ab149e":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#aea1ff":()=>ExcelCopilotCommandingHitlStrings.ColorPurple,"#A52A2A":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#b10000":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#DB2D43":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#E74C3C":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#F8696B":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#FF0044":()=>ExcelCopilotCommandingHitlStrings.ColorRed,"#E0115F":()=>ExcelCopilotCommandingHitlStrings.ColorRuby,"#8B2500":()=>ExcelCopilotCommandingHitlStrings.ColorRust,"#F4C430":()=>ExcelCopilotCommandingHitlStrings.ColorSaffron,"#FA8072":()=>ExcelCopilotCommandingHitlStrings.ColorSalmon,"#0F52BA":()=>ExcelCopilotCommandingHitlStrings.ColorSapphire,"#2E8B57":()=>ExcelCopilotCommandingHitlStrings.ColorSeaGreen,"#C0C0C0":()=>ExcelCopilotCommandingHitlStrings.ColorSilver,"#87CEEB":()=>ExcelCopilotCommandingHitlStrings.ColorSkyBlue,"#D2B48C":()=>ExcelCopilotCommandingHitlStrings.ColorTan,"#008080":()=>ExcelCopilotCommandingHitlStrings.ColorTeal,"#40E0D0":()=>ExcelCopilotCommandingHitlStrings.ColorTurquoise,"#EE82EE":()=>ExcelCopilotCommandingHitlStrings.ColorViolet,"#FCFCFF":()=>ExcelCopilotCommandingHitlStrings.ColorWhite,"#FFFFFF":()=>ExcelCopilotCommandingHitlStrings.ColorWhite,"#fcc400":()=>ExcelCopilotCommandingHitlStrings.ColorYellow,"#FFEF9C":()=>ExcelCopilotCommandingHitlStrings.ColorYellow,"#FFFF00":()=>ExcelCopilotCommandingHitlStrings.ColorYellow},n.ColorNamesLight=[()=>ExcelCopilotCommandingHitlStrings.ColorLightOrange,()=>ExcelCopilotCommandingHitlStrings.ColorPink,()=>ExcelCopilotCommandingHitlStrings.ColorLightOrange,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorLightYellow,()=>ExcelCopilotCommandingHitlStrings.ColorLightYellow,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorLightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorLightBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorPaleBlue,()=>ExcelCopilotCommandingHitlStrings.ColorLightBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorLightPurple,()=>ExcelCopilotCommandingHitlStrings.ColorLightPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPink,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorRed],n.ColorNamesMid=[()=>ExcelCopilotCommandingHitlStrings.ColorOrange,()=>ExcelCopilotCommandingHitlStrings.ColorRed,()=>ExcelCopilotCommandingHitlStrings.ColorOrange,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorTan,()=>ExcelCopilotCommandingHitlStrings.ColorGold,()=>ExcelCopilotCommandingHitlStrings.ColorYellow,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBrightGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGray,()=>ExcelCopilotCommandingHitlStrings.ColorPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPink,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorRed],n.ColorNamesDark=[()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkRed,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkYellow,()=>ExcelCopilotCommandingHitlStrings.ColorDarkYellow,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlueGreen,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlue,()=>ExcelCopilotCommandingHitlStrings.ColorDarkBlue,()=>ExcelCopilotCommandingHitlStrings.ColorBlueGray,()=>ExcelCopilotCommandingHitlStrings.ColorDarkPurple,()=>ExcelCopilotCommandingHitlStrings.ColorDarkPurple,()=>ExcelCopilotCommandingHitlStrings.ColorPurple,()=>ExcelCopilotCommandingHitlStrings.ColorBrown,()=>ExcelCopilotCommandingHitlStrings.ColorDarkRed],n.maxRGBValue=255,n.maxHslValue=6*n.maxRGBValue,n.HueLimitsForSatLevel1=[8,0,0,44,0,0,0,63,0,0,122,0,134,0,0,0,0,166,176,241,0,256,0],n.HueLimitsForSatLevel2=[0,10,0,32,46,0,0,0,61,0,106,0,136,144,0,0,0,158,166,241,0,0,256],n.HueLimitsForSatLevel3=[0,8,0,0,39,46,0,0,0,71,120,0,131,144,0,0,163,0,177,211,249,0,256],n.HueLimitsForSatLevel4=[0,11,26,0,0,38,45,0,0,56,100,121,129,0,140,0,180,0,0,224,241,0,256],n.HueLimitsForSatLevel5=[0,13,27,0,0,36,45,0,0,59,118,0,127,136,142,0,185,0,0,216,239,0,256],n.LumLimitsForHueIndexLow=[130,100,115,100,100,100,110,75,100,90,100,100,100,100,80,100,100,100,100,100,100,100,100],n.LumLimitsForHueIndexHigh=[170,170,170,155,170,170,170,170,170,115,170,170,170,170,170,170,170,170,150,150,170,140,165]},534537:(e,t,a)=>{"use strict";a.d(t,{Z:()=>d,i:()=>c});var n=a(267324),o=a(601301),r=a(47262),i=a(750927),l=a(162134),s=a(590572);function c(e){switch(e){case"sum":return(0,n.Qte)();case"count":return(0,n.O0M)();case"average":return(0,n.o9V)();case"min":return(0,n.dlV)();case"max":return(0,n.PX_)();case"stdDev":return(0,n.fVE)();case"variance":return(0,n.ORJ)();case"none":case"distinctCount":throw new Error("Invalid Data Calculation type.");default:(0,r.c)(e,"Invalid Data Calculation type.")}}function d(e){switch(e.visualType){case"ChartVisual":case"PivotChartVisual":case"QueryChartVisual":{const t=e.chart,a=(0,l.ip)(t),r=(0,i.L)((0,n.Is)(),t.series.length),c=t.data,d=(e,t)=>{const a=function(e,t){if(0===e.dataBindings.length)return 0;const a=e.dataBindings[0].dimensionId;return t.dimensions.find((e=>e.id===a)).values.raw.length}(e,c);return(0,i.L)((0,n.LxC)(),t+1,a)};if(a.secondary){const e=(0,i.L)((0,n.XM5)(),a.primary.localizedName,a.secondary.localizedName),l=(e,t,n)=>{const r=t===e.axisGroup||"primary"===t&&void 0===e.axisGroup,i=(0,o.C$)(a.primary.insightsType,e.dimensionType),l=!!i&&i.orientation===n;return r&&l},c=t.axes.find((e=>l(e,"primary",o.UQ.Horizontal))),u=c?.title?(0,i.L)((0,n.Sa0)(),(0,s.HW)(c.title)):"",m=t.axes.find((e=>l(e,"primary",o.UQ.Vertical))),h=m?.title?(0,i.L)((0,n.Ony)(),(0,s.HW)(m.title)):"",g=t.axes.find((e=>l(e,"secondary",o.UQ.Horizontal))),p=g?.title?(0,i.L)((0,n.YtG)(),(0,s.HW)(g.title)):u,b=t.axes.find((e=>l(e,"secondary",o.UQ.Vertical))),f=b?.title?(0,i.L)((0,n.qvS)(),(0,s.HW)(b.title)):"",C=`${(0,i.L)((0,n.MiK)(),a.primary.localizedName)} ${u} ${h}`,y=`${(0,i.L)((0,n.MiK)(),a.secondary.localizedName)} ${p} ${f}`,v=[],x=[];t.series.forEach(((e,t)=>{"secondary"!==e.valueAxisGroup?v.push({series:e,index:t}):x.push({series:e,index:t})}));return`${e} ${r} ${C} ${v.map((e=>d(e.series,e.index))).join(" ")} ${y} ${x.map((e=>d(e.series,e.index))).join(" ")}`.trim()}return`${(0,i.L)((0,n.eZ0)(),a.primary.localizedName)} ${r} ${t.series.map(d).join(" ")} ${(t.axes||[]).map((e=>{const t=(0,o.C$)(a.primary.insightsType,e.dimensionType);if(!t||!e.title)return"";const r=(0,s.HW)(e.title);if(t.orientation===o.UQ.Horizontal)return(0,i.L)((0,n.zvE)(),r);if(t.orientation===o.UQ.Vertical)return(0,i.L)((0,n.mjS)(),r);throw new Error("Invalid orientation")})).join(" ")}`.trim()}case"PivotTableVisual":{const{rowFields:t,columnFields:a,dataFields:o,pivotTableData:r}=e.pivotTable;if(r&&0===r.length)return n.olU.NoValueAnswerTextForIdeas;const l=[];switch((t||[]).length){case 1:l.push((0,i.L)((0,n.hLq)(),t[0].name));break;case 2:l.push((0,i.L)((0,n.n0L)(),t[0].name,t[1].name))}if(1===(a||[]).length&&l.push((0,i.L)((0,n.gOS)(),a[0].name)),1===(o||[]).length){const{name:e,dataCalculation:t}=o[0],a=c(t),r=(0,i.L)((0,n.Gn5)(),a,e);l.push((0,i.L)((0,n.e0T)(),r))}return`${l.join(", ")}.`.trim()}case"QueryResultVisual":return 0===e.result.fields.length||0===e.result.fields[0].values.raw.length?n.olU.NoValueAnswerTextForIdeas:"";case"ForecastVisual":case"TextAnalysisVisual":return"";default:return(0,r.x)(e)}}},544707:(e,t,a)=>{"use strict";a.d(t,{Eb:()=>l,Q9:()=>o,oR:()=>s,qH:()=>i,yu:()=>r});var n=a(956933);const o=e=>(0,n.Q9)(e),r=()=>(0,n.yu)(),i=async e=>(0,n.qH)(e),l=async(e,t)=>(0,n.Eb)(e,t),s=e=>(0,n.oR)(e)},547131:(e,t,a)=>{"use strict";a.d(t,{F:()=>h,m:()=>m});var n=a(993384),o=a(644476),r=a(956258),i=a(910480),l=a(528804);const s=!0,c={activeTable:void 0,activeChart:void 0,activePivotTable:void 0,activeRange:void 0,lastActiveTable:void 0,dataSourceApis:{},selectionContexts:{},evaluateQueryLocations:{},generateResultForNLEvaluationLocations:{},postRangesResults:{},postRangesRequestTypes:{},interpretations:{},recommendations:{},suggestions:{},selectionError:void 0,isInserting:!1,hideSelectionErrorOnRange:void 0,activeRequestId:{},isAllowRewrite:s,requestState:{},isPermanentError:!1,isWorksheetProtected:!1,isWorksheet:!0,isWorkbookAutoSaveOn:!0,pendingNLContextFetches:[],tabularRanges:{},localeCacheDeprecated:(0,n.FZ)(),themeColors:{accentColors:[]},textAnalysisCardProps:void 0,excelRecognizedTablesAnnotationsCache:[],excelRecognizedTablesAnnotationsCacheRevisionId:"",excelBlobRangeCache:[],excelBlobRangeCacheRevisionId:"",nlEvaluationStates:{},rawQueries:{},shouldFallBack:{}};function d(e,t){delete e.evaluateQueryLocations[t],delete e.postRangesResults[t],delete e.postRangesRequestTypes[t],delete e.interpretations[t],delete e.suggestions[t],delete e.recommendations[t],delete e.generateResultForNLEvaluationLocations[t]}const u=(0,o.Z0)({name:"selection",initialState:c,reducers:{clearExpiredRanges:(e,t)=>{d(e,t.payload)},clearTable:(e,t)=>{delete e.dataSourceApis[t.payload],delete e.selectionContexts[t.payload],d(e,t.payload),delete e.activeRequestId[t.payload]},setActiveTable:(e,t)=>{t.payload?(e.activeTable&&(e.lastActiveTable=e.activeTable),e.activeTable=t.payload):(e.lastActiveTable===e.activeTable&&(e.lastActiveTable=void 0),e.activeTable=void 0)},setActiveChart:(e,t)=>{e.activeChart=t.payload},setActivePivotTable:(e,t)=>{e.activePivotTable=t.payload},setActiveRange:(e,t)=>{e.activeRange=t.payload},removeLastActiveTable:e=>{e.lastActiveTable=void 0},setDataSourceApi:(e,t)=>{e.dataSourceApis[t.payload.tableName]=t.payload.dataSourceApi},setSelectionContext:(e,t)=>{e.selectionContexts[t.payload.tableName]=t.payload.context,e.localeCacheDeprecated=t.payload.localeCacheDeprecated,e.themeColors=t.payload.theme},setEvaluateQueryLocation:(e,t)=>{e.evaluateQueryLocations[t.payload.tableName]=t.payload.evaluateQueryLocation},postRangesSuccess:(e,t)=>{e.postRangesResults[t.payload.tableName]=t.payload.postRangesResult,e.postRangesRequestTypes[t.payload.tableName]||(e.postRangesRequestTypes[t.payload.tableName]=[]),e.postRangesRequestTypes[t.payload.tableName].includes(t.payload.requestType)||e.postRangesRequestTypes[t.payload.tableName].push(t.payload.requestType)},generateResultsSuccess:(e,t)=>{e.postRangesRequestTypes[t.payload.tableName].includes(t.payload.requestType)||e.postRangesRequestTypes[t.payload.tableName].push(t.payload.requestType),e.postRangesResults[t.payload.tableName].operationId=t.payload.generateResultsResult.operationId,e.postRangesResults[t.payload.tableName].operationLocation=t.payload.generateResultsResult.operationLocation},getInterpretationsSuccess:(e,t)=>{e.interpretations[t.payload.tableName]?e.interpretations[t.payload.tableName].push(...t.payload.result.interpretations):e.interpretations[t.payload.tableName]=t.payload.result.interpretations},getRecommendationsSuccess:(e,t)=>{const a=t.payload.recommendations.map((e=>({...e,queryId:r.M.userQueryGuid})));e.recommendations[t.payload.tableName]||(e.recommendations[t.payload.tableName]=[]),e.recommendations[t.payload.tableName].push(...a)},getNLContextSuccess:(e,t)=>{e.evaluateQueryLocations[t.payload.tableName]=t.payload.contextResponse.evaluateQueryLocation;((0,l.iPS)("Microsoft.Office.Excel.FA000000124.UseShortPollNLEvaluating",!1)||(0,l.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1))&&(e.generateResultForNLEvaluationLocations[t.payload.tableName]=t.payload.contextResponse.generateResultForNLEvaluationLocation),e.suggestions[t.payload.tableName]=t.payload.contextResponse.suggestedQueries?.suggestions??[]},setSelectionError:(e,t)=>{e.selectionError=t.payload,void 0===t.payload&&(e.hideSelectionErrorOnRange=void 0)},hideSelectionErrorOnRange:(e,t)=>{e.hideSelectionErrorOnRange=t.payload},startInsertRecommendations(e){e.isInserting=!0},endInsertRecommendations(e){e.isInserting=!1},setIsAllowRewrite(e,t){e.isAllowRewrite=t.payload},resetIsAllowRewrite(e){e.isAllowRewrite=s},setActiveRequestId:(e,t)=>{e.activeRequestId[t.payload.tableName]=t.payload.activeRequestId,e.requestState[t.payload.activeRequestId]="pending"},evaluateQuerySuccess:(e,t)=>{e.requestState[t.payload]="success"},evaluateQueryFailed:(e,t)=>{e.requestState[t.payload]="failed"},setIsPermanentError:(e,t)=>{e.isPermanentError=t.payload},setIsWorksheetProtected:(e,t)=>{e.isWorksheetProtected=t.payload},setIsWorksheet:(e,t)=>{e.isWorksheet=t.payload},setIsWorkbookAutoSaved:(e,t)=>{e.isWorkbookAutoSaveOn=t.payload},getNLContextRequest:(e,t)=>{e.pendingNLContextFetches.push(t.payload)},getNLContextFinished:(e,t)=>{e.pendingNLContextFetches=e.pendingNLContextFetches.filter((e=>e!==t.payload))},cacheTableInterpretationsForUndo:e=>{e.cachedTabularRangesForUndo=(0,i.cloneDeep)(e.tabularRanges)},restoreTableInterpretationsForUndo:e=>{e.cachedTabularRangesForUndo&&(e.tabularRanges=e.cachedTabularRangesForUndo),e.cachedTabularRangesForUndo=void 0},clearCachedTableInterpretationsForUndo:e=>{e.cachedTabularRangesForUndo=void 0},updateTableInterpretationsForSheet:(e,t)=>{e.tabularRanges[t.payload.sheetId]=t.payload.newInterpretations},updateExcelRecognizedTableCache:(e,t)=>{""!==e.excelRecognizedTablesAnnotationsCacheRevisionId&&e.excelRecognizedTablesAnnotationsCacheRevisionId===t.payload.revisionId||(e.excelRecognizedTablesAnnotationsCache=[],e.excelRecognizedTablesAnnotationsCacheRevisionId=t.payload.revisionId),e.excelRecognizedTablesAnnotationsCache.push(t.payload.recognizedTable)},updateExcelBlobRangeCache:(e,t)=>{""!==e.excelBlobRangeCacheRevisionId&&e.excelBlobRangeCacheRevisionId===t.payload.revisionId||(e.excelBlobRangeCache=[],e.excelBlobRangeCacheRevisionId=t.payload.revisionId),e.excelBlobRangeCache.push(t.payload.blobRange)},setTextAnalysisCardProps:(e,t)=>{e.textAnalysisCardProps=t.payload.props},setNLEvaluationState:(e,t)=>{e.nlEvaluationStates[t.payload.requestId]=t.payload.nlEvaluationState},setRawQuery:(e,t)=>{e.rawQueries[t.payload.userQueryGuid]=t.payload.messageText},setShouldFallBack:(e,t)=>{e.shouldFallBack[t.payload.requestId]=t.payload.shouldFallBack}}}),{actions:m,reducer:h}=u},549815:(e,t,a)=>{"use strict";a.d(t,{n:()=>P,r:()=>R});var n=a(267324),o=a(856656),r=a(932367),i=a(754440),l=a(700853),s=a(63919),c=a(322466),d=a(886866),u=a(365319),m=a(223887),h=a(893763),g=a(9847),p=a(956258),b=a(797639),f=a(49236),C=a(750927),y=a(528804),v=a(644082),x=a(340889),T=a(949404),S=a(14086),w=a(644737);const E=g.q.Commanding,I="Copilot\\Commanding";function R(e,t){return{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:A(t.length)},embeddedLists:(0,y.k64)()?[]:[{listItems:t}],messageFooter:{text:e}}}}}function A(e){if(!(0,y.yw9)("OfficeVSO_8977646_RemoveRangeFromHiTLConfirmationCard")){const t=b.CP.getActiveTable()?.address,a=b.CP.getHumanInTheLoopRange()??(0,S.r)(t??"");if(a)return(0,n.go9)(e).replace("{0}",a)}return(0,n.lj0)(e)}function L(){return(0,y.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?p.M.getInstance().getUsageFeatureForStandardizedFeature(p.M.getInstance().getActiveFeature()):E}function k(e,t){const a=b.CP.getActiveTable();if(!a?.address)throw new h.sF("No active table",h.UP.NoActiveTable);const o=(0,S.r)(a.address);return(0,y.ZAR)()?function(e,t,a,o){let r="";r=e&&1===t?(0,n.Bfv)():e&&t>1?(0,n.nEe)():t>1?(0,n.LhO)():(0,n.UQX)();t>1&&(r=r.replace("{numChanges}",t.toString()));return r.replace("{range}",a).replace("{sheet}",o)}(e,t,o,a.sheetRange.sheet):function(e,t,a){return e&&1===t?(0,C.L)((0,n.Af3)(),a):e&&t>1?(0,C.L)((0,n.Edn)(),a,t):t>1?(0,C.L)((0,n.syu)(),a,t):(0,C.L)((0,n.$Mo)(),a)}(e,t,o)}function F(e){return{type:o.jA.Default,title:(0,n.yZI)(),text:(0,n.yZI)(),iconRegular:d.N5_,iconHover:d.FUA,isDisabled:!0,handleButtonOnClick:async()=>{const t=p.M.getInstance(),a=L();t.logEvent((0,g.SV)(g.he.Apply,a,g.KZ.ApplyButton,void 0,p.M.userQueryGuid));const{message:o,telemetry:r}={message:{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Human,messageHeader:{text:(0,n.yZI)()}}}},telemetry:{featureName:L(),eventType:g.a5.HumanInput}};u.$.getInstance().displayResponse(o,r),await e()}}}function _(e,t,a=void 0){const n=g.q.ConditionalFormattingSuggestion,o=(0,T.v)(e,{errorType:t,featureName:n},{},{feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding Conditional Formatting"}:{feedbackArea:"Copilot\\Commanding CF Suggestions"}});o.message.addCardToChatHistory=!1,(0,y.jHv)()&&(o.telemetry.devInfo={category:t,message:a});const l=(0,y.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?g.BJ.ConditionalFormatting:g.BJ.Commanding;return t===g.q0.ClientError?p.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Conditional_Formatting_Suggestions_Error_Due_To_No_Table_Selected,l):p.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Conditional_Formatting_Suggestions_Error,l),o}const P={getOdslExecutionFailedResponse:function(e,t){return(0,T.v)(e,{featureName:L(),errorType:t},{},{feedbackData:{feedbackArea:I}})},getMultipleEventsErrorResponse:function(e,{showUndo:t}={showUndo:!1},a=g.BJ.CopilotChat){return(0,T.v)(e,{errorType:g.q0.DetectedMultipleIntents,featureName:(0,y.yw9)("OfficeVSO_9771900_ErrorFeatureAttribution")?p.M.getInstance().getUsageFeatureForStandardizedFeature(a):g.q.CopilotChat},{},{actionButtonList:t&&(0,y.BAK)()?[(0,w.FW)(L())]:[]})},getCommandingSuccessResponse:function(e,t){const a=t.some((e=>m.yT.test(e.text))),n=L(),o={shouldShowAIGeneratedIndicator:!0,feedbackData:{feedbackArea:n===g.q.Commanding?"Copilot\\Commanding":"Copilot\\Commanding Conditional Formatting"},feedbackSectionPosition:c.O.Footer,actionButtonList:(0,y.BAK)()?[(0,w.FW)(n)]:[]};let r;if(!(0,y.k64)()&&a){const a={header:A(t.length),listItems:t,footer:e},n=(0,x.KI)(a);r={chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,f.IM)("ChatCardListWithColorSwatch_V1",a),textContent:n}},chatMessageBodyData:o}}else r={...R(e,t),chatMessageBodyData:o};return{message:r,telemetry:{featureName:n,eventType:g.a5.ActionConfirmationMessage}}},getUnsupportedCommandResponse:function(e,t=[]){const{message:a,telemetry:n}=(0,T.v)(e,{featureName:L(),errorType:g.q0.UnsupportedCommand},{embeddedLists:[{listItems:t}]},{feedbackData:{feedbackArea:I},feedbackSectionPosition:c.O.None});return{message:a,telemetry:n}},getCommandingFeatureName:L,getCommandingTellMeResponse:function(){return{message:{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,embeddedLists:[{listHeader:(0,n.ZcJ)(),listItems:[{text:(0,n.UFE)()},{text:(0,n.$nW)()}]},{listHeader:(0,n.Sur)(),listItems:[{text:(0,n.Gpd)()},{text:(0,n.N9u)()}]}]}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:c.O.Footer,feedbackData:{feedbackArea:I}}},telemetry:{featureName:E,eventType:g.a5.HelpMessage}}},getCommandingHumanInTheLoopResponse:function(e,t){const a={header:k(!1,e.length),events:e},n=(0,y.yw9)("OfficeVSO_8990694_HiTLChatHistorySignalContent")?(0,x.NP)(a):"";return{message:{chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,f.IM)("ChatCardHumanInTheLoop_V1",a),textContent:n}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:[F(t)],feedbackSectionPosition:c.O.Footer,feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding"}:{}}},telemetry:{featureName:E,eventType:g.a5.HumanInTheLoopMessage}}},getCommandingHumanInTheLoopResponseDeprecated:function(e,t){return{message:{chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:k(!1,e.length)},embeddedLists:[{listItems:e.map((e=>({text:e})))}]}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:[F(t)],feedbackSectionPosition:c.O.Footer}},telemetry:{featureName:E,eventType:g.a5.HumanInTheLoopMessage}}},getCommandingCFHumanInTheLoopResponse:function(e,t,a){const n={header:k(0===t.length,e.length+t.length),cfHitlItems:e,eventIntents:t};return{message:{chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,f.IM)("ChatCardWithConditionalFormatting_V1",n),textContent:(0,x.EM)(n)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:[F(a)],feedbackSectionPosition:c.O.Footer,feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding Conditional Formatting"}:{}}},telemetry:{featureName:(0,y.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?g.q.ConditionalFormatting:g.q.Commanding,eventType:g.a5.HumanInTheLoopMessage}}},getConditionalFormattingSuggestionsResponseMessage:function(e,t,a,o){const d=b.CP.getActiveTable();if("out-of-credits"===t)return _((0,n.R_I)(),g.q0.OutOfCreditsError,t);if(t)return _((0,n.t_C)(),g.q0.ServiceError,t);if(d){const t=d.address,u=d.sheetRange.sheet;return 0===e.length?function(e){const t=g.q0.NoSuggestions,a=g.q.ConditionalFormattingSuggestion,o=(0,C.L)((0,n.yNF)(),e),l=(0,T.v)(o,{errorType:t,featureName:a},{},{feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding Conditional Formatting"}:{feedbackArea:"Copilot\\Commanding CF Suggestions"}});l.message.addCardToChatHistory=!1;const s=(0,y.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?g.BJ.ConditionalFormatting:g.BJ.Commanding;return p.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Conditional_Formatting_No_Suggestions_Error,s),l}(t):function(e,t,a,o,r){const i={featureName:g.q.ConditionalFormattingSuggestion,eventType:g.a5.SuggestionMessage},d=(0,S.r)(t);let u="";u=(0,y.ZAR)()?(0,n.z4t)().replace("{range}",d).replace("{sheet}",r):(0,C.L)(a??(0,n.AsH)(),d);const m={header:u,suggestions:e,footer:void 0,guid:o},h=(0,x.iN)(m);return{message:{chatCardType:l._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:s.Q9.Chat,renderData:(0,f.IM)("ConditionalFormattingSuggestionCard_V1",m),textContent:h}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:c.O.Footer,feedbackData:(0,y.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?{feedbackArea:"Copilot\\Commanding Conditional Formatting"}:{feedbackArea:"Copilot\\Commanding CF Suggestions"}}},telemetry:i}}(e,t,a,o,u)}return _((0,n.LNV)(),g.q0.ClientError)},getConditionalFormattingSuggestionsErrorResponse:_,getExcelChartStylesResponseMessage:function(e,t,a){return(0,v.k)({requestId:t,adaptiveCardDefinition:JSON.parse(e.adaptiveCardDefinition??""),cardButtonCallback:a})}}},551499:(e,t,a)=>{"use strict";a.d(t,{DH:()=>o,w2:()=>r,wv:()=>n});class n{}var o,r;n.Worksheet={Activate:"Worksheet.activated",Filter:{Icon:"Worksheet.filtered.Icon",BottomItems:"Worksheet.filtered.BottomItems",BottomPercent:"Worksheet.filtered.BottomPercent",TopItems:"Worksheet.filtered.TopItems",TopPercent:"Worksheet.filtered.TopPercent",Values:"Worksheet.filtered.Values",Custom:"Worksheet.filtered.Custom",Dynamic:"Worksheet.filtered.Dynamic",FontColor:"Worksheet.filtered.FontColor",CellColor:"Worksheet.filtered.CellColor"},ClearFilter:"Worksheet.clearedFilter",ClearColumnFilter:"Worksheet.clearedColumnFilter"},n.Range={Sort:"Range.sorted"},n.Table={Sort:"Table.sorted",TotalRow:"Table.totalRowToggled",HeaderRow:"Table.headerRowToggled",BandedRows:"Table.bandedRowsToggled",BandedColumns:"Table.bandedColumnsToggled",FirstColumn:"Table.firstColumnToggled",LastColumn:"Table.lastColumnToggled",FilterButton:"Table.filterButtonToggled",FilterColor:"Table.filterColor",ApplyStyle:"Table.styleApplied",ApplyTableUpdatePlan:"Table.applyPowerQueryTableUpdatePlan"},n.Format={IndentChange:"Format.indentChange",RemoveAutofitColumns:"Format.removeAutofitColumns",RemoveAutofitRows:"Format.removeAutofitRows"},n.ConditionalFormatting={ApplyIconSetConditionalFormatting:"ConditionalFormatting.applyIconSetConditionalFormatting"},function(e){e.Undo="Undo",e.TableAltText="TableAltText",e.RefreshData="RefreshData",e.AddComment="AddComment",e.DataValidation="DataValidation",e.CreatePivotTable="CreatePivotTable",e.InsertWorksheets="InsertWorksheets",e.DeleteWorksheets="DeleteWorksheets",e.InsertTables="InsertTables",e.FreezePanes="FreezePanes",e.Formatting="Formatting"}(o||(o={})),function(e){e[e.OfficeScripts=0]="OfficeScripts",e[e.OfficeJS=1]="OfficeJS",e[e.Insights=2]="Insights",e[e.FormulaGeneration=3]="FormulaGeneration",e[e.DataShaping=4]="DataShaping",e[e.UnsupportedEvent=5]="UnsupportedEvent",e[e.ConditionalFormatSuggestion=6]="ConditionalFormatSuggestion",e[e.ImportData=7]="ImportData"}(r||(r={}))},553373:(e,t,a)=>{"use strict";a.d(t,{JK:()=>L,RD:()=>O,bn:()=>M,qx:()=>D});var n=a(932367),o=a(754440),r=a(881707),i=a(365319),l=a(455811),s=a(663280),c=a(831310),d=a(261199),u=a(936044),m=a(9847),h=a(83437),g=a(477543),p=a(104450),b=a(476730),f=a(965634),C=a(956258),y=a(235373),v=a(544707),x=a(353033),T=a(883),S=a(565874),w=a(528804),E=a(507628);const I=(0,w.Z8j)("Microsoft.Office.Excel.FA000000124.CitationMetadataFetchRequestTimeoutMs",3e4),R=C.M.getInstance(),A=b.E.getInstance();function L(e){return void 0!==e.sourceAttributions&&void 0!==e.messageId}const k=new Map,F=new Map;async function _(e,t,a,r){try{const d=new g.g0({parentPath:["Signal",l.Uk.getTypeName()],items:[{id:a,body:new l.Uk({locale:r,fileIdentifiers:[{fileUrl:t,fileName:e}],requestId:a})}]});if((0,w.yw9)("OfficeVSO_9523129_refactorCitationSignalAwait"))return(0,u.T)(d,a,f.S2.FetchCitationMetadata,m.OP.FetchCitationFileMetadata,s.bV.getTypeName(),I);{const e=(0,x.p)();i.$.getInstance().submitOperation({operation:d,workflowAnnotationType:s.bV.getTypeName()});const t=setTimeout((()=>{N(a,{id:a,body:{requestId:a,error:{errorCode:c.O.Timeout,errorMessage:`ExcelImportDataFileMetadataSignal Request timed out after ${I} ms. request id ${a}`}}}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_File_Fetching_Timeout,m.BJ.ImportData)}),I);return k.set(a,{deferredPromise:e,requestId:a,timeoutId:t,startTime:performance.now(),telemetryEventType:f.S2.CitationFileUtils,latencyOperation:m.OP.FetchCitationFileMetadata}),e.promise}}catch(e){throw R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while submitting signal to fetch citation file details: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_File_Fetching_Error,m.BJ.ImportData),e}}function P(e,t){const a=F.get(e);if(a){F.delete(e),clearTimeout(a.timeoutId);const n=performance.now()-a.startTime;A.logLatency(n,m.OP.FetchTablesRelevancy),t instanceof Error?a.deferredPromise.reject(t):a.deferredPromise.resolve(t.body),R.logEvent((0,m.P1)(f.S2.FetchTablesRelevancy,{[f.IC.RequestId]:e,[f.IC.ExecutionTime]:n,[f.IC.Success]:!(t instanceof Error),[f.IC.Error]:t instanceof Error?t.message:""}))}else R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_Relevancy_Error,m.BJ.ImportData),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Received data import annotation for unknown request ${e}`,logLevel:h.$b.Warning})}function N(e,t){const a=k.get(e);if(a){k.delete(e),clearTimeout(a.timeoutId);const n=performance.now()-a.startTime;A.logLatency(n,m.OP.FetchCitationFileMetadata),t instanceof Error?a.deferredPromise.reject(t):a.deferredPromise.resolve(t.body),R.logEvent((0,m.P1)(f.S2.FetchCitationMetadata,{[f.IC.RequestId]:e,[f.IC.ExecutionTime]:n,[f.IC.Success]:!(t instanceof Error),[f.IC.Error]:t instanceof Error?t.message:""}))}else R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_File_Fetching_Error,m.BJ.ImportData),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Received data import annotation for unknown request ${e}`,logLevel:h.$b.Warning})}function M(e){e.body&&s.bV.typeGuard(e.body)&&N(e.body.requestId,e)}function O(e){e.body&&s.Dd.typeGuard(e.body)&&P(e.body.requestId,e)}class D{static getInstance(){return D._instance||(D._instance=new D((()=>(0,E.A)()),S.qD)),D._instance}stopGeneratingCurrentMessageId(){this.stoppedMessages.add(this.currentImportOperationMessageId)}doesMessageHaveFilteredExcelFiles(e){return this.messageIdsFilteredExcelFiles.has(e)}isMessageCancelled(e){return this.stoppedMessages.has(e)}setMessageMetadata(e,t){const a=t.messages?.filter((e=>"user"===e.author))[0]?.text??"";this.messageIdToMessageMetaDataMap.set(e.messageId,{userQuery:a,chatResponse:e.text,locale:e.locale??"",sensitivityLabel:e.sensitivityLabel})}doMessageContainsExcelCitation(e){return this.messageIdToFileUrlsMap.has(e)}doMessageContainsCitation(e){return this.messagesWithCitations.has(e)}async processCitations(e,t){try{this.augloopSession?e.sourceAttributions?.forEach((async a=>{this.messagesWithCitations.add(e.messageId);const n=await this.getReferenceMetadataForValidExcelFile(a,e.messageId);if(!n)return(0,T.debuglog)("Skipping citation file details fetch for non valid excel file"),Promise.resolve();const o=a.seeMoreUrl;if(this.messageIdToFileUrlsMap.has(e.messageId)||this.messageIdToFileUrlsMap.set(e.messageId,new Set),(0,w.iPS)("Microsoft.Office.Excel.FA000000124.Limit10FilesPerMessage",!0)&&this.messageIdToFileUrlsMap.get(e.messageId).size>=10)return void R.logError({eventType:f.S2.CitationFileUtils,errorMessage:"Number of files per message exceeds the limit of 10. skipping excel citation file",logLevel:h.$b.Warning});this.messageIdToFileUrlsMap.get(e.messageId)?.add(o);const r=`${C.M.userQueryGuid}_${e.messageId}_${this.requestIdGenerator()}`;if(!this.inProgressItems?.has(o)&&!this.resolvedItems?.has(o)){const e=async()=>{try{const e=await this.fetchCitationFileDetailsImpl(n.fileName,o,r,t??"");return this.resolvedItems?.has(o),this.resolvedItems?.set(o,e),this.inProgressItems?.delete(o),this.notifyItemResolvedEventHandlers(e),e}catch(e){return this.inProgressItems?.delete(o),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while fetching citation file details: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error}),Promise.resolve(void 0)}};this.inProgressItems?.set(o,e())}})):R.logError({eventType:f.S2.CitationFileUtils,errorMessage:"AugLoop session is not available to process citations",logLevel:h.$b.Warning})}catch(e){R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while processing citations: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_File_Fetching_Error,m.BJ.ImportData)}}intersectResolvedCitations(e){return e?.filter((e=>e.seeMoreUrl&&this.resolvedItems?.has(e.seeMoreUrl)))?.map((e=>this.resolvedItems.get(e.seeMoreUrl)))?.filter((e=>void 0!==e))}async fetchRelevantTablesForMessageId(e,t,a,r,d,p=y.m){this.currentImportOperationMessageId=e;try{r(p.startExecutingCommand({command:m.OP.ImportDataGenerateSuggestion,id:d}));const b=await this.getAllResolvedDataSourcesForMessageId(e,t),y=this.messageIdToMessageMetaDataMap.get(e);if(!y||0===b.length){const t=`Message metadata or dataSources not found.\nskipping relevancy check.\ndataSources length: ${b.length},\nmessageMetaData undefined: ${!y},\nmessage id: ${e}`;return R.logError({eventType:f.S2.CitationFileUtils,errorMessage:t,logLevel:h.$b.Error}),Promise.resolve({requestId:"",dataSources:b})}if(!(0,w.iPS)("Microsoft.Office.Excel.FA000000124.ImportDataEnableRelevancyCheck",!0))return Promise.resolve({requestId:"",dataSources:b});r(p.stopExecuting({isSuccess:!0,keepShowingLoadingUIIfAlreadyActive:!0})),r(p.startExecutingCommand({command:m.OP.ImportDataRelevancyCheck,id:d}));const v=`${C.M.userQueryGuid}_${e}_${this.requestIdGenerator()}`,S=new g.g0({parentPath:["Signal","ExcelImportDataSourcesRelevancySignal"],items:[{id:v,body:new l.sN({requestId:v,userQuery:y?.userQuery??"",chatResponse:y?.chatResponse??"",sources:b})}]});if((0,w.yw9)("OfficeVSO_9523129_refactorCitationSignalAwait"))return(0,u.T)(S,v,f.S2.FetchTablesRelevancy,m.OP.FetchTablesRelevancy,s.Dd.getTypeName(),a,{dataSourcesLength:b.length});{const e=(0,x.p)();(0,T.debuglog)(`SENDING SIGNAL TO RUN RELEVANCY CHECK: ${JSON.stringify(S)}`),i.$.getInstance().submitOperation({operation:S,workflowAnnotationType:s.Dd.getTypeName()});const t=setTimeout((()=>{P(v,{id:v,body:{requestId:v,dataSources:b,error:{errorCode:c.O.Timeout,errorMessage:`ExcelImportDataSourcesRelevancySignal Request timed out after ${a} ms. returning sources without relevancy. request id ${v}`}}}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_Relevancy_Timeout,m.BJ.ImportData)}),a);return F.set(v,{deferredPromise:e,requestId:v,timeoutId:t,telemetryEventType:f.S2.CitationFileUtils,latencyOperation:m.OP.FetchTablesRelevancy,startTime:performance.now()}),e.promise}}catch(e){throw R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while submitting signal to run relevancy check: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error}),R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,n.c.Import_Data_Relevancy_Error,m.BJ.ImportData),e}}async getAllResolvedDataSourcesForMessageId(e,t){const a=this.messageIdToFileUrlsMap.get(e)??new Set,r=this.getCurrentTime()+t,i=()=>Array.from(a).filter((e=>!this.resolvedItems.has(e)&&this.inProgressItems.has(e)));let l=i();for(;l.length>0&&this.getCurrentTime()<r;)await Promise.race([B(r-this.getCurrentTime()),this.waitForItemResolved()]),l=i();const s=Array.from(a).map((e=>this.resolvedItems.get(e))),d=s.filter((t=>{const a=void 0!==t&&void 0===t.error&&t.dataSources&&t.dataSources.length>0;if(!a&&(t&&!t.error||this.messageIdsFilteredExcelFiles.add(e),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Filtering resolved citation: citationDetails: ${!!t} citationDetails.error: ${JSON.stringify(t?.error)}\n            } citationDetails.dataSources count: ${t?.dataSources?.length}, requestId: ${t?.requestId}`,logLevel:h.$b.Error}),t?.error?.errorCode)){const e=t.error.errorCode===c.O.Timeout?n.c.Import_Data_File_Fetching_Timeout:n.c.Import_Data_File_Fetching_Error;R.logStandardizedAshaErrorEvent(o.W.Unable_To_Complete_Task,e,m.BJ.ImportData)}return a})),u=d.map((e=>e.dataSources)).flat(),g=u.filter((e=>{const t=void 0===e.error&&e.sourceName&&e.sourceLocation&&e.powerQueryScript;return t||R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Filtering data source: dataSource.error: ${JSON.stringify(e.error)} dataSource.sourceName: ${!!e.sourceName} dataSource.sourceLocation: ${!!e.sourceLocation} dataSource.powerQueryScript: ${!!e.powerQueryScript}`,logLevel:h.$b.Error}),t}));return R.logEvent((0,m.P1)(f.S2.GetResolvedCitations,{[f.IC.TotalFiles]:a.size,[f.IC.UnresolvedCitations]:l.length,[f.IC.ResolvedCitations]:s.length,[f.IC.ResolvedValidCitations]:d.length,[f.IC.ResolvedDataSources]:u.length,[f.IC.ValidDataSources]:g.length})),g}registerOnItemResolvedEventHandler(e){this.onItemResolvedEventHandlers.push(e)}unregisterOnItemResolvedEventHandler(e){const t=this.onItemResolvedEventHandlers.indexOf(e);t>-1&&this.onItemResolvedEventHandlers.splice(t,1)}waitForItemResolved(){return new Promise((e=>{this.registerOnItemResolvedEventHandler((t=>{this.unregisterOnItemResolvedEventHandler(e),e(t)}))}))}notifyItemResolvedEventHandlers(e){setTimeout((()=>{this.onItemResolvedEventHandlers.forEach((t=>t(e)))}),0)}async getReferenceMetadataForValidExcelFile(e,t,a=(0,w.Te4)("Microsoft.Office.Excel.FA000000124.ImportAllowedFileTypes",["xlsx","xlsm"]),n=(0,w.iPS)("Microsoft.Office.Excel.FA000000124.DecryptProtectedExcelFileV2",!1)){if(e.referenceMetadata)try{const o=JSON.parse(e.referenceMetadata);if(!o)throw new Error("referenceMetadata could not be parsed");const i=o.referenceType===p.YA.Excel||o.referenceType===d.ss.Excel,l=void 0!==e.providerDisplayName,s=o.sensitivityLabel?.isEncrypted,c=(0,w.iPS)("Microsoft.Office.Excel.FA000000124.ImportFilterEncryptedAndHigherCLPFiles",!0)&&!n;if(!i)return R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Skipping none excel file. referenceType: ${o.referenceType}`,logLevel:h.$b.Warning}),Promise.resolve(void 0);if(o.fileName?.includes(".")){const e=o.fileName?.split(".").pop()?.toLowerCase();if(e&&!a.includes(e))return R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Skipping file: fileExtension: ${e}`,logLevel:h.$b.Warning}),Promise.resolve(void 0)}return!l||s&&c?(R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Skipping file: hasDisplayName: ${l}, isEncrypted: ${s}`,logLevel:h.$b.Warning}),this.messageIdsFilteredExcelFiles.add(t),Promise.resolve(void 0)):c&&await async function(e){const t=(0,v.oR)(e.sensitivityLabel);return await r.n.getInstance().isSensitivityHigherThanDoc(t)}(o)?((0,T.debuglog)(`Skipping citation file details fetch for sensitive file ${o.fileName} with sensitivity ${o.sensitivityLabel}`),R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Skipping citation file details fetch for sensitive file with sensitivity ${o.sensitivityLabel?.displayName}`,logLevel:h.$b.Warning}),this.messageIdsFilteredExcelFiles.add(t),Promise.resolve(void 0)):e.seeMoreUrl?(o.fileName=e.providerDisplayName,Promise.resolve(o)):(R.logError({eventType:f.S2.CitationFileUtils,errorMessage:"Citation file url is missing in source attribution",logLevel:h.$b.Warning}),this.messageIdsFilteredExcelFiles.add(t),Promise.resolve(void 0))}catch(e){R.logError({eventType:f.S2.CitationFileUtils,errorMessage:`Error while parsing reference metadata: ${e} ${JSON.stringify(e)}`,logLevel:h.$b.Error}),this.messageIdsFilteredExcelFiles.add(t)}return Promise.resolve(void 0)}constructor(e,t,a=new Map,n=new Map,o=new Map,r=new Set,i=new Map,l=new Set,s=Date.now,c=_,d=new Set){this.requestIdGenerator=e,this.inProgressItems=a,this.resolvedItems=n,this.messageIdToFileUrlsMap=o,this.messagesWithCitations=r,this.messageIdToMessageMetaDataMap=i,this.messageIdsFilteredExcelFiles=l,this.getCurrentTime=s,this.fetchCitationFileDetailsImpl=c,this.stoppedMessages=d,this.augloopSession=void 0,this.onItemResolvedEventHandlers=[],this.currentImportOperationMessageId="",t().then((e=>{this.augloopSession=e}))}}function B(e){return new Promise((t=>setTimeout(t,e)))}D._instance=void 0},553482:(e,t,a)=>{"use strict";a.d(t,{YO:()=>n,q:()=>s,wM:()=>c});var n,o=a(267324),r=a(777179);!function(e){e.None="None",e.Trillions="Trillions",e.Billions="Billions",e.Millions="Millions",e.Thousands="Thousands"}(n||(n={}));const i=10,l=[];function s(e,t,a){if("histogram"===e.series[0].layout)return null;const n=(0,r.r)(e,t,a);return n?c(n.min,n.max):null}function c(e,t){l.length>0||l.push({numericalUnitsValue:1e15,languageUnitsValue:"None",localizedUnitsValue:""},{numericalUnitsValue:1e12,languageUnitsValue:"Trillions",localizedUnitsValue:(0,o.chZ)()},{numericalUnitsValue:1e9,languageUnitsValue:"Billions",localizedUnitsValue:(0,o.omg)()},{numericalUnitsValue:1e6,languageUnitsValue:"Millions",localizedUnitsValue:(0,o.Pjp)()},{numericalUnitsValue:1e3,languageUnitsValue:"Thousands",localizedUnitsValue:(0,o.vLX)()});const a=Math.abs(t)>Math.abs(e)?Math.abs(t):Math.abs(e);for(let e=0;e<l.length;e++)if(a>=l[e].numericalUnitsValue*i)return l[e];return null}},555454:(e,t,a)=>{"use strict";a.d(t,{rc:()=>p});var n=a(83437),o=a(472096),r=a(965634),i=a(956258),l=a(64292),s=a(353033),c=a(528804),d=a(390624);let u=!1;const m=new Map;var h;!function(e){e.LoadCalledWithoutWaiting="LoadCalledWithoutWaiting",e.QueryRefreshSuccess="QueryRefreshSuccess",e.QueryRefreshFailure="QueryRefreshFailure",e.QueryStillPending="QueryStillPending",e.CalledWhileSameQueryPending="CalledWhileSameQueryPending",e.InternalError="InternalError",e.AuthenticateRefreshDisabled="AuthenticateRefreshDisabled"}(h||(h={}));const g=async e=>{const t=Array.from(m).find((([t,a])=>a.exactQueryNameMatch?t===e.queryName:e.queryName.includes(t)))?.[1];i.M.getInstance().logEvent({eventType:r.S2.PowerQueryHelper,eventData:[{key:r.E_.Event,value:"onQueryRefreshCompleted"},{key:r.E_.QueryId,value:t?.queryId?t.queryId:"N/A"},{key:r.E_.Success,value:e.success.toString()},{key:r.E_.FoundCallback,value:(!!t).toString()},{key:r.E_.Duration,value:t?(performance.now()-t.startTime).toString():"N/A"}]}),t&&(e.success?t.callback(t.queryName,"QueryRefreshSuccess"):t.callback(t.queryName,"QueryRefreshFailure"))};async function p(e,t,a=!1,h){return Excel.run((async p=>await(0,d.F5)((async d=>{let p;const b=(0,c.Z8j)("Microsoft.Office.Excel.FA000000124.MaxTimeWaitingForLoadQueryCallback",3e3);a&&(p=async function(e,t,a,l){m.has(e)&&i.M.getInstance().logError({errorMessage:"waitForRefreshToCompleteWithTimeout Called while same query is pending",eventType:r.S2.PowerQueryHelper,logLevel:n.$b.Error});if((0,o.QK)()&&!(0,c.iPS)("Microsoft.Office.Excel.FA000000124.PowerQueryAuthenticateRefresh",!1))return"AuthenticateRefreshDisabled";const d=(0,s.p)(),h=setTimeout((()=>{d.resolve("QueryStillPending")}),t);return function(e,t,a,n){u||(a.workbook.queries.onQueryRefreshCompleted.add(g),u=!0);const o=!1;m.set(e,{startTime:performance.now(),queryId:n,queryName:e,exactQueryNameMatch:o,callback:t})}(e,((e,t)=>{clearTimeout(h),d.resolve(t)}),a,l),d.promise}(t,b,d,h));const f=d.workbook.queries.loadQuery(t,e,Excel.PowerQueryObjectType.table);d.load(f),await d.sync();const C=f.name;a&&function(e,t){const a=m.get(e);a&&(m.delete(e),m.set(t,{...a,exactQueryNameMatch:!0,queryName:t}))}(t,C);const y=d.workbook.worksheets.getItem(C);if(await d.sync(),y){const e=(0,l.x)(d,y);await e()(d),await d.sync()}return p??"LoadCalledWithoutWaiting"}))))}},565874:(e,t,a)=>{"use strict";a.d(t,{$q:()=>D,E:()=>O,UC:()=>_,V1:()=>k,jl:()=>P,qD:()=>M,s6:()=>N});var n=a(408185),o=a(290786),r=a(602775),i=a(99394),l=a(83437),s=a(207545),c=a(959994),d=a(117910),u=a(9847),m=a(476730),h=a(965634),g=a(956258),p=a(79458),b=a(329416),f=a(528804);const C="DefaultAugLoopSharedSessionID";let y,v,x,T="",S=0,w=0,E=()=>{};const I=(0,f.Z8j)("Microsoft.Office.Excel.FA000000124.MaxAugloopRestartsToAllowModelWorkflows",2),R=(0,f.Z8j)("Microsoft.Office.Excel.FA000000124.AugloopRestartsTimeRangeInMs",12e4),A=e=>{const t=(0,b.wB)(e);return t.setSessionCloseCallback(L),t},L=e=>{(0,p.cY)("AugLoop session closing"),m.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.AugLoopSessionClosed},g.M.getInstance()),y.close(),S=w&&F(w)<R?S+1:1,w=Date.now();let t=C;if(d.w9.typeGuard(e)&&e.reason&&d.pr.typeGuard(e.reason)&&e.reason.newDocSessionId)t=e.reason.newDocSessionId;else if(Office.context.platform!==Office.PlatformType.OfficeOnline){if(e.reason&&d.Zy.typeGuard(e.reason)&&"PermanentError"===e.reason?.reasonDescription)return void x();g.M.getInstance().logError({eventType:h.S2.Augloop,errorMessage:"AugLoop failed to provide the new docSessionId.",logLevel:l.$b.Warning})}if(Office.context.platform===Office.PlatformType.OfficeOnline||t!==C){y=A(t);let a=!1;if(e.reason&&o.G2.typeGuard(e.reason)){a=e.reason.errorType===r.m.ModelWorkflowNotSupported}const n=S>I;a=a||n,a&&m.E.getInstance().updateTelemetryChatEventData({[u.h3.ChatEventType]:u.a5.AugLoopSessionModelWorkflowUnsupported,[u.h3.ChatEventParameters]:JSON.stringify({restartLoopDetected:n})},g.M.getInstance()),E(y,a)}};const k=e=>{""===T&&(T=e)},F=e=>Date.now()-e,_=e=>{v=e},P=e=>{E=e},N=e=>{x=e},M=async()=>{if((0,p.cY)("getting AugLoop from host"),!y){if((0,p.cY)("sdxAugLoopSession does not exist, creating a new one"),i.V.IsSettingTrue(i.z.ButtonEnabledForLocalFiles)){if(""===T)return Promise.resolve(void 0);y=A(T)}else{const e=i.V.getSettingAsString(i.z.AugloopSharedSessionID);y=A(e??C)}if(await v(y),(0,f.KV_)()&&(0,f.yw9)("OfficeVSO_10454920_AugloopSessionPolling")){const e=1e4,t=Date.now();for(;Date.now()-t<e&&!y.getConnectParams()?.routingSessionKey;){const e=Date.now()-t;g.M.getInstance().logError({eventType:h.S2.Augloop,errorMessage:`routingSessionKey not available (${e}ms)`,logLevel:l.$b.Warning}),await new Promise((e=>setTimeout(e,1e3)))}}(0,f.yw9)("OfficeVSO_9503894_AugloopDiagnosticsPane")&&(0,s.I_)()&&n.$.getInstance().init(y)}return y},O=e=>void 0===e?"undefined":c.h.getTypeNameFor(e),D=()=>i.V.IsSettingTrue(i.z.AugloopEverHadModelError)},581431:(e,t,a)=>{"use strict";async function n(e,t){const a=performance.now();try{return await e}finally{if(t){t(performance.now()-a)}}}a.d(t,{H:()=>n,q:()=>o});class o{getName(e){return this.prefix?`${this.prefix}:${e}`:e}start(e){const t=this.getName(e);this.parent?this.parent.start(t):this.measures.set(t,{startTime:performance.now(),duration:NaN})}end(e){const t=this.getName(e);if(this.parent)this.parent.end(t);else{const e=this.measures.get(t);e&&(e.duration=performance.now()-e.startTime)}}getAll(){return Object.fromEntries(this.measures.entries())}async measure(e,t){this.start(e);try{return await t}finally{this.end(e)}}withPrefix(e){return new o(e,this)}constructor(e="",t=null){this.prefix=e,this.parent=t,this.measures=new Map}}},586446:(e,t,a)=>{"use strict";function n(e){switch(e){case"values":case"xValues":case"yValues":return!0;default:return!1}}function o(e,t,a){const n=e.series[t].dataBindings,o=e.data.dimensions,r=n.find((e=>e.dimensionType===a));return r&&o.find((e=>e.id===r.dimensionId))}a.d(t,{$:()=>n,Q:()=>o})},590572:(e,t,a)=>{"use strict";a.d(t,{HK:()=>r,HW:()=>o,m9:()=>i});var n=a(267324);function o(e){return e.runs.map((e=>e.text)).join("")}function r(e,t){const a=o(e),n=a.length,r=a.substring(0,t);return t<n?r.concat(""):r}function i(e){return e.map((e=>null==e?(0,n.Atw)():e))}},593688:(e,t,a)=>{"use strict";a.d(t,{B:()=>o,q:()=>r});var n=a(893763);async function o(e,t,a){try{return await Excel.run({delayForCellEdit:!0},(async n=>{const o=i(n,e,t,a);return await n.sync(),l(o,a)}))}catch{throw new n.tF(`Failed to read the ${a} colors from table column.`,"getTableColumnColors")}}async function r(e,t,a,o){try{const n=t.map((t=>i(o,e,t,a)));return await o.sync(),n.map((e=>l(e,a)))}catch{throw new n.tF(`Failed to read the ${a} colors from table column.`,"getTableColumnColors")}}function i(e,t,a,n){const o="font"===n?{format:{font:{color:!0}}}:{format:{fill:{color:!0}}};return e.workbook.tables.getItem(t).columns.getItemAt(a).getDataBodyRange().getCellProperties(o)}function l(e,t){return e.value.map((e=>"font"===t?e[0].format?.font?.color??"#000000":e[0].format?.fill?.color??"#FFFFFF"))}},593717:(e,t,a)=>{"use strict";a.d(t,{q:()=>s,w:()=>d});var n=a(267324),o=a(83437),r=a(965634),i=a(956258),l=a(991869);function s(e,t=(0,l.gl)()){const a=function(e){try{const t=new Intl.ListFormat(e,{});return e=>t.format(e)}catch(t){return i.M.getInstance().logError({eventType:r.S2.Localization,errorMessage:`Failed to create Intl.ListFormat for locale ${e}. ${t}`,logLevel:o.$b.Warning}),c}}(t);return a(e)}function c(e){const t=[...e];if(0===t.length)return"";if(1===t.length)return t[0];const a=t.pop(),o=n.olU.And;return`${t.join(", ")} ${o} ${a}`}function d(e){if(e){return new Intl.DisplayNames([(0,l.gl)()],{type:"language"}).of(e)}}},596618:(e,t,a)=>{"use strict";a.d(t,{u:()=>o});var n=a(507628);function o(){let e;try{e=OSF._OfficeAppFactory.getHostInfo().osfControlAppCorrelationId}catch(e){}return e||(e=`local.${(0,n.A)()}`),e}},601301:(e,t,a)=>{"use strict";var n;a.d(t,{C$:()=>m,UQ:()=>n,lf:()=>d,t7:()=>u}),function(e){e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical"}(n||(n={}));const o=[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:0,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:1,isHundredPercent:!1,axisGroup:"primary"}],r=[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:1,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:0,isHundredPercent:!1,axisGroup:"primary"}],i=[{dimension:"xValues",excelAxisType:"Category",ivyDimension:"xValues",isValue:!0,orientation:0,isHundredPercent:!1,axisGroup:"primary"},{dimension:"yValues",excelAxisType:"Value",ivyDimension:"yValues",isValue:!0,orientation:1,isHundredPercent:!1,axisGroup:"primary"}],l=[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:0,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:1,isHundredPercent:!0,axisGroup:"primary"}],s=[],c={area:o,areaStacked:o,areaStacked100:l,barClustered:r,barStacked:r,barStacked100:[{dimension:"categories",excelAxisType:"Category",ivyDimension:"categoryValues",isValue:!1,orientation:1,isHundredPercent:!1,axisGroup:"primary"},{dimension:"values",excelAxisType:"Value",ivyDimension:"values",isValue:!0,orientation:0,isHundredPercent:!0,axisGroup:"primary"}],columnClustered:o,columnStacked:o,columnStacked100:l,line:o,lineStacked:o,lineStacked100:l,bubble:i,doughnut:s,pie:s,radar:o,scatter:i,histogram:o};function d(e){return e in c?c[e]:[]}function u(e){const t=m(e,"values");if(void 0===t)throw new Error("unsupported secondary axis type");return[{...t,axisGroup:"secondary"}]}function m(e,t){return c[e].find((e=>e.dimension===t))}},609138:(e,t,a)=>{"use strict";a.d(t,{A:()=>l});var n=a(171755),o=a.n(n),r=a(982649),i=a.n(r)()(o());i.push([e.id,'.ChartRecommendationCard {\n  border: 1px solid var(--colorNeutralStroke1);\n  border-radius: 18px !important;\n  margin-top: 4px;\n}\n\n.ChartRecommendationCardText {\n  font-style: normal;\n  font-weight: 600 !important;\n  font-size: 14px;\n  padding: 0px;\n}\n\n.chartContainer {\n  border: 2px solid #f5f5f5;\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n.chartContainer:hover {\n  border: 2px solid var(--colorBrandStroke1);\n}\n\n.chartContainerSelected {\n  border: 2px solid var(--colorBrandStroke1);\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n.previewDesignButton,\n.applyDesignButton {\n  border: 2px solid #edebe9 !important;\n  border-radius: 6px !important;\n  padding: 8px 6px 8px 6px !important;\n  margin-top: 10px !important;\n  margin-bottom: 0px !important;\n}\n\n.chartRecommendationCardFooter,\n.chartRecommendationCardFooter:hover {\n  color: var(--colorBrandStroke1) !important;\n  text-decoration: underline !important;\n  display: block !important;\n  border: none !important;\n  font-weight: normal !important;\n  font-size: 14px !important;\n  margin-top: 6px !important;\n  padding-left: 0px !important;\n}\n\n.noShowIcon,\n.noShowIcon:hover {\n  color: var(--colorBrandStroke1);\n  font-size: 12px;\n  padding-left: 0px;\n}\n\n.backToResultButton {\n  border: none;\n  margin-bottom: 8px;\n}\n\n.chartRecommendationLabel {\n  font-size: 14px;\n  font-weight: normal;\n  padding: 0px !important;\n  margin-top: 0px;\n  margin-bottom: 5px;\n}\n\n.chartRecommendationSubLabel {\n  font-size: 12px;\n  font-weight: lighter;\n  opacity: 0.7;\n}\n\n.chartRecommendationLabelApply {\n  font-size: 14px;\n  font-weight: normal;\n  padding: 0px !important;\n  margin-top: 10px;\n  margin-bottom: 10px;\n}\n\n.sparkleIcon {\n  width: 28px;\n  height: 26px;\n}\n\n.chartItem {\n  width: 50%;\n  align-items: stretch;\n}\n\n.ms-Stack.ms-Stack-child {\n  align-items: stretch !important;\n}\n\n.chartContainerError {\n  width: 100%;\n  text-align: center;\n  font-size: 14px;\n  font-family: "Aptos";\n  font-weight: 400;\n  color: #bdbdbd;\n  align-content: center;\n  border: 2px solid #f5f5f5;\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n@media screen and (-ms-high-contrast: active), (forced-colors: active) {\n  .ChartRecommendationCard {\n    border-radius: 18px !important;\n    border: 2px solid buttontext;\n  }\n\n  .chartContainer,\n  .chartContainerError {\n    border: 2px solid buttontext;\n  }\n\n  .chartContainer:hover,\n  .chartContainerSelected {\n    border: 2px solid highlight;\n  }\n\n  .chartRecommendationCardFooter,\n  .chartRecommendationCardFooter:hover {\n    border: 2px solid buttontext !important;\n  }\n\n  .chartRecommendationCardFooter:hover {\n    color: highlight !important;\n    border: 2px solid highlight;\n  }\n\n  .previewDesignButton,\n  .applyDesignButton {\n    border: 2px solid buttontext !important;\n  }\n\n  .previewDesignButton:hover,\n  .applyDesignButton:hover {\n    border: 2px solid highlight !important;\n  }\n\n  .backToResultButton {\n    border: 2px solid buttontext !important;\n  }\n}\n',"",{version:3,sources:["webpack://./src/frontend/styles/ChartDesignRecommendationsCard.css"],names:[],mappings:"AAAA;EACE,4CAA4C;EAC5C,8BAA8B;EAC9B,eAAe;AACjB;;AAEA;EACE,kBAAkB;EAClB,2BAA2B;EAC3B,eAAe;EACf,YAAY;AACd;;AAEA;EACE,yBAAyB;EACzB,mBAAmB;EACnB,gBAAgB;AAClB;;AAEA;EACE,0CAA0C;AAC5C;;AAEA;EACE,0CAA0C;EAC1C,mBAAmB;EACnB,gBAAgB;AAClB;;AAEA;;EAEE,oCAAoC;EACpC,6BAA6B;EAC7B,mCAAmC;EACnC,2BAA2B;EAC3B,6BAA6B;AAC/B;;AAEA;;EAEE,0CAA0C;EAC1C,qCAAqC;EACrC,yBAAyB;EACzB,uBAAuB;EACvB,8BAA8B;EAC9B,0BAA0B;EAC1B,0BAA0B;EAC1B,4BAA4B;AAC9B;;AAEA;;EAEE,+BAA+B;EAC/B,eAAe;EACf,iBAAiB;AACnB;;AAEA;EACE,YAAY;EACZ,kBAAkB;AACpB;;AAEA;EACE,eAAe;EACf,mBAAmB;EACnB,uBAAuB;EACvB,eAAe;EACf,kBAAkB;AACpB;;AAEA;EACE,eAAe;EACf,oBAAoB;EACpB,YAAY;AACd;;AAEA;EACE,eAAe;EACf,mBAAmB;EACnB,uBAAuB;EACvB,gBAAgB;EAChB,mBAAmB;AACrB;;AAEA;EACE,WAAW;EACX,YAAY;AACd;;AAEA;EACE,UAAU;EACV,oBAAoB;AACtB;;AAEA;EACE,+BAA+B;AACjC;;AAEA;EACE,WAAW;EACX,kBAAkB;EAClB,eAAe;EACf,oBAAoB;EACpB,gBAAgB;EAChB,cAAc;EACd,qBAAqB;EACrB,yBAAyB;EACzB,mBAAmB;EACnB,gBAAgB;AAClB;;AAEA;EACE;IACE,8BAA8B;IAC9B,4BAA4B;EAC9B;;EAEA;;IAEE,4BAA4B;EAC9B;;EAEA;;IAEE,2BAA2B;EAC7B;;EAEA;;IAEE,uCAAuC;EACzC;;EAEA;IACE,2BAA2B;IAC3B,2BAA2B;EAC7B;;EAEA;;IAEE,uCAAuC;EACzC;;EAEA;;IAEE,sCAAsC;EACxC;;EAEA;IACE,uCAAuC;EACzC;AACF",sourcesContent:['.ChartRecommendationCard {\n  border: 1px solid var(--colorNeutralStroke1);\n  border-radius: 18px !important;\n  margin-top: 4px;\n}\n\n.ChartRecommendationCardText {\n  font-style: normal;\n  font-weight: 600 !important;\n  font-size: 14px;\n  padding: 0px;\n}\n\n.chartContainer {\n  border: 2px solid #f5f5f5;\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n.chartContainer:hover {\n  border: 2px solid var(--colorBrandStroke1);\n}\n\n.chartContainerSelected {\n  border: 2px solid var(--colorBrandStroke1);\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n.previewDesignButton,\n.applyDesignButton {\n  border: 2px solid #edebe9 !important;\n  border-radius: 6px !important;\n  padding: 8px 6px 8px 6px !important;\n  margin-top: 10px !important;\n  margin-bottom: 0px !important;\n}\n\n.chartRecommendationCardFooter,\n.chartRecommendationCardFooter:hover {\n  color: var(--colorBrandStroke1) !important;\n  text-decoration: underline !important;\n  display: block !important;\n  border: none !important;\n  font-weight: normal !important;\n  font-size: 14px !important;\n  margin-top: 6px !important;\n  padding-left: 0px !important;\n}\n\n.noShowIcon,\n.noShowIcon:hover {\n  color: var(--colorBrandStroke1);\n  font-size: 12px;\n  padding-left: 0px;\n}\n\n.backToResultButton {\n  border: none;\n  margin-bottom: 8px;\n}\n\n.chartRecommendationLabel {\n  font-size: 14px;\n  font-weight: normal;\n  padding: 0px !important;\n  margin-top: 0px;\n  margin-bottom: 5px;\n}\n\n.chartRecommendationSubLabel {\n  font-size: 12px;\n  font-weight: lighter;\n  opacity: 0.7;\n}\n\n.chartRecommendationLabelApply {\n  font-size: 14px;\n  font-weight: normal;\n  padding: 0px !important;\n  margin-top: 10px;\n  margin-bottom: 10px;\n}\n\n.sparkleIcon {\n  width: 28px;\n  height: 26px;\n}\n\n.chartItem {\n  width: 50%;\n  align-items: stretch;\n}\n\n.ms-Stack.ms-Stack-child {\n  align-items: stretch !important;\n}\n\n.chartContainerError {\n  width: 100%;\n  text-align: center;\n  font-size: 14px;\n  font-family: "Aptos";\n  font-weight: 400;\n  color: #bdbdbd;\n  align-content: center;\n  border: 2px solid #f5f5f5;\n  border-radius: 12px;\n  overflow: hidden;\n}\n\n@media screen and (-ms-high-contrast: active), (forced-colors: active) {\n  .ChartRecommendationCard {\n    border-radius: 18px !important;\n    border: 2px solid buttontext;\n  }\n\n  .chartContainer,\n  .chartContainerError {\n    border: 2px solid buttontext;\n  }\n\n  .chartContainer:hover,\n  .chartContainerSelected {\n    border: 2px solid highlight;\n  }\n\n  .chartRecommendationCardFooter,\n  .chartRecommendationCardFooter:hover {\n    border: 2px solid buttontext !important;\n  }\n\n  .chartRecommendationCardFooter:hover {\n    color: highlight !important;\n    border: 2px solid highlight;\n  }\n\n  .previewDesignButton,\n  .applyDesignButton {\n    border: 2px solid buttontext !important;\n  }\n\n  .previewDesignButton:hover,\n  .applyDesignButton:hover {\n    border: 2px solid highlight !important;\n  }\n\n  .backToResultButton {\n    border: 2px solid buttontext !important;\n  }\n}\n'],sourceRoot:""}]);const l=i},620316:(e,t,a)=>{"use strict";a.d(t,{c:()=>n});class n{constructor(e,t){this.finished=!1,this.reject=e=>{this.finished||(this.rejectFn(e),this.finished=!0)},this.resolve=e=>{this.finished||(this.resolveFn(e),this.finished=!0)},this.resolveFn=e,this.rejectFn=t}}},622807:(e,t,a)=>{"use strict";var n,o,r,i,l,s;a.d(t,{Ki:()=>o,Oc:()=>r,Tz:()=>i,X6:()=>u,YA:()=>s,fM:()=>n,iT:()=>l,jH:()=>d,w_:()=>c}),function(e){e.Insights="Insights",e.FormulaAction="FormulaAction",e.HighlightAction="HighlightAction",e.Search="Search",e.Python="Python",e.HowToSum="HowToSum",e.DataPreparation="DataPreparation"}(n||(n={})),function(e){e.SuggestColumn="SuggestColumn",e.WriteFormula="WriteFormula",e.AddFormulaColumn="AddFormulaColumn",e.ExplainFormula="ExplainFormula",e.InvestigateError="InvestigateError",e.SplitColumns="SplitColumns",e.TotalRow="TotalRow",e.LookupFormula="LookupFormula"}(o||(o={})),function(e){e.GetDataInsights="GetDataInsights",e.AdvancedAnalysis="AdvancedAnalysis",e.PerformForecasting="PerformForecasting",e.CreateBoxplot="CreateBoxplot",e.SetOfCharts="SetOfCharts",e.GenerateWordCloud="GenerateWordCloud",e.EditPythonCode="EditPythonCode"}(r||(r={})),function(e){e.CreateTable="CreateTable",e.KeyboardShortcuts="KeyboardShortcuts",e.TipsAndTricks="TipsAndTricks",e.FreezeColumn="FreezeColumn",e.HowToCreateDropdown="HowToCreateDropdown",e.DataPreparation="DataPreparation"}(i||(i={})),function(e){e.SummarizeColumn="SummarizeColumn",e.ShowDataInsights="ShowDataInsights",e.CreatePivotTable="CreatePivotTable",e.CreatePieChart="CreatePieChart",e.GenerateGraph="GenerateGraph",e.HighlightCells="HighlightCells",e.ApplyColorCoding="ApplyColorCoding"}(l||(l={})),function(e){e.WebSearchCreateTable="WebSearchCreateTable",e.WebSearchLearn="WebSearchLearn",e.ImportTable="ImportTable",e.PrepareForMeetings="PrepareForMeetings",e.RecapEmails="RecapEmails"}(s||(s={}));const c={...o,...r,...i,...l,...s},d={...o,...i,...l,...s},u={...n,...c}},626128:(e,t,a)=>{"use strict";a.d(t,{VS:()=>U,mZ:()=>ve,Ft:()=>Ce,JM:()=>X,Ys:()=>be,jI:()=>ae,e1:()=>Z,hK:()=>ne,g0:()=>se,cY:()=>j,$k:()=>Q,iM:()=>W,L$:()=>z,be:()=>J,s9:()=>Y,fJ:()=>le,xw:()=>oe,gA:()=>K,fS:()=>te,wr:()=>ee,uq:()=>ye,aG:()=>xe,Fw:()=>ie,jL:()=>re});var n=a(932367),o=a(754440),r=a(373753),i=a(784606),l=a(549768),s=a(365319),c=a(632512),d=a(875042),u=a(267324),m=a(83437),h=a(630079),g=a(581431),p=a(255448),b=a(477543),f=a(9847),C=a(476730),y=a(965634),v=a(956258),x=a(820633),T=a(318259),S=a(880496),w=a(797639),E=a(79458),I=a(140280),R=a(528804),A=a(471742),L=a(369169),k=a(906606),F=a(47262),_=a(961554);class P extends Error{constructor(e){super(e),this.name="insertionModeError"}}class N extends Error{constructor(e){super(e),this.name="formulaMissingError"}}class M extends Error{constructor(e){super(e),this.name="rangeError"}}async function O(e,t,a){if(!t.fixedInsertionRange)throw new N("Formula missing required fixedInsertionRange property");const n=H(e.workbook.worksheets.getItem(a).getRange(t.fixedInsertionRange),t.insertionMode),{rows:o,cols:r}=(0,_.excelRangeToGridRange)((0,_.parseRangeAddress)(t.fixedInsertionRange,""));return 1===o&&1===r?await async function(e,t,a){t.formulasLocal=[[a.formula]],a.numberFormat&&(t.numberFormat=[[a.numberFormat]]);return await D(e,t,a.numberFormat),await e.sync(),t}(e,n,t):await async function(e,t,a,n,o){const r=t.getCell(0,0);r.formulasLocal=[[a.formula]],a.numberFormat&&(r.numberFormat=[[a.numberFormat]]);return await e.sync(),await D(e,r,a.numberFormat),await async function(e,t,a,n,o,r){if(n>1&&o>1){const e=a.getRow(0);t.autoFill(e),e.autoFill(a)}else t.autoFill(a);r.numberFormat&&(a.numberFormat=[[r.numberFormat]]);await e.sync()}(e,r,t,n,o,a),t}(e,n,t,o,r)}async function D(e,t,a){const n=t.getSpillingToRangeOrNullObject();if(n.load("isNullObject"),await e.sync(),!n.isNullObject)return a&&(n.numberFormat=[[a]],await e.sync()),n}async function B(e,t,a,n,o){if(a.includes(":"))throw new M("The cellAddress must be a single cell address, not a range");let r=e.workbook.worksheets.getItem(n).getRange(a);return r=H(r,o),r.values=[[t]],await e.sync(),r}async function $(e,t){return async function(e,t,a){return t.load(a),await e.sync(),t}(e,t,["address"])}function H(e,t){try{switch(t){case r.PH.ShiftDown:return e.insert(Excel.InsertShiftDirection.down);case r.PH.ShiftRight:return e.insert(Excel.InsertShiftDirection.right);case r.PH.OverrideFixedRange:case r.PH.ToTableWithOverride:case r.PH.ToTableWithoutOverride:case r.PH.OverrideSelection:case r.PH.InsertIntoEmptyCells:case void 0:return e;default:return(0,F.x)(t),e}}catch(e){throw new P(`Failed to apply insertion mode: ${e}`)}}var U,q=a(593717),V=a(525463),G=a(390624);function W(e){return 0===e.suggestionType}function z(e){return e.every(W)}function j(e){return 1===e.suggestionType}function Q(e){return e.every(j)}function J(e){return 2===e.suggestionType}function Y(e){return e.every(J)}function X(e){return e.calculatedFormulas.flatMap((e=>e.insertionIndexes)).filter((e=>void 0!==e)).sort(((e,t)=>e-t))}async function Z(e){if(!(0,L.k8)(e))return;const t=Math.min(V.do+1,e.rowCount-(e.hasTableHeaders?1:0));return e.hasHiddenRows?Excel.run((async a=>{if(e.address){const n=a.workbook.worksheets.getItem(e.sheetName).getRange(e.address).getColumn(0).getVisibleView();n.load("cellAddresses"),await a.sync();const o=function(e,t,a){const n=e.split(",").slice(a.hasTableHeaders?1:0,t+(a.hasTableHeaders?1:0));return n.map((e=>{const t=e.match(/\d+$/);return t?parseInt(t[0],10):NaN}))}(n.cellAddresses.toString(),t,e);return o}})):Array.from({length:Math.min(t,e.rowCount-(e.hasTableHeaders?1:0))},((t,a)=>e.rowIndex+(e.hasTableHeaders?1:0)+(a+1)))}function K(e,t,a,n,o=!1,r){const{tableName:i,sheetName:l,address:s}=t;if(!i||!l||!s)return Promise.resolve();if((0,R.yw9)("OfficeVSO_9658083_enableInsertOverride")&&!r)return Promise.resolve();if(0===a.length)return Promise.resolve();const c=t.hasTableHeaders?[e,...a]:[];return Excel.run((async e=>{const a=o&&t.sheetId?e.workbook.worksheets.getItem(t.sheetId):e.workbook.worksheets.getActiveWorksheet();if(o)a.activate();else if(a.load("name"),await e.sync(),a.name!==l)return;const i=a.rangeValuesPreview;if(i.onDismissed.add(n),i.show((0,R.yw9)("OfficeVSO_9658083_enableInsertOverride")?r:(0,S.cc)(s)??s,c,{autoexpandTable:!0,autofitColumns:!0}),o){const t=a.getRange(r),n=t.getOffsetRange(0,(c[0]?.length??0)+1);await w.CP.runWithNoContextRefresh((async()=>{t.getBoundingRect(n).select(),await e.sync();t.getOffsetRange(0,-1).select(),await e.sync()}))}else await e.sync()}))}function ee(e,t,a,n,o=!1,r){if((0,R.yw9)("OfficeVSO_9753947_insertCellToFixedRange")&&!r)return Promise.resolve();const{tableName:i,sheetName:l,showTotals:s,address:c}=e;return i&&l&&c?0===t.length||void 0===a?Promise.resolve():Excel.run((async i=>{const d=o&&e.sheetId?i.workbook.worksheets.getItem(e.sheetId):i.workbook.worksheets.getActiveWorksheet();if(o)d.activate();else if(d.load("name"),await i.sync(),d.name!==l)return;const u=d.rangeValuesPreview,m=(0,R.yw9)("OfficeVSO_9753947_insertCellToFixedRange")&&r?r:(0,S.K3)(c,a)??c;if(u.onDismissed.add(n),u.show(m,[t],{autoexpandTable:!0,autofitColumns:!0}),o){const e=d.getRange(r);if(s)e.select(),await i.sync();else{const t=e.getOffsetRange(1,0),a=e.getOffsetRange(-1,0);await w.CP.runWithNoContextRefresh((async()=>{t.select(),await i.sync(),a.select(),await i.sync()}))}}else await i.sync()})):Promise.resolve()}function te(e,t,a){return 0===t.length?Promise.resolve():Excel.run((async n=>{const o=n.workbook.worksheets.getActiveWorksheet().rangeValuesPreview;o.onDismissed.add(a),o.show(e,t,{autoexpandTable:!0,autofitColumns:!0})}))}async function ae(e){const{rowIndex:t,rowCount:a,columnIndex:n,columnCount:o,sheetName:r}=e;if(!r)throw new Error("getRowValuesUnderneathTable: sheetName is undefined");return Excel.run((async e=>{const i=e.workbook.worksheets.getItem(r).getRangeByIndexes(t+a,n,1,o);return i.load("text"),await e.sync(),i.text[0]}))}function ne(e){return Excel.run((async t=>{(e?t.workbook.worksheets.getItem(e):t.workbook.worksheets.getActiveWorksheet()).rangeValuesPreview.dismiss(),await t.sync()}))}function oe(e,t,a,n,o){return v.M.getInstance().runTimedAsyncFunction("InsertColumn",(()=>async function(e,t,a,n,o){const r=[];try{if(!t.calculatedFormulas)return{insertionAddresses:r};let{calculatedFormulas:i}=t;const l=(0,L.UN)(t);let s;l&&(i=[...i],i.sort(((e,t)=>(e.insertionIndex??Number.MAX_SAFE_INTEGER)-(t.insertionIndex??Number.MAX_SAFE_INTEGER))));const c=[],d=new g.q("insertColumnApi");try{await(0,G.F5)((async e=>{for(let t=0;t<i.length;t++){const u=t,{address:m,selectedRange:h}=await de(i[t],a,n,u,s,c,e,o,d.withPrefix(`column${t}`));r.push(m),l||(s=h)}}),{operationTimers:d.withPrefix("undoScope")})}finally{C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.FormulaSuggestionInsertColumnTimings,[f.h3.ChatEventParameters]:JSON.stringify({requestId:e,recommendationId:t.id,timers:d.getAll()})},v.M.getInstance())}return{insertionAddresses:r}}catch(e){return{insertionAddresses:r,insertionError:e}}}(n,e,t,a,o)),n,e.id)}function re(e,t,a,r){return(0,R.yw9)("OfficeVSO_9546218_validatePreviewForRow")?v.M.getInstance().runTimedAsyncFunction("verifyCalcValueMatchesRowPreviewApi",(()=>async function(e,t,a,r){async function i(){let e=0,n=!1;const o=[];return await Excel.run({delayForCellEdit:!0},(async r=>{const{sheetName:i}=a;if(!i)throw new Error("Sheet name is undefined in selectionContext");const s=r.workbook.worksheets.getItem(i);for(let a=0;a<t.length;a++){const i=t[a],c=s.getRange(i);c.load("text, values"),await r.sync();const d=c.text[0];for(let t=0;t<d.length;t++)if(o.push(d[t]),d[t]!==l[e++]){n=!0;break}if(n)break}})),{isMismatch:n,gridTexts:o}}if(!e||0===e.length)return;t.sort(((e,t)=>(0,S.Jx)(e)-(0,S.Jx)(t)));const l=e[0],{isMismatch:s,gridTexts:d}=await i();if(s){const e=l.slice(0,d.length);v.M.getInstance().logStandardizedAshaErrorEvent(o.W.UI_Failed_To_Update_Or_Load,n.c.Mismatch_Between_Preview_And_Grid_Values,f.BJ.FormulaGeneration);const t=(0,S.sq)([e]),a=(0,S.sq)([d]);v.M.getInstance().logErrorCode(c.O.PreviewValidationFailed,new Error(`Preview value doesn't match the value on the grid. anonymized preview values: ${t}. anonymized grid values: ${a}`),y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:r})}}(e,t,a,r)),r):Promise.resolve()}function ie(e,t,a,r){return v.M.getInstance().runTimedAsyncFunction("VerifyCalcValueMatchesPreview",(()=>async function(e,t,a,r){async function i(e){return await Excel.run({delayForCellEdit:!0},(async n=>{const{sheetName:o,hasTableHeaders:r}=a,i=n.workbook.worksheets.getItem(o).getRange(t[0]),l=e.length-1,s=i.getCell(r?1:0,0).getResizedRange(l,0);s.load("text, values"),await n.sync();let c=!1;for(let t=0;t<l;t++)if(e[t][0]!==s.text[t][0]){c=!0;break}return{isMismatch:c,allZeroes:s.values.every((e=>0===e[0])),gridRangeValues:s.text}}))}async function l(){return await Excel.run({delayForCellEdit:!0},(async e=>(e.application.load("calculationMode"),await e.sync(),"Automatic"===e.application.calculationMode&&(e.application.calculate("Recalculate"),!0))))}if(!e||0===e.length)return;const s=Math.min(5,e.length),d=e.slice(0,s);let{isMismatch:u,allZeroes:h,gridRangeValues:g}=await i(d),p=!1;u&&h&&(p=await l(),p&&({isMismatch:u}=await i(d)));if(u){const e=/^#.+[?|!]$/,t=(0,S.sq)(d),a=(0,S.sq)(g);t.some((t=>e.test(t)))||a.some((t=>e.test(t)))||v.M.getInstance().logStandardizedAshaErrorEvent(o.W.UI_Failed_To_Update_Or_Load,n.c.Mismatch_Between_Preview_And_Grid_Values,f.BJ.FormulaGeneration),v.M.getInstance().logErrorCode(c.O.PreviewValidationFailed,new Error(`Preview value doesn't match the value on the grid. attempted recalc: ${p}. anonymized preview values: ${t}. anonymized grid values: ${a}`),y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:r})}}(e,t,a,r)),r)}async function le(e,t,a,n){return e.calculatedFormulas?(0,S.th)(e)?v.M.getInstance().runTimedAsyncFunction("InsertCellToSelection",(()=>async function(e){try{if(!e.isSingleFormula)throw new Error("insertCellToSelection: expected a single formula");const t=await(0,G.F5)((async t=>await ce(t,e.calculatedFormulas[0],t.workbook.getActiveCell())));return{insertionAddresses:t?[t]:[]}}catch(t){return v.M.getInstance().logErrorCode(c.O.InsertCalculatedCellToSelectionFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e.id}),{insertionAddresses:[],insertionError:t}}}(e)),n,e.id):(0,S.By)(e)?v.M.getInstance().runTimedAsyncFunction("InsertCellToFixedRange",(()=>async function(e){try{const t=e.calculatedFormulas[0]?.fixedInsertionRange;if(!t)throw new Error("insertCellToFixedRange: first formula is missing or doesn't have a fixedInsertionRange");const a=(0,A.vt)(t),n=await(0,G.F5)((async t=>{const n=t.workbook.worksheets.getActiveWorksheet();return await ce(t,e.calculatedFormulas[0],n.getCell(a.row-1,a.column-1))}));return{insertionAddresses:n?[n]:[]}}catch(t){return v.M.getInstance().logErrorCode(c.O.InsertCalculatedCellToFixedRangeFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e.id}),{insertionAddresses:[],insertionError:t}}}(e)),n,e.id):v.M.getInstance().runTimedAsyncFunction("InsertCell",(()=>async function(e,t){const a=[];let n,o=!1;try{const r=e.calculatedFormulas.flatMap((e=>{const t=(0,L.Ne)(e.insertionIndexes??[]),a=t.reduce(((e,t)=>e+t.length),0);if(!e.formulasToInsert||e.formulasToInsert.length!==a)throw new Error(`insertCellRecommendationApi: formula ${e.id} - formulasToInsert is not defined or has different length than insertionIndexes`);let n=0;return t.map((t=>({...e,insertionIndexes:t,formulasToInsert:t.map((()=>{const t=e.formulasToInsert?.[n]??e.formula;return n++,t}))})))})),i=new g.q("insertCellRecommendationApi");try{await(0,G.F5)((async l=>{t.showTotals||await i.measure("addEmptyRowIfNeededApi",async function(e,t,a){try{const{rowCount:e,rowIndex:n,columnIndex:o,sheetName:r,columnCount:i}=t;if(!r)throw new Error("addEmptyRowIfNeededApi: sheetName or showTotals are null or undefined");if(!a)throw new Error("addEmptyRowIfNeededApi: context is undefined");const l=await async function(e,t,a,n,o,r){const i=r.workbook.worksheets.getItem(o),l=i.getRangeByIndexes(a+e,n,1,t);l.load("valueTypes"),await r.sync();const s=(0,S.RV)(l);return s}(e,i,n,o,r,a);l||await async function(e,t,a,n,o,r){const i=e.workbook.worksheets.getItem(r);let l=i.getRangeByIndexes(n+t,o,1,a);return l=l.insert(Excel.InsertShiftDirection.down),l.clear(),l}(a,e,i,n,o,r)}catch(t){throw v.M.getInstance().logErrorCode(c.O.CalculatedCellPartialInsertFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e}),t}}(e.id,t,l));for(let s=0;s<r.length;s++){const c=r[s],d=i.withPrefix(`formulaGroup:${s}`);try{const{address:n}=await ue(c,t,l,Boolean(t.showTotals&&e.allowReplacementOfExistingValue),d);a.push(n)}catch(e){n=e,o=!0}}if(e.insertRowTitle){const a=i.withPrefix("Title");await async function(e,t,a,n){n.start("total");try{return await async function(e,t){const{rowCount:a,rowIndex:n,columnIndex:o,sheetName:r}=e,i=t.workbook.worksheets.getItem(r),l=i.getRangeByIndexes(n+a,o,1,1);if(l.load("valueTypes"),await t.sync(),!(0,S.RV)(l))return;l.values=[[u.olU.CalculatedRowsFormulaTotalHeader]],await t.sync()}(t,a)}catch(t){throw v.M.getInstance().logErrorCode(c.O.DefaultInsertCalculatedCellTitleFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e}),t}finally{n.end("total")}}(e.id,t,l,a)}if(await async function(e,t){const{rowCount:a,rowIndex:n,columnIndex:o,columnCount:r,sheetName:i}=e,l=t.workbook.worksheets.getItem(i);return l.getRangeByIndexes(n+a,o,1,r).format.font.bold=!0,t.sync()}(t,l),o)throw n}),{operationTimers:i.withPrefix("undoScope")})}finally{C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.FormulaSuggestionInsertRowTimings,[f.h3.ChatEventParameters]:JSON.stringify({requestId:e.id,timers:i.getAll()})},v.M.getInstance())}return{insertionAddresses:a}}catch(e){return{insertionAddresses:a,insertionError:e}}}(e,a)),n,e.id):{insertionAddresses:[]}}async function se(e){return await(0,G.F5)((async t=>{const a=t.workbook.worksheets.getActiveWorksheet();a.load("name"),await t.sync();const n=[];for(const o of e.calculatedFormulas){o.title&&o.titleTargetRange&&await B(t,o.title,o.titleTargetRange.address,a.name,o.titleTargetRange.insertionMethod);const e=await O(t,o,a.name);await $(t,e),n.push(e.address)}return(0,q.q)(n)}))}async function ce(e,t,a){return a.set({formulasLocal:[[t.formula]],numberFormat:[[t.numberFormat]]}),a.select(),a.load("address"),await e.sync(),a.address}async function de(e,t,a,n,o,i,l,s,d){try{if(e.insertionMode===r.PH.ToTableWithOverride&&(0,R.yw9)("OfficeVSO_9658083_enableInsertOverride"))return await async function(e,t,a,n,o,r){if(!o)throw new Error("overrideColumnInTable: context is undefined");const{showTotals:i,rowIndex:l,columnIndex:s,columnCount:c,sheetName:d,hasTableHeaders:u}=t,m=t.rowCount;if(!d||null==i)throw new Error("overrideColumnInTable: sheetName or showTotals are null or undefined");const h=o.workbook.worksheets.getItem(d),g=m+(i?1:0),p=h.getRangeByIndexes(l,s+(e.insertionIndex??c),g,1);return await ge(o,p,e,i,u,a,n,!1,r)}(e,a,o,d.withPrefix("overrideColumnInTable"),l,s);if(void 0!==e.insertionIndex)return await me(e,t,a,n,o,i,d.withPrefix("partialInsertColumn"),l,e.insertionIndex,s);try{return await async function(e,t,a,n,o,r,i,l){try{r.start("total");const s=t.hasTableHeaders,{showTotals:d,rowCount:u,rowIndex:m,columnCount:h,columnIndex:g,sheetName:p,isTable:b}=t;if(!p||null==d)throw new Error("expandTableWithNewColumn: sheetName or showTotals are null or undefined");if(!i)throw new Error("expandTableWithNewColumn: context is undefined");let f=e;if(o.length>0){const t=await r.measure("adjustFormulaReferencesToNewColAddition",(0,T.tn)(e.formula,o,p,m,u,g,h,l));f={...e,formula:t}}return await function(e,t,a,n,o,r,i,l,s,d,u,m,h){return async g=>{const p=g.workbook.worksheets.getItem(l),b=n+(a?1:0),f=p.getRangeByIndexes(o,i+r+t,b,1);f.load("valueTypes"),await m.measure("newColRange.load(valueTypes)",g.sync());if(f.valueTypes.every((e=>e.every((e=>e===Excel.RangeValueType.empty)))))return s||f.clear(),await he(g,f,e,a,s,d,u,m.withPrefix("fillFormulaAndFormat"),h);throw new Error(c.O.CalculatedColumnExpandFailedNotEmptyColumn)}}(f,a,d,u,m,h,g,p,b,s,n,r,l)(i)}catch(t){throw t.message===c.O.CalculatedColumnExpandFailedNotEmptyColumn?C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedColumnExpandFailedNotEmptyColumn,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()):C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedColumnExpandFailed,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()),t}finally{r.end("total")}}(e,a,n,o,i,d.withPrefix("expandTableWithNewColumn"),l,s)}catch(r){if(C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.DefaultInsertCalculatedColumnFailed,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()),r.message===c.O.CalculatedColumnExpandFailedNotEmptyColumn)return await me(e,t,a,n,o,i,d.withPrefix("partialInsertColumn-ExpandFailedNotEmptyColumn"),l);throw r}}catch(a){throw await async function(e,t,a){try{await Excel.run((async a=>{const n=a.workbook.tables.getItem(t);n.columns.load("items"),await a.sync();const o=n.columns.items[n.columns.count-1];o.name===e&&(o.delete(),await a.sync())}))}catch(e){v.M.getInstance().logErrorCode(c.O.DeleteLastColumnFailed,e,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:a})}}(e.columnName,t,e.id),a}}async function ue(e,t,a,n,o){o.start("total");try{return await async function(e,t,a,n,o){try{const{rowCount:r,rowIndex:i,columnIndex:l,sheetName:s}=t;if(!s)throw new Error("insertColumnAggregationUnderTable: sheetName null or undefined");return await async function(e,t,a,n,o,r,i,l){const s=r.workbook.worksheets.getItem(o),d=s.getRangeByIndexes(a+t,n+(e.insertionIndexes?.[0]??0),1,e.insertionIndexes?.length??1);let u=!1;i||(d.load("valueTypes"),await l.measure("newRowRange.load(valueTypes)",r.sync()),u=(0,S.RV)(d));if(u||i){const t=e.insertionIndexes?.map((()=>e.numberFormat))??[];return d.set({formulasLocal:[e.formulasToInsert],numberFormat:[t]}),d.select(),d.load("address"),await l.measure("newRowRange.set",r.sync()),{address:d.address,selectedRange:d}}throw new Error(c.O.CalculatedCellExpandFailedNotEmptyCell)}(e,r,i,l,s,a,n,o)}catch(t){throw t.message===c.O.CalculatedCellExpandFailedNotEmptyCell?C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedCellExpandFailedNotEmptyCell,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()):C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedCellExpandFailed,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()),t}}(e,t,a,n,o)}catch(t){throw v.M.getInstance().logErrorCode(c.O.DefaultInsertCalculatedCellFailed,t,y.S2.FormulaGeneration,m.$b.Warning,{key:f.un.SuggestionID,value:e.id}),t}finally{o.end("total")}}async function me(e,t,a,n,o,r,i,l,s,c){const{showTotals:d,rowCount:u,rowIndex:m,columnCount:h,columnIndex:g,sheetName:p,isTable:b}=a;if(!p||null==d)throw new Error("partialInsertColumn: sheetName or showTotals are null or undefined");try{if(i.start("total"),!l)throw new Error("partialInsertColumn: context is undefined");return await function(e,t,a,n,o,r,i,l,s,c,d,u,m,h,g,p){return async b=>{const f=await h.measure("partialInsertEmptyColumn",async function(e,t,a,n,o,r,i,l,s,c){let d;if(s){const t=void 0!==c?c+r:-1;d=e.workbook.tables.getItem(l).columns.add(t).getRange()}else{const l=void 0!==c?n+c+r:n+o+r;d=e.workbook.worksheets.getItem(t).getRangeByIndexes(a,l,i,1),d=d.insert(Excel.InsertShiftDirection.right),d.clear()}return d}(b,s,r,l,i,a,o,t,c,g));m.push(g??i);const C=await h.measure("adjustFormulaReferencesToNewColAddition",(0,T.tn)(e.formula,m,s,r,o,l,i,p)),y={...e,formula:C};return await he(b,f,y,n,c,u,d,h.withPrefix("fillFormulaAndFormat"),p)}}(e,t,n,d,u,m,h,g,p,b,o,a.hasTableHeaders,r,i,s,c)(l)}catch(t){throw C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedColumnPartialInsertFailed,[f.h3.ChatEventParameters]:JSON.stringify({suggestionID:e.id})},v.M.getInstance()),t}finally{i.end("total")}}async function he(e,t,a,n,o,r,i,l,s){if(l.start("total"),!o){const e=t.getOffsetRange(0,-1);t.copyFrom(e,Excel.RangeCopyType.formats),t.conditionalFormats.clearAll()}const c=await ge(e,t,a,n,r,i,l,!0,s);return l.end("total"),c}async function ge(e,t,a,n,o,r,i,l,s){let d=!1,u=!1,h=null;for(let g=0;g<2;g++)try{return await pe(e,t,a.columnName,a.formula,a.nonLocalizedFormula,a.numberFormat,n,o,r,d,u,i.withPrefix(`fillFormulaAndFormatWithAutoFill:${g}`))}catch(e){if("InvalidArgument"!==e.code)throw e;if(e.debugInfo.errorLocation===h)throw e;if(h=e.debugInfo.errorLocation,"Range.formulasLocal"===e.debugInfo.errorLocation&&a.nonLocalizedFormula){if(v.M.getInstance().logErrorCode(c.O.CalculatedColumnsInvalidFormula,e,y.S2.FormulaGeneration,m.$b.Warning),(0,R.yw9)("OfficeVSO_9663933_FixFormulaSuggestionInsertionInvalidArgErrors")&&"en-us"===s?.dataLocale?.toLowerCase())throw e;d=!0}else{if("Range.autoFill"!==e.debugInfo.errorLocation)throw e;if(v.M.getInstance().logErrorCode(c.O.InsertCalculatedColumnWithTargetRangeFailed,e,y.S2.FormulaGeneration,m.$b.Warning),!l)throw e;u=!0}}throw new Error("Failed to fill formula after 2 retries")}async function pe(e,t,a,n,o,r,i,l,s,c=!1,d=!1,u){u.start("total");const m=t.getCell(0,0),h=Te();!h&&l&&(m.values=[[a]]);const g=l?m.getOffsetRange(1,0):m;g.numberFormat=[[r]],c?g.values=[[o]]:(0,x.r1)()?g.formulasLocal=[[n]]:g.values=o?[[o]]:[[n]];const p=t.getOffsetRange(l?1:0,0).getResizedRange((i?-2:-1)+(l?0:1),0);g.autoFill(d?void 0:p,Excel.AutoFillType.fillDefault),Te()||await u.measure("ContextSyncMidInsert",e.sync()),h&&l&&(m.values=[[a]]),p.numberFormat=[[r]],t.format.autofitColumns();const b=s?s.getBoundingRect(t):t;return b.select(),t.load("address"),await u.measure("ContextSyncPostInsert",e.sync()),u.end("total"),{address:t.address,selectedRange:b}}function be(e,t){const{values:a,formulas:n}=t,o=Math.min(a.length,n?.length??1/0,(0,R.xyg)("CalculatedColumnsMaxRows"),(0,R.xyg)("CalculatedColumnsMaxCells")/a[0].length),r=[];for(let n=0;n<o;n++)for(let o=0;o<a[n].length;o++)r.push((0,I.I)(t,n,o,e.rowIndex,e.columnIndex));return r}function fe(e){return{decimalSeparator:e.localeInfo.decimalPoint,thousandsSeparator:e.localeInfo.digitGrouping,currencySymbol:e.localeInfo.currencySymbol,dayNameLong:e.localeInfo.longDay,dayNameShort:e.localeInfo.shortDay,monthNameLong:e.localeInfo.longMonth,monthNameShort:e.localeInfo.medMonth}}function Ce(e){const{errorTypeNames:t,specialRefNames:a,worksheetFunctionNames:n,...o}=e;return o}async function ye(e,t,a,n,o,r,u,g,T,w,I,A,L){let F,_;if((0,R.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1))try{_=await(0,S.Fr)()}catch(e){v.M.getInstance().logErrorCode(c.O.SubmitExcelIntelligenceOperationFailedOnGetActiveSheetName,e,y.S2.FormulaGeneration,m.$b.Warning)}try{F=await(0,S.Z$)()}catch(e){v.M.getInstance().logErrorCode(c.O.SubmitExcelIntelligenceOperationFailedOnGetActiveCell,e,y.S2.FormulaGeneration,m.$b.Warning)}let P;if(e){const l=await v.M.getInstance().runTimedAsyncFunction("GetVisibleRows",(()=>Z(e)),n);(0,E.cY)("visibleRows: ",l),P=function(e,t,a,n,o,r,l,s,u,h,g,b,f,C,T){if(!e.tableName||!(0,R.yw9)("CalculatedColumnsTLRSupport")&&!e.isTable)return null;const S=[];if((0,R.UBP)()||r){if(!a)return v.M.getInstance().logErrorCode(c.O.CalculatedColumnFailedToSendSignal,new Error("convertFormulaSuggestionToResult dataSourceApi is undefined"),y.S2.FormulaGeneration,m.$b.Error),null;S.push(...be(e,a))}const w=(0,k.at)(e,e.sheetId??""),E=(0,x.r1)(),I=(0,R.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1);return new i.v({sheetName:I?f??"":e.sheetName??"",tableInfo:{hasHeaderRow:e.hasTableHeaders,hasTotalRow:e.showTotals??!1,tableName:e.tableName},cells:S,tableAddress:e.address,userPrompt:l,requestId:n,scenarioType:I?d.az.NlToFormulaSuggestion:o,isCtrlTTable:e.isTable,dataLocale:t.dataLocale,localeInfoForPreview:E?void 0:fe(t),range:w,outputLanguage:h,visibleRows:g,isGeneralSuggestionsRequest:u,localeInfo:E?Ce(t.calcLocaleInfo):void 0,isHybrid:!r,workbookTables:(0,R._mi)()?b:void 0,queryOrigin:s??p.Rk.ChatUserPrompt,activeCellAddress:C,onGridQueryCellAddress:T,activeWorksheetId:e.sheetId})}(e,t,a,n,o,r,g,T,u,I,l,A,_,F,L)}else P=function(e,t,a,n,o,r,l,s,c,u,m,h,g){const p=(0,x.r1)();return new i.v({sheetName:m??"",tableInfo:{hasHeaderRow:!1,hasTotalRow:!1,tableName:e},cells:[],tableAddress:void 0,userPrompt:r,requestId:a,scenarioType:(0,R.iPS)("Microsoft.Office.Excel.FA000000124.AugLoop.FormulaGenerationNewNlToFormulaSkill",!1)?d.az.NlToFormulaSuggestion:n,isCtrlTTable:void 0,dataLocale:t.dataLocale,localeInfoForPreview:p?void 0:fe(t),range:void 0,outputLanguage:c,visibleRows:void 0,isGeneralSuggestionsRequest:s,localeInfo:p?Ce(t.calcLocaleInfo):void 0,isHybrid:!o,workbookTables:u,queryOrigin:l,activeCellAddress:h,onGridQueryCellAddress:g})}(w??"",t,n,o,r,g,T,u,I,A,_,F,L);if(!P)return Promise.reject(new Error("Invalid signal object"));const N=new b.g0({parentPath:["session","doc"],items:[{id:h.r.generateId(),body:P}]});C.E.getInstance().updateTelemetryChatEventData({[f.h3.ChatEventType]:f.a5.CalculatedColumnsSignalSent,[f.h3.ChatEventParameters]:JSON.stringify({scenarioType:o})},v.M.getInstance()),s.$.getInstance().submitOperation({operation:N,workflowAnnotationType:l.lL.getTypeName()})}function ve(e,t,a){if(e.requestId===t){if(!1===e.success)return{success:!1,result:void 0,suggestionType:a,suggestionMetadata:e.suggestionMetadata,debugInfo:e.debugInfo};const n=l.lL.typeGuard(e)?e.calculatedColumns?{id:xe(e.requestId,e.suggestionId),suggestionType:0,isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,calculatedFormulas:e.calculatedColumns,allowReplacementOfExistingValue:!1,debugInfo:e.debugInfo}:e.calculatedColumn?{suggestionType:0,id:xe(e.requestId,e.suggestionId),isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,allowReplacementOfExistingValue:!1,calculatedFormulas:[{id:e.suggestionId,description:e.description,formulaExplanation:e.formulaExplanation,formula:e.calculatedColumn.formula,columnName:e.calculatedColumn.columnName,title:e.calculatedColumn.title,numberFormat:e.calculatedColumn.numberFormat,structRefsFormula:e.calculatedColumn.structRefsFormula,insertionIndex:e.calculatedColumn.insertionIndex,nonLocalizedFormula:e.calculatedColumn.nonLocalizedFormula}]}:void 0:void 0,o=l.Dv.typeGuard(e)&&e.calculatedCells?{id:xe(e.requestId,e.suggestionId),suggestionType:1,isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,calculatedFormulas:e.calculatedCells,allowReplacementOfExistingValue:void 0,debugInfo:e.debugInfo}:void 0,r=l.sG.typeGuard(e)&&e.extendedFormulas?{id:xe(e.requestId,e.suggestionId),suggestionType:2,isAlternativeSuggestion:e.isAlternativeSuggestion??!1,isInserted:!1,calculatedFormulas:e.extendedFormulas,debugInfo:e.debugInfo,response:e.response}:void 0,i=n||o||r;return i?{success:!0,result:[i]}:(v.M.getInstance().logErrorCode(c.O.CalculatedColumnConvertAnnotationToRecommendationFailed,new Error("convertFormulaSuggestionToResult failed"),y.S2.FormulaGeneration,m.$b.ASHA,{key:f.un.SuggestionID,value:xe(t,e.suggestionId??"not found")}),{success:!1,result:void 0,suggestionType:a,suggestionMetadata:e.suggestionMetadata,debugInfo:e.debugInfo})}return{success:!0,result:void 0}}function xe(e,t){return`${e}_${t}`}function Te(){return(0,R.yw9)("OfficeVSO_9273998_skipContextSyncByBuildVersionV2")?(0,x.w0)(["PC:17425","Mac:84.414","OfficeOnline:true"]):(0,R.iPS)("Microsoft.Office.Excel.FA000000124.RemoveContextSyncMidInsert",!1)}!function(e){e[e.Column=0]="Column",e[e.Cell=1]="Cell",e[e.Formula=2]="Formula"}(U||(U={}))},627603:(e,t,a)=>{"use strict";a.d(t,{Kz:()=>R,Nl:()=>w,UD:()=>S,bs:()=>I,ci:()=>E,fo:()=>A});var n=a(365319),o=a(267324),r=a(322271),i=a(663280),l=a(262452),s=a(644737),c=a(9847),d=a(83437),u=a(477543),m=a(476730),h=a(965634),g=a(956258),p=a(235373),b=a(162800),f=a(47262),C=a(4091),y=a(555454),v=a(495501),x=a(936044),T=a(507628);async function S(e,t){const a=l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,r={success:!1,requestId:t.requestId,sessionId:t.sessionId};try{e((0,C.eM)(c.OP.EnterDataShapingMode)),e(p.m.clearSuggestionList());const i=a.onQueryScriptChanged.subscribe((a=>{const n={started:!1,disableQueryScriptUpdates:!1,requestId:t.requestId,sessionId:t.sessionId};try{const t=e((0,C.SW)());if(n.started=t.started,n.disableQueryScriptUpdates=t.started&&t.disableQueryScriptUpdates,!t.started||t.disableQueryScriptUpdates||t.queryScript===a)return;e(p.m.updateDataShapingQueryScript(a)),e(p.m.addDataShapingChatEntry({kind:"ManualEdit"})),(0,s.s_)(s.H0.DisableUndo)}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingQueryScriptChanged,[c.h3.ChatEventParameters]:JSON.stringify(n)},g.M.getInstance())}})),l=a.onPreviewClosed.subscribe((a=>{const r={reason:a,requestId:t.requestId,sessionId:t.sessionId};try{if("FAILURE"===a||"ERROR"===a){e((0,C.L4)()),e(p.m.exitDataShapingMode()),e(p.m.exitSingleMode());const{message:t,telemetry:a}=v.n.getDataShapingErrorResponse((0,o.y3x)());n.$.getInstance().displayResponse(t,a)}}finally{try{i.unsubscribe(),l.unsubscribe()}catch{}m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingPreviewClosed,[c.h3.ChatEventParameters]:JSON.stringify(r)},g.M.getInstance())}}));await a.startPreview(t.queryName,t.mashupDocument,t.tableName),e(p.m.enterDataShapingMode(t)),e(p.m.enterSingleMode({feature:"dataShaping",caption:(0,o.Bdz)(),exitMenuOptions:[{key:"replace",text:(0,o.bCm)()},{key:"newSheet",text:(0,o.SpP)()},{key:"discard",text:(0,o.Bms)()}]})),e((0,C.L4)()),e(p.m.setLatestRequestId(t.requestId));const d=JSON.stringify({queryScript:t.queryScript});v.n.displayDataShapingIntroResponse(d,t.requestId),r.success=!0}catch(t){g.M.getInstance().logError({eventType:h.S2.DataShaping,errorMessage:`got error during handling start mode: ${t} (${JSON.stringify(t)})`,logLevel:d.$b.Error}),await a.endPreview("ERROR"),e((0,C.L4)()),e(p.m.exitDataShapingMode()),e(p.m.exitSingleMode());const{message:r,telemetry:i}=v.n.getDataShapingErrorResponse((0,o.A99)());n.$.getInstance().displayResponse(t.message||r,i)}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingStartMode,[c.h3.ChatEventParameters]:JSON.stringify(r)},g.M.getInstance())}}async function w(e,t){let a="DECLINE";const r={success:!1,exitModeError:!1,started:!1,sessionId:"",exitReason:t?.key};try{const i=e((0,C.SW)());r.started=i.started,i.started&&(r.sessionId=i.sessionId);const u=l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,m=t?.key;try{if(!m)return void g.M.getInstance().logError({eventType:h.S2.DataShaping,errorMessage:"Unexpected: endDataShapingMode called without an exit option",logLevel:d.$b.Error});e((0,C.eM)(c.OP.ExitDataShapingMode)),(0,s.s_)(s.H0.DisableUndo);const t=await E(e,m);a=t.reason;const{message:o,telemetry:i}=v.n.getExitModeResponse(m,t.metadata);n.$.getInstance().displayResponse(o,i),r.success=!0}catch(e){const{message:t,telemetry:r}=v.n.getDataShapingErrorResponse((0,o.qmi)());n.$.getInstance().displayResponse(t,r),a="ERROR",g.M.getInstance().logError({eventType:h.S2.DataShaping,errorMessage:`Failed to apply exit mode action: ${m}, ${e} (${JSON.stringify(e)})`,logLevel:d.$b.Error})}finally{const t="FAILURE"===a?"ERROR":a;await u.endPreview(t),e((0,C.L4)()),e(p.m.exitDataShapingMode()),e(p.m.exitSingleMode())}}catch(e){r.exitModeError=!0,g.M.getInstance().logError({eventType:h.S2.DataShaping,errorMessage:`got error during handling exit mode: ${e} (${JSON.stringify(e)})`,logLevel:d.$b.Error})}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingEndMode,[c.h3.ChatEventParameters]:JSON.stringify(r)},g.M.getInstance())}}async function E(e,t){const a=l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value,n=await a.getQueryScript();switch(t){case"replace":{const t=await async function(e,t){const a=(0,T.A)(),n=e((0,C.SW)()),o=n.started?n.tableName:"",l=new u.g0({parentPath:["Signal",r.Cm.getTypeName()],items:[{id:a,body:new r.Cm({requestId:a,conversationId:a,tableId:o,queryScript:t,enableDebugging:n.enableDebugging})}]}),s=await(0,x.T)(l,a,h.S2.DataShaping,c.OP.DataShaping,i.Dd.getTypeName());if(!s?.success)throw new Error(`Failed to retrieve table update plan. ${s?.errorMessage}`);return await(0,b.UO)(s),s}(e,n);return{reason:"ACCEPT",metadata:{queryScript:n,requestJson:t.requestJson}}}case"newSheet":{const t=e((0,C.SW)()),a=t.started?t.tableName:"";return await(0,y.rc)(n,a),{reason:"ACCEPT",metadata:{queryScript:n}}}case"discard":break;default:(0,f.x)(t)}return{reason:"DECLINE",metadata:{}}}async function I(e,t){const a={success:!1,started:!1,sessionId:""};try{const n=e((0,C.SW)());a.started=n.started,n.started&&(a.sessionId=n.sessionId),e(p.m.setDisableQueryScriptUpdates(!0)),await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.appendSteps(t);const o=await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.getQueryScript();e(p.m.updateDataShapingQueryScript(o)),e(p.m.setDisableQueryScriptUpdates(!1)),a.success=!0}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingAddSteps,[c.h3.ChatEventParameters]:JSON.stringify(a)},g.M.getInstance())}}async function R(e,t){const a={success:!1,started:!1,sessionId:""};try{const n=e((0,C.SW)());a.started=n.started,n.started&&(a.sessionId=n.sessionId);for(const e of t.reverse())await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.removeStep(e.name);a.success=!0}catch(e){g.M.getInstance().logError({eventType:h.S2.DataShaping,errorMessage:`IDataShapingPrivateSdxApiService.removeStep failed with error ${e} (${JSON.stringify(e)})`,logLevel:d.$b.Warning})}finally{m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingUndoSteps,[c.h3.ChatEventParameters]:JSON.stringify(a)},g.M.getInstance())}}async function A(e,t){const a={success:!1,started:!1,sessionId:""};try{const n=e((0,C.SW)());a.started=n.started,n.started&&(a.sessionId=n.sessionId),e(p.m.setDisableQueryScriptUpdates(!0)),await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.updateQueryScript(t),t=await l.s.getInstance().NativeServices.IDataShapingPrivateSdxApiService.value.getQueryScript(),e(p.m.updateDataShapingQueryScript(t)),a.success=!0}finally{e(p.m.setDisableQueryScriptUpdates(!1)),m.E.getInstance().updateTelemetryChatEventData({[c.h3.ChatEventType]:c.a5.DataShapingEditQuery,[c.h3.ChatEventParameters]:JSON.stringify(a)},g.M.getInstance())}}},630079:(e,t,a)=>{"use strict";a.d(t,{r:()=>n});class n{static generateId(){return n.operationId++,"AugLoop-ChatExcel-"+n.operationId.toString()}}n.operationId=0},632197:(e,t,a)=>{"use strict";a.d(t,{Q:()=>o,t:()=>n});var n=function(e){var t,a;return{accessToken:e.accessToken,expirationTime:null!==(a=null===(t=null==e?void 0:e.expiresOn)||void 0===t?void 0:t.getTime())&&void 0!==a?a:0}},o=function(e){return e.substring(0,e.lastIndexOf("/"))}},632512:(e,t,a)=>{"use strict";a.d(t,{O:()=>o,u:()=>n});class n extends Error{getErrorLocation(){return this.error instanceof OfficeExtension.Error?this.error.debugInfo.errorLocation:null}constructor(e,t){super(e),this.errorCode=e,t instanceof n&&(t.error instanceof Error||t.error instanceof OfficeExtension.Error)?this.error=t.error:(t instanceof Error||t instanceof OfficeExtension.Error)&&(this.error=t),Object.setPrototypeOf(this,n.prototype)}}var o;!function(e){e.SelectionFailed="SelectionFailed",e.LargeData="LargeData",e.UnboundedRange="UnboundedRange",e.LargePivotTableSource="LargePivotTableSource",e.NotAlignedRanges="NotAlignedRanges",e.SeparateRowsSelected="SeparateRowsSelected",e.SeparateColumnsSelectedOnRowMajorTable="SeparateColumnsSelectedOnRowMajorTable",e.SelectionsFromDifferentRanges="SelectionsFromDifferentRanges",e.NetworkError="NetworkError",e.NetworkTimeout="NetworkTimeout",e.BadRequest="BadRequest",e.InternalServerError="InternalServerError",e.NetworkThrottleError="NetworkThrottleError",e.NoRecommendations="NoRecommendations",e.RecommendationsFailed="RecommendationsFailed",e.InsertionFailed="InsertionFailed",e.InsertionFailedCellEditMode="InsertionFailedCellEditMode",e.PivotTableSelection="PivotTableSelection",e.SignInFailed="SignInFailed",e.TrySampleDataError="TrySampleDataError",e.PreferencesFailed="PreferencesFailed",e.NoRecommendationsWithPreferences="NoRecommendationsWithPreferences",e.NaturalLanguageFailed="NaturalLanguageFailed",e.NaturalLanguageVisualInsertionFailed="NaturalLanguageVisualInsertionFailed",e.NaturalLanguageVisualInsertionFailedCellEditMode="NaturalLanguageVisualInsertionFailedCellEditMode",e.NaturalLanguageFailedNoSuggestions="NaturalLanguageFailedNoSuggestions",e.NaturalLanguageFailedConversation="NaturalLanguageFailedConversation",e.Unauthorized="Unauthorized",e.Forbidden="Forbidden",e.NotAcceptable="NotAcceptable",e.NotFound="NotFound",e.Gone="Gone",e.MultiSelectionError="MultiSelectionError",e.CellEditModeError="CellEditModeError",e.InvalidSelection="InvalidSelection",e.RecommendedPivotTablesNoRecommendations="RecommendedPivotTablesNoRecommendations",e.RecommendedPivotTablesFailed="RecommendedPivotTablesFailed",e.RecommendedPivotTablesPivotTableSelection="RecommendedPivotTablesPivotTableSelection",e.RecommendedPivotTablesInsertionFailed="RecommendedPivotTablesInsertionFailed",e.RecommendedPivotTablesInsertionFailedCellEditMode="RecommendedPivotTablesInsertionFailedCellEditMode",e.RecommendedPivotTablesBlankInsertionFailedInvalidDataSource="RecommendedPivotTablesBlankInsertionFailedInvalidDataSource",e.FetchNaturalLanguageContextFailed="FetchNaturalLanguageContextFailed",e.NaturalLanguageUnsupportedLanguageError="NaturalLanguageUnsupportedLanguageError",e.NaturalLanguageFailedForShortQuery="NaturalLanguageFailedForShortQuery",e.InactiveWorkbook="InactiveWorkbook",e.LocaleFetchFailed="LocaleFetchFailed",e.NaturalLanguageFailedForPotentialBiasQuery="NaturalLanguageFailedForPotentialBiasQuery",e.RecommendedPivotTablesNoRecosForSingleLineData="RecommendedPivotTablesNoRecosForSingleLineData",e.RecommendedChartsPivotTableSourceNoDataField="RecommendedChartsPivotTableSourceNoDataField",e.RecommendedChartsPivotTableSourceNoRowField="RecommendedChartsPivotTableSourceNoRowField",e.InsertionFailedPivotCacheProtected="InsertionFailedPivotCacheProtected",e.InsertionFailedDestinationProtected="InsertionFailedDestinationProtected",e.InsertionFailedCurrentWorksheetProtected="InsertionFailedCurrentWorksheetProtected",e.OCVFeedbackError="OCVFeedbackError",e.InsertCalculatedColumnFailed="InsertCalculatedColumnFailed",e.InsertFormulaSuggestionFailed="InsertFormulaSuggestionFailed",e.InsertCalculatedColumnWithTargetRangeFailed="InsertCalculatedColumnWithTargetRangeFailed",e.InsertCalculatedColumnFailedWithInvalidArgTableRangeChanged="InsertCalculatedColumnFailedWithInvalidArgTableRangeChanged",e.InsertCommentFailed="InsertCommentFailed",e.AnalyzeTyping="AnalyzeTyping",e.DeactivateRangePickerFailed="DeactivateRangePickerFailed",e.FetchUnsetFlight="FetchUnsetFlight",e.FlightingFailure="FlightingFailure",e.FormulaErrorContentTooLarge="FormulaErrorContentTooLarge",e.FormulaErrorExceedLengthLimitation="FormulaErrorExceedLengthLimitation",e.FormulaErrorProactiveLimitation="FormulaErrorProactiveLimitation",e.FormulaErrorTranslationFailure="FormulaErrorTranslationFailure",e.FormulaErrorUnknown="FormulaErrorUnknown",e.FormulaErrorValidationIssue="FormulaErrorValidationIssue",e.FormulaGenerationSkillError="FormulaGenerationSkillError",e.GenerateSuggestedQueries="GenerateSuggestedQueries",e.InitializeAppFailure="InitializeAppFailure",e.InitializeOfficeFailure="InitializeOfficeFailure",e.InitializeSharedRuntimeFailure="InitializeSharedRuntimeFailure",e.InsertionCleanupFailed="InsertionCleanupFailed",e.IvyWebFailure="IvyWebFailure",e.LoadStringsFailure="LoadStringsFailure",e.NativeSelectionFailed="NativeSelectionFailed",e.NaturalLanguageContextFailed="NaturalLanguageContextFailed",e.ReducerException="ReducerException",e.RenderRecommendationFailed="RenderRecommendationFailed",e.FailedToParseClientVersion="FailedToParseClientVersion",e.FailedToParseSelectionContext="FailedToParseSelectionContext",e.FailedToSelectSelectionContext="FailedToSelectSelectionContext",e.SeeAllChartsFailed="SeeAllChartsFailed",e.DataRefreshFailed="DataRefreshFailed",e.XlimResolveError="XlimResolveError",e.SubstrateSignalError="SubstrateSignalError",e.FailedToParseCalculatedColumnSuggestion="FailedToParseCalculatedColumnSuggestion",e.ShowPreviewColumnFailed="ShowPreviewColumnFailed",e.HidePreviewColumnFailed="HidePreviewColumnFailed",e.DefaultInsertCalculatedColumnFailed="DefaultInsertCalculatedColumnFailed",e.PreviewValidationFailed="PreviewValidationFailed",e.UpdateAppStyleFailed="UpdateAppStyleFailed",e.NavigateToDataAIError="NavigateToDataAIError",e.ExcelIntelligenceSignalFailed="ExcelIntelligenceSignalFailed",e.ExcelIntelligenceSignalFailedWithSuggestions="ExcelIntelligenceSignalFailedWithSuggestions",e.GetInsightsFailed="GetInsightsFailed",e.GetInterpretationsFailed="GetInterpretationsFailed",e.GetNLContextFailed="GetNLContextFailed",e.InsertRecommendationsDashboard="InsertRecommendationsDashboard",e.CheckForTablesError="CheckForTablesError",e.CalculatedColumnsInsertColumnFailedGetRange="CalculatedColumnsInsertColumnFailedGetRange",e.CalculatedColumnsInsertColumnFailedResolveTableLikeEntity="CalculatedColumnsInsertColumnFailedResolveTableLikeEntity",e.DeleteLastColumnFailed="DeleteLastColumnFailed",e.CalculatedColumnExpandFailedNotEmptyColumn="CalculatedColumnExpandFailedNotEmptyColumn",e.CalculatedColumnExpandFailed="CalculatedColumnExpandFailed",e.CalculatedColumnPartialInsertFailed="CalculatedColumnPartialInsertFailed",e.FetchAndSetActiveTableFailed="FetchAndSetActiveTableFailed",e.GetTableContextFailed="GetTableContextFailed",e.GetTabularRangeContextFailed="GetTabularRangeContextFailed",e.ColumnRecommendationsNotAvailable="ColumnRecommendationsNotAvailable",e.DataLocaleUndefined="DataLocaleUndefined",e.AnalyzeDataTimeout="AnalyzeDataTimeout",e.CalculatedColumnPreviewNotUpdated="CalculatedColumnPreviewNotUpdated",e.CalculatedColumnPreviewNoColumnLetters="CalculatedColumnPreviewNoColumnLetters",e.CalculatedColumnFormulaLocalizationFailed="CalculatedColumnFormulaLocalizationFailed",e.CalculatedColumnConvertAnnotationToRecommendationFailed="CalculatedColumnConvertAnnotationToRecommendationFailed",e.CalculatedColumnFailedToSendSignal="CalculatedColumnFailedToSendSignal",e.CalculatedColumnInsertColumnFailedVerifyPreview="CalculatedColumnInsertColumnFailedVerifyPreview",e.CalculatedColumnInsertColumnError="CalculatedColumnInsertColumnError",e.CalculatedColumnVisibleRowsOutOfRange="CalculatedColumnVisibleRowsOutOfRange",e.CalculatedColumnPreviewColumnOffsetOutOfTable="CalculatedColumnPreviewColumnOffsetOutOfTable",e.CalculatedColumnPreviewColumnInTheMiddleExpected="CalculatedColumnPreviewColumnInTheMiddleExpected",e.CopyButtonError="CopyButtonError",e.PostRangesError="PostRangesError",e.InitializeRangesFailure="InitializeRangesFailure",e.StoreDataFailure="StoreDataFailure",e.PrePythonModeError="PrePythonModeError",e.PythonStaleRuntimeError="PythonStaleRuntimeError",e.PythonBusyStateError="PythonBusyStateError",e.PythonCodeAndPostViewPropsNotSerializable="PythonCodeAndPostViewPropsNotSerializable",e.PythonGeneralError="PythonGeneralError",e.PythonAccessError="PythonAccessError",e.PythonCalcError="PythonCalcError",e.PythonGeneralContextError="PythonGeneralContextError",e.PythonInsertFailed="PythonInsertFailed",e.PythonProtectedSheetError="PythonProtectedSheetError",e.PythonCopyFailed="PythonCopyFailed",e.PythonNoActiveLicense="PythonNoActiveLicense",e.PythonUnsupportedLanguage="PythonUnsupportedLanguage",e.PythonUnsupportedPlatform="PythonUnsupportedPlatform",e.PythonUnsupportedResponseType="PythonUnsupportedResponseType",e.PythonDeletedSheetBeforeResponseGeneration="PythonDeletedSheetBeforeResponseGeneration",e.PythonDeletedSheetDuringResponseGeneration="PythonDeletedSheetDuringResponseGeneration",e.PythonUnexpectedMissingSheetInContextExtraction="PythonUnexpectedMissingSheetInContextExtraction",e.PythonMissingResponseValue="PythonMissingResponseValue",e.PythonInvalidResponseOrder="PythonInvalidResponseOrder",e.PythonResponseAllDebugChunks="PythonResponseAllDebugChunks",e.PythonCodeRetryMaximumHit="PythonCodeRetryMaximumHit",e.PythonAugLoopCallsPerQueryMaximumHit="PythonAugLoopCallsPerQueryMaximumHit",e.PythonStartAnalysisEditModeError="PythonStartAnalysisEditModeError",e.PythonGenericEditModeError="PythonGenericEditModeError",e.PythonInvalidSelectedContext="PythonInvaldSelectedContext",e.PythonUnknownError="PythonUnknownError",e.PythonPostViewError="PythonPostViewError",e.PythonDataFrameInsertFailed="PythonDataFrameInsertFailed",e.PythonContextUndefinedParameter="PythonContextUndefinedParameter",e.PythonObjectReferenceError="PythonObjectReferenceError",e.PythonExitAnalysisError="PythonExitAnalysisError",e.PythonAddResultsToNewSheetError="PythonAddResultToNewSheetError",e.PythonTuiNotShownError="PythonTuiNotShownError",e.PythonGetDiagnosticsError="PythonGetDiagnosticsError",e.PythonPayloadEmptyError="PayloadEmptyError",e.PythonDisplayResponseError="PythonDisplayResponseError",e.AnswersPostViewError="AnswersPostViewError",e.AnswersInvalidImageResponse="AnswersInvalidImageResponse",e.AnswersMissingChunkProperty="AnswersMissingChunkProperty",e.AnswersParsingMetadataFailed="AnswersParsingMetadataFailed",e.PayloadSizeError="PayloadSizeError",e.PythonPrintFormattedNumberError="PythonPrintFormattedNumberError",e.PythonMultipleOpenWorkbooks="PythonMultipleOpenWorkbooks",e.PythonExecutionBlockedByAdmin="PythonExecutionBlockedByAdmin",e.CalculatedCellExpandFailedNotEmptyCell="CalculatedCellExpandFailedNotEmptyCell",e.CalculatedCellExpandFailed="CalculatedCellExpandFailed",e.GetChartRecoFailed="GetChartRecoFailed",e.GetPivotTableRecoFailed="GetPivotTableRecoFailed",e.MissingOperationLocation="MissingOperationLocation",e.FeedbackApiError="FeedbackApiError",e.CalculatedColumnsInvalidFormula="CalculatedColumnsInvalidFormula",e.ShowSuggestionsTimeout="ShowSuggestionsTimeout",e.PythonAutofitFailed="PythonAutofitFailed",e.DefaultInsertCalculatedCellFailed="DefaultInsertCalculatedCellFailed",e.DefaultInsertCalculatedCellTitleFailed="DefaultInsertCalculatedCellTitleFailed",e.InsertCalculatedCellToSelectionFailed="InsertCalculatedCellToSelectionFailed",e.InsertCalculatedCellToFixedRangeFailed="InsertCalculatedCellToFixedRangeFailed",e.CalculatedCellPartialInsertFailed="CalculatedCellPartialInsertFailed",e.CalculatedCellUndefinedColumnHeader="CalculatedCellUndefinedColumnHeader",e.BlobRangeRevisionError="BlobRangeRevisionError",e.TLRRevisionError="TLRRevisionError",e.CalculatedCellsGetIsTotalRowCellsEmptyFailed="CalculatedCellsGetIsTotalRowCellsEmptyFailed",e.EvaluateQueryFailed="EvaluateQueryFailed",e.FetchAndSetTabularRangeAsActiveTableFailed="FetchAndSetTabularRangeAsActiveTableFailed",e.FetchAndSetUnrecognizedRangeFailed="FetchAndSetUnrecognizedRangeFailed",e.ResolveTableLikeEntityFailed="ResolveTableLikeEntityFailed",e.UpdateSelectionFailed="UpdateSelectionFailed",e.UpdateSelectionFailedWillRetry="UpdateSelectionFailedWillRetry",e.FetchPivotTableFailed="FetchPivotTableFailed",e.SetActiveChartFailed="SetActiveChartFailed",e.FetchActivePivotTableFailed="fetchActivePivotTableFailed",e.FetchPivotTableFailedToLoadRange="FetchPivotTableFailedToLoadRange",e.SelectionIntegrityCheckFailed="SelectionIntegrityCheckFailed",e.SelectionIntegrityCheckEncounteredNonWorksheet="SelectionIntegrityCheckEncounteredNonWorksheet",e.SelectionIntegrityCheckEncounteredNoGridSelection="SelectionIntegrityCheckEncounteredNoGridSelection",e.SelectionIntegrityCheckFoundTableMismatch="SelectionIntegrityCheckFoundTableMismatch",e.SelectionIntegrityCheckFoundNoTableButOneShouldBePresent="SelectionIntegrityCheckFoundNoTableButOneShouldBePresent",e.SelectionIntegrityCheckFlushingSelectionFailed="SelectionIntegrityCheckFlushingSelectionFailed",e.ContextManagerInitializationFailed="ContextManagerInitializationFailed",e.FetchAndSetActiveTableLikeEntityFailed="FetchAndSetActiveTableLikeEntityFailed",e.AuthError="AuthError",e.LoadAuthError="LoadAuthError",e.SetFormulaPreviewFailed="SetFormulaPreviewFailed",e.TLRFixDuplicatesFailed="TLRFixDuplicatesFailed",e.TLRFixMergedCellsFailed="TLRFixMergedCellsFailed",e.TLRRetrieveMergeCellsFailed="TLRRetrieveMergeCellsFailed",e.TLRFixEmptyHeadersFailed="TLRFixEmptyHeadersFailed",e.TLRValidateEmptyHeadersFailed="TLRValidateEmptyHeadersFailed",e.TLRRetrieveEmptyHeaderCellsFailed="TLRRetrieveEmptyHeaderCellsFailed",e.TLRRetrieveDuplicateHeaderCellsFailed="TLRRetrieveDuplicateHeaderCellsFailed",e.AutoFixTLRFailed="AutoFixTLRFailed",e.SetContextWithAddressValidationFailed="SetContextWithAddressValidationFailed",e.FormulaGenerationCreateFetchOperationFailed="FormulaGenerationCreateFetchOperationFailed",e.FormulaGenerationGetSelectionContextsFailed="FormulaGenerationGetSelectionContextsFailed",e.SubmitExcelIntelligenceOperationFailedOnGetActiveCell="SubmitExcelIntelligenceOperationFailedOnGetActiveCell",e.SubmitExcelIntelligenceOperationFailedOnGetActiveSheetName="SubmitExcelIntelligenceOperationFailedOnGetActiveSheetName",e.CheckIntersectingRemoteChangesFailed="CheckIntersectingRemoteChangesFailed",e.TLRNotFound="TLRNotFound",e.RefreshActiveTableFailed="RefreshActiveTableFailed",e.FeedbackGetUserAccessTokenError="FeedbackGetUserAccessTokenError",e.GetPythonCellContextTimeout="GetPythonCellContextTimeout",e.GetPythonCellContextTimeoutRecoverable="GetPythonCellContextTimeoutRecoverable",e.ExecutePythonCodeApiCallTimeout="ExecutePythonCodeApiCallTimeout",e.ConnectOfficePyServiceExecuteCodeException="ConnectOfficePyServiceExecuteCodeException",e.ConnectOfficePyServiceExecuteCodeTimeout="ConnectOfficePyServiceExecuteCodeTimeout",e.ConnectToOfficePySvcToExecutePythonCodeUnexpectedError="ConnectToOfficePySvcToExecutePythonCodeUnexpectedError",e.GetOfficePyServiceAccessTokenFailed="GetOfficePyServiceAccessTokenFailed",e.GetOfficePyServiceRuntimeUrlFailed="GetOfficePyServiceRuntimeUrlFailed",e.GetPythonContextObjectFailed="GetPythonContextObjectFailed",e.GetAllPythonCellsUpToAnalysisSheetTimeout="GetAllPythonCellsUpToAnalysisSheetTimeout",e.GetAllPythonCellsOfAASessionAnalysisSheetTimeout="GetAllPythonCellsOfAASessionAnalysisSheetTimeout",e.PythonContextExtractionAborted="PythonContextExtractionAborted",e.ImportDataTablePreviewNotUpdated="ImportDataTablePreviewNotUpdated",e.PythonImageUnavailableAnalysisSheetDeletedError="PythonImageUnavailableAnalysisSheetDeletedError",e.PythonAnalysisSheetMetadataError="PythonAnalysisSheetMetadataError",e.AnswersInsertImageError="AnswersInsertImageError",e.AnswersInsertTableError="AnswersInsertTableError",e.AnswersCollapsableCodeOnClickError="AnswersCollapsableCodeOnClickError",e.AnswersComponentPropsNotSerializable="AnswersComponentPropsNotSerializable",e.AnswersInvalidChartImageResponse="AnswersInvalidChartImageResponse",e.AnswersInteractiveChartRenderingFailed="AnswersInteractiveChartRenderingFailed",e.AnswersInteractiveChartRefFailed="AnswersInteractiveChartRefFailed",e.AnswersInteractiveChartImageGenerationFailed="AnswersInteractiveChartImageGenerationFailed",e.AnswersUnsupportedLanguageError="AnswersUnsupportedLanguageError",e.AnswersUnsupportedPlatformError="AnswersUnsupportedPlatformError",e.PythonStartAnalysisFailed="PythonStartAnalysisFailed",e.RichAPIGeneralException="RichAPIGeneralException",e.PythonProtectedSheetObjectInsertionError="PythonProtectedSheetObjectInsertionError"}(o||(o={}))},632927:(e,t,a)=>{"use strict";a.d(t,{Q:()=>i});var n=a(725556),o=a(980214),r=a(135973);function i(){const e=(0,n.jsx)(o.E,{animation:"wave",appearance:"translucent",style:{marginTop:4,width:"100%",height:12},children:(0,n.jsx)(r.H,{size:12})});return(0,n.jsxs)("div",{children:[e,e]})}},637211:(e,t,a)=>{"use strict";a.d(t,{$:()=>n});const n={Enabled:0,DisabledNewWorkbook:1,DisabledAutoSaveOff:2,DisabledSharedLock:4,DisabledLocalFile:8,DisabledPrerequisitesPending:16,DisabledAugLoopPending:32,DisabledUnsupportedLocale:64,DisabledUserChanged:128,DisabledVisibility:256,DisabledUnknownPrerequisite:512,DisabledAugLoopPermanentError:1024,DisabledUploadNotAllowedForClp:2048,DisabledDialogSheetExists:4096,DisabledThirdPartyHost:8192,Deprecated_DisabledUserContentServicesDisabled:16384,DisabledNoLicensingForTenant:32768}},638753:(e,t,a)=>{"use strict";a.d(t,{An:()=>x,Bp:()=>g,Cs:()=>p,Id:()=>h,Ne:()=>b,QH:()=>y,_H:()=>C,gZ:()=>v,hX:()=>u,if:()=>f,nh:()=>m});var n=a(423905),o=a(241273),r=a(664380),i=a(681420),l=a(261199),s=a(660606),c=a(83437),d=function(){return d=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},d.apply(this,arguments)};function u(e){return null==e}function m(e){switch(e){case o.ut.Enterprise:return"Enterprise";case o.ut.Consumer:return"Consumer";default:return"Unknown"}}var h=function(e,t,a,n,l){var s=t!==o.Gm.defaultWhite&&t!==o.Gm.themeColorful?d({isDarkModeEnabled:!0,isHighContrastModeEnabled:a},(0,r.W)(e)):d({isDarkModeEnabled:!1,isHighContrastModeEnabled:a},(0,i.a)(e));return s.dir=n,l&&s.isDarkModeEnabled&&Object.entries(l).forEach((function(e){var t=e[0],a=e[1];s[t]=a})),s};function g(e){(0,s.cY)("launchThisVersionOfSDX():"+e);var t=window.location.href;""===e?(0,s.cY)("launchThisVersionOfSDX() is empty"):t.split("/").length>9?e!==t.split("/")[7]&&((0,s.cY)("launchThisVersionOfSDX difference detected"),window.location.href=t.replace(t.split("/")[7],e)):t.split("/").length>6&&t.split("/").length<10&&e!==t.split("/")[4]&&((0,s.cY)("launchThisVersionOfSDX difference detected"),window.location.href=t.replace(t.split("/")[4],e))}var p=function(){return"undefined"!=typeof OfficeaicopilotStrings},b=function(e){var t,a,o,r;if(!u(e))return(0,s.cY)("Chat Message header received in response chatMessageHeaderType: ",e.chatMessageHeaderType),e.chatMessageHeaderType===l.Hu.Personalization_Indicator&&((0,s.cY)("Personalization header received in response"),s.EG.sendChatEventTelemetry((0,n.pN)(((t={})[c.h3.ChatEventType]=c.a5.PersonalizationIndicatorShown,t[c.h3.IsPersonalizedResponse]=!0,t))),s.EG.sendLatencyTelemetry((0,n.pN)(((a={})[c.CT.IsPersonalizedResponse]=!0,a)))),{titleText:null!==(o=null==e?void 0:e.title)&&void 0!==o?o:"",popoverText:null!==(r=null==e?void 0:e.expandedTitle)&&void 0!==r?r:void 0}};function f(e){var t=Array.from(e,(function(e){return String.fromCodePoint(e)})).join("");return btoa(t)}var C=function(e){return"bot"===e.author&&"GeneratedCode"===e.messageType},y=function(e,t){return{shouldShowViewCodeButton:t,code:null==e?void 0:e.text,stdout:""}};function v(e){return"string"==typeof e&&e.length>=2&&e.startsWith('"')&&e.endsWith('"')&&(e=e.slice(1,-1)),e}var x=function(e,t){var a;(null===(a=null==e?void 0:e.current)||void 0===a?void 0:a.updateExecutionStatusForAddInActions)&&e.current.updateExecutionStatusForAddInActions(t)}},644082:(e,t,a)=>{"use strict";a.d(t,{k:()=>p,n:()=>b});var n=a(700853),o=a(63919),r=a(322466),i=a(9847),l=a(49236),s=a(340889),c=a(528804),d=a(949404),u=a(644737),m=a(507628);const h=i.q.AnalyzeData,g="Copilot\\Analyze Data";function p({requestId:e,adaptiveCardDefinition:t,cardButtonCallback:a}){return{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,l.IM)("ChartAdaptiveCard_V1",{requestId:e,adaptiveCardDefinition:t,cardButtonCallback:a}),textContent:(0,s.hk)(t)}},chatMessageBodyData:{messageId:(0,m.A)(),shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:g}},addCardToChatHistory:!0},telemetry:{featureName:h,eventType:i.a5.SuggestionMessage}}}const b={getChartAdaptiveCardResponse:p,getAnalyzeDataErrorResponse:function(e,t){const{message:a,telemetry:n}=(0,d.v)(e,{errorType:t??i.q0.ClientError,featureName:h},{},{feedbackData:{feedbackArea:g},shouldShowAIGeneratedIndicator:!0});return{message:a,telemetry:n}},getAnalyzeDataRecommendationResponse:function({visual:e,requestId:t,responseText:a,caveats:d,tableName:u,tableContext:p,query:b}){const f=(0,s.Pp)(e,p.address);return{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,l.IM)("AnalyzeData_V1",{tableName:u,visual:e,requestId:t,responseText:a,caveats:d,tableContext:p,query:b}),textContent:f}},chatMessageBodyData:{messageId:(0,c.yw9)("OfficeVSO_8691849_CopilotChartToImage")?(0,m.A)():void 0,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:g}},addCardToChatHistory:!0},telemetry:{featureName:h,eventType:i.a5.SuggestionMessage}}},getAnalyzeDataInsertSuccessResponse:function({tableContext:e,messageText:t,confirmationMessage:a,suggestionId:l="",shouldShowGoBackToTableButton:s,originalDataSheetId:d}){const m=[];return s&&e&&m.push((0,u.zY)(e,d)),(0,c.BAK)()&&m.push((0,u.FW)(h,l)),{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:t},messageFooter:a?{text:a}:void 0}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:g},actionButtonList:m}},telemetry:{featureName:h,eventType:i.a5.ActionConfirmationMessage}}},getAnalyzeDataUserChat:function(e){return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:h,eventType:i.a5.HumanInput}}},getTextAnalysisV1Response:function({requestId:e,textAnalysis:t,title:a}){return{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,l.IM)("TextAnalysis_V1",{requestId:e,textAnalysis:t,title:a}),textContent:(0,s.oG)(a,t)}},chatMessageBodyData:{messageId:(0,c.yw9)("OfficeVSO_8691849_CopilotChartToImage")?(0,m.A)():void 0,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:g}},addCardToChatHistory:!0},telemetry:{featureName:h,eventType:i.a5.SuggestionMessage}}},getFullThemingSuggestionResponse:function(e,t){return{message:{chatCardType:n._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:o.Q9.Chat,renderData:(0,l.IM)("TextAnalysisSuggestion",{requestId:e,columnName:t}),textContent:(0,s.qM)()}},chatMessageBodyData:{messageId:(0,m.A)(),shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:g}},addCardToChatHistory:!0},telemetry:{featureName:h,eventType:i.a5.SuggestionMessage}}},getAnalyzeDataInfoResponse:function(e,t){const a=(0,m.A)();return{message:{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:g},messageId:a,actionButtonList:(0,c.jHv)()?[(0,u.yo)(a)]:void 0},addCardToChatHistory:t},telemetry:{featureName:h,eventType:i.a5.AnalyzeDataEmptyAnswer}}},getAnalyzeDataMarkdownResponse:function(e){const t=(0,m.A)();return{message:{chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:o.Q9.Chat,message:e}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:g},messageId:t,actionButtonList:(0,c.jHv)()?[(0,u.yo)(t)]:void 0},addCardToChatHistory:!0},telemetry:{featureName:h,eventType:i.a5.AnalyzeDataMarkdownMessage}}}}},644665:(e,t,a)=>{"use strict";a.d(t,{q:()=>s});var n=a(83437),o=a(965634),r=a(956258),i=a(9847),l=a(840574);function s(e){if(!(0,l.f)())try{Office.context.ribbonGallery.refreshRibbon(e)}catch(e){!function(){const e=r.M.getInstance(),t={eventType:o.S2.RefreshRibbonGallery,errorMessage:"",logLevel:n.$b.ASHA},a=[{key:i.ib.ErrorMessage,value:"Something went wrong while refreshing ribbon gallery after save."}];e.logError(t,void 0,a)}()}}},644737:(e,t,a)=>{"use strict";a.d(t,{H0:()=>Pe,Kv:()=>ze,Oy:()=>rt,J3:()=>at,z3:()=>Qe,vu:()=>qe,AH:()=>$e,zY:()=>nt,E_:()=>Ze,A6:()=>Ke,AU:()=>et,HZ:()=>He,JE:()=>Ge,NQ:()=>Ue,yo:()=>tt,FW:()=>De,yq:()=>Be,zL:()=>Ve,s_:()=>ot});var n=a(267324),o=a(856656),r=a(984691),i=a(322466),l=a(700853),s=a(63919),c=a(381277),d=a(6862),u=a(93663),m=a(551134),h=a(170530),g=a(38417),p=a(824088),b=a(886866),f=a(932367),C=a(754440),y=a(365319),v=a(39609),x=a(449650),T=a(822606),S=a(83437),w=a(956933),E=a(9847),I=a(214289),R=a(839945),A=a(923263),L=a(46445),k=a(314998),F=a(697705),_=a(476730),P=a(965634),N=a(956258),M=a(235373),O=a(4091),D=a(797639),B=a(79458),$=a(528804),H=a(186998),U=a(750927),q=a(95151),V=a(691097),G=a(855391);async function W(e,t,a,o){const r=function(){const e=(0,V.P)("LaunchOfficeScriptsSDXOptionalProperties");if(!e)throw new Error("LaunchOfficeScriptsSDXOptionalProperties is undefined");let t;try{const a=JSON.parse(e);t=JSON.parse(a?.devProperties?.DocumentHostInfo)}catch{throw new k.Q0("Unable to parse DocumentHostInfo.")}if(!t.ClientUrl)throw new k.Q0("Object does not contain a 'ClientUrl'.");return t}().ClientUrl,i=await(0,G.Jv)(r,o),l=r.split("/").filter((e=>""!==e)),s=l.length>=2?"/"+l.slice(-2).join("/"):"",c=decodeURIComponent(s);return{properties:{categoryNames:["diet"],summary:"On a recurring basis, run an Office Script on an Excel workbook.",description:"On a recurring basis, run an Office Script on an Excel workbook.",author:{displayName:"Microsoft",source:"Microsoft"},metadata:{dietDesignerMarkup:{showParameterWithValue:{Recurrence:["frequency","interval","StartTime"]},parameterLabelOverrides:[{operationNodeId:"recurrence",parameterName:"interval",label:(0,n.s2u)()},{operationNodeId:"recurrence",parameterName:"StartTime",label:(0,n.nPU)()}],parameterDisplayInlineOverrides:[{operationNodeId:"recurrence",parameterName:"frequency",displayInline:!0},{operationNodeId:"recurrence",parameterName:"interval",displayInline:!0}]}},definition:{$schema:"https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",contentVersion:"1.0.0.0",parameters:{$connections:{defaultValue:{},type:"Object"},$authentication:{defaultValue:{},type:"SecureObject"}},triggers:{Recurrence:{recurrence:a,type:"Recurrence"}},actions:{Run_script:{runAfter:{},metadata:{[i.fileId]:c,[e]:t},type:"OpenApiConnection",inputs:{host:{apiId:"/providers/Microsoft.PowerApps/apis/shared_excelonlinebusiness",connectionName:"shared_excelonlinebusiness",operationId:"RunScriptProd"},parameters:{source:i.locationId,drive:i.driveId,file:i.fileId,scriptId:e},authentication:"@parameters('$authentication')"}}}},connectionReferences:{shared_excelonlinebusiness:{api:{id:"/providers/Microsoft.PowerApps/apis/shared_excelonlinebusiness"},source:"NotSpecified",connectionNamingMode:"NotSpecified"}}}}}var z=a(108869),j=a(512238),Q=a(64292),J=a(880496),Y=a(71475);async function X(e,t,a){return await async function(e,t,a){const n=[];try{let t;const o=(0,J.me)(e);if(await e.sync(),o())t=e.workbook.worksheets.getActiveWorksheet();else{const a=(0,Q.d)(e);await e.sync();const o=await a()(e);n.push(o.undo),t=o.result}a(t);const r=(0,Q.x)(e,t),i=await r()(e);return n.push(i.undo),t.m_name}catch(e){throw await t((0,O.L4)()),await(0,Y.q)(n),e}}(a,t,(t=>function(e,t){const a=t.rows.length,n=t.headers.length,o=a+1;if(0===n)throw new Error("Parsed table has no columns");const r=e.getRangeByIndexes(0,0,o,n);r.numberFormat=(0,$.yw9)("OfficeVSO_9297500_CopilotSDXInsertTableFormatAsGeneral")?[["General"]]:[["@"]];const i=[t.headers,...t.rows.map((e=>e.cells.map((e=>e.value))))];r.values=i,e.tables.add(r,!0),r.select(),r.format.autofitColumns()}(t,e)))}var Z=a(479504),K=a(451373),ee=a(888810);async function te(e){const t=function(e){const t=(0,V.P)("LaunchOfficeScriptsSDXOptionalProperties");let a;if(t){const n=JSON.parse(t);a={DevProperties:n.devProperties,OptionalProperties:n.optionalProperties},a.DevProperties.Destination="Details",a.DevProperties.Source="Copilot",a.DevProperties.UnconditionalForceRefresh="",a.DevProperties.Script=JSON.stringify(e),a.DevProperties.CodeEditorUrl=ae(),a.DevProperties.IsOwner=!0,a.OptionalProperties.SourceLocationOverrideResourceId=ae()}else a={OptionalProperties:{TaskPaneTitle:"Office Scripts",TaskPaneWidth:360,SourceLocationOverrideResourceId:ae(),HeaderCssClass:"ewa-ptp-header-maker",TitleCssClass:"ewa-ptp-title-maker-react"},DevProperties:{Script:JSON.stringify(e),CodeEditorUrl:ae(),StorageModePreference:(0,K.o8)(),Source:"ExcelCopilot",Destination:"Details",CopilotEnabled:"true",wacFlights:JSON.stringify({CopilotSaveAutomation:(0,$.avT)()}),UnconditionalForceRefresh:""}};return a}(e);await ne("FA000000043",t.OptionalProperties,t.DevProperties)}function ae(){switch((0,ee.A)()){case"Dogfood":case"Microsoft":return"CodeEditor.URL";default:return"ProdCodeEditor.URL"}}async function ne(e,t,a={}){if(!Office?.context?.extensionLifeCycle?.launchExtensionComponent)throw new Error("Unable to launch taskpane. 'Office.context.extensionLifeCycle.launchExtensionComponent' is not defined");const n={extId:{Id:e,StoreId:"sdxcatalog",StoreType:"sdxcatalog",AppVersion:"1.0.0"},componentType:"Taskpane",componentId:e,hostProperties:{HostType:"Excel-Online",FormFactor:"Desktop",Locale:Office.context.displayLanguage},optionalProperties:{DevProperties:a,OptionalProperties:t}};await Office.context.extensionLifeCycle.launchExtensionComponent(n.extId,n.componentType,n.componentId,n.hostProperties,n.optionalProperties)}var oe=a(990219);function re(e){return!isNaN(Number(e))}function ie(e,t){var a;re(e)?t.cellFormatType.number++:"true"===(a=e).toLowerCase()||"false"===a.toLowerCase()?t.cellFormatType.boolean++:!function(e){return e.startsWith("=")}(e)?!function(e){return e.includes("http://")||e.includes("https://")}(e)?!function(e){return e.startsWith("$")||e.startsWith("")||e.startsWith("")||e.startsWith("")||e.startsWith("")||e.startsWith("")}(e)?!function(e){return!(e.length<8)&&(!re(e)&&(/^(0?[1-9]|1[0-2])[./](0?[1-9]|[12][0-9]|3[01])[./]\d{4}$/.test(e)&&!isNaN(Date.parse(e))))}(e)?t.cellFormatType.string++:t.cellFormatType.date++:t.cellFormatType.currency++:t.cellFormatType.linkCount++:t.cellFormatType.formula++}function le(e,t){const a={headers:[""],rows:[]};return e(t).find("li").each(((t,n)=>{const o={value:""},r={cells:[]};se(e,n,o),r.cells.push(o),a.rows.push(r)})),a}function se(e,t,a,n=void 0){const o=/^\^\d+\^$/g;e(t).find("a").each(((t,r)=>{e(r).text().match(o)?(n&&n.citationsCount++,e(r).remove()):(n&&n.hyperlinkCount++,a.hyperlink=e(r).attr("href"))})),a.value=e(t).text().trim()}var ce=a(644665),de=a(725556),ue=a(340267),me=a(86240),he=a(73915),ge=a(103806),pe=a(632512),be=a(60398),fe=a(202051),Ce=a(977055),ye=a(988013),ve=a(852853),xe=a(215592),Te=a(376116),Se=a(576583);const we={display:"flex",flexDirection:"row",gap:ve.L.spacingHorizontalS,justifyContent:"flex-start",width:"100%",alignItems:"center",flexWrap:"wrap",marginTop:ve.L.spacingVerticalXS},Ee={minWidth:"20px",height:"24px",...xe.shorthands.border(ve.L.strokeWidthThin,"solid",ve.L.colorNeutralStroke1),...xe.shorthands.padding(ve.L.spacingVerticalXS,ve.L.spacingHorizontalS),...Te.g.caption1,borderRadius:ve.L.borderRadiusMedium,":hover":{backgroundColor:ve.L.colorTransparentBackground},":focus":{backgroundColor:ve.L.colorTransparentBackground},":disabled":{backgroundColor:ve.L.colorNeutralBackgroundDisabled,color:ve.L.colorNeutralForegroundDisabled,cursor:"not-allowed"},":hover:disabled":{backgroundColor:ve.L.colorNeutralBackgroundDisabled,color:ve.L.colorNeutralForegroundDisabled,cursor:"not-allowed"}},Ie={...Ee,color:"#FFFFFF",backgroundColor:ve.L.colorPaletteGreenBackground3,":hover":{color:"#FFFFFF",backgroundColor:ve.L.colorPaletteGreenBackground3},":focus":{color:"#FFFFFF",backgroundColor:ve.L.colorPaletteGreenBackground3},":active":{color:"#FFFFFF",backgroundColor:ve.L.colorPaletteGreenBackground3}},Re={...Ee,color:ve.L.colorNeutralForeground1,backgroundColor:ve.L.colorTransparentBackground},Ae={marginRight:ve.L.spacingHorizontalS},Le=(0,Se.n)({pythonStartAnalysisRoot:Ie,pythonThinkDeeperRoot:Re,icon:Ae,container:we});var ke=a(887648);a(208520);const Fe=()=>{const e=(0,ye.j)(),t=(0,ke.d4)((e=>e.chat.showLoadingUI)),a=(0,ue.Bi)(),o=(0,ue.Bi)(),r=Le();return(0,de.jsxs)("div",{className:r.container,children:[(0,de.jsx)(me.$,{className:r.pythonStartAnalysisRoot,size:"medium",disabled:t,"aria-label":(0,n.CsI)(),"aria-labelledby":a,onClick:e=>i(),icon:{children:(0,de.jsx)(c.u9I,{}),className:r.icon},iconPosition:"before",children:(0,de.jsx)("span",{id:a,children:(0,n.CsI)()})}),(0,de.jsx)(me.$,{className:r.pythonThinkDeeperRoot,size:"medium",disabled:t,"aria-label":(0,n.YVl)(),"aria-labelledby":o,onClick:e=>async function(){D.CP.pythonContextManager.setIsPythonThinkDeeperMode(!0),await i(!0)}(),icon:{children:(0,de.jsx)(c.W66,{}),className:r.icon},iconPosition:"before",children:(0,de.jsx)("span",{id:o,children:(0,n.YVl)()})})]});async function i(t){try{const a=(0,$.yw9)("OfficeVSO_10320925_ThinkDeeperStringUpdate")&&t;(0,Ce.PB)(P.L3.StartAnalysisClicked,[]);const o={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:he.Q9.Human,messageHeader:{text:a?(0,n.YVl)():(0,n.QAQ)()}}}},r={featureName:E.q.Python,eventType:E.a5.SuggestionMessage};if(y.$.getInstance().displayResponse(o,r),D.CP.pythonContextManager.isPythonThinkDeeperMode){const e={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:he.Q9.Chat,messageHeader:{text:(0,n.PX7)()}}}};y.$.getInstance().displayResponse(e,r)}if(D.CP.pythonContextManager.prePythonModeError)return void(0,fe.Kx)(e,D.CP.pythonContextManager.prePythonModeError,D.CP.pythonContextManager.prePythonModeErrorFunction??"handleStartAnalysisOnClick - prePythonModeError",!1,!0);e((0,O.eM)(E.OP.PythonStartAnalysis)),D.CP.pythonContextManager.enterAdvancedAnalysisMode(),await ge.p.getInstance().handlePythonStartAnalysis()}catch(t){(0,z.Tk)(!1);const a=new be.H({errorCode:pe.O.PythonStartAnalysisFailed,innerError:t});(0,fe.Kx)(e,a,"handleStartAnalysisOnClick",!1,!1,[],!0)}}},_e=()=>(0,de.jsx)(Fe,{});var Pe,Ne=a(495501),Me=a(390624);function Oe(){return{type:o.jA.Default,title:(0,n.sUU)(),text:(0,Z.dD)()?void 0:(0,n.sUU)(),iconRegular:c.t2R,iconHover:c.JL$}}function De(e,t,a,n=[]){return Be((async()=>{await(0,Me.tN)(e),a&&a()}),e,t,n)}function Be(e,t,a,o=[]){const r=N.M.userQueryGuid;return{...Oe(),handleButtonOnClick:async()=>{const i=N.M.getInstance();i.logRejectedEvent(t,a),i.logEvent((0,E.SV)(E.he.Undo,t,E.KZ.UndoButton,a,r));let{message:c,telemetry:d}=function(){const e={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Human,messageHeader:{text:n.olU.ActionButtonUndo}}}},t={featureName:E.q.UndoMessage,eventType:E.a5.ActionConfirmationMessage};return{message:e,telemetry:t}}();y.$.getInstance().displayResponse(c,d),await e(t),ot("RemoveUndo"),({message:c,telemetry:d}=function(e=[]){const t={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:n.olU.ActionButtonUndoSuccessMessage}}},chatMessageBodyData:{actionButtonList:e}},a={featureName:E.q.UndoMessage,eventType:E.a5.ActionConfirmationMessage};return{message:t,telemetry:a}}(o)),y.$.getInstance().displayResponse(c,d)}}}function $e(e,t){return{title:(0,n.wW0)(),text:(0,n.wW0)(),type:o.jA.Default,handleButtonOnClick:()=>{(0,z.EA)(e,t)},isDisabled:!1}}function He(){return{title:"",type:o.jA.CustomButton,position:o.SC.ActionButtonBar,customButtonUI:_e(),handleButtonOnClick:()=>{(0,B.cY)("Custom Python Start Analysis Button Clicked")}}}async function Ue(e,t,a,i){const l=N.M.userQueryGuid;let s;if(t!==R.jy.Recurrence)throw new k.Q0(`Unknown schedule type ${t}`,k.y3.unknownScheduleType);return s=await W(e.id,e.name,a,i),{type:o.jA.Default,title:(0,n.XKD)(),text:(0,Z.dD)()?void 0:(0,n.XKD)(),iconRegular:(0,Z.dD)()?d.FQP:d.EO2,iconHover:(0,Z.dD)()?d.NDW:d.Ov,handleButtonOnClick:async()=>{const e=N.M.getInstance();F.B.getInstance().logKeptEvent(E.BJ.OfficeScripts,E.q.OfficeScripts,r.RX.Command),e.logEvent((0,E.SV)(E.he.ScheduleScriptClicked,E.q.OfficeScripts,E.KZ.ScheduleScriptButton,i,l)),async function(e){const t=(0,V.i)();t.Script=void 0,t.FlowCreated=!0;const a={LaunchSource:"ExcelCopilot",TemplateDefinition:e,CopilotPAIntegration:(0,$.Lap)(),CopilotSDXLaunchDevProps:JSON.stringify(t)};await ne("FA000000113",{SourceLocationOverrideResourceId:"ProdPowerAutomate.URL"},a)}(JSON.stringify(s))}}}function qe(e,t,a){const r=N.M.userQueryGuid;return{type:o.jA.Default,title:(0,n.Xlr)(),text:(0,Z.dD)()?void 0:(0,n.Xlr)(),iconRegular:(0,Z.dD)()?u.aYy:u.va_,iconHover:(0,Z.dD)()?u.i00:u.TTy,handleButtonOnClick:async()=>{const o=N.M.getInstance();o.logRejectedEvent(e,a),o.logEvent((0,E.SV)(E.he.DeleteScript,e,E.KZ.DeleteScriptButton,a,r));const i=y.$.getInstance(),{message:l,telemetry:s}=Ne.n.getOfficeScriptSimpleResponse((0,n.Xlr)(),E.a5.DeleteScriptClicked);i.displayResponse(l,s),await async function(e){const t=y.$.getInstance();try{const a=new I.L,n=A.H.getInstance();await a.removeScriptShim(e),n.popScript();const o={operationName:"Delete",scriptMetadata:e};(0,ce.q)(o);const{message:r,telemetry:i}=Ne.n.getOfficeScriptDeleteScriptSuccessResponse(e.name);t.displayResponse(r,i)}catch(a){N.M.getInstance().logError({eventType:P.S2.ChatEvents,errorMessage:"Remove script failed",logLevel:S.$b.Warning});const{message:n,telemetry:o}=Ne.n.getOfficeScriptDeleteScriptErrorResponse(e);t.displayResponse(n,o)}}(t),ot("RemoveUndo")}}}function Ve(e){return{type:o.jA.Default,title:(0,n.H2U)(),text:(0,Z.dD)()?void 0:(0,n.H2U)(),iconRegular:(0,Z.dD)()?m.y_M:m.Fr0,iconHover:(0,Z.dD)()?m.iKN:m.Pdb,position:(0,Z.dD)()?o.SC.FeedbackSection:o.SC.ActionButtonBar,handleButtonOnClick:async()=>{N.M.getInstance().logEvent((0,E.SV)(E.he.ViewScript,E.q.OfficeScripts,E.KZ.ViewScriptButton,void 0,N.M.userQueryGuid)),te(e)},popoverProps:{popoverTitle:(0,n.H2U)()}}}function Ge(e,t,a){return{type:o.jA.Default,title:(0,n.Rp5)(),text:(0,Z.dD)()?void 0:(0,n.Rp5)(),iconRegular:(0,Z.dD)()?h.osE:h.jFZ,iconHover:(0,Z.dD)()?h.WlZ:h.fml,position:(0,Z.dD)()?o.SC.FeedbackSection:o.SC.ActionButtonBar,handleButtonOnClick:async()=>{const o=N.M.getInstance();F.B.getInstance().logKeptEvent(E.BJ.OfficeScripts,E.q.OfficeScripts,r.RX.Command),o.logEvent((0,E.SV)(E.he.SaveScript,E.q.OfficeScripts,E.KZ.SaveScriptButton,void 0,N.M.userQueryGuid));const i=y.$.getInstance(),{message:l,telemetry:s}=Ne.n.getOfficeScriptSimpleResponse((0,n.Rp5)(),E.a5.SaveScriptClicked);i.displayResponse(l,s),a(M.m.startExecutingCommand({command:E.OP.SaveOfficeScripts}));const c=await(0,R.fS)(e,t);if(c){ot("RemoveSaveScript"),v.Z.getInstance().setShowUndoButton(!0);const{message:e,telemetry:t}=Ne.n.getSavedScriptCompletedResponse(c,!0);i.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),a(M.m.stopExecuting({isSuccess:!0}))}else{const{message:e,telemetry:t}=Ne.n.getOfficeScriptErrorResponse((0,n.CPY)(),L.m.SaveScript);i.displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1}),a(M.m.stopExecuting({isSuccess:!1}))}},popoverProps:{popoverTitle:(0,n.Rp5)()}}}!function(e){e.DisableUndo="DisableUndo",e.RemoveUndo="RemoveUndo",e.RemoveGoBackToData="RemoveGoBackToData",e.RemoveExplain="RemoveExplain",e.RemoveSaveScript="RemoveSaveScript",e.RemoveAll="RemoveAll",e.EnableApply="EnableApply",e.ImportData="ImportData",e.InsertToNewSheet="InsertToNewSheet",e.UpdateGoBackToData="UpdateGoBackToData",e.InsertFormulaSuggestion="InsertFormulaSuggestion"}(Pe||(Pe={}));const We=()=>{const e=[];return(0,$.CDX)()&&(e.push(n.ht0),e.push(T.D0)),e},ze=async(e,t,a)=>{(0,B.cY)("Copy button clicked");const n=N.M.getInstance();n.logEvent((0,E.SV)(E.he.CopyMessageClicked,E.q.CopyMessage,void 0,void 0,N.M.userQueryGuid));try{await(0,q.handleCopyOnClicked)(e,We())}catch(e){(0,B.cY)("Error copying html to clipboard",e.message),n.logError({eventType:P.S2.ChatEvents,errorMessage:"Error copying html to clipboard "+e.message,logLevel:S.$b.ASHA}),N.M.getInstance().logStandardizedAshaErrorEvent(C.W.Unable_To_Complete_Task,f.c.Failed_To_Copy_Response,E.BJ.CopilotChat)}};function je(e){return{title:n.xxz.CopyButtonLabel,text:e&&!(0,Z.dD)()?n.xxz.CopyButtonLabel:void 0,iconRegular:(0,Z.dD)()?g.c2D:g.Jg_,iconHover:(0,Z.dD)()?g.cAv:g.Z1B,popoverProps:{popoverTitle:n.xxz.CopyButtonPopover}}}function Qe(e=!0){return{type:o.jA.Default,...je(e),position:(0,Z.dD)()?o.SC.FeedbackSection:o.SC.ActionButtonBar,handleButtonOnClick:ze}}function Je(){return{type:o.jA.Default,title:(0,n.J40)(),text:(0,Z.dD)()?void 0:(0,n.J40)(),iconRegular:p.rz9,iconHover:p.dLz}}async function Ye(e,t,a,o,r=[]){t((0,O._Z)({caller:e?"InsertList":"InsertTable",numberOfTables:a.length})),_.E.getInstance().updateTelemetryChatEventData({[E.h3.ChatEventType]:E.a5.InsertingListsFromResponse,[E.h3.ChatEventParameters]:JSON.stringify({numberOfTables:a.length,tablesStatistics:r})},N.M.getInstance());let i=(0,n.CLD)();1===a.length&&o?i=(0,n.Yyo)().replace("{0}",o):a.length>1&&(i=(0,n.IKl)().replace("{0}",a.length.toString()));const{message:l,telemetry:s}=Ne.n.getInsertTableSuccessResponse(i);(0,$.yw9)("OfficeVSO_9260802_ActionBarButtonReleaseLock")&&await t((0,O.L4)()),y.$.getInstance().displayResponse(l,s),N.M.getInstance().logEvent((0,E.SV)(e?E.he.InsertListSuccess:E.he.InsertTableSuccess,e?E.q.InsertList:E.q.InsertTable,void 0,void 0,N.M.userQueryGuid))}async function Xe(e,t){N.M.getInstance().logError({eventType:P.S2.ChatEvents,errorMessage:"Error in handle insert table click"+e.message,logLevel:S.$b.ASHA}),(0,$.yw9)("OfficeVSO_9260802_ActionBarButtonReleaseLock")&&await t((0,O.L4)()),N.M.getInstance().logStandardizedAshaErrorEvent(C.W.Unable_To_Complete_Task,f.c.Failed_To_Insert_Table,E.BJ.CopilotChat);const{message:a,telemetry:o}=Ne.n.getInsertTableErrorResponse((0,n.LLM)());y.$.getInstance().displayResponse(a,o)}function Ze(e,t,a,i){return N.M.getInstance().logEvent((0,E.SV)(E.he.ImportDataButtonShowed,E.q.ImportDataFromSearch,void 0,void 0,t)),F.B.getInstance().logSeenEvent(E.q.ImportDataFromSearch),{type:o.jA.Default,title:(0,n.OS6)(),text:(0,Z.dD)()?void 0:(0,n.OS6)(),iconRegular:m.$7G,iconHover:m.B5Q,handleButtonOnClick:async(n,o,l)=>{const s=N.M.getInstance();F.B.getInstance().logKeptEvent(E.BJ.Search,E.q.Search,r.RX.Ask),s.logEvent((0,E.SV)(E.he.ImportDataButtonClicked,E.q.ImportDataFromSearch,void 0,void 0,t)),(0,j.yU)(e,t,i,(0,w.Q9)(a)),ot("ImportData")}}}function Ke(e,t){return N.M.getInstance().logEvent((0,E.SV)(E.he.InsertListShowed,E.q.InsertList,void 0,void 0,N.M.userQueryGuid)),{...Je(),handleButtonOnClick:async(a,n,o)=>{const i=N.M.getInstance();t&&F.B.getInstance().logKeptEvent(E.BJ.Search,E.q.Search,r.RX.Ask),i.logEvent((0,E.SV)(E.he.InsertListClicked,E.q.InsertList,void 0,void 0,N.M.userQueryGuid));try{if(ot("InsertToNewSheet"),!a)throw(0,B.cY)("No messageContentElementId"),i.logError({eventType:P.S2.ChatEvents,errorMessage:"Error in handle insert list click, no messageContentElementId",logLevel:S.$b.Warning}),new Error("No messageContentElementId");const t=function(e){const t=(0,oe.load)(e),a=[];return t("ul").each(((e,n)=>{const o=le(t,n);a.push(o)})),t("ol").each(((e,n)=>{const o=le(t,n);a.push(o)})),a}((0,q.getElementHtmlWithAllStylesInline)(a,void 0,void 0,We()));let n;e((0,O.eM)(E.OP.InsertList)),await(0,Me.F5)((async a=>{for(let o=0;o<t.length;o++){const r=t[o];0!==r.headers.length&&0!==r.rows.length?n=await X(r,e,a):i.logError({eventType:P.S2.ChatEvents,errorMessage:"Error in handle insert list click, empty lists is invalid",logLevel:S.$b.Error})}})),await Ye(!0,e,t,n)}catch(t){await Xe(t,e)}}}}function et(e,t){return N.M.getInstance().logEvent((0,E.SV)(E.he.InsertTableShowed,E.q.InsertTable,void 0,void 0,N.M.userQueryGuid)),{...Je(),handleButtonOnClick:async(a,n,o)=>{const i=N.M.getInstance();t&&F.B.getInstance().logKeptEvent(E.BJ.Search,E.q.Search,r.RX.Ask),i.logEvent((0,E.SV)(E.he.InsertTableClicked,E.q.InsertTable,t?E.KZ.SearchResponse:E.KZ.ChatResponse,void 0,N.M.userQueryGuid));try{if(ot("InsertToNewSheet"),!a)throw(0,B.cY)("No messageContentElementId"),i.logError({eventType:P.S2.ChatEvents,errorMessage:"Error in handle insert table click, no messageContentElementId",logLevel:S.$b.Warning}),new Error("No messageContentElementId");const t=function(e){const t=(0,oe.load)(e),a=[],n=[];return t("table").each(((e,o)=>{const r=[],i=[],l={columns:0,rows:0,citationsCount:0,hyperlinkCount:0,cellFormatType:{date:0,number:0,boolean:0,formula:0,string:0,currency:0,linkCount:0},cellStyleType:{bold:0}};t(o).find("thead th").each(((e,a)=>{r.push(t(a).text().trim())})),t(o).find("tbody tr").each(((e,a)=>{const n={cells:[]};t(a).find("td").each(((e,a)=>{const o={value:""};se(t,a,o,l),t(a).find("strong").each(((e,t)=>{l.cellStyleType.bold++})),ie(o.value,l),n.cells.push(o)})),i.push(n)})),l.columns=r.length,l.rows=i.length,n.push(l),a.push({headers:r,rows:i})})),{tables:a,tablesStatistics:n}}((0,q.getElementHtmlWithAllStylesInline)(a,void 0,void 0,We())),n=t.tables;let o;e((0,O.eM)(E.OP.InsertTable)),await(0,Me.F5)((async t=>{for(let a=0;a<n.length;a++){const r=n[a];0!==r.headers.length?o=await X(r,e,t):i.logError({eventType:P.S2.ChatEvents,errorMessage:"Error in handle insert table click, empty table headers is invalid",logLevel:S.$b.Error})}})),await Ye(!1,e,n,o,t.tablesStatistics)}catch(t){await Xe(t,e)}}}}function tt(e){const t="Dev",a=D.CP.getActiveTable();return{type:o.jA.Default,title:t,text:(0,Z.dD)()?void 0:t,iconRegular:g.SFT,iconHover:g.qTo,handleButtonOnClick:async(n,o,r)=>{(0,B.cY)(`Show Dev Detail Button Clicked for message ID: ${e}`);const c=y.$.getInstance().getChatLog().find((t=>t?.chatMessageBodyData?.messageId===e));if(!c)return;c.startAugloopTimerForStreaming=!1;let d=r;if(r||(d=c?.chatMessageBodyData?.telemetryData),!d)return;try{const e=JSON.parse(d);if(c?.chatMessageBodyData?.feedbackData?.contextData?.cardMetaData){const t=JSON.parse(c.chatMessageBodyData.feedbackData.contextData.cardMetaData);t.promptId&&(e.promptId=t.promptId)}a&&(e.activeTableName=a.name,a.tableLikeRange||(e.activeTableAddress=a.address));d=JSON.stringify(e,null,2)}catch(e){}const u=(e,a)=>{if(e.chatMessageBodyData?.actionButtonList){if(!e.chatMessageBodyData?.messageId)return;e.chatMessageBodyData.actionButtonList=e.chatMessageBodyData.actionButtonList.filter((e=>e.title!==t)),a&&y.$.getInstance().updateMessage(e)}},m=c.chatMessageData?.defaultMessageProps;if(m?.messageHeader?.text)return m.messageHeader.text+=`\n\n ${d}`,u(c,!1),void y.$.getInstance().updateMessage(c);const h=c.chatMessageData?.markDownCardProps;if(h?.message){h.message+=`\n\n ${d}`,u(c,!1);const e=c.chatMessageBodyData;return e?.feedbackSectionPosition&&(e.feedbackSectionPosition=i.O.Footer,e.shouldShowAIGeneratedIndicator=!0),void y.$.getInstance().updateMessage(c)}const g={chatCardType:l._.Default,chatMessageData:{defaultMessageProps:{user:s.Q9.Chat,messageHeader:{text:d}}},addCardToChatHistory:!1};u(c,!0),y.$.getInstance().displayResponse(g)}}}function at(e,t){const a=(0,n.FA0)();return{type:o.jA.Default,title:a,text:a,iconRegular:b.ZwM,iconHover:b.XWm,handleButtonOnClick:async()=>{try{const{message:a,telemetry:n}=(0,H.b7)();y.$.getInstance().displayResponse(a,n),await(0,H.iT)(e,t)}catch(e){N.M.getInstance().logError({eventType:P.S2.ChatEvents,errorMessage:`$"Error in auto fix button" ${e.message}`,logLevel:S.$b.Error})}}}}function nt(e,t){const a=e.sheetRange.sheet;D.CP.setSheetGoBackButtonPointTo(t);const r=(0,U.L)((0,n.zyf)(),e.sheetRange.sheet),i="Error in go back to data button";return{type:o.jA.Default,title:r,text:r,handleButtonOnClick:async()=>{try{await Excel.run((async n=>{if(!e)return void N.M.getInstance().logError({eventType:P.S2.ChatEvents,errorMessage:`${i}, no tableContext`,logLevel:S.$b.Warning});const o=x.ExcelCalc.IExcelRangeToAddress(e.sheetRange.range);n.workbook.worksheets.getItem(t||a).getRange(o).select(),await n.sync()}))}catch(e){N.M.getInstance().logError({eventType:P.S2.ChatEvents,errorMessage:i,logLevel:S.$b.ASHA})}}}}function ot(e,t,a){const o=y.$.getInstance().getLastMessage();if(!o?.actionBarButtons?.length)return;const r=[...o.actionBarButtons];let i=o.strikeThroughText,l=!1;const s=r.findIndex((e=>e.title===(0,n.sUU)())),c=r.findIndex((e=>{const a=t?(0,U.L)((0,n.zyf)(),t):(0,n.vG7)();return e.title===a})),d=r.findIndex((e=>e.title===(0,n.f7s)())),u=r.findIndex((e=>e.title===(0,n.H2U)())),m=r.findIndex((e=>e.title===(0,n.Rp5)())),h=r.findIndex((e=>e.title===(0,n.yZI)())),g=r.findIndex((e=>e.title===(0,n.OS6)())),p=r.findIndex((e=>e.title===(0,n.J40)())),b=r.findIndex((e=>e.title===(0,n.oOI)()));switch(e){case"EnableApply":-1!==h&&(r[h].isDisabled=!1,l=!0);break;case"DisableUndo":D.CP.clearCachedTableInterpretationsForUndo(),-1!==s&&(r[s]={...Oe(),isDisabled:!0,handleButtonOnClick:()=>{}},l=!0);break;case"RemoveUndo":D.CP.clearCachedTableInterpretationsForUndo(),-1!==s&&(r.splice(s,1),i=!0,l=!0,-1!==u&&r.splice(u,1));break;case"RemoveSaveScript":-1!==m&&r.splice(m,1);break;case"RemoveGoBackToData":-1!==c&&(r.splice(c,1),D.CP.setSheetGoBackButtonPointTo(void 0),l=!0);break;case"RemoveExplain":-1!==d&&(r.splice(d,1),l=!0);break;case"RemoveAll":r.length=0,l=!0;break;case"ImportData":-1!==g&&(r.splice(g,1),l=!0);break;case"InsertToNewSheet":-1!==p&&(r.splice(p,1),l=!0);break;case"InsertFormulaSuggestion":-1!==b&&(r.splice(b,1),l=!0);break;case"UpdateGoBackToData":if(-1!==c){if(a&&""!==a){const e=(0,U.L)((0,n.zyf)(),a);r[c].title=e,r[c].text=e}else r[c].isDisabled=!0;D.CP.setSheetGoBackButtonPointTo(void 0),l=!0}}l&&((0,$.yw9)("OfficeVSO_8923945_UpdateLastMessage")?y.$.getInstance().updateMessage({chatCardType:o.messageType,chatMessageBodyData:{actionButtonList:[...r],strikeThroughText:i,messageId:o.messageId},addCardToChatHistory:!1}):y.$.getInstance().updateLastMessage({chatCardType:o.messageType,chatMessageBodyData:{actionButtonList:[...r],strikeThroughText:i},addCardToChatHistory:!1}))}function rt(e,t){const a=[...e];return(0,$.jHv)()&&a.push(tt(t)),a}},644864:(e,t,a)=>{"use strict";function n(e){const t=e.length;return e.map(((a,n)=>e[t-n-1]))}function o(e){return e.sort(((e,t)=>e.value<t.value?-1:e.value>t.value?1:0))}function r(e,t,a){let n=e.data[t][0].map(((e,t)=>({index:t,value:e})));(e.exceptionalDatapoints||[]).forEach((e=>{n[e.index].exceptionalDatapoint=e})),(e.dataMarkers?.exceptionalDataMarkers||[]).forEach((e=>{n[e.index].exceptionalDataMarker=e})),n=a(n);const o=Object.keys(e.data).reduce(((t,a)=>{return{...t,[a]:(o=e.data[a],r=n,o.map((e=>e.map(((t,a)=>e[r[a].index])))))};var o,r}),{}),r=[];n.forEach(((e,t)=>{e.exceptionalDatapoint&&r.push({...e.exceptionalDatapoint,index:t})}));const i=[];n.forEach(((e,t)=>{e.exceptionalDataMarker&&i.push({...e.exceptionalDataMarker,index:t})}));const l={...e,data:o,exceptionalDatapoints:r};return i.length>0&&(l.dataMarkers={...l.dataMarkers,exceptionalDataMarkers:i}),l}function i(e,t){if(1!==t.dimensions.length||!e.binOptions)return[];const a=e.binOptions,n=t.dimensions[0].values.raw.filter((e=>"number"==typeof e&&Number.isFinite(e)));n.sort(((e,t)=>e-t));let o=n[0],r=n[n.length-1],i=a.binCount;a.underflow&&(o=a.underflow,i--),a.overflow&&(r=a.overflow,i--);let l=0;const s=[];if(a.underflow){let e=0;for(;l<n.length&&n[l]<=o+Number.EPSILON;)e++,l++;s.push(e)}for(let e=1;e<=i;e++){const t=Math.min(o+e*a.binWidth,r);let i=0;for(;l<n.length&&n[l]<=t+Number.EPSILON;)i++,l++;s.push(i)}return a.overflow&&s.push(n.length-l),s}function l(e){const t=e.data.values[0];let a=!1;for(let e=0;e<t.length;e++)"NaN"!==t[e]?(!a&&(e+1>=t.length||"NaN"===t[e+1])&&(t[e]="NaN"),a=!0):a=!1;const n={...e};return n.data.values[0]=t,n}a.d(t,{Hw:()=>n,Lt:()=>r,Mi:()=>i,V0:()=>o,jx:()=>l})},648870:(e,t,a)=>{"use strict";a.d(t,{n:()=>y});var n=a(267324),o=a(700853),r=a(63919),i=a(856656),l=a(322466),s=a(365319),c=a(644737),d=a(9847),u=a(912477),m=a(49236),h=a(949404),g=a(528804);const p=d.q.OfficeJsCommanding,b=d.q.ChartDesignRecommendations,f="Copilot\\Chart Design Recommendations";function C(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:r.Q9.Human,messageHeader:{text:e}}}},telemetry:{featureName:p,eventType:d.a5.ActionConfirmationMessage}}}const y={getOfficeJsGenericSuccess:function(e,t,a,s,u=d.q.OfficeJsCommanding){const m=[];return e&&(0,g.BAK)()&&m.push((0,c.FW)(u)),a&&s?.length&&m.push({type:i.jA.Default,title:(0,n.f7s)(),text:(0,n.f7s)(),handleButtonOnClick:async()=>{(0,c.s_)(c.H0.RemoveExplain),t(s)}}),{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:r.Q9.Chat,messageHeader:{text:a??(0,n.CLD)()}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:m,feedbackSectionPosition:l.O.Footer}},telemetry:{featureName:u,eventType:d.a5.ActionConfirmationMessage}}},getOfficeJsChangeWarning:function(e,t,a,l,m,h,g){const b=(0,n.hJV)(),f=(0,n.yPQ)(),y=()=>{(0,c.s_)(c.H0.RemoveAll);const{message:n,telemetry:o}=C(b);s.$.getInstance().displayResponse(n,o),m.onChangeAccepted(e,t,a,l,h,g)};u.MK.acceptUpcomingChange(e,y);const v={user:r.Q9.Chat,embeddedLists:[{listHeader:(0,n.zSd)(),listItems:a.map((e=>({text:e}))),listFooter:{text:(0,n.AbP)()}}]};return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:v},chatMessageBodyData:{messageId:e,actionButtonList:[{type:i.jA.Default,title:b,text:b,handleButtonOnClick:y},{type:i.jA.Default,title:f,text:f,handleButtonOnClick:async()=>{const{message:e,telemetry:t}=C(f);s.$.getInstance().displayResponse(e,t),(0,c.s_)(c.H0.RemoveAll)}}]}},telemetry:{featureName:p,eventType:d.a5.ActionConfirmationMessage}}},getOfficeJsCodeExplanation:function(e,t,a){const n={user:r.Q9.Chat,embeddedLists:[{listHeader:t,listItems:e.map((e=>({text:e})))}]};return{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:n},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,actionButtonList:a&&(0,g.BAK)()?[(0,c.FW)(p)]:[],feedbackSectionPosition:l.O.Footer}}},getOfficeJsInitialCodeExplanation:function(e,t,a,h,g,b,f,y){const v=(0,n.yZI)(),x=()=>{(0,c.s_)(c.H0.RemoveAll);const{message:n,telemetry:o}=C(v);s.$.getInstance().displayResponse(n,o),b.onChangeAccepted(e,t,a,g,f,y)};return u.MK.acceptUpcomingChange(e,x),{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:r.Q9.Chat,renderData:(0,m.IM)("ScratchpadCommandingCard",h)}},chatMessageBodyData:{messageId:e,actionButtonList:[{type:i.jA.Default,title:v,text:v,isDisabled:!0,handleButtonOnClick:x}],feedbackSectionPosition:l.O.Footer}},telemetry:{featureName:p,eventType:d.a5.ActionConfirmationMessage}}},getChartDesignRecommendationsResponseMessage:function(e,t){return{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:r.Q9.Chat,renderData:(0,m.IM)("ChartDesignRecommendationsCard_V1",{...t})}},chatMessageBodyData:{messageId:e,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:l.O.Footer,feedbackData:{feedbackArea:f}},addCardToChatHistory:!1},telemetry:{featureName:b,eventType:d.a5.ChartDesignRecommendationsCardShown}}},getChartDesignRecommendationsSnowballChartResponseMessage:function(e,t){return{message:{chatCardType:o._.ChatCardWrapper,chatMessageData:{chatCardWrapperProps:{user:r.Q9.Chat,renderData:(0,m.IM)("ChartDesignRecommendationsSnowballChartCard_V1",{queryId:e,isTriggeredViaOOUI:t})}},chatMessageBodyData:{messageId:e,shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:l.O.Footer,feedbackData:{feedbackArea:f}},addCardToChatHistory:!1},telemetry:{featureName:b,eventType:d.a5.ChartDesignRecommendationsCardShown}}},getChartDesignRecommendationsFailedResponse:function(e,t){return(0,h.v)(e,{featureName:b,errorType:t},{},{feedbackData:{feedbackArea:f}})},getOfficeJsApplicationFailure:function(e){return{message:{chatCardType:o._.Default,chatMessageData:{defaultMessageProps:{user:r.Q9.Chat,embeddedLists:[{listHeader:(0,n.v3A)(),listItems:[{text:e[0]}]}]}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:l.O.Footer}},telemetry:{featureName:p,eventType:d.a5.ActionConfirmationMessage}}}}},651537:(e,t,a)=>{"use strict";a.d(t,{E:()=>n});const n={ClientProgramResponseError:"ClientProgramResponseError",DisengagedError:"DisengagedError",InferenceAPIError:"InferenceAPIError",InputQueryError:"InputQueryError",LicensingError:"LicensingError",ODSLParseError:"ODSLParseError",ODSLSyntaxError:"ODSLSyntaxError",OffensiveContent:"OffensiveContent",SkillFailedError:"SkillFailedError",SydneyCancelledError:"SydneyCancelledError",IgnorableError:"IgnorableError",SydneyError:"SydneyError",TokenCountError:"TokenCountError",UnsupportedLanguageError:"UnsupportedLanguageError",UnrecognizedTabularRange:"UnrecognizedTabularRange",ExcelTabularSkillFailedError:"ExcelTabularSkillFailedError",PythonSkillFailedError:"PythonSkillFailedError",OfficeJsSkillFailedError:"OfficeJsSkillFailedError"}},654417:(e,t,a)=>{"use strict";a.d(t,{$:()=>A});var n=a(725556),o=a(267324),r=a(313963),i=a(661053),l=a(886866),s=a(397502),c=a(576583),d=a(215592),u=a(340267),m=a(96994),h=a(11248),g=a(486092),p=a(593562),b=a(632927),f=a(416223),C=a(376116);const y=(0,c.n)({title:C.g.body1Strong,explanation:{...C.g.body1,...d.shorthands.padding(0),boxSizing:"border-box","& p":{...d.shorthands.margin(0)},"& ul":{...d.shorthands.margin("8px","0px","0px"),paddingInlineStart:"24px"}}});function v({id:e,explanation:t}){const a=y();return t?t.isLoading?(0,n.jsx)(b.Q,{}):(0,n.jsx)(f.u,{id:e,text:t.explanation,className:a.explanation}):null}var x=a(751314),T=a(9847),S=a(944563),w=a(8745),E=a(208520);const I=(0,c.n)({contentCondensed:{"&[data-fui-focus-visible]":{...d.shorthands.outline(S.k1.strokeWidthThick,"solid",S.k1.colorStrokeFocus2),position:"relative",zIndex:1}},contentExpanded:{maxHeight:"none"},contentContainer:{textAlign:"left /* @noflip */",scrollbarGutter:"stable"},contentContainerCondensed:{maxHeight:"7.5em"},explanationDivider:{minHeight:"2em"},header:{display:"flex",flexDirection:"row",alignItems:"center",...d.shorthands.gap("4px")},content:{background:"unset"},footer:{display:"flex",flexDirection:"row-reverse",...d.shorthands.padding(0)},footerForeground:{color:S.k1.colorNeutralForeground3,"&:hover":{color:S.k1.colorNeutralForeground2Hover},"&:hover:active":{color:S.k1.colorNeutralForeground2Pressed},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},footerForegroundDisabled:{color:S.k1.colorNeutralForegroundDisabled}}),R={math:r.y4p,code:i.P1J},A=({icon:e,title:t,content:a,explanation:r,getClipboardItem:i,telemetryUsageFeatureName:c,suggestionId:d,ariaAttributes:b,alwaysShowExplanation:f,copyButtonAriaLabelSuffix:C})=>{const y=(0,u.Bi)("snippet-explanation-"),S=I(),[A,L]=E.useState(f);(0,w.IC)(A,(()=>{r?.onFirstTimeExplanationShown?.()}));const k=r&&(r.isNotAvailable||!r.isLoading&&!r.explanation);return(0,E.useEffect)((()=>{k&&L(!1)}),[k]),(0,n.jsxs)(x.Y,{role:"group","aria-label":b?.["aria-label"]??o.olU.CodeSnippetWithExplanation_AriaLabel,header:function(){if(!e&&!t)return;const a=e&&R[e];return(0,n.jsxs)("div",{className:S.header,children:[a&&(0,n.jsx)(a,{}),t||null]})}(),footer:function(){if(!r||f)return;const e=A?l.g4$:l.rLf,t=(0,n.jsx)(m.f,{"aria-roledescription":(0,o.qcV)(),checked:A,disabled:k,size:"small",appearance:"transparent",iconPosition:"after",className:k?S.footerForegroundDisabled:S.footerForeground,onClick:()=>L(!A),icon:(0,n.jsx)(e,{className:k?S.footerForegroundDisabled:S.footerForeground}),"aria-expanded":A,"aria-controls":y,children:A?o.olU.CodeSnippetWithExplanation_ExplanationButton_Hide:o.olU.CodeSnippetWithExplanation_ExplanationButton_Show});return{className:S.footer,children:k?(0,n.jsx)(h.m,{withArrow:!0,content:o.olU.CodeSnippetWithExplanation_ExplanationNotAvailable,relationship:"label",children:t}):t}}(),controls:i&&(0,n.jsx)(s.i,{getClipboardItem:i,telemetryUsageData:{actionType:T.he.FormulaCopyClicked,source:T.KZ.CopyFormulaButton,featureName:c,suggestionId:d},ariaLabelSuffix:C}),content:{className:(0,g.z)(A?S.contentExpanded:S.contentCondensed,S.content),tabIndex:0},children:[(0,n.jsx)("div",{dir:"ltr",className:(0,g.z)(S.contentContainer,!A&&S.contentContainerCondensed),children:a}),A&&r&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p.c,{className:S.explanationDivider}),(0,n.jsx)(v,{id:y,explanation:r})]})]})}},654845:(e,t,a)=>{"use strict";a.d(t,{N:()=>c});var n=a(83437),o=a(620316),r=a(173339),i=a(516999),l=a(375485);function s(){return{msalDefined:void 0!==window.msal,browserAuthDefined:void 0!==window.BrowserAuth}}class c{handleError(e){"string"==typeof e&&e.indexOf("BrowserAuth")>=0&&this.loadPromise&&this.loadPromise.reject(new Error(e))}async ensureAuthLibraryLoaded(e){const t=this.providers.getCurrent();if(t.isLoaded())return;const a=new l.A("LoadAuthLibrary",[{level:n.$b.ASHA,timeout:r.R.getLoadAuthLibraryAshaTimeout()},{level:n.$b.Error,timeout:r.R.getLoadAuthLibraryAceTimeout()}]);a.sendStart({parentCallId:e});const o={numFailures:0},c=()=>(0,i.U)((()=>this.loadAuthLibraryFn(t)),(()=>!0),(()=>(o.numFailures++,!1)),5,o);try{await(0,i.Y)(c,r.R.getLoadAuthLibraryTimeout()),a.succeed({...o,parentCallId:e,debugData:s(),provider:t.getName(),...t.getLoadProps()})}catch(r){throw a.fail(n.$b.Warning,{...o,parentCallId:e,debugData:s(),provider:t.getName(),...t.getLoadProps()},r),new Error("Authorization Error")}}constructor(e){this.loadAuthLibraryFn=async e=>new Promise(((t,a)=>{const n=new o.c(t,a);e.load().then((()=>n.resolve())).catch(n.reject),this.loadPromise=n})),this.providers=e}}},660606:(e,t,a)=>{"use strict";a.d(t,{EG:()=>n,JB:()=>i,YP:()=>s,cY:()=>l,s7:()=>c,t6:()=>o});var n,o,r=a(801609),i=void 0,l=function(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a]},s=function(e,t,a,r){i=e,l=t,n=a,o=r};function c(e){if(!e)return r.D.PRODUCTION;var t=e.toLowerCase();return t.indexOf("augloop.office.com")>=0||t.indexOf("augloop-int.officeppe.com")>=0?r.D.PRODUCTION:t.indexOf("augloop-gcc.office.com")>=0||t.indexOf("gcc.augloop.svc.cloud.microsoft")>=0?r.D.GCC:t.indexOf("augloop.gov.online.office365.us")>=0?r.D.GCCHIGH:t.indexOf("augloop.dod.online.office365.us")>=0?r.D.DOD:t.includes("dogfood")?r.D.DOGFOOD:r.D.PRODUCTION}},671100:()=>{},677871:(e,t,a)=>{"use strict";a.d(t,{N:()=>n});class n{getTable(e){return this.tableName?e.workbook.worksheets.getItem(this.sheetId).tables.getItem(this.tableName):null}getSheet(e){return e.workbook.worksheets.getItem(this.sheetId)}getRange(e){return e.workbook.worksheets.getItem(this.sheetId).getRange(this.address)}getRangeFromReferences(e,t){if(1!==t.length)throw new Error("Invalid number of references.");const a=this.getRange(e),{top:n,right:o,bottom:r,left:i}=t[0],l=a.getCell(n,i),s=a.getCell(r,o);return l.getBoundingRect(s)}getTopLeftCell(e){return e.workbook.worksheets.getItem(this.sheetId).getRange(this.address).getCell(0,0)}constructor(e,t,a,n){this.sheetId=e,this.sheetName=t,this.address=a,this.tableName=n}}},686576:(e,t,a)=>{"use strict";a.d(t,{e:()=>v,z:()=>y});var n=a(725556),o=a(886866),r=a(94186),i=a(267324),l=a(965634),s=a(96994),c=a(202051),d=a(528804),u=a(804672),m=a(962127),h=a(991869),g=a(977055),p=a(57980),b=a(988013),f=a(208520),C=a(979426);const y={None:"None",Image:"image",Boolean:"boolean",String:"string",Number:"number",Json:"json",Table:"table",TableWithObjects:"tableWithObjects",Object:"object"};function v(e){const{output:t,outputType:a,tableHasHeader:v}=e,x=(0,b.j)(),[T,S]=(0,f.useState)(!1),[w,E]=(0,f.useState)(!1),I=(0,f.useRef)(null),R=38,A=55,L="vh";(0,f.useEffect)((()=>{const e=()=>{if(I.current){const e=I.current.scrollHeight,t=window.innerHeight;E(e>R/100*t)}},t=setTimeout(e,0);return window.addEventListener("resize",e),()=>{clearTimeout(t),window.removeEventListener("resize",e)}}),[t,a]);const k=(0,f.useMemo)((()=>{const e=(0,m.wP)(),t=(0,m.Xj)(e).palette;return(0,p.l8)({image:{maxWidth:"100%"},jsonPre:{color:t.neutralSecondary,border:`1px solid  ${t.neutralSecondaryAlt}`,borderRadius:"4px",padding:"8px",overflowX:"auto",fontFamily:"monospace",maxHeight:"300px",overflowY:"auto",whiteSpace:"pre-wrap",fontSize:"14px"},tableContainer:{overflowX:"auto",overflowY:"auto",border:`1px solid ${t.neutralSecondaryAlt}`,borderRadius:"8px",width:"100%",maxWidth:"100%",maxHeight:`${A}${L}`,scrollbarWidth:"thin",scrollbarColor:`${t.neutralTertiaryAlt} transparent`,"&::-webkit-scrollbar":{width:"8px",height:"8px"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:t.neutralTertiaryAlt,borderRadius:"4px",border:"2px solid transparent",backgroundClip:"content-box"},"&::-webkit-scrollbar-thumb:hover":{backgroundColor:t.neutralSecondary},"&::-webkit-scrollbar-corner":{backgroundColor:"transparent"}},table:{borderCollapse:"separate",borderSpacing:"0",width:"auto",minWidth:"100%",position:"relative"},headerCell:{padding:"2px 4px",textAlign:"left",background:"#f8f9fa",borderBottom:`3px solid ${t.neutralSecondaryAlt}`,borderRight:`1px solid ${t.neutralSecondaryAlt}`,whiteSpace:"nowrap",minWidth:"80px",position:"sticky",top:0,zIndex:100,"&::after":{content:'""',position:"absolute",bottom:"-2px",left:0,right:0,height:"4px",backgroundColor:"#f8f9fa",zIndex:99},"&:last-child":{borderRight:"none"}},headerCellRightAligned:{padding:"2px 4px",textAlign:"right",background:"#f8f9fa",borderBottom:`3px solid ${t.neutralSecondaryAlt}`,borderRight:`1px solid ${t.neutralSecondaryAlt}`,whiteSpace:"nowrap",minWidth:"80px",position:"sticky",top:0,zIndex:100,"&::after":{content:'""',position:"absolute",bottom:"-2px",left:0,right:0,height:"4px",backgroundColor:"#f8f9fa",zIndex:99},"&:last-child":{borderRight:"none"}},headerText:{fontWeight:600,color:t.neutralPrimary},tableCell:{padding:"2px 4px",textAlign:"left",color:t.neutralSecondary,borderBottom:`1px solid ${t.neutralSecondaryAlt}`,borderRight:`1px solid ${t.neutralSecondaryAlt}`,minWidth:"80px",maxWidth:"160px","&:last-child":{borderRight:"none"}},tableCellRightAligned:{padding:"2px 4px",textAlign:"right",color:t.neutralSecondary,borderBottom:`1px solid ${t.neutralSecondaryAlt}`,borderRight:`1px solid ${t.neutralSecondaryAlt}`,minWidth:"80px",maxWidth:"160px","&:last-child":{borderRight:"none"}},outputLabel:{fontWeight:600},stringOutput:{color:t.themeSecondary,whiteSpace:"pre-wrap",overflow:"visible",textOverflow:"clip",display:"block",wordBreak:"break-word",maxWidth:"100%"},expandButtonContainer:{textAlign:"left",margin:"3px 0"},tableToggleButtonStyle:{color:t.neutralSecondary,paddingLeft:"2px !important",marginLeft:"4px !important","&:hover":{color:t.neutralSecondary,paddingLeft:"2px",marginLeft:"4px"},"&:hover:active":{color:t.neutralPrimary,paddingLeft:"2px",marginLeft:"4px"},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},lastRowCell:{padding:"2px 4px",textAlign:"left",color:t.neutralSecondary,borderRight:`1px solid ${t.neutralSecondaryAlt}`,minWidth:"80px","&:first-child":{borderBottomLeftRadius:"7px"},"&:last-child":{borderRight:"none",borderBottomRightRadius:"7px"}},lastRowCellRightAligned:{padding:"2px 4px",textAlign:"right",color:t.neutralSecondary,borderRight:`1px solid ${t.neutralSecondaryAlt}`,minWidth:"80px","&:first-child":{borderBottomLeftRadius:"7px"},"&:last-child":{borderRight:"none",borderBottomRightRadius:"7px"}}})}),[m.wP,m.Xj]);let F=(0,n.jsx)("div",{children:t});const _=(0,h.xt)();switch(a){case y.Image:{let e,o;try{e=JSON.parse("string"==typeof t?t:"{}").base64_data}catch(e){const t=(0,c.Wx)((0,c.MQ)(e,"RenderModelessOutput"),e);(0,c.QX)(x,t,!1);break}if((0,d.g6K)()&&(o=JSON.parse("string"==typeof t?t:"{}").chart_json),o){const e=JSON.parse("string"==typeof t?t:"{}"),a={chartId:(0,u.RE)(e.title,e.summary),inputChartSchema:o};F=(0,n.jsx)(r.e,{...a})}else{const t=a||"png";F=(0,n.jsx)("img",{src:`data:image/${t};base64,${e}`,alt:"Data visualization",className:k.image}),(0,d.g6K)()&&(0,g.PB)(l.L3.StaticChartRendered,[])}break}case y.Boolean:case y.Number:case y.String:F=(0,n.jsx)("div",{className:k.stringOutput,children:String(t).replace(/^"|"$|\\"/g,"")});break;case y.Json:try{const e=JSON.parse("string"==typeof t?t:"{}"),a=JSON.stringify(e,null,2),o=e=>e.replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,((e,t)=>e.match(/"[^"]*":/g)?e:t.replace(/\\"/g,'"').replace(/\\\\/g,"\\"))),r=o(a);F=(0,n.jsx)("pre",{className:k.jsonPre,children:r})}catch(e){const t=(0,c.Qi)((0,c.MQ)(e,"RenderModelessOutput"),e);(0,c.QX)(x,t,!1)}break;case y.Table:case y.TableWithObjects:try{const e=(0,d.yw9)("OfficeVSO_10196331_Handle_Table_With_Objects_Edge_Case")?t:JSON.parse("string"==typeof t?t:"[]"),a=(e,t,a)=>(0,d.yw9)("OfficeVSO_10325780_NumbersRightAligned")&&(0,C.C)(e)||_?t===a-1?k.lastRowCellRightAligned:k.tableCellRightAligned:t===a-1?k.lastRowCell:k.tableCell;if(Array.isArray(e)&&e.length>0&&Array.isArray(e[0])){const t=v??!0;let r=[],l=[];t?(r=e[0],l=e.slice(1)):l=e,F=(0,n.jsxs)("div",{children:[(0,n.jsx)("div",{ref:I,className:k.tableContainer,style:{maxHeight:T?`${A}${L}`:`${R}${L}`},children:(0,n.jsxs)("table",{className:k.table,children:[t&&(0,n.jsx)("thead",{children:(0,n.jsx)("tr",{children:r.map(((e,t)=>(0,n.jsx)("th",{className:_?k.headerCellRightAligned:k.headerCell,children:(0,n.jsx)("span",{className:k.headerText,children:e})},t)))})}),(0,n.jsx)("tbody",{children:l.map(((e,t)=>(0,n.jsx)("tr",{children:e.map(((e,o)=>(0,n.jsx)("td",{className:a(e,t,l.length),children:String(e)},o)))},t)))})]})}),w&&(0,n.jsx)("div",{className:k.expandButtonContainer,children:(0,n.jsx)(s.f,{checked:T,size:"small",appearance:"transparent",iconPosition:"after",onClick:()=>S(!T),className:k.tableToggleButtonStyle,icon:T?(0,n.jsx)(o.g4$,{className:k.tableToggleButtonStyle}):(0,n.jsx)(o.rLf,{className:k.tableToggleButtonStyle}),children:(0,n.jsx)("span",{className:k.tableToggleButtonStyle,children:T?(0,i.EB5)():(0,i.PHI)()})})})]})}}catch(e){const t=(0,c.pz)((0,c.MQ)(e,"RenderModelessOutput"),e);(0,c.QX)(x,t,!1)}break;case y.None:F=(0,n.jsx)("div",{})}try{return(0,n.jsx)("div",{children:F})}catch{return(0,n.jsx)("div",{})}}},689534:(e,t,a)=>{"use strict";var n,o;a.d(t,{O:()=>n,f:()=>o}),function(e){e.MissingIntent="MissingIntent",e.NoIntentNeeded="NoIntentNeeded",e.UnhandledIntent="Missing intent string"}(n||(n={})),function(e){e.Never="Never"}(o||(o={}))},691097:(e,t,a)=>{"use strict";function n(e){if(Office.context.document?.settings?.get){const t=Office.context.document.settings.get(e);if(null===t)return;return t}throw new Error("Unable to get initial taskpane state. 'Office.context.document.settings.get' is not defined.")}function o(){return{AudienceGroup:n("AudienceGroup"),Script:n("Script"),StorageModePreference:n("StorageModePreference"),StartTimeMs:n("StartTimeMs"),copilotPaneStartTimestamp:n("copilotPaneStartTimestamp"),CopilotSaveAutomation:n("CopilotSaveAutomation"),CopilotPAIntegration:n("CopilotPAIntegration"),HandoffMessageId:n("HandoffMessageId"),LaunchOfficeScriptsSDXOptionalProperties:n("LaunchOfficeScriptsSDXOptionalProperties"),optionalProperties:n("optionalProperties"),FlowCreated:n("FlowCreated"),SessionLocation:n("SessionLocation")}}a.d(t,{P:()=>n,i:()=>o})},697705:(e,t,a)=>{"use strict";a.d(t,{B:()=>E});var n=a(9847),o=a(24784),r=a(12163),i=a(46692),l=a(965634),s=a(722307),c=a(99394),d=a(41192),u=a(984691),m=a(95151),h=a(476730),g=a(956258),p=a(233488),b=a(272487),f=a(79458),C=a(528804),y=a(308849),v=a(328831),x=a(993821),T=a(448514),S=a(310681),w=a(46566);class E extends m.TelemetryHandler{initializeCheckPoint(){if(this.recordCheckPoint(n._R.TaskPaneStart,Number(b.excelTaskPaneStartTime)),this.recordCheckPoint(n._R.AppLoadStart,Number(p.appLoadStartTime)),p.officeOnReadyTime&&this.recordCheckPoint(n._R.OfficeJSReady,p.officeOnReadyTime),(0,C.yw9)("OfficeVSO_9262045_ShouldRecordAppAndCopilotPaneStartCheckpoints")){const e=c.V.getSetting(c.z.AppStartTimestamp);e&&this.recordCheckPoint(n._R.AppStart,e);const t=c.V.getSetting(c.z.CopilotPaneStartTimestamp);t&&!(0,b.getPreloadCopilot)()&&this.recordCheckPoint(n._R.CopilotPaneStart,t)}}setCopilotPaneStartPerfMark(){const e=c.V.getSetting(c.z.CopilotPaneStartTimestamp);let t=e?performance.timeOrigin-e:0;t=t>0?t:0,performance.measure("bizchat-metaOS-app.ClickToNavigationStart",{start:0,duration:t})}sendChatEventTelemetry(e,t){return e.push({key:n.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())}),this.telemetryLoggerUtils.sendTelemetryChatEventData(e,t)}sendLatencyTelemetry(e,t){return e.push({key:n.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())}),this.telemetryLoggerUtils.sendTelemetryLatencyData(e,t)}sendErrorTelemetry(e){e.push({key:n.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())}),this.telemetryLoggerUtils.sendTelemetryErrorData(e)}sendTelemetryChatEventData(e){this.sendChatEventTelemetry(e)}sendTelemetryErrorData(e){this.sendErrorTelemetry(e)}sendTelemetryLatencyData(e){this.sendLatencyTelemetry(e)}static getInstance(){return E.instance||(E.instance=new E,m.TelemetryLoggerUtils.getInstance().setTelemetryHandler(E.instance)),E.instance}updateTelemetryOnAnnotationReceived(e,t,a,n,o,r,i){}resetActiveFeature(){E.querySource=E.nextQuerySource?E.nextQuerySource:n.BC.Default,E.nextQuerySource=n.BC.Default,E.querySource===n.BC.ExternalQuery?E.currentEntryPoint=n.Y9.Canvas:E.currentEntryPoint=n.Y9.Chat}setQuerySource(e){E.nextQuerySource=e}LogTelemetryEvent(e){let t=!1;switch(e.GetEventName()){case d.lr.AshaError:case d.lr.Chat:if(e.GetEventName()===d.lr.AshaError&&(t=!0),e.GetShouldLog()){e.SetIsRequired(!0);const a=e.GetLogs().some((e=>"Copilot.FeatureActionType"===e.name&&e.value===o.TA.FeatureActionType.IsTried));this.logSharedCopilotChatTelemetryEvent(e,a,t)}break;case d.lr.ChatEvents:if(!e.GetShouldLog()){for(const t of e.GetLogs())t.name!==n.h3.UserQueryGuid&&(this.telemetryChatEventObject[t.name]=t.value);break}e.SetIsRequired(!0),e.SetLogs([...e.GetLogs(),...this.getDataFields([{key:n.h3.UserQueryGuid,value:g.M.userQueryGuid},{key:n.h3.UserQueryOrder,value:g.M.userQueryOrder},{key:n.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())},...(0,C.yw9)("OfficeVSO_9857355_addDevBuildChatEvent")?this.getDefaultTelemetryData():[],...Object.keys(this.telemetryChatEventObject).map((e=>({key:e,value:this.telemetryChatEventObject[e]})))])]),this.logSharedTelemetryEvent(e),this.telemetryChatEventObject={};break;case d.lr.Latency:if(!e.GetShouldLog()){for(const t of e.GetLogs())t.name===n.CT.CopilotChatHistoryInfoJson?this.chatHistoryLog=this.chatHistoryLog.concat(JSON.parse(t.value)):t.name!==n.CT.UserQueryGuid&&(this.telemetryLatencyObject[t.name]=t.value);break}e.SetIsRequired(!0),e.SetLogs([...e.GetLogs().filter((e=>e.name!==n.CT.CopilotChatHistoryInfoJson)),...this.getDataFields([{key:n.CT.CopilotChatHistoryInfoJson,value:JSON.stringify(this.chatHistoryLog)},{key:n.CT.UserQueryGuid,value:g.M.userQueryGuid},{key:n.CT.AugloopSessionGuid,value:w.O},{key:n.CT.FeatureName,value:this.telemetryLogger.getActiveFeature()},{key:n.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())},...Object.keys(this.telemetryLatencyObject).map((e=>({key:e,value:this.telemetryLatencyObject[e]})))])]),this.logSharedTelemetryEvent(e),this.chatHistoryLog=[],this.telemetryLatencyObject={};break;case d.lr.Error:if(!e.GetShouldLog())break;e.SetLogs([...e.GetLogs(),...this.getDataFields([{key:n.h3.UserQueryGuid,value:g.M.userQueryGuid},{key:n.h3.ExtensibilityInfo,value:(0,y.Sd)((0,v.Ld)(),(0,v.Gn)())},...(0,C.yw9)("OfficeVSO_9857355_addDevBuildChatEvent")?this.getDefaultTelemetryData():[]])]),this.logSharedErrorEvent(e)}}getDataFields(e){return e.map((e=>"number"==typeof e.value?(0,r.ip)(e.key,e.value):"string"==typeof e.value?(0,r.m9)(e.key,e.value):"boolean"==typeof e.value?(0,r.LK)(e.key,e.value):(0,r.m9)(e.key,e.value)),[])}logSharedCopilotChatTelemetryEvent(e,t,a){const n={telemetryProperties:this.telemetryLogger.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.IsRequired()&&(t||a)?i.o.DiagnosticLevel.RequiredServiceData:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?i.o.SamplingPolicy.CriticalUsage:i.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.telemetryLogger.sendTelemetryEvent(n)}logSharedTelemetryEvent(e){const t={eventName:"Office.Voice.ActionAI."+e.GetEventName(),eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?i.o.SamplingPolicy.CriticalUsage:i.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.telemetryLogger.sendTelemetryEvent(t)}logSharedErrorEvent(e){const t={eventName:"Office.Voice.ActionAI."+l.S2.Error,error:{errorGroup:e.GetLogs().find((e=>e.name===n.IC.ErrorCategory))?.value,tag:0},eventFlags:{dataCategories:e.GetDataCategory(),diagnosticLevel:e.GetDiagnosticLevel(),samplingPolicy:e.IsRequired()?i.o.SamplingPolicy.CriticalUsage:i.o.SamplingPolicy.NotSet},dataFields:e.GetLogs()};this.telemetryLogger.sendTelemetryEvent(t)}sendTelemetryEvent(e){this.telemetryLogger.sendTelemetryEvent(e)}logKeptEvent(e,t=n.q.Unset,a,r){this.telemetryLoggerUtils.logKeptEvent(r||[...this.getDefaultTelemetryData(),...this.convertDataFieldsToTelemetryData(this.getCopilotDataFields(o.TA.FeatureActionType.IsKept))],E.currentEntryPoint??n.Y9.Chat,e,void 0,void 0,a,t)}logSeenEvent(e,t=n.q.Unset,a,r){if(this.seenEvents.has(t))return;const i=e??this.getStandardizedFeatureForSubFeature(t);this.telemetryLoggerUtils.logSeenEvent(r||[...this.getDefaultTelemetryData(),...this.convertDataFieldsToTelemetryData(this.getCopilotDataFields(o.TA.FeatureActionType.IsSeen))],n.Y9.Chat,i,void 0,a??this.getVerbForStandardizedFeature(i),t),this.seenEvents.add(t)}getStandardizedFeatureForSubFeature(e){switch(e){case n.q.AnalyzeData:return n.BJ.AnalyzeData;case n.q.CalculatedColumns:case n.q.CalculatedRows:case n.q.NLToFormula:return n.BJ.FormulaGeneration;case n.q.Commanding:case n.q.OfficeJsCommanding:case n.q.ShowHeaders:case n.q.SmartHelp:return n.BJ.Commanding;case n.q.ConditionalFormatting:case n.q.ConditionalFormattingSuggestion:return(0,C.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?n.BJ.ConditionalFormatting:n.BJ.Commanding;case n.q.DataShaping:return n.BJ.PrepareData;case n.q.HandOff:return n.BJ.Handoff;case n.q.ImportDataFromSearch:return n.BJ.ImportData;case n.q.Search:return n.BJ.Search;case n.q.OfficeScripts:return n.BJ.OfficeScripts;case n.q.Python:return n.BJ.Python;case n.q.InsertTable:return n.BJ.Search;case n.q.SelfHelp:return n.BJ.ChatQnA;case n.q.ImageChat:case n.q.ChatPaneLoad:case n.q.ConvertToTable:case n.q.CopilotChat:case n.q.SampleData:case n.q.ContextInference:return n.BJ.CopilotChat;case n.q.Else:return n.BJ.ExcelChatHelper;case n.q.Answers:return n.BJ.Answers;case n.q.CopyMessage:case n.q.ExternalTriggeredQuery:case n.q.UndoMessage:default:return n.BJ.CopilotChat}}getVerbForStandardizedFeature(e){switch(e){case n.BJ.AnalyzeData:case n.BJ.PrepareData:case n.BJ.Python:case n.BJ.Answers:return u.RX.Analyze;case n.BJ.ChatQnA:case n.BJ.Search:return u.RX.Ask;case n.BJ.FormulaGeneration:case n.BJ.ImportData:return u.RX.Create;case n.BJ.Commanding:case n.BJ.ConditionalFormatting:case n.BJ.OfficeScripts:return u.RX.Command;case n.BJ.CopilotChat:case n.BJ.ExcelChatHelper:case n.BJ.Handoff:default:return}}getDefaultTelemetryData(){const e=[{key:l.Wg.UserQueryGuid,value:E.userQueryGuid},{key:l.Wg.ClientVersion,value:"9.58.16"},{key:l.Wg.GroundingMode,value:(0,n.Q6)()},{key:l.Wg.IsDevBuild,value:!1},{key:l.Wg.UiLanguage,value:(0,s.Yd)()}];return void 0!==E.querySource&&e.push({key:l.Wg.QuerySource,value:E.querySource}),(0,C.yw9)("OfficeVSO_10534295_LogCopilotExperience")&&(0,C.UW0)()&&e.push({key:l.Wg.CopilotExperience,value:(0,x.dL)()?.PrimaryUserAccountInfo?.CopilotExperience??"AppChat"}),e}getCopilotDataFields(e,t,a,n){const r=e===o.TA.FeatureActionType.IsTried||e===o.TA.FeatureActionType.IsKept||e===o.TA.FeatureActionType.IsRejected||void 0!==t,i=e===o.TA.FeatureActionType.IsTried||e===o.TA.FeatureActionType.IsKept||e===o.TA.FeatureActionType.IsRejected||void 0!==t;return[...o.TA.getFields({interactionId:r?a??E.userQueryGuid:"",conversationId:i?n??E.conversationId:""})]}convertDataFieldsToTelemetryData(e){return e.map((e=>({key:e.name,value:e.value})))}logTelemetryForSharedChatPaneLoad(){if(p.copilotPaneStartTimestamp){const e={[n.CT.SDXResourcesLoadTime]:(0,T.W)(b.excelTaskPaneStartTime),[n.CT.FeatureName]:n.BJ.ChatPaneLoad};(0,b.getPreloadCopilot)()?(0,C.wQA)()||b.copilotPaneStartTimestampAfterPreload&&(e[n.CT.UserCopilotPaneLoadTime]=(0,T.W)(b.copilotPaneStartTimestampAfterPreload)):e[n.CT.UserCopilotPaneLoadTime]=(0,T.W)(p.copilotPaneStartTimestamp),h.E.getInstance().updateTelemetryLatencyData(e,this.telemetryLogger)}else h.E.getInstance().updateTelemetryLatencyData({[n.CT.SDXResourcesLoadTime]:(0,T.W)(b.excelTaskPaneStartTime),[n.CT.FeatureName]:n.BJ.ChatPaneLoad},this.telemetryLogger);h.E.getInstance().updateTelemetryChatEventData({[n.h3.ChatEventType]:n.a5.TaskPaneStart,[n.h3.ChatEventParameters]:b.excelTaskPaneStartTime},this.telemetryLogger),h.E.getInstance().updateTelemetryChatEventData({[n.h3.ChatEventType]:n.a5.AppLoadStart,[n.h3.ChatEventParameters]:p.appLoadStartTime},this.telemetryLogger),p.officeOnReadyTime&&h.E.getInstance().updateTelemetryChatEventData({[n.h3.ChatEventType]:n.a5.OfficeJSReady,[n.h3.ChatEventParameters]:p.officeOnReadyTime.toString()},this.telemetryLogger),h.E.getInstance().updateTelemetryChatEventData({[n.h3.ChatEventType]:n.a5.CopilotEnabledAfterAutoSave,[n.h3.ChatEventParameters]:(0,S.Y)()},this.telemetryLogger),h.E.getInstance().updateTelemetryChatEventData({[n.h3.ChatEventType]:n.a5.ShowDisabledScreen,[n.h3.ChatEventParameters]:(0,S.iN)()},this.telemetryLogger);const e=(0,b.getPreloadCopilot)();e&&h.E.getInstance().updateTelemetryChatEventData({[n.h3.ChatEventType]:n.a5.PreloadCopilot,[n.h3.ChatEventParameters]:e.toString()},this.telemetryLogger);const t=JSON.stringify({isDeclarativeAgentsEnabled:(0,C.Pz_)(),shouldUseMsalGetTokenRequestCaching:(0,C.xZX)(),enableSwitcherMenuV2:(0,C.o25)(),loadGptListOnCopilotIconClick:(0,C.AFi)(),enableAgentsBasedOnSkill:(0,C.VDk)()});(0,f.cY)(`Sending extensibility config telemetry for chat pane load ${t}`),this.sendChatEventTelemetry((0,n.pN)({[n.h3.ChatEventType]:n.a5.ExtensibilityConfig,[n.h3.ChatEventParameters]:t})),this.recordCheckPoint(n._R.ChatPaneLoaded)}recordCheckPoint(e,t){t&&0!==t&&!Number.isNaN(t)||(t=(new Date).getTime()),0===this.checkPointStartTime?(this.checkPointStartTime=t,this.checkPoints[e]=0):this.checkPoints[e]=t-this.checkPointStartTime}sendLatencyTelemetryForCheckPoints(e){const t=JSON.stringify(this.checkPoints);(0,f.cY)("sendLatencyTelemetryForCheckPoints: ",t),this.sendLatencyTelemetry((0,n.pN)({[n.CT.CheckPoints]:t}),e)}setInitialHandoffQuery(e){(0,f.cY)("setInitialHandoffQuery: ",e),this.initialHandoffQuery=e}sendHandoffQuerySubmittedEvent(e){if(!this.initialHandoffQuery)return;e=e.trim();const t=this.initialHandoffQuery.trim(),a=!(e===t||e.includes(t));(0,f.cY)("Handoff query is submitted. IsModified: "+a),E.getInstance().sendChatEventTelemetry([{key:n.h3.ChatEventType,value:n.a5.HandoffQuerySubmittedByUser},{key:n.h3.ChatEventParameters,value:`${n.CD.IsModified}:${a}`}]),this.initialHandoffQuery=void 0}constructor(){super(),this.chatHistoryLog=[],this.seenEvents=new Set,this.logUserCopilotPaneLoadTelemetry=(e,t=n.CT.ExcelUserCopilotPaneLoadTime,a=n.BJ.Preload_ChatPaneLoad)=>{const o=parseFloat((0,f.gZ)(e));h.E.getInstance().updateTelemetryLatencyData({[t]:(0,T.W)(o),[n.CT.FeatureName]:a},this.telemetryLogger),this.recordCheckPoint(n._R.CopilotPaneStart,o)},this.sendVisibilityModeChangedTelemetry=e=>{E.getInstance().sendChatEventTelemetry((0,n.pN)({[n.h3.ChatEventType]:n.a5.TaskPaneVisibilityModeChanged,[n.h3.ChatEventParameters]:e}))},this.telemetryLogger=g.M.getInstance(),this.telemetryLoggerUtils=m.TelemetryLoggerUtils.getInstance(),this.telemetryLoggerUtils.setTelemetryHandler(E.instance),this.telemetryChatEventObject={},this.telemetryLatencyObject={},this.checkPoints={},this.checkPointStartTime=0,this.initializeCheckPoint(),this.setCopilotPaneStartPerfMark()}}E.querySource=void 0,E.nextQuerySource=void 0,E.currentEntryPoint=void 0,E.conversationId=void 0,E.userQueryGuid=""},699302:(e,t,a)=>{"use strict";a.d(t,{JU:()=>O,GU:()=>F,wF:()=>A,fp:()=>R,LS:()=>D,ke:()=>$,bl:()=>B,xX:()=>M,Dz:()=>N,oO:()=>S,mo:()=>H,gp:()=>L,yt:()=>k});var n=a(632512),o=a(397646),r=a(99394),i=a(267324),l=a(207545),s=a(56254),c=a(707314),d=a(9847),u=a(956258),m=a(173339),h=a(528804),g=a(507628);function p(e,t){e.onerror=()=>{t(new n.u(n.O.NetworkError))},e.timeout=m.R.getAnalyzeDataNetworkTimeout(),e.ontimeout=()=>{t(new n.u(n.O.NetworkTimeout))}}function b(e,t){(0,h.yw9)("OfficeVSO_10685812_InsightsCORSRequest")&&(e.withCredentials=!0),t&&Object.keys(t).forEach((a=>{e.setRequestHeader(a,t[a])}))}function f(e,t,a){const n=(0,g.A)().replace(/-/g,"").slice(0,16);let o;o=t?.[i.Vno]?t[i.Vno]:(0,g.A)(),o=o.replace(/-/g,"");const r=`00-${o}-${n}-01`;e.setRequestHeader("traceparent",r),a.push({key:d.W0.TraceId,value:o}),a.push({key:d.W0.SpanId,value:n})}var C=a(303943),y=a(558976),v=a(820633),x=a(880496),T=a(991869);function S(e,t,a){const n={"Accept-Language":(0,T.gl)(),Flights:(0,h.lCC)(),DeferredFlights:(0,v.RJ)(),SessionId:(0,v.u0)()};return e&&(n.Authorization=`Bearer ${e}`),t&&(n["New-Authorization"]=t),a&&(n[i.Vno]=a),n}const w=1e4;function E(){return w}function I(e){return 400===e?new n.u(n.O.BadRequest):401===e?new n.u(n.O.Unauthorized):403===e?new n.u(n.O.Forbidden):406===e?new n.u(n.O.NotAcceptable):404===e?new n.u(n.O.NotFound):410===e?new n.u(n.O.Gone):429===e?new n.u(n.O.NetworkThrottleError):500===e?new n.u(n.O.InternalServerError):new Error}function R(){return"F940464D-7313-4BF9-B3F4-60A4E3DC50B7"}function A(){switch((0,h.xyg)("InsightsEndpointOverride")){case"dev":return i.WlT;case"dev2":return i.imX;case"ppe":return i.gu1;case"prod":return i.mDj}const e=r.V.getSettingAsString(r.z.InsightsEndpoint);return"Insights.Https.GCC.Bundle"===e?i.W32:"Insights.Https.DOD.Bundle"===e?i.u7V:"Insights.Https.GCCH.Bundle"===e?i.w_Q:(0,l.I_)()||(0,l.B2)()?i.gu1:i.mDj}async function L(e,t,a,o,r){const{address:i,rowCount:l,columnCount:s}=t,c={contentLanguageHint:e.contentLanguageHint,topLeftCellAddress:(0,x.D$)(i),sheetName:a,tableName:o,dataSize:{width:s,height:l},data:await(0,C.yu)(e)};return V((e=>function(e,t,a){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=[],s=[{key:d.W0.NumRows,value:e.data.valueRows.length},{key:d.W0.NumColumns,value:e.data.valueRows[0].length},{key:d.W0.Height,value:e.dataSize.height},{key:d.W0.Width,value:e.dataSize.width}];let c=0;const m=new URLSearchParams;m.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const h=`${A()}/v3.0/ranges/initialize?${m.toString()}`;i.open("POST",h,!0),i.setRequestHeader("Content-Type","application/json"),f(i,t,s),b(i,t),p(i,r),i.onreadystatechange=()=>{if(4===i.readyState){if(l.push({key:d.W0.ServiceTime,value:performance.now()-c}),0===i.status);else if(201===i.status){const e=i.getResponseHeader("Range-Id"),t=i.getResponseHeader("Location"),a=i.getResponseHeader("Auth-Token");s.push({key:d.W0.RangeId,value:e}),l.push({key:d.W0.RangeId,value:e}),o({...JSON.parse(i.responseText),rangeId:e,location:t,authToken:a})}else r(I(i.status));u.M.getInstance().logInsightsApiCall("POST","initialize",i.status,a,s),u.M.getInstance().logRangeDataPerformance(l)}};try{const t=e.data.valueRows.length*e.data.valueRows[0].length,a=performance.now(),n=JSON.stringify(e);if(l.push({key:d.W0.SerializationTime,value:performance.now()-a}),t>E()){const e=performance.now(),t=(0,y.Kc)(n,{level:1});l.push({key:d.W0.CompressionMethod,value:"deflate"},{key:d.W0.CompressionTime,value:performance.now()-e},{key:d.W0.RequestSize,value:t.length}),c=performance.now(),i.setRequestHeader("Content-Encoding","deflate"),i.send(t)}else l.push({key:d.W0.CompressionMethod,value:"none"},{key:d.W0.RequestSize,value:n.length}),c=performance.now(),i.send(n)}catch(e){r(new n.u(n.O.InitializeRangesFailure,e))}}))}(c,r,e)))}async function k(e,t,a,o){const r={rowOffset:a,data:await(0,C.yu)(t)};return V((t=>function(e,t,a,o){return new Promise(((r,i)=>{const l=new XMLHttpRequest,s=[],c=[{key:d.W0.NumRows,value:t.data.valueRows.length},{key:d.W0.NumColumns,value:t.data.valueRows[0].length},{key:d.W0.RowOffset,value:t.rowOffset}];let m=0;const h=new URLSearchParams;h.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const g=`${A()}${e}/data?${h.toString()}`;l.open("POST",g,!0),l.setRequestHeader("Content-Type","application/json"),f(l,a,c),b(l,a),p(l,i),l.onreadystatechange=()=>{4===l.readyState&&(s.push({key:d.W0.ServiceTime,value:performance.now()-m}),0===l.status||(200===l.status?r(JSON.parse(l.responseText)):i(I(l.status))),u.M.getInstance().logInsightsApiCall("POST","data",l.status,o,c),u.M.getInstance().logRangeDataPerformance(s))};try{const e=t.data.valueRows.length*t.data.valueRows[0].length,a=performance.now(),n=JSON.stringify(t);if(s.push({key:d.W0.SerializationTime,value:performance.now()-a}),e>E()){const e=performance.now(),t=(0,y.Kc)(n,{level:1});s.push({key:d.W0.CompressionMethod,value:"deflate"},{key:d.W0.CompressionTime,value:performance.now()-e},{key:d.W0.RequestSize,value:t.length}),m=performance.now(),l.setRequestHeader("Content-Encoding","deflate"),l.send(t)}else s.push({key:d.W0.CompressionMethod,value:"none"},{key:d.W0.RequestSize,value:n.length}),m=performance.now(),l.send(n)}catch(e){i(new n.u(n.O.StoreDataFailure,e))}}))}(e,r,o,t)))}async function F(e,t,a){return V((n=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const s=`${A()}${e}/generateResults?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),b(i,a),p(i,r);const c=[];f(i,a,c),i.onreadystatechange=()=>{if(4===i.readyState){if(0===i.status);else if(202===i.status){const e=i.getResponseHeader("Operation-Id"),t=i.getResponseHeader("Operation-Location");o({operationId:e,operationLocation:t}),c.push({key:d.W0.OperationId,value:e})}else r(I(i.status));u.M.getInstance().logInsightsApiCall("POST","generateResultsForRange",i.status,n,c)}},i.send(JSON.stringify(t))}))}(e,t,a,n)))}async function _(e,t,a,n){const r=await V((a=>async function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const l=`${A()}${e}?${i.toString()}`;r.open("GET",l,!0),b(r,t),p(r,o);const s=[];f(r,t,s),r.onreadystatechange=()=>{if(4===r.readyState){if(0===r.status);else if(200===r.status){const e=JSON.parse(r.responseText);s.push({key:d.W0.OperationStatus,value:e.status}),n(e)}else o(I(r.status));u.M.getInstance().logInsightsApiCall("GET","operation",r.status,a,s)}},r.send()}))}(e,t,a)));return await async function(e,t,a){const n={...e.resourceLocations};e.links[s.J.NLEvaluationResult]&&(n.nlEvaluationResult=e.links[s.J.NLEvaluationResult].href);const r=await async function(e,t,a){if(t&&a&&e&&e.length>0){const n=new o.y(a.sheetId),r=Promise.all(e.map((e=>(0,C.sy)(n.getTranslations(a.rowIndex,a.columnIndex),e,t,!1))));return await n.resolveJobs(),await r}return}(e.statusDetails?.nlEvaluationState?.intermediateResults,t,a),i=e.statusDetails?{...e.statusDetails,nlEvaluationState:e.statusDetails.nlEvaluationState?{...e.statusDetails.nlEvaluationState,intermediateResults:r}:void 0}:void 0,l={...e,statusDetails:i,resourceLocations:n};return l}(r,a,n)}async function P(e,t){await V((a=>async function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const l=`${A()}${e}?${i.toString()}`;r.open("DELETE",l,!0),b(r,t),p(r,o);const s=[];f(r,t,s),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?n():o(I(r.status))),u.M.getInstance().logInsightsApiCall("DELETE","operation",r.status,a,s))},r.send()}))}(e,t,a)))}async function N(e,t,a,n,r){const i=await V((t=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7"),a&&(l.set("chartWidth",a.chartWidth.toString()),l.set("chartHeight",a.chartHeight.toString()));const s=`${A()}${e}?${l.toString()}`;i.open("GET",s,!0),b(i,t),p(i,r);const c=[];f(i,t,c),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(200===i.status?o(JSON.parse(i.responseText)):r(I(i.status))),u.M.getInstance().logInsightsApiCall("GET","recommendations",i.status,n,c))},i.send()}))}(e,a,n,t))),l=[],s=new o.y(t.sheetId),c=s.getTranslations(t.rowIndex,t.columnIndex);i.recommendations&&l.push(...i.recommendations);const d=Promise.all(l.map((e=>{const t=i.interpretations.find((({id:t})=>t===e.interpretationId));return(0,C.gT)(c,e,t,r??!1)}))),m=Promise.all(i.interpretations.map((e=>(0,C.r9)(c,e))));await s.resolveJobs();const[h,g]=await Promise.all([m,d]);return{interpretations:h,recommendations:g}}async function M(e,t,a,n,r){let i=await V((a=>G(e,t,r,a)),q);(function(e){if(e.responseType!==c.WZ.Answered||!e.visualAnswer||!e.visualAnswer.visual)return!1;if(!(0,s.tz)(e.visualAnswer))return!1;const t=e.visualAnswer.visual.pivotTable,a=!!t.labelFilters&&t.labelFilters.length>0,n=!!t.valueFilters&&t.valueFilters.some((e=>"between"===e.filterType||"notBetween"===e.filterType)),o=Office.context.requirements.isSetSupported.bind(Office.context.requirements);if(t.dateFilters&&t.dateFilters.length>0){if(!o("ExcelApi","1.12")&&!o("PivotFilters","1.2"))return!0;if(!!t.dateFilters&&t.dateFilters.some((e=>!!e.wholeDays))&&!o("PivotTableNativeGrouping","1.1")&&!o("ExcelApi","1.14"))return!0}if((a||n)&&!o("ExcelApi","1.12")&&!o("PivotFilters","1.1"))return!0;const r=e=>!!e.datePartOverride,i=t.rowFields?.some(r)??!1,l=t.columnFields?.some(r)??!1;if((i||l)&&!o("PivotTableNativeGrouping","1.1"))return!0;return!1})(i)&&(t.forceStaticAnswer=!0,i=await V((a=>G(e,t,r,a)),q));const l=new o.y(n.sheetId),d=(0,C.sy)(l.getTranslations(n.rowIndex,n.columnIndex),i,a,!!t.forceStaticAnswer);return await l.resolveJobs(),await d}async function O(e,t,a){return V((n=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest;(new URLSearchParams).set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7"),i.open("POST",e,!0),i.setRequestHeader("Content-Type","application/json"),b(i,a),p(i,r);const l=[];f(i,a,l);const s=e.split("/"),c=s[3],m=s[5];l.push({key:d.W0.RangeId,value:c}),l.push({key:d.W0.NLContextId,value:m}),l.push({key:d.W0.AllowRewrite,value:t.allowRewrite??!1}),i.onreadystatechange=()=>{if(4===i.readyState){if(0===i.status);else if(202===i.status){const e=i.getResponseHeader("Operation-Id"),t=i.getResponseHeader("Operation-Location");o({operationId:e,operationLocation:t}),l.push({key:d.W0.OperationId,value:e})}else r(I(i.status));u.M.getInstance().logInsightsApiCall("POST","generateResultForNaturalLanguage",i.status,n,l)}},i.send(JSON.stringify(t))}))}(e,t,a,n)))}async function D(e,t,a,n,r){const i=await V((t=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest;(new URLSearchParams).set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7"),r.open("GET",e,!0),b(r,t),p(r,o);const i=[];f(r,t,i),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?n(JSON.parse(r.responseText)):o(I(r.status))),u.M.getInstance().logInsightsApiCall("GET","getResultForNaturalLanguage",r.status,a,i))},r.send()}))}(e,r,t)),q),l=new o.y(a.sheetId),s=(0,C.sy)(l.getTranslations(a.rowIndex,a.columnIndex),i,t,!!n);return await l.resolveJobs(),await s}async function B(e,t,a){const n=await V((n=>function(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const s=`${A()}${e}?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),b(i,a),p(i,r);const c=[];f(i,a,c),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(201===i.status?o(JSON.parse(i.responseText)):r(I(i.status))),u.M.getInstance().logInsightsApiCall("POST","naturalLanguageContext",i.status,n,c))},i.send(JSON.stringify(t))}))}(e,t,a,n)),q);return{id:n.id,evaluateQueryLocation:n.evaluateQueryLocation,generateResultForNLEvaluationLocation:n.links[s.J.GenerateResultForNLEvaluation]?.href,language:n.language,suggestedQueries:n.suggestedQueries}}async function $(e,t,a){const n=await V((t=>function(e,t,a){return new Promise(((n,o)=>{const r=new XMLHttpRequest,i=new URLSearchParams;i.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const l=`${A()}${e}?${i.toString()}`;r.open("GET",l,!0),b(r,t),p(r,o);const s=[];f(r,t,s),r.onreadystatechange=()=>{4===r.readyState&&(0===r.status||(200===r.status?n(JSON.parse(r.responseText)):o(I(r.status))),u.M.getInstance().logInsightsApiCall("GET","interpretations",r.status,a,s))},r.send()}))}(e,a,t))),r=new o.y(t.sheetId),i=r.getTranslations(t.rowIndex,t.columnIndex),l=Promise.all(n.interpretations.map((e=>(0,C.r9)(i,e))));return await r.resolveJobs(),{interpretations:await l}}function H(e,t,a,n,o,r,i=()=>!1){return function(e,t,a,n,o,r,i){const l=[],s={};function d(e){Object.keys(e||{}).forEach((a=>{const n=t[a],o=e[a];!s[a]&&n&&(l.push(n(o)),s[a]=!0)}))}async function u(e){if(!n||!e)return Promise.resolve({shouldDeleteOperation:!1});const t=Object.keys(e||{}).map((t=>{const a=n[t],o=e[t];return a?a(o):Promise.resolve({shouldDeleteOperation:!1})})),a=(await Promise.all(t)).some((e=>e.shouldDeleteOperation));return Promise.resolve({shouldDeleteOperation:a})}async function m(){const t=await _(e,o,r,i);if(a())return await P(e,o),[];const{resourceLocations:n,retryAfterMs:s,status:g}=t,p=s||2e3,b=new Promise((e=>{setTimeout(e,p)}));switch(g){case c.Uh.NotStarted:return await b,a()?(await P(e,o),[]):m();case c.Uh.Running:{d(n);const{shouldDeleteOperation:r}=await u(t.statusDetails);return(0,h.yw9)("OfficeVSO_10449020_LoopFallBack")&&r||a()?(await P(e,o),[]):(await b,a()?(await P(e,o),[]):m())}case c.Uh.Succeeded:return d(n),await u(t.statusDetails),a()?(await P(e,o),[]):Promise.all(l);default:return Promise.reject(new Error("Unexpected operation result."))}}return m()}(e,t,i,a,n,o,r)}const U=4,q=2;function V(e,t=U){let a=0;const o=async()=>{try{return await e(a)}catch(e){return(e.errorCode===n.O.NetworkError||e.errorCode===n.O.NetworkTimeout)&&a<t?(a++,await new Promise((e=>{window.setTimeout(e,1===a?0:200)})),o()):Promise.reject(e)}};return o()}function G(e,t,a,n){return new Promise(((o,r)=>{const i=new XMLHttpRequest,l=new URLSearchParams;l.set("clientId","F940464D-7313-4BF9-B3F4-60A4E3DC50B7");const s=`${A()}${e}?${l.toString()}`;i.open("POST",s,!0),i.setRequestHeader("Content-Type","application/json"),b(i,a),p(i,r);const c=[];f(i,a,c);const m=e.split("/"),h=m[3],g=m[5];c.push({key:d.W0.RangeId,value:h}),c.push({key:d.W0.NLContextId,value:g}),c.push({key:d.W0.AllowRewrite,value:t.allowRewrite??!1}),i.onreadystatechange=()=>{4===i.readyState&&(0===i.status||(200===i.status?o(JSON.parse(i.responseText)):r(I(i.status))),u.M.getInstance().logInsightsApiCall("POST","naturalLanguageResult",i.status,n,c))},i.send(JSON.stringify(t))}))}},702864:(e,t,a)=>{"use strict";var n;a.d(t,{aB:()=>n,xP:()=>o}),function(e){e[e.Idle=0]="Idle",e[e.ScopeStarted=1]="ScopeStarted",e[e.HasAction=2]="HasAction",e[e.ShowButton=3]="ShowButton"}(n||(n={}));var o=function(){function e(){this.addinUndoState=n.Idle,this.isAddinFlowActive=!1}return e.getInstance=function(){return e.instance||(e.instance=new e),e.instance},e.prototype.getCurrentAddinState=function(){return this.addinUndoState},e.prototype.isAddinFlow=function(){return this.isAddinFlowActive},e.prototype.setIsAddinFlow=function(e,t){this.isAddinFlowActive=e,null==t||t()},e.prototype.transitionAddinState=function(e,t){this.addinUndoState!==e&&(this.addinUndoState=e,null==t||t())},e.prototype.checkAndSetIsUndoableActionPresent=function(){this.getCurrentAddinState()===n.ScopeStarted&&this.transitionAddinState(n.HasAction)},e}().getInstance()},703227:(e,t,a)=>{"use strict";a.d(t,{G2:()=>p,Jm:()=>g,K7:()=>c,R1:()=>s,Sy:()=>u,_f:()=>m,m:()=>h,vs:()=>d,zC:()=>b});var n=a(471742),o=a(14086),r=a(413848),i=a(906606),l=a(299512);function s(e,t,a){return e((0,i.Vy)(t,a))?.tabularRange}function c(e){const t=e.interpretation.location,{left:a,top:n,right:o,bottom:r,worksheetId:i}={left:t.left-1,top:t.top-1,right:t.right-1,bottom:t.bottom-1,worksheetId:t.worksheetId};return{left:a,top:n,right:o,bottom:r,worksheetId:i}}function d(e,t,a){let n;return n="rowMajor"===a?e.getRangeByIndexes(t.top,t.left,t.bottom-t.top+1,1):e.getRangeByIndexes(t.top,t.left,1,t.right-t.left+1),n}function u(e,t,a){return(0,l.TP)(t,a)?[]:"rowMajor"===t?e.values.map((e=>e[0])):e.values[0]}function m(e,t){return e.getRangeByIndexes(t.top+1,t.left,1,t.right-t.left+1)}async function h(e,t,a,n){const o=function(e,t){return e.getRangeByIndexes(t.top+1,t.left,t.bottom-t.top,t.right-t.left+1)}(t,a);o.track(),o.load("rowCount"),await e.sync();const i=await(0,r.dr)(e,o,n);return o.untrack(),i}function g(e,t){return`${e}!${(0,n.XK)({top:t.top,left:t.left,right:t.right,bottom:t.bottom})}`}function p(e){return(0,o.r)(e)}function b(e){const t=e.lastIndexOf("!");return-1===t?"":e.substring(0,t)}},707314:(e,t,a)=>{"use strict";var n,o,r,i,l,s,c,d;function u(e){return"ChartVisual"===e||"PivotChartVisual"===e||"QueryChartVisual"===e||"ForecastVisual"===e}function m(e){return e&&u(e.visualType)}function h(e){return"inDynamicPeriod"===e.filterType}function g(e){return["equal","notEqual","after","afterOrEqual","before","beforeOrEqual"].some((t=>t===e.filterType))}function p(e){return["between","notBetween"].some((t=>t===e.filterType))}function b(e,t){return t.every((t=>void 0!==e[t]))}a.d(t,{J2:()=>m,M$:()=>l,S$:()=>g,T6:()=>n,Uh:()=>o,VZ:()=>u,WZ:()=>r,kp:()=>p,o_:()=>b,rb:()=>d,uK:()=>c,vr:()=>h}),function(e){e.ChartTypeNotSupported="chartTypeNotSupported",e.ChartTypeNotAppropriate="chartTypeNotAppropriate"}(n||(n={})),function(e){e.NotStarted="notStarted",e.Running="running",e.Succeeded="succeeded",e.Failed="failed",e.Cancelling="cancelling",e.Cancelled="cancelled"}(o||(o={})),function(e){e.NotUnderstood="notUnderstood",e.Error="error",e.Answered="answered",e.Conversation="conversation"}(r||(r={})),function(e){e.None="none",e.Entities="entities",e.PotentialBias="potentialBias"}(i||(i={})),function(e){e.UnanswerableQuery="UnanswerableQuery",e.AskForClarification="AskForClarification",e.InvalidJsonFormat="InvalidJsonFormat",e.InvalidResponseType="InvalidResponseType",e.InvalidAE="InvalidAE",e.MismatchedColumnName="MismatchedColumnName",e.UnsupportedExecution="UnsupportedExecution",e.LLMThrottledError="LLMThrottledError",e.LLMHttpRequestError="LLMHttpRequestError",e.LLMTimeout="LLMTimeout",e.LLMGenericError="LLMGenericError",e.SymbolicLogicException="SymbolicLogicException",e.VisualConversionError="VisualConversionError",e.MissingFunctionality="MissingFunctionality",e.ContentTooLarge="ContentTooLarge",e.UnsupportedLanguage="UnsupportedLanguage",e.UnsupportedTextAnalysisType="UnsupportedTextAnalysisType",e.TextAnalysisUnexpectedLLMResult="TextAnalysisUnexpectedLLMResult",e.BlockedByRAI="BlockedByRAI"}(l||(l={})),function(e){e.OLAP="olap",e.Insights="insights",e.TextAnalysis="textAnalysis",e.Forecasting="forecasting",e.Visualization="visualization"}(s||(s={})),function(e){e.Summary="summary",e.Clustering="clustering",e.Topic="topic",e.KeyPhrase="keyPhrase",e.Sentiment="sentiment",e.General="general",e.Tagging="tagging"}(c||(c={})),function(e){e.QuickSummary="quickSummary",e.FullThemeSummary="fullThemeSummary",e.Others="others"}(d||(d={}))},715540:(e,t,a)=>{"use strict";a.d(t,{b:()=>p});var n=a(893763);var o=a(136609);class r{create(e,t){return!this.store[e]&&(this.store[e]=t,!0)}read(e){if(void 0!==this.store[e])return this.store[e];throw new Error("No such item: "+JSON.stringify(e))}update(e,t){const a=!!this.store[e];return this.store[e]=t,a}delete(e){const t=!!this.store[e];return delete this.store[e],t}keys(){const e=[];for(const t in this.store)e.push(t);return e}constructor(){this.store={}}}var i=a(353033),l=a(237600),s=a(724138),c=a(530495),d=a(274793);const u=["RichApiRuntimeFlag","ExcelApi","ExcelApiOnline","ExcelApiUndo"];function m(){if(Office?.context)return Office.context.platform}class h{async getRuntime(e,t,a){const n=(0,c.Ml)(e),o=!1;let r=this.getPreload(n,o);try{r||(r=new i.U((()=>this.createRuntime(n,o,t,a))));return await r.getPromise()}catch(e){throw e}finally{this.removePreload(n,o)}}getSupportedSetMap(){if(this.apiSetMap)return this.apiSetMap;const e={};return u.forEach((t=>{let a=0;for(;a<99;){if(!Office.context.requirements.isSetSupported(t,`1.${a}`)){a--;break}a++}a>=0&&(e[t]=`1.${a}`)})),this.apiSetMap=e,e}async loadCodeForRuntime(e,t,a){const n=a??await(0,d.Q)(),o=t.codeOverride||n;await e.loadCode(o);const r=this.getSupportedSetMap(),i=(0,l.tI)(r);return await e.loadCode(i),e}async createRuntime(e={variant:"synchronous",variantVersion:2},t,a,n){const o=await(0,c.Tq)(e),r=o.officeJsOverride||function(){const e=m()===Office.PlatformType.PC?"excel-win32-16.01.js":m()===Office.PlatformType.Mac?"excel-mac-16.00.js":"excel-web-16.00.js",t=(0,s.Tp)(window.location.href);return t?`${t}/lib/beta/hosted/${e}`:"https://appsforoffice.microsoft.com/lib/beta/hosted/"+e}(),i={allowExternalCalls:t,runtimeConsole:{log:()=>{},warn:()=>{},error:()=>{},info:()=>{}},batchHandlerFunction:n,batchSafetyFlag:l.hl.OnlyAllowMakerSafeApi};return l.zI.createRuntimeInstance(i).then((async e=>(await e.loadUrl(r),this.loadCodeForRuntime(e,o,a))))}getPreload(e,t){const a=JSON.stringify([e,t]);if(!(this.preloads.keys().indexOf(a)<0))return this.preloads.read(a)}constructor(){this.preloadRuntime=async(e,t)=>{const a=(0,c.Ml)(e)||{variant:"synchronous",variantVersion:2},n=!1;if(void 0===this.getPreload(a,n)){const e=new i.U((()=>this.createRuntime(a,n,t))),o=e.getPromise();this.pushPreload(a,n,e);try{await o}catch(e){this.removePreload(a,n)}}},this.pushPreload=(e,t,a)=>{const n=JSON.stringify([e,t]);this.preloads.create(n,a)},this.removePreload=(e,t)=>{const a=JSON.stringify([e,t]);this.preloads.delete(a)},this.preloads=new r}}var g=a(439720);class p{async terminateCurrentRun(e){this.runtime&&(this.runtime.terminate(),this.ensurePreload(e))}getPrepareScriptError(e){let t="Error occurred while loading runtime.";return!!e.isCompileError&&(t="Error occurred during code compilation."),new n.WD(t)}constructor(){this.acquireMutexToken=()=>{const e=this.mutex.tryAcquire();return void 0!==e&&(this.mutexToken=e,!0)},this.releaseMutexToken=()=>{try{this.mutexToken.release(),this.mutexToken=void 0,this.resolveMutexReleasePromise()}catch(e){}},this.ensureScriptBody=e=>{const t=e.localUpdates.body;return!(null==t)},this.ensurePreload=e=>{this.runtimeTracker.preloadRuntime(e)},this.prepareCustomParams=async(e,t,a,n)=>this.prepare(e,n,t,a),this.prepareScript=async e=>{const t=e.localUpdates.body,a=await(0,c.uS)(e),n=await(0,g.V)(t,e,a);return this.prepare(n,e)},this.executeScript=async(e,t)=>{try{const a=await this.runtime.executeFunction("main",t??[],"Excel",(function(e,t,a){a("external API not supported")}));return await this.terminateCurrentRun(e),a}catch(t){await this.terminateCurrentRun(e);const a=new n.WD("Office Script execution failed.");throw t.data?.message?.error?.code&&(a.errorCode=t.data.message.error.code),a}},this.prepare=async(e,t,a,n)=>{try{this.runtime=await this.runtimeTracker.getRuntime(t,a,n),await this.runtime.loadCode("OfficeExtension._internalConfig.appendTypeNameToObjectPathInfo = true;\n        "),await this.runtime.loadCode(e)}catch(e){const a=this.getPrepareScriptError(e);throw await this.terminateCurrentRun(t),a}},this.resolveMutexReleasePromise=()=>{this.mutexPromiseResolveFn&&this.mutexPromiseResolveFn()},this.mutex=new o.e,this.runtimeTracker=new h}}p.instance=()=>(p._instance||(p._instance=new p),p._instance)},722307:(e,t,a)=>{"use strict";a.d(t,{ET:()=>u,H5:()=>c,Yd:()=>s,iJ:()=>l,vI:()=>d});var n=a(472096),o=a(702864),r=a(737617),i=a(507628);class l extends n.Gt{static async performUndo(){await Excel.run((async e=>{e.application.undo(),await e.sync()}))}static async startUndoScope(){await Excel.run((async e=>{e.application.undoScope.open((0,i.A)()),await e.sync()})),o.xP.transitionAddinState(o.aB.ScopeStarted)}static async endUndoScope(){await Excel.run((async e=>{e.application.undoScope.close(),await e.sync()}))}}function s(){return Office.context.displayLanguage}function c(){return new Promise((function(e){Office.context.document.getFilePropertiesAsync((function(t){e(t.value?.url)}))}))}function d(){return Office.context.diagnostics.platform}function u(){switch(Office.context.diagnostics.platform){case Office.PlatformType.PC:return r.mp.Win32;case Office.PlatformType.Mac:return r.mp.MacOS;case Office.PlatformType.iOS:return r.mp.iPad;case Office.PlatformType.OfficeOnline:return r.mp.Web;default:return r.mp.Unknown}}},731137:e=>{"use strict";e.exports=JSON.parse('{"Intents":{"AllowEditRangeAddedLabel":"Add unlocked range ${range}","_AllowEditRangeAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by the name of the range","AllowEditRangeDeletedLabel":"I deleted the unlocked range ${range}","_AllowEditRangeDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by the name of the range","AllowEditRangeEditedLabel":"I edited the unlocked range ${range}","_AllowEditRangeEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by the name of the range","ArtPasteSameWorkbookLabel":"Paste art on sheet ${sheet}","_ArtPasteSameWorkbookLabel.comment":"Text to show in a list when a paste art on same workbook user action was taken during script recording","CellFindContainingLabel":"Find cell containing \'${search}\'","_CellFindContainingLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.","ChartFormatSetGetPropertiesLabel":"${count} format changes were applied to ${chartName}.","_ChartFormatSetGetPropertiesLabel.comment":"The intent shown when two or more chart formats were changed in a batch request.","ChartSeriesDeleteLabel":"I deleted the series ${seriesIndex} from chart ${chartName} on sheet ${sheet}","_ChartSeriesDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartSeriesDataChangedLabel":"I changed the data of series ${seriesIndex} of chart ${chartName}","ChartSeriesDataChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentDeleteLabel":"I deleted the comment","_CommentDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentDeleteReplyLabel":"I deleted the reply","_CommentDeleteReplyLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentEditLabel":"I edited the comment","_CommentEditLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentEditReplyLabel":"I edited the reply","_CommentEditReplyLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentInsertLabel":"I inserted a comment","_CommentInsertLabel.comment":"User-facing string describing the Excel event executed by Copilot.","CommentInsertReplyLabel":"I inserted a reply","_CommentInsertReplyLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${range} where ${cellValueCriteria}.","_ConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} where ${cellValueCriteria}.","_TableRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} body where ${cellValueCriteria}.","_TableBodyRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} header row where ${cellValueCriteria}.","_TableHeaderRowRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${tableName} total row where ${cellValueCriteria}.","_TableTotalRowRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} sub-range of table ${tableName} where ${cellValueCriteria}.","_TableGeneralRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${count} row(s) in table ${tableName} where ${cellValueCriteria}.","_TableRowsRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} row at index ${rowIndex} in table ${tableName} where ${cellValueCriteria}.","TableRowByIndexRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} ${count} column(s) in table ${tableName} where ${cellValueCriteria}.","_TableColumnsRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} column \'${columnName}\' in table ${tableName} where ${cellValueCriteria}.","_TableColumnByNameRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} the column at index ${columnIndex} in table ${tableName} where ${cellValueCriteria}.","_TableColumnByIndexRangeConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingCellValueCreatedLabel":"I ${cellFormat} the column(s) \'${columnName}\' where ${cellValueCriteria}.","_ColumnNameConditionalFormattingCellValueCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${range} with formula ${customFormula}.","_ConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} with formula ${customFormula}.","_TableRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} body with formula ${customFormula}.","_TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} header row with formula ${customFormula}.","_TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${tableName} total row with formula ${customFormula}.","_TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} sub-range of table ${tableName} with formula ${customFormula}.","_TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${count} row(s) in table ${tableName} with formula ${customFormula}.","_TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} row at index ${rowIndex} in table ${tableName} with formula ${customFormula}.","TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} ${count} column(s) in table ${tableName} with formula ${customFormula}.","_TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} column \'${columnName}\' in table ${tableName} with formula ${customFormula}.","_TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} the column at index ${columnIndex} in table ${tableName} with formula ${customFormula}.","_TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingCustomFormulaCreatedLabel":"I ${cellFormat} the column(s) \'${columnName}\' with formula ${customFormula}.","_ColumnNameConditionalFormattingCustomFormulaCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${range} that ${textComparisonCriteria}.","_ConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} that ${textComparisonCriteria}.","_TableRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} body that ${textComparisonCriteria}.","_TableBodyRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} header row that ${textComparisonCriteria}.","_TableHeaderRowRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${tableName} total row that ${textComparisonCriteria}.","_TableTotalRowRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in sub-range of table ${tableName} that ${textComparisonCriteria}.","_TableGeneralRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${count} row(s) in table ${tableName} that ${textComparisonCriteria}.","_TableRowsRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in row at index ${rowIndex} in table ${tableName} that ${textComparisonCriteria}.","TableRowByIndexRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in ${count} column(s) in table ${tableName} that ${textComparisonCriteria}.","_TableColumnsRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in column \'${columnName}\' in table ${tableName} that ${textComparisonCriteria}.","_TableColumnByNameRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in the column at index ${columnIndex} in table ${tableName} that ${textComparisonCriteria}.","_TableColumnByIndexRangeConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnConditionalFormattingTextComparisonCreatedLabel":"I ${cellFormat} text in the column(s) \'${columnName}\' that ${textComparisonCriteria}.","_ColumnConditionalFormattingTextComparisonCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${range}.","_ConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName}.","_TableRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName} body.","_TableBodyRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel":"I created a ${colorScaleFormat} color scale conditional formatting rule on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${range}.","_ConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName}.","_TableRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName} body.","_TableBodyRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingDataBarCustomCreatedLabel":"I created a data bar conditional formatting rule with ${dataBarFormat} on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingDataBarCustomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${range}.","_ConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName}.","_TableRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName} body.","_TableBodyRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel":"I created an icon set conditional formatting rule using ${iconSet} on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${range}.","_ConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName}.","_TableRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName} body.","_TableBodyRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${tableName} total row.","_TableTotalRowRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingTopBottomCreatedLabel":"I ${cellFormatting} the ${topBottomRule} in the column(s) \'${columnName}\'.","_ColumnNameConditionalFormattingTopBottomCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${range}.","_ConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName}.","_TableRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName} body.","_TableBodyRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${tableName} total row.","_TableTotalRowRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingUniqueDuplicateCreatedLabel":"I ${cellFormatting} ${unique} values in the column(s) \'${columnName}\'.","_ColumnNameConditionalFormattingUniqueDuplicateCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${range}.","_ConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName}.","_TableRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName} body.","_TableBodyRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${tableName} total row.","_TableTotalRowRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingPresetDatesCreatedLabel":"I ${cellFormatting} dates ${dateString} in the column(s) \'${columnName}\'.","_ColumnNameConditionalFormattingPresetDatesCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${range} for values that are ${presetCriterion}.","_ConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} for values that are ${presetCriterion}.","_TableRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} body for values that are ${presetCriterion}.","_TableBodyRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} header row for values that are ${presetCriterion}.","_TableHeaderRowRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${tableName} total row for values that are ${presetCriterion}.","_TableTotalRowRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} sub-range of table ${tableName} for values that are ${presetCriterion}.","_TableGeneralRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${count} row(s) in table ${tableName} for values that are ${presetCriterion}.","_TableRowsRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} row at index ${rowIndex} in table ${tableName} for values that are ${presetCriterion}.","TableRowByIndexRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} ${count} column(s) in table ${tableName}. for values that are ${presetCriterion}","_TableColumnsRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} column \'${columnName}\' in table ${tableName} for values that are ${presetCriterion}.","_TableColumnByNameRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} the column at index ${columnIndex} in table ${tableName} for values that are ${presetCriterion}.","_TableColumnByIndexRangeConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameConditionalFormattingPresetCreatedLabel":"I ${cellFormatting} the column(s) \'${columnName}\' for values that are ${presetCriterion}.","_ColumnNameConditionalFormattingPresetCreatedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${range}","_ConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName}","_TableRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName} body","_TableBodyRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName} header row","_TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${tableName} total row","_TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on sub-range of table ${tableName}","_TableGeneralRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${count} row(s) in table ${tableName}","_TableRowsRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on ${count} column(s) in table ${tableName}","_TableColumnsRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel":"I created a conditional formatting rule on the column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ConditionalFormattingCreatedGroupTypeEventLabel":"I created a ${type} conditional formatting rule on ${range}","_ConditionalFormattingCreatedGroupTypeEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingEditedGroupEventLabel":"I edited the conditional formatting on sheet ${sheet}","_ConditionalFormattingEditedGroupEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingRuleDeletedLabel":"I cleared the conditional formatting rule on ${range}","_ConditionalFormattingRuleDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${range}","_ConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName}.","_TableRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName} body.","_TableBodyRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName} header row.","_TableHeaderRowRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${tableName} total row.","_TableTotalRowRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on sub-range of table ${tableName}.","_TableGeneralRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${count} row(s) in table ${tableName}.","_TableRowsRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on ${count} column(s) in table ${tableName}.","_TableColumnsRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeConditionalFormattingDeletedLabel":"I cleared all conditional formatting rules on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexRangeConditionalFormattingDeletedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","CreateNamedItem":"I created a named item","_CreateNamedItem.comment":"User-facing string describing the Excel event executed by Copilot.","SetNamedItem":"I set the named item","_SetNamedItem.comment":"User-facing string describing the Excel event executed by Copilot.","DeleteNamedItem":"I deleted the named item","_DeleteNamedItem.comment":"User-facing string describing the Excel event executed by Copilot.","ErrorAliasInfo":"This object\'s actions cannot be recorded right now. Try restarting the recorder and execute the action again.","_ErrorAliasInfo.comment":"User-facing string describing an error that occurs when a user creates an object during a recording session that we don\'t understand.","ErrorUnknown":"Oops! An unexpected error occurred while recording this action. Try restarting the recorder and execute the action again.","_ErrorUnknown.comment":"User-facing string describing an error case we don\'t know about.","ExternalLinksRefreshedLabel":"Refresh a linked Workbook","_ExternalLinksRefreshedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksRefreshedAllLabel":"Refresh all linked workbooks","_ExternalLinksRefreshedAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksBrokeLinkLabel":"Break a linked workbook","_ExternalLinksBrokeLinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksBrokeAllLinksLabel":"Break all linked workbooks","_ExternalLinksBrokeAllLinksLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksSetAutoRefreshLabel":"I set the auto refresh for workbook links","_ExternalLinksSetAutoRefreshLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ExternalLinksChangedSourceLabel":"I changed the source for a linked workbook","_ExternalLinksChangedSourceLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutAddedToPrintAreaLabel":"Added to print area label in page setup","_PageLayoutAddedToPrintAreaLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutOrientationChangedLabel":"I changed the page setup orientation","_PageLayoutOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPageBreakInsertedLabel":"I inserted a page break in page setup","_PageLayoutPageBreakInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPageBreakRemovedLabel":"I removed the page break in page setup","_PageLayoutPageBreakRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPageBreaksAllResetLabel":"Reset all page breaks in page setup","_PageLayoutPageBreaksAllResetLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPaperSizeChangedLabel":"I changed the page setup paper size","_PageLayoutPaperSizeChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPrintAreaClearedLabel":"I cleared the page setup print area","_PageLayoutPrintAreaClearedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPrintAreaSetLabel":"I set the page setup print area","_PageLayoutPrintAreaSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutPrintSettingsChangedLabel":"I changed the page setup print setting","_PageLayoutPrintSettingsChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PageLayoutScalingChangedLabel":"I changed the page setup scaling","_PageLayoutScalingChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","InProgressEventLabel":"This action is coming soon","_InProgressEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PictureInsertedEventLabel":"I inserted a picture on sheet ${sheet}","_PictureInsertedEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","PivotChartCreateLabel":"I created a pivot chart","_PivotChartCreateLabel.comment":"Text to show in a list when a create pivot chart user action was taken during script recording","PivotTableCreateLabel":"I created a pivot table","_PivotTableCreateLabel.comment":"Text to show in a list when a create pivot table user action was taken during script recording","PivotTableSortLabel":"I sorted the  pivot table","_PivotTableSortLabel.comment":"Text to show in a list when a create pivot table user action was taken during script recording","PivotTableChangePositionLabel":"I changed the pivot table position","_PivotTableChangePositionLabel.comment":"Text to show in a list when a create pivot table user action was taken during script recording","PivotTableRefreshLabel":"Refresh pivot table ${pivotName}","_PivotTableRefreshLabel.comment":"Text to show in a list when a refresh pivot table user action was taken during script recording","PivotDrillExpandedLabel":"Expanded pivot item ${pivotItem} for pivot table ${pivotName}","_PivotDrillExpandedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotItem variable/placeholder is replaced by the name of the item being expanded.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotDrillCollapsedLabel":"Collapse pivot item ${pivotItem} for pivot table ${pivotName}","_PivotDrillCollapsedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotItem variable/placeholder is replaced by the name of the item being collapsed.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableRenamedLabel":"Rename pivot table to ${newName}","_PivotTableRenamedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and newName variable/placeholder is replaced by the new name of the pivot table.","PivotTableRowGrandTotalShownLabel":"Show row grand totals for pivot table ${pivotName}","_PivotTableRowGrandTotalShownLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableRowGrandTotalHiddenLabel":"I hid the row grand totals for pivot table ${pivotName}","_PivotTableRowGrandTotalHiddenLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableColumnGrandTotalShownLabel":"Show column grand totals for pivot table ${pivotName}","_PivotTableColumnGrandTotalShownLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableColumnGrandTotalHiddenLabel":"I hid the column(s) grand totals for pivot table ${pivotName}","_PivotTableColumnGrandTotalHiddenLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableAutoFitColumnWidthsOnRefreshToggledLabel":"I set the auto-fit of column widths for pivot table ${pivotName} to ${value}","_PivotTableAutoFitColumnWidthsOnRefreshToggledLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.  The $ and value variable/placeholder is replaced by true or false","PivotTableSubTotalsVisibilitySettingSetLabel":"Visibility of subtotals changed for pivot table ${pivotName}","_PivotTableSubTotalsVisibilitySettingSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableLayoutTypeSetLabel":"Layout type of pivot table ${pivotName} changed","_PivotTableLayoutTypeSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableChangeLabel":"I changed the fields for pivot table ${pivotName}","_PivotTableChangeLabel.comment":"Text to show in a list when a change pivot table user action was taken during script recording","PivotTableAddPivot":"Added pivot for pivot table ${pivotName}","_PivotTableAddPivot.comment":"Text to show in a list when a add pivot to pivot table user action was taken during script recording. The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","PivotTableRemovePivot":"I removed the pivot for pivot table ${pivotName}","_PivotTableRemovePivot.comment":"Text to show in a list when a add pivot to pivot table user action was taken during script recording. The $ and pivotName variable/placeholder is replaced by the name of the pivot table.","RangeAutoSumLabel":"I applied autosum to ${range}","_RangeAutoSumLabel.comment":"Text to show in a list when a range autosum user action was taken during script recording","RangeApplyBorderLabel":"I changed the border on ${range}","_RangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameApplyBorderLabel":"I changed the border on the column(s) \'${columnName}\'","_ColumnNameApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","SheetProtectionProtectedLabel":"Protect sheet ${sheet}","_SheetProtectionProtected.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionUnprotectedLabel":"Unprotect sheet ${sheet}","_SheetProtectionUnprotected.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionPasswordUpdatedLabel":"Update sheet password on sheet ${sheet}","_SheetProtectionPasswordUpdated.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionOptionsUpdatedLabel":"Update sheet protection option on sheet ${sheet}","_SheetProtectionOptionsUpdated.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionPausedLabel":"Pause protection on sheet ${sheet}","_SheetProtectionPaused.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","SheetProtectionResumedLabel":"Resume protection on sheet ${sheet}","_SheetProtectionResumed.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet.","TableAltTextEditedLabel":"I edited the Alt Text of Table ${tableName}","_TableAltTextEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAltTextTitleEditedLabel":"I edited the title part of Alt Text of Table ${tableName}","_TableAltTextTitleEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAltTextDescriptionEditedLabel":"I edited the description part Alt Text of Table ${tableName}","_TableAltTextDescriptionEditedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeApplyBorderLabel":"I changed the border on table ${tableName}","_TableRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeApplyBorderLabel":"I changed the border on table ${tableName} body","_TableBodyRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeApplyBorderLabel":"I changed the border on table ${tableName} header row","_TableHeaderRowRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeApplyBorderLabel":"I changed the border on table ${tableName} total row","_TableTotalRowRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeApplyBorderLabel":"I changed the border on sub-range of table ${tableName}","_TableGeneralRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeApplyBorderLabel":"I changed the border on ${count} row(s) in table ${tableName}","_TableRowsRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeApplyBorderLabel":"I changed the border on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeApplyBorderLabel":"I changed the border on ${count} column(s) in table ${tableName}","_TableColumnsRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeApplyBorderLabel":"I changed the border on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeApplyBorderLabel":"I changed the border on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeApplyBorderLabel":"I changed the border on range areas","_MultiRangeApplyBorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeClearBackgroundColorLabel":"I cleared the background color on ${range}","_RangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameClearBackgroundColorLabel":"I cleared the background color on the column(s) \'${columnName}\'","_ColumnNameClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeClearBackgroundColorLabel":"I cleared the background color on range areas","_MultiRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName}","_TableRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by a the name of the table.","TableBodyRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName} body","_TableBodyRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName} header row","_TableHeaderRowRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeClearBackgroundColorLabel":"I cleared the background color on table ${tableName} total row","_TableTotalRowRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeClearBackgroundColorLabel":"I cleared the background color on sub-range of table ${tableName}","_TableGeneralRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeClearBackgroundColorLabel":"I cleared the background color on ${count} row(s) in table ${tableName}","_TableRowsRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeClearBackgroundColorLabel":"I cleared the background color on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeClearBackgroundColorLabel":"I cleared the background color on ${count} column(s) in table ${tableName}","_TableColumnsRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeClearBackgroundColorLabel":"I cleared the background color on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeClearBackgroundColorLabel":"I cleared the background color on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeClearBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFillPatternAppliedLabel":"Patterned fill applied","_RangeFillPatternAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeCellStyleAppliedLabel":"I applied a cell style to ${range}","_RangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameCellStyleAppliedLabel":"I applied a cell style to the column(s) \'${columnName}\'","_ColumnNameCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeCellStyleAppliedLabel":"I applied a cell style to range areas","_MultiRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName}","_TableRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by a range of cells.","TableBodyRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName} body","_TableBodyRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName} header row","_TableHeaderRowRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeCellStyleAppliedLabel":"I applied a cell style to table ${tableName} total row","_TableTotalRowRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeCellStyleAppliedLabel":"I applied a cell style to sub-range of table ${tableName}","_TableGeneralRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeCellStyleAppliedLabel":"I applied a cell style to ${count} row(s) in table ${tableName}","_TableRowsRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeCellStyleAppliedLabel":"I applied a cell style to row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeCellStyleAppliedLabel":"I applied a cell style to ${count} column(s) in table ${tableName}","_TableColumnsRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeCellStyleAppliedLabel":"I applied a cell style to column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeCellStyleAppliedLabel":"I applied a cell style to column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeCellStyleAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeClearLabel":"I cleared the contents of ${range}","_RangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeClearLabel":"I cleared the contents of table ${tableName}","_TableRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeClearLabel":"I cleared the contents of table ${tableName} body","_TableBodyRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeClearLabel":"I cleared the contents of table ${tableName} header row","_TableHeaderRowRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeClearLabel":"I cleared the contents of table ${tableName} total row","_TableTotalRowRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeClearLabel":"I cleared the contents of sub-range of table ${tableName}","_TableGeneralRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeClearLabel":"I cleared the contents of ${count} row(s) in table ${tableName}","_TableRowsRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeClearLabel":"I cleared the contents of row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeClearLabel":"I cleared the contents of ${count} column(s) in table ${tableName}","_TableColumnsRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeClearLabel":"I cleared the contents of column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeClearLabel":"I cleared the contents of column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeClearFormatLabel":"I cleared the formatting on ${range}","_RangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeClearFormatLabel":"I cleared the formatting on table ${tableName}","_TableRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeClearFormatLabel":"I cleared the formatting on table ${tableName} body","_TableBodyRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeClearFormatLabel":"I cleared the formatting on table ${tableName} header row","_TableHeaderRowRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeClearFormatLabel":"I cleared the formatting on table ${tableName} total row","_TableTotalRowRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeClearFormatLabel":"I cleared the formatting on sub-range of table ${tableName}","_TableGeneralRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeClearFormatLabel":"I cleared the formatting on ${count} row(s) in table ${tableName}","_TableRowsRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeClearFormatLabel":"I cleared the formatting on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeClearFormatLabel":"I cleared the formatting on ${count} column(s) in table ${tableName}","_TableColumnsRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeClearFormatLabel":"I cleared the formatting on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeClearFormatLabel":"I cleared the formatting on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeClearFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeClearLabel":"I cleared the range areas","_MultiRangeClearLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeColumnsAutofitLabel":"I autofitted column(s) in ${range}.","_RangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName}","_TableRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName} body","_TableBodyRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName} header row","_TableHeaderRowRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeColumnsAutofitLabel":"I autofitted column(s) in table ${tableName} total row","_TableTotalRowRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeColumnsAutofitLabel":"I autofitted column(s) in sub-range of table ${tableName}","_TableGeneralRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeColumnsAutofitLabel":"I autofitted column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeColumnsAutofitLabel":"I autofitted column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeColumnsAutofitLabel":"I autofitted column(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeColumnsAutofitLabel":"I autofitted column(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeColumnsAutofitLabel":"I autofitted column(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeColumnsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeUseStandardWidthLabel":"I removed autofit from column(s) in ${range}.","_RangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName}","_TableRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName} body","_TableBodyRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName} header row","_TableHeaderRowRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUseStandardWidthLabel":"I removed autofit from column(s) in table ${tableName} total row","_TableTotalRowRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUseStandardWidthLabel":"I removed autofit from column(s) in sub-range of table ${tableName}","_TableGeneralRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUseStandardWidthLabel":"I removed autofit from column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUseStandardWidthLabel":"I removed autofit from column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUseStandardWidthLabel":"I removed autofit from column(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUseStandardWidthLabel":"I removed autofit from column(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUseStandardWidthLabel":"I removed autofit from column(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUseStandardWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeUseStandardHeightLabel":"I removed autofit from row(s) in ${range}.","_RangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName}","_TableRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName} body","_TableBodyRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName} header row","_TableHeaderRowRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUseStandardHeightLabel":"I removed autofit from row(s) in table ${tableName} total row","_TableTotalRowRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUseStandardHeightLabel":"I removed autofit from row(s) in sub-range of table ${tableName}","_TableGeneralRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUseStandardHeightLabel":"I removed autofit from row(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUseStandardHeightLabel":"I removed autofit from row(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUseStandardHeightLabel":"I removed autofit from row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUseStandardHeightLabel":"I removed autofit from row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUseStandardHeightLabel":"I removed autofit from row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUseStandardHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeCustomSortLabel":"I applied a custom sort on ${range}","_RangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by a name of a sheet.","TableRangeCustomSortLabel":"I applied a custom sort on ${tableName}.","_TableRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeCustomSortLabel":"I applied a custom sort on ${tableName} body.","_TableBodyRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeCustomSortLabel":"I applied a custom sort on ${tableName} header row.","_TableHeaderRowRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeCustomSortLabel":"I applied a custom sort on ${tableName} total row.","_TableTotalRowRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeCustomSortLabel":"I applied a custom sort on sub-range of table ${tableName}.","_TableGeneralRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeCustomSortLabel":"I applied a custom sort on ${count} row(s) in table ${tableName}.","_TableRowsRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeCustomSortLabel":"I applied a custom sort on row at index ${rowIndex} in table ${tableName}.","TableRowByIndexRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeCustomSortLabel":"I applied a custom sort on ${count} column(s) in table ${tableName}.","_TableColumnsRangeCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameCustomSortLabel":"I applied a custom sort on column \'${columnName}\' in table ${tableName}.","_TableColumnByNameCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexCustomSortLabel":"I applied a custom sort on the column at index ${columnIndex} in table ${tableName}.","_TableColumnByIndexCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","AutoFilterCustomSortLabel":"I applied a custom sort to range spanned by auto filter on sheet ${sheet}","_AutoFilterCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TextToColumnsLabel":"Transform text to columns on ${range}","_TextToColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is the range where the operation happens.","RangeDeleteLabel":"I deleted ${range}","_RangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeDeleteLabel":"I deleted table ${tableName}","_TableRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeDeleteLabel":"I deleted table ${tableName} body","_TableBodyRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeDeleteLabel":"I deleted table ${tableName} header row","_TableHeaderRowRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeDeleteLabel":"I deleted table ${tableName} total row","_TableTotalRowRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeDeleteLabel":"I deleted sub-range of table ${tableName}","_TableGeneralRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeDeleteLabel":"I deleted ${count} row(s) in table ${tableName}","_TableRowsRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeDeleteLabel":"I deleted row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeDeleteLabel":"I deleted ${count} column(s) in table ${tableName}","_TableColumnsRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeDeleteLabel":"I deleted column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeDeleteLabel":"I deleted column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeEditLabel":"I edited ${range}","_RangeEditLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeEditValueNumberLabel":"Write ${value} into ${range}","_RangeEditValueNumberLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells. The value represents a specific string cell value we\'re writing into that cell range, e.g. \'1.5\'","RangeEditValueStringLabel":"I wrote \'${value}\' into ${range}","_RangeEditValueStringLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells. The value represents a specific cell value we\'re writing into that cell range, e.g. \'1.5\'","MultiRangeEditLabel":"I edited the range areas","_MultiRangeEditLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeDeleteLabel":"I deleted the range areas","_MultiRangeDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFillLabel":"Fill range ${range}","_RangeFillLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeFlashFillLabel":"Flash fill on ${range}","_RangeFlashFillLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeFormatBoldLabel":"I bolded ${range}","_RangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatBoldLabel":"I bolded the column(s) \'${columnName}\'","_ColumnFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatSuperscriptLabel":"Superscript ${range}","_RangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatSuperscriptLabel":"Superscript the column(s) \'${columnName}\'","_ColumnFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatSubscriptLabel":"subscript ${range}","_RangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatSubscriptLabel":"subscript the column(s) \'${columnName}\'","_ColumnFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatBoldLabel":"I bolded the range areas","_MultiRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatSuperscriptLabel":"Superscript range areas","_MultiRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatSubscriptLabel":"Subscript range areas","_MultiRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatBoldLabel":"I bolded the table ${tableName}","_TableRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatSuperscriptLabel":"Superscript table ${tableName}","_TableRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatSubscriptLabel":"Subscript table ${tableName}","_TableRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatBoldLabel":"I bolded the table ${tableName} body","_TableBodyRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSuperscriptLabel":"Superscript table ${tableName} body","_TableBodyRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSubscriptLabel":"Subscript table ${tableName} body","_TableBodyRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatBoldLabel":"I bolded the table ${tableName} header row","_TableHeaderRowRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSuperscriptLabel":"Superscript table ${tableName} header row","_TableHeaderRowRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSubscriptLabel":"Subscript table ${tableName} header row","_TableHeaderRowRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatBoldLabel":"I bolded the table ${tableName} total row","_TableTotalRowRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSuperscriptLabel":"Superscript table ${tableName} total row","_TableTotalRowRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSubscriptLabel":"Subscript table ${tableName} total row","_TableTotalRowRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatBoldLabel":"I bolded the sub-range of table ${tableName}","_TableGeneralRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSuperscriptLabel":"Superscript sub-range of table ${tableName}","_TableGeneralRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSubscriptLabel":"Subscript sub-range of table ${tableName}","_TableGeneralRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatBoldLabel":"I bolded ${count} row(s) in table ${tableName}","_TableRowsRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatBoldLabel":"I bolded row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatSuperscriptLabel":"Superscript ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSuperscriptLabel":"Superscript row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatSubscriptLabel":"Subscript ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSubscriptLabel":"Subscript row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatBoldLabel":"I bolded ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatBoldLabel":"I bolded column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatBoldLabel":"I bolded column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatBoldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatSuperscriptLabel":"Superscript ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSuperscriptLabel":"Superscript column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSuperscriptLabel":"Superscript column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatSubscriptLabel":"Subscript ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSubscriptLabel":"Subscript column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSubscriptLabel":"Subscript column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeFormatUnboldLabel":"I unbolded the range areas","_MultiRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatRemoveSuperscriptLabel":"I removed the superscript from range areas","_MultiRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeFormatRemoveSubscriptLabel":"I removed the subscript from range areas","_MultiRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFormatDoubleUnderlineLabel":"I applied a double underline to ${range}","_RangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatDoubleUnderlineLabel":"I applied a double underline to the column(s) \'${columnName}\'","_ColumnFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatDoubleUnderlineLabel":"I applied a double underline to range areas","_MultiRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName}","_TableRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName} body","_TableBodyRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName} header row","_TableHeaderRowRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatDoubleUnderlineLabel":"I applied a double underline to table ${tableName} total row","_TableTotalRowRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatDoubleUnderlineLabel":"I applied a double underline to sub-range of table ${tableName}","_TableGeneralRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatDoubleUnderlineLabel":"I applied a double underline to ${count} row(s) in table ${tableName}","_TableRowsRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatDoubleUnderlineLabel":"I applied a double underline to row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatDoubleUnderlineLabel":"I applied a double underline to ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatDoubleUnderlineLabel":"I applied a double underline to column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatDoubleUnderlineLabel":"I applied a double underline to column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatItalicLabel":"I italicized ${range}","_RangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatItalicLabel":"I italicized the column(s) \'${columnName}\'","_ColumnFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatItalicizeLabel":"I italicized the range areas","_MultiRangeFormatItalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatItalicLabel":"I italicized the table ${tableName}","_TableRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatItalicLabel":"I italicized the table ${tableName} body","_TableBodyRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatItalicLabel":"I italicized the table ${tableName} header row","_TableHeaderRowRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatItalicLabel":"I italicized the table ${tableName} total row","_TableTotalRowRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatItalicLabel":"I italicized the sub-range of table ${tableName}","_TableGeneralRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatItalicLabel":"I italicized ${count} row(s) in table ${tableName}","_TableRowsRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatItalicLabel":"I italicized row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatItalicLabel":"I italicized ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatItalicLabel":"I italicized column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatItalicLabel":"I italicized column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatItalicLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeFormatUnItalicizeLabel":"I removed italics from the range areas","_MultiRangeFormatUnItalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from ${range}","_RangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveDoubleUnderlineLabel":"I removed the double underline from the column(s) \'${columnName}\'","_ColumnFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName}","_TableRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName} body","_TableBodyRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from table ${tableName} total row","_TableTotalRowRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeFormatRemoveDoubleUnderlineLabel":"I removed the double underline from range areas","_MultiRangeFormatRemoveDoubleUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from ${range}","_RangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveStrikethroughLabel":"I removed the strikethrough from the column(s) \'${columnName}\'","_ColumnFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from range areas","_MultiRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName}","_TableRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName} body","_TableBodyRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from table ${tableName} total row","_TableTotalRowRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveStrikethroughLabel":"I removed the strikethrough from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatRemoveUnderlineLabel":"I removed underlining from ${range}","_RangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveUnderlineLabel":"I removed underlining from column(s) ${racolumnNamenge}","_ColumnFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatRemoveUnderlineLabel":"I removed underlining from range areas","_MultiRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName}","_TableRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName} body","_TableBodyRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveUnderlineLabel":"I removed underlining from table ${tableName} total row","_TableTotalRowRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveUnderlineLabel":"I removed underlining from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatRemoveUnderlineLabel":"I removed underlining from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveUnderlineLabel":"I removed underlining from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatRemoveUnderlineLabel":"I removed underlining from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveUnderlineLabel":"I removed underlining from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveUnderlineLabel":"I removed underlining from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatSetFontColorLabel":"I set the font color to ${color} on ${range}","_RangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameFormatSetFontColorLabel":"I set the font color to ${color} on ${columnName}","_ColumnNameFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and columnName variable/placeholder is replaced by the column name.","ColumnFormatSetFontColorLabel":"I set the font color to ${color} on ${range}","_ColumnFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeFormatSetFontColorLabel":"I set the font color to ${color} on range areas","_MultiRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.","TableRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName}","_TableRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName} body","_TableBodyRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName} header row","_TableHeaderRowRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSetFontColorLabel":"I set the font color to ${color} on table ${tableName} total row","_TableTotalRowRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSetFontColorLabel":"I set the font color to ${color} on sub-range of table ${tableName}","_TableGeneralRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatSetFontColorLabel":"I set the font color to ${color} on ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSetFontColorLabel":"I set the font color to ${color} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatSetFontColorLabel":"I set the font color to ${color} on ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSetFontColorLabel":"I set the font color to ${color} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSetFontColorLabel":"I set the font color to ${color} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSetFontColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new font color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatSetFontLabel":"I set the font to ${fontName} on ${range}","_RangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameFormatSetFontLabel":"I set the font to ${fontName} on the column(s) \'${columnName}\'","_ColumnNameFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatSetFontLabel":"I set the font to ${fontName} on range areas","_MultiRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.","TableRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName}","_TableRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName} body","_TableBodyRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName} header row","_TableHeaderRowRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatSetFontLabel":"I set the font to ${fontName} on table ${tableName} total row","_TableTotalRowRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatSetFontLabel":"I set the font to ${fontName} on sub-range of table ${tableName}","_TableGeneralRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatSetFontLabel":"I set the font to ${fontName} on ${count} row(s) in table ${tableName}","_TableRowsRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatSetFontLabel":"I set the font to ${fontName} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatSetFontLabel":"I set the font to ${fontName} on ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatSetFontLabel":"I set the font to ${fontName} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatSetFontLabel":"I set the font to ${fontName} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatSetFontLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontName variable/placeholder is replaced by the new font name.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatStrikethroughLabel":"I applied a strikethrough on ${range}","_RangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatStrikethroughLabel":"I applied a strikethrough on the column(s) \'${columnName}\'","_ColumnFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatStrikethroughLabel":"I applied a strikethrough on range areas","_MultiRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName}","_TableRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableRange variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName} body","_TableBodyRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName} header row","_TableHeaderRowRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatStrikethroughLabel":"I applied a strikethrough on table ${tableName} total row","_TableTotalRowRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatStrikethroughLabel":"I applied a strikethrough on sub-range of table ${tableName}","_TableGeneralRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatStrikethroughLabel":"I applied a strikethrough on ${count} row(s) in table ${tableName}","_TableRowsRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatStrikethroughLabel":"I applied a strikethrough on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatStrikethroughLabel":"I applied a strikethrough on ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatStrikethroughLabel":"I applied a strikethrough on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatStrikethroughLabel":"I applied a strikethrough on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatStrikethroughLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatUnboldLabel":"I unbolded ${range}","_RangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatUnboldLabel":"I unbolded the column(s) \'${columnName}\'","_ColumnFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatRemoveSuperscriptLabel":"I removed the superscript from ${range}","_RangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveSuperscriptLabel":"I removed the superscript from the column(s) \'${columnName}\'","_ColumnFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeFormatRemoveSubscriptLabel":"I removed the subscript from ${range}","_RangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatRemoveSubscriptLabel":"I removed the subscript from the column(s) \'${columnName}\'","_ColumnFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeFormatUnboldLabel":"I unbolded the table ${tableName}","_TableRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatUnSuperscriptLabel":"I removed the superscript from table ${tableName}","_TableRangeFormatUnSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName}","_TableRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatUnboldLabel":"I unbolded the table ${tableName} body","_TableBodyRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveSuperscriptLabel":"I removed the superscript from table ${tableName} body","_TableBodyRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName} body","_TableBodyRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatUnboldLabel":"I unbolded the table ${tableName} header row","_TableHeaderRowRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveSuperscriptLabel":"I removed the superscript from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName} header row","_TableHeaderRowRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatUnboldLabel":"I unbolded the table ${tableName} total row","_TableTotalRowRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveSuperscriptLabel":"I removed the superscript from table ${tableName} total row","_TableTotalRowRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatRemoveSubscriptLabel":"I removed the subscript from table ${tableName} total row","_TableTotalRowRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatUnboldLabel":"I unbolded the sub-range of table ${tableName}","_TableGeneralRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveSuperscriptLabel":"I removed the superscript from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatRemoveSubscriptLabel":"I removed the subscript from sub-range of table ${tableName}","_TableGeneralRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatUnboldLabel":"I unbolded ${count} row(s) in table ${tableName}","_TableRowsRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatUnboldLabel":"I unbolded row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatRemoveSuperscriptLabel":"I removed the superscript from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveSuperscriptLabel":"I removed the superscript from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableRowsRangeFormatRemoveSubscriptLabel":"I removed the subscript from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatRemoveSubscriptLabel":"I removed the subscript from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatUnboldLabel":"I unbolded ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatUnboldLabel":"I unbolded column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatUnboldLabel":"I unbolded column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatUnboldLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatRemoveSuperscriptLabel":"I removed the superscript from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveSuperscriptLabel":"I removed the superscript from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveSuperscriptLabel":"I removed the superscript from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveSuperscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","TableColumnsRangeFormatRemoveSubscriptLabel":"I removed the subscript from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatRemoveSubscriptLabel":"I removed the subscript from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatRemoveSubscriptLabel":"I removed the subscript from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatRemoveSubscriptLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatUnderlineLabel":"I underlined ${range}","_RangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatUnderlineLabel":"I underlined the column(s) \'${columnName}\'","_ColumnFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeFormatUnderlineLabel":"I underlined the range areas","_MultiRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeFormatUnderlineLabel":"I underlined the table ${tableName}","_TableRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatUnderlineLabel":"I underlined the table ${tableName} body","_TableBodyRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatUnderlineLabel":"I underlined the table ${tableName} header row","_TableHeaderRowRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatUnderlineLabel":"I underlined the table ${tableName} total row","_TableTotalRowRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatUnderlineLabel":"I underlined the sub-range of table ${tableName}","_TableGeneralRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatUnderlineLabel":"I underlined ${count} row(s) in table ${tableName}","_TableRowsRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatUnderlineLabel":"I underlined row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatUnderlineLabel":"I underlined ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatUnderlineLabel":"I underlined column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatUnderlineLabel":"I underlined column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatUnderlineLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeFormatUnitalicizeLabel":"I removed italics from ${range}","_RangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnFormatUnitalicizeLabel":"I removed italics from the column(s) \'${columnName}\'","_ColumnFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName}","_TableRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName} body","_TableBodyRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName} header row","_TableHeaderRowRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFormatUnitalicizeLabel":"I removed italics from table ${tableName} total row","_TableTotalRowRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFormatUnitalicizeLabel":"I removed italics from sub-range of table ${tableName}","_TableGeneralRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFormatUnitalicizeLabel":"I removed italics from ${count} row(s) in table ${tableName}","_TableRowsRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFormatUnitalicizeLabel":"I removed italics from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFormatUnitalicizeLabel":"I removed italics from ${count} column(s) in table ${tableName}","_TableColumnsRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFormatUnitalicizeLabel":"I removed italics from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFormatUnitalicizeLabel":"I removed italics from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFormatUnitalicizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeGroupDetailsHideLabel":"I hid the group details on sheet ${sheet}","_RangeGroupDetailsHideLabel.comment":"Text to show in a list when a group details hide user action was taken during script recording","RangeGroupDetailsShowLabel":"Show group details on sheet ${sheet}","_RangeGroupDetailsShowLabel.comment":"Text to show in a list when a group details show user action was taken during script recording","RangeGroupLabel":"Group range on sheet ${sheet}","_RangeGroupLabel.comment":"Text to show in a list when a range group user action was taken during script recording","RangeDataValidationChangedGroupLabel":"I set the data validation on sheet ${sheet}","_RangeDataValidationChangedGroupLabel.comment":"Text to show in a list when the data validation group was changed for a selected range","RangeHideRowsLabel":"I hid the row(s) on ${range}","_RangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeHideRowsLabel":"I hid the row(s) in table ${tableName}","_TableRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeHideRowsLabel":"I hid the row(s) in table ${tableName} body","_TableBodyRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeHideRowsLabel":"I hid the table ${tableName} header row","_TableHeaderRowRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeHideRowsLabel":"I hid the table ${tableName} total row","_TableTotalRowRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeHideRowsLabel":"I hid the row(s) in sub-range of table ${tableName}","_TableGeneralRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeHideRowsLabel":"I hid ${count} row(s) in table ${tableName}","_TableRowsRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeHideRowsLabel":"I hid row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeHideRowsLabel":"I hid the row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeHideRowsLabel":"I hid the row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeHideRowsLabel":"I hid the row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameHideRowsLabel":"I hid the row(s) on the column(s) \'${columnName}\'","_ColumnNameRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeUnhideRowsLabel":"I unhid the row(s) on ${range}","_RangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeUnhideRowsLabel":"I unhid the row(s) in table ${tableName}","_TableRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnhideRowsLabel":"I unhid the row(s) in table ${tableName} body","_TableBodyRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnhideRowsLabel":"I unhid the table ${tableName} header row","_TableHeaderRowRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnhideRowsLabel":"I unhid the table ${tableName} total row","_TableTotalRowRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnhideRowsLabel":"I unhid the row(s) in sub-range of table ${tableName}","_TableGeneralRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnhideRowsLabel":"I unhid ${count} row(s) in table ${tableName}","_TableRowsRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnhideRowsLabel":"I unhid row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnhideRowsLabel":"I unhid the row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnhideRowsLabel":"I unhid the row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnhideRowsLabel":"I unhid the row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameUnhideRowsLabel":"I unhid the row(s) on the column(s) \'${columnName}\'","_ColumnNameUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeHideColumnsLabel":"I hid the column(s) on ${range}","_RangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeHideColumnsLabel":"I hid the column(s) in table ${tableName}","_TableRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeHideColumnsLabel":"I hid the column(s) in table ${tableName} body","_TableBodyRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeHideColumnsLabel":"I hid the column(s) in table ${tableName} header row","_TableHeaderRowRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeHideColumnsLabel":"I hid the column(s) in table ${tableName} total row","_TableTotalRowRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeHideColumnsLabel":"I hid the column(s) in sub-range of table ${tableName}","_TableGeneralRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeHideColumnsLabel":"I hid the column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeHideColumnsLabel":"I hid the column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeHideColumnsLabel":"I hid ${count} column(s) in table ${tableName}","_TableColumnsRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeHideColumnsLabel":"I hid column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeHideColumnsLabel":"I hid the column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameHideColumnsLabel":"I hid the column(s) \'${columnName}\'","_ColumnNameHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","RangeUnhideColumnsLabel":"I unhid the column(s) on ${range}","_RangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName}","_TableRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName} body","_TableBodyRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName} header row","_TableHeaderRowRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnhideColumnsLabel":"I unhid the column(s) in table ${tableName} total row","_TableTotalRowRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnhideColumnsLabel":"I unhid the column(s) in sub-range of table ${tableName}","_TableGeneralRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnhideColumnsLabel":"I unhid the column(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnhideColumnsLabel":"I unhid the column(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnhideColumnsLabel":"I unhid ${count} column(s) in table ${tableName}","_TableColumnsRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnhideColumnsLabel":"I unhid column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnhideColumnsLabel":"I unhid the column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameUnhideColumnsLabel":"I unhid the column(s) \'${columnName}\'","_ColumnNameRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeHideRowsLabel":"I hid the row(s) on range areas","_MultiRangeHideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeUnhideRowsLabel":"I unhid the row(s) on range areas","_MultiRangeUnhideRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeHideColumnsLabel":"I hid the column(s) on range areas","_MultiRangeHideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","MultiRangeUnhideColumnsLabel":"I unhid the column(s) on range areas","_MultiRangeUnhideColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeHyperlinkLabel":"I applied a hyperlink on ${range}","_RangeHyperlinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeRemoveHyperlinkLabel":"I removed the hyperlink from ${range}","_RangeRemoveHyperlinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ChangeRangeIndent":"I changed the indent","_ChangeRangeIndent.comment":"User-facing string describing the Excel event executed by Copilot.","RangeChangeIndentLabel":"I changed the indent on ${range}","_RangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameChangeIndentLabel":"I changed the indent on the column(s) \'${columnName}\'","_ColumnNameChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeChangeIndentLabel":"I changed the indent on table ${tableName}","_TableRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeChangeIndentLabel":"I changed the indent on table ${tableName} body","_TableBodyRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeChangeIndentLabel":"I changed the indent on table ${tableName} header row","_TableHeaderRowRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeChangeIndentLabel":"I changed the indent on table ${tableName} total row","_TableTotalRowRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeChangeIndentLabel":"I changed the indent on sub-range of table ${tableName}","_TableGeneralRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeChangeIndentLabel":"I changed the indent on ${count} row(s) in table ${tableName}","_TableRowsRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeChangeIndentLabel":"I changed the indent on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeChangeIndentLabel":"I changed the indent on ${count} column(s) in table ${tableName}","_TableColumnsRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeChangeIndentLabel":"I changed the indent on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeChangeIndentLabel":"I changed the indent on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeRemoveHyperlinkLabel":"I removed the hyperlink from range areas","_MultiRangeRemoveHyperlinkLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MultiRangeChangeIndentLabel":"I changed the indent on range areas","_MultiRangeChangeIndentLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeInsertLabel":"I inserted ${range}","_RangeInsertLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeInsertedLabel":"I inserted cells at table ${tableName}","_TableRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeInsertedLabel":"I inserted cells at table ${tableName} body","_TableBodyRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeInsertedLabel":"I inserted cells at table ${tableName} header row","_TableHeaderRowRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeInsertedLabel":"I inserted cells at table ${tableName} total row","_TableTotalRowRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeInsertedLabel":"I inserted cells at sub-range of table ${tableName}","_TableGeneralRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeInsertedLabel":"I inserted cells at ${count} row(s) in table ${tableName}","_TableRowsRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeInsertedLabel":"I inserted cells at row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeInsertedLabel":"I inserted cells at ${count} column(s) in table ${tableName}","_TableColumnsRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeInsertedLabel":"I inserted cells at column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeInsertedLabel":"I inserted cells at column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultipleRangeInsertLabel":"I inserted multiple ranges","_MultipleRangeInsertLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeMergeLabel":"I merged ${range}","_RangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeMergeLabel":"I merged cells on table ${tableName}","_TableRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeMergeLabel":"I merged cells on table ${tableName} body","_TableBodyRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeMergeLabel":"I merged cells on table ${tableName} header row","_TableHeaderRowRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeMergeLabel":"I merged cells on table ${tableName} total row","_TableTotalRowRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeMergeLabel":"I merged cells on sub-range of table ${tableName}","_TableGeneralRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeMergeLabel":"I merged cells on ${count} row(s) in table ${tableName}","_TableRowsRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeMergeLabel":"I merged cells on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeMergeLabel":"I merged cells on ${count} column(s) in table ${tableName}","_TableColumnsRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeMergeLabel":"I merged cells on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeMergeLabel":"I merged cells on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeMergeLabel":"I merged the range areas","_MultiRangeMergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeNumberFormatLabel":"I applied ${numberFormat} on ${range}","_RangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameNumberFormatLabel":"I applied ${numberFormat} on the column(s) \'${columnName}\'","_ColumnNameNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeNumberFormatLabel":"I applied the number format on range areas","_MultiRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeNumberFormatLabel":"I applied the number format on table ${tableName}","_TableRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeNumberFormatLabel":"I applied the number format on table ${tableName} body","_TableBodyRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeNumberFormatLabel":"I applied the number format on table ${tableName} header row","_TableHeaderRowRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeNumberFormatLabel":"I applied the number format on table ${tableName} total row","_TableTotalRowRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeNumberFormatLabel":"I applied the number format on sub-range of table ${tableName}","_TableGeneralRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeNumberFormatLabel":"I applied the number format on ${count} row(s) in table ${tableName}","_TableRowsRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeNumberFormatLabel":"I applied the number format on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeNumberFormatLabel":"I applied the number format on ${count} column(s) in table ${tableName}","_TableColumnsRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeNumberFormatLabel":"I applied the number format on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeNumberFormatLabel":"I applied the number format on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeNumberFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangePasteCopyLabel":"Paste copied cells into ${range}","_RangePasteCopyLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangePasteCopyInTableLabel":"Paste copied cells into row ${rowIndex} of table ${tableName}","_RangePasteCopyInTableLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and rowIndex variable/placeholder is replaced by the index where the copied cells are pasted.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteCutLabel":"Paste cut cells into ${range}","_RangePasteCutLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangePasteCutInTableLabel":"Paste cut cells into row ${rowIndex} of table ${tableName}","_RangePasteCutInTableLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and rowIndex variable/placeholder is replaced by the index where the cut cells are pasted.  The $ and tableName variable/placeholder is replaced by the name of the table.","NamedSheetViewCreateLabel":"I created a new temporary sheet view","_NamedSheetViewCreateLabel.comment":"User-facing string describing the Excel event executed by Copilot.","NamedSheetViewDeleteLabel":"I deleted ${deletedNum} named sheet view(s)","_NamedSheetViewDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and deletedNum variables/placeholders is replaced by the number of named sheet views deleted.","NamedSheetViewDuplicateLabel":"Duplicate named sheet view ${sheetViewName}","_NamedSheetViewDuplicateLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewExitLabel":"Exit named sheet view","_NamedSheetViewExitLabel.comment":"User-facing string describing the Excel event executed by Copilot.","NamedSheetViewExitAndKeepLabel":"Exit named sheet view and keep as ${sheetViewName}","_NamedSheetViewExitAndKeepLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewKeepLabel":"Keep named sheet view as ${sheetViewName}","_NamedSheetViewKeepLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewRenameLabel":"Rename named sheet view to ${newSheetViewName}","_NamedSheetViewRenameLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and newSheetViewName variables/placeholders is replaced by the new name of the named sheet view.","NamedSheetViewSwitchLabel":"Switch to named sheet view ${sheetViewName}","_NamedSheetViewSwitchLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.","NamedSheetViewSwitchAndKeepLabel":"Switch to named sheet view ${sheetViewName} and keep temporary named sheet view as ${sheetViewKeepName}","_NamedSheetViewSwitchAndKeepLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheetViewName variables/placeholders is replaced by the name of the named sheet view.  The $ and namedSheetViewKeepName variables/placeholders is replaced by the name of the temporary named sheet view to keep.","RangePasteLabel":"Paste from ${sourceRange} to ${destinationRange}","_RangePasteLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and sourceRange and destinationRange variables/placeholders are replaced by ranges of cells.","RangePasteInTableRangeLabel":"Paste from ${sourceRange} to table ${tableName}","_RangePasteInTableRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and sourceRange variable/placeholder is replaced a range of cells.","RangePasteInTableBodyRangeLabel":"Paste from ${sourceRange} to table ${tableName} body","_RangePasteInTableBodyRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteInTableHeaderRowRangeLabel":"Paste from ${sourceRange} to table ${tableName} header row","_RangePasteInTableHeaderRowRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteInTableTotalRowRangeLabel":"Paste from ${sourceRange} to table ${tableName} total row","_RangePasteInTableTotalRowRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","RangePasteInTableGeneralRangeLabel":"Paste from ${sourceRange} to sub-range of table ${tableName}","_RangePasteInTableGeneralRangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.   The $ and sourceRange variable/placeholder is replaced a range of cells.  The $ and tableName variable/placeholder is replaced by the name of the table.","MultiRangePasteLabel":"Paste from ${sourceRange} to range areas","_MultiRangePasteLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and sourceRange variable/placeholder is replaced by ranges of cells.","RangePasteTextLabel":"Paste text to ${range}","_RangePasteTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","RangeRemoveDuplicatesLabel":"I removed duplicates on ${range}","_RangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName}","_TableRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName} body","_TableBodyRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName} header row","_TableHeaderRowRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeRemoveDuplicatesLabel":"I removed duplicates in table ${tableName} total row","_TableTotalRowRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeRemoveDuplicatesLabel":"I removed duplicates in sub-range of table ${tableName}","_TableGeneralRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeRemoveDuplicatesLabel":"I removed duplicates in ${count} row(s) in table ${tableName}","_TableRowsRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeRemoveDuplicatesLabel":"I removed duplicates in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeRemoveDuplicatesLabel":"I removed duplicates in ${count} column(s) in table ${tableName}","_TableColumnsRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeRemoveDuplicatesLabel":"I removed duplicates in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeRemoveDuplicatesLabel":"I removed duplicates in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeRemoveDuplicatesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeRowsAutofitLabel":"I autofitted row(s) in ${range}.","_RangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName}","_TableRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName} body","_TableBodyRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName} header row","_TableHeaderRowRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeRowsAutofitLabel":"I autofitted row(s) in table ${tableName} total row","_TableTotalRowRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeRowsAutofitLabel":"I autofitted row(s) in sub-range of table ${tableName}","_TableGeneralRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeRowsAutofitLabel":"I autofitted row(s) in ${count} row(s) in table ${tableName}","_TableRowsRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeRowsAutofitLabel":"I autofitted row(s) in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeRowsAutofitLabel":"I autofitted row(s) in ${count} column(s) in table ${tableName}","_TableColumnsRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeRowsAutofitLabel":"I autofitted row(s) in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeRowsAutofitLabel":"I autofitted row(s) in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeRowsAutofitLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSetBackgroundColorLabel":"I set the background color to ${color} on ${range}","_RangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetBackgroundColorLabel":"I set the background color to ${color} on the column(s) \'${columnName}\'","_ColumnNameSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and columnName variable/placeholder is replaced by columnName of cells.","TableRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName}","_TableRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName} body","_TableBodyRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName} header row","_TableHeaderRowRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetBackgroundColorLabel":"I set the background color to ${color} on table ${tableName} total row","_TableTotalRowRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetBackgroundColorLabel":"I set the background color to ${color} on sub-range of table ${tableName}","_TableGeneralRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetBackgroundColorLabel":"I set the background color to ${color} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetBackgroundColorLabel":"I set the background color to ${color} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetBackgroundColorLabel":"I set the background color to ${color} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetBackgroundColorLabel":"I set the background color to ${color} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetBackgroundColorLabel":"I set the background color to ${color} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeSetBackgroundColorLabel":"I set the background color to ${color} on range areas","_MultiRangeSetBackgroundColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new background color.","RangeSetCellHeightLabel":"I set the height to ${size} on ${range}","_RangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName}","_TableRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName} body","_TableBodyRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName} header row","_TableHeaderRowRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetCellHeightLabel":"I set the height to ${size} on table ${tableName} total row","_TableTotalRowRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetCellHeightLabel":"I set the height to ${size} on sub-range of table ${tableName}","_TableGeneralRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetCellHeightLabel":"I set the height to ${size} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetCellHeightLabel":"I set the height to ${size} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetCellHeightLabel":"I set the height to ${size} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetCellHeightLabel":"I set the height to ${size} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetCellHeightLabel":"I set the height to ${size} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameSetCellHeightLabel":"I set the height to ${size} on the column(s) \'${columnName}\'","_ColumnNameSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell height number.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetCellHeightLabel":"I set the height to ${size} on range areas","_MultiRangeSetCellHeightLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeSetCellWidthLabel":"I set the width to ${size} on ${range}","_RangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName}","_TableRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName} body","_TableBodyRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName} header row","_TableHeaderRowRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetCellWidthLabel":"I set the width to ${size} on table ${tableName} total row","_TableTotalRowRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetCellWidthLabel":"I set the width to ${size} on sub-range of table ${tableName}","_TableGeneralRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetCellWidthLabel":"I set the width to ${size} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetCellWidthLabel":"I set the width to ${size} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetCellWidthLabel":"I set the width to ${size} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetCellWidthLabel":"I set the width to ${size} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetCellWidthLabel":"I set the width to ${size} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameSetCellWidthLabel":"I set the width to ${size} on the column(s) \'${columnName}\'","_ColumnNameSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetCellWidthLabel":"I set the width to ${size} on range areas","_MultiRangeSetCellWidthLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and size variable/placeholder is replaced by the new cell width number.","RangeSetFontSizeLabel":"I set the font size to ${fontSize} on ${range}","_RangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetFontSizeLabel":"I set the font size to ${fontSize} on the column(s) \'${columnName}\'","_ColumnNameSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetFontSizeLabel":"I set the font size to ${fontSize} on range areas","_MultiRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","FontUnderlineStyleLabel":"I applied the ${style} underline on ${range}","_FontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and style variable/placeholder is replaced by the style of underline. The $ and range variable/placeholder is replaced by a range of cells","TableRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName}","_TableRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName} body","_TableBodyRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName} header row","_TableHeaderRowRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeFontUnderlineStyleLabel":"I applied the ${style} underline on table ${tableName} total row","_TableTotalRowRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeFontUnderlineStyleLabel":"I applied the ${style} underline on sub-range of table ${tableName}","_TableGeneralRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeFontUnderlineStyleLabel":"I applied the ${style} underline on ${count} row(s) in table ${tableName}","_TableRowsRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeFontUnderlineStyleLabel":"I applied the ${style} underline on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeFontUnderlineStyleLabel":"I applied the ${style} underline on ${count} column(s) in table ${tableName}","_TableColumnsRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeFontUnderlineStyleLabel":"I applied the ${style} underline on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeFontUnderlineStyleLabel":"I applied the ${style} underline on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.   The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameFontUnderlineStyleLabel":"I applied the ${style} underline on the column(s) \'${columnName}\'","_ColumnNameFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and style variable/placeholder is replaced by the style of underline.  The $ and style variable/placeholder is replaced by the style of underline. The $ and columnName variable/placeholder is replaced by columnName of cells","RemoveFontUnderlineStyleLabel":"I removed underlining from ${range}","_RemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and range variable/placeholder is replaced by a range of cells","TableRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName}","_TableRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName} body","_TableBodyRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName} header row","_TableHeaderRowRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeRemoveFontUnderlineStyleLabel":"I removed underlining from table ${tableName} total row","_TableTotalRowRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeRemoveFontUnderlineStyleLabel":"I removed underlining from sub-range of table ${tableName}","_TableGeneralRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeRemoveFontUnderlineStyleLabel":"I removed underlining from ${count} row(s) in table ${tableName}","_TableRowsRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeRemoveFontUnderlineStyleLabel":"I removed underlining from row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeRemoveFontUnderlineStyleLabel":"I removed underlining from ${count} column(s) in table ${tableName}","_TableColumnsRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeRemoveFontUnderlineStyleLabel":"I removed underlining from column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeRemoveFontUnderlineStyleLabel":"I removed underlining from column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ColumnNameRemoveFontUnderlineStyleLabel":"I removed underlining from the column(s) \'${columnName}\'","_ColumnNameRemoveFontUnderlineStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and columnName variable/placeholder is replaced by columnName of cells","TableRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName}","_TableRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName} body","_TableBodyRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName} header row","_TableHeaderRowRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetFontSizeLabel":"I set the font size to ${fontSize} on table ${tableName} total row","_TableTotalRowRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetFontSizeLabel":"I set the font size to ${fontSize} on sub-range of table ${tableName}","_TableGeneralRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetFontSizeLabel":"I set the font size to ${fontSize} on ${count} row(s) in table ${tableName}","_TableRowsRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetFontSizeLabel":"I set the font size to ${fontSize} on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetFontSizeLabel":"I set the font size to ${fontSize} on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetFontSizeLabel":"I set the font size to ${fontSize} on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetFontSizeLabel":"I set the font size to ${fontSize} on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetFontSizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and fontSize variable/placeholder is replaced by a font size value.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on ${range}","_RangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetHorizontalAlignmentLabel":"I set the horizontal alignment on the column(s) \'${columnName}\'","_ColumnNameSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on range areas","_MultiRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName}","_TableRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableRange variable/placeholder is replaced by the name of the table.","TableBodyRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName} body","_TableBodyRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName} header row","_TableHeaderRowRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on table ${tableName} total row","_TableTotalRowRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on sub-range of table ${tableName}","_TableGeneralRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on ${count} row(s) in table ${tableName}","_TableRowsRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetHorizontalAlignmentLabel":"I set the horizontal alignment on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetHorizontalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSetVerticalAlignmentLabel":"I set the vertical alignment on ${range}","_RangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameSetVerticalAlignmentLabel":"I set the vertical alignment on the column(s) \'${columnName}\'","_ColumnNameSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeSetVerticalAlignmentLabel":"I set the vertical alignment on range areas","_MultiRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName}","_TableRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by the name of the table.","TableBodyRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName} body","_TableBodyRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName} header row","_TableHeaderRowRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeSetVerticalAlignmentLabel":"I set the vertical alignment on table ${tableName} total row","_TableTotalRowRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeSetVerticalAlignmentLabel":"I set the vertical alignment on sub-range of table ${tableName}","_TableGeneralRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeSetVerticalAlignmentLabel":"I set the vertical alignment on ${count} row(s) in table ${tableName}","_TableRowsRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeSetVerticalAlignmentLabel":"I set the vertical alignment on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeSetVerticalAlignmentLabel":"I set the vertical alignment on ${count} column(s) in table ${tableName}","_TableColumnsRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeSetVerticalAlignmentLabel":"I set the vertical alignment on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeSetVerticalAlignmentLabel":"I set the vertical alignment on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeSetVerticalAlignmentLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeSortLabel":"I sorted the range  ${range}","_RangeSortLabel.comment":"Text to show in a list when a sort range user action was taken during script recording","RangeUnGroupLabel":"Ungroup range on sheet ${sheet}","_RangeUnGroupLabel.comment":"Text to show in a list when a range ungroup user action was taken during script recording","RangeUnmergeLabel":"Unmerge ${range}","_RangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","TableRangeUnmergeLabel":"I unmerged cells on table ${tableName}","_TableRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnmergeLabel":"I unmerged cells on table ${tableName} body","_TableBodyRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnmergeLabel":"I unmerged cells on table ${tableName} header row","_TableHeaderRowRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnmergeLabel":"I unmerged cells on table ${tableName} total row","_TableTotalRowRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnmergeLabel":"I unmerged cells on sub-range of table ${tableName}","_TableGeneralRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnmergeLabel":"I unmerged cells on ${count} row(s) in table ${tableName}","_TableRowsRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnmergeLabel":"I unmerged cells on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnmergeLabel":"I unmerged cells on ${count} column(s) in table ${tableName}","_TableColumnsRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnmergeLabel":"I unmerged cells on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnmergeLabel":"I unmerged cells on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","MultiRangeUnmergeLabel":"Unmerge range areas","_MultiRangeUnmergeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","RangeUnwrapTextLabel":"Unwrap text on ${range}","_RangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameUnwrapTextLabel":"Unwrap text on the column(s) \'${columnName}\'","_ColumnNameUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeUnwrapTextLabel":"Unwrap text on range areas","_MultiRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeUnwrapTextLabel":"Unwrap text on table ${tableName}","_TableRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeUnwrapTextLabel":"Unwrap text on table ${tableName} body","_TableBodyRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeUnwrapTextLabel":"Unwrap text on table ${tableName} header row","_TableHeaderRowRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeUnwrapTextLabel":"Unwrap text on table ${tableName} total row","_TableTotalRowRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeUnwrapTextLabel":"Unwrap text on sub-range of table ${tableName}","_TableGeneralRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeUnwrapTextLabel":"Unwrap text on ${count} row(s) in table ${tableName}","_TableRowsRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeUnwrapTextLabel":"Unwrap text on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeUnwrapTextLabel":"Unwrap text on ${count} column(s) in table ${tableName}","_TableColumnsRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeUnwrapTextLabel":"Unwrap text on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeUnwrapTextLabel":"Unwrap text on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeUnwrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RangeWrapTextLabel":"I wrapped text on ${range}","_RangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and range variable/placeholder is replaced by a range of cells.","ColumnNameWrapTextLabel":"I wrapped text on the column(s) \'${columnName}\'","_ColumnNameWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnName variable/placeholder is replaced by columnName of cells.","MultiRangeWrapTextLabel":"I wrapped text on range areas","_MultiRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeWrapTextLabel":"I wrapped text on table ${tableName}","_TableRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeWrapTextLabel":"I wrapped text on table ${tableName} body","_TableBodyRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeWrapTextLabel":"I wrapped text on table ${tableName} header row","_TableHeaderRowRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeWrapTextLabel":"I wrapped text on table ${tableName} total row","_TableTotalRowRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeWrapTextLabel":"I wrapped text on sub-range of table ${tableName}","_TableGeneralRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeWrapTextLabel":"I wrapped text on ${count} row(s) in table ${tableName}","_TableRowsRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeWrapTextLabel":"I wrapped text on row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeWrapTextLabel":"I wrapped text on ${count} column(s) in table ${tableName}","_TableColumnsRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeWrapTextLabel":"I wrapped text on column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeWrapTextLabel":"I wrapped text on column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeWrapTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","RedoLabel":"Redo","_RedoLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' over the range ${range}","_ReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term. \'range\' represents the cell range we\'re operating over, e.g. A1:C6","TableRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName}","_TableRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableBodyRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName} body","_TableBodyRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHeaderRowRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName} header row","_TableHeaderRowRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableTotalRowRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in table ${tableName} total row","_TableTotalRowRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableGeneralRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in sub-range of table ${tableName}","_TableGeneralRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in ${count} row(s) in table ${tableName}","_TableRowsRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows.","TableRowByIndexRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in row at index ${rowIndex} in table ${tableName}","TableRowByIndexRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row.","TableColumnsRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in ${count} column(s) in table ${tableName}","_TableColumnsRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns.","TableColumnByNameRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in column \'${columnName}\' in table ${tableName}","_TableColumnByNameRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column.","TableColumnByIndexRangeReplaceAllLabel":"Replace all \'${search}\' with \'${replace}\' in column at index ${columnIndex} in table ${tableName}","_TableColumnByIndexRangeReplaceAllLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column.","ReplaceAllLabelGeneric":"Replace all \'${search}\' with \'${replace}\'","_ReplaceAllLabelGeneric.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and search variable/placeholder is replaced by the user-entered search term.  The $ and replace variable/placeholder is replaced by the user-entered replace term.","TableApplyStyleLabel":"I applied a style on table ${tableName}","_TableApplyStyleLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableChangeBandedColumnsVisibilityLabel":"Change the visibility of banded columns on table ${tableName}","_TableChangeBandedColumnsVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddBandedColumnsLabel":"I added banded columns on table ${tableName}","_TableAddBandedColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveBandedColumnsLabel":"I removed banded columns on table ${tableName}","_TableRemoveBandedColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableChangeBandedRowsVisibilityLabel":"I changed the visibility of banded rows on table ${tableName}","_TableChangeBandedRowsVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddBandedRowsLabel":"I added banded rows on table ${tableName}","_TableAddBandedRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveBandedRowsLabel":"I removed banded rows on table ${tableName}","_TableRemoveBandedRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableChangeFilterButtonVisibilityLabel":"I changed the visibility of filter button on table ${tableName}","_TableChangeFilterButtonVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddFilterButtonLabel":"I added filter button on table ${tableName}","_TableAddFilterButtonLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveFilterButtonLabel":"I removed filter button on table ${tableName}","_TableRemoveFilterButtonLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableClearFiltersLabel":"I removed all filters on table ${tableName}","_TableClearFiltersLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnClearFilterLabel":"I removed a filter on \'${columnName}\' of table ${tableName}","_TableColumnClearFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was un-filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnCustomFilterLabel":"I applied a custom filter on \'${columnName}\' of table ${tableName}","_TableColumnCustomFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnEqualsFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is equal to ${value1}","_TableColumnEqualsFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotEqualFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value does not equal to ${value1}","_TableColumnDoesNotEqualFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnBeginsWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value begins with ${value1}","_TableColumnBeginsWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnBeginsWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value begins with ${value1} or ${value2}","_TableColumnBeginsWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnDoesNotBeginWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value does not begin with ${value1}","_TableColumnDoesNotBeginWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotBeginWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value does not begin with ${value1} and ${value2}","_TableColumnDoesNotBeginWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnEndsWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value ends with ${value1}","_TableColumnEndsWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnEndsWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value ends with ${value1} or ${value2}","_TableColumnEndsWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnDoesNotEndWithFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value does not end with ${value1}","_TableColumnDoesNotEndWithFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotEndWithFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value does not end with ${value1} and ${value2}","_TableColumnDoesNotEndWithFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnContainsFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value contains ${value1}","_TableColumnContainsFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnContainsFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value contains ${value1} or ${value2}","_TableColumnContainsFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnDoesNotContainFilterLabel1":"I applied a filter on \'${columnName}\' to show only rows where the value does not contain ${value1}","_TableColumnDoesNotContainFilterLabel1.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnDoesNotContainFilterLabel2":"I applied a filter on \'${columnName}\' to show only rows where the value does not contain ${value1} and ${value2}","_TableColumnDoesNotContainFilterLabel2.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter. The ${value2} is replaced by the second value used to filter.","TableColumnIsGreaterThanFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is greater than ${value1}","_TableColumnIsGreaterThanFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnIsGreaterThanOrEqualToFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is greater than or equal to ${value1}","_TableColumnIsGreaterThanOrEqualToFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnIsLessThanFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is less than ${value1}","_TableColumnIsLessThanFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnIsLessThanOrEqualToFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is less than or equal to ${value1}","_TableColumnIsLessThanOrEqualToFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the value used to filter.","TableColumnBetweenFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is between ${value1} and ${value2}","_TableColumnBetweenFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the smaller value used to filter. The ${value2} is replaced by the greater value used to filter.","TableColumnNotBetweenFilterLabel":"I applied a filter on \'${columnName}\' to show only rows where the value is not between ${value1} and ${value2}","_TableColumnNotBetweenFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered. The ${value1} is replaced by the smaller value used to filter. The ${value2} is replaced by the greater value used to filter.","TableColumnDynamicFilterLabel":"I applied a filter on \'${columnName}\' of table ${tableName}","_TableColumnDynamicFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableColumnTopFilterLabel":"I applied a ${direction} ${count} filter on \'${columnName}\' of table ${tableName}","_TableColumnTopFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by a number.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableConvertToRangeLabel":"Convert table ${tableName} to range","_TableConvertToRangeLabel.comment":"Text to show in a list when a convert to range action was taken during script recording.","TableCreateAndFormatLabel":"I created and formatted a table ${tableName} on the range ${range}","_TableCreateAndFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableCreateLabel":"I created a table ${tableName} on the range ${range}","_TableCreateLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableCustomSortLabel":"I applied a custom sort to table ${tableName}","_TableCustomSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableClearSortLabel":"I removed sorting on table ${tableName}","_TableClearSortLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableFilterColumnLabel":"I applied a filter on the column \'${columnName}\' of table ${tableName} to include the following values: ${values}","_TableFilterColumnLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was filtered.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and values variable/placeholder is replaced by a comma-separated list of unique values in the column. For example, I applied a filter on column Column1 of table Table1 to include the following values: A, B, C","TableFormatLabel":"I applied a new format on table ${tableName}","_TableFormatLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHighlightFirstColumnFilterLabel":"I changed the highlighting on first column on table ${tableName}","_TableHighlightFirstColumnFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableHighlightLastColumnLabel":"I changed the highlighting on last column on table ${tableName}","_TableHighlightLastColumnLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableInsertColumnsLabel":"I inserted ${count} column(s) at column number ${columnNumber} of table ${tableName}","_TableInsertColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of columns inserted.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableInsertRowsLabel":"I inserted ${count} row(s) at row number ${rowNumber} of table ${tableName}","_TableInsertRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of rows inserted.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableReapplyFilterLabel":"Reapply filter on table ${tableName}","_TableReapplyFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveColumnsLabel":"I removed ${count} column(s) at column number ${columnNumber} of table ${tableName}","_TableRemoveColumnsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of columns removed.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveRowsLabel":"I removed ${count} row(s) at row number ${rowNumber} of table ${tableName}","_TableRemoveRowsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and count variable/placeholder is replaced by the number of rows removed.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRenameLabel":"Rename table to ${tableName}","_TableRenameLabel.comment":"Text to show in a list when a rename table user action was taken during script recording","TableResizeLabel":"Resize table ${tableName}","_TableResizeLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRowsRearrangeLabel":"Rearrange table row(s)","_TableRowsRearrangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableColumnsRearrangeLabel":"Rearrange table column(s)","_TableColumnsRearrangeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","TableSortColumnLabel":"I sorted column ${columnNumber} of table ${tableName}","_TableSortColumnLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and columnNumber variable/placeholder is replaced by the index of the table column which was sorted.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableToggleAutoFilterLabel":"I changed the AutoFilter on table ${tableName}","_TableToggleAutoFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableToggleHeaderRowLabel":"I changed the visibility of header row on table ${tableName}","_TableToggleHeaderRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddHeaderRowLabel":"I added header row on table ${tableName}","_TableAddHeaderRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveHeaderRowLabel":"I removed header row on table ${tableName}","_TableRemoveHeaderRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableToggleTotalRowLabel":"I changed the visibility of total row on table ${tableName}","_TableToggleTotalRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableAddTotalRowLabel":"I added total row on table ${tableName}","_TableAddTotalRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","TableRemoveTotalRowLabel":"I removed total row on table ${tableName}","_TableRemoveTotalRowLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.","CellTextOrientationChanged":"I changed the text orientation of ${range} to ${orientation} degrees","_CellTextOrientationChanged.comment":"User-facing string describing the Excel event executed by Copilot. \'orientation\' is a number representing degrees out of 360, e.g. 45 or 90.","ColumnNameCellTextOrientationChanged":"I changed the text orientation of the column(s) \'${columnName}\' to ${orientation} degrees","_ColumnNameCellTextOrientationChanged.comment":"User-facing string describing the Excel event executed by Copilot. \'orientation\' is a number representing degrees out of 360, e.g. 45 or 90.","CellTextOrientationChangedGeneric":"Cell text orientation changed","_CellTextOrientationChangedGeneric.comment":"User-facing string describing the Excel event executed by Copilot.","TableRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} to ${orientation} degrees","_TableRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableBodyRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} body to ${orientation} degrees","_TableBodyRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableHeaderRowRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} header row to ${orientation} degrees","_TableHeaderRowRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableTotalRowRangeCellTextOrientationChangedLabel":"I changed the text orientation of table ${tableName} total row to ${orientation} degrees","_TableTotalRowRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableGeneralRangeCellTextOrientationChangedLabel":"I changed the text orientation of sub-range of table ${tableName} to ${orientation} degrees","_TableGeneralRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableRowsRangeCellTextOrientationChangedLabel":"I changed the text orientation of ${count} row(s) in table ${tableName} to ${orientation} degrees","_TableRowsRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of rows. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableRowByIndexRangeCellTextOrientationChangedLabel":"I changed the text orientation of row at index ${rowIndex} in table ${tableName} to ${orientation} degrees","TableRowByIndexRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and rowIndex variable/placeholder is replaced by the index of the row. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableColumnsRangeCellTextOrientationChangedLabel":"I changed the text orientation of ${count} column(s) in table ${tableName} to ${orientation} degrees","_TableColumnsRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and count variable/placeholder is replaced by the number of columns. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableColumnByNameRangeCellTextOrientationChangedLabel":"I changed the text orientation of column \'${columnName}\' in table ${tableName} to ${orientation} degrees","_TableColumnByNameRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnName variable/placeholder is replaced by the name of the column. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","TableColumnByIndexRangeCellTextOrientationChangedLabel":"I changed the text orientation of column at index ${columnIndex} in table ${tableName} to ${orientation} degrees","_TableColumnByIndexRangeCellTextOrientationChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and tableName variable/placeholder is replaced by the name of the table.  The $ and columnIndex variable/placeholder is replaced by the index of the column. The $ and orientation variable/placeholder is replaced by the orientation of the text in degrees.","ChartRenamed":"Rename chart","_ChartRenamed.comment":"User-facing string describing the Excel event executed by Copilot.","CommentResolved":"Resolve comment","_CommentResolved.comment":"User-facing string describing the Excel event executed by Copilot.","TableDeleted":"I deleted the table","_TableDeleted.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetCalculated":"Calculate worksheet","_WorksheetCalculated.comment":"User-facing string describing the Excel event executed by Copilot.","IntentChangeRangeBorder":"I changed the range border","_IntentChangeRangeBorder.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatColorScale":"I created a conditional format color scale","_IntentCreateConditionalFormatColorScale.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatDataBar":"I created a Conditional Format data bar","_IntentCreateConditionalFormatDataBar.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatCellValue":"I created a Conditional Format cell rules","_IntentCreateConditionalFormatCellValue.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatPreset":"I created a Conditional Format preset criteria","_IntentCreateConditionalFormatPreset.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatContainsText":"I created a Conditional Format containing text","_IntentCreateConditionalFormatContainsText.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatTopBottom":"I created a Conditional Format with Top/Bottom rules","_IntentCreateConditionalFormatTopBottom.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatCustom":"I created a Conditional Format with custom rules","_IntentCreateConditionalFormatCustom.comment":"User-facing string describing the Excel event executed by Copilot.","IntentCreateConditionalFormatIconSet":"I created a Conditional Format with icon sets","_IntentCreateConditionalFormatIconSet.comment":"User-facing string describing the Excel event executed by Copilot.","IntentSetDataValidation":"I created a data validation rule","_IntentSetDataValidation.comment":"User-facing string describing the Excel event executed by Copilot.","FixedWidthTextToColumns":"Convert fixed width text to columns","_FixedWidthTextToColumns.comment":"User-facing string describing the Excel event executed by Copilot.","IntentRangeCopyFrom":"Copy range","_IntentRangeCopyFrom.comment":"User-facing string describing the Excel event executed by Copilot.","UndoLabel":"Undo","_UndoLabel.comment":"User-facing string describing the Excel event executed by Copilot.","UnknownEventLabel":"This action is not yet recordable","_UnknownEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","UnsupportedEventLabel":"This action cannot be recorded","_UnsupportedEventLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartAxisTitleHorizontal":"I set the axis title orientation to horizontal","_ChartAxisTitleHorizontal.comment":"Text to show in a list when axis title orientation is changed during script recording","ChartAxisTitleVertical":"I set the axis title orientation to vertical","_ChartAxisTitleVertical.comment":"Text to show in a list when axis title orientation is changed during script recording","ChartAxisDisplayUnit":"I changed the axis display unit","_ChartAxisDisplayUnit.comment":"Text to show in a list when axis display unit is changed during script recording","ChartAxisMajorGridilinesVisible":"I changed the axis major gridline visibility","_ChartAxisMajorGridilinesVisible.comment":"Text to show in a list when major gridline visibility is changed during script recording","ChartAxisMajorTickMark":"I changed the axis major tick mark","_ChartAxisMajorTickMark.comment":"Text to show in a list when major tick mark is changed during script recording","ChartAxisMinorTickMark":"I changed the axis minor tick mark","_ChartAxisMinorTickMark.comment":"Text to show in a list when minor tick mark is changed during script recording","ChartAxisMinorGridilinesVisible":"I changed the axis minor gridline visibility","_ChartAxisMinorGridilinesVisible.comment":"Text to show in a list when major gridline visibility is changed during script recording","ChartAxisTitleText":"I changed the axis title text","_ChartAxisTitleText.comment":"Text to show in a list when axis title text is changed during script recording","VisualChartAxisAxisTitleFillColoredLabel":"I set the fill color on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFillColoredLabel.comment":"Text to show in a list when the fill color for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontBoldedLabel":"I set the font bold on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontBoldedLabel.comment":"Text to show in a list when the font bold style for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontColoredLabel":"I set the font color on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontColoredLabel.comment":"Text to show in a list when a visual.SetProperty(\'PlotArea0_Axis_PrimaryValue0_AxisTitle0_FontFormat_Color\') was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontItalicizedLabel":"I set the font italic on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontItalicizedLabel.comment":"Text to show in a list when the font italic style for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontNamedLabel":"I set the font name on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontNamedLabel.comment":"Text to show in a list when the font name for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontSizedLabel":"I set the font size on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontSizedLabel.comment":"Text to show in a list when the font size for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleFontUnderlinedLabel":"I set the font underline on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleFontUnderlinedLabel.comment":"Text to show in a list when the font underline style for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleLineColoredLabel":"I set the line color on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisAxisTitleTextChangedLabel":"I set the text on ${axis} title to \'${newValue}\' for chart ${chartName}","_VisualChartAxisAxisTitleTextChangedLabel.comment":"Text to show in a list when the text for the specified axis title was changed by the ChartFormat add-in during script recording","VisualChartAxisBoundsMaxChangedLabel":"I set the bounds max on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisBoundsMaxChangedLabel.comment":"Text to show in a list when the maximum value for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisBoundsMinChangedLabel":"I set the bounds min on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisBoundsMinChangedLabel.comment":"Text to show in a list when the minimum value for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisCrossesAtChangedLabel":"I set the crossesAt on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisCrossesAtChangedLabel.comment":"Text to show in a list when the specified axis position where the other axis crosses at for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisCrossesChangedLabel":"I set the crosses on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisCrossesChangedLabel.comment":"Text to show in a list when the specified axis position where the other axis crosses was changed by the ChartFormat add-in during script recording","VisualChartAxisFillColoredLabel":"I set the fill color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFillColoredLabel.comment":"Text to show in a list when the fill color for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontBoldedLabel":"I set the font bold on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontBoldedLabel.comment":"Text to show in a list when the font bold style for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontColoredLabel":"I set the font color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontColoredLabel.comment":"Text to show in a list when the font color for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontItalicizedLabel":"I set the font italic on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontItalicizedLabel.comment":"Text to show in a list when the font italic style for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontNamedLabel":"I set the font name on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontNamedLabel.comment":"Text to show in a list when the font name for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontSizedLabel":"I set the font size on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontSizedLabel.comment":"Text to show in a list when the font size for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisFontUnderlinedLabel":"I set the font underline on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisFontUnderlinedLabel.comment":"Text to show in a list when the font underline style for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisLineColoredLabel":"I set the line color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisMajorGridlinesLineColoredLabel":"I set the major grid line\'s line color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisMajorGridlinesLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis major gridlines was changed by the ChartFormat add-in during script recording","VisualChartAxisMinorGridlinesLineColoredLabel":"I set the minor grid line\'s line color on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisMinorGridlinesLineColoredLabel.comment":"Text to show in a list when the line color for the specified axis minor gridlines was changed by the ChartFormat add-in during script recording","VisualChartAxisNumberFormatCodeChangedLabel":"I set the numberFormat on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisNumberFormatCodeChangedLabel.comment":"Text to show in a list when the numberFormat for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisReversePlotOrderChangedLabel":"I set the reverse plot order on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisReversePlotOrderChangedLabel.comment":"Text to show in a list when the reverse plot order for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisTickMarksMajorTypeChangedLabel":"I set the major tick mark on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisTickMarksMajorTypeChangedLabel.comment":"Text to show in a list when the type of major tick mark for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisTickMarksMinorTypeChangedLabel":"I set the minor tick mark on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisTickMarksMinorTypeChangedLabel.comment":"Text to show in a list when the type of minor tick mark for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisUnitsMajorUnitChangedLabel":"I set the units major unit on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisUnitsMajorUnitChangedLabel.comment":"Text to show in a list when the interval between two major tick marks for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartAxisUnitsMinorUnitChangedLabel":"I set the units minor unit on ${axis} to \'${newValue}\' for chart ${chartName}","_VisualChartAxisUnitsMinorUnitChangedLabel.comment":"Text to show in a list when the interval between two minor tick marks for the specified axis was changed by the ChartFormat add-in during script recording","VisualChartTitleFillColoredLabel":"I set the fill color on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFillColoredLabel.comment":"Text to show in a list when the fill color of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontBoldedLabel":"I set the font bold on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontBoldedLabel.comment":"Text to show in a list when the font bold style of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontColoredLabel":"I set the font color on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontColoredLabel.comment":"Text to show in a list when the font color of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontItalicizedLabel":"I set the font italic on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontItalicizedLabel.comment":"Text to show in a list when the font italic style of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontNamedLabel":"I set the font name on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontNamedLabel.comment":"Text to show in a list when the font name of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontSizedLabel":"I set the font size on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontSizedLabel.comment":"Text to show in a list when the font size of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleFontUnderlinedLabel":"I set the font underline on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleFontUnderlinedLabel.comment":"Text to show in a list when the font underline style of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleLineColoredLabel":"I set the line color on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleLineColoredLabel.comment":"Text to show in a list when the line color of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleOverlayChangedLabel":"I set the position on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleOverlayChangedLabel.comment":"Text to show in a list when the overlay of a chart title was changed by the ChartFormat add-in during script recording","VisualChartTitleTextChangedLabel":"I set the text on title to \'${newValue}\' for chart ${chartName}","_VisualChartTitleTextChangedLabel.comment":"Text to show in a list when the text of a chart title was changed by the ChartFormat add-in during script recording","VisualLegendFillClearedLabel":"I cleared the legend fill color","_VisualLegendFillClearedLabel.comment":"Text to show in a list when the fill color of a chart legend was cleared by the ChartFormat add-in during script recording","VisualLegendFillColoredLabel":"I set the fill color on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFillColoredLabel.comment":"Text to show in a list when the fill color of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontBoldedLabel":"I set the font bold on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontBoldedLabel.comment":"Text to show in a list when the font bold style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontColoredLabel":"I set the font color on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontColoredLabel.comment":"Text to show in a list when the font color of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontItalicizedLabel":"I set the font italic on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontItalicizedLabel.comment":"Text to show in a list when the font italic style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontNamedLabel":"I set the font name on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontNamedLabel.comment":"Text to show in a list when font name of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontSizedLabel":"I set the font size on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontSizedLabel.comment":"Text to show in a list when font size of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendFontUnderlinedLabel":"I set the font underline on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendFontUnderlinedLabel.comment":"Text to show in a list when font underline style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendLineClearedLabel":"I cleared the legend line color","_VisualLegendLineClearedLabel.comment":"Text to show in a list when the line color of a chart legend was cleared by the ChartFormat add-in during script recording","VisualLegendLineStyleChangedLabel":"I changed the legend line style","_VisualLegendLineStyleChangedLabel.comment":"Text to show in a list when the line style of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendLineWeightChangedLabel":"I cleared the legend line weight","_VisualLegendLineWeightChangedLabel.comment":"Text to show in a list when the line weight of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendLineColoredLabel":"I set the line color on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendLineColoredLabel.comment":"Text to show in a list when the line color of a chart legend was changed by the ChartFormat add-in during script recording","VisualLegendOverlayChangedLabel":"I set the overlay on legend to \'${newValue}\' for chart ${chartName}","_VisualLegendOverlayChangedLabel.comment":"Text to show in a list when the overlay of a chart legend was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsBinCountLabel":"I set the binOptions\' count on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsBinCountLabel.comment":"Text to show in a list when the binOptions\' count property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsBinWidthLabel":"I set the binOption\'s width on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsBinWidthLabel.comment":"Text to show in a list when the binOptions\' width property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsBinningTypeLabel":"I set the binOption\'s type on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsBinningTypeLabel.comment":"Text to show in a list when the binOptions\' type property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsOverflowEnabledLabel":"I set the binOption\'s allowOverflow on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsOverflowEnabledLabel.comment":"Text to show in a list when the binOptions\' allowOverflow property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsOverflowValueLabel":"I set the binOption\'s overflowValue on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsOverflowValueLabel.comment":"Text to show in a list when the binOptions\' overflowValue property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsUnderflowEnabledLabel":"I set the binOption\'s allowUnderflow on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsUnderflowEnabledLabel.comment":"Text to show in a list when the binOptions\' allowUnderflow property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBinningOptionsUnderflowValueLabel":"I set the binOption\'s underflowValue on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBinningOptionsUnderflowValueLabel.comment":"Text to show in a list when the binOptions\' underflowValue property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerQuartileCalculationLabel":"I set the boxwhiskerOptions\'s quartileCalculation on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerQuartileCalculationLabel.comment":"Text to show in a list when the boxwhiskerOptions\' quartileCalculation property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowInnerPointsLabel":"I set the boxwhiskerOptions\'s showInnerPoints on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowInnerPointsLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showInnerPoints property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowMeanLineLabel":"I set the boxwhiskerOptions\'s showMeanLine on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowMeanLineLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showMeanLine property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowMeanMarkerLabel":"I set the boxwhiskerOptions\'s showMeanMarker on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowMeanMarkerLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showMeanMarker property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBoxWhiskerShowOutliersLabel":"I set the boxwhiskerOptions\'s showOutlierPoints on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBoxWhiskerShowOutliersLabel.comment":"Text to show in a list when the boxwhiskerOptions\' showOutlierPoints property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesBubbleScaleSizedLabel":"I set the bubbleScale on series ${seriesIndex} for chart ${chartName}","_VisualSeriesBubbleScaleSizedLabel.comment":"Text to show in a list when the bubbleScale property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesDataLabelsContainsCategoryNameToggledLabel":"I set the visibility of the data label category name on the series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsCategoryNameToggledLabel.comment":"Text to show in a list when the visibility of the data label category name on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel":"I set the separator used for the data label on the series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel.comment":"Text to show in a list when the separator used for the data label on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsLegendKeyToggledLabel":"I set the visibility of the data label legend key on the series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsLegendKeyToggledLabel.comment":"Text to show in a list when the visibility of the data label legend key on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsSeparatorChangedLabel":"I set the predefined separator of the data label on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsSeparatorChangedLabel.comment":"Text to show in a list when the predefined separator of the data label on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsSeriesNameToggledLabel":"I set the visibility of the data label series name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsSeriesNameToggledLabel.comment":"Text to show in a list when the data label series name on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsContainsValueToggledLabel":"I set the visibility of the data label value on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsContainsValueToggledLabel.comment":"Text to show in a list when the data label value on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFillFormatColoredLabel":"I set the data label\'s fill color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFillFormatColoredLabel.comment":"Text to show in a list when the data label\'s fill color on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatBoldedLabel":"I set the data label\'s font bold style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatBoldedLabel.comment":"Text to show in a list when the data label\'s font bold style on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatColoredLabel":"I set the data label\'s font color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatColoredLabel.comment":"Text to show in a list when the data label\'s font color on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatItaliizedcLabel":"I set the data label\'s font italic style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatItaliizedcLabel.comment":"Text to show in a list when the data label\'s font italic style on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatNamedLabel":"I set the data label\'s font name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatNamedLabel.comment":"Text to show in a list when the data label\'s font name on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatSizedLabel":"I set the data label\'s font size for chart ${chartName}","_VisualSeriesDataLabelsFontFormatSizedLabel.comment":"Text to show in a list when the data label\'s font size on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsFontFormatUnderlinedLabel":"I set the data label\'s font underline style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsFontFormatUnderlinedLabel.comment":"Text to show in a list when the data label\'s font underline style on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsLineFormatColoredLabel":"I set the data label\'s line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsLineFormatColoredLabel.comment":"Text to show in a list when the data label\'s line color on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsNumberFormatCodeChangedLabel":"I set the data label\'s number format on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsNumberFormatCodeChangedLabel.comment":"Text to show in a list when the data label\'s number format on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDataLabelsPositionedLabel":"I set the data label\'s position on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsPositionedLabel.comment":"Text to show in a list when the data label\'s position on the specified chart series was changed by the ChartFormat add-in during script recording.","VisualSeriesDoughnutHoleSizedLabel":"I set the dough nut hole size on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDoughnutHoleSizedLabel.comment":"Text to show in a list when the doughnut hole size of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesFillColoredLabel":"I set the fill color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesFillColoredLabel.comment":"Text to show in a list when the fill color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesGapWidthChangedLabel":"I set the gap width on series for chart ${chartName}","_VisualSeriesGapWidthChangedLabel.comment":"Text to show in a list when the gap width of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesLineColoredLabel":"I set the line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesLineColoredLabel.comment":"Text to show in a list when the line color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersFillColoredLabel":"I set the markers fill color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersFillColoredLabel.comment":"Text to show in a list when the markers background color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersLineColoredLabel":"I set the markers line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersLineColoredLabel.comment":"Text to show in a list when the markers foreground color of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersMarkerSizedLabel":"I set the maker size on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersMarkerSizedLabel.comment":"Text to show in a list when the marker size of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesMakersMarkerStyleChangedLabel":"I set the maker style on series ${seriesIndex} for chart ${chartName}","_VisualSeriesMakersMarkerStyleChangedLabel.comment":"Text to show in a list when the marker style of a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesNamedLabel":"I set the name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesNamedLabel.comment":"Text to show in a list when the name property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesTreemapParentLabelStrategyLabel":"I set the parentLabelStrategy on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTreemapParentLabelStrategyLabel.comment":"Text to show in a list when the parentLabelStrategy property for a treemap chart series was changed by the ChartFormat add-in during script recording","VisualSeriesVaryColorsBySliceChangedLabel":"I set the vary color by slice on series ${seriesIndex} for chart ${chartName}","_VisualSeriesVaryColorsBySliceChangedLabel.comment":"Text to show in a list when the varyByCategories property for a chart series was changed by the ChartFormat add-in during script recording","VisualSeriesWaterfallShowConnectorLinesLabel":"I set the showConnectorLines on series ${seriesIndex} for chart ${chartName}","_VisualSeriesWaterfallShowConnectorLinesLabel.comment":"Text to show in a list when the showConnectorLines property for a waterfall chart series was changed by the ChartFormat add-in during script recording","VisualSeriesTrendlineTypeSetLabel":"I set the trendline type on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineTypeSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineNameChangedLabel":"I set the trendline name on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineNameChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineEquationDisplayedLabel":"I set the trendline equation visibility on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineEquationDisplayedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineRSquaredDisplayedLabel":"I set the trendline R squared visibility on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineRSquaredDisplayedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineInterceptSetLabel":"I set the trendline intercept on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineInterceptSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineManualSetLabel":"I set the trendline intercept manually on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineManualSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineAutomaticSetLabel":"I set the trendline intercept automatically on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineAutomaticSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineLineFormatColoredLabel":"I set the trendline\'s line color on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineLineFormatColoredLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineForecastForwardSetLabel":"I set the trendline forward forecast on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineForecastForwardSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualSeriesTrendlineForecastBackwardSetLabel":"I set the trendline backward forecast on series ${seriesIndex} for chart ${chartName}","_VisualSeriesTrendlineForecastBackwardSetLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and seriesIndex variable/placeholder is replaced by the index of the series which was operated on.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartTitleAddedRemovedLabel":"I changed the visibility of title for chart ${chartName}","_VisualChartTitleAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartTitleAddedLabel":"I added title for chart ${chartName}","_VisualChartTitleAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartTitleRemovedLabel":"I removed title for chart ${chartName}","_VisualChartTitleRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualLegendAddedRemovedLabel":"I changed the visibility of legend for chart ${chartName}","_VisualLegendAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualLegendAddedLabel":"I added legend for chart ${chartName}","_VisualLegendAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualLegendRemovedLabel":"I removed legend for chart ${chartName}","_VisualLegendRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.","VisualChartAxisAxisTitleAddedRemovedLabel":"I changed the visibility of ${axis} title for chart ${chartName}","_VisualChartAxisAxisTitleAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisAxisTitleAddedLabel":"I added ${axis} title for chart ${chartName}","_VisualChartAxisAxisTitleAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisAxisTitleRemovedLabel":"I removed ${axis} title for chart ${chartName}","_VisualChartAxisAxisTitleRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMajorGridlinesAddedRemovedLabel":"I changed the visibility of ${axis} major grid lines for chart ${chartName}","_VisualChartAxisGridlinesMajorGridlinesAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMajorGridlinesAddedLabel":"I added ${axis} major grid lines for chart ${chartName}","_VisualChartAxisGridlinesMajorGridlinesAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMajorGridlinesRemovedLabel":"I removed ${axis} major grid lines for chart ${chartName}","_VisualChartAxisGridlinesMajorGridlinesRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMinorGridlinesAddedRemovedLabel":"I changed the visibility of ${axis} minor grid lines for chart ${chartName}","_VisualChartAxisGridlinesMinorGridlinesAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMinorGridlinesAddedLabel":"I added ${axis} minor grid lines for chart ${chartName}","_VisualChartAxisGridlinesMinorGridlinesAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualChartAxisGridlinesMinorGridlinesRemovedLabel":"I removed ${axis} minor grid lines for chart ${chartName}","_VisualChartAxisGridlinesMinorGridlinesRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and axis variable/placeholder is replaced by the type of axis.","VisualSerriesErrorBarXAddedRemovedLabel":"I changed the visibility of horizontal error bars on series ${seriesIndex} for chart ${chartName}","_VisualSerriesErrorBarXAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarXAddedLabel":"I added horizontal error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarXAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarXRemovedLabel":"I removed horizontal error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarXRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSerriesErrorBarYAddedRemovedLabel":"I changed the visibility of vertical error bars on series ${seriesIndex} for chart ${chartName}","_VisualSerriesErrorBarYAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarYAddedLabel":"I added vertical error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarYAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesErrorBarYRemovedLabel":"I removed vertical error bars on series ${seriesIndex} for chart ${chartName}","_VisualSeriesErrorBarYRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSerriesTrendlineAddedLabel":"Add trendline to series ${seriesIndex} of chart ${chartName}","_VisualSerriesTrendlineAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSerriesTrendlineRemovedLabel":"I removed the trendline ${trendlineIndex} from series ${seriesIndex} of chart ${chartName}","_VisualSerriesTrendlineRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.  The $ and trendlineIndex variable/placeholder is replaced by the trendline index.","VisualSeriesTrendlineTitleAddedLabel":"Add a equation to trendline ${trendlineIndex} of series ${seriesIndex} of chart ${chartName}","_VisualSeriesTrendlineTitleAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index. The $ and trendlineIndex variable/placeholder is replaced by the trendline index.","VisualSeriesTrendlineTitleRemovedLabel":"I removed the equation and/or R Squared value from trendline ${trendlineIndex} of series ${seriesIndex} of chart ${chartName}","_VisualSeriesTrendlineTitleRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index. The $ and trendlineIndex variable/placeholder is replaced by the trendline index.","VisualSeriesDataLabelsAddedRemovedLabel":"I changed the visibility of data labels on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsAddedRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesDataLabelsAddedLabel":"I added data labels on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","VisualSeriesDataLabelsRemovedLabel":"I removed data labels on series ${seriesIndex} for chart ${chartName}","_VisualSeriesDataLabelsRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on.  The $ and seriesIndex variable/placeholder is replaced by the series index.","ChartTitleFillClearedLabel":"Chart title fill cleared","_ChartTitleFillClearedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartTitleLineClearedLabel":"Chart title line cleared","_ChartTitleLineClearedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartTitleLineStyleChangedLabel":"Chart title line style changed","_ChartTitleLineStyleChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","ChartTitleWeightChangedLabel":"Chart title line weight changed","_ChartTitleWeightChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorkbookRecalculateLabel":"Recalculate workbook","_WorkbookRecalculateLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorkbookRefreshAllLabel":"Refresh all data connections in workbook","_WorkbookRefreshAllLabel.comment":"Text to show in a list when a refresh all user action was taken during script recording.","WorkbookSetCalculationModeLabel":"I set the calculation mode","_WorkbookSetCalculationModeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetAddLabel":"Add worksheet","_WorksheetAddLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetAddedWithNameLabel":"Add worksheet with name ${worksheetName}","_WorksheetAddedWithNameLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and worksheetName variable/placeholder is replaced by the new name of the worksheet.","WorksheetChartAxisTitleChangeTextLabel":"I changed the title of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartAxisTitleChangeTextLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetCharTitleChangeTextLabel":"I changed the title of chart ${chartName} on sheet ${sheet}","_WorksheetCharTitleChangeTextLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and chartName variable/placeholder is replaced by the name of the chart which was operated on. The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartChangeAxisLabel":"I changed the axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeAxisLabel.comment":"Text to show in a list when a change Chart axis user action was taken during script recording","WorksheetChartChangeAxisTitleLabel":"I changed the title of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeAxisTitleLabel.comment":"Text to show in a list when a change Chart axis title user action was taken during script recording","WorksheetChartChangeAxisVisibilityLabel":"I changed the visibility of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeAxisVisibilityLabel.comment":"Text to show in a list when a change Chart axis visibility user action was taken during script recording","WorksheetChartAddAxisLabel":"I added axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartAddAxisLabel.comment":"Text to show in a list when a change Chart axis visibility user action was taken during script recording","WorksheetChartRemoveAxisLabel":"I removed axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartRemoveAxisLabel.comment":"Text to show in a list when a change Chart axis visibility user action was taken during script recording","WorksheetChartChangeGridlineVisiblityLabel":"I changed the visibility of gridlines for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeGridlineVisiblityLabel.comment":"Text to show in a list when a change Chart gridlines visibility user action was taken during script recording","WorksheetChartAddGridlineLabel":"I added gridlines for chart ${chartName} on sheet ${sheet}","_WorksheetChartAddGridlineLabel.comment":"Text to show in a list when a change Chart gridlines visibility user action was taken during script recording","WorksheetChartRemoveGridlineLabel":"I removed gridlines for chart ${chartName} on sheet ${sheet}","_WorksheetChartRemoveGridlineLabel.comment":"Text to show in a list when a change Chart gridlines visibility user action was taken during script recording","WorksheetChartChangeLegendLabel":"I changed the legend for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeLegendLabel.comment":"Text to show in a list when a change Chart legend user action was taken during script recording","WorksheetChartChangeTitleLabel":"I changed the title for chart ${chartName} on sheet ${sheet}","_WorksheetChartChangeTitleLabel.comment":"Text to show in a list when a Change Chart Title user action was taken during script recording","WorksheetChartChangeTypeLabel":"I changed the chart type for ${chartName} on sheet ${sheet}","_WorksheetChartChangeTypeLabel.comment":"Text to show in a list when a Change Chart Type user action was taken during script recording","WorksheetChartDataLabelChangePositionLabel":"I changed the position of data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelChangePositionLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDataLabelChangeVisibilityLabel":"I changed the visibility of data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelChangeVisibilityLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDataLabelAddedLabel":"I added data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelAddedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDataLabelRemovedLabel":"I removed data label for chart ${chartName} on sheet ${sheet}","_WorksheetChartDataLabelRemovedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetChartDeleteLabel":"I deleted the chart ${chartName} on sheet ${sheet}","_WorksheetChartDeleteLabel.comment":"Text to show in a list when a chart delete user action was taken during script recording","WorksheetChartHideAxisTitleLabel":"I hid the title of axis for chart ${chartName} on sheet ${sheet}","_WorksheetChartHideAxisTitleLabel.comment":"Text to show in a list when a hide Chart axis title user action was taken during script recording","WorksheetChartHideLegendLabel":"I hid the legend for chart ${chartName} on sheet ${sheet}","_WorksheetChartHideLegendLabel.comment":"Text to show in a list when a change Chart legend user action was taken during script recording","WorksheetChartHideTitleLabel":"I hid the title for chart ${chartName} on sheet ${sheet}","_WorksheetChartHideTitleLabel.comment":"Text to show in a list when a Hide Chart Title user action was taken during script recording","WorksheetChartMoveAndResizeLabel":"Move or resize chart ${chartName} on sheet ${sheet}","_WorksheetChartMoveAndResizeLabel.comment":"Text to show in a list when a chart move or resize user action was taken during script recording","WorksheetChartSelectDataLabel":"Select data for chart ${chartName} on sheet ${sheet}","_WorksheetChartSelectDataLabel.comment":"Text to show in a list when a Select Chart Data user action was taken during script recording","WorksheetChartSwitchRowColumnLabel":"Switch row/column for chart ${chartName} on sheet ${sheet}","_WorksheetChartSwitchRowColumnLabel.comment":"Text to show in a list when a Switch Chart Row and Column user action was taken during script recording","WorksheetClearFiltersLabel":"I cleared the filters on worksheet ${sheet}","_WorksheetClearFiltersLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetClearTabColorLabel":"I cleared the worksheet tab color on worksheet ${sheet}","_WorksheetClearTabColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetCreateChartLabel":"I created a chart on worksheet ${sheet}","_WorksheetCreateChartLabel.comment":"Text to show in a list when a Create Chart user action was taken during script recording","SlicerInsertedLabel":"I created a slicer with pivot ${pivotName} from pivot table ${pivotTable}","_SlicerInsertedLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and pivotName variable/placeholder is replaced by the name of the pivot the slicer is associated with.  The $ and pivotTable variable/placeholder is replaced by the name of the source pivot table","WorksheetTableRangeCreateChartLabel":"I created a chart on worksheet ${sheet} with source data from table ${table}","_WorksheetTableRangeCreateChartLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet the chart was inserted on.  The $ and table variable/placeholder is replaced by the name of the source data table","WorksheetCustomFilterAppliedLabel":"I applied a custom filter to ${range}","_WorksheetCustomFilterAppliedLabel.comment":"Text to show in a list when a worksheet custom filter user action was taken during script recording","WorksheetDeleteLabel":"I deleted the worksheet","_WorksheetDeleteLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetDeleteMultipleLabel":"I deleted ${count} worksheets","_WorksheetDeleteMultipleLabel.comment":"User-facing string describing the Excel event executed by Copilot. The $ and count variable/placeholder is replaced by the number of sheets deleted","WorksheetDuplicateLabel":"Duplicate worksheet ${sheet}","_WorksheetDuplicateLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the duplicated sheet.","WorksheetDynamicFilterAppliedLabel":"I applied a dynamic filter to ${range}","_WorksheetDynamicFilterAppliedLabel.comment":"Text to show in a list when a worksheet dynamic filter user action was taken during script recording","WorksheetFloatingObjectDeleteLabel":"I deleted the object on sheet ${sheet}","_WorksheetFloatingObjectDeleteLabel.comment":"Text to show in a list when an object delete user action was taken during script recording","WorksheetFloatingObjectMoveAndResizeLabel":"Move or resize object on sheet ${sheet}","_WorksheetFloatingObjectMoveAndResizeLabel.comment":"Text to show in a list when an object move or resize user action was taken during script recording","WorksheetFloatingObjectZOrderChangedLabel":"I changed the z-order of object on sheet ${sheet}","_WorksheetFloatingObjectZOrderChangedLabel.comment":"Text to show in a list when an object change z-order type user action was taken during script recording","WorksheetFreezePaneLabel":"Freeze worksheet panes","_WorksheetFreezePaneLabel.comment":"Text to show in a list when a worksheet pane freeze user action was taken during script recording","WorksheetFreezeRowsLabel":"Freeze worksheet rows","_WorksheetFreezeRowsLabel.comment":"Text to show in a list when a worksheet row freeze user action was taken during script recording","WorksheetFreezeColumnsLabel":"Freeze worksheet columns","_WorksheetFreezeColumnsLabel.comment":"Text to show in a list when a worksheet column freeze user action was taken during script recording","WorksheetHideGridlinesLabel":"I hid the gridlines on worksheet ${sheet}","_WorksheetHideGridlinesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetHideHeadingsLabel":"I hid the headings on worksheet ${sheet}","_WorksheetHideHeadingsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetOutlineLevelsSetLabel":"I set the outline level on sheet ${sheet}","_WorksheetOutlineLevelsSetLabel.comment":"Text to show in a list when an outline set user action was taken during script recording","WorksheetReapplyFiltersLabel":"Reapply filters on worksheet ${sheet}","_WorksheetReapplyFiltersLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetRenameLabel":"Rename worksheet to ${worksheetName}","_WorksheetRenameLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and worksheetName variable/placeholder is replaced by the new name of the worksheet.","WorksheetReorderLabel":"Reorder worksheet ${sheet}","_WorksheetReorderLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetSetTabColorLabel":"I set the worksheet tab color to ${color} on worksheet ${sheet}","_WorksheetSetTabColorLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and color variable/placeholder is replaced by the new tab color.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetShapeAltTextApplyLabel":"I applied an alt text to shape on sheet ${sheet}","_WorksheetShapeAltTextApplyLabel.comment":"Text to show in a list when an shape alt text apply user action was taken during script recording","WorksheetShapeInsertedLabel":"I created a shape on sheet ${sheet}","_WorksheetShapeInsertedLabel.comment":"Text to show in a list when a create shape user action was taken during script recording","WorksheetShapeRotateLabel":"Rotate shape on sheet ${sheet}","_WorksheetShapeRotateLabel.comment":"Text to show in a list when an shape rotate user action was taken during script recording","WorksheetShapeSetStyleLabel":"I set the style on shape on sheet ${sheet}","_WorksheetShapeSetStyleLabel.comment":"Text to show in a list when a shape set style user action was taken during script recording","WorksheetShapeTextChangedLabel":"I set the text on shape on sheet ${sheet}","_WorksheetShapeTextChangedLabel.comment":"Text to show in a list when a shape text changed user action was taken during script recording","WorksheetShapeTextBoldedLabel":"I bolded the text of shape on sheet ${sheet}","_WorksheetShapeTextBoldedLabel.comment":"Text to show in a list when bold style for text of a shape was changed during script recording","WorksheetShapeTextUnboldedLabel":"I unbolded the text of shape on sheet ${sheet}","_WorksheetShapeTextUnboldedLabel.comment":"Text to show in a list when bold style for text of a shape was changed during script recording","WorksheetShapeTextItalicizedLabel":"I italicized the text of shape on sheet ${sheet}","_WorksheetShapeTextItalicizedLabel.comment":"Text to show in a list when italic style for text of a shape was changed during script recording","WorksheetShapeTextUnitalicizedLabel":"I removed italics from text of shape on sheet ${sheet}","_WorksheetShapeTextUnitalicizedLabel.comment":"Text to show in a list when italic style for text of a shape was changed during script recording","WorksheetShapeTextUnderlinedLabel":"I underlined the text of shape on sheet ${sheet}","_WorksheetShapeTextUnderlinedLabel.comment":"Text to show in a list when underline style for text of a shape was changed during script recording","WorksheetShapeTextUnderlineRemovedLabel":"I removed underlining from text of shape on sheet ${sheet}","_WorksheetShapeTextUnderlineRemovedLabel.comment":"Text to show in a list when underline style for text of a shape was changed during script recording","WorksheetShapeTextFontNameChangedLabel":"I set the font name to ${fontName} for shape on sheet ${sheet}","_WorksheetShapeTextFontNameChangedLabel.comment":"Text to show in a list when font name for text of a shape was changed during script recording","WorksheetShapeTextFontSizeChangedLabel":"I set the font size to ${fontSize} for shape on sheet ${sheet}","_WorksheetShapeTextFontSizeChangedLabel.comment":"Text to show in a list when font size for text of a shape was changed during script recording","WorksheetShapeTextFontColorChangedLabel":"I set the font color to ${fontColor} for shape on sheet ${sheet}","_WorksheetShapeTextFontColorChangedLabel.comment":"Text to show in a list when font color for text of a shape was changed during script recording","WorksheetShapeTextHorizontallyAlignedLabel":"I set the horizontal alignment on shape on sheet ${sheet}","_WorksheetShapeTextHorizontallyAlignedLabel.comment":"Text to show in a list when horiontal alignment for text of a shape was changed during script recording","WorksheetShapeTextVerticallyAlignedLabel":"I set the vertical alignment on shape on sheet ${sheet}","_WorksheetShapeTextVerticallyAlignedLabel.comment":"Text to show in a list when vertical alignment for text of a shape was changed during script recording","WorksheetShowGridlinesLabel":"Show gridlines on worksheet ${sheet}","_WorksheetShowGridlinesLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetShowHeadingsLabel":"Show headings on worksheet ${sheet}","_WorksheetShowHeadingsLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetToggleAutoFilterLabel":"I changed the AutoFilter on worksheet ${sheet}","_WorksheetToggleAutoFilterLabel.comment":"User-facing string describing the Excel event executed by Copilot.  The $ and sheet variable/placeholder is replaced by the name of the sheet which was operated on.","WorksheetUnFreezePaneLabel":"Unfreeze worksheet panes","_WorksheetUnFreezePaneLabel.comment":"Text to show in a list when a worksheet pane unfreeze user action was taken during script recording","WorksheetValuesFilterAppliedLabel":"I applied a values filter to ${range}","_WorksheetValuesFilterAppliedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetVisibilityChangedLabel":"I changed the worksheet visibility","_WorksheetVisibilityChangedLabel.comment":"User-facing string describing the Excel event executed by Copilot.","MoveToEdgeLabel":"Select data region","_MoveToEdgeLabel.comment":"User-facing string describing the Excel event executed by Copilot.","WorksheetCellColorFilterLabel":"I applied a cell color filter on ${range} to show only rows that are highlighted ${color}","_WorksheetCellColorFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetFontColorFilterLabel":"I applied a font color filter on ${range} to show only rows that contain ${color} text","_WorksheetFontColorFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetTopItemsFilterLabel":"I applied a top ${criterion} filter on ${range}","_WorksheetTopItemsFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetTopPercentFilterLabel":"I applied a top ${criterion}% filter on ${range}","_WorksheetTopPercentFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetBottomItemsFilterLabel":"I applied a bottom ${criterion} filter on ${range}","_WorksheetBottomItemsFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetBottomPercentFilterLabel":"I applied a bottom ${criterion}% filter on ${range}","_WorksheetBottomPercentFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetDefaultFilterLabel":"I applied a top ${criterion} filter on ${range}","_WorksheetDefaultFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetRangeClearFiltersLabel":"I removed all filters on ${range}","_WorksheetRangeClearFiltersLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event","WorksheetColumnClearFilterLabel":"I removed a filter on ${range}","_WorksheetColumnClearFilterLabel.comment":"String which will be sent to Flex to describe the outcome of the filter event"}}')},731531:e=>{"use strict";if("undefined"==typeof perf_hooks){var t=new Error("Cannot find module 'perf_hooks'");throw t.code="MODULE_NOT_FOUND",t}e.exports=perf_hooks},734e3:(e,t,a)=>{"use strict";a.d(t,{eD:()=>A,dW:()=>R,uC:()=>O,_2:()=>N});var n=a(267324),o=a(956258),r=a(622807),i=a(719322),l=a(101576),s=a(991940),c=a(886866),d=a(661053),u=a(660449),m=a(824088),h=a(313963),g=a(551134),p=a(389833),b=a(217371),f=a(269428),C=a(38417),y=a(30312),v=a(950069),x=a(93663);const T={[r.fM.Insights]:i.uJg,[r.fM.FormulaAction]:l.vfO,[r.fM.HighlightAction]:s.RIf,[r.fM.Search]:c.CDg,[r.fM.Python]:d.Yuv,[r.fM.HowToSum]:c.CDg,[r.fM.DataPreparation]:s.RIf,[r.Ki.SuggestColumn]:u.pZh,[r.Ki.WriteFormula]:s.RIf,[r.Ki.AddFormulaColumn]:m.Y8t,[r.Ki.ExplainFormula]:h.rof,[r.Ki.InvestigateError]:g.TRI,[r.Ki.SplitColumns]:u.hX8,[r.Ki.TotalRow]:g.Kdk,[r.Ki.LookupFormula]:g.Vz1,[r.Oc.GetDataInsights]:d.zJX,[r.Oc.AdvancedAnalysis]:d.Yuv,[r.Oc.EditPythonCode]:s.RIf,[r.Oc.PerformForecasting]:d.vS8,[r.Oc.CreateBoxplot]:d.O11,[r.Oc.SetOfCharts]:l.NOv,[r.Oc.GenerateWordCloud]:p.VJB,[r.Tz.CreateTable]:g.X_q,[r.Tz.KeyboardShortcuts]:b.YWy,[r.Tz.TipsAndTricks]:g.lHS,[r.Tz.FreezeColumn]:g.NFJ,[r.Tz.HowToCreateDropdown]:c.CDg,[r.iT.SummarizeColumn]:f.QXr,[r.iT.ShowDataInsights]:d.SZA,[r.iT.CreatePivotTable]:C.pnR,[r.iT.CreatePieChart]:d.BGz,[r.iT.GenerateGraph]:c.XQT,[r.iT.HighlightCells]:p.jEr,[r.iT.ApplyColorCoding]:y.fFI,[r.YA.WebSearchCreateTable]:g.Vz1,[r.YA.WebSearchLearn]:v.ITY,[r.YA.ImportTable]:C.kMD,[r.YA.PrepareForMeetings]:x.vmL,[r.YA.RecapEmails]:g.GOF};var S=a(528804),w=a(48093),E=a(9847),I=a(108869);const R=()=>{const e=(0,S.wpe)(),t=(0,S.B8x)()&&!(0,I.$)();return{[r.fM.FormulaAction]:(0,n.$dh)(),[r.fM.Insights]:(0,n.zp5)(),[r.fM.Python]:e?(0,n.H5o)():t?(0,n.fkZ)():(0,n.ONP)(),[r.fM.HighlightAction]:(0,n.jI0)(),[r.fM.Search]:(0,n.IZv)(),[r.fM.HowToSum]:(0,n.Ghz)(),[r.fM.DataPreparation]:(0,n.On3)()}},A=()=>({...R(),[r.X6.SuggestColumn]:(0,n.VG_)(),[r.X6.WriteFormula]:(0,n.K0f)(),[r.X6.AddFormulaColumn]:(0,n.ztP)(),[r.X6.ExplainFormula]:(0,n.qAx)(),[r.X6.InvestigateError]:(0,n.C_C)(),[r.X6.SplitColumns]:(0,n._zy)(),[r.X6.TotalRow]:(0,n.KtU)(),[r.X6.LookupFormula]:(0,n.f00)(),[r.X6.GetDataInsights]:(0,n.N_T)(),[r.X6.AdvancedAnalysis]:(0,n.Bzb)(),[r.X6.EditPythonCode]:(0,n.d0n)(),[r.X6.PerformForecasting]:(0,n.xf7)(),[r.X6.CreateBoxplot]:(0,n.pKA)(),[r.X6.SetOfCharts]:(0,n.YYh)(),[r.X6.GenerateWordCloud]:(0,n.Coj)(),[r.X6.CreateTable]:(0,n.BhF)(),[r.X6.KeyboardShortcuts]:(0,n.hCI)(),[r.X6.TipsAndTricks]:(0,n.DqS)(),[r.X6.FreezeColumn]:(0,n.U7J)(),[r.X6.HowToCreateDropdown]:(0,n._ok)(),[r.X6.SummarizeColumn]:(0,n.kvY)(),[r.X6.ShowDataInsights]:(0,n.WNU)(),[r.X6.CreatePivotTable]:(0,n.QHr)(),[r.X6.CreatePieChart]:(0,n.wwj)(),[r.X6.GenerateGraph]:(0,n.esl)(),[r.X6.HighlightCells]:(0,n.aW0)(),[r.X6.ApplyColorCoding]:(0,n.bgS)(),[r.X6.WebSearchCreateTable]:(0,n.rnM)(),[r.X6.WebSearchLearn]:(0,n._xk)(),[r.X6.ImportTable]:(0,n._BM)(),[r.X6.PrepareForMeetings]:(0,n.ST4)(),[r.X6.RecapEmails]:(0,n.tMQ)()});function L(){return{[r.fM.Insights]:n.hn.menuSectionUnderstand(),[r.fM.FormulaAction]:n.hn.menuSectionCreate(),[r.fM.HighlightAction]:n.hn.menuSectionEdit(),[r.fM.Search]:(0,n._JR)(),[r.fM.Python]:(0,n.vNK)(),[r.fM.HowToSum]:(0,n._JR)(),[r.fM.DataPreparation]:(0,n.lun)(),[r.X6.SuggestColumn]:(0,n.UXx)(),[r.X6.WriteFormula]:(0,n.ptM)(),[r.X6.AddFormulaColumn]:(0,n.KsV)(),[r.X6.ExplainFormula]:(0,n.no)(),[r.X6.InvestigateError]:(0,n.$OL)(),[r.X6.SplitColumns]:(0,n.xOV)(),[r.X6.TotalRow]:(0,n.nHd)(),[r.X6.LookupFormula]:(0,n.itS)(),[r.X6.GetDataInsights]:(0,n.I1u)(),[r.X6.AdvancedAnalysis]:(0,n.Oz3)(),[r.X6.EditPythonCode]:(0,n.qag)(),[r.X6.PerformForecasting]:(0,n.sqX)(),[r.X6.CreateBoxplot]:(0,n.E9A)(),[r.X6.SetOfCharts]:(0,n.xMZ)(),[r.X6.GenerateWordCloud]:(0,n.D8x)(),[r.X6.CreateTable]:(0,n.ixU)(),[r.X6.KeyboardShortcuts]:(0,n.wvv)(),[r.X6.TipsAndTricks]:(0,n.qhm)(),[r.X6.FreezeColumn]:(0,n.Z2X)(),[r.X6.HowToCreateDropdown]:(0,n.Z2X)(),[r.X6.SummarizeColumn]:(0,n.XAy)(),[r.X6.ShowDataInsights]:(0,n.NyX)(),[r.X6.CreatePivotTable]:(0,n.D02)(),[r.X6.CreatePieChart]:(0,n.BIf)(),[r.X6.GenerateGraph]:(0,n.roM)(),[r.X6.HighlightCells]:(0,n.lFW)(),[r.X6.ApplyColorCoding]:(0,n.gsW)(),[r.X6.WebSearchCreateTable]:(0,n.Qhk)(),[r.X6.WebSearchLearn]:(0,n.r3R)(),[r.X6.ImportTable]:(0,n.nby)(),[r.X6.PrepareForMeetings]:(0,n.vJt)(),[r.X6.RecapEmails]:(0,n._0P)()}}function k(){return{[r.fM.Insights]:!0,[r.fM.FormulaAction]:!0,[r.fM.HighlightAction]:!1,[r.fM.Search]:!1,[r.fM.Python]:!0,[r.fM.HowToSum]:!1,[r.fM.DataPreparation]:!0,[r.X6.SuggestColumn]:!0,[r.X6.WriteFormula]:!1,[r.X6.AddFormulaColumn]:!1,[r.X6.ExplainFormula]:!1,[r.X6.InvestigateError]:!1,[r.X6.SplitColumns]:!1,[r.X6.TotalRow]:!1,[r.X6.LookupFormula]:!1,[r.X6.GetDataInsights]:!0,[r.X6.AdvancedAnalysis]:!0,[r.X6.EditPythonCode]:!1,[r.X6.PerformForecasting]:!1,[r.X6.CreateBoxplot]:!0,[r.X6.SetOfCharts]:!0,[r.X6.GenerateWordCloud]:!0,[r.X6.CreateTable]:!0,[r.X6.KeyboardShortcuts]:!0,[r.X6.TipsAndTricks]:!0,[r.X6.FreezeColumn]:!0,[r.X6.HowToCreateDropdown]:!0,[r.X6.SummarizeColumn]:!1,[r.X6.ShowDataInsights]:!0,[r.X6.CreatePivotTable]:!1,[r.X6.CreatePieChart]:!0,[r.X6.GenerateGraph]:!1,[r.X6.HighlightCells]:!1,[r.X6.ApplyColorCoding]:!1,[r.X6.WebSearchCreateTable]:!0,[r.X6.WebSearchLearn]:!0,[r.X6.ImportTable]:!1,[r.X6.PrepareForMeetings]:!0,[r.X6.RecapEmails]:!0}}const F=(0,S.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")?(0,I.XT)():(0,I.gx)(),_=(0,S.ggM)()&&(0,S.yw9)("OfficeVSO_10277196_AnswersSkipLicenseCheckFixed")?(0,I.XT)():(0,I.gx)(),P={[r.fM.Search]:()=>(0,w.pX)(),[r.fM.Python]:()=>(0,S.H2A)()&&(0,I.gx)(),[r.fM.DataPreparation]:()=>(0,S.eFk)()&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableDataPreparationZQM",!1),[r.fM.HowToSum]:()=>(0,S.Qyj)(),[r.X6.GetDataInsights]:()=>(0,S.H2A)()&&F&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableGetDataInsightsRotatingZQM",!1),[r.X6.AdvancedAnalysis]:()=>(0,S.H2A)()&&_&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableAdvancedAnalysisRotatingZQM",!1),[r.X6.EditPythonCode]:()=>(0,S.H2A)()&&(0,I.gx)()&&(0,S.GqX)()&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableEditPythonCodeRotatingZQM",!1),[r.X6.PerformForecasting]:()=>(0,S.H2A)()&&F&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisablePerformForecastingRotatingZQM",!1),[r.X6.CreateBoxplot]:()=>(0,S.H2A)()&&F&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableCreateBoxplotRotatingZQM",!1),[r.X6.SetOfCharts]:()=>(0,S.H2A)()&&F&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableSetOfChartsRotatingZQM",!1),[r.X6.GenerateWordCloud]:()=>(0,S.H2A)()&&F&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableGenerateWordCloudRotatingZQM",!1),[r.X6.CreateTable]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableCreateTableRotatingZQM",!1),[r.X6.KeyboardShortcuts]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableKeyboardShortcutsRotatingZQM",!1),[r.X6.TipsAndTricks]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableTipsAndTricksRotatingZQM",!1),[r.X6.FreezeColumn]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableFreezeColumnRotatingZQM",!1),[r.X6.HowToCreateDropdown]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableHowToCreateDropdownRotatingZQM",!1),[r.X6.WriteFormula]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableWriteFormulaRotatingZQM",!1),[r.X6.SummarizeColumn]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableSummarizeColumnRotatingZQM",!1),[r.X6.ShowDataInsights]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableShowDataInsightsRotatingZQM",!1),[r.X6.CreatePivotTable]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableCreatePivotTableRotatingZQM",!1),[r.X6.CreatePieChart]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableCreatePieChartRotatingZQM",!1),[r.X6.GenerateGraph]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableGenerateGraphRotatingZQM",!1),[r.X6.HighlightCells]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableHighlightCellsRotatingZQM",!1),[r.X6.ApplyColorCoding]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableApplyColorCodingRotatingZQM",!1),[r.X6.SuggestColumn]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableSuggestColumnRotatingZQM",!1),[r.X6.AddFormulaColumn]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableAddFormulaColumnRotatingZQM",!1),[r.X6.ExplainFormula]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableExplainFormulaRotatingZQM",!1),[r.X6.InvestigateError]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableInvestigateErrorRotatingZQM",!1),[r.X6.SplitColumns]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableSplitColumnsRotatingZQM",!1),[r.X6.TotalRow]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableTotalRowRotatingZQM",!1),[r.X6.LookupFormula]:()=>!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableLookupFormulaRotatingZQM",!1),[r.X6.WebSearchCreateTable]:()=>(0,w.gc)()&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableWebSearchCreateTableRotatingZQM",!1),[r.X6.WebSearchLearn]:()=>(0,w.gc)()&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableWebSearchLearnRotatingZQM",!1),[r.X6.ImportTable]:()=>(0,w.pX)()&&(0,S.iPS)("Microsoft.Office.Excel.FA000000124.EnableImportTableRotatingZQM",!1),[r.X6.PrepareForMeetings]:()=>(0,w.pX)()&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisablePrepareForMeetingsRotatingZQM",!1),[r.X6.RecapEmails]:()=>(0,w.pX)()&&!(0,S.iPS)("Microsoft.Office.Excel.FA000000124.DisableRecapEmailsRotatingZQM",!1)};function N(e){return(P[e]??(()=>!0))()}function M(e){const t={[(0,n.VG_)()]:"SuggestColumn",[(0,n.K0f)()]:"WriteFormula",[(0,n.ztP)()]:"AddFormulaColumn",[(0,n.qAx)()]:"ExplainFormula",[(0,n.C_C)()]:"InvestigateError",[(0,n._zy)()]:"SplitColumns",[(0,n.KtU)()]:"CreateTotalRow",[(0,n.f00)()]:"WriteLookupFormula",[(0,n.N_T)()]:"GetDataInsights",[(0,n.Bzb)()]:"AdvancedAnalysis",[(0,n.d0n)()]:"EditPythonCode",[(0,n.xf7)()]:"PerformForecasting",[(0,n.pKA)()]:"CreateBoxplot",[(0,n.YYh)()]:"SetOfCharts",[(0,n.Coj)()]:"GenerateWordCloud",[(0,n.BhF)()]:"CreateTable",[(0,n.hCI)()]:"KeyboardShortcuts",[(0,n.DqS)()]:"TipsAndTricks",[(0,n.U7J)()]:"FreezeColumn",[(0,n._ok)()]:"HowToCreateDropdown",[(0,n.kvY)()]:"SummarizeColumn",[(0,n.WNU)()]:"ShowDataInsights",[(0,n.QHr)()]:"CreatePivotTable",[(0,n.wwj)()]:"CreatePieChart",[(0,n.esl)()]:"GenerateGraph",[(0,n.aW0)()]:"HighlightCells",[(0,n.bgS)()]:"ApplyColorCoding",[(0,n.rnM)()]:"WebSearchCreateTable",[(0,n._xk)()]:"WebSearchLearn",[(0,n._BM)()]:"ImportTable",[(0,n.ST4)()]:"PrepareForMeetings",[(0,n.zp5)()]:"Insights",[(0,n.$dh)()]:"FormulaAction",[(0,n.jI0)()]:"HighlightAction",[(0,n.IZv)()]:"Search",[(0,n.ONP)()]:"Python",[(0,n.Ghz)()]:"HowToSum",[(0,n.On3)()]:"DataPreparation",[(0,n.tMQ)()]:"RecapEmails"}[e];t&&o.M.getInstance().logEvent((0,E.nE)(t))}function O(e=[],t=()=>{}){const a=e=>{M(e.suggestionText)},n=(0,S.GKX)();if(e.length>0&&n){return{promptSuggestionList:e.filter((e=>N(e))).map((e=>({suggestionText:A()[e],suggestionCategory:L()[e],iconRegular:T[e],shouldSubmitQueryOnClick:k()[e],notifyClientOnZQMClicked:a}))),showRefreshButton:n,handleRefreshButtonClick:t,showBranding:!1}}return{promptSuggestionList:Object.entries(R()).filter((([e,t])=>N(e))).map((([e,t])=>({suggestionText:t,suggestionCategory:L()[e],iconRegular:T[e],shouldSubmitQueryOnClick:k()[e],notifyClientOnZQMClicked:a}))),showRefreshButton:!1,handleRefreshButtonClick:t,showBranding:!1}}},743352:(e,t,a)=>{"use strict";a.d(t,{L7:()=>f,Si:()=>g,VL:()=>b,sR:()=>p});var n=a(449650),o=a(48494),r=a(146156),i=a(261452),l=a(417929);const s={type:l.default.automin,formula:"",number:0},c={type:l.default.automax,formula:"",number:0},d={borderColor:"#FF0000",borderStyle:n.BorderLineStyle.Thin,borderWeight:o.BorderWeight.thin,scaleFactor:.25,defaultHeightWidth:15,fontColor:"#000000",fontSizeChange:2},u={isGradientFill:!0,borderColor:null,fillColor:"#FFFF00",isLTRDirection:!0,isNegativeValuesFillColorCustom:!1,negativeValuesFillColor:"#FFFF00",isNegativeValuesBorderColorCustom:!1,negativeValuesBorderColor:null,isShowValueEnabled:!0,axisColor:"#000000",axisPositionType:i.default.none,minBoundCFObjectValues:s,maxBoundCFObjectValues:c,minimumColorDeprecated:"#FF0000",minimumColor:"#F8696B",maximumColorDeprecated:"#00FF00",maximumColor:"#63be7b",midpointColor:"",maximumCFObjectValues:{type:l.default.max,formula:null,number:0},midpointCFObjectValuesDeprecated:{type:l.default.percent,formula:"=50",number:0},midpointCFObjectValues:{type:l.default.percentile,formula:"=50",number:50},minimumCFObjectValues:{type:l.default.min,formula:null,number:0},shouldGenerateGetRule:!1,defaultCustomFormat:{BackgroundColor:null,TextColor:"#000000",IsTextBold:!1,IsTextItalic:!1,IsTextStrikethrough:!1,IsTextUnderlined:!1,IsTextDoubleUnderlined:!1,BorderFormat:{Position:15,LineStyle:[n.BorderLineStyle.None,n.BorderLineStyle.None,n.BorderLineStyle.None,n.BorderLineStyle.None],Color:[0,0,0,0],ThemeBorderColor:[{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0},{ThemeColorIndex:0,ThemeColorRow:0}],ColorTypeOption:r.hU.rgbColor,Thickness:[0,0,0,0]},PreserveBackgroundColor:!1,PreserveTextColor:!1},BorderStyle:n.BorderLineStyle.Thin,defaultBackgroundColor:"#FFFF00",topBottomRank:10,topBottomType:"topItems"},m={"#FF0000":"#FF555A","#00FF00":"#63BE7B","#FFFF00":"#FFEF9C","#FFFFFF":"#FCFCFF","#0000FF":"#5A8AC6","#FFC0CB":"#FFC7CE","#8B0000":"#9C0006","#006400":"#63BE7B","#4169E1":"#5A8AC6","#FFA500":"#FCBF7B"},h={isAscending:!0,caseMatch:!1};function g(e){return d[e]}function p(e){return u[e]}function b(e){return h[e]}function f(e){return e in m?m[e]:e}},750927:(e,t,a)=>{"use strict";function n(e,...t){return e.replace(/{(\d+)}/gm,((e,a)=>{const n=parseInt(a,10);return t[n]?t[n]:""}))}a.d(t,{L:()=>n})},754440:(e,t,a)=>{"use strict";var n;a.d(t,{W:()=>n}),function(e){e.Copilot_Canvas_Pane_Failed_To_Load="Copilot Canvas Pane Failed to Load",e.Copilot_Chat_Pane_Failed_To_Load="Copilot Chat Pane Failed to Load",e.LLM_Service_Side_Issue_Prevents_Output="LLM Service Side Issue Prevents Output",e.Missing_Copilot_Functionality="Missing Copilot Functionality",e.Referencing_A_File_Failed="Referencing a File Failed",e.Response_Delayed_Or_Timed_Out="Response Delayed or Timed Out",e.Responsible_AI_Filter_Blocked_Response="Responsible AI Filter Blocked Response",e.UI_Failed_To_Update_Or_Load="UI Failed to Update or Load",e.Unable_To_Complete_Task="Unable to Complete Task",e.Unable_To_Generate_Response_Due_To_Capacity_Issue="Unable to Generate Response Due to Capacity Issue",e.Unclassified_ASHA_Error="Unclassified ASHA Error",e.Unclassified_Chat_Failure="Unclassified Chat Failure",e.User_Access_Issue_For_Copilot="User Access Issue for Copilot",e.User_Input_Could_Not_Be_Processed="User Input Could Not Be Processed",e.User_Rejected_Or_Cancelled_Response="User Rejected or Cancelled Response"}(n||(n={}))},755005:(e,t,a)=>{"use strict";var n,o,r,i;a.d(t,{UW:()=>n,lp:()=>o,px:()=>r,qf:()=>i}),function(e){e.AbortError="AbortError"}(n||(n={})),function(e){e.StandardTable="StandardTable",e.TableLikeRange="TableLikeRange",e.Range="Range"}(o||(o={})),function(e){e.SinglePythonObjectCell="SinglePythonObjectCell",e.SingleExcelValueCell="SingleExcelValueCell",e.SpilledExcelValueCell="SpilledExcelValueCell"}(r||(r={})),function(e){e.Error="Error",e.PngImageFile="<class 'PIL.PngImagePlugin.PngImageFile'>",e.ImageFile="<class 'PIL.Image.Image'>",e.None="<class 'NoneType'>",e.PythonPlot="<class 'excel.pythonplots.PlotlyPlot'>",e.MatplotlibPlot="<class 'excel.pythonplots.MatplotlibPlot'>"}(i||(i={}))},755657:(e,t,a)=>{"use strict";a.d(t,{Uk:()=>v,aW:()=>C});var n=a(822606),o=a(881707),r=a(322466),i=a(700853),l=a(63919),s=a(83437),c=a(660606),d=a(423905),u=a(241273),m=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},h=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},g=!1,p=function(){return g},b=function(e){(0,c.cY)("setting ClpOfficeJSApiError to ".concat(e)),g=e},f=!1;function C(){return m(this,void 0,void 0,(function(){var e,t;return h(this,(function(a){switch(a.label){case 0:return!c.t6.IsClpEnabledInEnterpriseForSydney()||(null===(t=c.t6.IsCopilotInBackstageMode)||void 0===t?void 0:t.call(c.t6))?[3,3]:(f=!0,[4,o.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]);case 1:return e=a.sent(),[4,o.n.getInstance().getHighestDocumentSensitivityInfo([o.n.getInstance().getInDocSensitiveLabelInfo(),e])];case 2:if(a.sent(),p())return b(!1),f=!1,[2,!1];a.label=3;case 3:return f=!1,[2,!0]}}))}))}function y(e,t){var a,n={chatEventType:s.a5.OfficeJsApiCallForCLPError,chatEventParam:"OfficeJsApiCallForCLP",chatErrorType:s.T_.Client,ashaErrorDetails:{vetoName:(0,d.CI)(s.kD.UnclearIntent,s.G8.UserInputIssue),errorString:s.av.SensitivityExecutionFailed,featureName:s.CC.CopilotChat}};null===(a=null==e?void 0:e.current)||void 0===a||a.addResponseMessage(function(e,t,a,n,s){void 0===s&&(s=!0);var u={shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,showAnimation:!1,isFailure:!0,telemetryData:n?(0,d.YI)(n):void 0},m=!0,h=o.n.getInstance();(null==h?void 0:h.getShouldStopLoadingUi)&&(m=h.getShouldStopLoadingUi());var g={chatCardType:i._.Default,chatMessageData:{defaultMessageProps:{user:l.Q9.Chat,messageHeader:{text:e}}},chatMessageBodyData:u,stopLoadingUi:m,startAugloopTimerForStreaming:!1,addCardToChatHistory:s};return(0,d.IT)(t,a,!0),(0,c.cY)("CLP error response message: ".concat(g)),g}(t,!0,n))}function v(e,t,a,r){var i,l,m;if(null===(m=null==e?void 0:e.current)||void 0===m?void 0:m.getIsExecuting()){var h=function(e,t){switch(e){case u.YY.ApplyLabelUnsupportedCrossTenantErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.Sh)();case u.YY.ApplyLabelDocumentReadOnlyErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.w3)();case u.YY.ApplyLabelInsufficientPermissionErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.bX)();case u.YY.ApplyLabelLabelDisabledErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.pS)();case u.YY.ApplyLabelUnsupportedUdpErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.hf)();case u.YY.ApplyLabelLabelingDisabledErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.f4)();case u.YY.ApplyLabelUnsupportedContentTypeErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.TZ)();case u.YY.ApplyLabelUnsupportedDkeErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.O1)();case u.YY.ApplyLabelLabelNotFoundErrorCode:case u.YY.ErrorCode2147647531:return t===u.OZ.CLP_Get?n.u1:(0,n.aE)();case u.YY.OsfControlContainerErrorCode:case u.YY.OfficeSolutionFrameworkHostErrorCode:case u.YY.DocCookieErrorCode:case u.YY.HostIntegrationManagerErrorCode:case u.YY.MsoOLDocumentErrorCode:case u.YY.ClpSessionErrorCode:return(0,n.VQ)();case u.YY.OMWorkflowUserNotFoundErrorCode:return(0,n.W2)();case u.YY.OMOfficePerpetualNotSupportedErrorCode:return(0,n.MH)();case u.YY.LabelingDisabledProtectedViewErrorCode:return(0,n.s_)();case u.YY.LabelingDisabledAppguardErrorCode:return(0,n.Ng)();case u.YY.LabelingDisabledPrivacySettingsErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.KA)();case u.YY.LabelingDisabledUnsupportedLabelClientErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.H9)();case u.YY.LabelingDisabledNoSignedInClpCompatibleUsersErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.oM)();case u.YY.OMOfficeClientNotLicensedForLabelingErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.kB)();case u.YY.PolicyManagerUnavailableErrorCode:return t===u.OZ.CLP_Get?n.u1:(0,n.VQ)();case u.YY.ApplyLabelNewLabelSensitivityOrderErrorCode:return n.u1;case u.YY.ErrorCode2147500033:default:return t===u.OZ.CLP_Get?n.u1:(0,n.VQ)()}}(t,a);if(h){f&&b(!0),(0,c.cY)("clp error: ".concat(h)),y(e,h);var g=!0,p=o.n.getInstance();(null==p?void 0:p.getShouldStopLoadingUi)&&(g=p.getShouldStopLoadingUi()),r&&g&&r(),c.EG.sendChatEventTelemetry((0,d.pN)(((i={})[s.h3.ChatEventType]=s.a5.CLPErrorShown,i[s.h3.ChatEventParameters]=a+"_"+t,i)))}else(0,c.cY)("clp error string is empty"),c.EG.sendChatEventTelemetry((0,d.pN)(((l={})[s.h3.ChatEventType]=s.a5.CLPErrorIgnored,l[s.h3.ChatEventParameters]=a+"_"+t,l)));return h}return n.u1}},762542:(e,t,a)=>{"use strict";a.d(t,{M:()=>f,m:()=>y});var n=a(725556),o=(a(117463),a(944032)),r=a(965634),i=a(654417),l=a(486092),s=a(808169),c=a(70100),d=a(208520),u=a(528804),m=a(202051),h=a(108869),g=a(977055),p=a(209980);const b=(0,d.lazy)((()=>Promise.all([a.e("monaco-editor","high"),a.e("vendors-npm_store_sdx_officecopilot_monaco-editor_0_46_0-51dbdf7e44e9cf33acc3_node_modules_mo-e5e20f","high"),a.e("monacoreadonly","high")]).then(a.bind(a,364130)))),f=1,C=()=>Office.context.platform===Office.PlatformType.Mac&&!(0,u.yw9)("OfficeVSO_9770243_MacCopyButtonFix");function y(e){const{requestId:t,codeExplanation:a,code:u}=e,y=(0,p.E)();return(0,n.jsx)(o.lJ,{contentBody:(0,n.jsx)(c.B,{tokens:{childrenGap:8},className:(0,l.z)(y.pythonRecommendation,"python-recommendation"),children:(0,n.jsx)(d.Suspense,{fallback:(0,n.jsx)(s.y,{}),children:(0,n.jsx)(i.$,{title:"Python",content:(0,n.jsx)(b,{code:u}),getClipboardItem:C()?void 0:()=>async function(e){let t=new ClipboardItem({"text/plain":""});try{const a=(0,h.ZK)(e,!1,f);t=new ClipboardItem({"text/plain":new Blob([a],{type:"text/plain"})}),(0,g.PB)(r.L3.CopyButtonClicked,[])}catch(e){const t=(0,m.LH)(e);(0,m.QX)(null,t,!1)}return t}(u),explanation:a?{explanation:a}:void 0})})}),requestId:t})}},764081:(e,t,a)=>{"use strict";a.d(t,{$H:()=>u,Nz:()=>l,OY:()=>i,Qt:()=>o,ag:()=>s,fH:()=>m,oY:()=>n,pL:()=>h,qj:()=>d,t9:()=>r,yT:()=>c});var n="TaskViewMode",o=80,r=55,i=50,l=70,s=50,c=35,d=70,u=50,m=35,h="c0ab8ce9-e9a0-42e7-b064-33d422df41f1"},767176:(e,t,a)=>{"use strict";e.exports=a.p+"assets/send-button-icon.svg"},771496:(e,t,a)=>{"use strict";a.d(t,{fB:()=>l,ps:()=>h,q3:()=>i,tJ:()=>r});var n=a(586446),o=a(777179);function r(e){return e.some((e=>"secondary"===e.valueAxisGroup))}function i(e){return!!r(e)&&e.some((e=>"line"===e.layout&&"primary"===e.valueAxisGroup))}function l(e,t){const a=(0,n.Q)(e,0,"categories"),o=!!a&&!!a.formatInfo&&a.formatInfo.isDateTime,r=!!a&&a.values.raw.every((e=>"number"==typeof e));if("values"===t.dimension&&i(e.series)&&o&&r){const a="primary"===t.axisGroup?"secondary":"primary";return e.axes.find((e=>e.dimensionType===t.dimension&&e.axisGroup===a))}return e.axes.find((e=>e.dimensionType===t.dimension&&e.axisGroup===t.axisGroup))}const s=10,c=1/6,d=.05,u=1.5,m=6;function h(e,t,a,n){const r=(0,o.r)(e,t,a);if(null===r)return null;const i=r.max-r.min;if(i<0)throw new Error("Invalid MinMax: max should not be less than min");if(0===i){if(0===r.min)return{minimum:0,maximum:1};r.min<0?r.max=0:r.min=0}let l=r.max,s=r.min;if(s>0||l<0){const e=s>0?l:Math.abs(s),t=l-s;t>e/m?s>0?s=0:l=0:s>0?s-=t/2:l+=t/2}const h=l-s,p=(1+d)*h,b=d*h,f=p*u;let C,y;const v=e=>{s=s-r.min+b>0?r.min-b:s;const t=g(e||-1*s);return Math.floor(s/t)*t},x=e=>{l=l-r.max-b<0?r.max+b:l;const t=g(e||l);return Math.ceil(l/t)*t};if(l>0&&s<0)C=v(p),y=x(p);else if(l>0){h<c*l&&!n?(C=v(f),y=x(f)):(C=0,y=x())}else if(s<0){h<-1*c*s&&!n?(C=v(f),y=x(f)):(C=v(),y=0)}return void 0!==C&&void 0!==y?{minimum:C,maximum:y}:null}function g(e){const t=[.1,.2,.5,1,2,5,10],{base:a,exponent:n}=function(e){if(e<0)throw new Error("Input number should be greater than or equal to 0");if(0===e)return{base:0,exponent:0};const t=Math.floor(Math.log10(e)),a=e/s**t;return{base:a,exponent:t}}(e);for(let e=t.length-1;e>1;--e)if(a>t[e]){return t[e-2]*s**n}return t[0]*s**n}},774370:(e,t,a)=>{"use strict";a.d(t,{f:()=>f,O:()=>C});var n=a(252610),o=a(267324),r=a(390624),i=a(79458);class l{reset(){this.batchProcessors=[],this.apiCalls=[]}tryCollectBatchesAndHitlDescription(e){return!!this.appendApiCalls(e)&&(this.batchProcessors.push(e),!0)}async applyLastBatches(){if(0===this.batchProcessors.length)return{success:!1,errorMessage:"No batch processors available to apply"};try{await(0,r.$r)((0,o.Eyh)())}catch(e){return{success:!1,errorMessage:"Error opening undoscope: "+JSON.stringify(e)}}try{const e=this.batchProcessors[this.batchProcessors.length-1];await e.applyBatches(),await(0,r.TA)()}catch(e){try{await(0,r.TA)({rollback:!0})}catch(e){return{success:!1,errorMessage:"Error closing undo scope and undoing changes: "+JSON.stringify(e)}}return{success:!1,errorMessage:"Error applying changes: "+JSON.stringify(e)}}return{success:!0}}async applyAllBatches(){try{await(0,r.$r)((0,o.Eyh)())}catch(e){return{success:!1,errorMessage:`Error opening undoscope: ${e}`}}try{for(const e of this.batchProcessors)await e.applyBatches();await(0,r.TA)()}catch(e){try{await(0,r.TA)({rollback:!0})}catch(e){return{success:!1,errorMessage:"Error closing undo scope and undoing changes: "+JSON.stringify(e)}}return{success:!1,errorMessage:"Error applying changes: "+JSON.stringify(e)}}return{success:!0}}getHitlDescription(){return n.i.generateDescription(this.apiCalls)}appendApiCalls(e){const t=e.getApiCalls();return(0,i.cY)("[1mAPI Call Summary:[0m",JSON.stringify(t)),0!==t.length&&(this.apiCalls.push(...t),!0)}constructor(){this.batchProcessors=[],this.apiCalls=[]}}var s=a(83437),c=a(167447),d=a(715540),u=a(965634),m=a(956258),h=a(173339),g=a(883),p=a(528804),b=a(940096);class f extends Error{constructor(e){super(e),this.name="ExecuteOfficeJsRawError"}}class C{createSystemErrorExecutionResult(e){return m.M.getInstance().logError({eventType:u.S2.ChatEvents,errorMessage:e??"createSystemErrorExecutionResult: Unknown error",logLevel:s.$b.Error}),{success:!1,result:e?{error:e}:{},documentChanges:"",apiDescriptionHeader:"",apiDescriptions:[]}}clearChangeCollectors(){this.changeCollectors.clear()}clearChangeCollectorForCaller(e){this.changeCollectors.delete(e)}addOrResetChangeCollector(e){this.changeCollectors.has(e)?this.changeCollectors.get(e)?.reset():this.changeCollectors.set(e,new l)}async executeScript(e,t){this.changeCollectors.has(t)||this.changeCollectors.set(t,new l);const a=this.changeCollectors.get(t);if(!a)return(0,g.debuglog)(`Cannot start change collector for: ${t}`),this.createSystemErrorExecutionResult(`Cannot start change collector for: ${t}`);let o;const r=new c.p(this.dataLocale,t);try{const i=await this.wrapRawOfficeJsScript(e);await this.runtimeHelper.prepareCustomParams(i,void 0,r?.makeBatchHandler());const l=await this.runScriptWithTimeoutAsync(this.runtimeHelper);o=this.decodeScriptResponse(l);if((a.tryCollectBatchesAndHitlDescription(r)||!(0,p.yw9)("OfficeVSO_10497180_directApplyAfterCollection"))&&(0,p.iPS)("Microsoft.Office.Excel.FA000000124.DirectApplyExcelAgentChanges",!1)&&"excelAgent"===t){const e=await a.applyLastBatches();if(!e.success)return(0,g.debuglog)(`Error applying last batch: ${e.errorMessage}`),this.createSystemErrorExecutionResult(`Error applying last batch: ${e.errorMessage}`)}const s=a.getHitlDescription();return{success:!0,result:{response:o},documentChanges:JSON.stringify(n.i.generateDocumentChanges(r.getApiCalls())),apiDescriptionHeader:s.header,apiDescriptions:s.descriptions}}catch(e){return(0,g.debuglog)(`Error executing script: ${e}`),e instanceof f?{success:!0,result:{error:e.message},documentChanges:"",apiDescriptionHeader:"",apiDescriptions:[]}:this.createSystemErrorExecutionResult("Unexpected catastrophic error during script execution")}}async applyAllBatches(e){const t=this.changeCollectors.get(e);return t?await t.applyAllBatches():{success:!1,errorMessage:`No change collector found for: ${e}`}}decodeScriptResponse(e){if("string"==typeof e||void 0===e)return e;if("object"==typeof e&&!Array.isArray(e)&&null!==e&&"error"in e){const t=JSON.stringify(e.error);throw m.M.getInstance().logError({eventType:u.S2.ChatEvents,errorMessage:JSON.stringify(e.error),logLevel:s.$b.Error}),new f(t)}return JSON.stringify(e,((e,t)=>void 0===t?null:t))}async runScriptWithTimeoutAsync(e){let[t,a]=this.makeCancelableTimer();return t=t.catch((t=>{throw e.terminateCurrentRun(),t})),Promise.race([t,e.executeScript()]).finally(a)}makeCancelableTimer(){let e=()=>{};return[new Promise(((t,a)=>{const n=setTimeout((()=>{a(new f(C.ERROR_STRING_TIMEOUT))}),h.R.getScratchpadScriptExecutionTimeout());e=()=>clearTimeout(n)})),e]}async wrapRawOfficeJsScript(e){const t=e.match(/await\s+Excel\.run\s*\(((?:.|\n)*?)\);?(?:\s|\n)*$/);if(!t)throw new f("OfficeJS code not in expected format");return`async function main(context) {\n        let firstError = null;\n        const extractError = (value) => {\n            if (typeof value === "object") {\n                if (Array.isArray(value)) {\n                    return value.map((v) => extractError(v));\n                }\n                if (value === null) {\n                    return value;\n                }\n                const properObject = {};\n                const properties = new Set(Object.getOwnPropertyNames(value));\n                for (const property of properties) {\n                    properObject[property] = value[property];\n                }\n                return properObject;\n            }\n            return value;\n        };\n        const returnValue = await (${t[1]})(context).catch(error => {\n            firstError = extractError(error);\n        });\n        await context.sync().catch(error => {\n            firstError ??= extractError(error);\n        });\n        return firstError ? { error: firstError } : returnValue;\n    }`}hasChangeCollector(e){return this.changeCollectors.has(e)}constructor(e){this.changeCollectors=new Map,this.runtimeHelper=d.b.instance(),this.dataLocale=e((0,b.Z)()).dataLocale}}C.ERROR_STRING_TIMEOUT="Timeout"},777179:(e,t,a)=>{"use strict";a.d(t,{r:()=>r});var n=a(586446),o=a(644864);function r(e,t,a){if(!(0,n.$)(t))return null;function r(e){return"number"==typeof e&&Number.isFinite(e)}let i=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,s=!1;return e.series.forEach(((c,d)=>{if(c.valueAxisGroup!==a)return;const u=(0,n.Q)(e,d,t);if(!u)return;const m="histogram"===c.layout?(0,o.Mi)(c,e.data):u.values.raw.filter(r);0!==m.length&&(i=m.reduce(((e,t)=>Math.min(e,t)),i),l=m.reduce(((e,t)=>Math.max(e,t)),l),s=!0)})),s?{min:i,max:l}:null}},789787:(e,t,a)=>{"use strict";a.d(t,{z:()=>o});var n=a(95151);const o=()=>(0,n.getDefaultClientInfo)()},795917:(e,t,a)=>{"use strict";a.d(t,{$:()=>o,d:()=>s});var n,o,r=function(e){return"object"==typeof e&&!Array.isArray(e)&&null!==e};function i(e){return Array.isArray(e)&&e.every((function(e){return"string"==typeof e}))}function l(e){if(!r(e))return!1;var t=function(e){return!e||e===o.M365CopilotChat||e===o.Researcher||e===o.Analyst||e===o.AppChat||e===o.Disabled||e===o.DataShaping}("CopilotExperience"in e?e.CopilotExperience:void 0),a=!("Upn"in e)||!e.Upn||"string"==typeof e.Upn,n=!("LicensedFeatures"in e)||!e.LicensedFeatures||i(e.LicensedFeatures),l=!("AggregatedLicensedFeatures"in e)||!e.AggregatedLicensedFeatures||i(e.AggregatedLicensedFeatures);return t&&a&&n&&l}function s(e){if(!e||!r(e))return!1;var t,a=!("PrimaryUserAccountInfo"in e&&e.PrimaryUserAccountInfo)||l(e.PrimaryUserAccountInfo),o=!("DocumentContext"in e&&e.DocumentContext)||function(e){if(!r(e))return!1;var t="FileHost"in e?e.FileHost:void 0;return!t||t===n.Local||t===n.NewDocument||t===n.ODSP||t===n.NotSet||t===n.ThirdParty}(e.DocumentContext),i=!("TrustedBrokerDomain"in e)||(!(t=e.TrustedBrokerDomain)||"string"==typeof t);return a&&o&&i}!function(e){e.NotSet="NotSet",e.Local="Local",e.NewDocument="NewDocument",e.ODSP="ODSP",e.ThirdParty="ThirdParty"}(n||(n={})),function(e){e.M365CopilotChat="M365CopilotChat",e.AppChat="AppChat",e.Researcher="Researcher",e.Analyst="Analyst",e.DataShaping="DataShaping",e.Disabled="Disabled"}(o||(o={}))},797639:(e,t,a)=>{"use strict";a.d(t,{CP:()=>Le,En:()=>Ae});var n=a(449650),o=a(255448),r=a(910480),i=a(380644),l=a.n(i),s=a(932367),c=a(754440),d=a(79458),u=a(632512),m=a(348065),h=a(644737),g=a(9847),p=a(503079),b=a(136609),f=a(267324),C=a(877825),y=a(476730),v=a(965634),x=a(956258),T=a(547131),S=a(974717),w=a(235373),E=a(906606),I=a(626128),R=a(528804),A=a(4091),L=a(703227),k=a(593688);async function F(e,t){return Excel.run({delayForCellEdit:!0},(async a=>{let r,i,l=!1;const s=a.workbook.tables.getItemOrNullObject(e);s.load(["name","id"]),a.workbook.load(["autoSave"]);const c=s.getRange().load("cellCount, columnCount, columnIndex, address");try{if(r=s.getHeaderRowRange().load("values,numberFormat,numberFormatCategories"),await a.sync(),s.isNullObject)return void x.M.getInstance().logErrorCode(u.O.GetTableContextFailed,new Error("Table is NullObject"))}catch(e){if(x.M.getInstance().logErrorCode(u.O.GetTableContextFailed,e),e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.itemNotFound&&"Table.getHeaderRowRange"===e.debugInfo.errorLocation)l=!0;else if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.itemNotFound&&"TableCollection.getItem"===e.debugInfo.errorLocation)return;r=void 0,(0,R.tgf)()&&(i=o.ye.EmptyHeaders)}try{if(!a.workbook.autoSave)return;s.load("showTotals"),l&&s.load("showHeaders");const e=["rowCount","columnCount"],o=["values","numberFormat","numberFormatCategories"];let d="values";(0,R.yw9)("OfficeVSO_8534150_PassVisibleRowData")&&(e.push("text"),o.push("text"),d="text"),o.push("numberFormatLocal");const u=s.getDataBodyRange().load(e),m=u.getRow(0).load(o),h=u.getLastRow().load(d),g=[];for(let e=0;e<c.columnCount;e++)g.push(s.worksheet.getCell(0,c.columnIndex+e).getEntireColumn().load("hidden"));let p,b,f,C,y,v,x;try{await a.sync(),p=u.rowCount,b=u.columnCount,(0,R.yw9)("OfficeVSO_8534150_PassVisibleRowData")?(f=m.text,v=h.text):(f=m.values,v=h.values),C=q(m),y=m.numberFormatCategories,x=g.map((e=>e.hidden))}catch(e){if(!(z(e)||e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.generalException))throw e;{s.load("name, showTotals"),l&&s.load("showHeaders");const e=s.getDataBodyRange().load(["rowCount","columnCount"]),t=e.getRow(0).load(o),n=e.getLastRow().load("values"),r=[];for(let e=0;e<c.columnCount;e++)r.push(s.worksheet.getCell(0,c.columnIndex+e).getEntireColumn().load("hidden"));await a.sync(),p=e.rowCount,b=e.columnCount,f=t.values,C=q(t),y=t.numberFormatCategories,v=n.values,x=r.map((e=>e.hidden))}}const T=e=>V(e?e[0]:[]),S=T(r?.values),w=T(f),E=T(v),I=T(C),A=T(y),L=[];for(const[e,t]of x.entries())t||L.push(e);let F=!1;if(s.showTotals){const e=s.getTotalRowRange();e.load("hidden"),await a.sync(),F=!e.hidden}const _=n.ExcelCalc.sheetAddressToExcelSheetRange(c.address);let P;(0,R.iPS)("Microsoft.Office.Excel.FA000000124.OfficeVSO_8415279_PassColorsUsedInTableForFormatting",!1)&&(P=await async function(e,t,a){let n;if(t){const o=await(0,k.q)(e,t,"cell",a);n=[...new Set(o.flat())]}return n}(s.name,L,a));return{id:s.id,name:s.name,address:c.address,headers:S,numRows:p,numColumns:b,firstRowValues:w,lastRowValues:E,numberFormats:I,numberFormatCategories:A,visibleColumns:L,sheetRange:_,totalRow:F,ColorAlreadyUsedForConditionalFormatting:P,tableContained:t?.isContained,tableIntersected:t?0===t.distance:void 0,tableLikeRangeFeatures:i}}catch(e){throw x.M.getInstance().logErrorCode(u.O.GetTableContextFailed,e),e}}))}async function _(e,t){try{return Excel.run({delayForCellEdit:!0},(async a=>{const n=e.interpretation.orientation,r=(0,L.K7)(e),{left:i,top:l,right:s,bottom:c,worksheetId:d}=r;let u=e?.unsupportedFeatures;const m=a.workbook.worksheets.getItem(d);m.load("name");const h=(0,L.vs)(m,r,n);h.load("values");m.getRangeByIndexes(l+1,i,c-l,1).load("values");const g=(0,L._f)(m,r);g.load(["values","numberFormat","numberFormatCategories","numberFormatLocal"]);const p=m.getRangeByIndexes(c,i,1,s-i+1);p.load("values");const b=[];for(let e=i;e<=s;e++){const t=m.getCell(l,e);t.load("hidden"),b.push(t)}await a.sync();const f=(0,L.Sy)(h,n,e.unsupportedFeatures),C=f.some((e=>""===e));(0,R.tgf)()&&(C&&(u|=o.ye.EmptyHeaders),new Set(f).size!==f.length&&(u|=o.ye.DuplicateHeaders));const y=[];for(let e=0;e<s-i+1;e++)b[e].hidden||y.push(e);const v={sheet:m.name,range:{topLeft:{row:l,column:i},bottomRight:{row:c,column:s}}},x=V(g.numberFormatCategories),T=q(g);return{name:e.name,address:e.name,headers:V(f),numRows:c-l,numColumns:s-i+1,firstRowValues:V(g.values[0]),lastRowValues:V(p.values[0]),numberFormats:V(T[0]),numberFormatCategories:x,visibleColumns:y,sheetRange:v,totalRow:!!(0,R.tgf)()&&e.hasTotalRow,tableLikeRange:!0,tableContained:t?.isContained,tableIntersected:t?0===t.distance:void 0,tableLikeRangeFeatures:u}}))}catch(e){throw x.M.getInstance().logErrorCode(u.O.GetTabularRangeContextFailed,e),e}}const P={name:!0};async function N(){return Excel.run((async e=>{const t=e.workbook;return t.load(P),await e.sync(),t.name}))}const M={name:!0,id:!0};async function O(){return Excel.run((async e=>{const t=e.workbook.worksheets;t.load(M),await e.sync();return{worksheets:t.items.map((e=>({id:e.id,name:e.name})))}}))}const D={charts:{name:!0,chartType:!0,title:{text:!0},pivotOptions:{showLegendFieldButtons:!0},worksheet:{id:!0}}};const B={address:!0,rowIndex:!0,rowCount:!0,columnIndex:!0,columnCount:!0},$={name:!0,worksheet:{id:!0},layout:{showColumnGrandTotals:!0,showRowGrandTotals:!0,layoutType:!0}},H={name:!0,fields:{name:!0}},U={name:!0,field:{name:!0}};function q(e){return void 0!==e.numberFormatLocal?e.numberFormatLocal:e.numberFormat}function V(e){return JSON.stringify(e)}function G(e){return V(e?e[0]:[])}function W(e,t){return{worksheetId:t,top:e.rowIndex+1,left:e.columnIndex+1,bottom:e.rowIndex+e.rowCount,right:e.columnIndex+e.columnCount}}function z(e){return e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.responsePayloadSizeLimitExceeded||"RequestPayloadSizeLimitExceeded"===e.code)}var j=a(53113),Q=a(14086),J=a(162800),Y=a(108869),X=a(83437);class Z{getPythonCalculatedColumnContext(){return{columnCode:this.columnCode}}async updatePythonColumns(){return Excel.run((async e=>{const t=Le.getActiveWorksheetId();if(!t)return;const a=e.workbook.worksheets.getItem(t),n=Le.getActiveTable();if(n){const t=a.getRange(n.address).getRow(1).load(["formulas","values"]);await e.sync();const o=t.formulas[0],r=t.values[0],i=[];for(let e=0;e<o.length;e++){const t=o[e],a=r[e];if(!t.toString().startsWith("=PY")||t===a)continue;const n=(0,Y.vv)(t);""!==n&&i.push(n)}this.columnCode=i}}))}constructor(){this.columnCode=[]}}Z.getInstance=()=>(void 0===Z._instance&&(Z._instance=new Z),Z._instance);var K,ee,te,ae=a(504003),ne=a(202051);function oe(e,t,a){const n=e instanceof DOMException&&"QuotaExceededError"===e.name&&window.localStorage&&0!==window.localStorage.length;switch(a){case"PythonAaTuiShown":{const e=`Failed to ${t} ${a} in local storage. Local storage is ${n?"available":"not available"}.`,o=(0,ne.h3)(u.O.PythonTuiNotShownError,e,void 0);(0,ne.QX)(void 0,o,!1);break}}return n?"QuotaExceeded":"LocalStorageNotAvailable"}!function(e){e.PythonAaTuiShown="PythonAaTuiShown",e.PythonIsThinkDeeperMode="PythonIsThinkDeeperMode",e.UseModelessPythonAA="UseModelessPythonAA"}(K||(K={})),function(e){e.KeyNotFound="KeyNotFound",e.QuotaExceeded="QuotaExceeded",e.LocalStorageNotAvailable="LocalStorageNotAvailable"}(ee||(ee={})),function(e){e.Read="Read",e.Write="Write"}(te||(te={}));var re=a(84668),ie=a(15536),le=a(755005),se=a(875136),ce=a(60398);class de{getPythonConversationHistory(){return this.pythonConversationHistory}getFormulasProcessedPerWorksheet(){return this.formulasProcessedPerWorksheet}getFormulasProcessed(){return this.formulasProcessed}getWorksheetsProcessed(){return this.worksheetsProcessed}resetFormulasProcessedPerWorksheet(){this.formulasProcessedPerWorksheet=0}clearPythonContextBuilder(){this.pythonConversationHistory=[],this.otherPythonCells=[],this.pythonPrompt="",this.pythonCellsUptoAnalysisSheet.clear(),this.resetAllProcessedCounters()}getOtherPythonCells(){return this.otherPythonCells}setQuery(e){this.pythonConversationHistory.push({query:e})}setSelectedPythonTableContext(e){this.pythonConversationHistory.push({tableContext:e})}setSelectedPythonCellContext(e){this.pythonConversationHistory.push({pythonContext:e})}setLlmText(e){this.pythonConversationHistory.push({llmResponse:e})}setCodeAndOutput(e){this.pythonConversationHistory.push({codeAndOutput:e})}setFinalResponse(e){this.pythonConversationHistory.push({finalResponse:e})}setPythonPrompt(e){this.pythonPrompt=e}getPythonPrompt(){return this.pythonPrompt}async updateConversationHistory(e){const t=new Set;for(let a=0;a<this.pythonConversationHistory.length;a++){const n=this.pythonConversationHistory[a];if(n.tableContext){const e=n.tableContext,t=n.tableContext.tableType===le.lp.TableLikeRange?await Le.pythonContextManager.getUpdatedPythonTableContextForTableLikeRange(e):await Le.pythonContextManager.getUpdatedPythonTableContext(n.tableContext);t?this.pythonConversationHistory[a]={tableContext:t}:n.tableContext.wasDeleted=!0}if(n.pythonContext){const o=n.pythonContext.sheetAddress,r=e.get(n.pythonContext.sheetAddress??"");r?(this.pythonConversationHistory[a]={pythonContext:r},t.add(o??"")):n.pythonContext.wasDeleted=!0}if(n.codeAndOutput){const o=n.codeAndOutput.sheetAddress,r=e.get(n.codeAndOutput.sheetAddress??"");r?(this.pythonConversationHistory[a]={codeAndOutput:r},t.add(o??"")):n.codeAndOutput.wasDeleted=!0}}const a=Array.from(e.values()).filter((e=>!t.has(e.sheetAddress??"")));this.otherPythonCells=a}calculatePythonRangeDifference(e,t){return e.rowIndex!==t.rowIndex?e.rowIndex-t.rowIndex:e.columnIndex-t.columnIndex}async callGetSpecialCellsOrNullObjectApi(e,t){const a=t.getUsedRange().getSpecialCellsOrNullObject(Excel.SpecialCellType.formulas).load(["areas","areaCount","isNullObject"]);return await e.sync(),a}async getPythonCellsFromSpecialCellsAreas(e,t,a){const n=[];for(let o=0;o<e.areaCount;o++){const r=e.areas.getItemAt(o).load(["address","formulas","rowIndex","columnIndex"]);await t.sync();const i=r.formulas;let l=r.rowIndex;for(const e of i){let t=r.columnIndex;for(const o of e){if(Y.sy.test(o)){const e=a.getRangeByIndexes(l,t,1,1);e.track(),n.push(e),e.load(["address","rowIndex","columnIndex"])}this.formulasProcessed++,this.formulasProcessedPerWorksheet++,t++}l++}}return await t.sync(),n.sort(((e,t)=>this.calculatePythonRangeDifference(e,t))),n}async getPythonCellsFromWorksheet(e,t){const a=(new Date).getTime();try{const n=await(0,se.Mg)((async()=>await this.callGetSpecialCellsOrNullObjectApi(e,t)),se.xk.CallGetSpecialCellsOrNullObjectApi);if(n.isNullObject)return[];const o=await(0,se.Mg)((async()=>await this.getPythonCellsFromSpecialCellsAreas(n,e,t)),se.xk.GetPythonCellsFromSpecialCellsAreas);return(0,se.Cc)(se.xk.GetPythonCellsFromWorksheet,a,!1),o}catch(e){throw(0,se.Cc)(se.xk.GetPythonCellsFromWorksheet,a,!0),(0,ne.R_)(e)}finally{Le.pythonContextManager.pythonContextBuilder.resetFormulasProcessedPerWorksheet()}}resetAllProcessedCounters(){this.worksheetsProcessed=0,this.formulasProcessed=0,this.formulasProcessedPerWorksheet=0}async getAllPythonCellsUptoAnalysisSheetWithTimeout(e,t,a){const n=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextGetAllPythonCellsUpToAnalysisSheetTimeoutInMS",6e4);this.pythonCellsUptoAnalysisSheet.clear(),this.resetAllProcessedCounters();let o=new Map;try{(0,R.uze)()?await Le.pythonContextManager.executeWithTimeout(n,(n=>this.getAllPythonCellContextOfAASessionAnalysisSheet(e,t,a,n)),se.xk.GetAllPythonCellsOfAASessionAnalysisSheet,"getPythonCellsOfAASessionAnalysisSheetWithTimeout",u.O.GetAllPythonCellsOfAASessionAnalysisSheetTimeout):await Le.pythonContextManager.executeWithTimeout(n,(n=>this.getAllPythonCellContextUptoAnalysisSheet(e,t,a,n)),se.xk.GetAllPythonCellsUptoAnalysisSheet,"getPythonCellsUpToAnalysisSheetWithTimeout",u.O.GetAllPythonCellsUpToAnalysisSheetTimeout)}catch(t){if(!(t instanceof ce.H&&t.errorCode===u.O.GetAllPythonCellsUpToAnalysisSheetTimeout))throw t;{let a=[];a=[{key:v.HR.FormulasProcessed,value:this.formulasProcessed},{key:v.HR.WorksheetsProcessed,value:this.worksheetsProcessed}],(0,ne.QX)(e,t,!0,a)}}finally{o=(0,r.cloneDeep)(this.pythonCellsUptoAnalysisSheet);const e=Array.from(this.pythonCellsUptoAnalysisSheet.entries()).reverse();o=new Map(e),this.pythonCellsUptoAnalysisSheet.clear(),this.resetAllProcessedCounters()}return o}async getAllPythonCellsUptoAnalysisSheet(e,t,a){try{await this.getAllPythonCellContextUptoAnalysisSheet(e,t,a);return(0,r.cloneDeep)(this.pythonCellsUptoAnalysisSheet)}catch(e){throw e}finally{this.pythonCellsUptoAnalysisSheet.clear(),this.resetAllProcessedCounters()}}async getAllPythonCellContextOfAASessionAnalysisSheet(e,t,a,n){return Excel.run({delayForCellEdit:!1},(async o=>{const r=o.workbook.worksheets.load("items"),i=o.workbook.worksheets.getActiveWorksheet();await o.sync();const l=r.items;await(0,Y.Dh)(i,o);const s=Le.pythonContextManager.pythonAnalysisSheetId;if(!s)return;const c=l.find((e=>e.id===s));if(!c)return;let d;try{d=await e((0,A.q9)()),d!==g.OP.PythonCellsCalculating?e(w.m.startExecutingCommand({command:g.OP.PythonCellsCalculating})):d=void 0,await this.loadPythonCellsContextFromWorksheet(o,c,t,a,n),this.worksheetsProcessed++}catch(e){if((0,ne.CS)(e,n))return;throw e instanceof ce.H&&e.errorCode===u.O.GetPythonCellContextTimeoutRecoverable?(0,ne.Uc)(u.O.GetPythonCellContextTimeout,e.errorDetailsNoPII??"",e):e}finally{d&&e(w.m.startExecutingCommand({command:d}))}}))}async getAllPythonCellContextUptoAnalysisSheet(e,t,a,n){return Excel.run({delayForCellEdit:!1},(async o=>{const r=o.workbook.worksheets.load("items");await o.sync();const i=r.items,l=Le.pythonContextManager.pythonAnalysisSheetId;let s,c;s=l?i.findIndex((e=>e.id===l)):i.length-1,-1===s&&(s=i.length-1);const d=i.slice(0,s+1);let m=d[length-1];try{c=await e((0,A.q9)()),c!==g.OP.PythonCellsCalculating?e(w.m.startExecutingCommand({command:g.OP.PythonCellsCalculating})):c=void 0;for(let e=d.length-1;e>=0;e--){if(n?.signal.aborted)return;m=d[e],await this.loadPythonCellsContextFromWorksheet(o,m,t,a,n),this.worksheetsProcessed++}}catch(t){if((0,ne.CS)(t,n))return;if(m.load("id"),await o.sync(),m.id===l)throw t instanceof ce.H&&t.errorCode===u.O.GetPythonCellContextTimeoutRecoverable?(0,ne.Uc)(u.O.GetPythonCellContextTimeout,t.errorDetailsNoPII??"",t):t;{const a=(0,ne.Y8)(t);(0,ne.QX)(e,a,!0)}}finally{c&&e(w.m.startExecutingCommand({command:c}))}}))}async loadPythonCellsContextFromWorksheet(e,t,a,n,o){try{if(o?.signal.aborted)throw(0,ne.Uc)(u.O.PythonContextExtractionAborted,"loadPythonCellsContextFromWorksheet operation aborted by caller.",void 0);let r=[];if(r=await this.getPythonCellsFromWorksheet(e,t),!(0,R.yw9)("OfficeVSO_9052463_UsePythonAnalysisSheetRangeForContextExtraction"))if(t.id===a){const a=t.getRange(n);a.load(["rowIndex","columnIndex"]),await e.sync(),r=r.filter((e=>{const t=this.calculatePythonRangeDifference(e,a)<=0;return e.untrack(),t}))}else r.forEach((e=>{e.untrack()}));for(let e=r.length-1;e>=0;e--){const a=(0,Y.c3)(r[e].address);if(o?.signal.aborted)throw(0,ne.Uc)(u.O.PythonContextExtractionAborted,"loadPythonCellsContextFromWorksheet operation aborted by caller.",void 0);const n=await Le.pythonContextManager.getPythonCellContextWithTimeout(t.id,a,!0,o);this.pythonCellsUptoAnalysisSheet.set(a,n),r[e].untrack()}}catch(e){if((0,ne.CS)(e,o))return;throw e}finally{await e.sync()}}async getLastPythonCellOnSheet(e,t){return Excel.run({delayForCellEdit:!1},(async a=>{const n=(new Date).getTime(),o=a.workbook.worksheets.getItem(e);let r=[];r=await this.getPythonCellsFromWorksheet(a,o);const i=r.length;if(0===i)return;const l=(0,Y.c3)(r[i-1].address);let s;return s=t.get(l),s||(s=await Le.pythonContextManager.getPythonCellContextWithTimeout(o.id,l)),(0,se.Cc)(se.xk.GetLastPythonCellOnSheet,n,!1),s}))}constructor(){this.pythonConversationHistory=[],this.otherPythonCells=[],this.pythonPrompt="",this.pythonCellsUptoAnalysisSheet=new Map,this.worksheetsProcessed=0,this.formulasProcessed=0,this.formulasProcessedPerWorksheet=0}}de._instance=void 0,de.getInstance=()=>(void 0===de._instance&&(de._instance=new de),de._instance);var ue=a(977055),me=a(502582),he=a(750927),ge=a(464216);var pe=a(762542),be=a(254359),fe=a(390624),Ce=a(507628);class ye extends me.r{getDataFrameCodeHelper(e,t=!1){return t?((0,ue.PB)(v.L3.DataFrameCodeProperty,[{key:v.$.TableNameHasBackslash,value:!0}]),`${this.dataFrameName}=xl(r"${e}", headers=${this.hasHeaders?"True":"False"})`):`${this.dataFrameName}=xl("${e}", headers=${this.hasHeaders?"True":"False"})`}getDataFrameCode(e){if(this.tableLikeRange){const e=(0,Y.VF)(this.address,this.hasTotalRow);return this.getDataFrameCodeHelper(e)}{const t=`[${e}]`,a=this.name+t,n=this.name.includes("\\");return this.getDataFrameCodeHelper(a,n)}}getDataFrameLabel(e,t){return(0,he.L)((0,f.YYS)(),e,t)}clearState(){this.resolve=void 0,this.reject=void 0}resolveAndClear(e){this.resolve&&this.resolve(e),this.clearState()}rejectAndClear(e){this.reject&&this.reject(e),this.clearState()}getAddressAndPythonCellContext(e){const t=Array.from(this.pythonCells.entries()).find((t=>{const[a,n]=t;return!!e(a,n)}));if(void 0!==t)return{address:t[0],pythonCellContext:t[1]}}codeRegexTest(e,t,a){return e.test(a.code)}codeRegexMissingSheetNameTest(e,t,a,o){return n.ExcelCalc.sheetNameFromSheetAddresses(t)===a&&e.test(o.code)}findDataFrame(e){if(this.tableLikeRange){const e=n.ExcelCalc.sheetNameFromSheetAddresses(this.name),t=n.ExcelCalc.localAddressesFromSheetAddresses(this.name),a=(0,Y.UH)(e),o=(0,Y.gQ)(a,t,!0),r=this.getAddressAndPythonCellContext(((e,t)=>this.codeRegexTest(o,e,t)));if(r)return r;const i=(0,Y.gQ)(a,t,!1);return this.getAddressAndPythonCellContext(((t,a)=>this.codeRegexMissingSheetNameTest(i,t,e,a)))}{const t=(0,Y.WM)(this.name,e);return this.getAddressAndPythonCellContext(((e,a)=>this.codeRegexTest(t,e,a)))}}async getListSeparator(e){return e.application.cultureInfo.formulaCulture.load("listSeparator"),await e.sync(),e.application.cultureInfo.formulaCulture.listSeparator??","}autoInsertPythonFormula(){return new Promise(((e,t)=>{this.resolve=e,this.reject=t,(0,fe.F5)((async e=>{try{const t=await this.getListSeparator(e),a=await async function(){return await Excel.run({delayForCellEdit:!1},(async e=>(e.application.load("cultureInfo/formulaCulture/specialRefNames"),await e.sync(),e.application.cultureInfo.formulaCulture.specialRefNames)))}(),o=`[#${a[1]}]${t}[#${a[2]}]`,r=this.findDataFrame(o);if(r){const{address:e,pythonCellContext:t}=r,a=(0,ne.L7)(t);return a?void this.rejectAndClear(a):void this.resolveAndClear(e)}(0,se.Fr)(se.xk.DataFrameInsert),(0,se.BW)(this.dispatch);let i=this.getDataFrameCode(o);const l=(0,Y.ZK)(i,!0,pe.M),[s,c]=(0,Y.Jy)(this.address),d=this.tableLikeRange?c:this.name;this.codeLabel=this.getDataFrameLabel(s,d),i=(0,Y.MA)(i,this.codeLabel);const u=await(0,Y.WH)(e,this.sheetId),m=this.codeLabel,h=await(0,se.Mg)((async()=>this.insertLabelAndContentForPreviewOrFormula(e,u,m,l,!0,!0)),se.xk.InsertContentToGrid),g=n.ExcelCalc.localAddressesFromSheetAddresses(h),p=n.ExcelCalc.sheetNameFromSheetAddresses(h);let b;if((0,R.EJJ)()){const e={type:"code",value:{code:i,codeLabel:this.codeLabel}};b=(0,ge.C)([e])}Le.pythonContextManager.lastCodeAndPostViewMessage=be.n.displayPythonCodeCardWithPendingPostView(this.dispatch,(0,Ce.A)(),i,p,g,!0,(0,he.L)((0,f.vCA)(),s,d),this.codeLabel,b)}catch(e){(0,se.i5)(!1),(0,se.$k)(this.dispatch);const a=(0,ne.MF)(e,"PythonDataFrameInserter","autoInsertPythonFormula",!0);t(a)}}),{delayForCellEdit:!1})}))}onCalculatedHandlerShouldNotGenerate(){super.onCalculatedHandlerShouldNotGenerate(),this.resolveAndClear(null)}async handlePythonCellExecutionResult(e,t){const a=(0,ne.L7)(e);if(a)return void this.rejectAndClear(a);this.addCodeAndOutputToBuilder(e);const n=e.sheetAddress;this.pythonCells.set(n??"",e),this.resolveAndClear(n??"")}constructor(e,t,a,n,o,r,i,l,s){super(i,l,me.n.PythonDataFrameInserter),this.name=e,this.address=t,this.tableLikeRange=a,this.hasHeaders=n,this.hasTotalRow=o,this.pythonCells=r,this.dataFrameName=(0,Y.Yp)(e,t,s)}}async function ve(e,t,a,n,o,r,i){const l=await(0,Y.nC)(i,Le),[s,c]=(0,Y.Jy)(t),d=await async function(e){return await Excel.run((async t=>{const a=t.workbook.worksheets.getItem(e);return a.load("position"),await t.sync(),a.position}))}(s),u=new ye(e,t,a,n,o,r,i,l,d);return await u.autoInsertPythonFormula()}class xe{async setPythonStartAnalysisContext(e){if(!this.query){const e=`Undefined Item: query, Function: setPythonStartAnalysisContext, isPythonCellSelected: ${Le.isPythonCellSelected}`;throw(0,ne.Uc)(u.O.PythonContextUndefinedParameter,e,void 0)}if(!this.sheetId||!this.address){const e=`\n      Address: ${this.address?"Defined":"Undefined"},\n      Sheet Id: ${this.sheetId?"Defined":"Undefined"},\n      Function: setPythonStartAnalysisContext, isPythonCellSelected: ${Le.isPythonCellSelected}`;throw(0,ne.Uc)(u.O.PythonContextUndefinedParameter,e,void 0)}Le.pythonContextManager.pythonContextBuilder.clearPythonContextBuilder(),this.pythonCellContext?this.pythonContextBuilder.setSelectedPythonCellContext(this.pythonCellContext):this.pythonTableContext&&this.pythonContextBuilder.setSelectedPythonTableContext(this.pythonTableContext),this.pythonContextBuilder.setQuery(this.query),await(0,se.ek)((async()=>{await this.pythonContextBuilder.updateConversationHistory(e)}),se.xk.UpdateConversationHistory)}updateTrimmedContext(e){const{query:t,sheetId:a,address:n,pythonCellContext:o,pythonTableContext:r}=e;this.query=t,this.sheetId=a,this.address=n,this.pythonCellContext=o,this.pythonTableContext=r,(0,ue.xX)(ue.Am.Update,!t,Error().stack)}setPythonCellContext(e){this.pythonCellContext=e}setPythonTableContext(e){this.pythonTableContext=e}getTrimmedContextQuery(){return this.query}getTrimmedContextSheetId(){return this.sheetId}getTrimmedContextAddress(){return this.address}getPythonTableContext(){return this.pythonTableContext}clearTrimmedContext(){this.query=void 0,this.sheetId=void 0,this.address=void 0,this.pythonCellContext=void 0,this.pythonTableContext=void 0,(0,ue.xX)(ue.Am.Clear,!0,Error().stack)}async insertDataFrameIfNecessaryForStartAnalysis(e,t){const a=(new Date).getTime(),n=this.getPythonTableContext();if(n){const a=n.tableName,o=n.tableType===le.lp.TableLikeRange,r=n.headers!==f.r$C,i=n.hasTotalRow,l=await ve(a,n.sheetAddress,o,r,i,e,t);if(!Le.pythonContextManager.shouldGenerate)return;const{sheet:s,address:c}=(0,Y.B4)(l,e),d=await Le.pythonContextManager.getPythonCellContextWithTimeout(s,c);d&&(this.setPythonCellContext(d),this.setPythonTableContext(void 0))}else(0,Y.nC)(t,Le);(0,se.QO)(se.xk.InsertDataFrameIfNecessaryForStartAnalysis,a)}constructor(){this.pythonContextBuilder=de.getInstance()}}xe.getInstance=()=>(void 0===xe._instance&&(xe._instance=new xe),xe._instance);var Te=a(413848),Se=a(318259),we=a(107295);class Ee{async getMaxRetryAttempts(e){switch(e){case"ExecutePythonCode":return this.MAX_RETRY_ATTEMPTS_EXECUTE_PYTHON_CODE;case"GetCodeAndOutput":case"GetCellTypeAndValueIfNotBusy":return Math.ceil(await this.getPythonExecutionTimeoutInMilliseconds()/this.RETRY_WAIT_IN_MILLISECONDS);default:return this.MAX_RETRY_ATTEMPTS}}registerOnNewEntry(){this.requestContext.workbook.externalCodeService.diagnostics.onNewEntry.add(ae.w)}setIsPythonMode(e){this.isPythonMode=e,(0,we.z)(e),(0,R.gnD)()&&(this.dispatch(w.m.setIsPythonMode(e)),e||this.setIsPythonThinkDeeperMode(e))}setIsPythonThinkDeeperMode(e){this.isPythonThinkDeeperMode=e,this.dispatch(w.m.setIsPythonThinkDeeperMode(e))}unregisterOnNewEntry(){this.requestContext.workbook.externalCodeService.diagnostics.onNewEntry.remove(ae.w)}enterAdvancedAnalysisMode(){Le.pythonContextManager.setIsPythonMode(!0),Le.pythonContextManager.analysisSessionId=(0,Ce.A)(),Le.pythonContextManager.isFirstCodeExecution=!0,Le.pythonContextManager.registerOnNewEntry()}async init(e){this.dispatch=e}get alreadyShownTui(){return this._alreadyShownTui}set alreadyShownTui(e){this._alreadyShownTui=e,function(e,t){try{return localStorage.setItem(e,t),{isSuccess:!0,errorType:void 0}}catch(t){return{isSuccess:!1,errorType:oe(t,"Write",e)}}}(K.PythonAaTuiShown,e?"true":"false")}async recalcSheet(e=!1){const t=(new Date).getTime(),a=this.pythonTrimmedContext.sheetId;if(!a)return void(0,ue.PB)(v.L3.RecalcSheetMissingSheetId,[]);const n=await(0,Y.eU)();if(n===Excel.CalculationMode.automatic){if(e)this.requestContext.application.calculate(Excel.CalculationType.full);else{this.requestContext.workbook.worksheets.getItem(a).calculate(!0)}await this.requestContext.sync()}(0,se.Cc)(se.xk.RecalcSheet,t,!1,`Calculation Mode: ${n}`)}async getActiveTableContext(e){let t;if(t=(0,R.ZAR)()?await Le.getNearestTable():Le.getActiveTable(),t){const a=(new Date).getTime(),r=n.ExcelCalc.IExcelSheetRangeToSheetAddress(t.sheetRange),i=await(0,Te.vq)(t,e,r,this.dispatch,this.requestContext,this.MAX_SAMPLE_ROWS),l=(0,Y.c3)(r),s={tableName:t.name,headers:t.headers,hasTotalRow:t.totalRow,numRows:t.numRows,numColumns:t.numColumns,sampleRows:i,numberFormat:t.numberFormatCategories,sheetId:e,sheetAddress:l,tableType:t.tableLikeRange?o.lp.TableLikeRange:o.lp.StandardTable};return(0,se.Cc)(se.xk.GetActiveTableContext,a,!1),s}}async insertDataFrameAndGetPythonContext(e,t){const a=(new Date).getTime(),n=e.name,o=e.tableLikeRange??!1,r=e.headers!==f.r$C,i=e.totalRow,l=await ve(n,e.address,o,r,i,t,this.dispatch),{sheet:s,address:c}=(0,Y.B4)(l,t),d=await this.getPythonCellContextWithTimeout(s,c);return(0,se.QO)(se.xk.InsertDataFrameAndGetPythonContext,a),d}getPythonAdaContext(){let e=this.pythonContextBuilder.getPythonConversationHistory().slice(-this.MAX_CONVERSATION_HISTORY);return e=structuredClone(e),e.forEach((e=>{e.pythonContext?delete e.pythonContext.sheetId:e.codeAndOutput&&delete e.codeAndOutput.sheetId})),{staticPromptOverride:"",hasActivePythonLicense:(0,Y.Gd)(),isPythonCellSelected:Le.isPythonCellSelected,conversationHistory:e,otherPythonCells:this.pythonContextBuilder.getOtherPythonCells().slice(-this.MAX_PYTHON_CELLS),queryOrigin:this.queryOrigin}}async setPythonAdaContext(e,t,a,n,r){const i=(new Date).getTime();try{if(this.prePythonModeError=void 0,this.prePythonModeErrorFunction=void 0,this.queryOrigin=r??o.Rk.CopilotSDX,(0,ue.Jr)(this.augloopCallsPerQuery,this.codeRetryAttempts),this.codeRetryAttempts=0,this.augloopCallsPerQuery=0,(0,R.LhK)()&&(this.renderedCardCount=0,Le.pythonContextManager.isAutoScrollingEnabled=!0),!(0,R.H2A)()||!(0,Y.Gd)())return this.pythonContextBuilder.clearPythonContextBuilder(),!0;if(!a||!n){const e=`\n        Address: ${n?"Defined":"Undefined"},\n        Sheet Id: ${a?"Defined":"Undefined"},\n        Function: setPythonAdaContext, isPythonCellSelected: ${Le.isPythonCellSelected}`;throw(0,ne.Uc)(u.O.PythonContextUndefinedParameter,e,void 0)}const l=await this.isPythonCell(a,n);l!==e&&((0,ue.hp)(e,l),Le.isPythonCellSelected=l,e=l);const s={query:t,sheetId:a,address:n};let c;if(c=this.isPythonMode?await this.pythonContextBuilder.getAllPythonCellsUptoAnalysisSheetWithTimeout(this.dispatch,a,n):new Map,e){const e=(0,Y.c3)(n),t=c.get(e);s.pythonCellContext=t||await this.getPythonCellContextWithTimeout(a,n)}else if(this.isPythonMode){const e=Le.pythonContextManager.pythonAnalysisSheetId;if(e&&e===a){const t=await this.pythonContextBuilder.getLastPythonCellOnSheet(e,c);s.pythonCellContext=t}else{let e;if(e=(0,R.ZAR)()?await Le.getNearestTable():Le.getActiveTable(),e)s.pythonCellContext=await this.insertDataFrameAndGetPythonContext(e,c);else{(0,Y.nC)(this.dispatch,Le);const e=await this.pythonContextBuilder.getLastPythonCellOnSheet(a,c);s.pythonCellContext=e}}}else s.pythonTableContext=await this.getActiveTableContext(a);return this.isPythonMode?this.updatePythonContextFieldsForPythonMode(s,c):this.pythonTrimmedContext.updateTrimmedContext(s),(0,se.Cc)(se.xk.AdaContextExtraction,i,!1),!0}catch(e){return this.isPythonMode?((0,se.Cc)(se.xk.AdaContextExtraction,i,!0),(0,ne.Kx)(this.dispatch,e,"setPythonAdaContext",!1),!1):(this.prePythonModeErrorFunction="setPythonAdaContext",this.prePythonModeError=e,!0)}}async isPythonCell(e,t){const a=(new Date).getTime();try{const n=await this.getPythonCellRange(e,t);return await this.requestContext.sync(),await this.getPythonCellType(n),n.untrack(),await this.requestContext.sync(),(0,se.Cc)(se.xk.IsPythonCell,a,!1),!0}catch(e){return(0,se.Cc)(se.xk.IsPythonCell,a,!0),!1}}async getCodeAndOutput(e,t){if(t||(t=await this.getPythonCellType(e)),e.load("valuesAsJson"),await this.requestContext.sync(),"Error"===e.valuesAsJson[0][0].type)return await this.getErrorValue(e);switch(t){case le.px.SinglePythonObjectCell:return await this.getPythonObjectOutput(e);case le.px.SingleExcelValueCell:return await this.getExcelValueSingleCellOutput(e);case le.px.SpilledExcelValueCell:return await this.getExcelValueSpilledRangeOutput(e)}}async getUpdatedPythonTableContext(e){const t=e.tableName,a=this.requestContext.workbook.tables.getItemOrNullObject(t);if(a.load(["isNullObject","showTotals"]),await this.requestContext.sync(),a.isNullObject)return;const n=a.getHeaderRowRange().load("values"),o=a.getDataBodyRange().load(["rowCount","columnCount"]),r=o.getRow(0);r.load("numberFormatCategories"),await this.requestContext.sync();const i=n?JSON.stringify(n.values[0]):"",l=await(0,Te.GF)(t,this.MAX_SAMPLE_ROWS),s=r.numberFormatCategories?JSON.stringify(r.numberFormatCategories):"";return{tableName:t,headers:i,hasTotalRow:a.showTotals,numRows:o.rowCount,numColumns:o.columnCount,sampleRows:l,numberFormat:s,sheetId:e.sheetId,sheetAddress:e.sheetAddress,tableType:e.tableType}}async getUpdatedPythonTableContextForTableLikeRange(e){if(!e.sheetId){throw(0,ne.Uc)(u.O.PythonContextUndefinedParameter,"Undefined Parameter: sheetId, Function: getUpdatedPythonTableContextForTableLikeRange",void 0)}const t=(0,L.R1)(this.dispatch,e.sheetId,e.sheetAddress);if(t){const a=(0,L.K7)(t),{left:n,top:o,right:r,bottom:i,worksheetId:l}=a,s=t.interpretation.orientation,c=this.requestContext.workbook.worksheets.getItem(l),d=(0,L.vs)(c,a,s);d.load("values");const u=(0,L._f)(c,a);u.load("numberFormat");const m=await(0,L.m)(this.requestContext,c,a,this.MAX_SAMPLE_ROWS),h=(0,L.Sy)(d,s,t.unsupportedFeatures);return{tableName:t.name,headers:JSON.stringify(h),hasTotalRow:t.hasTotalRow,numRows:i-o,numColumns:r-n+1,sampleRows:m,numberFormat:JSON.stringify(u.numberFormat[0]),sheetId:e.sheetId,sheetAddress:e.sheetAddress,tableType:e.tableType}}(0,ue.PB)(v.L3.UpdateContextTLRCalledOnNonTLR,[])}async getPythonCellContextWithTimeout(e,t,a=!1,n){if(n?.signal.aborted)throw(0,ne.Uc)(u.O.PythonContextExtractionAborted,"getPythonCellContextWithTimeout was aborted.",void 0);const o=await this.getPythonExecutionTimeoutInMilliseconds()+5e3,r=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextGetPythonCellContextTimeoutInMS",o),i=a?u.O.GetPythonCellContextTimeoutRecoverable:u.O.GetPythonCellContextTimeout;return await this.executeWithTimeout(r,(a=>this.getPythonCellContext(e,t,a)),se.xk.GetPythonCellContext,"getPythonCellContext",i,n)}async getPythonCellContext(e,t,a){try{if(a?.signal.aborted)throw(0,ne.Uc)(u.O.PythonContextExtractionAborted,"getPythonCellContext was aborted.",void 0);if(!e||!t){const e=`Undefined Parameter: ${t?"sheetId":"address"}, Function: getPythonCellContext, isPythonCellSelected: ${Le.isPythonCellSelected}`;throw(0,ne.Uc)(u.O.PythonContextUndefinedParameter,e,void 0)}const n=await this.getPythonCellRange(e,t);await this.requestContext.sync();const o=await this.getPythonCellType(n),r=e=>!(0,ne.U6)(e)&&(!(0,ne.s$)(e)||(this.recalcSheet(!0),!1)),i=performance.now(),l=await this.getMaxRetryAttempts("GetCodeAndOutput"),s=await(0,Y.AJ)((async()=>await this.getCodeAndOutput(n,o)),r,l,this.RETRY_WAIT_IN_MILLISECONDS,!1,this.dispatch,a);n.load(["worksheet/id","address"]).untrack(),await this.requestContext.sync();let c="";if((0,ne.U6)(s)){throw c=`Busy State in codeAndOutput, Total Wait Time (ms): ${performance.now()-i}}, Retry Wait Interval (ms): ${this.RETRY_WAIT_IN_MILLISECONDS}, Python execution timeout (ms): ${await this.getPythonExecutionTimeoutInMilliseconds()}, Max Attempts: ${l}`,(0,ne.jv)(c,void 0)}return{sheetId:n.worksheet.id,sheetAddress:(0,Y.c3)(n.address),code:s.code,output:s.output,outputType:s.outputType}}catch(e){throw(0,R.yw9)("OfficeVSO_9900533_ImproveErrorTelemetryForPythonCellContext")?e instanceof ce.H?e:(0,ne.Uc)(u.O.PythonGeneralContextError,"Unknown error in getPythonCellContext.",e):e}}isStartAnalysisCard(){return this.lastStartAnalysisQueryGuid===x.M.userQueryGuid}exitAdvancedAnalysisMode(){this.pythonAnalysisSheetId=void 0,this.pythonAnalysisSheetExistsOnUserQuerySubmit=!1,this.setIsPythonMode(!1),this.analysisSessionId=void 0,this.pythonContextBuilder.clearPythonContextBuilder(),this.pythonTrimmedContext.clearTrimmedContext(),this.isFirstCodeExecution=!0,Le.pythonContextManager.shouldGenerate=!1,this.unregisterOnNewEntry(),Le.pythonContextManager.lastPythonUserRequestId="",(0,R.LhK)()&&(this.isAutoScrollingEnabled=!0,this.renderedCardCount=0)}async getPythonCellType(e){try{e.load(["formulas","hasSpill"]),await this.requestContext.sync();const t=e.formulas[0][0];if(Y.sy.test(t))return e.hasSpill?le.px.SpilledExcelValueCell:Y.OU.test(t)?le.px.SingleExcelValueCell:le.px.SinglePythonObjectCell;{const e="getPythonCellType: pythonCellType is PythonCellType.None";throw(0,ne.Uc)(u.O.PythonGeneralContextError,e,void 0)}}catch(e){if((0,R.yw9)("OfficeVSO_9900533_ImproveErrorTelemetryForPythonCellContext")){const t="Unknown error in getPythonCellType.";throw(0,ne.Uc)(u.O.PythonGeneralContextError,t,e)}throw e}}async getExcelValueSingleCellOutput(e){const t=(new Date).getTime();e.load(["formulas","valuesAsJson"]),await this.requestContext.sync();const a=(0,Y.vv)(e.formulas[0][0]),n=e.valuesAsJson[0][0];let o,r;switch(n.type){case"LocalImage":o="",r="Image";break;case Excel.CellValueType.notAvailable:o="#Unknown!",r=Excel.CellValueType.error;break;default:o=String(n.basicValue??""),r=String(n.basicType??"")}return(0,se.Cc)(se.xk.GetExcelValueSingleCellOutput,t,!1),{code:a,output:o,outputType:r}}async getExcelValueSpilledRangeOutput(e){const t=(new Date).getTime(),a=e.getSpillingToRangeOrNullObject().load(["isNullObject","rowCount","columnCount"]);if(a.track(),await this.requestContext.sync(),a.isNullObject){a.untrack(),await this.requestContext.sync();const e="getExcelValueSpilledRangeOutput: fullSpilledRange is null";throw(0,ne.Uc)(u.O.PythonGeneralContextError,e,void 0)}const n=a.getRow(0).load("formulas");await this.requestContext.sync();const o=(0,Y.vv)(n.formulas[0][0]),r=[],i=[],l=a.rowCount,s=a.columnCount;for(let e=0;e<this.MAX_SAMPLE_ROWS&&!(e>=l);e++){const t=[],n=a.getRow(e).load(["formulas","valuesAsJson"]);await this.requestContext.sync();const o=[];for(const e of n.valuesAsJson[0])t.push(String(e.basicValue??"")),o.push(String(e.basicType??""));r.push(o),!(t.length>0)||i.push(t)}a.untrack(),await this.requestContext.sync();const c={columnNames:[],dataTypes:r[0],sampleRows:i,numRows:l,numColumns:s};return(0,se.Cc)(se.xk.GetExcelValueSingleCellOutput,t,!1),{code:o,output:c,outputType:"TableLikeRange"}}async composePythonOutputString(e){try{if((0,ue.$y)(e.Python_typeName),e.preview){const t=e.preview;if(t.properties?.arrayPreview?.elements){const e=t.properties.arrayPreview.elements;if(e&&!Y.Xn.test(e[0][0].basicValue)){const t=e.map((e=>e.map((async e=>{if("FormattedNumber"===e.type){return await(0,Se.k0)(e)}return e.basicValue})))).map((async e=>await Promise.all(e.map((e=>Promise.resolve(e)))))),a=await Promise.all(t);return JSON.stringify(a)}}}return e.Python_str}catch{return e.Python_str}}async connectToOfficePySvcToExecutePythonCodeWithRetry(e){const t=(new Date).getTime(),a=e.getPythonContextObject();a.load(["pythonObjectReferenceIds","runtimeUrl"]),await this.requestContext.sync();try{const n=a.pythonObjectReferenceIds[0][0];if(!n)throw(0,ne.Uc)(u.O.GetPythonContextObjectFailed,"pythonObjectReferenceId is empty",void 0);const o=(0,Y.yK)(n),r=JSON.parse(a.runtimeUrl);if(!Array.isArray(r)||0===r.length||!r[0]||"object"!=typeof r[0])throw(0,ne.Uc)(u.O.GetPythonContextObjectFailed,"Invalid or empty runtimeUrl data",void 0);const i=r[0].RuntimeUrl;if(!i)throw(0,ne.Uc)(u.O.GetPythonContextObjectFailed,"runtimeurl is empty",void 0);return(0,se.l5)(se.xk.GetPythonContextObjectApiCall,t,0),await this.executePythonCodeWithRetry(o,e,i)}catch(e){if((0,se.l5)(se.xk.GetPythonContextObjectApiCall,t,0,!0),(0,R.yw9)("OfficeVSO_10004713_updateExecutePythonCodeErrorToEvent")){const t=e instanceof ce.H&&e.errorDetailsNoPII?e.errorDetailsNoPII:"connectToOfficePySvcToExecutePythonCodeWithRetry unknown error",a=[];a.push({key:v.$.ErrorMessage,value:t}),(0,ue.PB)(v.L3.GetPythonContextObjectFailed,a)}else{let t;if(e instanceof ce.H)t=e;else{const a=(0,ne.MQ)(e,"tryConnectingOfficePyServiceToExecuteCode");t=(0,ne.Uc)(u.O.GetPythonContextObjectFailed,a,void 0)}(0,ne.QX)(this.dispatch,t,!1)}}}async getPythonObjectOutputWithRetry(e){if((0,R.Ap6)())if((0,R.yw9)("OfficeVSO_10004713_fixEmptyRuntimeUrl")){const t=await this.connectToOfficePySvcToExecutePythonCodeWithRetry(e);if(t)return t}else{const t=e.getPythonContextObject();t.load(["pythonObjectReferenceIds","runtimeUrl"]),await this.requestContext.sync();const a=(0,Y.yK)(t.pythonObjectReferenceIds[0][0]);try{const n=JSON.parse(t.runtimeUrl)[0].RuntimeUrl;return await this.executePythonCodeWithRetry(a,e,n)}catch(e){const t=(0,ne.MQ)(e,"getPythonObjectOutputWithRetry"),a=(0,ne.Uc)(u.O.GetOfficePyServiceRuntimeUrlFailed,t,void 0);(0,ne.QX)(this.dispatch,a,!1)}}e.load("address");const t=await this.getPythonObjectReferenceIdWithRetry(e),a=(0,Y.yK)(t);return await this.executePythonCodeWithRetry(a,e)}async getPythonObjectOutput(e){const t=(new Date).getTime();let a;e.load("formulas"),await this.requestContext.sync();const n=e.valuesAsJson[0][0],o=(0,Y.vv)(e.formulas[0][0]);if("DataFrame"!==n.Python_typeName)a={code:o,output:await this.composePythonOutputString(n),outputType:n.Python_type};else{const t=await this.getPythonObjectOutputWithRetry(e),n=t?.result;if(!n)throw(0,ne.Uc)(u.O.PythonPayloadEmptyError,"Python payload is undefined in getPythonObjectOutput",void 0);const r=n.value,i=n.value_type,l=r.sampleRows;for(let e=0;e<l.length;e++)l[e]=(0,Y.LC)(l[e]);a={code:o,output:{columnNames:r.columnNames,dataTypes:r.dataTypes,sampleRows:l,numRows:r.numRows,numColumns:r.numColumns},outputType:i}}return(0,se.Cc)(se.xk.GetPythonObjectOutput,t,!1,`Python Object Output Type: ${a.outputType}`),a}async executeWithTimeout(e,t,a,n,o,r){const i=(new Date).getTime();let l,s=!1;const c=r||new AbortController,d=new Promise(((t,a)=>{l=window.setTimeout((()=>{c.abort(),t()}),e)})),u=t(c).finally((()=>{l&&window.clearTimeout(l),s=!0,(0,se.Cc)(a,i,!1)}));if(await Promise.race([d,u]),s)return await u;{const e=(0,g.xJ)(i);throw(0,ne.Uc)(o,`${n} after ${e} ms`,void 0)}}async connectToOfficePySvcToExecutePythonCode(e,t,a,n){const o=(new Date).getTime(),r=n||(0,Ce.A)();let i;try{i=await re.v.instance().authorizeOfficePyService(r),(0,se.l5)(se.xk.GetOfficePyServiceAccessToken,o,t)}catch(e){if((0,R.yw9)("OfficeVSO_10004713_fixEmptyRuntimeUrl")){const e=[];e.push({key:v.$.ExecutePythonCodeCorrelationId,value:r}),(0,ue.PB)(v.L3.GetOfficePyServiceAccessTokenFailed,e)}(0,se.l5)(se.xk.GetOfficePyServiceAccessToken,o,t,!0);const a=(0,ne.MQ)(e,"connectToOfficePySvcToExecutePythonCode");throw(0,ne.Uc)(u.O.GetOfficePyServiceAccessTokenFailed,a,void 0)}const l=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.ExecutePythonCodeTimeoutInMS",5e3),s=(new Date).getTime();let c,d=!1;const m=new Promise(((e,t)=>{c=window.setTimeout((()=>{e()}),l)})),h={code:e};(0,R.yw9)("OfficeVSO_10004713_passOfficePyTraceId")&&(h.traceId=r.replace(/-/g,""));const p=(0,ie.Jx)({url:a,requestToken:i}).execute(h).then((e=>(c&&window.clearTimeout(c),d=!0,(0,se.l5)(se.xk.ConnectOfficePySvcToExecutePythonCode,s,t),e))).catch((e=>{if(c&&window.clearTimeout(c),d=!0,(0,R.yw9)("OfficeVSO_10004713_passOfficePyTraceId")){(0,se.l5)(se.xk.ConnectOfficePySvcToExecutePythonCode,s,t,!0);throw(0,ne.Uc)(u.O.ConnectOfficePyServiceExecuteCodeException,`connectToOfficePySvc and executePythonCode exception. CorrelationId: ${r}.`,void 0)}throw(0,se.l5)(se.xk.ConnectOfficePySvcToExecutePythonCode,s,t),e}));if(await Promise.race([m,p]),d)return await p;{const e=(0,g.xJ)(s);throw(0,ne.Uc)(u.O.ConnectOfficePyServiceExecuteCodeTimeout,`connectToOfficePySvc and executePythonCode timed out after ${e} ms. CorrelationId: ${r}`,void 0)}}async executePythonCodeWithTimeout(e,t,a,n){if(!(0,R.yw9)("OfficeVSO_10004713_fixEmptyRuntimeUrl")&&(0,R.Ap6)()&&!n){const e=(0,ne.Uc)(u.O.GetOfficePyServiceRuntimeUrlFailed,"empty runtimeurl",void 0);(0,ne.QX)(this.dispatch,e,!1)}if((0,R.Ap6)()&&n)try{return await this.connectToOfficePySvcToExecutePythonCode(e,t,n,a)}catch(e){if((0,R.yw9)("OfficeVSO_10004713_updateExecutePythonCodeErrorToEvent")){const t=e instanceof ce.H&&e.errorDetailsNoPII?e.errorDetailsNoPII:"connectToOfficePySvcToExecutePythonCode unknown error",a=[];a.push({key:v.$.ErrorMessage,value:t}),(0,ue.PB)(v.L3.CannotConnectToOfficePyService,a)}else{let t;if(e instanceof ce.H)t=e;else{if((0,R.yw9)("OfficeVSO_10004713_fixEmptyRuntimeUrl")){const a=(0,ne.MQ)(e,"ConnectToOfficePySvcToExecutePythonCode");t=(0,ne.Uc)(u.O.ConnectToOfficePySvcToExecutePythonCodeUnexpectedError,a,e)}else{const a=(0,ne.MQ)(e,"executePythonCodeWithTimeout");t=(0,ne.Uc)(u.O.GetOfficePyServiceRuntimeUrlFailed,a,e)}(0,ne.QX)(this.dispatch,t,!1)}}}const o=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.ExecutePythonCodeTimeoutInMS",5e3),r=(new Date).getTime();let i,l=!1;const s=new Promise(((e,t)=>{i=window.setTimeout((()=>{e()}),o)})),c=OfficeFirstParty.externalCodeService.executePythonCode(e,{correlationId:a}).finally((()=>{i&&window.clearTimeout(i),l=!0,(0,se.l5)(se.xk.ExecutePythonCodeApiCall,r,t)}));if(await Promise.race([s,c]),l){const e=await c;return JSON.parse(e)}return{error_name:"executeTimedOut",error_message:`executePythonCode timed out after ${(0,g.xJ)(r)} ms`}}async executePythonCodeWithObjectReferenceRetry(e,t,a,n,o){const r=await this.getPythonObjectReferenceId(t);if(r)return e=(0,Y.yK)(r),await this.executePythonCodeWithTimeout(e,a,n,o)}async executePythonCodeWithRetry(e,t,a){let n,o=0;const r=(new Date).getTime(),i=(0,Ce.A)();if(n=await this.executePythonCodeWithTimeout(e,o++,i,a),void 0===n?.error_name&&n?.result&&n?.result.value)return n;let l;if(l=void 0!==n?.error_name?`executePythonCode API Call Failed - ErrorName: ${n?.error_name}, ErrorMessage: ${n?.error_message}`:`executePythonCode API Call Failed - Value_Type: ${n?.result.value_type}, Value: ${n?.result.value}`,(0,ue.nQ)(i,l),await Excel.run((async()=>{this.requestContext.application.calculate(Excel.CalculationType.full)})),await this.requestContext.sync(),n=await(0,Y.AJ)((async()=>await this.executePythonCodeWithObjectReferenceRetry(e,t,o,i,a)),(e=>(o++,void 0===e?.error_name&&e?.result&&e?.result.value)),await this.getMaxRetryAttempts("ExecutePythonCode"),this.RETRY_WAIT_IN_MILLISECONDS,!0,this.dispatch),void 0===n?.error_name&&n?.result&&n?.result.value)return n;const s=`executePythonCodeWithRetry:\nHResult: ${n?.hresult}\nError Name: ${n?.error_name}\nError Message: ${n?.error_message}`;if(""===n?.error_name&&""===n?.error_message)throw(0,ne.w5)(s);if(n?.result&&n?.result.value_type===le.qf.None){const e=`executePythonCodeWithRetry:\nValue_Type: ${n?.result.value_type}\nValue ${n?.result.value}}`;throw(0,ne.Pi)(e)}if("executeTimedOut"===n?.error_name){const e=(0,g.xJ)(r),t=`executePythonCodeWithRetry:\nHResult: ${n?.hresult}\nError Name: ${n?.error_name}\nError Message: ${n?.error_message}\nRetry Attempts: ${o}\nTotal Retry Wait: ${e} ms`;throw(0,ne.Uc)(u.O.ExecutePythonCodeApiCallTimeout,t,void 0)}throw(0,ne.Uc)(u.O.PythonGeneralContextError,s,void 0)}async getPythonObjectReferenceId(e){const t=e.getPythonObjectReferenceIds();await this.requestContext.sync();return t.value[0][0]}async getPythonObjectReferenceIdWithRetry(e){const t=(new Date).getTime();let a=await this.getPythonObjectReferenceId(e);if(a)return a;if(await Excel.run((async()=>{this.requestContext.application.calculate(Excel.CalculationType.full)})),await this.requestContext.sync(),a=await(0,Y.AJ)((async()=>await this.getPythonObjectReferenceId(e)),(e=>!!e),await this.getMaxRetryAttempts("GetPythonObjectReferenceId"),this.RETRY_WAIT_IN_MILLISECONDS,!0,this.dispatch),a)return(0,se.l5)(se.xk.GetPythonObjectReferenceIdWithRetry,t),a;throw(0,ne.Uc)(u.O.PythonGeneralContextError,"getPythonObjectReferenceIdWithRetry: id is undefined.",void 0)}async getErrorValue(e){e.load(["formulas","valuesAsJson"]),await this.requestContext.sync();const t=(0,Y.vv)(e.formulas[0][0]),{errorName:a,errorType:n,errorSubType:o,errorMessage:r}=(0,Y.$e)(e);let i;i=o||(a&&r?`${a}: ${r}`:"");return{code:t,output:{errorType:n,errorDetail:i},outputType:"Error"}}async getPythonCellRange(e,t){const a=(new Date).getTime(),n=this.requestContext.workbook.worksheets.getItem(e).getRange(t).getCell(0,0).load("hasSpill").track();let o;if(await this.requestContext.sync(),n.hasSpill){if(o=n.getSpillParentOrNullObject().load("isNullObject"),o.track(),n.untrack(),await this.requestContext.sync(),o.isNullObject){o.untrack();const e="getPythonCellRange: pythonCellRange is unexpectedly null for spilled Python cell.";throw(0,ne.Uc)(u.O.PythonGeneralContextError,e,void 0)}return(0,se.Cc)(se.xk.GetPythonCellRange,a,!1),o}return n}async updatePythonContextFieldsForPythonMode(e,t){const{query:a,pythonCellContext:n,pythonTableContext:o}=e,r=n&&o;if(r){const e=`updatePythonContextFields: isBothDefined: ${r}.`;throw(0,ne.Uc)(u.O.PythonInvalidSelectedContext,e,void 0)}n?this.pythonContextBuilder.setSelectedPythonCellContext(n):o&&this.pythonContextBuilder.setSelectedPythonTableContext(o),this.pythonContextBuilder.setQuery(a),await(0,se.ek)((async()=>{await this.pythonContextBuilder.updateConversationHistory(t)}),se.xk.UpdateConversationHistory)}getLastPythonCell(e){const t=this.pythonContextBuilder.getPythonConversationHistory();for(let a=t.length-1;a>=0;a--){const n=t[a];if(e&&n.query)return null;if(n.codeAndOutput&&!n.codeAndOutput.wasDeleted)return n.codeAndOutput}return null}constructor(e){this.RETRY_WAIT_IN_MILLISECONDS=1e3,this.MAX_RETRY_ATTEMPTS=10,this.MAX_RETRY_ATTEMPTS_EXECUTE_PYTHON_CODE=5,this.MAX_CODE_RETRY_ATTEMPTS=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaMaxCodeRetryAttempts",2),this.MAX_AUGLOOP_CALLS_PER_QUERY_THINK_DEEPER=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaMaxAugLoopCallsPerQuery",10),this.MAX_AUGLOOP_CALLS_PER_QUERY=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAaMaxAugLoopCallsPerQueryRegularMode",10),this.isPythonMode=!1,this.isPythonThinkDeeperMode=!1,this.isFirstCodeExecution=!0,this.pythonAnalysisSheetExistsOnUserQuerySubmit=!1,this.codeRetryAttempts=0,this.disableAutoScroll=!1,this.isAutoScrollingEnabled=!0,this.renderedCardCount=0,this.augloopCallsPerQuery=0,this.ocvErrorDetails={},this.diagnosticsEntriesMap=new Map,this.lastPythonUserRequestId="",this.queryOrigin=o.Rk.CopilotSDX,this.shouldGenerate=!0,this.getPythonExecutionTimeoutInMilliseconds=async()=>this.pythonExecutionTimeout?this.pythonExecutionTimeout:await Excel.run((async e=>{e.workbook.load(["externalCodeServiceTimeout"]),await e.sync();const t=1e3*(e.workbook.externalCodeServiceTimeout??30);return this.pythonExecutionTimeout=t+5e3,this.pythonExecutionTimeout})),this.MAX_SAMPLE_ROWS=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextMaxSampleRows",5),this.MAX_CONVERSATION_HISTORY=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextMaxConversationHistory",50),this.MAX_PYTHON_CELLS=(0,R.Z8j)("Microsoft.Office.Excel.FA000000124.PythonAdaContextMaxPythonCells",50),this.pythonContextBuilder=de.getInstance(),this.pythonTrimmedContext=xe.getInstance(),this.requestContext=e;const t=function(e){try{const t=localStorage.getItem(e);return null===t?{value:void 0,errorType:"KeyNotFound"}:{value:t,errorType:void 0}}catch(t){return{value:void 0,errorType:oe(t,"Read",e)}}}(K.PythonAaTuiShown);t.errorType?this._alreadyShownTui=!1:this._alreadyShownTui="true"===t.value}}Ee._instance=void 0,Ee.getInstance=e=>(void 0===Ee._instance&&(Ee._instance=new Ee(e)),Ee._instance);var Ie=a(940096);class Re{get dispatch(){return(0,R.yw9)("OfficeVSO_10501487_ContextManagerStore")?(0,m.KA)().dispatch:this.dispatch_DEPRECATED}lockContextRefresh(e){const t=this.mutex.tryAcquire(e);void 0!==t?this.mutexToken=t:this.mutex.logMutexTokenError("Context already locked.","ContextManager",e)}async releaseContextLock(){try{this.mutexToken?.release(),this.mutexToken=void 0,await this.updateSelection()}catch(e){}}async runWithNoContextRefresh(e){const t=void 0!==this.mutexToken;(0,d.cY)("ContextManager.runWithNoContextRefresh",{currentlyLocked:t}),t||this.lockContextRefresh();try{return await e()}finally{t||this.releaseContextLock()}}async runWithContextRefreshAndLoader(e,t=g.OP.ActionAI){this.dispatch(w.m.startExecutingCommand({command:t}));const a=void 0!==this.mutexToken;a||this.lockContextRefresh(t);try{return await e()}finally{a||await this.dispatch((0,A.L4)())}}clearMergedCellsFromActiveTable(){const e=this.activeWorksheetId,t=this.getActiveTable();if(e&&t?.tableLikeRangeFeatures){const a={hasMergedCells:!1,unsupportedFeatures:t.tableLikeRangeFeatures&~o.ye.HasMergedCells};this.dispatch((0,E.mI)(e,t.name,a))}}clearCachedTableInterpretationsForUndo(){this.dispatch(T.m.clearCachedTableInterpretationsForUndo())}isContextLocked(){return!!this.mutexToken}getActiveWorksheetName(){return this.activeWorksheetName}getActiveWorksheetId(){return this.activeWorksheetId}getPythonActiveTableSheetId(){return this.activePythonTableSheetId}getActiveTable(e=0){return this.activeTables.length?this.activeTables[e]:void 0}getSelectedTableName(e=0){return this.selectedTableNames?.length?this.selectedTableNames[e]:void 0}async getNearestTable(){if(this.activeWorksheetId&&this.activeCell){const e=await this.getClosestTableInfo(this.activeWorksheetId,this.activeCell);if(e)return e?.tabularRange?await _(e.tabularRange,e):await F(e.name,e)}}getRangeAddressesFromAddress(e){return e.includes("!")?n.ExcelCalc.localAddressesFromSheetAddresses(e).split(","):e.split(",")}getActiveRangeAddresses(){if(!this.activeRangeAddress)return[];return this.getRangeAddressesFromAddress(this.activeRangeAddress).map((e=>`${this.activeWorksheetName}!${e}`))}getActiveTableRowNumber(){return this.getActiveTable()?.numRows??0}getHumanInTheLoopRange(){return this.humanInTheLoopRange}setHumanInTheLoopRange(e){this.humanInTheLoopRange=e}setPythonAdaStaticPromptOverride(e){this.pythonAdaStaticPromptOverride=e}getSheetGoBackButtonPointTo(){return this.sheetGoBackButtonPointTo}setSheetGoBackButtonPointTo(e){this.sheetGoBackButtonPointTo=e}async getContextString(e){(0,R.yw9)("OfficeVSO_8434690_ContextManagerIntegrityCheck")&&(0,R.tgf)()&&await this.doSelectionIntegrityCheck();const t=this.getActiveTable(),a={activeTables:this.activeTables};(0,R.ZAR)()&&(a.hiddenSheetIds=this.hiddenSheetIds),this.activeUxRail&&(0,R.xyg)("CopilotUxRailsOverride")&&(a.activeUxRail={type:this.activeUxRail});const n=(0,R.geU)();if(n&&(0,R.wyh)()&&(a.activeUxRail={type:"Office Js"}),(0,R.H2A)()){const e=this.pythonContextManager.getPythonAdaContext();a.pythonAdaContext=e,(0,Y.mx)(e),(0,R.w9F)()&&this.pythonAdaStaticPromptOverride&&(a.pythonAdaContext.staticPromptOverride=this.pythonAdaStaticPromptOverride)}if((0,R.vom)()){const e=this.pythonCalculatedColumnContextManager?.getPythonCalculatedColumnContext();a.pythonCalculatedColumnContext=e}n&&(a.activeChart=this.activeChart,a.activeRange=this.activeRange,a.activePivotTable=this.activePivotTable,a.nearestChart=this.nearestChart,a.allCharts=this.allCharts),(0,R.avT)()&&(a.officeScriptsContext=C.y.getInstance().getOfficeScriptsContext()),(0,R.tgf)()&&(a.activeChart=this.activeChart,a.activeRangeAreas=this.activeRangeAreas,a.activePivotTable=this.activePivotTable),a.activeCell=this.activeCell;const r=(0,j.Qo)(this.dispatch);if(r&&(a.formulaSkillContext=await(0,j.w2)(this.dispatch,e,t)),(0,R.LrR)()){const e=this.dispatch((0,Ie.Z)());e.isLoaded&&(a.localeInfo=(0,I.Ft)(e.calcLocaleInfo),a.dataLocale=e.dataLocale)}else if(t){const e=this.dispatch((0,E.xQ)(t.name));e&&(a.localeInfo=(0,I.Ft)(e.localeCacheDeprecated.calcLocaleInfo),a.dataLocale=e.localeCacheDeprecated.dataLocale)}if(a.localeInfo&&a.dataLocale||(0,j.yT)(this.dispatch,e,"localeInfo"),a.isActiveTableCtrlT=!t?.tableLikeRange,"PAYLOAD_TOO_LARGE"===this.selectionError&&(a.unsupportedContext=(a.unsupportedContext??0)|o.b_.PayloadTooLarge),(0,R.yw9)("OfficeVSO_9679906_AlwaysSetActiveWorksheetInContext")&&this.activeWorksheetId&&this.activeWorksheetName&&(a.activeWorksheet={id:this.activeWorksheetId,name:this.activeWorksheetName}),(0,R.CpS)()&&this.activeWorksheetId&&this.activeCell){const e=await this.getClosestTableInfo(this.activeWorksheetId,this.activeCell);if(e)if(e?.tabularRange)try{a.nearestTable=await _(e.tabularRange,e)}catch(e){(0,d.cY)("Failed to add TLR nearestTable to context",e)}else try{a.nearestTable=await F(e.name,e)}catch(e){(0,d.cY)("Failed to add ctrl-t nearestTable to context",e)}if(!(0,R.yw9)("OfficeVSO_10165383_disableTlrCellBlobHarvesting")&&(0,R.Y$0)()||(0,R.JMu)()||r){const e=this.dispatch((0,E.QF)());a.workbookTables=e}}if((0,R.Y$0)()){const e=Date.now(),[t,n,o,r]=await Promise.all([N(),O(),Excel.run((async e=>{const t=e.workbook.worksheets;t.load(D),await e.sync();const a=t.items.map((e=>e.charts)),n=(0,R.bx9)(),o=a.flatMap((e=>e.items.map((e=>({chart:e,range:e.getDataRange(),jsonDOM:n?e.getContextDOM():void 0})))));return await e.sync(),{workbookCharts:o.map((e=>({worksheetId:e.chart.worksheet.id,name:e.chart.name,title:e.chart.title.text,chartType:e.chart.chartType,dataRange:e.range.value,isPivotChart:e.chart.pivotOptions.showLegendFieldButtons,jsonDOM:e.jsonDOM})))}})),Excel.run((async e=>{const t=e.workbook.pivotTables;t.load($),await e.sync(),t.items.forEach((e=>{e.hierarchies.load(H),e.rowHierarchies.load(H),e.columnHierarchies.load(H),e.filterHierarchies.load(H),e.dataHierarchies.load(U)})),await e.sync();const a=t.items.map((e=>{const t=e.columnHierarchies.items.filter((e=>"Values"!==e.name)).length,a=e.rowHierarchies.items.length,n=e.dataHierarchies.items.length,o=e.filterHierarchies.items.length;return{pivotTable:e,dataSource:e.getDataSourceString(),dataSourceType:e.getDataSourceType(),range:e.layout.getRange().load(B),columnLabelRange:t>0?e.layout.getColumnLabelRange().load(B):void 0,rowLabelRange:a>0?e.layout.getRowLabelRange().load(B):void 0,dataBodyRange:n>0?e.layout.getDataBodyRange().load(B):void 0,filterRange:o>0?e.layout.getFilterAxisRange().load(B):void 0}}));return await e.sync(),{workbookPivotTables:a.map((e=>{const{pivotTable:t,dataSource:a,dataSourceType:n,range:o,columnLabelRange:r,rowLabelRange:i,dataBodyRange:l,filterRange:s}=e;return{name:t.name,range:W(o,t.worksheet.id),columnLabelAddress:r?.address,rowLabelAddress:i?.address,dataBodyAddress:l?.address,filterAddress:s?.address,dataSourceType:n.value,dataSourceString:a.value,fields:t.hierarchies.items.map((e=>e.name)),rows:t.rowHierarchies.items.map((e=>({name:e.name,fields:e.fields.items.map((e=>e.name))}))),columns:t.columnHierarchies.items.map((e=>({name:e.name,fields:e.fields.items.map((e=>e.name))}))),filters:t.filterHierarchies.items.map((e=>({name:e.name,fields:e.fields.items.map((e=>e.name))}))),values:t.dataHierarchies.items.map((e=>({name:e.name,field:e.field.name}))),layout:{showColumnGrandTotals:t.layout.showColumnGrandTotals,showRowGrandTotals:t.layout.showRowGrandTotals,layoutType:t.layout.layoutType}}}))}}))]);y.E.getInstance().logLatency(Date.now()-e,g.OP.DocumentContextCollection),a.workbookName=t,a.worksheets=n.worksheets,(0,R.yw9)("OfficeVSO_10165383_disableTlrCellBlobHarvesting")||(a.workbookBlobRanges=this.dispatch((0,E.H7)())),Re.addChartsAndPivotTablesToDocumentContext(a,o.workbookCharts,r.workbookPivotTables)}if(a.activeWorksheet||(0,j.yT)(this.dispatch,e,"activeWorksheet"),(0,R.eFk)()){const e=this.dispatch((0,A.SW)());a.dataShapingContext=function(e){return{enableDebugging:e.enableDebugging,...e.started?{sessionId:e.sessionId,queryScript:e.queryScript,baseScript:e.baseScript,tableName:e.tableName,chatHistory:e.chatHistory}:{sessionId:void 0}}}(e)}(r||(0,R.xLF)())&&(a.queryOrigin=this.dispatch((0,A.HE)(e)),a.onGridQueryCellAddress=this.dispatch((0,A.Y4)(e))),(0,R.xLF)()&&(a.elseCategory=this.dispatch((0,A.jc)(e)));const i=new Set(["sheetRange","totalRow","tableLikeRange","tableContained"]);(0,R.tgf)()||(i.add("tableLikeRangeFeatures"),i.add("tableIntersected")),r&&(i.delete("address"),i.delete("totalRow"));const l=Object.fromEntries(Array.from(i.keys(),(e=>[e,void 0])));return JSON.stringify(a,((e,t)=>"activeTables"===e&&t?t.map((e=>({...e,tableContextOverrides:l}))):t))}static addChartsAndPivotTablesToDocumentContext(e,t,a){const n=(0,R.bzg)(),r=(0,R.tsg)(),i=e.activeWorksheet?.id;if(e.documentContextFlags=o.w2.None,t&&t.length>r){e.documentContextFlags|=o.w2.TooManyCharts;const a=(i?t.filter((e=>e.worksheetId===i)):t).slice(0,r);e.workbookCharts=a}else e.workbookCharts=t;if(a&&a.length>n){e.documentContextFlags|=o.w2.TooManyPivotTables;const t=(i?a.filter((e=>e.range?.worksheetId===i)):a).slice(0,n);e.workbookPivotTables=t}else e.workbookPivotTables=a;const l=JSON.stringify({documentContextFlags:e.documentContextFlags,pivotTableCount:a?.length??0,chartCount:t?.length??0,undefinedWorksheetId:void 0===i});y.E.getInstance().updateTelemetryChatEventData({[g.h3.ChatEventType]:g.a5.DocumentContextFlags,[g.h3.ChatEventParameters]:l},x.M.getInstance())}getQueryIdShouldNotShowFluxResponse(){return this.queryIdShouldNotShowFluxResponse}setQueryIdShouldNotShowFluxResponse(e){this.queryIdShouldNotShowFluxResponse=e}isTableHeaderShown(e=0){return this.activeTables.length>0&&!!this.activeTables[e].headers}async ensureSheetName(e,t){return e||(t===this.activeWorksheetId&&this.activeWorksheetName?this.activeWorksheetName:await Excel.run({delayForCellEdit:!0},(async e=>{const a=e.workbook.worksheets.getItem(t);return a.load("name"),await e.sync(),a.name})))}async initPublic(e){return(0,R.yw9)("OfficeVSO_10501487_ContextManagerStore")||(this.dispatch_DEPRECATED=e),this.initMemo.promise()}async init(){const e=performance.now();try{await this.pythonContextManager.init(this.dispatch);const e=(0,R.eFk)();y.E.getInstance().setInitContextTime(),await this.updateSelection(),(0,R.avT)()&&(await C.y.getInstance().initOfficeScriptsContext(),(0,R.Lap)()&&await C.y.getInstance().checkIfFlowCreatedFromPowerAutomate()),e&&await(0,J.uR)(),await Excel.run({delayForCellEdit:!0},(async t=>{try{const e=t.workbook.worksheets.getActiveWorksheet().load(["protection/protected","protection/isPaused"]);await t.sync(),e.protection.protected&&!e.protection.isPaused&&this.dispatch(T.m.setIsWorksheetProtected(!0))}catch(e){if(!(e instanceof OfficeExtension.Error&&"InvalidSelection"===e.code))throw e;this.setSelectionError("INVALID_SELECTION"),this.dispatch(T.m.setIsWorksheet(!1))}t.workbook.load(["autoSave"]),t.workbook.worksheets.onSelectionChanged.add((async e=>{this.mutexToken?((0,d.cY)("ContextManager.onSelectionChanged skipped"),this.mutexToken.logSelectionChangeEvent()):((0,d.cY)("ContextManager.onSelectionChanged called",e),await this.updateSelection())})),t.workbook.worksheets.onDeactivated.add((async()=>{await this.onWorksheetDeactivated()})),t.workbook.onAutoSaveSettingChanged.add((async()=>{await this.updateSelection()})),t.workbook.worksheets.onChanged.add((0,d.g5)((async e=>{if(this.mutexToken)return;const t=this.getActiveTable();t?.tableLikeRange&&await this.isWorksheetChangeWithinTable(e,t)&&await this.refreshActiveTable(!0,t.name)}),250)),(0,R.yw9)("OfficeVSO_9451523_renameWorksheetAssortedIssues")&&t.workbook.worksheets.onNameChanged.add((async e=>{this.mutexToken||(await this.dispatch((0,E.fx)(e.worksheetId)),await this.updateSelection()),e.nameBefore!==e.nameAfter&&this.getSheetGoBackButtonPointTo()===e.worksheetId&&(0,h.s_)(h.H0.UpdateGoBackToData,e.nameBefore,e.nameAfter)})),t.workbook.worksheets.onFormatChanged.add((async e=>{if(this.mutexToken)return;if(e.worksheetId!==this.activeWorksheetId)return;const t=this.getActiveTable()?.address;t?.includes("!")&&n.ExcelCalc.IExcelRangeIntersect(n.ExcelCalc.addressToExcelRange(e.address),n.ExcelCalc.addressToExcelRange(t.split("!")[1]))&&this.debouncedOnFormatChangeHandler(e)})),t.workbook.worksheets.onRowSorted.add((0,d.g5)((async e=>{if(this.mutexToken)return;const t=await this.getTableNameFromWorksheetIdAndAddress(e.worksheetId,e.address);void 0!==t&&t===this.getActiveTable()?.name&&this.clearTableAndInvalidateNL(t),await this.refreshActiveTable(!0,t)}),0)),t.workbook.tables.onAdded.add((0,d.g5)((async t=>{(0,R.geU)()&&this.isContextLocked()||("Local"===t.source&&(this.fetchAndSetActiveTable(t.tableId),(0,R.avT)()&&C.y.getInstance().addTable(t.tableId)),e&&await(0,J.Vq)(t.tableId))}),0)),t.workbook.tables.onChanged.add((async e=>{this.mutexToken?(0,d.cY)("ContextManager.tables.onChanged refreshActiveTable skipped"):void 0!==e.tableId&&e.tableId===this.getActiveTable()?.id&&this.debouncedTableOnChangeHandler(e)})),t.workbook.tables.onFiltered.add((0,d.g5)((async e=>{await this.onTablesFiltered(e)}),0)),t.workbook.worksheets.onActivated.add((async()=>{this.mutexToken?(0,d.cY)(d.SA.Verbose,"ContextManager.worksheets.onActivated skipped"):(await this.updateSelection(),await this.refreshActiveTable(!1))})),t.workbook.tables.onDeleted.add((async t=>{this.activeTables=this.activeTables.filter((e=>e.name!==t.tableName)),this.dispatch((0,E.o4)(t.tableName)),(0,R.avT)()&&C.y.getInstance().removeTable(t.tableName),e&&(0,J.q9)(t.tableName)})),t.workbook.worksheets.onProtectionChanged.add((async e=>{this.onProtectionChanged(e)})),t.workbook.worksheets.onDeleted.add((async e=>{this.mutexToken||"Local"===e.source||e.worksheetId===this.activeWorksheetId&&await this.updateSelection()})),this.updateHiddenSheetIds(),t.workbook.worksheets.onVisibilityChanged.add((async e=>{this.updateHiddenSheetIds()})),await t.sync(),t.workbook.autoSave||this.dispatch(T.m.setIsWorkbookAutoSaved(t.workbook.autoSave))})),y.E.getInstance().updateTelemetryChatEventData({[g.h3.ChatEventType]:g.a5.ContextManagerInitialized},x.M.getInstance())}catch(e){throw x.M.getInstance().logErrorCode(u.O.ContextManagerInitializationFailed,e),e}finally{x.M.getInstance().logDuration("ContextManagerInitialization",performance.now()-e)}}setActivePythonTableProps(e){this.activePythonTableSheetId=e}setActiveTable(e,t=!1,a){e?(t?this.activeTables.push(e):this.activeTables=[e],(0,h.s_)(h.H0.RemoveGoBackToData)):this.activeTables=[],this.setActivePythonTableProps(a),this.dispatch((0,E.GL)(e))}setActiveChart(e){this.activeChart=e,(0,R.geU)()&&this.dispatch(T.m.setActiveChart(e))}setNearestChart(e){this.nearestChart=e}setAllCharts(e){this.allCharts=e}setActivePivotTable(e){this.activePivotTable=e,(0,R.geU)()&&this.dispatch(T.m.setActivePivotTable(e))}setActiveRange(e){this.activeRange=e,(0,R.geU)()&&this.dispatch(T.m.setActiveRange(e))}async onWorksheetDeactivated(){await Excel.run((async e=>{try{e.workbook.worksheets.getActiveWorksheet(),await e.sync()}catch(e){(0,d.cY)("!==== "+e),this.setSelectionError("INVALID_SELECTION"),this.dispatch(T.m.setIsWorksheet(!1))}return Promise.resolve()}))}setSelectionError(e){(0,R.ZAR)()&&"INVALID_SELECTION"!==e||("PAYLOAD_TOO_LARGE"===e&&e!==this.selectionError&&x.M.getInstance().logStandardizedAshaErrorEvent(c.W.User_Input_Could_Not_Be_Processed,s.c.Input_Failed_Due_To_Memory,g.BJ.AnalyzeData),this.selectionError=e,this.dispatch(T.m.setSelectionError(e)))}clearSelectionError(){this.selectionError=void 0,this.dispatch(T.m.setSelectionError(void 0))}setHasTFCDeliveredQueryResult(){this.hasTFCDeliveredQueryResult=!0}getHasTFCDeliveredQueryResult(){return(0,R.ZAR)()&&this.hasTFCDeliveredQueryResult}async handleBlankContextForPythonAa(e,t){try{e&&(this.isPythonCellSelected=!1,this.selectedPythonSheetId=t,this.selectedPythonAddress=e)}catch(e){return void(0,d.cY)(d.SA.Warning,e)}}loadSelectionDetails(e){const t=e.workbook,a=t.worksheets.getActiveWorksheet(),n=t.getSelectedRanges(),o=t.getActiveCell(),r=n.areas,i=a.getUsedRangeOrNullObject(),l=(0,R.ZAR)()?n.getTables():void 0;return r.load("items/address"),n.load("address"),o.load("address"),a.load("name,id,protection/protected,protection/isPaused"),t.load("autoSave"),l?.load("items/name"),{workbook:t,selectedSheet:a,selectedRanges:n,selectedCell:o,selectedAreas:r,selectedTables:l,usedRange:i}}getSelectedAddress(e){const{selectedRanges:t,selectedCell:a,selectedAreas:n,selectedTables:o,selectedSheet:r}=e;this.activeWorksheetName=r.name,this.activeWorksheetId=r.id,this.activeCell=a.address?(0,Q.r)(a.address):void 0,(0,R.ZAR)()&&(this.activeRangeAreas=t.address,this.selectedTableNames=o?.items.map((e=>e.name)));const i=n.items.map((e=>e.address)),l=i.length;return l>0?i[l-1]:void 0}async updateSelection(){if(this.isUpdatingSelection)this.pendingSelection=!0;else{this.isUpdatingSelection=!0;try{await Excel.run({delayForCellEdit:!0},(async e=>{const t=this.loadSelectionDetails(e),{selectedSheet:a,workbook:n,usedRange:o}=t;await e.sync();const r=n.autoSave;if(this.dispatch(T.m.setIsWorkbookAutoSaved(r)),!r)return;const i=a.name,l=a.id,s=o.isNullObject,c=this.getSelectedAddress(t),d=a.protection.protected&&!a.protection.isPaused;if(this.dispatch(T.m.setIsWorksheetProtected(d)),this.dispatch(T.m.setIsWorksheet(!0)),await this.registerChartActivationHandlers(a,l,e),(0,R.geU)()&&await this.updateActiveRange(e,c,l),!(0,R.ZAR)()&&s)return"BLANK_WORKSHEET"!==this.selectionError&&x.M.getInstance().logEvent((0,g.SV)(g.he.SuggestionShown,g.q.SampleData)),this.setActiveTable(void 0),this.setSelectionError("BLANK_WORKSHEET"),void this.handleBlankContextForPythonAa(c,l);try{await this.setContextWithAddressValidation(l,i,c)}catch(e){this.setActiveTable(void 0),this.isInvalidSelection(e)?this.setSelectionError("INVALID_SELECTION"):(this.setSelectionError("UNKNOWN_ERROR"),x.M.getInstance().logErrorCode(u.O.SetContextWithAddressValidationFailed,e))}}))}catch(e){if(this.isInvalidSelection(e))return this.setSelectionError("INVALID_SELECTION"),void this.setActiveTable(void 0);let t=u.O.UpdateSelectionFailed;e instanceof OfficeExtension.Error&&"PropertyNotLoaded"===e.code&&!this.pendingSelection&&(this.pendingSelection=!0,t=u.O.UpdateSelectionFailedWillRetry),x.M.getInstance().logErrorCode(t,e)}finally{this.isUpdatingSelection=!1,this.pendingSelection&&(this.pendingSelection=!1,await this.updateSelection())}}}isInvalidSelection(e){return e instanceof OfficeExtension.Error&&"InvalidSelection"===e.code}async updateHiddenSheetIds(){(0,R.ZAR)()&&await Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.worksheets;t.load("items/id, items/visibility"),await e.sync(),this.hiddenSheetIds=t.items.filter((e=>e.visibility!==Excel.SheetVisibility.visible)).map((e=>e.id))}))}async registerChartActivationHandlers(e,t,a){if(this.worksheetsWithChartsOnActivated.includes(t))return;const n=(0,R.geU)()||(0,R.tgf)(),o=async()=>{this.setActiveChart(void 0)};n&&e.charts.onDeactivated.add(o),e.charts.onActivated.add((async e=>{n?await this.updateActiveChart(e):this.setChartSelectedError()})),await a.sync(),this.worksheetsWithChartsOnActivated.push(t)}setChartSelectedError(){this.setActiveTable(void 0),this.setSelectionError("CHART_SELECTED")}makeChartContext(e,t){return{name:e.name,title:e.title.text,chartType:e.chartType,series:(e.series??[]).map((e=>e.name)),dataSource:e["data range"],jsonDOM:t}}async updateActiveChart(e){try{await Excel.run({delayForCellEdit:!0},(async t=>{const a=(0,R.bx9)(),n=t.workbook.worksheets.getItemOrNullObject(e.worksheetId).charts.getItemOrNullObject(e.chartId);if(a){if(await t.sync(),n.isNullObject)throw new Error("Chart is null object");const e=n.getContextDOM();await t.sync();const a=JSON.parse(e.value);this.setActiveChart(this.makeChartContext(a,e.value))}else{const e="series/items/name,chartType,title/text,isNullObject";if(n.load(e),await t.sync(),n.isNullObject)throw new Error("Chart is null object");this.setActiveChart({title:n.title.text,series:n.series.items.map((e=>e.name)),chartType:"string"==typeof n.chartType?n.chartType:Excel.ChartType[n.chartType]})}this.setActiveRange(void 0),this.setChartSelectedError()}))}catch(e){x.M.getInstance().logErrorCode(u.O.SetActiveChartFailed,e),this.setActiveChart(void 0)}}async onTablesFiltered(e){await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.tables.getItem(e.tableId);a.load("name"),await t.sync(),await this.refreshActiveTable(!0,a.name)}))}async onProtectionChanged(e){e.worksheetId===this.activeWorksheetId&&(e.isProtected?await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.worksheets.getItem(e.worksheetId).load(["protection/protected","protection/isPaused"]);await t.sync(),this.dispatch(T.m.setIsWorksheetProtected(a.protection.protected&&!a.protection.isPaused))})):this.dispatch(T.m.setIsWorksheetProtected(e.isProtected)))}async fetchAndSetActiveTableLikeEntity(e){const t=this.dispatch((0,E.m)(e));try{if(t)await this.fetchAndSetTabularRangeAsActiveTable(t);else{if(e.includes("!"))throw new Error(u.O.TLRNotFound);await this.fetchAndSetActiveTable(e)}}catch(e){x.M.getInstance().logErrorCode(u.O.FetchAndSetActiveTableLikeEntityFailed,e)}}async fetchAndSetActiveTable(e,t=!1,a){if(this.tooLargeTableIds.includes(e))return;const n=performance.now();try{const n=await F(e,a);n?(this.setActiveTable(n,t),this.dispatch((0,E.Wc)({type:le.lp.StandardTable,table:n}))):this.setActiveTable(void 0)}catch(t){x.M.getInstance().logErrorCode(u.O.FetchAndSetActiveTableFailed,t),this.setActiveTable(void 0),z(t)?(this.pendingSelectionError="PAYLOAD_TOO_LARGE",this.tooLargeTableIds.push(e)):this.setSelectionError("UNKNOWN_ERROR")}finally{x.M.getInstance().logDuration("FetchAndSetActiveTable",performance.now()-n)}}async fetchAndSetActiveTableArray(e){try{let t=[];if(this.selectedTableNames)for(const e of this.selectedTableNames)await this.fetchAndSetActiveTable(e,!0);if(this.activeRangeAreas){t=this.activeRangeAreas.split(",").map((t=>this.dispatch((0,E.oR)(e,t)))).flat();for(const e of t)await this.fetchAndSetTabularRangeAsActiveTable(e,!0)}this.selectedTableNames?.length||t?.length||this.setActiveTable(void 0)}catch(e){this.setActiveTable(void 0),(0,d.cY)(e)}}async getTableNamesUndefinedForDeletedTables(e){return await Excel.run({delayForCellEdit:!0},(async t=>{const a=e.map((e=>{const a=t.workbook.tables.getItemOrNullObject(e);return a.load("name"),a}));await t.sync();return a.map((e=>{if(!e.isNullObject)return e.name;(0,d.cY)("Table not found in getTableNamesUndefinedForDeletedTables - likely recently deleted")}))}))}async clearTableAndInvalidateNLResultFromId(e){if(this.pendingTableClear.add(e),this.isTableClearing)return;this.isTableClearing=!0;const t=Array.from(this.pendingTableClear);this.isTableClearing=!1,this.pendingTableClear.clear();(await this.getTableNamesUndefinedForDeletedTables(t)).filter((e=>void 0!==e)).forEach((e=>this.clearTableAndInvalidateNL(e)))}clearTableAndInvalidateNL(e){this.dispatch(T.m.clearTable(e)),this.dispatch((0,A.YS)())}async getClosestTableInfo(e,t){if(!t)return;const a=await Excel.run({delayForCellEdit:!0},(async t=>await l().getTablesNameToRangeMapOnSheet(t,e)));let o,r;const i=this.getRangeAddressesFromAddress(t);for(const t of i){if(Object.keys(a).length>0){const e=Object.keys(a);for(const r of e){const e=a[r],i=n.ExcelCalc.addressToExcelRange(t);if(n.ExcelCalc.IExcelRangeContainedIn(i,e.range))return{name:r,distance:0,isContained:!0};if(n.ExcelCalc.IExcelRangeIntersect(i,e.range))return{name:r,distance:0};{const t=(0,S._)(i,e.range);(!o||t<o.distance)&&(o={name:r,distance:t})}}}const i=this.dispatch((0,E.Vy)(e,t));(!r||i&&i.distance<r.distance)&&(r=i)}return 0===o?.distance?o:o?.distance&&0!==r?.distance?(r?.distance&&r.distance<o.distance&&(o=r),o):r}async getNearestChartContext(e,t){return t&&(0,R.bx9)()?await Excel.run((async a=>{let o=null;const r=a.workbook.worksheets.getItemOrNullObject(e);if(await a.sync(),r.isNullObject)return o;if(r.load("charts"),await a.sync(),0===r.charts.items.length)return o;if(!r.charts.items[0].getContextDOM){const e=r.charts.items[0];e.load(this.chartLoadOptions);const t=e.getDataRange();return await a.sync(),o={name:e.name,title:e.title.text,chartType:e.chartType,series:e.series.items.map((e=>e.name)),dataSource:t.value,jsonDOM:void 0},o}const i=r.charts.items.map((e=>({jsonDOM:e.getContextDOM()})));await a.sync();let l,s=Number.MAX_VALUE;return l=-1===t.indexOf("!")?n.ExcelCalc.addressToExcelRange(t):n.ExcelCalc.sheetAddressToExcelSheetRange(t).range,i.forEach((e=>{const t=JSON.parse(e.jsonDOM.value);let a;a=t["location range"]?{topLeft:{row:t["location range"].top,column:t["location range"].left},bottomRight:{row:t["location range"].bottom,column:t["location range"].right}}:n.ExcelCalc.addressToExcelRange(t["data range"]);const r=(0,S._)(a,l);r<s&&(s=r,o=this.makeChartContext(t,e.jsonDOM.value))})),o})):null}async getAllCharts(e){return await Excel.run((async t=>{let a=[];if(!(0,R.bx9)())return a;const n=t.workbook.worksheets.getItemOrNullObject(e).load("isNullObject");if(await t.sync(),n.isNullObject)return a;if(n.load("charts"),await t.sync(),0===n.charts.items.length)return a;if(!n.charts.items[0].getContextDOM){n.charts.load(this.chartLoadOptions),await t.sync();const e=n.charts.items.map((e=>({chart:e,dataSource:e.getDataRange()})));return await t.sync(),a=e.map((e=>({name:e.chart.name,title:e.chart.title.text,chartType:e.chart.chartType,series:e.chart.series.items.map((e=>e.name)),dataSource:e.dataSource.value,jsonDOM:void 0}))),a}const o=n.charts.items.map((e=>({jsonDOM:e.getContextDOM()})));return await t.sync(),a=o.filter((e=>e.jsonDOM)).map((e=>{const t=JSON.parse(e.jsonDOM.value);return this.makeChartContext(t,e.jsonDOM.value)})),a}))}async doesRangeContainPivotTable(e,t){try{return await Excel.run({delayForCellEdit:!0},(async a=>{const n=this.getRangeAddressesFromAddress(t)[0],o=a.workbook.worksheets.getItem(e).getRange(n).getPivotTables().getCount();return await a.sync(),o.value>0}))}catch(e){return x.M.getInstance().logErrorCode(u.O.FetchPivotTableFailed,e),!1}}async setContext(e,t){this.isPythonCellSelected=await this.pythonContextManager.isPythonCell(e,t),this.selectedPythonSheetId=e,this.selectedPythonAddress=t;let a=!1;if((0,R.geU)()){if(this.activeChart)this.setNearestChart(this.activeChart);else{const a=await this.getNearestChartContext(e,t);this.setNearestChart(a??void 0)}const a=await this.getAllCharts(e);this.setAllCharts(a)}if((0,R.ZAR)()&&this.activeRangeAreas){if(this.activeTables=[],await this.fetchAndSetActiveTableArray(e),this.activeTables.length)return}else{this.setActivePivotTable(void 0);const n=await this.getClosestTableInfo(e,t);if(n){if(n?.tabularRange?await this.fetchAndSetTabularRangeAsActiveTable(n.tabularRange,void 0,n):await this.fetchAndSetActiveTable(n.name,void 0,n),!(0,R.tgf)())return;a=!!n}}let n,o=!1;if((0,R.tgf)()?n=await this.fetchActivePivotTable(e,t):o=await this.doesRangeContainPivotTable(e,t),o||n)return((0,R.geU)()||(0,R.tgf)())&&(n&&this.setActivePivotTable(n),a||this.setActiveTable(void 0)),void this.setSelectionError("PIVOT_TABLE_SELECTED");if((0,R.tgf)()){if(a)return void(this.pendingSelectionError?(this.setSelectionError(this.pendingSelectionError),this.pendingSelectionError=void 0):this.clearSelectionError());if(await this.fetchAndSetUnrecognizedRange(e))return}this.setNoTableSelectedError()}getPivotTableAttributes(e){return{name:e.name,hierarchies:e.hierarchies.items.map((e=>e.name)),columnHierarchies:e.columnHierarchies.items.map((e=>e.name)),dataHierarchies:e.dataHierarchies.items.map((e=>e.name)),filterHierarchies:e.filterHierarchies.items.map((e=>e.name)),rowHierarchies:e.rowHierarchies.items.map((e=>e.name))}}async fetchActivePivotTable(e,t){let a=u.O.FetchPivotTableFailedToLoadRange;const n=performance.now();try{return await Excel.run({delayForCellEdit:!0},(async n=>{const o=n.workbook.worksheets.getItem(e).getRanges(t).areas;o.load("items/isNullObject"),await n.sync();a=u.O.FetchActivePivotTableFailed;const r=o.items.map((e=>{const t=e.getPivotTables().getFirstOrNullObject();return t.load("name,columnHierarchies/items/name,dataHierarchies/items/name,filterHierarchies/items/name,hierarchies/items/name,rowHierarchies/items/name"),t}));await n.sync();const i=r.find((e=>!e.isNullObject));if(i)return this.getPivotTableAttributes(i)}))}catch(e){return x.M.getInstance().logErrorCode(a,e),void(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidArgument&&(0,d.cY)(d.SA.Error,a,e.code,e.debugInfo.errorLocation,t,this.activeWorksheetName))}finally{x.M.getInstance().logDuration("FetchActivePivotTable",performance.now()-n)}}async setContextWithAddressValidation(e,t,a){this.activeWorksheetId=e,this.activeWorksheetName=t,this.activeRangeAddress=a,a?await this.setContext(e,a):(this.setActiveTable(void 0),this.setSelectionError("NOTHING_SELECTED"))}async fetchAndSetTabularRangeAsActiveTable(e,t=!1,a){const n=performance.now();try{const n=await _(e,a),o=e.interpretation.location.worksheetId;this.setActiveTable(n,t,o),this.selectionError=void 0,this.dispatch((0,E.Wc)({type:le.lp.TableLikeRange,table:n})),(0,R.tgf)()||this.clearSelectionError()}catch(e){if(this.setActiveTable(void 0),x.M.getInstance().logErrorCode(u.O.FetchAndSetTabularRangeAsActiveTableFailed,e),z(e))return void(this.pendingSelectionError="PAYLOAD_TOO_LARGE")}finally{x.M.getInstance().logDuration("FetchAndSetTabularRangeAsActiveTable",performance.now()-n)}}async fetchAndSetUnrecognizedRange(e){const t=performance.now(),a=e=>e instanceof OfficeExtension.Error&&(e.code===Excel.ErrorCodes.itemNotFound||e.code===Excel.ErrorCodes.invalidSelection);try{return await Excel.run({delayForCellEdit:!0},(async t=>{const r=t.workbook.getActiveCell(),i=r.getSurroundingRegion(),l=i.getPivotTables().getCount(),s=["numberFormat","numberFormatCategories","text"];s.push("numberFormatLocal"),r.load("valuesAsJson, isNullObject"),i.load(["address","rowCount","columnCount","cellCount"]);const c=i.getRow(0).load(s),u=i.getLastRow().load(["text"]);let m,h,g,p,b,C,y,v;(0,R.ZAR)()&&(y=i.getTables().getCount(),v=()=>{const t=this.dispatch((0,E.Vy)(e,i.address));return!!t&&0===t.distance});try{if(await t.sync(),i.cellCount<4||l.value>0||y&&y.value>0||v?.())return;m=i.rowCount,h=i.columnCount,g=c.text,C=u.text,p=q(c),b=c.numberFormatCategories}catch(e){if(a(e))return;throw(0,d.cY)(d.SA.Error,e),e}const x=G(g),T=G(C),S=G(p);let w=()=>Array.from({length:h},((e,t)=>t));const I=t.workbook.getActiveCell().getSurroundingRegion(),A=Array.from({length:h},((e,t)=>t)).map(((e,t)=>{const a=I.getCell(0,t);return a.load("hidden"),{index:t,cell:a}}));w=()=>A.filter((({cell:e})=>!e.hidden)).map((({index:e})=>e));const L=G(b),k=n.ExcelCalc.sheetAddressToExcelSheetRange(i.address);await t.sync();const F=w(),_={name:i.address,address:i.address,headers:f.r$C,numRows:m,numColumns:h,firstRowValues:x,lastRowValues:T,numberFormats:S,numberFormatCategories:L,visibleColumns:F,sheetRange:k,totalRow:!1,tableLikeRange:!0,tableContained:!0,tableIntersected:!0,tableLikeRangeFeatures:o.ye.Unrecognized};return this.setActiveTable(_,void 0,e),this.dispatch((0,E.Wc)({type:le.lp.Range,table:_})),this.clearSelectionError(),i.address}))}catch(e){if(a(e))return;return x.M.getInstance().logErrorCode(u.O.FetchAndSetUnrecognizedRangeFailed,e),z(e)?void(this.pendingSelectionError="PAYLOAD_TOO_LARGE"):void 0}finally{x.M.getInstance().logDuration("FetchAndSetUnrecognizedRange",performance.now()-t)}}async isWorksheetChangeWithinTable(e,t){try{return await Excel.run({delayForCellEdit:!0},(async a=>{if(e.worksheetId!==this.activeWorksheetId||t.sheetRange.sheet!==this.activeWorksheetName||e.changeType===Excel.DataChangeType.unknown||!e.address)return!1;const n=(0,Q.r)(t.address),o=a.workbook.worksheets.getItemOrNullObject(t.sheetRange.sheet),r=a.workbook.worksheets.getItemOrNullObject(e.worksheetId).getRanges(e.address),i=o.getRanges(n),l=r.getIntersectionOrNullObject(i);return await a.sync(),!l.isNullObject}))}catch(e){return x.M.getInstance().logErrorCode(u.O.CheckIntersectingRemoteChangesFailed,e,void 0,void 0,(0,g.RE)(Le)),!1}}async updateActiveRange(e,t,a){try{const n=e.workbook,o=n.getActiveChartOrNullObject();if(await e.sync(),!o.isNullObject)return;const r=a?n.worksheets.getItem(a):n.worksheets.getActiveWorksheet(),i=t?r.getRange(t):n.getSelectedRange();i.load(["rowCount","columnCount","rowIndex","columnIndex","address"]);const l=2,s=10,c=["text","rowIndex","columnIndex"],d=["areas/items/rowCount","areas/items/columnCount","areas/items/rowIndex","areas/items/columnIndex"],u=i.getIntersection(i.getAbsoluteResizedRange(s,s)),m=i.getMergedAreasOrNullObject();await e.sync();const{columnCount:h,columnIndex:g,rowCount:p,rowIndex:b}=i;if(h*p>1){u.load(c),m.load(d);const t={topLeft:{range:u,mergedAreas:m}},a=b+p,n=g+h;if(p>s){const e=r.getRangeByIndexes(a-l,g,l,Math.min(s,h)).load(c),n=e.getMergedAreasOrNullObject().load(d);t.lastRows={range:e,mergedAreas:n}}if(h>s){const e=r.getRangeByIndexes(b,n-l,Math.min(s,p),l).load(c),a=e.getMergedAreasOrNullObject().load(d);t.lastCols={range:e,mergedAreas:a}}if(h>s&&p>s){const e=r.getRangeByIndexes(a-l,n-l,l,l).load(c),o=e.getMergedAreasOrNullObject().load(d);t.bottomRight={range:e,mergedAreas:o}}await e.sync();for(const e of Object.values(t)){const{range:t,mergedAreas:a}=e,n=e.values=t.text;if(!a.isNullObject)for(const e of a.areas.items){const a=e.rowIndex-t.rowIndex,o=e.columnIndex-t.columnIndex;if(a>=n.length||o>=n[o].length)continue;const r=n[a][o];for(let t=a;t<a+e.rowCount&&t<n.length;t++)for(let a=o;a<o+e.columnCount&&a<n[t].length;a++)n[t][a]=r}}this.setActiveRange({address:i.address,numRows:i.rowCount,numCols:i.columnCount,topLeftValues:t.topLeft.values,lastRowsValues:t.lastRows?.values,lastColsValues:t.lastCols?.values,bottomRightValues:t.bottomRight?.values})}else this.setActiveRange(void 0)}catch(e){(0,d.cY)(e),this.setActiveRange(void 0)}}setNoTableSelectedError(){this.setActiveTable(void 0),this.setActivePivotTable(void 0),this.setSelectionError("NO_TABLE_SELECTED")}async getTableNameFromWorksheetIdAndAddress(e,t){const a=await this.getClosestTableInfo(e,t);return a?.name}async doSelectionIntegrityCheck(){const e=performance.now();let t=u.O.SelectionIntegrityCheckFlushingSelectionFailed;try{return await Excel.run({delayForCellEdit:!0},(async e=>{this.isUpdatingSelection=!1,this.pendingSelection&&((0,d.cY)("Flushing pending selection update in doSelectionIntegrityCheck"),this.pendingSelection=!1,await this.updateSelection()),t=(0,R.ZAR)()?void 0:u.O.SelectionIntegrityCheckEncounteredNonWorksheet;const a=e.workbook.worksheets.getActiveWorksheet();a.load("id"),await e.sync(),t=(0,R.ZAR)()?void 0:u.O.SelectionIntegrityCheckEncounteredNoGridSelection;const n=e.workbook.getSelectedRanges();n.load("address,areas/isNullObject,worksheet/id");const o=n.areas.getItemAt(0);o.load("address,worksheet/id,worksheet/name");const r=e.workbook.getActiveCell();r.load("address,worksheet/id");const i=(0,R.ZAR)()?n.getTables().load("name"):void 0;if(await e.sync(),t=u.O.SelectionIntegrityCheckFailed,o.worksheet.id===a.id&&r.worksheet.id===a.id&&o.worksheet.id===r.worksheet.id||x.M.getInstance().logError({eventType:v.S2.ContextManager,errorMessage:"OfficeJS reported inconsistent worksheet ID between active worksheet, selected range, and active cell",logLevel:X.$b.Warning}),(0,R.ZAR)()){const e=this.selectedTableNames?.sort().join(","),a=i.items.map((e=>e.name)).sort().join(",");if(a!==e){const n=!e&&a?u.O.SelectionIntegrityCheckFoundNoTableButOneShouldBePresent:u.O.SelectionIntegrityCheckFoundTableMismatch;x.M.getInstance().logErrorCode(t,new Error(n)),await this.setContextWithAddressValidation(o.worksheet.id,o.worksheet.name,o.address)}}else{const e=await this.getClosestTableInfo(o.worksheet.id,o.address),a=this.getActiveTable();if(e?.name!==a?.name&&"PAYLOAD_TOO_LARGE"!==this.selectionError){const n=!a&&e?u.O.SelectionIntegrityCheckFoundNoTableButOneShouldBePresent:u.O.SelectionIntegrityCheckFoundTableMismatch;x.M.getInstance().logErrorCode(t,new Error(n)),await this.setContextWithAddressValidation(o.worksheet.id,o.worksheet.name,o.address)}}}))}catch(e){if(void 0===t)return;if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidSelection)return;x.M.getInstance().logErrorCode(t,e)}finally{x.M.getInstance().logDuration("DoSelectionIntegrityCheck",performance.now()-e)}}constructor(e){this.selectionError=void 0,this.pendingSelectionError=void 0,this.tooLargeTableIds=[],this.activeWorksheetName=void 0,this.activeWorksheetId=void 0,this.activeRangeAddress=void 0,this.activeTables=[],this.activeRangeAreas=void 0,this.selectedTableNames=void 0,this.activeCell=void 0,this.hiddenSheetIds=[],this.activeRange=void 0,this.activeChart=void 0,this.nearestChart=void 0,this.allCharts=void 0,this.activePivotTable=void 0,this.activeUxRail=void 0,this.humanInTheLoopRange=void 0,this.worksheetsWithChartsOnActivated=[],this.pendingSelection=!1,this.isUpdatingSelection=!1,this.isTableClearing=!1,this.pendingTableClear=new Set,this.sheetGoBackButtonPointTo=void 0,this.hasTFCDeliveredQueryResult=!1,this.isPythonCellSelected=!1,this.selectedPythonSheetId=void 0,this.selectedPythonAddress=void 0,this.pythonAdaStaticPromptOverride=void 0,this.activePythonTableSheetId=void 0,this.calculatedFormulaInsertLocation=void 0,this.queryIdShouldNotShowFluxResponse=void 0,this.initMemo=new p.d((async()=>{await this.init()})),this.refreshSelectionContext=(0,r.debounce)((async()=>{if(!this.mutexToken)return await this.updateSelection()}),0),this.refreshActiveTable=(0,d.g5)((async(e,t)=>{const a=this.getActiveTable();if((!e||t===a?.name)&&a)try{await this.dispatch((0,E.v)(a))}catch(e){const t=v.S2.AnalyzeDataError;x.M.getInstance().logErrorCode(u.O.RefreshActiveTableFailed,e,t,void 0,(0,g.RE)(Le))}}),500),this.chartLoadOptions={name:!0,chartType:!0,title:{text:!0},series:{name:!0}},this.debouncedOnFormatChangeHandler=(0,d.g5)((async e=>{if(this.getActiveTable()?.name){const t=await this.getTableNameFromWorksheetIdAndAddress(e.worksheetId,e.address);void 0!==t&&t===this.getActiveTable()?.name&&this.clearTableAndInvalidateNL(t)}if("Local"===e.source)await this.updateSelection();else if(this.getActiveTable())if((0,R.geU)())await this.updateSelection();else{await this.getTableNameFromWorksheetIdAndAddress(e.worksheetId,e.address)===this.getActiveTable()?.name&&await this.updateSelection()}}),f.gtW),this.debouncedTableOnChangeHandler=(0,d.g5)((async e=>{await this.fetchAndSetActiveTable(e.tableId);(e.changeType!==Excel.DataChangeType.rangeEdited||void 0===e.details||e.details.valueBefore!==e.details.valueAfter)&&await this.refreshActiveTable(!1),await this.clearTableAndInvalidateNLResultFromId(e.tableId)}),f.gtW),this.mutex=new b.e,this.pythonContextManager=new Ee(e),(0,R.vom)()&&(this.pythonCalculatedColumnContextManager=new Z)}}function Ae(e){return!e.tableLikeRange}const Le=new Re(new Excel.RequestContext)},800862:(e,t,a)=>{"use strict";a.d(t,{J:()=>L});var n=a(725556),o=a(932367),r=a(754440),i=a(632512),l=a(626128),s=a(9847),c=a(267324),d=a(83437),u=a(231160),m=a(980214),h=a(135973),g=a(486092);function p({rows:e,numberColumnWidth:t}){const a=u.Q1.neutral,o=(0,u.gY)(a),r=(0,n.jsx)(m.E,{animation:"wave",appearance:"translucent",style:{width:"100%",height:12,marginLeft:4,marginRight:4},children:(0,n.jsx)(h.H,{size:12})});return(0,n.jsxs)("div",{className:o.tablePreview,children:[(0,n.jsx)("div",{className:o.numberRowColumn,style:{width:t},children:Array.from({length:e}).map(((e,t)=>(0,n.jsx)("div",{className:o.numberRowCell,children:0===t?null:r},t)))}),(0,n.jsx)("div",{className:(0,g.z)(o.dataColumn,o.lastDataColumn),style:{width:"100%"},children:Array.from({length:e}).map(((e,t)=>(0,n.jsx)("div",{className:0===t?(0,g.z)(o.dataCell,o.headerCell):o.dataCell,children:r},t)))})]})}var b=a(476730),f=a(965634),C=a(956258),y=a(47262),v=a(79458);a(117463);const x=(e,t,a)=>Math.min(Math.max(((e,t="12px Segoe UI")=>{const a=document.createElement("canvas").getContext("2d");if(a)return a.font=t,a.measureText(e).width;return 12*e.length})(e),t),a);var T=a(471742),S=a(944563),w=a(215592),E=a(576583);const I={smallScrollbarStyle:{"::-webkit-scrollbar":{height:"7px",backgroundColor:"transparent",...w.shorthands.borderRadius(S.k1.borderRadiusLarge)},"::-webkit-scrollbar-thumb":{backgroundColor:S.k1.colorScrollbarOverlay,...w.shorthands.borderRadius(S.k1.borderRadiusLarge),...w.shorthands.border("1px","solid",S.k1.colorNeutralBackground1),":hover":{backgroundColor:S.k1.colorNeutralForeground3}},"::-webkit-scrollbar-track":{backgroundColor:"transparent",...w.shorthands.borderRadius(S.k1.borderRadiusLarge)}}},R=(0,E.n)(I);var A=a(8745);a(208520);const L=({preview:e,type:t,theme:a,uiTimeout:i,errorData:l,isChatHistoryRehydration:m})=>{(0,A.IC)("Failed"===e,(()=>{C.M.userQueryGuid&&!m&&(C.M.getInstance().logStandardizedAshaErrorEvent(r.W.UI_Failed_To_Update_Or_Load,o.c.Preview_On_Card_Failed_To_Display,l.telemetryFeature),C.M.getInstance().logErrorCode(l.errorCode,new Error("Preview is 'Failed'"),l.telemetryType,d.$b.Warning))}));const h=(0,A.rK)("preview",Boolean(e),i,{onTimeout(){C.M.userQueryGuid&&!m&&(C.M.getInstance().logStandardizedAshaErrorEvent(r.W.Response_Delayed_Or_Timed_Out,o.c.Calculate_Preview_Timeout,l.telemetryFeature),C.M.getInstance().logErrorCode(l.errorCode,new Error("Preview took too long to load"),l.telemetryType,d.$b.Warning))},onLoaded(e,t){b.E.getInstance().logLatency(e,s.OP.FormulaPreviewAvailable,!t)}}),g=(0,n.jsx)("div",{children:c.olU.FormulaSuggestion_Preview_NotAvailable});switch(h){case"timeout":return g;case"loading":return(0,n.jsx)(p,{rows:7,numberColumnWidth:u.i$});case"loaded":switch(e){case"Failed":return g;case"previewDisabled":case void 0:return null;default:return(0,n.jsx)(k,{preview:e,type:t,theme:a,errorData:l})}default:(0,y.x)(h)}},k=({preview:e,type:t,theme:a})=>{const o=(0,u.gY)(a),r=R();if(!e.rows.length||!e.rows[0].values.length)return(0,v.cY)("TablePreview: No rows or values in preview"),null;const s=e.rows[0].values.length,m=({children:e})=>(0,n.jsx)("div",{className:o.numberRowCell,children:(0,n.jsx)("div",{children:e})}),h=({children:e,className:t,contentClassName:a})=>(0,n.jsx)("div",{className:t,children:(0,n.jsx)("div",{className:(0,g.z)(o.contentDataCell,a),children:e})}),p=Array.from({length:s}),b=p.length-1,y=x(String(e.rows.at(-1)?.row),u.i$,u.oz);return(0,n.jsxs)("div",{className:o.tablePreview,role:"group","aria-label":c.olU.FormulaSuggestion_Preview_AriaLabel,children:[(0,n.jsxs)("div",{className:o.numberRowColumn,style:{width:y},"aria-hidden":!0,children:[(0,n.jsx)(m,{})," ",(0,n.jsx)(m,{children:e.headerRow}),e.rows.map((e=>(0,n.jsx)(m,{children:e.row},e.row)))]}),(0,n.jsx)("div",{className:(0,g.z)(o.dataColumnsContainer,r.smallScrollbarStyle),children:p.map(((a,r)=>{const s=0===r,c=r===b,u=e.columnLetters[r];void 0===u&&C.M.getInstance().logErrorCode(i.O.CalculatedColumnPreviewNoColumnLetters,new Error(`columnLetters is undefined for column ${r} out of ${b}`),f.S2.FormulaGeneration,d.$b.Warning);const m=s?void 0:e.columnLetters[r-1],y=c?void 0:e.columnLetters[r+1],{isBeforeSkip:v,isAfterSkip:x}=function(e,t,a){if(void 0===e)return{isBeforeSkip:!1,isAfterSkip:!1};const n=void 0!==t&&(0,T.$Y)(e)+1!==(0,T.$Y)(t),o=void 0!==a&&(0,T.$Y)(a)+1!==(0,T.$Y)(e);return{isBeforeSkip:n,isAfterSkip:o}}(u,y,m);return(0,n.jsxs)("div",{className:(0,g.z)(o.dataColumn,c&&o.lastDataColumn),style:{maxWidth:1===p.length?"100%":"50%"},children:[(0,n.jsx)(h,{className:(0,g.z)(o.dataCell,o.headerCell,v&&o.headerCellBeforeSkip,x&&o.headerCellAfterSkip),children:u}),(0,n.jsx)(h,{className:(0,g.z)(o.dataCell,o.columnTitleCell),children:e.columnHeaders[r]}),e.rows.map(((e,a,i)=>{const s=a===i.length-1;return(0,n.jsx)(h,{className:(0,g.z)(o.dataCell,t===l.VS.Cell&&s&&o.dataCellTotal),contentClassName:t===l.VS.Cell&&s?o.contentDataCellTotal:void 0,children:e.values[r]},e.row)}))]},r)}))})]})}},804672:(e,t,a)=>{"use strict";a.d(t,{EO:()=>X,Kv:()=>V,R3:()=>P,RE:()=>Z,VY:()=>G,WS:()=>B,Y6:()=>J,Yd:()=>H,Yp:()=>Y,cY:()=>N,jZ:()=>O,m4:()=>Q,mm:()=>q,qW:()=>$,sZ:()=>W,uN:()=>M});var n=a(267324),o=a(932367),r=a(754440),i=a(308849),l=a(207545),s=a(83437),c=a(993821),d=a(822606),u=a(742633),m=a(797639),h=a(88994),g=a(39609),p=a(722307),b=a(99394),f=a(429721),C=a(965634),y=a(956258),v=a(9847),x=a(551499),T=a(47262),S=a(79458),w=a(95151),E=a(528804),I=a(789787),R=a(173491),A=a(48093),L=a(544707),k=a(991869),F=a(108869),_=a(758651);const P=e=>{let t,a=e.length;for(;0!==a;)t=Math.floor(Math.random()*a),a--,[e[a],e[t]]=[e[t],e[a]];return e},N=(e,...t)=>{(0,S.K_)()&&_.log("Excel Copilot Chat Log:",e,...t)},M=e=>{if(e.json){const t=JSON.parse(e.json);switch(t.code){case"unsupported-multi-agent":return(0,n.CDl)();case"document-processing-denied":if((0,E.yw9)("OfficeVSO_10156381_ExcelCopilotChatDlpMessage"))return(0,n.UTd)();break;case"unknown":if("guardlist"===t.callReason&&m.CP.pythonContextManager.isStartAnalysisCard())return(0,F.Tk)(!1),(0,n.Dpi)()}}const t=(0,n.UuN)();let a=t;return(0,n.Ogc)().some((n=>((e.message===n.error||e.message.startsWith(n.error))&&(a=n.errorMessageUser),a!==t))),a},O=e=>D(e,(0,n.QEp)()),D=(e,t)=>(e=(e=e.replace(/[.,?!']/g,"")).toLowerCase(),t.some((t=>t===e))),B=(e,t)=>(e=(e=e.replace(/[.,?!']/g,"")).toLowerCase(),t.some((t=>e.includes(t)))),$=e=>{const t=[];return B(e,(0,n.J_P)())&&t.push(x.DH.Undo),B(e,(0,n.hAW)())&&t.push(x.DH.TableAltText),B(e,(0,n.inn)())&&t.push(x.DH.AddComment),B(e,(0,n.fOb)())&&t.push(x.DH.DataValidation),B(e,(0,n.fOb)())&&t.push(x.DH.CreatePivotTable),B(e,(0,n.VAP)())&&t.push(x.DH.DeleteWorksheets),t},H=e=>{switch(e){case"ChartVisual":case"QueryChartVisual":return(0,n.zQo)()[0];case"PivotChartVisual":return(0,n.zQo)()[1];case"PivotTableVisual":return(0,n.zQo)()[2];case"QueryResultVisual":return(0,n.zQo)()[3];case"ForecastVisual":case"TextAnalysisVisual":return null;default:(0,T.x)(e)}},U=async e=>{const t=()=>{const t=e?.some((e=>e.id===n.AF5),!1);return{webGroundingEnabled:!t&&(0,E.vIj)()&&(0,A.gc)(),enterpriseGroundingEnabled:(0,A.pX)(),docGroundingDisabled:!1,requireExplicitPlugins:(0,E.vIj)(),searchOnlyMode:!1,pluginInfo:e??[],...(0,E.gnD)()&&{isPythonThinkDeeperMode:m.CP.pythonContextManager.isPythonThinkDeeperMode}}};return(0,E._bw)()?await(0,L.Eb)(t):{copilotConfig:t()}},q=async(e,t,a,n,o,r,s,c,d,m,h,p,b,f)=>{const C=n??g.Z.getInstance().getConversationId();N(`createInputSignalOperationBody: ${r}, ${JSON.stringify(s)}`);const y=(0,i.Hr)(m),v=await e.getContextString(a),x=d===w.defaultCopilotChatMenuItemId?void 0:d||m?.appId;return new u.qO({query:t,queryId:a,gptId:(0,E.Pz_)()?x:void 0,context:v,raw:(0,l.I_)(),fluxSkillOverride:o,config:{...await U(s),isToolboxEnabled:!!x||(0,E.KV_)(),isInterstitialConfirmationEnabled:(0,E.dw_)(),isInterstitialAuthenticationEnabled:(0,E.I3H)()},queryAnnotations:r,conversationId:C,images:c,mentionedPlugins:y,isWarmUp:h,requestContinuation:p,clientUILanguageAndLocale:(0,k.gl)(),userQueryLanguage:(0,E.yw9)("OfficeVSO_9526211_SendUserQueryLanguageInInputSignal")?b:void 0,clientCapabilities:f})},V=async(e,t,a)=>{(0,S.cY)("Copy button clicked");try{e&&(await navigator.clipboard.write([e]),a&&y.M.getInstance().logEvent((0,v.Qf)(a)))}catch(e){(0,S.cY)("Error copying html to clipboard",e.message),y.M.getInstance().logError({eventType:t,errorMessage:"Error copying html to clipboard "+e.message,logLevel:s.$b.ASHA}),y.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.Failed_To_Copy_Response,v.BJ.CopilotChat)}};function G(e,t){return e.replaceAll(/\{(\w+)\}/g,((e,a)=>a in t?String(t[a]):`${a}`))}function W(){window.document.getElementById(n.OsU)?.style.setProperty("display","none")}const z="brk-multihub://fa000000124.resources.office.net";const j=async e=>{let t=!1;if((0,E.AJD)()&&(0,E.am)()&&p.iJ.isWebPlatform())try{t=await OfficeFirstPartyAuth.NestedAppAuth.isBridgeAvailableAsync()}catch(e){t=!1}return(0,E.AJD)()&&(p.iJ.isIOSPlatform()||p.iJ.isWin32Platform()||p.iJ.isMacPlatform()||t)?"NestedAppAuth":(0,E.XPY)()&&p.iJ.isWebPlatform()&&e?"PairwiseBroker":"Default"};async function Q(){if(!(0,E.kkU)()&&!(0,E.l6e)())return(0,I.z)();let e;if((0,E.FsT)()){const t=(0,c.dL)();e=(0,c.FF)(t)}const t=!!e,a=await j(t),n={locale:(0,p.Yd)(),sessionId:b.V.getSettingAsString(b.z.AugloopSharedSessionID),physicalRing:(0,l.I_)()?"Dogfood":"Prod",clientType:p.iJ.isWebPlatform()?f.WK.web:f.WK.desktop,hubName:f.UH.office,redirectUri:(0,R.x3)(),nestedAppAuthRedirectUri:(0,E.sDe)()?(0,R.x3)():z,preferredAuthenticationStrategy:a,trustedBrokerDomain:e,clientId:d.qA,aadUserId:"",userName:"",userPrincipalName:""};let o="",r="",i="";try{const e=new Promise((e=>Office.context.auth.getAuthContextAsync(e))),t=await e,a=await OfficeFirstPartyAuth.getPrimaryIdentityInfo();if("succeeded"===t.status){const e=t.value;o=a.displayName,i=e.userPrincipalName,r=(0,E.i9S)()?a?.email:i}else N("Failed to fetch user id from OfficeJS")}catch(e){return N("Error getting user info: "+e),n}return{...n,aadUserId:r,bizChatAadUserId:i,userName:o,bizChatUserName:o,userPrincipalName:r,bizChatUserPrincipalName:i}}function J(){return!h.s.getInstance().isWaitingForStreamEnd()}function Y(e,t=35){const a="...";return e?.length>t-3?e.substring(0,t-3)+a:e}async function X(){let e="";try{const t=new Promise((e=>Office.context.auth.getAuthContextAsync(e))),a=await t;if("succeeded"===a.status){const t=a.value;t?(e=t.tenantId,N("Fetched tenant id for Safelinks successfully")):(N("AuthContext is undefined"),y.M.getInstance().logError({eventType:C.S2.Safelinks,errorMessage:"AuthContext is undefined",logLevel:s.$b.ASHA}))}else N(`Failed to fetch tenant ID. Status: ${a.status}`),y.M.getInstance().logError({eventType:C.S2.Safelinks,errorMessage:`Failed to fetch tenant ID. Status: ${a.status}`,logLevel:s.$b.ASHA})}catch(e){N(`Error getting tenant ID: ${e}`),y.M.getInstance().logError({eventType:C.S2.Safelinks,errorMessage:`Error getting tenant ID: ${e}`,logLevel:s.$b.ASHA})}return e}function Z(e,t){return`chart_${function(e){let t=0;for(let a=0;a<e.length;a++)t=(t<<5)-t+e.charCodeAt(a),t|=0;return Math.abs(t).toString(36)}(`${e}::${t}`)}`}},805027:(e,t,a)=>{"use strict";a.d(t,{SB:()=>c,f9:()=>d,gV:()=>s,vc:()=>l,xb:()=>u});var n=a(267324),o=a(47262);function r(e,t){return e.length===t.length&&e.every(((e,a)=>e===t[a]))}function i(e){let t=e.length-1;for(;t>0&&e[t]===e[t-1];t--);return e.slice(0,t+1)}function l(e){const t=e.length;let a=[...e],n=t-1;for(;n>0&&r(a[n],a[n-1]);n--);return a=a.slice(0,n+1),a.map(i)}function s(e,t,a){const n=e[t<e.length?t:e.length-1];return n[a<n.length?a:n.length-1]}function c(e){if(!e)return null;if(0===e.length)return{keys:[],values:[],positions:[]};const t=e.map((e=>e.map((()=>-1)))),a=[],n=[];return e.forEach(((e,o)=>{e.forEach(((e,r)=>{const i=a.indexOf(e);"General"===e?t[o][r]=-1:i<0?(t[o][r]=a.length,a.push(e),n.push({row:o,column:r})):t[o][r]=i}))})),{keys:t,values:a,positions:n}}function d(e){const t=e>=60&&e<61,a=e<60?e+1:e,n=new Date(1e3*Math.round(86400*(a-25569)));return{is29Feb1900:t,adjustedRaw:a,date:new Date(1e3*Math.round(86400*(a-25569+n.getTimezoneOffset()/1440)))}}function u(e,t){if(null==e)return(0,n.Atw)();if("number"!=typeof e)throw new Error("Only numerics and blanks are expected in DatePartOverride grouped data");const{is29Feb1900:a,adjustedRaw:r,date:i}=d(e);if(Number.isNaN(i.getDay()))return r.toString();const l=e=>{const t=`0${e.toString()}`;return t.substr(t.length-2)},s=(i.getFullYear()-i.getFullYear()%10).toString(),c=i.getFullYear().toString(),u=l(i.getMonth()+1),m=a?"29":l(i.getDate()),h=l(i.getHours()),g=l(i.getMinutes()),p=l(i.getSeconds()),b=(Math.floor(i.getMonth()/3)+1).toString();switch(t){case"date":return`${c}-${u}-${m}`;case"decade":return`${s}`;case"monthAndDay":return`${u}-${m}`;case"dayOfMonth":return`${m}`;case"month":return`${u}`;case"quarter":return`Q${b}`;case"year":return`${c}`;case"yearAndMonth":return`${c}-${u}`;case"yearAndQuarter":return`${c} Q${b}`;case"hour":return`${h}:00`;case"minute":return`${g}`;case"hourAndMinute":return`${h}:${g}`;case"hourMinuteAndSecond":return`${h}:${g}:${p}`;case"dateAndHour":return`${c}-${u}-${m} ${h}:00`;case"dateHourAndMinute":return`${c}-${u}-${m} ${h}:${g}`;case"dateHourMinuteAndSecond":return`${c}-${u}-${m} ${h}:${g}:${p}`;default:return(0,o.x)(t)}}},810646:(e,t,a)=>{"use strict";a.d(t,{NU:()=>kl,yC:()=>Sl,C2:()=>Ll});var n=a(551499),o=a(932367),r=a(754440),i=a(449650),l=a(893763),s=a(689534),c=a(956258),d=a(9847),u=a(797639),m=a(528804),h=a(236348),g=a(818977),p=a(533972),b=a(885930),f=a(267324),C=a(319329),y=a(812328),v=a(399589),x=a(947621),T=a(863890),S=a(827508),w=a(972677),E=a(181704);const I=(0,m.yw9)("OfficeVSO_8999367_UseSeparateStringsForNumberValuesHiTL"),R=(0,m.yw9)("OfficeVSO_8884962_useColorNameForHumanInTheLoop"),A={substitute:E.A};function L(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeCellTextOrientationChangedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeCellTextOrientationChangedLabel,{orientation:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameCellTextOrientationChanged,{columnName:e.parameters.columnName,orientation:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.CellTextOrientationChanged,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),orientation:e.parameters.value})}function k(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetAddedWithNameLabel,{worksheetName:e.parameters})}function F(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetRenameLabel,{worksheetName:e.parameters})}function _(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetDeleteMultipleLabel,{count:e.parameters.events.length})}function P(e){const t=e.parameters.values;if(1===t.length&&1===t[0].length){const a=I&&!isNaN(t[0][0])?ExcelCopilotCommandingHitlStrings.RangeEditValueNumberLabel:ExcelCopilotCommandingHitlStrings.RangeEditValueStringLabel;return A.substitute(a,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${t[0][0]}`})}return A.substitute(ExcelCopilotCommandingHitlStrings.RangeEditLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function N(e){const t=I&&!isNaN(e.parameters.value)?ExcelCopilotCommandingHitlStrings.RangeEditValueNumberLabel:ExcelCopilotCommandingHitlStrings.RangeEditValueStringLabel;return A.substitute(t,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${e.parameters.value}`})}function M(e){return e.parameters.command===w.default.ClearCellsFormat?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeClearFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeClearFormatLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeClearFormatLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeClearLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeClearLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeClearLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function O(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeDeleteLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeDeleteLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeDeleteLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function D(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeInsertedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeInsertedLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeInsertLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function B(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeMergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeMergeLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeMergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function $(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnmergeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnmergeLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnmergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function H(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeColumnsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeColumnsAutofitLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeColumnsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function U(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeRowsAutofitLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeRowsAutofitLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeRowsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function q(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUseStandardHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUseStandardHeightLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUseStandardHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function V(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUseStandardWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUseStandardWidthLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUseStandardWidthLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function G(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function W(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeRemoveHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function z(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeNumberFormatLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeNumberFormatLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!0),columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!0),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function j(e){return 0===e.parameters.copyCutOperation?A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCopyLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)}):A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCutLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)})}function Q(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.target)})}function J(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableCreateLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Y(e){return(0,m.yw9)("OfficeVSO_8900971_HumanInTheLoopAddColumnNameToInsertColumn")&&void 0!==e.parameters.columnNames?1===e.parameters.count?A.substitute(ExcelCopilotCommandingHitlStrings.TableInsertColumnsLabelWithColumnName,{columnNumber:e.parameters.index+1,columnName:e.parameters.columnNames,tableName:e.parameters.name}):s.O.MissingIntent:A.substitute(ExcelCopilotCommandingHitlStrings.TableInsertColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function X(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableRemoveColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Z(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableInsertRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function K(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableRemoveRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function ee(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableSortColumnLabel,{columnNumber:e.parameters.columnIndex,tableName:e.parameters.tableName})}function te(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableClearFiltersLabel,{tableName:e.entityId})}function ae(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnClearFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function ne(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableReapplyFilterLabel,{tableName:e.parameters.tableName})}function oe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableFilterColumnLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName,values:e.parameters.values.join(", ")})}function re(e){switch(e.parameters.value1.valueCompareType){case S.default.Equals:{const t=I&&!isNaN(e.parameters.value1.value)?ExcelCopilotCommandingHitlStrings.TableColumnEqualsNumberFilterLabel:ExcelCopilotCommandingHitlStrings.TableColumnEqualsFilterLabel;return A.substitute(t,{columnName:e.parameters.columnName,value1:e.parameters.value1.value})}case S.default.DoesNotEqual:{const t=I&&!isNaN(e.parameters.value1.value)?ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEqualNumberFilterLabel:ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEqualFilterLabel;return A.substitute(t,{columnName:e.parameters.columnName,value1:e.parameters.value1.value})}case S.default.BeginsWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnBeginsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotBeginWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotBeginWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.EndsWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnEndsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotEndWith:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotEndWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.Contains:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnContainsFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotContain:return e.parameters.value2?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDoesNotContainFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThan:return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThenOrEqualTo:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsLessThanOrEqualTo?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsGreaterThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThen:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsGreaterThan?A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnNotBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThanOrEqualTo:return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnIsLessThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});default:return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnCustomFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}}function ie(e){if(e.parameters.sharedSortConditions[0].columnName)return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnByNameCustomSortLabel,{tableName:e.parameters.tableName,columnName:e.parameters.sharedSortConditions[0].columnName});if(e.parameters.sharedSortConditions[0].columnIndex>=0)return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnByIndexCustomSortLabel,{tableName:e.parameters.tableName,columnIndex:e.parameters.sharedSortConditions[0].columnIndex});throw new l.sF("Unhandled intent case in Table.CustomSorted",l.UP.MissingIntent)}function le(e){return A.substitute((0,f.S0l)(),{tableName:e.entityId})}function se(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnTopFilterLabel,{direction:e.parameters.top?"top":"bottom",count:e.parameters.count,columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function ce(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableColumnDynamicFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function de(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatBoldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatBoldLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatBoldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatUnboldLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatUnboldLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatUnboldLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatUnboldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ue(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatBoldLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatUnboldLabel}function me(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatSuperscriptLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveSuperscriptLabel}function he(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatSubscriptLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveSubscriptLabel}function ge(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatItalicLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatItalicLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatItalicLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatItalicLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatUnitalicizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatUnitalicizeLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatUnitalicizeLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatUnitalicizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function pe(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General)return En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSetFontColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSetFontColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value});if((0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName){const t=(0,m.yw9)("OfficeVSO_9425205_FixSetColumnFontColor")?ExcelCopilotCommandingHitlStrings.ColumnNameFormatSetFontColorLabel:ExcelCopilotCommandingHitlStrings.ColumnFormatSetFontColorLabel;return A.substitute(t,{columnName:e.parameters.columnName,color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}return A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSetFontColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}function be(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeFormatSetFontColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters.events[0].parameters.value):e.parameters.events[0].parameters.value})}function fe(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSetFontLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSetFontLabel,{fontName:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameFormatSetFontLabel,{columnName:e.parameters.columnName,fontName:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSetFontLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontName:e.parameters.value})}function Ce(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeFormatSetFontLabel,{fontName:e.parameters.events[0].parameters.value})}function ye(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ve(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatDoubleUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatDoubleUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveDoubleUnderlineLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function xe(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatStrikethroughLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatStrikethroughLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveStrikethroughLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveStrikethroughLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveStrikethroughLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Te(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSuperscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatSuperscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatUnSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveSuperscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveSuperscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveSuperscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Se(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatSubscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatSubscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFormatRemoveSubscriptLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFormatRemoveSubscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatRemoveSubscriptLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeFormatRemoveSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function we(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetFontSizeLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetFontSizeLabel,{fontSize:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetFontSizeLabel,{columnName:e.parameters.columnName,fontSize:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetFontSizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontSize:e.parameters.value})}function Ee(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetFontSizeLabel,{fontSize:e.parameters.events[0].parameters.value})}function Ie(e){if("none"===e.parameters.value)return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeRemoveFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeRemoveFontUnderlineStyleLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameRemoveFontUnderlineStyleLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RemoveFontUnderlineStyleLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)});let t="";const a=(0,m.yw9)("OfficeVSO_9413070_FixHiTLUnderlineStringLocalization");if(a)switch(e.parameters.value){case"single":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleSingleLabel;break;case"double":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleDoubleLabel;break;case"singleAccountant":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleSingleAccountantLabel;break;case"doubleAccountant":t=ExcelCopilotCommandingHitlStrings.FontUnderlineStyleDoubleAccountantLabel;break;default:throw new l.sF("Unhandled underline style in Font.UnderlineStyle",l.UP.MissingIntent)}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?a?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeApplyFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeApplyFontUnderlineStyleLabel,{style:t}):En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeFontUnderlineStyleLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase()}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?a?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameApplyFontUnderlineStyleLabel,{style:t,columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),columnName:e.parameters.columnName}):a?A.substitute(ExcelCopilotCommandingHitlStrings.ApplyFontUnderlineStyleLabel,{style:t,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):A.substitute(ExcelCopilotCommandingHitlStrings.FontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Re(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetBackgroundColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetBackgroundColorLabel,{columnName:e.parameters.columnName,color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}function Ae(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeClearBackgroundColorLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeClearBackgroundColorLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?(0,m.yw9)("OfficeVSO_9374824_FixClearFormatIntentString")?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameClearBackgroundColorLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeClearBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Le(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetBackgroundColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters.events[0].parameters.value):e.parameters.events[0].parameters.value})}function ke(e){const t=(e.parameters.value/C.bN).toFixed(2);return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetCellWidthLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetCellWidthLabel,{size:t}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetCellWidthLabel,{size:t,columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetCellWidthLabel,{size:t,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Fe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetCellWidthLabel,{size:e.parameters.events[0].parameters.value})}function _e(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetCellHeightLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetCellHeightLabel,{size:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetCellHeightLabel,{columnName:e.parameters.columnName,size:e.parameters.value}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetCellHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),size:e.parameters.value})}function Pe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangeSetCellHeightLabel,{size:e.parameters.events[0].parameters.value})}function Ne(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeApplyBorderLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeApplyBorderLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameApplyBorderLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeApplyBorderLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Me(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewDeleteLabel,{deletedNum:e.parameters.namedSheetViewNames.length})}function Oe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewDuplicateLabel,{sheetViewName:e.parameters.namedSheetViewName})}function De(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewExitAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewKeepName}):ExcelCopilotCommandingHitlStrings.NamedSheetViewExitLabel}function Be(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewKeepLabel,{sheetViewName:e.parameters.namedSheetViewName})}function $e(e){return A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewRenameLabel,{newSheetViewName:e.parameters.newNamedSheetViewName})}function He(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewSwitchAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewName,sheetViewKeepName:e.parameters.namedSheetViewKeepName}):A.substitute(ExcelCopilotCommandingHitlStrings.NamedSheetViewSwitchLabel,{sheetViewName:e.parameters.namedSheetViewName})}function Ue(e){if(e.parameters.destinationRange.rangeType===i.RangeType.TableRange){let t;switch(e.parameters.destinationRange.range.subRange){case i.TableRangeOperationSubRange.WholeTable:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableRangeLabel;break;case i.TableRangeOperationSubRange.Body:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableBodyRangeLabel;break;case i.TableRangeOperationSubRange.HeaderRow:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableHeaderRowRangeLabel;break;case i.TableRangeOperationSubRange.TotalRow:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableTotalRowRangeLabel;break;case i.TableRangeOperationSubRange.General:if((0,m.yw9)("OfficeVSO_8900963_HumanInTheLoopRemoveSubRange"))return s.O.MissingIntent;t=ExcelCopilotCommandingHitlStrings.RangePasteInTableGeneralRangeLabel;break;case i.TableRangeOperationSubRange.Rows:case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:t=ExcelCopilotCommandingHitlStrings.RangePasteInTableRangeLabel}return A.substitute(t,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),tableName:e.entityId})}return A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),destinationRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).range)})}function qe(e){return A.substitute(ExcelCopilotCommandingHitlStrings.MultiRangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.events[0].parameters.sourceRange).range)})}function Ve(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ge(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetDuplicateLabel,{sheet:e.entityId})}function We(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetReapplyFiltersLabel,{sheet:e.entityId})}function ze(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetClearFiltersLabel,{sheet:e.entityId})}function je(e){return A.substitute(ExcelCopilotCommandingHitlStrings.CellFindContainingLabel,{search:e.parameters.searchString})}function Qe(e){const t=i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range,a=i.ExcelCalc.IExcelRangeToAddress(t);if((0,m.yw9)("OfficeVSO_9033826_SearchReplaceEmptyCellStrings")&&""===e.parameters.searchString){const n=t.topLeft.row===t.bottomRight.row&&t.topLeft.column===t.bottomRight.column?ExcelCopilotCommandingHitlStrings.ReplaceEmptyCellLabel:ExcelCopilotCommandingHitlStrings.ReplaceAllEmptyCellsLabel;return A.substitute(n,{replace:e.parameters.replaceWith,range:a})}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeReplaceAllLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith}):A.substitute(ExcelCopilotCommandingHitlStrings.ReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith,range:a})}function Je(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ReplaceAllLabelGeneric,{search:e.parameters.events[0].parameters.searchString,replace:e.parameters.events[0].parameters.replaceWith})}function Ye(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetHorizontalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetHorizontalAlignmentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetHorizontalAlignmentLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetHorizontalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Xe(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeSetVerticalAlignmentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeSetVerticalAlignmentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameSetVerticalAlignmentLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeSetVerticalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ze(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeWrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeWrapTextLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameWrapTextLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeWrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnwrapTextLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnwrapTextLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameUnwrapTextLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnwrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ke(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeChangeIndentLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeChangeIndentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameChangeIndentLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeChangeIndentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function et(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetReorderLabel,{sheet:e.entityId})}function tt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableToggleAutoFilterLabel,{tableName:e.entityId})}function at(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetToggleAutoFilterLabel,{sheet:e.entityId})}function nt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SlicerInsertedLabel,{pivotTable:e.parameters.pivotTable,pivotName:e.parameters.pivotFieldName})}function ot(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General){const t=e.parameters.range;if(t.subRange===i.TableRangeOperationSubRange.WholeTable)return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetTableRangeCreateChartLabel,{sheet:e.entityId,table:t.tableName})}return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCreateChartLabel,{sheet:e.entityId})}function rt(e){return`#${i.ExcelCalc.toHexColor(e)}`}function it(e,t,a){const n=a?a(e.parameters.newValue):`${e.parameters.newValue}`;return e.parameters.category===i.ChartObjectCategory.ChartAxis?A.substitute(t,{newValue:n,axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?A.substitute(t,{newValue:n,seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):A.substitute(t,{newValue:n,chartName:e.parameters.chartName})}function lt(e,t){return e.parameters.category===i.ChartObjectCategory.ChartAxis?A.substitute(t,{axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?A.substitute(t,{seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):A.substitute(t,{chartName:e.parameters.chartName})}function st(e){return e.parameters.added?A.substitute(ExcelCopilotCommandingHitlStrings.VisualSerriesTrendlineAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):A.substitute(ExcelCopilotCommandingHitlStrings.VisualSerriesTrendlineRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function ct(e){return e.parameters.added?A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineTitleAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex}):A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineTitleRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function dt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCreateChartLabel,{sheet:e.entityId})}function ut(e){return e.parameters?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShowHeadingsLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetHideHeadingsLabel,{sheet:e.entityId})}function mt(e){return e.parameters?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShowGridlinesLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetHideGridlinesLabel,{sheet:e.entityId})}function ht(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeRemoveDuplicatesLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeRemoveDuplicatesLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeRemoveDuplicatesLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function gt(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddTotalRowLabel:ExcelCopilotCommandingHitlStrings.TableRemoveTotalRowLabel;return A.substitute(t,{tableName:e.entityId})}function pt(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddHeaderRowLabel:ExcelCopilotCommandingHitlStrings.TableRemoveHeaderRowLabel;return A.substitute(t,{tableName:e.entityId})}function bt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableResizeLabel,{tableName:e.entityId})}function ft(e){return e.parameters.isCreation?A.substitute(ExcelCopilotCommandingHitlStrings.TableCreateAndFormatLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):A.substitute(ExcelCopilotCommandingHitlStrings.TableFormatLabel,{tableName:e.entityId})}function Ct(e){return""===e.parameters?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetClearTabColorLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetSetTabColorLabel,{color:R?p.g.colorNameFromHEX(e.parameters):e.parameters,sheet:e.entityId})}function yt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartSwitchRowColumnLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function vt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartSelectDataLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function xt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeTypeLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Tt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeFlashFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function St(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function wt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartHideTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Et(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeAxisTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function It(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartHideAxisTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Rt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeLegendLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function At(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartAxisTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Lt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCharTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function kt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartHideLegendLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Ft(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartDataLabelChangePositionLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function _t(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartDataLabelChangeVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Pt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeAxisLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Nt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeAxisVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Mt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableApplyStyleLabel,{tableName:e.entityId})}function Ot(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddBandedRowsLabel:ExcelCopilotCommandingHitlStrings.TableRemoveBandedRowsLabel;return A.substitute(t,{tableName:e.entityId})}function Dt(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddBandedColumnsLabel:ExcelCopilotCommandingHitlStrings.TableRemoveBandedColumnsLabel;return A.substitute(t,{tableName:e.entityId})}function Bt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableHighlightFirstColumnFilterLabel,{tableName:e.entityId})}function $t(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableHighlightLastColumnLabel,{tableName:e.entityId})}function Ht(e){const t=e.parameters?ExcelCopilotCommandingHitlStrings.TableAddFilterButtonLabel:ExcelCopilotCommandingHitlStrings.TableRemoveFilterButtonLabel;return A.substitute(t,{tableName:e.entityId})}function Ut(e){return e.parameters.rangeToFreeze?ExcelCopilotCommandingHitlStrings.WorksheetFreezePaneLabel:ExcelCopilotCommandingHitlStrings.WorksheetUnFreezePaneLabel}function qt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeInsertedLabel,{sheet:e.entityId})}function Vt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeSetStyleLabel,{sheet:e.entityId})}function Gt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Wt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ChartSeriesDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId,seriesIndex:e.parameters.seriesIndex})}function zt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ChartSeriesDataChangedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.seriesIndex})}function jt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetFloatingObjectDeleteLabel,{sheet:e.entityId})}function Qt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartMoveAndResizeLabel,{chartName:e.parameters.name,sheet:e.entityId})}function Jt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetFloatingObjectMoveAndResizeLabel,{sheet:e.entityId})}function Yt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetFloatingObjectZOrderChangedLabel,{sheet:e.entityId})}function Xt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeRotateLabel,{sheet:e.entityId})}function Zt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeAltTextApplyLabel,{sheet:e.entityId})}function Kt(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextChangedLabel,{sheet:e.entityId})}function ea(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextBoldedLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnboldedLabel,{sheet:e.entityId})}function ta(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextItalicizedLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnitalicizedLabel,{sheet:e.entityId})}function aa(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnderlinedLabel,{sheet:e.entityId}):A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextUnderlineRemovedLabel,{sheet:e.entityId})}function na(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextFontNameChangedLabel,{sheet:e.entityId,fontName:e.parameters.value})}function oa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextFontSizeChangedLabel,{sheet:e.entityId,fontSize:e.parameters.value})}function ra(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextFontColorChangedLabel,{sheet:e.entityId,fontColor:R?p.g.colorNameFromHEX(e.parameters.value):e.parameters.value})}function ia(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextHorizontallyAlignedLabel,{sheet:e.entityId})}function la(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetShapeTextVerticallyAlignedLabel,{sheet:e.entityId})}function sa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeGroupLabel,{sheet:e.entityId})}function ca(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnGroupLabel,{sheet:e.entityId})}function da(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetOutlineLevelsSetLabel,{sheet:e.entityId})}function ua(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeGroupDetailsShowLabel,{sheet:e.entityId})}function ma(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeGroupDetailsHideLabel,{sheet:e.entityId})}function ha(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeDataValidationChangedGroupLabel,{sheet:e.entityId})}function ga(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableRenameLabel,{tableName:e.parameters})}function pa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableConvertToRangeLabel,{tableName:e.entityId})}function ba(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableAltTextEditedLabel,{tableName:e.entityId})}function fa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableAltTextTitleEditedLabel,{tableName:e.entityId})}function Ca(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TableAltTextDescriptionEditedLabel,{tableName:e.entityId})}function ya(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableChangeLabel,{pivotName:e.parameters.events[0].parameters.pivotName})}function va(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableAddPivot,{pivotName:e.parameters.pivotName})}function xa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRemovePivot,{pivotName:e.parameters.pivotName})}function Ta(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRefreshLabel,{pivotName:e.parameters})}function Sa(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.PivotDrillExpandedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName}):A.substitute(ExcelCopilotCommandingHitlStrings.PivotDrillCollapsedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName})}function wa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRenamedLabel,{newName:e.parameters.value})}function Ea(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRowGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableRowGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ia(e){return e.parameters.value?A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableColumnGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableColumnGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ra(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableLayoutTypeSetLabel,{pivotName:e.parameters.pivotName})}function Aa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetValuesFilterAppliedLabel,{range:i.ExcelCalc.columnFromIExcelAddress(e.parameters.range.range,e.parameters.column)})}function La(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetCustomFilterAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function ka(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetDynamicFilterAppliedLabel,{range:i.ExcelCalc.ICellColumnSheetRangeToAddress({range:{topLeft:{column:e.parameters.column,row:null},bottomRight:{column:e.parameters.column,row:null}},sheet:""})})}function Fa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function _a(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ArtPasteSameWorkbookLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).sheet})}function Pa(e){return A.substitute(ExcelCopilotCommandingHitlStrings.RangeAutoSumLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Na(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeHideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeHideRowsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameHideRowsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeHideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnhideRowsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnhideRowsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameUnhideRowsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnhideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ma(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeHideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeHideColumnsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameHideColumnsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeHideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeUnhideColumnsLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeUnhideColumnsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameUnhideColumnsLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeUnhideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Oa(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeHideRowsLabel:ExcelCopilotCommandingHitlStrings.MultiRangeUnhideRowsLabel}function Da(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeHideColumnsLabel:ExcelCopilotCommandingHitlStrings.MultiRangeUnhideColumnsLabel}function Ba(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCreatedGroupEventLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function $a(e){const t=e.parameters.customFormat,a=[];t.IsTextBold&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatBoldLabel),t.IsTextItalic&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatItalicizeLabel),t.IsTextUnderlined&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatUnderlineLabel),t.IsTextDoubleUnderlined&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDoubleUnderlineLabel);const n=R?p.g.colorNameFromHEX(t.BackgroundColor):t.BackgroundColor,o=R?p.g.colorNameFromHEX(t.TextColor):t.TextColor,r=t.IsTextStrikethrough,l=t.BorderFormat.LineStyle,s=t.BorderFormat.Color;if(null!=n){const e=A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatFillColorLabel,{color:n});a.push(e)}if(null!=o){const e=A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatFontColorLabel,{color:o});a.push(e)}if(r&&a.push(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatStrikethroughLabel),l[0]!==i.BorderLineStyle.None){const e=(0,g.Cn)(s[0]),t=R?p.g.colorNameFromHEX((0,g.S)(e)):(0,g.S)(e),n=A.substitute(y.$8[l[0]](),{color:t});a.push(n)}const c=[{key:d.Dh.EventType,value:d.Mv.LogSuccessMessageFormattingParameters},{key:d.Dh.SuccessMessageNumParameters,value:a.length},{key:d.Dh.SuccessMessageFormattingParameters,value:a.join(", ")}];return(0,x.j)(c),a}function Ha(e){return En(e,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingApplyFormattingCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingApplyFormattingCustomCreatedLabel,{})}function Ua(e,t){return(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameConditionalFormattingApplyFormattingCustomCreatedLabel,{columnName:e}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingApplyFormattingCustomCreatedLabel,{range:t})}function qa(e){const t=/"|=|DATEVALUE|\(|\)/g,a=e.parameters.rule,n=a.operator,o=a.formula1.replace(t,"");let r=y.X7[n](I&&!isNaN(o));const l=(0,m.yw9)("OfficeVSO_9352581_CFCustomFormulaValue2BugFix");if(l||(r=A.substitute(r,{value1:o})),!a.formula2||n!==T.default.Between&&n!==T.default.NotBetween)l&&(r=A.substitute(r,{value1:o}));else{const e=a.formula2.replace(t,"");r=l?A.substitute(r,{value1:o,value2:e}):A.substitute(r,{value2:a.formula2})}const s=new b.J(b.D.CellValue),c=e.parameters.customFormat;c&&(s.customFormat=c);const d={title:r,explanation:"",conditionalFormatResponseCardData:s,subExplanations:$a(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(d.explanation=Ha(e.parameters.range),d):(d.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),d)}function Va(e){const t=e.parameters.rule,a=t.formula,n=t.formulaExplanation,o=new b.J(b.D.CustomCreated);o.customFormula=a,o.formulaExplanation=n;const r=e.parameters.customFormat;r&&(o.customFormat=r);const l={title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingCustomFormulaPrefixLabel,explanation:"",subExplanations:$a(e),conditionalFormatResponseCardData:o};return e.parameters.rangeType===i.RangeType.TableRange?(l.explanation=En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,{}),l):((0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?l.explanation=A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameConditionalFormattingCustomFormulaCreatedLabel,{columnName:e.parameters.columnName}):l.explanation=A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingCustomFormulaCreatedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}),l)}function Ga(e){const t=e.parameters.rule,a=A.substitute(y.mY[t.operator](),{text:t.text}),n=new b.J(b.D.TextComparison),o=e.parameters.customFormat;o&&(n.customFormat=o);const r={title:a,explanation:"",conditionalFormatResponseCardData:n,subExplanations:$a(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(r.explanation=Ha(e.parameters.range),r):(r.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),r)}function Wa(e){const t=new b.J(b.D.ColorScale),a=e.parameters.colorScaleFormat;a&&(t.originalHexColors=a);const n={title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingColorScalePrefixLabel,explanation:"",conditionalFormatResponseCardData:t};let o="",r="",l="";return a&&(o=R?p.g.colorNameFromHEX(a.minimumColor):a.minimumColor,r=R?p.g.colorNameFromHEX(a.midpointColor):a.midpointColor,l=R?p.g.colorNameFromHEX(a.maximumColor):a.maximumColor),e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(n.explanation=r?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,{color1:o,color2:r,color3:l}):En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,{color1:o,color2:l}),n):(n.explanation=r?A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingColorScaleThreeColorsCustomCreatedLabel,{color1:o,color2:r,color3:l,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingColorScaleTwoColorsCustomCreatedLabel,{color1:o,color2:l,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}),n)}function za(e){const t=e.parameters.dataBarFormat;let a=!1,n="";t&&(a=t.isGradientFill,n=R?p.g.colorNameFromHEX(t.fillColor):t.fillColor);const o=new b.J(b.D.DataBar);t&&(o.dataBarFormat=t);const r={title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingDataBarPrefixLabel,explanation:"",conditionalFormatResponseCardData:o};if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General)return a?(r.explanation=En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingGradientDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingGradientDataBarCustomCreatedLabel,{color:n}),r):(r.explanation=En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingSolidDataBarCustomCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingSolidDataBarCustomCreatedLabel,{color:n}),r);const l=a?ExcelCopilotCommandingHitlStrings.ConditionalFormattingGradientDataBarCustomCreatedLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingSolidDataBarCustomCreatedLabel;return r.explanation=A.substitute(l,{color:n,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}),r}function ja(e){let t;t=e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSetCreatedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)});const a=e.parameters.style,n=new b.J(b.D.IconSet);return n.iconSetNumber=a,{title:ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSetPrefixLabel,explanation:t,conditionalFormatResponseCardData:n,subExplanations:[y.Is[a]()]}}function Qa(e){const t=e.parameters.rule,a=new b.J(b.D.Preset),n=e.parameters.customFormat;n&&(a.customFormat=n);const o={title:y.y6[t.criterion](),explanation:"",conditionalFormatResponseCardData:a,subExplanations:$a(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(o.explanation=Ha(e.parameters.range),o):(o.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),o)}function Ja(e){const t=e.parameters.rule,a=new b.J(b.D.Dates),n=e.parameters.customFormat;n&&(a.customFormat=n);const o={title:y.sh[t.timePeriodType](),explanation:"",conditionalFormatResponseCardData:a,subExplanations:$a(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(o.explanation=Ha(e.parameters.range),o):(o.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),o)}function Ya(e){const t=e.parameters.rule,a=new b.J(b.D.UniqueValue),n=e.parameters.customFormat;n&&(a.customFormat=n);const o={title:t.unique?ExcelCopilotCommandingHitlStrings.ConditionalFormattingUniquePrefixLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingDuplicatePrefixLabel,explanation:"",conditionalFormatResponseCardData:a,subExplanations:$a(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(o.explanation=Ha(e.parameters.range),o):(o.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),o)}function Xa(e){const t=e.parameters.rule,a=t.rank,n=y.qq[t.type](),o=A.substitute(n,{number:a}),r=new b.J(b.D.TopBottom),l=e.parameters.customFormat;l&&(r.customFormat=l);const s={title:o,explanation:"",conditionalFormatResponseCardData:r,subExplanations:$a(e)};return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?(s.explanation=Ha(e.parameters.range),s):(s.explanation=Ua(e.parameters.columnName,i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)),s)}function Za(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingEditedGroupEventLabel,{sheet:e.entityId})}function Ka(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingRuleDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.ranges[0]).range)})}function en(e){return s.O.NoIntentNeeded}function tn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeConditionalFormattingDeletedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeConditionalFormattingDeletedLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.ConditionalFormattingDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function an(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameRangeCellStyleAppliedLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexRangeCellStyleAppliedLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?A.substitute(ExcelCopilotCommandingHitlStrings.ColumnNameCellStyleAppliedLabel,{columnName:e.parameters.columnName}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeCellStyleAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function nn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PictureInsertedEventLabel,{sheet:e.entityId})}function on(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?En(e.parameters.range,ExcelCopilotCommandingHitlStrings.TableRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableBodyRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableHeaderRowRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableTotalRowRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableGeneralRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableRowsRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableRowByIndexRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableColumnsRangeCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableColumnByNameCustomSortLabel,ExcelCopilotCommandingHitlStrings.TableColumnByIndexCustomSortLabel,{}):A.substitute(ExcelCopilotCommandingHitlStrings.RangeCustomSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function rn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AutoFilterCustomSortLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).sheet})}function ln(e){return A.substitute(ExcelCopilotCommandingHitlStrings.TextToColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range)})}function sn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AllowEditRangeAddedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function cn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AllowEditRangeDeletedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function dn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.AllowEditRangeEditedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function un(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionOptionsUpdatedLabel,{sheet:e.entityId})}function mn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionPasswordUpdatedLabel,{sheet:e.entityId})}function hn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionPausedLabel,{sheet:e.entityId})}function gn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionProtectedLabel,{sheet:e.entityId})}function pn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionResumedLabel,{sheet:e.entityId})}function bn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.SheetProtectionUnprotectedLabel,{sheet:e.entityId})}function fn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationListRangeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),source:e.parameters.source})}function Cn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationCustomRangeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),formula:e.parameters.formula})}function yn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"date",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"date",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function vn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"decimal",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"decimal",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function xn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"text length",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"text length",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function Tn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"time",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"time",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function Sn(e){return""!==e.parameters.formula2?A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationTernaryBasicRangeLabel,{validationType:"whole number",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1,formula2:e.parameters.formula2}):A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationBinaryBasicRangeLabel,{validationType:"whole number",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),operator:e.parameters.operator,formula1:e.parameters.formula1})}function wn(e){return A.substitute(ExcelCopilotCommandingHitlStrings.DataValidationClearRangeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function En(e,t,a,n,o,r,l,c,d,u,h,g){let p;switch(g.tableName=e.tableName,e.subRange){case i.TableRangeOperationSubRange.WholeTable:p=t;break;case i.TableRangeOperationSubRange.Body:p=a;break;case i.TableRangeOperationSubRange.HeaderRow:p=n;break;case i.TableRangeOperationSubRange.TotalRow:p=o;break;case i.TableRangeOperationSubRange.General:if((0,m.yw9)("OfficeVSO_8900963_HumanInTheLoopRemoveSubRange"))return s.O.MissingIntent;p=r;break;case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:{p=d;const t=e.subRangeValues;if(t.columnNames)1===t.columnNames.length?(p=u,g.columnName=t.columnNames[0]):g.count=t.columnNames.length;else{const t=e.subRangeValues;1===t.count?(p=h,g.columnIndex=t.firstIndex):g.count=t.count}break}case i.TableRangeOperationSubRange.Rows:{const t=e.subRangeValues;1===t.count?(p=c,g.rowIndex=t.firstIndex):(p=l,g.count=t.count);break}}return A.substitute(p,g)}var In=a(731137);const Rn=(0,m.yw9)("OfficeVSO_8999367_UseSeparateStringsForNumberValuesHiTL"),An={...In,substitute:E.A};function Ln(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeCellTextOrientationChangedLabel,An.Intents.TableBodyRangeCellTextOrientationChangedLabel,An.Intents.TableHeaderRowRangeCellTextOrientationChangedLabel,An.Intents.TableTotalRowRangeCellTextOrientationChangedLabel,An.Intents.TableGeneralRangeCellTextOrientationChangedLabel,An.Intents.TableRowsRangeCellTextOrientationChangedLabel,An.Intents.TableRowByIndexRangeCellTextOrientationChangedLabel,An.Intents.TableColumnsRangeCellTextOrientationChangedLabel,An.Intents.TableColumnByNameRangeCellTextOrientationChangedLabel,An.Intents.TableColumnByIndexRangeCellTextOrientationChangedLabel,{orientation:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameCellTextOrientationChanged,{columnName:e.parameters.columnName,orientation:e.parameters.value}):An.substitute(An.Intents.CellTextOrientationChanged,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),orientation:e.parameters.value})}function kn(e){return An.substitute(An.Intents.WorksheetAddedWithNameLabel,{worksheetName:e.parameters})}function Fn(e){return An.substitute(An.Intents.WorksheetRenameLabel,{worksheetName:e.parameters})}function _n(e){return An.substitute(An.Intents.WorksheetDeleteMultipleLabel,{count:e.parameters.events.length})}function Pn(e){const t=e.parameters.values;return 1===t.length&&1===t[0].length?An.substitute(An.Intents.RangeEditValueStringLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${t[0][0]}`}):An.substitute(An.Intents.RangeEditLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Nn(e){const t=Rn&&!isNaN(e.parameters.value)?An.Intents.RangeEditValueNumberLabel:An.Intents.RangeEditValueStringLabel;return An.substitute(t,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),value:`${e.parameters.value}`})}function Mn(e){return e.parameters.command===w.default.ClearCellsFormat?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeClearFormatLabel,An.Intents.TableBodyRangeClearFormatLabel,An.Intents.TableHeaderRowRangeClearFormatLabel,An.Intents.TableTotalRowRangeClearFormatLabel,An.Intents.TableGeneralRangeClearFormatLabel,An.Intents.TableRowsRangeClearFormatLabel,An.Intents.TableRowByIndexRangeClearFormatLabel,An.Intents.TableColumnsRangeClearFormatLabel,An.Intents.TableColumnByNameRangeClearFormatLabel,An.Intents.TableColumnByIndexRangeClearFormatLabel,{}):An.substitute(An.Intents.RangeClearFormatLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeClearLabel,An.Intents.TableBodyRangeClearLabel,An.Intents.TableHeaderRowRangeClearLabel,An.Intents.TableTotalRowRangeClearLabel,An.Intents.TableGeneralRangeClearLabel,An.Intents.TableRowsRangeClearLabel,An.Intents.TableRowByIndexRangeClearLabel,An.Intents.TableColumnsRangeClearLabel,An.Intents.TableColumnByNameRangeClearLabel,An.Intents.TableColumnByIndexRangeClearLabel,{}):An.substitute(An.Intents.RangeClearLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function On(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeDeleteLabel,An.Intents.TableBodyRangeDeleteLabel,An.Intents.TableHeaderRowRangeDeleteLabel,An.Intents.TableTotalRowRangeDeleteLabel,An.Intents.TableGeneralRangeDeleteLabel,An.Intents.TableRowsRangeDeleteLabel,An.Intents.TableRowByIndexRangeDeleteLabel,An.Intents.TableColumnsRangeDeleteLabel,An.Intents.TableColumnByNameRangeDeleteLabel,An.Intents.TableColumnByIndexRangeDeleteLabel,{}):An.substitute(An.Intents.RangeDeleteLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Dn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeInsertedLabel,An.Intents.TableBodyRangeInsertedLabel,An.Intents.TableHeaderRowRangeInsertedLabel,An.Intents.TableTotalRowRangeInsertedLabel,An.Intents.TableGeneralRangeInsertedLabel,An.Intents.TableRowsRangeInsertedLabel,An.Intents.TableRowByIndexRangeInsertedLabel,An.Intents.TableColumnsRangeInsertedLabel,An.Intents.TableColumnByNameRangeInsertedLabel,An.Intents.TableColumnByIndexRangeInsertedLabel,{}):An.substitute(An.Intents.RangeInsertLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Bn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeMergeLabel,An.Intents.TableBodyRangeMergeLabel,An.Intents.TableHeaderRowRangeMergeLabel,An.Intents.TableTotalRowRangeMergeLabel,An.Intents.TableGeneralRangeMergeLabel,An.Intents.TableRowsRangeMergeLabel,An.Intents.TableRowByIndexRangeMergeLabel,An.Intents.TableColumnsRangeMergeLabel,An.Intents.TableColumnByNameRangeMergeLabel,An.Intents.TableColumnByIndexRangeMergeLabel,{}):An.substitute(An.Intents.RangeMergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function $n(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUnmergeLabel,An.Intents.TableBodyRangeUnmergeLabel,An.Intents.TableHeaderRowRangeUnmergeLabel,An.Intents.TableTotalRowRangeUnmergeLabel,An.Intents.TableGeneralRangeUnmergeLabel,An.Intents.TableRowsRangeUnmergeLabel,An.Intents.TableRowByIndexRangeUnmergeLabel,An.Intents.TableColumnsRangeUnmergeLabel,An.Intents.TableColumnByNameRangeUnmergeLabel,An.Intents.TableColumnByIndexRangeUnmergeLabel,{}):An.substitute(An.Intents.RangeUnmergeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Hn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeColumnsAutofitLabel,An.Intents.TableBodyRangeColumnsAutofitLabel,An.Intents.TableHeaderRowRangeColumnsAutofitLabel,An.Intents.TableTotalRowRangeColumnsAutofitLabel,An.Intents.TableGeneralRangeColumnsAutofitLabel,An.Intents.TableRowsRangeColumnsAutofitLabel,An.Intents.TableRowByIndexRangeColumnsAutofitLabel,An.Intents.TableColumnsRangeColumnsAutofitLabel,An.Intents.TableColumnByNameRangeColumnsAutofitLabel,An.Intents.TableColumnByIndexRangeColumnsAutofitLabel,{}):An.substitute(An.Intents.RangeColumnsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Un(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeRowsAutofitLabel,An.Intents.TableBodyRangeRowsAutofitLabel,An.Intents.TableHeaderRowRangeRowsAutofitLabel,An.Intents.TableTotalRowRangeRowsAutofitLabel,An.Intents.TableGeneralRangeRowsAutofitLabel,An.Intents.TableRowsRangeRowsAutofitLabel,An.Intents.TableRowByIndexRangeRowsAutofitLabel,An.Intents.TableColumnsRangeRowsAutofitLabel,An.Intents.TableColumnByNameRangeRowsAutofitLabel,An.Intents.TableColumnByIndexRangeRowsAutofitLabel,{}):An.substitute(An.Intents.RangeRowsAutofitLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function qn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUseStandardHeightLabel,An.Intents.TableBodyRangeUseStandardHeightLabel,An.Intents.TableHeaderRowRangeUseStandardHeightLabel,An.Intents.TableTotalRowRangeUseStandardHeightLabel,An.Intents.TableGeneralRangeUseStandardHeightLabel,An.Intents.TableRowsRangeUseStandardHeightLabel,An.Intents.TableRowByIndexRangeUseStandardHeightLabel,An.Intents.TableColumnsRangeUseStandardHeightLabel,An.Intents.TableColumnByNameRangeUseStandardHeightLabel,An.Intents.TableColumnByIndexRangeUseStandardHeightLabel,{}):An.substitute(An.Intents.RangeUseStandardHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Vn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUseStandardWidthLabel,An.Intents.TableBodyRangeUseStandardWidthLabel,An.Intents.TableHeaderRowRangeUseStandardWidthLabel,An.Intents.TableTotalRowRangeUseStandardWidthLabel,An.Intents.TableGeneralRangeUseStandardWidthLabel,An.Intents.TableRowsRangeUseStandardWidthLabel,An.Intents.TableRowByIndexRangeUseStandardWidthLabel,An.Intents.TableColumnsRangeUseStandardWidthLabel,An.Intents.TableColumnByNameRangeUseStandardWidthLabel,An.Intents.TableColumnByIndexRangeUseStandardWidthLabel,{}):An.substitute(An.Intents.RangeUseStandardWidthLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Gn(e){return An.substitute(An.Intents.RangeHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Wn(e){return An.substitute(An.Intents.RangeRemoveHyperlinkLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function zn(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeNumberFormatLabel,An.Intents.TableBodyRangeNumberFormatLabel,An.Intents.TableHeaderRowRangeNumberFormatLabel,An.Intents.TableTotalRowRangeNumberFormatLabel,An.Intents.TableGeneralRangeNumberFormatLabel,An.Intents.TableRowsRangeNumberFormatLabel,An.Intents.TableRowByIndexRangeNumberFormatLabel,An.Intents.TableColumnsRangeNumberFormatLabel,An.Intents.TableColumnByNameRangeNumberFormatLabel,An.Intents.TableColumnByIndexRangeNumberFormatLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!1),columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeNumberFormatLabel,{numberFormat:(0,v.X)(e.parameters.value,!1),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function jn(e){return 0===e.parameters.copyCutOperation?An.substitute(An.Intents.RangePasteCopyLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)}):An.substitute(An.Intents.RangePasteCutLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.destinationRange.range)})}function Qn(e){return An.substitute(An.Intents.RangeFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.target)})}function Jn(e){return An.substitute(An.Intents.TableCreateLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Yn(e){return An.substitute(An.Intents.TableInsertColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Xn(e){return An.substitute(An.Intents.TableRemoveColumnsLabel,{columnNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Zn(e){return An.substitute(An.Intents.TableInsertRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function Kn(e){return An.substitute(An.Intents.TableRemoveRowsLabel,{rowNumber:e.parameters.index+1,count:e.parameters.count,tableName:e.parameters.name})}function eo(e){return An.substitute(An.Intents.TableSortColumnLabel,{columnNumber:e.parameters.columnIndex,tableName:e.parameters.tableName})}function to(e){return An.substitute(An.Intents.TableClearFiltersLabel,{tableName:e.entityId})}function ao(e){return An.substitute(An.Intents.TableColumnClearFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function no(e){return An.substitute(An.Intents.TableReapplyFilterLabel,{tableName:e.parameters.tableName})}function oo(e){return An.substitute(An.Intents.TableFilterColumnLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName,values:e.parameters.values.join(", ")})}function ro(e){switch(e.parameters.value1.valueCompareType){case S.default.Equals:return An.substitute(An.Intents.TableColumnEqualsFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotEqual:return An.substitute(An.Intents.TableColumnDoesNotEqualFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.BeginsWith:return e.parameters.value2?An.substitute(An.Intents.TableColumnBeginsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnBeginsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotBeginWith:return e.parameters.value2?An.substitute(An.Intents.TableColumnDoesNotBeginWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnDoesNotBeginWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.EndsWith:return e.parameters.value2?An.substitute(An.Intents.TableColumnEndsWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnEndsWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotEndWith:return e.parameters.value2?An.substitute(An.Intents.TableColumnDoesNotEndWithFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnDoesNotEndWithFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.Contains:return e.parameters.value2?An.substitute(An.Intents.TableColumnContainsFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnContainsFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.DoesNotContain:return e.parameters.value2?An.substitute(An.Intents.TableColumnDoesNotContainFilterLabel2,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnDoesNotContainFilterLabel1,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThan:return An.substitute(An.Intents.TableColumnIsGreaterThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsGreaterThenOrEqualTo:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsLessThanOrEqualTo?An.substitute(An.Intents.TableColumnBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnIsGreaterThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThen:return e.parameters.value2&&e.parameters.value2.valueCompareType===S.default.IsGreaterThan?An.substitute(An.Intents.TableColumnNotBetweenFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value,value2:e.parameters.value2.value}):An.substitute(An.Intents.TableColumnIsLessThanFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});case S.default.IsLessThanOrEqualTo:return An.substitute(An.Intents.TableColumnIsLessThanOrEqualToFilterLabel,{columnName:e.parameters.columnName,value1:e.parameters.value1.value});default:return An.substitute(An.Intents.TableColumnCustomFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}}function io(e){return e.parameters.sharedSortConditions[0].columnName?An.substitute(An.Intents.TableColumnByNameCustomSortLabel,{tableName:e.parameters.tableName,columnName:e.parameters.sharedSortConditions[0].columnName}):e.parameters.sharedSortConditions[0].columnIndex?An.substitute(An.Intents.TableColumnByIndexCustomSortLabel,{tableName:e.parameters.tableName,columnIndex:e.parameters.sharedSortConditions[0].columnIndex}):An.substitute(An.Intents.TableCustomSortLabel,{tableName:e.parameters.tableName})}function lo(e){return An.substitute(An.Intents.TableClearSortLabel,{tableName:e.entityId})}function so(e){return An.substitute(An.Intents.TableColumnTopFilterLabel,{direction:e.parameters.top?"top":"bottom",count:e.parameters.count,columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function co(e){return An.substitute(An.Intents.TableColumnDynamicFilterLabel,{columnName:e.parameters.columnName,tableName:e.parameters.tableName})}function uo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatBoldLabel,An.Intents.TableBodyRangeFormatBoldLabel,An.Intents.TableHeaderRowRangeFormatBoldLabel,An.Intents.TableTotalRowRangeFormatBoldLabel,An.Intents.TableGeneralRangeFormatBoldLabel,An.Intents.TableRowsRangeFormatBoldLabel,An.Intents.TableRowByIndexRangeFormatBoldLabel,An.Intents.TableColumnsRangeFormatBoldLabel,An.Intents.TableColumnByNameRangeFormatBoldLabel,An.Intents.TableColumnByIndexRangeFormatBoldLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatBoldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatUnboldLabel,An.Intents.TableBodyRangeFormatUnboldLabel,An.Intents.TableHeaderRowRangeFormatUnboldLabel,An.Intents.TableTotalRowRangeFormatUnboldLabel,An.Intents.TableGeneralRangeFormatUnboldLabel,An.Intents.TableRowsRangeFormatUnboldLabel,An.Intents.TableRowByIndexRangeFormatUnboldLabel,An.Intents.TableColumnsRangeFormatUnboldLabel,An.Intents.TableColumnByNameRangeFormatUnboldLabel,An.Intents.TableColumnByIndexRangeFormatUnboldLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatUnboldLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatUnboldLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function mo(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatBoldLabel:An.Intents.MultiRangeFormatUnboldLabel}function ho(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatSuperscriptLabel:An.Intents.MultiRangeFormatRemoveSuperscriptLabel}function go(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatSubscriptLabel:An.Intents.MultiRangeFormatRemoveSubscriptLabel}function po(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatItalicLabel,An.Intents.TableBodyRangeFormatItalicLabel,An.Intents.TableHeaderRowRangeFormatItalicLabel,An.Intents.TableTotalRowRangeFormatItalicLabel,An.Intents.TableGeneralRangeFormatItalicLabel,An.Intents.TableRowsRangeFormatItalicLabel,An.Intents.TableRowByIndexRangeFormatItalicLabel,An.Intents.TableColumnsRangeFormatItalicLabel,An.Intents.TableColumnByNameRangeFormatItalicLabel,An.Intents.TableColumnByIndexRangeFormatItalicLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatItalicLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatItalicLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatUnitalicizeLabel,An.Intents.TableBodyRangeFormatUnitalicizeLabel,An.Intents.TableHeaderRowRangeFormatUnitalicizeLabel,An.Intents.TableTotalRowRangeFormatUnitalicizeLabel,An.Intents.TableGeneralRangeFormatUnitalicizeLabel,An.Intents.TableRowsRangeFormatUnitalicizeLabel,An.Intents.TableRowByIndexRangeFormatUnitalicizeLabel,An.Intents.TableColumnsRangeFormatUnitalicizeLabel,An.Intents.TableColumnByNameRangeFormatUnitalicizeLabel,An.Intents.TableColumnByIndexRangeFormatUnitalicizeLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatUnitalicizeLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatUnitalicizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function bo(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General)return pl(e.parameters.range,An.Intents.TableRangeFormatSetFontColorLabel,An.Intents.TableBodyRangeFormatSetFontColorLabel,An.Intents.TableHeaderRowRangeFormatSetFontColorLabel,An.Intents.TableTotalRowRangeFormatSetFontColorLabel,An.Intents.TableGeneralRangeFormatSetFontColorLabel,An.Intents.TableRowsRangeFormatSetFontColorLabel,An.Intents.TableRowByIndexRangeFormatSetFontColorLabel,An.Intents.TableColumnsRangeFormatSetFontColorLabel,An.Intents.TableColumnByNameRangeFormatSetFontColorLabel,An.Intents.TableColumnByIndexRangeFormatSetFontColorLabel,{color:e.parameters.value});if((0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName){const t=(0,m.yw9)("OfficeVSO_9425205_FixSetColumnFontColor")?An.Intents.ColumnNameFormatSetFontColorLabel:An.Intents.ColumnFormatSetFontColorLabel;return An.substitute(t,{columnName:e.parameters.columnName,color:e.parameters.value})}return An.substitute(An.Intents.RangeFormatSetFontColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:e.parameters.value})}function fo(e){return An.substitute(An.Intents.MultiRangeFormatSetFontColorLabel,{color:e.parameters.events[0].parameters.value})}function Co(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatSetFontLabel,An.Intents.TableBodyRangeFormatSetFontLabel,An.Intents.TableHeaderRowRangeFormatSetFontLabel,An.Intents.TableTotalRowRangeFormatSetFontLabel,An.Intents.TableGeneralRangeFormatSetFontLabel,An.Intents.TableRowsRangeFormatSetFontLabel,An.Intents.TableRowByIndexRangeFormatSetFontLabel,An.Intents.TableColumnsRangeFormatSetFontLabel,An.Intents.TableColumnByNameRangeFormatSetFontLabel,An.Intents.TableColumnByIndexRangeFormatSetFontLabel,{fontName:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameFormatSetFontLabel,{columnName:e.parameters.columnName,fontName:e.parameters.value}):An.substitute(An.Intents.RangeFormatSetFontLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontName:e.parameters.value})}function yo(e){return An.substitute(An.Intents.MultiRangeFormatSetFontLabel,{fontName:e.parameters.events[0].parameters.value})}function vo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatUnderlineLabel,An.Intents.TableBodyRangeFormatUnderlineLabel,An.Intents.TableHeaderRowRangeFormatUnderlineLabel,An.Intents.TableTotalRowRangeFormatUnderlineLabel,An.Intents.TableGeneralRangeFormatUnderlineLabel,An.Intents.TableRowsRangeFormatUnderlineLabel,An.Intents.TableRowByIndexRangeFormatUnderlineLabel,An.Intents.TableColumnsRangeFormatUnderlineLabel,An.Intents.TableColumnByNameRangeFormatUnderlineLabel,An.Intents.TableColumnByIndexRangeFormatUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatUnderlineLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatRemoveUnderlineLabel,An.Intents.TableBodyRangeFormatRemoveUnderlineLabel,An.Intents.TableHeaderRowRangeFormatRemoveUnderlineLabel,An.Intents.TableTotalRowRangeFormatRemoveUnderlineLabel,An.Intents.TableGeneralRangeFormatRemoveUnderlineLabel,An.Intents.TableRowsRangeFormatRemoveUnderlineLabel,An.Intents.TableRowByIndexRangeFormatRemoveUnderlineLabel,An.Intents.TableColumnsRangeFormatRemoveUnderlineLabel,An.Intents.TableColumnByNameRangeFormatRemoveUnderlineLabel,An.Intents.TableColumnByIndexRangeFormatRemoveUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveUnderlineLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function xo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatDoubleUnderlineLabel,An.Intents.TableBodyRangeFormatDoubleUnderlineLabel,An.Intents.TableHeaderRowRangeFormatDoubleUnderlineLabel,An.Intents.TableTotalRowRangeFormatDoubleUnderlineLabel,An.Intents.TableGeneralRangeFormatDoubleUnderlineLabel,An.Intents.TableRowsRangeFormatDoubleUnderlineLabel,An.Intents.TableRowByIndexRangeFormatDoubleUnderlineLabel,An.Intents.TableColumnsRangeFormatDoubleUnderlineLabel,An.Intents.TableColumnByNameRangeFormatDoubleUnderlineLabel,An.Intents.TableColumnByIndexRangeFormatDoubleUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatDoubleUnderlineLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableBodyRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableHeaderRowRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableTotalRowRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableGeneralRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableRowsRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableRowByIndexRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableColumnsRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableColumnByNameRangeFormatRemoveDoubleUnderlineLabel,An.Intents.TableColumnByIndexRangeFormatRemoveDoubleUnderlineLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveDoubleUnderlineLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveDoubleUnderlineLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function To(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatStrikethroughLabel,An.Intents.TableBodyRangeFormatStrikethroughLabel,An.Intents.TableHeaderRowRangeFormatStrikethroughLabel,An.Intents.TableTotalRowRangeFormatStrikethroughLabel,An.Intents.TableGeneralRangeFormatStrikethroughLabel,An.Intents.TableRowsRangeFormatStrikethroughLabel,An.Intents.TableRowByIndexRangeFormatStrikethroughLabel,An.Intents.TableColumnsRangeFormatStrikethroughLabel,An.Intents.TableColumnByNameRangeFormatStrikethroughLabel,An.Intents.TableColumnByIndexRangeFormatStrikethroughLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatStrikethroughLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatRemoveStrikethroughLabel,An.Intents.TableBodyRangeFormatRemoveStrikethroughLabel,An.Intents.TableHeaderRowRangeFormatRemoveStrikethroughLabel,An.Intents.TableTotalRowRangeFormatRemoveStrikethroughLabel,An.Intents.TableGeneralRangeFormatRemoveStrikethroughLabel,An.Intents.TableRowsRangeFormatRemoveStrikethroughLabel,An.Intents.TableRowByIndexRangeFormatRemoveStrikethroughLabel,An.Intents.TableColumnsRangeFormatRemoveStrikethroughLabel,An.Intents.TableColumnByNameRangeFormatRemoveStrikethroughLabel,An.Intents.TableColumnByIndexRangeFormatRemoveStrikethroughLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveStrikethroughLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveStrikethroughLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function So(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatSuperscriptLabel,An.Intents.TableBodyRangeFormatSuperscriptLabel,An.Intents.TableHeaderRowRangeFormatSuperscriptLabel,An.Intents.TableTotalRowRangeFormatSuperscriptLabel,An.Intents.TableGeneralRangeFormatSuperscriptLabel,An.Intents.TableRowsRangeFormatSuperscriptLabel,An.Intents.TableRowByIndexRangeFormatSuperscriptLabel,An.Intents.TableColumnsRangeFormatSuperscriptLabel,An.Intents.TableColumnByNameRangeFormatSuperscriptLabel,An.Intents.TableColumnByIndexRangeFormatSuperscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatSuperscriptLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatUnSuperscriptLabel,An.Intents.TableBodyRangeFormatRemoveSuperscriptLabel,An.Intents.TableHeaderRowRangeFormatRemoveSuperscriptLabel,An.Intents.TableTotalRowRangeFormatRemoveSuperscriptLabel,An.Intents.TableGeneralRangeFormatRemoveSuperscriptLabel,An.Intents.TableRowsRangeFormatRemoveSuperscriptLabel,An.Intents.TableRowByIndexRangeFormatRemoveSuperscriptLabel,An.Intents.TableColumnsRangeFormatRemoveSuperscriptLabel,An.Intents.TableColumnByNameRangeFormatRemoveSuperscriptLabel,An.Intents.TableColumnByIndexRangeFormatRemoveSuperscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveSuperscriptLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveSuperscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function wo(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatSubscriptLabel,An.Intents.TableBodyRangeFormatSubscriptLabel,An.Intents.TableHeaderRowRangeFormatSubscriptLabel,An.Intents.TableTotalRowRangeFormatSubscriptLabel,An.Intents.TableGeneralRangeFormatSubscriptLabel,An.Intents.TableRowsRangeFormatSubscriptLabel,An.Intents.TableRowByIndexRangeFormatSubscriptLabel,An.Intents.TableColumnsRangeFormatSubscriptLabel,An.Intents.TableColumnByNameRangeFormatSubscriptLabel,An.Intents.TableColumnByIndexRangeFormatSubscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatSubscriptLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFormatRemoveSubscriptLabel,An.Intents.TableBodyRangeFormatRemoveSubscriptLabel,An.Intents.TableHeaderRowRangeFormatRemoveSubscriptLabel,An.Intents.TableTotalRowRangeFormatRemoveSubscriptLabel,An.Intents.TableGeneralRangeFormatRemoveSubscriptLabel,An.Intents.TableRowsRangeFormatRemoveSubscriptLabel,An.Intents.TableRowByIndexRangeFormatRemoveSubscriptLabel,An.Intents.TableColumnsRangeFormatRemoveSubscriptLabel,An.Intents.TableColumnByNameRangeFormatRemoveSubscriptLabel,An.Intents.TableColumnByIndexRangeFormatRemoveSubscriptLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatRemoveSubscriptLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeFormatRemoveSubscriptLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Eo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetFontSizeLabel,An.Intents.TableBodyRangeSetFontSizeLabel,An.Intents.TableHeaderRowRangeSetFontSizeLabel,An.Intents.TableTotalRowRangeSetFontSizeLabel,An.Intents.TableGeneralRangeSetFontSizeLabel,An.Intents.TableRowsRangeSetFontSizeLabel,An.Intents.TableRowByIndexRangeSetFontSizeLabel,An.Intents.TableColumnsRangeSetFontSizeLabel,An.Intents.TableColumnByNameRangeSetFontSizeLabel,An.Intents.TableColumnByIndexRangeSetFontSizeLabel,{fontSize:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetFontSizeLabel,{columnName:e.parameters.columnName,fontSize:e.parameters.value}):An.substitute(An.Intents.RangeSetFontSizeLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),fontSize:e.parameters.value})}function Io(e){return An.substitute(An.Intents.MultiRangeSetFontSizeLabel,{fontSize:e.parameters.events[0].parameters.value})}function Ro(e){return"none"===e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeRemoveFontUnderlineStyleLabel,An.Intents.TableBodyRangeRemoveFontUnderlineStyleLabel,An.Intents.TableHeaderRowRangeRemoveFontUnderlineStyleLabel,An.Intents.TableTotalRowRangeRemoveFontUnderlineStyleLabel,An.Intents.TableGeneralRangeRemoveFontUnderlineStyleLabel,An.Intents.TableRowsRangeRemoveFontUnderlineStyleLabel,An.Intents.TableRowByIndexRangeRemoveFontUnderlineStyleLabel,An.Intents.TableColumnsRangeRemoveFontUnderlineStyleLabel,An.Intents.TableColumnByNameRangeRemoveFontUnderlineStyleLabel,An.Intents.TableColumnByIndexRangeRemoveFontUnderlineStyleLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameRemoveFontUnderlineStyleLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RemoveFontUnderlineStyleLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeFontUnderlineStyleLabel,An.Intents.TableBodyRangeFontUnderlineStyleLabel,An.Intents.TableHeaderRowRangeFontUnderlineStyleLabel,An.Intents.TableTotalRowRangeFontUnderlineStyleLabel,An.Intents.TableGeneralRangeFontUnderlineStyleLabel,An.Intents.TableRowsRangeFontUnderlineStyleLabel,An.Intents.TableRowByIndexRangeFontUnderlineStyleLabel,An.Intents.TableColumnsRangeFontUnderlineStyleLabel,An.Intents.TableColumnByNameRangeFontUnderlineStyleLabel,An.Intents.TableColumnByIndexRangeFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase()}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameFontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),columnName:e.parameters.columnName}):An.substitute(An.Intents.FontUnderlineStyleLabel,{style:e.parameters.value.replace(/([A-Z])/g," $1").toLocaleLowerCase(),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ao(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetBackgroundColorLabel,An.Intents.TableBodyRangeSetBackgroundColorLabel,An.Intents.TableHeaderRowRangeSetBackgroundColorLabel,An.Intents.TableTotalRowRangeSetBackgroundColorLabel,An.Intents.TableGeneralRangeSetBackgroundColorLabel,An.Intents.TableRowsRangeSetBackgroundColorLabel,An.Intents.TableRowByIndexRangeSetBackgroundColorLabel,An.Intents.TableColumnsRangeSetBackgroundColorLabel,An.Intents.TableColumnByNameRangeSetBackgroundColorLabel,An.Intents.TableColumnByIndexRangeSetBackgroundColorLabel,{color:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetBackgroundColorLabel,{columnName:e.parameters.columnName,color:e.parameters.value}):An.substitute(An.Intents.RangeSetBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),color:e.parameters.value})}function Lo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeClearBackgroundColorLabel,An.Intents.TableBodyRangeClearBackgroundColorLabel,An.Intents.TableHeaderRowRangeClearBackgroundColorLabel,An.Intents.TableTotalRowRangeClearBackgroundColorLabel,An.Intents.TableGeneralRangeClearBackgroundColorLabel,An.Intents.TableRowsRangeClearBackgroundColorLabel,An.Intents.TableRowByIndexRangeClearBackgroundColorLabel,An.Intents.TableColumnsRangeClearBackgroundColorLabel,An.Intents.TableColumnByNameRangeClearBackgroundColorLabel,An.Intents.TableColumnByIndexRangeClearBackgroundColorLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnFormatBoldLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeClearBackgroundColorLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ko(e){return An.substitute(An.Intents.MultiRangeSetBackgroundColorLabel,{color:e.parameters.events[0].parameters.value})}function Fo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetCellWidthLabel,An.Intents.TableBodyRangeSetCellWidthLabel,An.Intents.TableHeaderRowRangeSetCellWidthLabel,An.Intents.TableTotalRowRangeSetCellWidthLabel,An.Intents.TableGeneralRangeSetCellWidthLabel,An.Intents.TableRowsRangeSetCellWidthLabel,An.Intents.TableRowByIndexRangeSetCellWidthLabel,An.Intents.TableColumnsRangeSetCellWidthLabel,An.Intents.TableColumnByNameRangeSetCellWidthLabel,An.Intents.TableColumnByIndexRangeSetCellWidthLabel,{size:e.parameters.value/C.bN}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetCellWidthLabel,{size:e.parameters.value/C.bN,columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeSetCellWidthLabel,{size:e.parameters.value/C.bN,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function _o(e){return An.substitute(An.Intents.MultiRangeSetCellWidthLabel,{size:e.parameters.events[0].parameters.value})}function Po(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetCellHeightLabel,An.Intents.TableBodyRangeSetCellHeightLabel,An.Intents.TableHeaderRowRangeSetCellHeightLabel,An.Intents.TableTotalRowRangeSetCellHeightLabel,An.Intents.TableGeneralRangeSetCellHeightLabel,An.Intents.TableRowsRangeSetCellHeightLabel,An.Intents.TableRowByIndexRangeSetCellHeightLabel,An.Intents.TableColumnsRangeSetCellHeightLabel,An.Intents.TableColumnByNameRangeSetCellHeightLabel,An.Intents.TableColumnByIndexRangeSetCellHeightLabel,{size:e.parameters.value}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetCellHeightLabel,{columnName:e.parameters.columnName,size:e.parameters.value}):An.substitute(An.Intents.RangeSetCellHeightLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),size:e.parameters.value})}function No(e){return An.substitute(An.Intents.MultiRangeSetCellHeightLabel,{size:e.parameters.events[0].parameters.value})}function Mo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeApplyBorderLabel,An.Intents.TableBodyRangeApplyBorderLabel,An.Intents.TableHeaderRowRangeApplyBorderLabel,An.Intents.TableTotalRowRangeApplyBorderLabel,An.Intents.TableGeneralRangeApplyBorderLabel,An.Intents.TableRowsRangeApplyBorderLabel,An.Intents.TableRowByIndexRangeApplyBorderLabel,An.Intents.TableColumnsRangeApplyBorderLabel,An.Intents.TableColumnByNameRangeApplyBorderLabel,An.Intents.TableColumnByIndexRangeApplyBorderLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameApplyBorderLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeApplyBorderLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Oo(e){return An.substitute(An.Intents.NamedSheetViewDeleteLabel,{deletedNum:e.parameters.namedSheetViewNames.length})}function Do(e){return An.substitute(An.Intents.NamedSheetViewDuplicateLabel,{sheetViewName:e.parameters.namedSheetViewName})}function Bo(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?An.substitute(An.Intents.NamedSheetViewExitAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewKeepName}):An.Intents.NamedSheetViewExitLabel}function $o(e){return An.substitute(An.Intents.NamedSheetViewKeepLabel,{sheetViewName:e.parameters.namedSheetViewName})}function Ho(e){return An.substitute(An.Intents.NamedSheetViewRenameLabel,{newSheetViewName:e.parameters.newNamedSheetViewName})}function Uo(e){return void 0!==e.parameters.namedSheetViewKeepName&&e.parameters.namedSheetViewKeepName.length>0?An.substitute(An.Intents.NamedSheetViewSwitchAndKeepLabel,{sheetViewName:e.parameters.namedSheetViewName,sheetViewKeepName:e.parameters.namedSheetViewKeepName}):An.substitute(An.Intents.NamedSheetViewSwitchLabel,{sheetViewName:e.parameters.namedSheetViewName})}function qo(e){if(e.parameters.destinationRange.rangeType===i.RangeType.TableRange){let t;switch(e.parameters.destinationRange.range.subRange){case i.TableRangeOperationSubRange.WholeTable:t=An.Intents.RangePasteInTableRangeLabel;break;case i.TableRangeOperationSubRange.Body:t=An.Intents.RangePasteInTableBodyRangeLabel;break;case i.TableRangeOperationSubRange.HeaderRow:t=An.Intents.RangePasteInTableHeaderRowRangeLabel;break;case i.TableRangeOperationSubRange.TotalRow:t=An.Intents.RangePasteInTableTotalRowRangeLabel;break;case i.TableRangeOperationSubRange.General:t=An.Intents.RangePasteInTableGeneralRangeLabel;break;case i.TableRangeOperationSubRange.Rows:case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:t=An.Intents.RangePasteInTableRangeLabel}return An.substitute(t,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),tableName:e.entityId})}return An.substitute(An.Intents.RangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range),destinationRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).range)})}function Vo(e){return An.substitute(An.Intents.MultiRangePasteLabel,{sourceRange:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.events[0].parameters.sourceRange).range)})}function Go(e){return An.substitute(An.Intents.RangePasteTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Wo(e){return An.substitute(An.Intents.WorksheetDuplicateLabel,{sheet:e.entityId})}function zo(e){return An.substitute(An.Intents.WorksheetReapplyFiltersLabel,{sheet:e.entityId})}function jo(e){return An.substitute(An.Intents.WorksheetClearFiltersLabel,{sheet:e.entityId})}function Qo(e){return An.substitute(An.Intents.CellFindContainingLabel,{search:e.parameters.searchString})}function Jo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeReplaceAllLabel,An.Intents.TableBodyRangeReplaceAllLabel,An.Intents.TableHeaderRowRangeReplaceAllLabel,An.Intents.TableTotalRowRangeReplaceAllLabel,An.Intents.TableGeneralRangeReplaceAllLabel,An.Intents.TableRowsRangeReplaceAllLabel,An.Intents.TableRowByIndexRangeReplaceAllLabel,An.Intents.TableColumnsRangeReplaceAllLabel,An.Intents.TableColumnByNameRangeReplaceAllLabel,An.Intents.TableColumnByIndexRangeReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith}):An.substitute(An.Intents.ReplaceAllLabel,{search:e.parameters.searchString,replace:e.parameters.replaceWith,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Yo(e){return An.substitute(An.Intents.ReplaceAllLabelGeneric,{search:e.parameters.events[0].parameters.searchString,replace:e.parameters.events[0].parameters.replaceWith})}function Xo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetHorizontalAlignmentLabel,An.Intents.TableBodyRangeSetHorizontalAlignmentLabel,An.Intents.TableHeaderRowRangeSetHorizontalAlignmentLabel,An.Intents.TableTotalRowRangeSetHorizontalAlignmentLabel,An.Intents.TableGeneralRangeSetHorizontalAlignmentLabel,An.Intents.TableRowsRangeSetHorizontalAlignmentLabel,An.Intents.TableRowByIndexRangeSetHorizontalAlignmentLabel,An.Intents.TableColumnsRangeSetHorizontalAlignmentLabel,An.Intents.TableColumnByNameRangeSetHorizontalAlignmentLabel,An.Intents.TableColumnByIndexRangeSetHorizontalAlignmentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetHorizontalAlignmentLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeSetHorizontalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Zo(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeSetVerticalAlignmentLabel,An.Intents.TableBodyRangeSetVerticalAlignmentLabel,An.Intents.TableHeaderRowRangeSetVerticalAlignmentLabel,An.Intents.TableTotalRowRangeSetVerticalAlignmentLabel,An.Intents.TableGeneralRangeSetVerticalAlignmentLabel,An.Intents.TableRowsRangeSetVerticalAlignmentLabel,An.Intents.TableRowByIndexRangeSetVerticalAlignmentLabel,An.Intents.TableColumnsRangeSetVerticalAlignmentLabel,An.Intents.TableColumnByNameRangeSetVerticalAlignmentLabel,An.Intents.TableColumnByIndexRangeSetVerticalAlignmentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameSetVerticalAlignmentLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeSetVerticalAlignmentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ko(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeWrapTextLabel,An.Intents.TableBodyRangeWrapTextLabel,An.Intents.TableHeaderRowRangeWrapTextLabel,An.Intents.TableTotalRowRangeWrapTextLabel,An.Intents.TableGeneralRangeWrapTextLabel,An.Intents.TableRowsRangeWrapTextLabel,An.Intents.TableRowByIndexRangeWrapTextLabel,An.Intents.TableColumnsRangeWrapTextLabel,An.Intents.TableColumnByNameRangeWrapTextLabel,An.Intents.TableColumnByIndexRangeWrapTextLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameWrapTextLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeWrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUnwrapTextLabel,An.Intents.TableBodyRangeUnwrapTextLabel,An.Intents.TableHeaderRowRangeUnwrapTextLabel,An.Intents.TableTotalRowRangeUnwrapTextLabel,An.Intents.TableGeneralRangeUnwrapTextLabel,An.Intents.TableRowsRangeUnwrapTextLabel,An.Intents.TableRowByIndexRangeUnwrapTextLabel,An.Intents.TableColumnsRangeUnwrapTextLabel,An.Intents.TableColumnByNameRangeUnwrapTextLabel,An.Intents.TableColumnByIndexRangeUnwrapTextLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameUnwrapTextLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeUnwrapTextLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function er(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeChangeIndentLabel,An.Intents.TableBodyRangeChangeIndentLabel,An.Intents.TableHeaderRowRangeChangeIndentLabel,An.Intents.TableTotalRowRangeChangeIndentLabel,An.Intents.TableGeneralRangeChangeIndentLabel,An.Intents.TableRowsRangeChangeIndentLabel,An.Intents.TableRowByIndexRangeChangeIndentLabel,An.Intents.TableColumnsRangeChangeIndentLabel,An.Intents.TableColumnByNameRangeChangeIndentLabel,An.Intents.TableColumnByIndexRangeChangeIndentLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameChangeIndentLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeChangeIndentLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function tr(e){return An.substitute(An.Intents.WorksheetReorderLabel,{sheet:e.entityId})}function ar(e){return An.substitute(An.Intents.TableToggleAutoFilterLabel,{tableName:e.entityId})}function nr(e){return An.substitute(An.Intents.WorksheetToggleAutoFilterLabel,{sheet:e.entityId})}function or(e){return An.substitute(An.Intents.SlicerInsertedLabel,{pivotTable:e.parameters.pivotTable,pivotName:e.parameters.pivotFieldName})}function rr(e){if(e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General){const t=e.parameters.range;if(t.subRange===i.TableRangeOperationSubRange.WholeTable)return An.substitute(An.Intents.WorksheetTableRangeCreateChartLabel,{sheet:e.entityId,table:t.tableName})}return An.substitute(An.Intents.WorksheetCreateChartLabel,{sheet:e.entityId})}function ir(e){return`#${i.ExcelCalc.toHexColor(e)}`}function lr(e,t,a){const n=a?a(e.parameters.newValue):`${e.parameters.newValue}`;return e.parameters.category===i.ChartObjectCategory.ChartAxis?An.substitute(t,{newValue:n,axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?An.substitute(t,{newValue:n,seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):An.substitute(t,{newValue:n,chartName:e.parameters.chartName})}function sr(e,t){return e.parameters.category===i.ChartObjectCategory.ChartAxis?An.substitute(t,{axis:`${i.ChartAxisGroup[e.parameters.axisGroup].toLocaleLowerCase()} ${i.ChartAxisType[e.parameters.axisType].toLocaleLowerCase()} axis`,chartName:e.parameters.chartName}):e.parameters.category===i.ChartObjectCategory.Series?An.substitute(t,{seriesIndex:e.parameters.index,chartName:e.parameters.chartName}):An.substitute(t,{chartName:e.parameters.chartName})}function cr(e){return e.parameters.added?An.substitute(An.Intents.VisualSerriesTrendlineAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):An.substitute(An.Intents.VisualSerriesTrendlineRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function dr(e){return e.parameters.added?An.substitute(An.Intents.VisualSeriesTrendlineTitleAddedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex}):An.substitute(An.Intents.VisualSeriesTrendlineTitleRemovedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index,trendlineIndex:e.parameters.secondaryIndex})}function ur(e){return An.substitute(An.Intents.WorksheetCreateChartLabel,{sheet:e.entityId})}function mr(e){return e.parameters?An.substitute(An.Intents.WorksheetShowHeadingsLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetHideHeadingsLabel,{sheet:e.entityId})}function hr(e){return e.parameters?An.substitute(An.Intents.WorksheetShowGridlinesLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetHideGridlinesLabel,{sheet:e.entityId})}function gr(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeRemoveDuplicatesLabel,An.Intents.TableBodyRangeRemoveDuplicatesLabel,An.Intents.TableHeaderRowRangeRemoveDuplicatesLabel,An.Intents.TableTotalRowRangeRemoveDuplicatesLabel,An.Intents.TableGeneralRangeRemoveDuplicatesLabel,An.Intents.TableRowsRangeRemoveDuplicatesLabel,An.Intents.TableRowByIndexRangeRemoveDuplicatesLabel,An.Intents.TableColumnsRangeRemoveDuplicatesLabel,An.Intents.TableColumnByNameRangeRemoveDuplicatesLabel,An.Intents.TableColumnByIndexRangeRemoveDuplicatesLabel,{}):An.substitute(An.Intents.RangeRemoveDuplicatesLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function pr(e){const t=e.parameters?An.Intents.TableAddTotalRowLabel:An.Intents.TableRemoveTotalRowLabel;return An.substitute(t,{tableName:e.entityId})}function br(e){const t=e.parameters?An.Intents.TableAddHeaderRowLabel:An.Intents.TableRemoveHeaderRowLabel;return An.substitute(t,{tableName:e.entityId})}function fr(e){return An.substitute(An.Intents.TableResizeLabel,{tableName:e.entityId})}function Cr(e){return e.parameters.isCreation?An.substitute(An.Intents.TableCreateAndFormatLabel,{tableName:e.parameters.tableName,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):An.substitute(An.Intents.TableFormatLabel,{tableName:e.entityId})}function yr(e){return""===e.parameters?An.substitute(An.Intents.WorksheetClearTabColorLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetSetTabColorLabel,{color:e.parameters,sheet:e.entityId})}function vr(e){return An.substitute(An.Intents.WorksheetChartSwitchRowColumnLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function xr(e){return An.substitute(An.Intents.WorksheetChartSelectDataLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Tr(e){return An.substitute(An.Intents.WorksheetChartChangeTypeLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Sr(e){return An.substitute(An.Intents.RangeFlashFillLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function wr(e){return An.substitute(An.Intents.WorksheetChartChangeTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Er(e){return An.substitute(An.Intents.WorksheetChartHideTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Ir(e){return An.substitute(An.Intents.WorksheetChartChangeAxisTitleLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Rr(e){return An.substitute(An.Intents.WorksheetChartHideAxisTitleLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Ar(e){return An.substitute(An.Intents.WorksheetChartChangeLegendLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Lr(e){return An.substitute(An.Intents.WorksheetChartAxisTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function kr(e){return An.substitute(An.Intents.WorksheetCharTitleChangeTextLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Fr(e){return An.substitute(An.Intents.WorksheetChartHideLegendLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function _r(e){return An.substitute(An.Intents.WorksheetChartDataLabelChangePositionLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Pr(e){return An.substitute(An.Intents.WorksheetChartDataLabelChangeVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Nr(e){return An.substitute(An.Intents.WorksheetChartChangeAxisLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}function Mr(e){return An.substitute(An.Intents.WorksheetChartChangeAxisVisibilityLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function Or(e){return An.substitute(An.Intents.TableApplyStyleLabel,{tableName:e.entityId})}function Dr(e){const t=e.parameters?An.Intents.TableAddBandedRowsLabel:An.Intents.TableRemoveBandedRowsLabel;return An.substitute(t,{tableName:e.entityId})}function Br(e){const t=e.parameters?An.Intents.TableAddBandedColumnsLabel:An.Intents.TableRemoveBandedColumnsLabel;return An.substitute(t,{tableName:e.entityId})}function $r(e){return An.substitute(An.Intents.TableHighlightFirstColumnFilterLabel,{tableName:e.entityId})}function Hr(e){return An.substitute(An.Intents.TableHighlightLastColumnLabel,{tableName:e.entityId})}function Ur(e){const t=e.parameters?An.Intents.TableAddFilterButtonLabel:An.Intents.TableRemoveFilterButtonLabel;return An.substitute(t,{tableName:e.entityId})}function qr(e){return e.parameters.rangeToFreeze?An.Intents.WorksheetFreezePaneLabel:An.Intents.WorksheetUnFreezePaneLabel}function Vr(e){return An.substitute(An.Intents.WorksheetShapeInsertedLabel,{sheet:e.entityId})}function Gr(e){return An.substitute(An.Intents.WorksheetShapeSetStyleLabel,{sheet:e.entityId})}function Wr(e){return An.substitute(An.Intents.WorksheetChartDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId})}function zr(e){return An.substitute(An.Intents.ChartSeriesDeleteLabel,{chartName:e.parameters.chartName,sheet:e.entityId,seriesIndex:e.parameters.seriesIndex})}function jr(e){return An.substitute(An.Intents.ChartSeriesDataChangedLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.seriesIndex})}function Qr(e){return An.substitute(An.Intents.WorksheetFloatingObjectDeleteLabel,{sheet:e.entityId})}function Jr(e){return An.substitute(An.Intents.WorksheetChartMoveAndResizeLabel,{chartName:e.parameters.name,sheet:e.entityId})}function Yr(e){return An.substitute(An.Intents.WorksheetFloatingObjectMoveAndResizeLabel,{sheet:e.entityId})}function Xr(e){return An.substitute(An.Intents.WorksheetFloatingObjectZOrderChangedLabel,{sheet:e.entityId})}function Zr(e){return An.substitute(An.Intents.WorksheetShapeRotateLabel,{sheet:e.entityId})}function Kr(e){return An.substitute(An.Intents.WorksheetShapeAltTextApplyLabel,{sheet:e.entityId})}function ei(e){return An.substitute(An.Intents.WorksheetShapeTextChangedLabel,{sheet:e.entityId})}function ti(e){return e.parameters.value?An.substitute(An.Intents.WorksheetShapeTextBoldedLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetShapeTextUnboldedLabel,{sheet:e.entityId})}function ai(e){return e.parameters.value?An.substitute(An.Intents.WorksheetShapeTextItalicizedLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetShapeTextUnitalicizedLabel,{sheet:e.entityId})}function ni(e){return e.parameters.value?An.substitute(An.Intents.WorksheetShapeTextUnderlinedLabel,{sheet:e.entityId}):An.substitute(An.Intents.WorksheetShapeTextUnderlineRemovedLabel,{sheet:e.entityId})}function oi(e){return An.substitute(An.Intents.WorksheetShapeTextFontNameChangedLabel,{sheet:e.entityId,fontName:e.parameters.value})}function ri(e){return An.substitute(An.Intents.WorksheetShapeTextFontSizeChangedLabel,{sheet:e.entityId,fontSize:e.parameters.value})}function ii(e){return An.substitute(An.Intents.WorksheetShapeTextFontColorChangedLabel,{sheet:e.entityId,fontColor:e.parameters.value})}function li(e){return An.substitute(An.Intents.WorksheetShapeTextHorizontallyAlignedLabel,{sheet:e.entityId,fontColor:e.parameters.value})}function si(e){return An.substitute(An.Intents.WorksheetShapeTextVerticallyAlignedLabel,{sheet:e.entityId,fontColor:e.parameters.value})}function ci(e){return An.substitute(An.Intents.RangeGroupLabel,{sheet:e.entityId})}function di(e){return An.substitute(An.Intents.RangeUnGroupLabel,{sheet:e.entityId})}function ui(e){return An.substitute(An.Intents.WorksheetOutlineLevelsSetLabel,{sheet:e.entityId})}function mi(e){return An.substitute(An.Intents.RangeGroupDetailsShowLabel,{sheet:e.entityId})}function hi(e){return An.substitute(An.Intents.RangeGroupDetailsHideLabel,{sheet:e.entityId})}function gi(e){return An.substitute(An.Intents.RangeDataValidationChangedGroupLabel,{sheet:e.entityId})}function pi(e){return An.substitute(An.Intents.TableRenameLabel,{tableName:e.parameters})}function bi(e){return An.substitute(An.Intents.TableConvertToRangeLabel,{tableName:e.entityId})}function fi(e){return An.substitute(An.Intents.TableAltTextEditedLabel,{tableName:e.entityId})}function Ci(e){return An.substitute(An.Intents.TableAltTextTitleEditedLabel,{tableName:e.entityId})}function yi(e){return An.substitute(An.Intents.TableAltTextDescriptionEditedLabel,{tableName:e.entityId})}function vi(e){return An.substitute(An.Intents.PivotTableChangeLabel,{pivotName:e.parameters.events[0].parameters.pivotName})}function xi(e){return An.substitute(An.Intents.PivotTableAddPivot,{pivotName:e.parameters.pivotName})}function Ti(e){return An.substitute(An.Intents.PivotTableRemovePivot,{pivotName:e.parameters.pivotName})}function Si(e){return An.substitute(An.Intents.PivotTableRefreshLabel,{pivotName:e.parameters})}function wi(e){return e.parameters.value?An.substitute(An.Intents.PivotDrillExpandedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName}):An.substitute(An.Intents.PivotDrillCollapsedLabel,{pivotName:e.parameters.pivotName,pivotItem:e.parameters.pivotItemName})}function Ei(e){return An.substitute(An.Intents.PivotTableRenamedLabel,{newName:e.parameters.value})}function Ii(e){return e.parameters.value?An.substitute(An.Intents.PivotTableRowGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):An.substitute(An.Intents.PivotTableRowGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ri(e){return e.parameters.value?An.substitute(An.Intents.PivotTableColumnGrandTotalShownLabel,{pivotName:e.parameters.pivotName}):An.substitute(An.Intents.PivotTableColumnGrandTotalHiddenLabel,{pivotName:e.parameters.pivotName})}function Ai(e){return An.substitute(An.Intents.PivotTableLayoutTypeSetLabel,{pivotName:e.parameters.pivotName})}function Li(e){return An.substitute(An.Intents.WorksheetValuesFilterAppliedLabel,{range:i.ExcelCalc.columnFromIExcelAddress(e.parameters.range.range,e.parameters.column)})}function ki(e){return An.substitute(An.Intents.WorksheetCustomFilterAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Fi(e){return An.substitute(An.Intents.WorksheetDynamicFilterAppliedLabel,{range:i.ExcelCalc.ICellColumnSheetRangeToAddress({range:{topLeft:{column:e.parameters.column,row:null},bottomRight:{column:e.parameters.column,row:null}},sheet:""})})}function _i(e){return An.substitute(An.Intents.RangeSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Pi(e){return An.substitute(An.Intents.ArtPasteSameWorkbookLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.destinationRange).sheet})}function Ni(e){return An.substitute(An.Intents.RangeAutoSumLabel,{range:i.ExcelCalc.IExcelRangeToAddress(e.parameters.range.range)})}function Mi(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeHideRowsLabel,An.Intents.TableBodyRangeHideRowsLabel,An.Intents.TableHeaderRowRangeHideRowsLabel,An.Intents.TableTotalRowRangeHideRowsLabel,An.Intents.TableGeneralRangeHideRowsLabel,An.Intents.TableRowsRangeHideRowsLabel,An.Intents.TableRowByIndexRangeHideRowsLabel,An.Intents.TableColumnsRangeHideRowsLabel,An.Intents.TableColumnByNameRangeHideRowsLabel,An.Intents.TableColumnByIndexRangeHideRowsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameHideRowsLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeHideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUnhideRowsLabel,An.Intents.TableBodyRangeUnhideRowsLabel,An.Intents.TableHeaderRowRangeUnhideRowsLabel,An.Intents.TableTotalRowRangeUnhideRowsLabel,An.Intents.TableGeneralRangeUnhideRowsLabel,An.Intents.TableRowsRangeUnhideRowsLabel,An.Intents.TableRowByIndexRangeUnhideRowsLabel,An.Intents.TableColumnsRangeUnhideRowsLabel,An.Intents.TableColumnByNameRangeUnhideRowsLabel,An.Intents.TableColumnByIndexRangeUnhideRowsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameUnhideRowsLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeUnhideRowsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Oi(e){return e.parameters.value?e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeHideColumnsLabel,An.Intents.TableBodyRangeHideColumnsLabel,An.Intents.TableHeaderRowRangeHideColumnsLabel,An.Intents.TableTotalRowRangeHideColumnsLabel,An.Intents.TableGeneralRangeHideColumnsLabel,An.Intents.TableRowsRangeHideColumnsLabel,An.Intents.TableRowByIndexRangeHideColumnsLabel,An.Intents.TableColumnsRangeHideColumnsLabel,An.Intents.TableColumnByNameRangeHideColumnsLabel,An.Intents.TableColumnByIndexRangeHideColumnsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameHideColumnsLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeHideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)}):e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeUnhideColumnsLabel,An.Intents.TableBodyRangeUnhideColumnsLabel,An.Intents.TableHeaderRowRangeUnhideColumnsLabel,An.Intents.TableTotalRowRangeUnhideColumnsLabel,An.Intents.TableGeneralRangeUnhideColumnsLabel,An.Intents.TableRowsRangeUnhideColumnsLabel,An.Intents.TableRowByIndexRangeUnhideColumnsLabel,An.Intents.TableColumnsRangeUnhideColumnsLabel,An.Intents.TableColumnByNameRangeUnhideColumnsLabel,An.Intents.TableColumnByIndexRangeUnhideColumnsLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameUnhideColumnsLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeUnhideColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Di(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeHideRowsLabel:An.Intents.MultiRangeUnhideRowsLabel}function Bi(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeHideColumnsLabel:An.Intents.MultiRangeUnhideColumnsLabel}function $i(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableBodyRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableHeaderRowRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableTotalRowRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableGeneralRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableRowsRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableRowByIndexRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableColumnsRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableColumnByNameRangeConditionalFormattingCreatedGroupEventLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingCreatedGroupEventLabel,{}):An.substitute(An.Intents.ConditionalFormattingCreatedGroupEventLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Hi(e){const t=e.parameters.customFormat,a=[];t.IsTextBold&&a.push("bolded"),t.IsTextItalic&&a.push("italicized"),t.IsTextUnderlined&&a.push("underlined"),t.IsTextDoubleUnderlined&&a.push("double underlined");const n=[],o=t.BackgroundColor,r=t.TextColor,l=t.IsTextStrikethrough,s=t.BorderFormat.LineStyle,c=t.BorderFormat.Color;if(null!=o&&n.push(`${o} fill color`),null!=r&&n.push(`${r} font color`),l&&n.push("strikethrough"),s[0]!==i.BorderLineStyle.None){const e=(0,g.S)(c[0]);n.push(`${y.US[s[0]]} ${e} border`)}let u="";if(1===a.length&&0===n.length)u+=a[0];else if(0===a.length&&1===n.length)u+="applied a "+n[0]+" to";else if(1===a.length&&1===n.length)u+=a[0]+" and applied a "+n[0]+" to";else if(2===a.length&&0===n.length)u+=a[0]+" and "+a[1];else if(0===a.length&&2===n.length)u+="applied a "+n[0]+" and a "+n[1]+" to";else{if(a.length>0){for(let e=0;e<a.length-1;e++)u+=a[e]+", ";0===n.length?u+="and "+a[a.length-1]:u+=a[a.length-1]+", "}if(n.length>0)if(1===n.length)u+="and applied a "+n[0];else{u+="applied a ";for(let e=0;e<n.length-1;e++)u+=n[e]+", ";u+="and "+n[n.length-1]+" to"}}const m=[{key:d.Dh.EventType,value:d.Mv.LogSuccessMessageFormattingParameters},{key:d.Dh.SuccessMessageNumParameters,value:a.length+n.length},{key:d.Dh.SuccessMessageFormattingParameters,value:a.concat(n).join(", ")}];return(0,x.j)(m),u}function Ui(e){const t=/"|=|DATEVALUE|\(|\)/g;let a="cell value is ";const n=e.parameters.rule,o=n.operator;if(a+=y.Mb[o]+" "+n.formula1.replace(t,""),n.formula2&&(o===T.default.Between||o===T.default.NotBetween)){a+=" and "+n.formula2.replace(t,"")}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingCellValueCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingCellValueCreatedLabel,{cellFormat:Hi(e),cellValueCriteria:a}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingCellValueCreatedLabel,{cellFormat:Hi(e),columnName:e.parameters.columnName,cellValueCriteria:a}):An.substitute(An.Intents.ConditionalFormattingCellValueCreatedLabel,{cellFormat:Hi(e),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),cellValueCriteria:a})}function qi(e){const t=e.parameters.rule.formula;return e.parameters.rangeType===i.RangeType.TableRange?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingCustomFormulaCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingCustomFormulaCreatedLabel,{cellFormat:Hi(e),customFormula:t}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingCustomFormulaCreatedLabel,{cellFormat:Hi(e),columnName:e.parameters.columnName,customFormula:t}):An.substitute(An.Intents.ConditionalFormattingCustomFormulaCreatedLabel,{cellFormat:Hi(e),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),customFormula:t})}function Vi(e){const t=e.parameters.rule,a=y.tQ[t.operator]+" "+t.text;return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingTextComparisonCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingTextComparisonCreatedLabel,{cellFormat:Hi(e),textComparisonCriteria:a}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnConditionalFormattingTextComparisonCreatedLabel,{cellFormat:Hi(e),columnName:e.parameters.columnName,textComparisonCriteria:a}):An.substitute(An.Intents.ConditionalFormattingTextComparisonCreatedLabel,{cellFormat:Hi(e),range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range),textComparisonCriteria:a})}function Gi(e){const t=e.parameters.colorScaleFormat;let a="";if(t){const e=t.minimumColor,n=t.midpointColor,o=t.maximumColor;a=n?e+", "+n+", "+o:e+", "+o}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingColorScaleCustomCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingColorScaleCustomCreatedLabel,{colorScaleFormat:a}):An.substitute(An.Intents.ConditionalFormattingColorScaleCustomCreatedLabel,{colorScaleFormat:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Wi(e){const t=e.parameters.dataBarFormat;let a="";if(t){const e=t.isGradientFill,n=t.fillColor;a=e?"gradient "+n:"solid "+n}return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingDataBarCustomCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingDataBarCustomCreatedLabel,{dataBarFormat:a}):An.substitute(An.Intents.ConditionalFormattingDataBarCustomCreatedLabel,{dataBarFormat:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function zi(e){const t=e.parameters.style,a=y.B8[t];return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingIconSetCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingIconSetCreatedLabel,{iconSet:a}):An.substitute(An.Intents.ConditionalFormattingIconSetCreatedLabel,{iconSet:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ji(e){const t=e.parameters.rule,a=y.b3[t.criterion];return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingPresetCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingPresetCreatedLabel,{cellFormatting:Hi(e),presetCriterion:a}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingPresetCreatedLabel,{cellFormatting:Hi(e),presetCriterion:a,columnName:e.parameters.columnName}):An.substitute(An.Intents.ConditionalFormattingPresetCreatedLabel,{cellFormatting:Hi(e),presetCriterion:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Qi(e){const t=e.parameters.rule,a=y.GO[t.timePeriodType];return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingPresetDatesCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingPresetDatesCreatedLabel,{cellFormatting:Hi(e),dateString:a}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingPresetDatesCreatedLabel,{cellFormatting:Hi(e),dateString:a,columnName:e.parameters.columnName}):An.substitute(An.Intents.ConditionalFormattingPresetDatesCreatedLabel,{cellFormatting:Hi(e),dateString:a,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Ji(e){const t=e.parameters.rule.unique;return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingUniqueDuplicateCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingUniqueDuplicateCreatedLabel,{cellFormatting:Hi(e),unique:t?"unique":"duplicate"}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingUniqueDuplicateCreatedLabel,{cellFormatting:Hi(e),unique:t?"unique":"duplicate",columnName:e.parameters.columnName}):An.substitute(An.Intents.ConditionalFormattingUniqueDuplicateCreatedLabel,{cellFormatting:Hi(e),unique:t?"unique":"duplicate",range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Yi(e){const t=e.parameters.rule,a=t.rank,n=y.tg[t.type],o=An.substitute(n,{number:a});return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableBodyRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableTotalRowRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableGeneralRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableRowsRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableColumnsRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingTopBottomCreatedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingTopBottomCreatedLabel,{cellFormatting:Hi(e),topBottomRule:o}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameConditionalFormattingTopBottomCreatedLabel,{cellFormatting:Hi(e),topBottomRule:o,columnName:e.parameters.columnName}):An.substitute(An.Intents.ConditionalFormattingTopBottomCreatedLabel,{cellFormatting:Hi(e),topBottomRule:o,range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function Xi(e){return An.substitute(An.Intents.ConditionalFormattingEditedGroupEventLabel,{sheet:e.entityId})}function Zi(e){return An.substitute(An.Intents.ConditionalFormattingRuleDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.ranges[0]).range)})}function Ki(e){return s.O.MissingIntent}function el(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeConditionalFormattingDeletedLabel,An.Intents.TableBodyRangeConditionalFormattingDeletedLabel,An.Intents.TableHeaderRowRangeConditionalFormattingDeletedLabel,An.Intents.TableTotalRowRangeConditionalFormattingDeletedLabel,An.Intents.TableGeneralRangeConditionalFormattingDeletedLabel,An.Intents.TableRowsRangeConditionalFormattingDeletedLabel,An.Intents.TableRowByIndexRangeConditionalFormattingDeletedLabel,An.Intents.TableColumnsRangeConditionalFormattingDeletedLabel,An.Intents.TableColumnByNameRangeConditionalFormattingDeletedLabel,An.Intents.TableColumnByIndexRangeConditionalFormattingDeletedLabel,{}):An.substitute(An.Intents.ConditionalFormattingDeletedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function tl(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeCellStyleAppliedLabel,An.Intents.TableBodyRangeCellStyleAppliedLabel,An.Intents.TableHeaderRowRangeCellStyleAppliedLabel,An.Intents.TableTotalRowRangeCellStyleAppliedLabel,An.Intents.TableGeneralRangeCellStyleAppliedLabel,An.Intents.TableRowsRangeCellStyleAppliedLabel,An.Intents.TableRowByIndexRangeCellStyleAppliedLabel,An.Intents.TableColumnsRangeCellStyleAppliedLabel,An.Intents.TableColumnByNameRangeCellStyleAppliedLabel,An.Intents.TableColumnByIndexRangeCellStyleAppliedLabel,{}):(0,m.yw9)("OfficeVSO_8562565_ColumnNameInConfirmationMessage")&&e.parameters.columnName?An.substitute(An.Intents.ColumnNameCellStyleAppliedLabel,{columnName:e.parameters.columnName}):An.substitute(An.Intents.RangeCellStyleAppliedLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function al(e){return An.substitute(An.Intents.PictureInsertedEventLabel,{sheet:e.entityId})}function nl(e){return e.parameters.rangeType===i.RangeType.TableRange&&e.parameters.range.subRange!==i.TableRangeOperationSubRange.General?pl(e.parameters.range,An.Intents.TableRangeCustomSortLabel,An.Intents.TableBodyRangeCustomSortLabel,An.Intents.TableHeaderRowRangeCustomSortLabel,An.Intents.TableTotalRowRangeCustomSortLabel,An.Intents.TableGeneralRangeCustomSortLabel,An.Intents.TableRowsRangeCustomSortLabel,An.Intents.TableRowByIndexRangeCustomSortLabel,An.Intents.TableColumnsRangeCustomSortLabel,An.Intents.TableColumnByNameCustomSortLabel,An.Intents.TableColumnByIndexCustomSortLabel,{}):An.substitute(An.Intents.RangeCustomSortLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).range)})}function ol(e){return An.substitute(An.Intents.AutoFilterCustomSortLabel,{sheet:i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters).sheet})}function rl(e){return An.substitute(An.Intents.TextToColumnsLabel,{range:i.ExcelCalc.IExcelRangeToAddress(i.ExcelCalc.getIGeneralRangeOperationRange(e.parameters.sourceRange).range)})}function il(e){return An.substitute(An.Intents.AllowEditRangeAddedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function ll(e){return An.substitute(An.Intents.AllowEditRangeDeletedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function sl(e){return An.substitute(An.Intents.AllowEditRangeEditedLabel,{range:void 0!==e.parameters.events?e.parameters.events[1].parameters.title:e.parameters.title})}function cl(e){return An.substitute(An.Intents.SheetProtectionOptionsUpdatedLabel,{sheet:e.entityId})}function dl(e){return An.substitute(An.Intents.SheetProtectionPasswordUpdatedLabel,{sheet:e.entityId})}function ul(e){return An.substitute(An.Intents.SheetProtectionPausedLabel,{sheet:e.entityId})}function ml(e){return An.substitute(An.Intents.SheetProtectionProtectedLabel,{sheet:e.entityId})}function hl(e){return An.substitute(An.Intents.SheetProtectionResumedLabel,{sheet:e.entityId})}function gl(e){return An.substitute(An.Intents.SheetProtectionUnprotectedLabel,{sheet:e.entityId})}function pl(e,t,a,n,o,r,l,s,c,d,u,m){let h;switch(m.tableName=e.tableName,e.subRange){case i.TableRangeOperationSubRange.WholeTable:h=t;break;case i.TableRangeOperationSubRange.Body:h=a;break;case i.TableRangeOperationSubRange.HeaderRow:h=n;break;case i.TableRangeOperationSubRange.TotalRow:h=o;break;case i.TableRangeOperationSubRange.General:h=r;break;case i.TableRangeOperationSubRange.Columns:case i.TableRangeOperationSubRange.ColumnsBody:{h=c;const t=e.subRangeValues;if(t.columnNames)1===t.columnNames.length?(h=d,m.columnName=t.columnNames[0]):m.count=t.columnNames.length;else{const t=e.subRangeValues;1===t.count?(h=u,m.columnIndex=t.firstIndex):m.count=t.count}break}case i.TableRangeOperationSubRange.Rows:{const t=e.subRangeValues;1===t.count?(h=s,m.rowIndex=t.firstIndex):(h=l,m.count=t.count);break}}return An.substitute(h,m)}var bl=a(54947);function fl(e){let t=e.method;return t===i.EventMethods.System.Batched&&(t=e.parameters.method),t}const Cl=new Map([[i.EventMethods.Worksheet.Added,()=>An.Intents.WorksheetAddLabel],[i.EventMethods.Worksheet.AddedWithName,kn],[i.EventMethods.Worksheet.Deleted,()=>An.Intents.WorksheetDeleteLabel],[i.EventMethods.Worksheet.MultiSheetDeleted,_n],[i.EventMethods.Worksheet.Renamed,Fn],[i.EventMethods.Worksheet.Duplicated,Wo],[i.EventMethods.Worksheet.FilterReapplied,zo],[i.EventMethods.Worksheet.AutoFilterCleared,jo],[i.EventMethods.Worksheet.Reordered,tr],[i.EventMethods.Worksheet.AutoFilterToggled,nr],[i.EventMethods.Worksheet.GridlinesToggled,hr],[i.EventMethods.Worksheet.HeadingsToggled,mr],[i.EventMethods.Worksheet.TabColored,yr],[i.EventMethods.Worksheet.PaneFrozen,qr],[i.EventMethods.Worksheet.ColumnsFrozen,()=>An.Intents.WorksheetFreezeColumnsLabel],[i.EventMethods.Worksheet.RowsFrozen,()=>An.Intents.WorksheetFreezeRowsLabel],[i.EventMethods.Worksheet.OutlineLevelsShown,ui],[i.EventMethods.Worksheet.ValuesFilterApplied,Li],[i.EventMethods.Worksheet.CustomFilterApplied,ki],[i.EventMethods.Worksheet.DynamicFilterApplied,Fi],[i.EventMethods.Worksheet.VisibilityChanged,()=>An.Intents.WorksheetVisibilityChangedLabel],[i.EventMethods.Worksheet.MoveToEdge,()=>An.Intents.MoveToEdgeLabel],[i.EventMethods.Intent.CreateNamedItemOnWorkbook,()=>An.Intents.CreateNamedItem],[i.EventMethods.Intent.CreateNamedItemOnWorksheet,()=>An.Intents.CreateNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorkbook,()=>An.Intents.SetNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorksheet,()=>An.Intents.SetNamedItem],[i.EventMethods.Intent.DeleteNamedItemOnWorkbook,()=>An.Intents.DeleteNamedItem],[i.EventMethods.Intent.RangeSetIndent,()=>An.Intents.ChangeRangeIndent],[i.EventMethods.Intent.RangeAdjustIndent,()=>An.Intents.ChangeRangeIndent],[i.EventMethods.Range.Edited,Pn],[i.EventMethods.Range.SingleValueEdited,Nn],[i.EventMethods.Range.MultiRangeEdited,()=>An.Intents.MultiRangeEditLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>An.Intents.MultiRangeDeleteLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>An.Intents.MultiRangeDeleteLabel],[i.EventMethods.Range.Cleared,Mn],[i.EventMethods.Range.MultiRangeCleared,()=>An.Intents.MultiRangeClearLabel],[i.EventMethods.Range.Deleted,On],[i.EventMethods.Range.Inserted,Dn],[i.EventMethods.Range.Merged,Bn],[i.EventMethods.Range.MultiRangeMerged,()=>An.Intents.MultiRangeMergeLabel],[i.EventMethods.Range.MultiRangeInserted,()=>An.Intents.MultipleRangeInsertLabel],[i.EventMethods.Range.Unmerged,$n],[i.EventMethods.Range.MultiRangeUnmerged,()=>An.Intents.MultiRangeUnmergeLabel],[i.EventMethods.Range.ColumnsAutoFit,Hn],[i.EventMethods.Range.MultiRangeColumnsAutoFit,Hn],[i.EventMethods.Range.RowsAutoFit,Un],[i.EventMethods.Range.UseStandardHeight,qn],[i.EventMethods.Range.UseStandardWidth,Vn],[i.EventMethods.Range.MultiRangeRowsAutoFit,Un],[i.EventMethods.Range.HyperlinkApplied,Gn],[i.EventMethods.Range.HyperlinkRemoved,Wn],[i.EventMethods.Range.MultiRangeHyperlinkRemoved,()=>An.Intents.MultiRangeRemoveHyperlinkLabel],[i.EventMethods.Range.NumberFormatChanged,zn],[i.EventMethods.Range.MultiRangeNumberFormatChanged,()=>An.Intents.MultiRangeNumberFormatLabel],[i.EventMethods.Range.InsertCopiedCutCells,jn],[i.EventMethods.Range.InsertCopiedCutCellsInTable,e=>function(e){const t=e.parameters.destinationTableRange.subRangeValues;return 0===e.parameters.copyCutOperation?An.substitute(An.Intents.RangePasteCopyInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex}):An.substitute(An.Intents.RangePasteCutInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex})}(e)],[i.EventMethods.Range.Filled,Qn],[i.EventMethods.Range.DuplicatesRemoved,gr],[i.EventMethods.Range.FlashFilled,Sr],[i.EventMethods.Range.Grouped,ci],[i.EventMethods.Range.Ungrouped,di],[i.EventMethods.Range.GroupDetailsShown,mi],[i.EventMethods.Range.GroupDetailsHidden,hi],[i.EventMethods.Range.Sorted,_i],[i.EventMethods.Range.DataValidationChangedGroup,gi],[i.EventMethods.Range.AutoSum,Ni],[i.EventMethods.Range.CellStyleApplied,tl],[i.EventMethods.Range.MultiRangeCellStyleApplied,()=>An.Intents.MultiRangeCellStyleAppliedLabel],[i.EventMethods.Range.CustomSorted,nl],[i.EventMethods.Range.AutoFilterCustomSorted,ol],[i.EventMethods.Range.TextToColumns,rl],[i.EventMethods.Range.FixedWidthTextToColumns,()=>An.Intents.FixedWidthTextToColumns],[i.EventMethods.Intent.SetDataValidation,()=>An.Intents.IntentSetDataValidation],[i.EventMethods.Shape.Inserted,Vr],[i.EventMethods.Shape.StyleSet,Gr],[i.EventMethods.Shape.Deleted,Qr],[i.EventMethods.Shape.MovedAndResized,Yr],[i.EventMethods.Shape.ZOrderChanged,Xr],[i.EventMethods.Shape.Rotated,Zr],[i.EventMethods.Shape.AltTextApplied,Kr],[i.EventMethods.Shape.PictureInserted,al],[i.EventMethods.Shape.TextChanged,ei],[i.EventMethods.Shape.TextBolded,ti],[i.EventMethods.Shape.TextItalicized,ai],[i.EventMethods.Shape.TextUnderlined,ni],[i.EventMethods.Shape.TextFontNameChanged,oi],[i.EventMethods.Shape.TextFontSizeChanged,ri],[i.EventMethods.Shape.TextFontColorChanged,ii],[i.EventMethods.Shape.TextHorizontallyAligned,li],[i.EventMethods.Shape.TextVerticallyAligned,si],[i.EventMethods.PivotTable.Created,()=>An.Intents.PivotTableCreateLabel],[i.EventMethods.PivotTable.SortApplied,()=>An.Intents.PivotTableSortLabel],[i.EventMethods.PivotTable.PivotPositionChanged,()=>An.Intents.PivotTableChangePositionLabel],[i.EventMethods.PivotTable.CreatedOnNewSheet,()=>An.Intents.PivotTableCreateLabel],[i.EventMethods.PivotTable.PivotRemoved,Ti],[i.EventMethods.PivotTable.PivotAdded,xi],[i.EventMethods.PivotTable.PivotAdded,xi],[i.EventMethods.PivotTable.Pivoted,vi],[i.EventMethods.PivotTable.Refreshed,Si],[i.EventMethods.PivotTable.PivotDrillToggled,wi],[i.EventMethods.PivotTable.Renamed,Ei],[i.EventMethods.PivotTable.RowGrandTotalShown,Ii],[i.EventMethods.PivotTable.ColumnGrandTotalShown,Ri],[i.EventMethods.PivotTable.AutoFitColumnWidthsOnRefreshToggled,e=>function(e){return An.substitute(An.Intents.PivotTableAutoFitColumnWidthsOnRefreshToggledLabel,{pivotName:e.parameters.pivotName,value:e.parameters.value})}(e)],[i.EventMethods.PivotTable.SubTotalsVisibilitySettingSet,e=>function(e){return An.substitute(An.Intents.PivotTableSubTotalsVisibilitySettingSetLabel,{pivotName:e.parameters.pivotName})}(e)],[i.EventMethods.PivotTable.LayoutTypeSet,Ai],[i.EventMethods.Slicer.Inserted,or],[i.EventMethods.Chart.Created,rr],[i.EventMethods.Chart.MultiRangeCreated,ur],[i.EventMethods.Chart.RowColumnSwitched,vr],[i.EventMethods.Chart.DataSelected,xr],[i.EventMethods.Chart.TypeChanged,Tr],[i.EventMethods.Chart.TitleChanged,wr],[i.EventMethods.Chart.TitleTextChanged,kr],[i.EventMethods.Chart.TitleHidden,Er],[i.EventMethods.Chart.AxisTitleChanged,Ir],[i.EventMethods.Chart.AxisTitleHidden,Rr],[i.EventMethods.Chart.AxisTitleTextChanged,Lr],[i.EventMethods.Chart.AxisTitleHorizontal,()=>An.Intents.ChartAxisTitleHorizontal],[i.EventMethods.Chart.AxisTitleVertical,()=>An.Intents.ChartAxisTitleVertical],[i.EventMethods.Chart.LegendChanged,Ar],[i.EventMethods.Chart.LegendHidden,Fr],[i.EventMethods.Chart.DataLabelPositionChanged,_r],[i.EventMethods.Chart.DataLabelVisibilityChanged,Pr],[i.EventMethods.Chart.GridlinesVisibilityChanged,e=>function(e){return An.substitute(An.Intents.WorksheetChartChangeGridlineVisiblityLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}(e)],[i.EventMethods.Chart.AxisChanged,Nr],[i.EventMethods.Chart.AxisVisiblityChanged,Mr],[i.EventMethods.Chart.Deleted,Wr],[i.EventMethods.Chart.MovedAndResized,Jr],[i.EventMethods.Chart.SeriesDeleted,zr],[i.EventMethods.Chart.SeriesDataChanged,jr],[i.EventMethods.ChartFormat.SetGetProperties,e=>function(e){return An.substitute(An.Intents.ChartFormatSetGetPropertiesLabel,{count:e.parameters.events.length,chartName:e.parameters.events[0].parameters.chartName})}(e)],[i.EventMethods.Visual.ChartAxisAxisTitleFillColored,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFillColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisAxisTitleFontBolded,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontColored,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisAxisTitleFontItalicized,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontNamed,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontNamedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontSized,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontSizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontUnderlined,e=>lr(e,An.Intents.VisualChartAxisAxisTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleLineColored,e=>lr(e,An.Intents.VisualChartAxisAxisTitleLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisAxisTitleTextChanged,e=>lr(e,An.Intents.VisualChartAxisAxisTitleTextChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMaxChanged,e=>lr(e,An.Intents.VisualChartAxisBoundsMaxChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMinChanged,e=>lr(e,An.Intents.VisualChartAxisBoundsMinChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesAtChanged,e=>lr(e,An.Intents.VisualChartAxisCrossesAtChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesChanged,e=>lr(e,An.Intents.VisualChartAxisCrossesChangedLabel)],[i.EventMethods.Visual.ChartAxisFillColored,e=>lr(e,An.Intents.VisualChartAxisFillColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisFontBolded,e=>lr(e,An.Intents.VisualChartAxisFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisFontColored,e=>lr(e,An.Intents.VisualChartAxisFontColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisFontItalicized,e=>lr(e,An.Intents.VisualChartAxisFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisFontNamed,e=>lr(e,An.Intents.VisualChartAxisFontNamedLabel)],[i.EventMethods.Visual.ChartAxisFontSized,e=>lr(e,An.Intents.VisualChartAxisFontSizedLabel)],[i.EventMethods.Visual.ChartAxisFontUnderlined,e=>lr(e,An.Intents.VisualChartAxisFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesLineColored,e=>lr(e,An.Intents.VisualChartAxisMajorGridlinesLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesLineColored,e=>lr(e,An.Intents.VisualChartAxisMinorGridlinesLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisLineColored,e=>lr(e,An.Intents.VisualChartAxisLineColoredLabel,ir)],[i.EventMethods.Visual.ChartAxisNumberFormatCodeChanged,e=>lr(e,An.Intents.VisualChartAxisNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.ChartAxisReversePlotOrderChanged,e=>lr(e,An.Intents.VisualChartAxisReversePlotOrderChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMajorTypeChanged,e=>lr(e,An.Intents.VisualChartAxisTickMarksMajorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMinorTypeChanged,e=>lr(e,An.Intents.VisualChartAxisTickMarksMinorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMajorUnitChanged,e=>lr(e,An.Intents.VisualChartAxisUnitsMajorUnitChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMinorUnitChanged,e=>lr(e,An.Intents.VisualChartAxisUnitsMinorUnitChangedLabel)],[i.EventMethods.Visual.ChartTitleFillColored,e=>lr(e,An.Intents.VisualChartTitleFillColoredLabel,ir)],[i.EventMethods.Visual.ChartTitleFontBolded,e=>lr(e,An.Intents.VisualChartTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartTitleFontColored,e=>lr(e,An.Intents.VisualChartTitleFontColoredLabel,ir)],[i.EventMethods.Visual.ChartTitleFontItalicized,e=>lr(e,An.Intents.VisualChartTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartTitleFontNamed,e=>lr(e,An.Intents.VisualChartTitleFontNamedLabel)],[i.EventMethods.Visual.ChartTitleFontSized,e=>lr(e,An.Intents.VisualChartTitleFontSizedLabel)],[i.EventMethods.Visual.ChartTitleFontUnderlined,e=>lr(e,An.Intents.VisualChartTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartTitleLineColored,e=>lr(e,An.Intents.VisualChartTitleLineColoredLabel,ir)],[i.EventMethods.Visual.ChartTitleOverlayChanged,e=>lr(e,An.Intents.VisualChartTitleOverlayChangedLabel)],[i.EventMethods.Visual.ChartTitleTextChanged,e=>lr(e,An.Intents.VisualChartTitleTextChangedLabel)],[i.EventMethods.Visual.LegendFillCleared,()=>An.Intents.VisualLegendFillClearedLabel],[i.EventMethods.Visual.LegendFillColored,e=>lr(e,An.Intents.VisualLegendFillColoredLabel,ir)],[i.EventMethods.Visual.LegendFontBolded,e=>lr(e,An.Intents.VisualLegendFontBoldedLabel)],[i.EventMethods.Visual.LegendFontColored,e=>lr(e,An.Intents.VisualLegendFontColoredLabel,ir)],[i.EventMethods.Visual.LegendFontItalicized,e=>lr(e,An.Intents.VisualLegendFontItalicizedLabel)],[i.EventMethods.Visual.LegendFontNamed,e=>lr(e,An.Intents.VisualLegendFontNamedLabel)],[i.EventMethods.Visual.LegendFontSized,e=>lr(e,An.Intents.VisualLegendFontSizedLabel)],[i.EventMethods.Visual.LegendFontUnderlined,e=>lr(e,An.Intents.VisualLegendFontUnderlinedLabel)],[i.EventMethods.Visual.LegendLineCleared,()=>An.Intents.VisualLegendLineClearedLabel],[i.EventMethods.Visual.LegendLineStyleChanged,()=>An.Intents.VisualLegendLineStyleChangedLabel],[i.EventMethods.Visual.LegendLineWeightChanged,()=>An.Intents.VisualLegendLineWeightChangedLabel],[i.EventMethods.Visual.LegendLineColored,e=>lr(e,An.Intents.VisualLegendLineColoredLabel,ir)],[i.EventMethods.Visual.LegendOverlayChanged,e=>lr(e,An.Intents.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.LegendPositionChanged,e=>lr(e,An.Intents.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinCount,e=>lr(e,An.Intents.VisualSeriesBinningOptionsBinCountLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinWidth,e=>lr(e,An.Intents.VisualSeriesBinningOptionsBinWidthLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinningType,e=>lr(e,An.Intents.VisualSeriesBinningOptionsBinningTypeLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowEnabled,e=>lr(e,An.Intents.VisualSeriesBinningOptionsOverflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowValue,e=>lr(e,An.Intents.VisualSeriesBinningOptionsOverflowValueLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowEnabled,e=>lr(e,An.Intents.VisualSeriesBinningOptionsUnderflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowValue,e=>lr(e,An.Intents.VisualSeriesBinningOptionsUnderflowValueLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerQuartileCalculation,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerQuartileCalculationLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowInnerPoints,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerShowInnerPointsLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanLine,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerShowMeanLineLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanMarker,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerShowMeanMarkerLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowOutliers,e=>lr(e,An.Intents.VisualSeriesBoxWhiskerShowOutliersLabel)],[i.EventMethods.Visual.SeriesBubbleScaleSized,e=>lr(e,An.Intents.VisualSeriesBubbleScaleSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCategoryNameToggled,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsCategoryNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCustomSeparatorChanged,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsLegendKeyToggled,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsLegendKeyToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeparatorChanged,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeriesNameToggled,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsSeriesNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsValueToggled,e=>lr(e,An.Intents.VisualSeriesDataLabelsContainsValueToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsFillFormatColored,e=>lr(e,An.Intents.VisualSeriesDataLabelsFillFormatColoredLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatBolded,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatBoldedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatColored,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatColoredLabel,ir)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatItalicized,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatItaliizedcLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatNamed,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatNamedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatSized,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatUnderlined,e=>lr(e,An.Intents.VisualSeriesDataLabelsFontFormatUnderlinedLabel)],[i.EventMethods.Visual.SeriesDataLabelsLineFormatColored,e=>lr(e,An.Intents.VisualSeriesDataLabelsLineFormatColoredLabel,ir)],[i.EventMethods.Visual.SeriesDataLabelsNumberFormatCodeChanged,e=>lr(e,An.Intents.VisualSeriesDataLabelsNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsPositioned,e=>lr(e,An.Intents.VisualSeriesDataLabelsPositionedLabel)],[i.EventMethods.Visual.SeriesDoughnutHoleSized,e=>lr(e,An.Intents.VisualSeriesDoughnutHoleSizedLabel)],[i.EventMethods.Visual.SeriesFillColored,e=>lr(e,An.Intents.VisualSeriesFillColoredLabel,ir)],[i.EventMethods.Visual.SeriesGapWidthChanged,e=>lr(e,An.Intents.VisualSeriesGapWidthChangedLabel)],[i.EventMethods.Visual.SeriesLineColored,e=>lr(e,An.Intents.VisualSeriesLineColoredLabel,ir)],[i.EventMethods.Visual.SeriesMarkersFillColored,e=>lr(e,An.Intents.VisualSeriesMakersFillColoredLabel,ir)],[i.EventMethods.Visual.SeriesMarkersLineColored,e=>lr(e,An.Intents.VisualSeriesMakersLineColoredLabel,ir)],[i.EventMethods.Visual.SeriesMarkersMarkerSized,e=>lr(e,An.Intents.VisualSeriesMakersMarkerSizedLabel)],[i.EventMethods.Visual.SeriesMarkersMarkerStyleChanged,e=>lr(e,An.Intents.VisualSeriesMakersMarkerStyleChangedLabel)],[i.EventMethods.Visual.SeriesNamed,e=>lr(e,An.Intents.VisualSeriesNamedLabel)],[i.EventMethods.Visual.SeriesTreemapParentLabelStrategy,e=>lr(e,An.Intents.VisualSeriesTreemapParentLabelStrategyLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>lr(e,An.Intents.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>lr(e,An.Intents.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesWaterfallShowConnectorLines,e=>lr(e,An.Intents.VisualSeriesWaterfallShowConnectorLinesLabel)],[i.EventMethods.Visual.SeriesTrendlineTypeSet,e=>lr(e,An.Intents.VisualSeriesTrendlineTypeSetLabel)],[i.EventMethods.Visual.SeriesTrendlineNameSet,e=>lr(e,An.Intents.VisualSeriesTrendlineNameChangedLabel)],[i.EventMethods.Visual.SeriesTrendlineEquationDisplayed,e=>lr(e,An.Intents.VisualSeriesTrendlineEquationDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineRSquaredDisplayed,e=>lr(e,An.Intents.VisualSeriesTrendlineRSquaredDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineInterceptSet,e=>lr(e,An.Intents.VisualSeriesTrendlineInterceptSetLabel)],[i.EventMethods.Visual.SeriesTrendlineIsCustomInterceptSet,e=>function(e){return e.parameters.newValue?An.substitute(An.Intents.VisualSeriesTrendlineManualSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):An.substitute(An.Intents.VisualSeriesTrendlineAutomaticSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index})}(e)],[i.EventMethods.Visual.SeriesTrendlineLineFormatColored,e=>lr(e,An.Intents.VisualSeriesTrendlineLineFormatColoredLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastForwardSet,e=>lr(e,An.Intents.VisualSeriesTrendlineForecastForwardSetLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastBackwardSet,e=>lr(e,An.Intents.VisualSeriesTrendlineForecastBackwardSetLabel)],[i.EventMethods.Visual.ChartTitleAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualChartTitleAddedLabel:An.Intents.VisualChartTitleRemovedLabel)],[i.EventMethods.Visual.LegendAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualLegendAddedLabel:An.Intents.VisualLegendRemovedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualChartAxisAxisTitleAddedLabel:An.Intents.VisualChartAxisAxisTitleRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualChartAxisGridlinesMajorGridlinesAddedLabel:An.Intents.VisualChartAxisGridlinesMajorGridlinesRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualChartAxisGridlinesMinorGridlinesAddedLabel:An.Intents.VisualChartAxisGridlinesMinorGridlinesRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarXAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualSeriesErrorBarXAddedLabel:An.Intents.VisualSeriesErrorBarXRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarYAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualSeriesErrorBarYAddedLabel:An.Intents.VisualSeriesErrorBarYRemovedLabel)],[i.EventMethods.Visual.SeriesTrendlineAddedRemoved,cr],[i.EventMethods.Visual.SeriesTrendlineTitleAddedRemoved,dr],[i.EventMethods.Visual.SeriesDataLabelsAddedRemoved,e=>sr(e,e.parameters.added?An.Intents.VisualSeriesDataLabelsAddedLabel:An.Intents.VisualSeriesDataLabelsRemovedLabel)],[i.EventMethods.Visual.ChartTitleFillCleared,()=>An.Intents.ChartTitleFillClearedLabel],[i.EventMethods.Visual.ChartTitleLineCleared,()=>An.Intents.ChartTitleLineClearedLabel],[i.EventMethods.Visual.ChartTitleLineStyleChanged,()=>An.Intents.ChartTitleLineStyleChangedLabel],[i.EventMethods.Visual.ChartTitleWeightChanged,()=>An.Intents.ChartTitleWeightChangedLabel],[i.EventMethods.Table.Created,Jn],[i.EventMethods.Table.ColumnInserted,Yn],[i.EventMethods.Table.ColumnsDeleted,Xn],[i.EventMethods.Table.ColumnRearranged,()=>An.Intents.TableColumnsRearrangeLabel],[i.EventMethods.Table.RowInserted,Zn],[i.EventMethods.Table.RowsDeleted,Kn],[i.EventMethods.Table.FilterCleared,ao],[i.EventMethods.Table.FilterReapplied,no],[i.EventMethods.Table.ValuesFilterApplied,oo],[i.EventMethods.Table.CustomFilterApplied,ro],[i.EventMethods.Table.CustomSorted,io],[i.EventMethods.Table.SortCleared,lo],[i.EventMethods.Table.Top10FilterApplied,so],[i.EventMethods.Table.DynamicFilterApplied,co],[i.EventMethods.Table.ColumnSorted,eo],[i.EventMethods.Table.RowRearranged,()=>An.Intents.TableRowsRearrangeLabel],[i.EventMethods.Table.AutoFilterCleared,to],[i.EventMethods.Table.AutoFilterToggled,ar],[i.EventMethods.Table.TotalRowToggled,pr],[i.EventMethods.Table.HeaderRowToggled,br],[i.EventMethods.Table.Resized,fr],[i.EventMethods.Table.CreatedWithFormat,Cr],[i.EventMethods.Table.StyleApplied,Or],[i.EventMethods.Table.BandedColumnsVisibilityChanged,Br],[i.EventMethods.Table.BandedRowsVisibilityChanged,Dr],[i.EventMethods.Table.FirstColumnHighlighted,$r],[i.EventMethods.Table.LastColumnHighlighted,Hr],[i.EventMethods.Table.FilterButtonVisibilityChanged,Ur],[i.EventMethods.Table.Renamed,pi],[i.EventMethods.Table.Converted,bi],[i.EventMethods.Table.AltTextEdited,fi],[i.EventMethods.Table.AltTextTitleEdited,Ci],[i.EventMethods.Table.AltTextDescriptionEdited,yi],[i.EventMethods.PivotChart.Created,()=>An.Intents.PivotChartCreateLabel],[i.EventMethods.PivotChart.OnNewSheetCreated,()=>An.Intents.PivotChartCreateLabel],[i.EventMethods.Font.Bolded,uo],[i.EventMethods.Font.MultiRangeBolded,mo],[i.EventMethods.Font.Italicized,po],[i.EventMethods.Font.MultiRangeItalicized,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatItalicizeLabel:An.Intents.MultiRangeFormatUnItalicizeLabel}(e)],[i.EventMethods.Font.Colored,bo],[i.EventMethods.Font.MultiRangeColored,fo],[i.EventMethods.Font.Named,Co],[i.EventMethods.Font.MultiRangeNamed,yo],[i.EventMethods.Font.Underlined,vo],[i.EventMethods.Font.MultiRangeUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatUnderlineLabel:An.Intents.MultiRangeFormatRemoveUnderlineLabel}(e)],[i.EventMethods.Font.DoubleUnderlined,xo],[i.EventMethods.Font.MultiRangeDoubleUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatDoubleUnderlineLabel:An.Intents.MultiRangeFormatRemoveDoubleUnderlineLabel}(e)],[i.EventMethods.Font.Superscript,So],[i.EventMethods.Font.Subscript,wo],[i.EventMethods.Font.MultiRangeSuperscript,ho],[i.EventMethods.Font.MultiRangeSubscript,go],[i.EventMethods.Font.Superscript,So],[i.EventMethods.Font.MultiRangeSuperscript,ho],[i.EventMethods.Font.StrikeThrough,To],[i.EventMethods.Font.MultiRangeStrikeThrough,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeFormatStrikethroughLabel:An.Intents.MultiRangeFormatRemoveStrikethroughLabel}(e)],[i.EventMethods.Font.UnderlineStyle,Ro],[i.EventMethods.Font.Sized,Eo],[i.EventMethods.Font.MultiRangeSized,Io],[i.EventMethods.Fill.Colored,Ao],[i.EventMethods.Fill.MultiRangeColored,ko],[i.EventMethods.Fill.ColorCleared,Lo],[i.EventMethods.Fill.MultiRangeColorCleared,()=>An.Intents.MultiRangeClearBackgroundColorLabel],[i.EventMethods.Fill.Patterned,()=>An.Intents.RangeFillPatternAppliedLabel],[i.EventMethods.CellDimensions.ColumnWidthSet,Fo],[i.EventMethods.CellDimensions.MultiRangeColumnWidthSet,_o],[i.EventMethods.CellDimensions.RowHeightSet,Po],[i.EventMethods.CellDimensions.MultiRangeRowHeightSet,No],[i.EventMethods.CellDimensions.RowsHidden,Mi],[i.EventMethods.CellDimensions.MultiRangeRowsHidden,Di],[i.EventMethods.CellDimensions.ColumnsHidden,Oi],[i.EventMethods.CellDimensions.MultiRangeColumnsHidden,Bi],[i.EventMethods.Border.BorderChanged,Mo],[i.EventMethods.Border.MultiRangeBorderChanged,()=>An.Intents.MultiRangeApplyBorderLabel],[i.EventMethods.NamedSheetView.Created,()=>An.Intents.NamedSheetViewCreateLabel],[i.EventMethods.NamedSheetView.Deleted,Oo],[i.EventMethods.NamedSheetView.Duplicated,Do],[i.EventMethods.NamedSheetView.Exited,Bo],[i.EventMethods.NamedSheetView.Kept,$o],[i.EventMethods.NamedSheetView.Renamed,Ho],[i.EventMethods.NamedSheetView.Switched,Uo],[i.EventMethods.Paste.Range,qo],[i.EventMethods.Paste.MultiRange,Vo],[i.EventMethods.Paste.String,Go],[i.EventMethods.Paste.ArtSameWorkbook,Pi],[i.EventMethods.Comment.Inserted,()=>An.Intents.CommentInsertLabel],[i.EventMethods.Comment.MultiRangeInserted,()=>An.Intents.CommentInsertLabel],[i.EventMethods.Comment.Edited,()=>An.Intents.CommentEditLabel],[i.EventMethods.Comment.MultiRangeEdited,()=>An.Intents.CommentEditLabel],[i.EventMethods.Comment.Deleted,()=>An.Intents.CommentDeleteLabel],[i.EventMethods.Comment.MultiRangeDeleted,()=>An.Intents.CommentDeleteLabel],[i.EventMethods.Reply.Inserted,()=>An.Intents.CommentInsertReplyLabel],[i.EventMethods.Reply.MultiRangeInserted,()=>An.Intents.CommentInsertReplyLabel],[i.EventMethods.Reply.Edited,()=>An.Intents.CommentEditReplyLabel],[i.EventMethods.Reply.MultiRangeEdited,()=>An.Intents.CommentEditReplyLabel],[i.EventMethods.Reply.Deleted,()=>An.Intents.CommentDeleteReplyLabel],[i.EventMethods.Reply.MultiRangeDeleted,()=>An.Intents.CommentDeleteReplyLabel],[i.EventMethods.Range.ReplacedAll,Jo],[i.EventMethods.Workbook.ReplacedAll,Jo],[i.EventMethods.Worksheet.ReplacedAll,Jo],[i.EventMethods.Range.MultiRangeReplacedAll,Yo],[i.EventMethods.Worksheet.MultiRangeReplacedAll,Yo],[i.EventMethods.Workbook.MultiRangeReplacedAll,Yo],[i.EventMethods.Range.FoundNext,Qo],[i.EventMethods.Workbook.FoundNext,Qo],[i.EventMethods.Workbook.CalculationModeSet,()=>An.Intents.WorkbookSetCalculationModeLabel],[i.EventMethods.Workbook.Recalculated,()=>An.Intents.WorkbookRecalculateLabel],[i.EventMethods.Alignment.HorizontalAlignmentSet,Xo],[i.EventMethods.Alignment.MultiRangeHorizontalAlignmentSet,()=>An.Intents.MultiRangeSetHorizontalAlignmentLabel],[i.EventMethods.Alignment.VerticalAlignmentSet,Zo],[i.EventMethods.Alignment.MultiRangeVerticalAlignmentSet,()=>An.Intents.MultiRangeSetVerticalAlignmentLabel],[i.EventMethods.CellText.WrapChanged,Ko],[i.EventMethods.CellText.MultiRangeWrapChanged,e=>function(e){return e.parameters.events[0].parameters.value?An.Intents.MultiRangeWrapTextLabel:An.Intents.MultiRangeUnwrapTextLabel}(e)],[i.EventMethods.Indent.Set,er],[i.EventMethods.Indent.Incremented,er],[i.EventMethods.Indent.MultiRangeSet,()=>An.Intents.MultiRangeChangeIndentLabel],[i.EventMethods.ConditionalFormatting.CreatedGroup,$i],[i.EventMethods.ConditionalFormatting.CellValueCreated,Ui],[i.EventMethods.ConditionalFormatting.CustomCreated,qi],[i.EventMethods.ConditionalFormatting.ColorScaleCustomCreated,Gi],[i.EventMethods.ConditionalFormatting.DataBarCustomCreated,Wi],[i.EventMethods.ConditionalFormatting.DatesCreated,Qi],[i.EventMethods.ConditionalFormatting.IconSetCreated,zi],[i.EventMethods.ConditionalFormatting.PresetCreated,ji],[i.EventMethods.ConditionalFormatting.TextComparisonCreated,Vi],[i.EventMethods.ConditionalFormatting.TopBottomCreated,Yi],[i.EventMethods.ConditionalFormatting.UniqueCreated,Ji],[i.EventMethods.ConditionalFormatting.EditedGroup,Xi],[i.EventMethods.ConditionalFormatting.Deleted,el],[i.EventMethods.ConditionalFormatting.RuleDeleted,Zi],[i.EventMethods.ConditionalFormatting.PriorityEdited,Ki],[i.EventMethods.Workbook.RefreshedAll,()=>An.Intents.WorkbookRefreshAllLabel],[i.EventMethods.Workbook.ExternalLinksRefreshed,()=>An.Intents.ExternalLinksRefreshedLabel],[i.EventMethods.Workbook.ExternalLinksRefreshedAll,()=>An.Intents.ExternalLinksRefreshedAllLabel],[i.EventMethods.Workbook.ExternalLinksBrokeLink,()=>An.Intents.ExternalLinksBrokeLinkLabel],[i.EventMethods.Workbook.ExternalLinksBrokeAllLinks,()=>An.Intents.ExternalLinksBrokeAllLinksLabel],[i.EventMethods.Workbook.ExternalLinksSetAutoRefresh,()=>An.Intents.ExternalLinksSetAutoRefreshLabel],[i.EventMethods.Workbook.ExternalLinksChangedSource,()=>An.Intents.ExternalLinksChangedSourceLabel],[i.EventMethods.PageLayout.AddedToPrintArea,()=>An.Intents.PageLayoutAddedToPrintAreaLabel],[i.EventMethods.PageLayout.OrientationChanged,()=>An.Intents.PageLayoutOrientationChangedLabel],[i.EventMethods.PageLayout.PageBreakInserted,()=>An.Intents.PageLayoutPageBreakInsertedLabel],[i.EventMethods.PageLayout.PageBreakRemoved,()=>An.Intents.PageLayoutPageBreakRemovedLabel],[i.EventMethods.PageLayout.PageBreaksAllReset,()=>An.Intents.PageLayoutPageBreaksAllResetLabel],[i.EventMethods.PageLayout.PaperSizeChanged,()=>An.Intents.PageLayoutPaperSizeChangedLabel],[i.EventMethods.PageLayout.PrintAreaCleared,()=>An.Intents.PageLayoutPrintAreaClearedLabel],[i.EventMethods.PageLayout.PrintAreaSet,()=>An.Intents.PageLayoutPrintAreaSetLabel],[i.EventMethods.PageLayout.PrintSettingsChanged,()=>An.Intents.PageLayoutPrintSettingsChangedLabel],[i.EventMethods.PageLayout.ScalingChanged,()=>An.Intents.PageLayoutScalingChangedLabel],[i.EventMethods.AllowEditRange.Added,il],[i.EventMethods.AllowEditRange.Deleted,ll],[i.EventMethods.AllowEditRange.Edited,sl],[i.EventMethods.SheetProtection.OptionsUpdated,cl],[i.EventMethods.SheetProtection.PasswordUpdated,dl],[i.EventMethods.SheetProtection.Paused,ul],[i.EventMethods.SheetProtection.Resumed,hl],[i.EventMethods.SheetProtection.Protected,ml],[i.EventMethods.SheetProtection.Unprotected,gl],[i.EventMethods.CellText.OrientationChanged,Ln],[i.EventMethods.CellText.MultiRangeOrientationChanged,()=>An.Intents.CellTextOrientationChangedGeneric],[i.EventMethods.Chart.Renamed,()=>An.Intents.ChartRenamed],[i.EventMethods.Comment.Resolved,()=>An.Intents.CommentResolved],[i.EventMethods.Table.Deleted,()=>An.Intents.TableDeleted],[i.EventMethods.Worksheet.Calculated,()=>An.Intents.WorksheetCalculated],[i.EventMethods.Intent.ChangeRangeBorder,()=>An.Intents.IntentChangeRangeBorder],[i.EventMethods.Intent.CreateConditionalFormatColorScale,()=>An.Intents.IntentCreateConditionalFormatColorScale],[i.EventMethods.Intent.CreateConditionalFormatDataBar,()=>An.Intents.IntentCreateConditionalFormatDataBar],[i.EventMethods.Intent.RangeCopyFrom,()=>An.Intents.IntentRangeCopyFrom],[i.EventMethods.Intent.CreateConditionalFormatCellValue,()=>An.Intents.IntentCreateConditionalFormatCellValue],[i.EventMethods.Intent.CreateConditionalFormatPreset,()=>An.Intents.IntentCreateConditionalFormatPreset],[i.EventMethods.Intent.CreateConditionalFormatContainsText,()=>An.Intents.IntentCreateConditionalFormatContainsText],[i.EventMethods.Intent.CreateConditionalFormatTopBottom,()=>An.Intents.IntentCreateConditionalFormatTopBottom],[i.EventMethods.Intent.CreateConditionalFormatCustom,()=>An.Intents.IntentCreateConditionalFormatCustom],[i.EventMethods.Intent.CreateConditionalFormatIconSet,()=>An.Intents.IntentCreateConditionalFormatIconSet],[i.EventMethods.System.Undo,()=>An.Intents.UndoLabel],[i.EventMethods.System.Redo,()=>An.Intents.RedoLabel],[i.EventMethods.System.Unknown,()=>An.Intents.UnknownEventLabel],[i.EventMethods.System.Unsupported,()=>An.Intents.UnsupportedEventLabel],[i.EventMethods.System.InProgress,()=>An.Intents.InProgressEventLabel],[i.EventMethods.System.Undefined,()=>An.Intents.UnknownEventLabel],[i.EventMethods.Error.Alias,()=>An.Intents.ErrorAliasInfo],[i.EventMethods.Error.Unknown,()=>An.Intents.ErrorUnknown],[i.EventMethods.Error.UpstreamExceptionOccured,()=>An.Intents.ErrorUnknown]]),yl=new Map([[i.EventMethods.Worksheet.Added,()=>ExcelCopilotCommandingHitlStrings.WorksheetAddLabel],[i.EventMethods.Worksheet.AddedWithName,k],[i.EventMethods.Worksheet.Deleted,()=>ExcelCopilotCommandingHitlStrings.WorksheetDeleteLabel],[i.EventMethods.Worksheet.MultiSheetDeleted,_],[i.EventMethods.Worksheet.Renamed,F],[i.EventMethods.Worksheet.Duplicated,Ge],[i.EventMethods.Worksheet.FilterReapplied,We],[i.EventMethods.Worksheet.AutoFilterCleared,ze],[i.EventMethods.Worksheet.Reordered,et],[i.EventMethods.Worksheet.AutoFilterToggled,at],[i.EventMethods.Worksheet.GridlinesToggled,mt],[i.EventMethods.Worksheet.HeadingsToggled,ut],[i.EventMethods.Worksheet.TabColored,Ct],[i.EventMethods.Worksheet.PaneFrozen,Ut],[i.EventMethods.Worksheet.ColumnsFrozen,()=>ExcelCopilotCommandingHitlStrings.WorksheetFreezeColumnsLabel],[i.EventMethods.Worksheet.RowsFrozen,()=>ExcelCopilotCommandingHitlStrings.WorksheetFreezeRowsLabel],[i.EventMethods.Worksheet.OutlineLevelsShown,da],[i.EventMethods.Worksheet.ValuesFilterApplied,Aa],[i.EventMethods.Worksheet.CustomFilterApplied,La],[i.EventMethods.Worksheet.DynamicFilterApplied,ka],[i.EventMethods.Worksheet.VisibilityChanged,()=>ExcelCopilotCommandingHitlStrings.WorksheetVisibilityChangedLabel],[i.EventMethods.Worksheet.MoveToEdge,()=>ExcelCopilotCommandingHitlStrings.MoveToEdgeLabel],[i.EventMethods.Intent.CreateNamedItemOnWorkbook,()=>ExcelCopilotCommandingHitlStrings.CreateNamedItem],[i.EventMethods.Intent.CreateNamedItemOnWorksheet,()=>ExcelCopilotCommandingHitlStrings.CreateNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorkbook,()=>ExcelCopilotCommandingHitlStrings.SetNamedItem],[i.EventMethods.Intent.SetNamedItemOnWorksheet,()=>ExcelCopilotCommandingHitlStrings.SetNamedItem],[i.EventMethods.Intent.DeleteNamedItemOnWorkbook,()=>ExcelCopilotCommandingHitlStrings.DeleteNamedItem],[i.EventMethods.Intent.RangeSetIndent,()=>ExcelCopilotCommandingHitlStrings.ChangeRangeIndent],[i.EventMethods.Intent.RangeAdjustIndent,()=>ExcelCopilotCommandingHitlStrings.ChangeRangeIndent],[i.EventMethods.Range.Edited,P],[i.EventMethods.Range.SingleValueEdited,N],[i.EventMethods.Range.MultiRangeEdited,()=>ExcelCopilotCommandingHitlStrings.MultiRangeEditLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.MultiRangeDeleteLabel],[i.EventMethods.Range.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.MultiRangeDeleteLabel],[i.EventMethods.Range.Cleared,M],[i.EventMethods.Range.MultiRangeCleared,()=>ExcelCopilotCommandingHitlStrings.MultiRangeClearLabel],[i.EventMethods.Range.Deleted,O],[i.EventMethods.Range.Inserted,D],[i.EventMethods.Range.Merged,B],[i.EventMethods.Range.MultiRangeMerged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeMergeLabel],[i.EventMethods.Range.MultiRangeInserted,()=>ExcelCopilotCommandingHitlStrings.MultipleRangeInsertLabel],[i.EventMethods.Range.Unmerged,$],[i.EventMethods.Range.MultiRangeUnmerged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeUnmergeLabel],[i.EventMethods.Range.ColumnsAutoFit,H],[i.EventMethods.Range.MultiRangeColumnsAutoFit,H],[i.EventMethods.Range.RowsAutoFit,U],[i.EventMethods.Range.UseStandardHeight,q],[i.EventMethods.Range.UseStandardWidth,V],[i.EventMethods.Range.MultiRangeRowsAutoFit,U],[i.EventMethods.Range.HyperlinkApplied,G],[i.EventMethods.Range.HyperlinkRemoved,W],[i.EventMethods.Range.MultiRangeHyperlinkRemoved,()=>ExcelCopilotCommandingHitlStrings.MultiRangeRemoveHyperlinkLabel],[i.EventMethods.Range.NumberFormatChanged,z],[i.EventMethods.Range.MultiRangeNumberFormatChanged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeNumberFormatLabel],[i.EventMethods.Range.InsertCopiedCutCells,j],[i.EventMethods.Range.InsertCopiedCutCellsInTable,e=>function(e){const t=e.parameters.destinationTableRange.subRangeValues;return 0===e.parameters.copyCutOperation?A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCopyInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex}):A.substitute(ExcelCopilotCommandingHitlStrings.RangePasteCutInTableLabel,{tableName:e.entityId,rowIndex:t.firstIndex})}(e)],[i.EventMethods.Range.Filled,Q],[i.EventMethods.Range.DuplicatesRemoved,ht],[i.EventMethods.Range.FlashFilled,Tt],[i.EventMethods.Range.Grouped,sa],[i.EventMethods.Range.Ungrouped,ca],[i.EventMethods.Range.GroupDetailsShown,ua],[i.EventMethods.Range.GroupDetailsHidden,ma],[i.EventMethods.Range.Sorted,Fa],[i.EventMethods.Range.DataValidationChangedGroup,ha],[i.EventMethods.Range.AutoSum,Pa],[i.EventMethods.Range.CellStyleApplied,an],[i.EventMethods.Range.MultiRangeCellStyleApplied,()=>ExcelCopilotCommandingHitlStrings.MultiRangeCellStyleAppliedLabel],[i.EventMethods.Range.CustomSorted,on],[i.EventMethods.Range.AutoFilterCustomSorted,rn],[i.EventMethods.Range.TextToColumns,ln],[i.EventMethods.Range.FixedWidthTextToColumns,()=>ExcelCopilotCommandingHitlStrings.FixedWidthTextToColumns],[i.EventMethods.Intent.SetDataValidation,()=>ExcelCopilotCommandingHitlStrings.IntentSetDataValidation],[i.EventMethods.Shape.Inserted,qt],[i.EventMethods.Shape.StyleSet,Vt],[i.EventMethods.Shape.Deleted,jt],[i.EventMethods.Shape.MovedAndResized,Jt],[i.EventMethods.Shape.ZOrderChanged,Yt],[i.EventMethods.Shape.Rotated,Xt],[i.EventMethods.Shape.AltTextApplied,Zt],[i.EventMethods.Shape.PictureInserted,nn],[i.EventMethods.Shape.TextChanged,Kt],[i.EventMethods.Shape.TextBolded,ea],[i.EventMethods.Shape.TextItalicized,ta],[i.EventMethods.Shape.TextUnderlined,aa],[i.EventMethods.Shape.TextFontNameChanged,na],[i.EventMethods.Shape.TextFontSizeChanged,oa],[i.EventMethods.Shape.TextFontColorChanged,ra],[i.EventMethods.Shape.TextHorizontallyAligned,ia],[i.EventMethods.Shape.TextVerticallyAligned,la],[i.EventMethods.PivotTable.Created,()=>ExcelCopilotCommandingHitlStrings.PivotTableCreateLabel],[i.EventMethods.PivotTable.SortApplied,()=>ExcelCopilotCommandingHitlStrings.PivotTableSortLabel],[i.EventMethods.PivotTable.PivotPositionChanged,()=>ExcelCopilotCommandingHitlStrings.PivotTableChangePositionLabel],[i.EventMethods.PivotTable.CreatedOnNewSheet,()=>ExcelCopilotCommandingHitlStrings.PivotTableCreateLabel],[i.EventMethods.PivotTable.PivotRemoved,xa],[i.EventMethods.PivotTable.PivotAdded,va],[i.EventMethods.PivotTable.PivotAdded,va],[i.EventMethods.PivotTable.Pivoted,ya],[i.EventMethods.PivotTable.Refreshed,Ta],[i.EventMethods.PivotTable.PivotDrillToggled,Sa],[i.EventMethods.PivotTable.Renamed,wa],[i.EventMethods.PivotTable.RowGrandTotalShown,Ea],[i.EventMethods.PivotTable.ColumnGrandTotalShown,Ia],[i.EventMethods.PivotTable.AutoFitColumnWidthsOnRefreshToggled,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableAutoFitColumnWidthsOnRefreshToggledLabel,{pivotName:e.parameters.pivotName,value:e.parameters.value})}(e)],[i.EventMethods.PivotTable.SubTotalsVisibilitySettingSet,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.PivotTableSubTotalsVisibilitySettingSetLabel,{pivotName:e.parameters.pivotName})}(e)],[i.EventMethods.PivotTable.LayoutTypeSet,Ra],[i.EventMethods.Slicer.Inserted,nt],[i.EventMethods.Chart.Created,ot],[i.EventMethods.Chart.MultiRangeCreated,dt],[i.EventMethods.Chart.RowColumnSwitched,yt],[i.EventMethods.Chart.DataSelected,vt],[i.EventMethods.Chart.TypeChanged,xt],[i.EventMethods.Chart.TitleChanged,St],[i.EventMethods.Chart.TitleTextChanged,Lt],[i.EventMethods.Chart.TitleHidden,wt],[i.EventMethods.Chart.AxisTitleChanged,Et],[i.EventMethods.Chart.AxisTitleHidden,It],[i.EventMethods.Chart.AxisTitleTextChanged,At],[i.EventMethods.Chart.AxisTitleHorizontal,()=>ExcelCopilotCommandingHitlStrings.ChartAxisTitleHorizontal],[i.EventMethods.Chart.AxisTitleVertical,()=>ExcelCopilotCommandingHitlStrings.ChartAxisTitleVertical],[i.EventMethods.Chart.LegendChanged,Rt],[i.EventMethods.Chart.LegendHidden,kt],[i.EventMethods.Chart.DataLabelPositionChanged,Ft],[i.EventMethods.Chart.DataLabelVisibilityChanged,_t],[i.EventMethods.Chart.GridlinesVisibilityChanged,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.WorksheetChartChangeGridlineVisiblityLabel,{chartName:e.parameters.events[0].parameters.chartName,sheet:e.entityId})}(e)],[i.EventMethods.Chart.AxisChanged,Pt],[i.EventMethods.Chart.AxisVisiblityChanged,Nt],[i.EventMethods.Chart.Deleted,Gt],[i.EventMethods.Chart.MovedAndResized,Qt],[i.EventMethods.Chart.SeriesDeleted,Wt],[i.EventMethods.Chart.SeriesDataChanged,zt],[i.EventMethods.ChartFormat.SetGetProperties,e=>function(e){return A.substitute(ExcelCopilotCommandingHitlStrings.ChartFormatSetGetPropertiesLabel,{count:e.parameters.events.length,chartName:e.parameters.events[0].parameters.chartName})}(e)],[i.EventMethods.Visual.ChartAxisAxisTitleFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFillColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisAxisTitleFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisAxisTitleFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontNamedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontSizedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisAxisTitleTextChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleTextChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMaxChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisBoundsMaxChangedLabel)],[i.EventMethods.Visual.ChartAxisBoundsMinChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisBoundsMinChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesAtChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisCrossesAtChangedLabel)],[i.EventMethods.Visual.ChartAxisCrossesChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisCrossesChangedLabel)],[i.EventMethods.Visual.ChartAxisFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFillColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontBoldedLabel)],[i.EventMethods.Visual.ChartAxisFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontItalicizedLabel)],[i.EventMethods.Visual.ChartAxisFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontNamedLabel)],[i.EventMethods.Visual.ChartAxisFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontSizedLabel)],[i.EventMethods.Visual.ChartAxisFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisFontUnderlinedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisMajorGridlinesLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisMinorGridlinesLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisLineColoredLabel,rt)],[i.EventMethods.Visual.ChartAxisNumberFormatCodeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.ChartAxisReversePlotOrderChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisReversePlotOrderChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMajorTypeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisTickMarksMajorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisTickMarksMinorTypeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisTickMarksMinorTypeChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMajorUnitChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisUnitsMajorUnitChangedLabel)],[i.EventMethods.Visual.ChartAxisUnitsMinorUnitChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartAxisUnitsMinorUnitChangedLabel)],[i.EventMethods.Visual.ChartTitleFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFillColoredLabel,rt)],[i.EventMethods.Visual.ChartTitleFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontBoldedLabel)],[i.EventMethods.Visual.ChartTitleFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontColoredLabel,rt)],[i.EventMethods.Visual.ChartTitleFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontItalicizedLabel)],[i.EventMethods.Visual.ChartTitleFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontNamedLabel)],[i.EventMethods.Visual.ChartTitleFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontSizedLabel)],[i.EventMethods.Visual.ChartTitleFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleFontUnderlinedLabel)],[i.EventMethods.Visual.ChartTitleLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleLineColoredLabel,rt)],[i.EventMethods.Visual.ChartTitleOverlayChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleOverlayChangedLabel)],[i.EventMethods.Visual.ChartTitleTextChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualChartTitleTextChangedLabel)],[i.EventMethods.Visual.LegendFillCleared,()=>ExcelCopilotCommandingHitlStrings.VisualLegendFillClearedLabel],[i.EventMethods.Visual.LegendFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFillColoredLabel,rt)],[i.EventMethods.Visual.LegendFontBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontBoldedLabel)],[i.EventMethods.Visual.LegendFontColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontColoredLabel,rt)],[i.EventMethods.Visual.LegendFontItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontItalicizedLabel)],[i.EventMethods.Visual.LegendFontNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontNamedLabel)],[i.EventMethods.Visual.LegendFontSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontSizedLabel)],[i.EventMethods.Visual.LegendFontUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendFontUnderlinedLabel)],[i.EventMethods.Visual.LegendLineCleared,()=>ExcelCopilotCommandingHitlStrings.VisualLegendLineClearedLabel],[i.EventMethods.Visual.LegendLineStyleChanged,()=>ExcelCopilotCommandingHitlStrings.VisualLegendLineStyleChangedLabel],[i.EventMethods.Visual.LegendLineWeightChanged,()=>ExcelCopilotCommandingHitlStrings.VisualLegendLineWeightChangedLabel],[i.EventMethods.Visual.LegendLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendLineColoredLabel,rt)],[i.EventMethods.Visual.LegendOverlayChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.LegendPositionChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualLegendOverlayChangedLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinCount,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsBinCountLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinWidth,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsBinWidthLabel)],[i.EventMethods.Visual.SeriesBinningOptionsBinningType,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsBinningTypeLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowEnabled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsOverflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsOverflowValue,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsOverflowValueLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowEnabled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsUnderflowEnabledLabel)],[i.EventMethods.Visual.SeriesBinningOptionsUnderflowValue,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBinningOptionsUnderflowValueLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerQuartileCalculation,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerQuartileCalculationLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowInnerPoints,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowInnerPointsLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanLine,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowMeanLineLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowMeanMarker,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowMeanMarkerLabel)],[i.EventMethods.Visual.SeriesBoxWhiskerShowOutliers,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBoxWhiskerShowOutliersLabel)],[i.EventMethods.Visual.SeriesBubbleScaleSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesBubbleScaleSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCategoryNameToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsCategoryNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsCustomSeparatorChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsCustomSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsLegendKeyToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsLegendKeyToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeparatorChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsSeparatorChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsSeriesNameToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsSeriesNameToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsContainsValueToggled,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsContainsValueToggledLabel)],[i.EventMethods.Visual.SeriesDataLabelsFillFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFillFormatColoredLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatBolded,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatBoldedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatColoredLabel,rt)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatItalicized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatItaliizedcLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatNamedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatSizedLabel)],[i.EventMethods.Visual.SeriesDataLabelsFontFormatUnderlined,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsFontFormatUnderlinedLabel)],[i.EventMethods.Visual.SeriesDataLabelsLineFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsLineFormatColoredLabel,rt)],[i.EventMethods.Visual.SeriesDataLabelsNumberFormatCodeChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsNumberFormatCodeChangedLabel)],[i.EventMethods.Visual.SeriesDataLabelsPositioned,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsPositionedLabel)],[i.EventMethods.Visual.SeriesDoughnutHoleSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesDoughnutHoleSizedLabel)],[i.EventMethods.Visual.SeriesFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesFillColoredLabel,rt)],[i.EventMethods.Visual.SeriesGapWidthChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesGapWidthChangedLabel)],[i.EventMethods.Visual.SeriesLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesLineColoredLabel,rt)],[i.EventMethods.Visual.SeriesMarkersFillColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersFillColoredLabel,rt)],[i.EventMethods.Visual.SeriesMarkersLineColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersLineColoredLabel,rt)],[i.EventMethods.Visual.SeriesMarkersMarkerSized,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersMarkerSizedLabel)],[i.EventMethods.Visual.SeriesMarkersMarkerStyleChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesMakersMarkerStyleChangedLabel)],[i.EventMethods.Visual.SeriesNamed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesNamedLabel)],[i.EventMethods.Visual.SeriesTreemapParentLabelStrategy,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTreemapParentLabelStrategyLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesVaryColorsBySliceChanged,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesVaryColorsBySliceChangedLabel)],[i.EventMethods.Visual.SeriesWaterfallShowConnectorLines,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesWaterfallShowConnectorLinesLabel)],[i.EventMethods.Visual.SeriesTrendlineTypeSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineTypeSetLabel)],[i.EventMethods.Visual.SeriesTrendlineNameSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineNameChangedLabel)],[i.EventMethods.Visual.SeriesTrendlineEquationDisplayed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineEquationDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineRSquaredDisplayed,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineRSquaredDisplayedLabel)],[i.EventMethods.Visual.SeriesTrendlineInterceptSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineInterceptSetLabel)],[i.EventMethods.Visual.SeriesTrendlineIsCustomInterceptSet,e=>function(e){return e.parameters.newValue?A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineManualSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index}):A.substitute(ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineAutomaticSetLabel,{chartName:e.parameters.chartName,seriesIndex:e.parameters.index})}(e)],[i.EventMethods.Visual.SeriesTrendlineLineFormatColored,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineLineFormatColoredLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastForwardSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineForecastForwardSetLabel)],[i.EventMethods.Visual.SeriesTrendlineForecastBackwardSet,e=>it(e,ExcelCopilotCommandingHitlStrings.VisualSeriesTrendlineForecastBackwardSetLabel)],[i.EventMethods.Visual.ChartTitleAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartTitleAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartTitleRemovedLabel)],[i.EventMethods.Visual.LegendAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualLegendAddedLabel:ExcelCopilotCommandingHitlStrings.VisualLegendRemovedLabel)],[i.EventMethods.Visual.ChartAxisAxisTitleAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartAxisAxisTitleRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMajorGridlinesAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMajorGridlinesAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMajorGridlinesRemovedLabel)],[i.EventMethods.Visual.ChartAxisGridlinesMinorGridlinesAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMinorGridlinesAddedLabel:ExcelCopilotCommandingHitlStrings.VisualChartAxisGridlinesMinorGridlinesRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarXAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarXAddedLabel:ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarXRemovedLabel)],[i.EventMethods.Visual.SeriesErrorBarYAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarYAddedLabel:ExcelCopilotCommandingHitlStrings.VisualSeriesErrorBarYRemovedLabel)],[i.EventMethods.Visual.SeriesTrendlineAddedRemoved,st],[i.EventMethods.Visual.SeriesTrendlineTitleAddedRemoved,ct],[i.EventMethods.Visual.SeriesDataLabelsAddedRemoved,e=>lt(e,e.parameters.added?ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsAddedLabel:ExcelCopilotCommandingHitlStrings.VisualSeriesDataLabelsRemovedLabel)],[i.EventMethods.Visual.ChartTitleFillCleared,()=>ExcelCopilotCommandingHitlStrings.ChartTitleFillClearedLabel],[i.EventMethods.Visual.ChartTitleLineCleared,()=>ExcelCopilotCommandingHitlStrings.ChartTitleLineClearedLabel],[i.EventMethods.Visual.ChartTitleLineStyleChanged,()=>ExcelCopilotCommandingHitlStrings.ChartTitleLineStyleChangedLabel],[i.EventMethods.Visual.ChartTitleWeightChanged,()=>ExcelCopilotCommandingHitlStrings.ChartTitleWeightChangedLabel],[i.EventMethods.Table.Created,J],[i.EventMethods.Table.ColumnInserted,Y],[i.EventMethods.Table.ColumnsDeleted,X],[i.EventMethods.Table.ColumnRearranged,()=>ExcelCopilotCommandingHitlStrings.TableColumnsRearrangeLabel],[i.EventMethods.Table.RowInserted,Z],[i.EventMethods.Table.RowsDeleted,K],[i.EventMethods.Table.FilterCleared,ae],[i.EventMethods.Table.FilterReapplied,ne],[i.EventMethods.Table.ValuesFilterApplied,oe],[i.EventMethods.Table.CustomFilterApplied,re],[i.EventMethods.Table.CustomSorted,ie],[i.EventMethods.Table.SortCleared,le],[i.EventMethods.Table.Top10FilterApplied,se],[i.EventMethods.Table.DynamicFilterApplied,ce],[i.EventMethods.Table.ColumnSorted,ee],[i.EventMethods.Table.RowRearranged,()=>ExcelCopilotCommandingHitlStrings.TableRowsRearrangeLabel],[i.EventMethods.Table.AutoFilterCleared,te],[i.EventMethods.Table.AutoFilterToggled,tt],[i.EventMethods.Table.TotalRowToggled,gt],[i.EventMethods.Table.HeaderRowToggled,pt],[i.EventMethods.Table.Resized,bt],[i.EventMethods.Table.CreatedWithFormat,ft],[i.EventMethods.Table.StyleApplied,Mt],[i.EventMethods.Table.BandedColumnsVisibilityChanged,Dt],[i.EventMethods.Table.BandedRowsVisibilityChanged,Ot],[i.EventMethods.Table.FirstColumnHighlighted,Bt],[i.EventMethods.Table.LastColumnHighlighted,$t],[i.EventMethods.Table.FilterButtonVisibilityChanged,Ht],[i.EventMethods.Table.Renamed,ga],[i.EventMethods.Table.Converted,pa],[i.EventMethods.Table.AltTextEdited,ba],[i.EventMethods.Table.AltTextTitleEdited,fa],[i.EventMethods.Table.AltTextDescriptionEdited,Ca],[i.EventMethods.PivotChart.Created,()=>ExcelCopilotCommandingHitlStrings.PivotChartCreateLabel],[i.EventMethods.PivotChart.OnNewSheetCreated,()=>ExcelCopilotCommandingHitlStrings.PivotChartCreateLabel],[i.EventMethods.Font.Bolded,de],[i.EventMethods.Font.MultiRangeBolded,ue],[i.EventMethods.Font.Italicized,ge],[i.EventMethods.Font.MultiRangeItalicized,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatItalicizeLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatUnItalicizeLabel}(e)],[i.EventMethods.Font.Colored,pe],[i.EventMethods.Font.MultiRangeColored,be],[i.EventMethods.Font.Named,fe],[i.EventMethods.Font.MultiRangeNamed,Ce],[i.EventMethods.Font.Underlined,ye],[i.EventMethods.Font.MultiRangeUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatUnderlineLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveUnderlineLabel}(e)],[i.EventMethods.Font.DoubleUnderlined,ve],[i.EventMethods.Font.MultiRangeDoubleUnderlined,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatDoubleUnderlineLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveDoubleUnderlineLabel}(e)],[i.EventMethods.Font.Superscript,Te],[i.EventMethods.Font.Subscript,Se],[i.EventMethods.Font.MultiRangeSuperscript,me],[i.EventMethods.Font.MultiRangeSubscript,he],[i.EventMethods.Font.Superscript,Te],[i.EventMethods.Font.MultiRangeSuperscript,me],[i.EventMethods.Font.StrikeThrough,xe],[i.EventMethods.Font.MultiRangeStrikeThrough,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeFormatStrikethroughLabel:ExcelCopilotCommandingHitlStrings.MultiRangeFormatRemoveStrikethroughLabel}(e)],[i.EventMethods.Font.UnderlineStyle,Ie],[i.EventMethods.Font.Sized,we],[i.EventMethods.Font.MultiRangeSized,Ee],[i.EventMethods.Fill.Colored,Re],[i.EventMethods.Fill.MultiRangeColored,Le],[i.EventMethods.Fill.ColorCleared,Ae],[i.EventMethods.Fill.MultiRangeColorCleared,()=>ExcelCopilotCommandingHitlStrings.MultiRangeClearBackgroundColorLabel],[i.EventMethods.Fill.Patterned,()=>ExcelCopilotCommandingHitlStrings.RangeFillPatternAppliedLabel],[i.EventMethods.CellDimensions.ColumnWidthSet,ke],[i.EventMethods.CellDimensions.MultiRangeColumnWidthSet,Fe],[i.EventMethods.CellDimensions.RowHeightSet,_e],[i.EventMethods.CellDimensions.MultiRangeRowHeightSet,Pe],[i.EventMethods.CellDimensions.RowsHidden,Na],[i.EventMethods.CellDimensions.MultiRangeRowsHidden,Oa],[i.EventMethods.CellDimensions.ColumnsHidden,Ma],[i.EventMethods.CellDimensions.MultiRangeColumnsHidden,Da],[i.EventMethods.Border.BorderChanged,Ne],[i.EventMethods.Border.MultiRangeBorderChanged,()=>ExcelCopilotCommandingHitlStrings.MultiRangeApplyBorderLabel],[i.EventMethods.NamedSheetView.Created,()=>ExcelCopilotCommandingHitlStrings.NamedSheetViewCreateLabel],[i.EventMethods.NamedSheetView.Deleted,Me],[i.EventMethods.NamedSheetView.Duplicated,Oe],[i.EventMethods.NamedSheetView.Exited,De],[i.EventMethods.NamedSheetView.Kept,Be],[i.EventMethods.NamedSheetView.Renamed,$e],[i.EventMethods.NamedSheetView.Switched,He],[i.EventMethods.Paste.Range,Ue],[i.EventMethods.Paste.MultiRange,qe],[i.EventMethods.Paste.String,Ve],[i.EventMethods.Paste.ArtSameWorkbook,_a],[i.EventMethods.Comment.Inserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertLabel],[i.EventMethods.Comment.MultiRangeInserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertLabel],[i.EventMethods.Comment.Edited,()=>ExcelCopilotCommandingHitlStrings.CommentEditLabel],[i.EventMethods.Comment.MultiRangeEdited,()=>ExcelCopilotCommandingHitlStrings.CommentEditLabel],[i.EventMethods.Comment.Deleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteLabel],[i.EventMethods.Comment.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteLabel],[i.EventMethods.Reply.Inserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertReplyLabel],[i.EventMethods.Reply.MultiRangeInserted,()=>ExcelCopilotCommandingHitlStrings.CommentInsertReplyLabel],[i.EventMethods.Reply.Edited,()=>ExcelCopilotCommandingHitlStrings.CommentEditReplyLabel],[i.EventMethods.Reply.MultiRangeEdited,()=>ExcelCopilotCommandingHitlStrings.CommentEditReplyLabel],[i.EventMethods.Reply.Deleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteReplyLabel],[i.EventMethods.Reply.MultiRangeDeleted,()=>ExcelCopilotCommandingHitlStrings.CommentDeleteReplyLabel],[i.EventMethods.Range.ReplacedAll,Qe],[i.EventMethods.Workbook.ReplacedAll,Qe],[i.EventMethods.Worksheet.ReplacedAll,Qe],[i.EventMethods.Range.MultiRangeReplacedAll,Je],[i.EventMethods.Worksheet.MultiRangeReplacedAll,Je],[i.EventMethods.Workbook.MultiRangeReplacedAll,Je],[i.EventMethods.Range.FoundNext,je],[i.EventMethods.Workbook.FoundNext,je],[i.EventMethods.Workbook.CalculationModeSet,()=>ExcelCopilotCommandingHitlStrings.WorkbookSetCalculationModeLabel],[i.EventMethods.Workbook.Recalculated,()=>ExcelCopilotCommandingHitlStrings.WorkbookRecalculateLabel],[i.EventMethods.Alignment.HorizontalAlignmentSet,Ye],[i.EventMethods.Alignment.MultiRangeHorizontalAlignmentSet,()=>ExcelCopilotCommandingHitlStrings.MultiRangeSetHorizontalAlignmentLabel],[i.EventMethods.Alignment.VerticalAlignmentSet,Xe],[i.EventMethods.Alignment.MultiRangeVerticalAlignmentSet,()=>ExcelCopilotCommandingHitlStrings.MultiRangeSetVerticalAlignmentLabel],[i.EventMethods.CellText.WrapChanged,Ze],[i.EventMethods.CellText.MultiRangeWrapChanged,e=>function(e){return e.parameters.events[0].parameters.value?ExcelCopilotCommandingHitlStrings.MultiRangeWrapTextLabel:ExcelCopilotCommandingHitlStrings.MultiRangeUnwrapTextLabel}(e)],[i.EventMethods.Indent.Set,Ke],[i.EventMethods.Indent.Incremented,Ke],[i.EventMethods.Indent.MultiRangeSet,()=>ExcelCopilotCommandingHitlStrings.MultiRangeChangeIndentLabel],[i.EventMethods.ConditionalFormatting.CreatedGroup,Ba],[i.EventMethods.ConditionalFormatting.EditedGroup,Za],[i.EventMethods.ConditionalFormatting.Deleted,tn],[i.EventMethods.ConditionalFormatting.RuleDeleted,Ka],[i.EventMethods.Workbook.RefreshedAll,()=>ExcelCopilotCommandingHitlStrings.WorkbookRefreshAllLabel],[i.EventMethods.Workbook.ExternalLinksRefreshed,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksRefreshedLabel],[i.EventMethods.Workbook.ExternalLinksRefreshedAll,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksRefreshedAllLabel],[i.EventMethods.Workbook.ExternalLinksBrokeLink,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksBrokeLinkLabel],[i.EventMethods.Workbook.ExternalLinksBrokeAllLinks,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksBrokeAllLinksLabel],[i.EventMethods.Workbook.ExternalLinksSetAutoRefresh,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksSetAutoRefreshLabel],[i.EventMethods.Workbook.ExternalLinksChangedSource,()=>ExcelCopilotCommandingHitlStrings.ExternalLinksChangedSourceLabel],[i.EventMethods.PageLayout.AddedToPrintArea,()=>ExcelCopilotCommandingHitlStrings.PageLayoutAddedToPrintAreaLabel],[i.EventMethods.PageLayout.OrientationChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutOrientationChangedLabel],[i.EventMethods.PageLayout.PageBreakInserted,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPageBreakInsertedLabel],[i.EventMethods.PageLayout.PageBreakRemoved,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPageBreakRemovedLabel],[i.EventMethods.PageLayout.PageBreaksAllReset,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPageBreaksAllResetLabel],[i.EventMethods.PageLayout.PaperSizeChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPaperSizeChangedLabel],[i.EventMethods.PageLayout.PrintAreaCleared,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPrintAreaClearedLabel],[i.EventMethods.PageLayout.PrintAreaSet,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPrintAreaSetLabel],[i.EventMethods.PageLayout.PrintSettingsChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutPrintSettingsChangedLabel],[i.EventMethods.PageLayout.ScalingChanged,()=>ExcelCopilotCommandingHitlStrings.PageLayoutScalingChangedLabel],[i.EventMethods.AllowEditRange.Added,sn],[i.EventMethods.AllowEditRange.Deleted,cn],[i.EventMethods.AllowEditRange.Edited,dn],[i.EventMethods.SheetProtection.OptionsUpdated,un],[i.EventMethods.SheetProtection.PasswordUpdated,mn],[i.EventMethods.SheetProtection.Paused,hn],[i.EventMethods.SheetProtection.Resumed,pn],[i.EventMethods.SheetProtection.Protected,gn],[i.EventMethods.SheetProtection.Unprotected,bn],[i.EventMethods.CellText.OrientationChanged,L],[i.EventMethods.CellText.MultiRangeOrientationChanged,()=>ExcelCopilotCommandingHitlStrings.CellTextOrientationChangedGeneric],[i.EventMethods.Chart.Renamed,()=>ExcelCopilotCommandingHitlStrings.ChartRenamed],[i.EventMethods.Comment.Resolved,()=>ExcelCopilotCommandingHitlStrings.CommentResolved],[i.EventMethods.Table.Deleted,()=>ExcelCopilotCommandingHitlStrings.TableDeleted],[i.EventMethods.Worksheet.Calculated,()=>ExcelCopilotCommandingHitlStrings.WorksheetCalculated],[i.EventMethods.Intent.ChangeRangeBorder,()=>ExcelCopilotCommandingHitlStrings.IntentChangeRangeBorder],[i.EventMethods.Intent.CreateConditionalFormatColorScale,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatColorScale],[i.EventMethods.Intent.CreateConditionalFormatDataBar,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatDataBar],[i.EventMethods.Intent.RangeCopyFrom,()=>ExcelCopilotCommandingHitlStrings.IntentRangeCopyFrom],[i.EventMethods.Intent.CreateConditionalFormatCellValue,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCellValue],[i.EventMethods.Intent.CreateConditionalFormatPreset,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatPreset],[i.EventMethods.Intent.CreateConditionalFormatContainsText,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatContainsText],[i.EventMethods.Intent.CreateConditionalFormatTopBottom,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatTopBottom],[i.EventMethods.Intent.CreateConditionalFormatCustom,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatCustom],[i.EventMethods.Intent.CreateConditionalFormatIconSet,()=>ExcelCopilotCommandingHitlStrings.IntentCreateConditionalFormatIconSet],[i.EventMethods.System.Undo,()=>ExcelCopilotCommandingHitlStrings.UndoLabel],[i.EventMethods.System.Redo,()=>ExcelCopilotCommandingHitlStrings.RedoLabel],[i.EventMethods.System.Unknown,()=>ExcelCopilotCommandingHitlStrings.UnknownEventLabel],[i.EventMethods.System.Unsupported,()=>ExcelCopilotCommandingHitlStrings.UnsupportedEventLabel],[i.EventMethods.System.InProgress,()=>ExcelCopilotCommandingHitlStrings.InProgressEventLabel],[i.EventMethods.System.Undefined,()=>ExcelCopilotCommandingHitlStrings.UnknownEventLabel],[i.EventMethods.Error.Alias,()=>ExcelCopilotCommandingHitlStrings.ErrorAliasInfo],[i.EventMethods.Error.Unknown,()=>ExcelCopilotCommandingHitlStrings.ErrorUnknown],[i.EventMethods.Error.UpstreamExceptionOccured,()=>ExcelCopilotCommandingHitlStrings.ErrorUnknown],[i.EventMethods.Range.DataValidationRuleListChanged,fn],[i.EventMethods.Range.DataValidationRuleCustomChanged,Cn],[i.EventMethods.Range.DataValidationRuleDateChanged,yn],[i.EventMethods.Range.DataValidationRuleDecimalChanged,vn],[i.EventMethods.Range.DataValidationRuleWholeNumberChanged,Sn],[i.EventMethods.Range.DataValidationRuleTextLengthChanged,xn],[i.EventMethods.Range.DataValidationRuleTimeChanged,Tn],[i.EventMethods.Range.DataValidationRuleCleared,wn]]),vl=new Map([[i.EventMethods.ConditionalFormatting.CellValueCreated,qa],[i.EventMethods.ConditionalFormatting.CustomCreated,Va],[i.EventMethods.ConditionalFormatting.ColorScaleCustomCreated,Wa],[i.EventMethods.ConditionalFormatting.DataBarCustomCreated,za],[i.EventMethods.ConditionalFormatting.DatesCreated,Ja],[i.EventMethods.ConditionalFormatting.IconSetCreated,ja],[i.EventMethods.ConditionalFormatting.PresetCreated,Qa],[i.EventMethods.ConditionalFormatting.TextComparisonCreated,Ga],[i.EventMethods.ConditionalFormatting.TopBottomCreated,Xa],[i.EventMethods.ConditionalFormatting.UniqueCreated,Ya],[i.EventMethods.ConditionalFormatting.PriorityEdited,en]]);function xl(e,t){const a=fl(e),n=(0,m.k64)()&&t?yl.get(a):Cl.get(a);if(void 0===n)return(0,m.yw9)("OfficeVSO_8958983_HiTLMissingIntentError")?s.O.UnhandledIntent:"Missing intent string";return n(e)}function Tl(e,t){const a=vl.get(t);if(void 0===a)return s.O.UnhandledIntent;return a(e)}function Sl(e,t){return e.map((e=>xl(e,t)))}function wl(e){return e!==i.EventMethods.ConditionalFormatting.Deleted&&e?.includes("ConditionalFormatting")}function El(e){const t=e;t.parameters.rangeType=i.RangeType.TableRange,t.parameters.range.subRange=i.TableRangeOperationSubRange.WholeTable;const a=u.CP.getActiveTable();return t.parameters.range.tableName=a.name,t}function Il(e){switch(e){case n.wv.Worksheet.Filter.Icon:case n.wv.Worksheet.Filter.BottomItems:case n.wv.Worksheet.Filter.BottomPercent:case n.wv.Worksheet.Filter.TopItems:case n.wv.Worksheet.Filter.TopPercent:case n.wv.Worksheet.Filter.Values:case n.wv.Worksheet.Filter.Custom:case n.wv.Worksheet.Filter.FontColor:case n.wv.Worksheet.Filter.CellColor:case n.wv.Worksheet.Filter.Dynamic:return!0;default:return!1}}function Rl(e){switch(e.method){case n.wv.Worksheet.ClearFilter:case n.wv.Worksheet.ClearColumnFilter:return!0;default:return!1}}function Al(e){return e.method===n.wv.Range.Sort}function Ll(e){const t=[];for(const a of e){let e=!1;const n=a.method;let o=s.O.UnhandledIntent;if(Il(n)){const{filteredDataDisplayName:e,filterCriteria:t}=a.args;o=(0,h.lx)(e,t)}else if(Rl(a)){const{changedDataDisplayName:e}=a.args;o=(0,E.A)(ExcelCopilotCommandingHitlStrings.WorksheetRangeClearFiltersLabel,{range:e})}else if((0,m.yw9)("OfficeVSO_9136744_HiTLTLRSortOfficeJS")&&Al(a)){const n=a.args;n.fields.forEach((a=>{a.key>=0&&(o=(0,E.A)(ExcelCopilotCommandingHitlStrings.TableColumnByIndexCustomSortLabel,{columnIndex:a.key,tableName:n.rangeAddress}),t.push(o),e=!0)}))}if(o===s.O.UnhandledIntent)throw new l.sF("Intent string missing or no conversion method exists.",l.UP.MissingIntent);(0,m.yw9)("OfficeVSO_9136744_HiTLTLRSortOfficeJS")&&e||t.push(o)}return t}function kl(e){const t=[],a=[];for(let n of e){const e=fl(n),i=wl(e);n.parameters?.columnName===bl.G.O&&(n=El(n));const u=i?Tl(n,e):xl(n,!0),h=(0,m.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")&&i?d.BJ.ConditionalFormatting:d.BJ.Commanding;if("string"==typeof u)switch(u){case s.O.NoIntentNeeded:continue;case s.O.MissingIntent:case s.O.UnhandledIntent:if((0,m.yw9)("OfficeVSO_9631333_FixHiTLErrorToElse")||c.M.getInstance().logStandardizedAshaErrorEvent(r.W.Missing_Copilot_Functionality,o.c.Missing_HITL_Intent_String,h),(0,m.yw9)("OfficeVSO_8958983_HiTLMissingIntentError"))throw new l.sF("Intent string missing or no conversion method exists.",l.UP.MissingIntent);return{cfIntents:[],nonCfIntents:[]}}i?t.push(u):a.push(u)}return{cfIntents:t,nonCfIntents:a}}},812328:(e,t,a)=>{"use strict";a.d(t,{$8:()=>A,$J:()=>v,B8:()=>w,FN:()=>g,GO:()=>p,IJ:()=>R,Is:()=>E,Mb:()=>d,RR:()=>s,US:()=>L,X7:()=>c,Yl:()=>I,ZA:()=>u,b3:()=>y,c$:()=>o,fP:()=>n,mY:()=>T,nr:()=>S,qq:()=>h,sh:()=>b,t0:()=>f,tQ:()=>x,tg:()=>m,y6:()=>C});var n,o,r=a(449650),i=a(863890),l=a(171927);!function(e){e.UniqueDuplicate="UniqueDuplicate",e.TimePeriod="TimePeriod",e.OtherPresetsNumber="OtherPresetsNumber",e.OtherPresetsGeneral="OtherPresetsGeneral"}(n||(n={})),function(e){e.Number="Number",e.Date="Date",e.Text="Text"}(o||(o={}));const s={between:i.default.Between,equalTo:i.default.EQ,greaterThan:i.default.GT,greaterThanOrEqual:i.default.GE,lessThan:i.default.LT,lessThanOrEqual:i.default.LE,notBetween:i.default.NotBetween,notEqualTo:i.default.NE},c={[i.default.Between]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueBetweenPrefixLabel,[i.default.EQ]:e=>e?ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueEqualToNumberPrefixLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueEqualToPrefixLabel,[i.default.GT]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueGreaterThanPrefixLabel,[i.default.GE]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueGreaterThanOrEqualToPrefixLabel,[i.default.LT]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueLessThanPrefixLabel,[i.default.LE]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueLessThanOrEqualToPrefixLabel,[i.default.NotBetween]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueNotBetweenPrefixLabel,[i.default.NE]:e=>e?ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueNotEqualToNumberPrefixLabel:ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellValueNotEqualToPrefixLabel},d={[i.default.Between]:"between",[i.default.EQ]:"equal to",[i.default.GT]:"greater than",[i.default.GE]:"greater than or equal to",[i.default.LT]:"less than",[i.default.LE]:"less than or equal to",[i.default.NotBetween]:"not between",[i.default.NE]:"not equal to"},u={bottomItems:i.default.Bot10,bottomPercent:i.default.Bot10P,topItems:i.default.Top10,topPercent:i.default.Top10P},m={[i.default.Bot10]:"bottom ${number} items",[i.default.Bot10P]:"bottom ${number} percent",[i.default.Top10]:"top ${number} items",[i.default.Top10P]:"top ${number} percent"},h={[i.default.Bot10]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomItemsPrefixLabel,[i.default.Bot10P]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomBottomPercentPrefixLabel,[i.default.Top10]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopItemsPrefixLabel,[i.default.Top10P]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTopBottomTopPercentPrefixLabel},g={lastMonth:l.default.LastMonth,lastSevenDays:l.default.Last7Days,lastWeek:l.default.LastWeek,nextMonth:l.default.NextMonth,nextWeek:l.default.NextWeek,thisMonth:l.default.ThisMonth,thisWeek:l.default.ThisWeek,today:l.default.Today,tomorrow:l.default.Tomorrow},p={[l.default.LastMonth]:"in the last month",[l.default.Last7Days]:"in the last 7 days",[l.default.LastWeek]:"in the last week",[l.default.NextMonth]:"in the next month",[l.default.NextWeek]:"in the next week",[l.default.ThisMonth]:"in this month",[l.default.ThisWeek]:"in this week",[l.default.Today]:"for today",[l.default.Tomorrow]:"for tomorrow"},b={[l.default.LastMonth]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesLastMonthPrefixLabel,[l.default.Last7Days]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesLast7DaysPrefixLabel,[l.default.LastWeek]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesLastWeekPrefixLabel,[l.default.NextMonth]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesNextMonthPrefixLabel,[l.default.NextWeek]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesNextWeekPrefixLabel,[l.default.ThisMonth]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesThisMonthPrefixLabel,[l.default.ThisWeek]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesThisWeekPrefixLabel,[l.default.Today]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesTodayPrefixLabel,[l.default.Tomorrow]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetDatesTomorrowPrefixLabel},f={aboveAverage:i.default.AA,belowAverage:i.default.BA,equalOrAboveAverage:i.default.EqualAA,equalOrBelowAverage:i.default.EqualBA,blanks:i.default.Blanks,nonBlanks:i.default.NoBlanks,errors:i.default.Errors,nonErrors:i.default.NoErrors,invalid:i.default.Nil},C={[i.default.AA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetAboveAveragePrefixLabel,[i.default.BA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetBelowAveragePrefixLabel,[i.default.EqualAA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetEqualToOrAboveAveragePrefixLabel,[i.default.EqualBA]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetEqualToOrBelowAveragePrefixLabel,[i.default.Blanks]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetBlankPrefixLabel,[i.default.NoBlanks]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetNotBlankPrefixLabel,[i.default.Errors]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetErrorsPrefixLabel,[i.default.NoErrors]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetNotErrorsPrefixLabel,[i.default.Nil]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingPresetInvalidPrefixLabel},y={[i.default.AA]:"above average",[i.default.BA]:"below average",[i.default.EqualAA]:"equal to or above average",[i.default.EqualBA]:"equal to or below average",[i.default.Blanks]:"blank",[i.default.NoBlanks]:"not blank",[i.default.Errors]:"errors",[i.default.NoErrors]:"not errors",[i.default.Nil]:"invalid"},v={beginsWith:i.default.BeginsWith,contains:i.default.Contains,endsWith:i.default.EndsWith,notContains:i.default.NotContains},x={[i.default.BeginsWith]:"begins with",[i.default.Contains]:"contains",[i.default.EndsWith]:"ends with",[i.default.NotContains]:"does not contain"},T={[i.default.BeginsWith]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonBeginsWithPrefixLabel,[i.default.Contains]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonContainsPrefixLabel,[i.default.EndsWith]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonEndsWithPrefixLabel,[i.default.NotContains]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingTextComparisonDoesNotContainPrefixLabel},S={fiveArrows:i.default.IconSet5Arrows,fiveArrowsGray:i.default.IconSet5ArrowsGray,fiveBoxes:i.default.IconSet5Boxes,fiveQuarters:i.default.IconSet5Quarters,fiveRating:i.default.IconSet5Rating,fourArrows:i.default.IconSet4Arrows,fourArrowsGray:i.default.IconSet4ArrowsGray,fourRating:i.default.IconSet4Rating,fourRedToBlack:i.default.IconSet4RedToBlack,fourTrafficLights:i.default.IconSet4TrafficLights,threeArrows:i.default.IconSet3Arrows,threeArrowsGray:i.default.IconSet3ArrowsGray,threeFlags:i.default.IconSet3Flags,threeSigns:i.default.IconSet3Signs,threeStars:i.default.IconSet3Stars,threeSymbols:i.default.IconSet3Symbols,threeSymbols2:i.default.IconSet3Symbols2,threeTrafficLights1:i.default.IconSet3TrafficLights1,threeTrafficLights2:i.default.IconSet3TrafficLights2,threeTriangles:i.default.IconSet3Triangles},w={[i.default.IconSet5Arrows]:"5 Arrows",[i.default.IconSet5ArrowsGray]:"5 Arrows Gray",[i.default.IconSet5Boxes]:"5 Boxes",[i.default.IconSet5Quarters]:"5 Quarters",[i.default.IconSet5Rating]:"5 Rating",[i.default.IconSet4Arrows]:"4 Arrows",[i.default.IconSet4ArrowsGray]:"4 Arrows Gray",[i.default.IconSet4Rating]:"4 Rating",[i.default.IconSet4RedToBlack]:"4 Red to Black",[i.default.IconSet4TrafficLights]:"4 Traffic Lights",[i.default.IconSet3Arrows]:"3 Arrows",[i.default.IconSet3ArrowsGray]:"3 Arrows Gray",[i.default.IconSet3Flags]:"3 Flags",[i.default.IconSet3Signs]:"3 Signs",[i.default.IconSet3Stars]:"3 Stars",[i.default.IconSet3Symbols]:"3 Symbols",[i.default.IconSet3Symbols2]:"3 Symbols",[i.default.IconSet3TrafficLights1]:"3 Traffic Lights",[i.default.IconSet3TrafficLights2]:"3 Traffic Lights",[i.default.IconSet3Triangles]:"3 Triangles"},E={[i.default.IconSet5Arrows]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Arrows,[i.default.IconSet5ArrowsGray]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5ArrowsGray,[i.default.IconSet5Boxes]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Boxes,[i.default.IconSet5Quarters]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Quarters,[i.default.IconSet5Rating]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet5Rating,[i.default.IconSet4Arrows]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4Arrows,[i.default.IconSet4ArrowsGray]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4ArrowsGray,[i.default.IconSet4Rating]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4Rating,[i.default.IconSet4RedToBlack]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4RedToBlack,[i.default.IconSet4TrafficLights]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet4TrafficLights,[i.default.IconSet3Arrows]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Arrows,[i.default.IconSet3ArrowsGray]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3ArrowsGray,[i.default.IconSet3Flags]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Flags,[i.default.IconSet3Signs]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Signs,[i.default.IconSet3Stars]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Stars,[i.default.IconSet3Symbols]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Symbols,[i.default.IconSet3Symbols2]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Symbols,[i.default.IconSet3TrafficLights1]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3TrafficLights,[i.default.IconSet3TrafficLights2]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3TrafficLights,[i.default.IconSet3Triangles]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingIconSet3Triangles},I={fiveArrows:Excel.IconSet.fiveArrows,fiveArrowsGray:Excel.IconSet.fiveArrowsGray,fiveBoxes:Excel.IconSet.fiveBoxes,fiveQuarters:Excel.IconSet.fiveQuarters,fiveRating:Excel.IconSet.fiveRating,fourArrows:Excel.IconSet.fourArrows,fourArrowsGray:Excel.IconSet.fourArrowsGray,fourRating:Excel.IconSet.fourRating,fourRedToBlack:Excel.IconSet.fourRedToBlack,fourTrafficLights:Excel.IconSet.fourTrafficLights,threeArrows:Excel.IconSet.threeArrows,threeArrowsGray:Excel.IconSet.threeArrowsGray,threeFlags:Excel.IconSet.threeFlags,threeSigns:Excel.IconSet.threeSigns,threeStars:Excel.IconSet.threeStars,threeSymbols:Excel.IconSet.threeSymbols,threeSymbols2:Excel.IconSet.threeSymbols2,threeTrafficLights1:Excel.IconSet.threeTrafficLights1,threeTrafficLights2:Excel.IconSet.threeTrafficLights2,threeTriangles:Excel.IconSet.threeTriangles},R={[Excel.IconSet.fiveArrows]:"5 Arrows",[Excel.IconSet.fiveArrowsGray]:"5 Arrows Gray",[Excel.IconSet.fiveBoxes]:"5 Boxes",[Excel.IconSet.fiveQuarters]:"5 Quarters",[Excel.IconSet.fiveRating]:"5 Rating",[Excel.IconSet.fourArrows]:"4 Arrows",[Excel.IconSet.fourArrowsGray]:"4 Arrows Gray",[Excel.IconSet.fourRating]:"4 Rating",[Excel.IconSet.fourRedToBlack]:"4 Red to Black",[Excel.IconSet.fourTrafficLights]:"4 Traffic Lights",[Excel.IconSet.threeArrows]:"3 Arrows",[Excel.IconSet.threeArrowsGray]:"3 Arrows Gray",[Excel.IconSet.threeFlags]:"3 Flags",[Excel.IconSet.threeSigns]:"3 Signs",[Excel.IconSet.threeStars]:"3 Stars",[Excel.IconSet.threeSymbols]:"3 Symbols",[Excel.IconSet.threeSymbols2]:"3 Symbols",[Excel.IconSet.threeTrafficLights1]:"3 Traffic Lights",[Excel.IconSet.threeTrafficLights2]:"3 Traffic Lights",[Excel.IconSet.threeTriangles]:"3 Triangles"},A={[r.BorderLineStyle.Thin]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatThinBorderLabel,[r.BorderLineStyle.Medium]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumBorderLabel,[r.BorderLineStyle.Dashed]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDashedBorderLabel,[r.BorderLineStyle.Dotted]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDottedBorderLabel,[r.BorderLineStyle.Thick]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatThickBorderLabel,[r.BorderLineStyle.Double]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDoubleBorderLabel,[r.BorderLineStyle.Hair]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatHairlineBorderLabel,[r.BorderLineStyle.MediumDashed]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumDashedBorderLabel,[r.BorderLineStyle.DashDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDashDotBorderLabel,[r.BorderLineStyle.MediumDashDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumDashDotBorderLabel,[r.BorderLineStyle.DashDotDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatDashDotDotBorderLabel,[r.BorderLineStyle.MediumDashDotDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatMediumDashDotDotBorderLabel,[r.BorderLineStyle.SlantDashDot]:()=>ExcelCopilotCommandingHitlStrings.ConditionalFormattingCellFormatSlantDashDotBorderLabel},L={[r.BorderLineStyle.None]:"none",[r.BorderLineStyle.Thin]:"thin",[r.BorderLineStyle.Medium]:"medium",[r.BorderLineStyle.Dashed]:"dashed",[r.BorderLineStyle.Dotted]:"dotted",[r.BorderLineStyle.Thick]:"thick",[r.BorderLineStyle.Double]:"double",[r.BorderLineStyle.Hair]:"hairline",[r.BorderLineStyle.MediumDashed]:"medium dashed",[r.BorderLineStyle.DashDot]:"dash dot",[r.BorderLineStyle.MediumDashDot]:"medium dash dot",[r.BorderLineStyle.DashDotDot]:"dash dot dot",[r.BorderLineStyle.MediumDashDotDot]:"medium dash dot dot",[r.BorderLineStyle.SlantDashDot]:"slant dash dot"}},817560:(e,t,a)=>{"use strict";a.d(t,{A:()=>C});var n=a(171755),o=a.n(n),r=a(982649),i=a.n(r),l=a(697652),s=a.n(l),c=new URL(a(69336),a.b),d=new URL(a(952978),a.b),u=new URL(a(824815),a.b),m=new URL(a(767176),a.b),h=i()(o()),g=s()(c),p=s()(d),b=s()(u),f=s()(m);h.push([e.id,`:root {\n  --bgColor: #fafafa;\n}\nhtml,\nbody {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  background-color: var(--bgColor);\n}\n\n#log {\n  max-height: 92%;\n  max-width: 100%;\n  overflow: auto;\n  overflow-wrap: break-word;\n}\n\n.ChatUi {\n  position: absolute;\n  top: 5px;\n  bottom: 5px;\n  left: 0;\n  right: 0;\n  background-color: var(--bgColor);\n}\n\n.chat-input-text {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-page-fre {\n  overflow-wrap: break-word;\n  overflow-y: auto;\n  scroll-behavior: smooth;\n  margin-bottom: 5px;\n}\n\n.chat-input-text:focus {\n  outline: none;\n}\n\n.chat-footer-hyper-link-text {\n  /* Hyperlink */\n  height: 16px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n  text-decoration-line: underline;\n  /* Excel Colors / XL Primary */\n  color: #107c41;\n  /* Inside auto layout */\n  margin-top: 3px;\n}\n\n.chat-footer-like-button {\n  background-image: url(${g});\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-like-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-dislike-button {\n  background-image: url(${p});\n  margin-left: 8px;\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-dislike-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-info-button {\n  background-image: url(${b});\n  background-color: white;\n  border: #ffffff;\n  margin-left: 8px;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-info-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-log {\n  padding-top: 5px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  background-color: white;\n  margin-bottom: 5px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-log-human {\n  align-self: flex-end;\n  align-items: flex-start;\n  border: 1px solid #bebbb8;\n  background-color: #edebe9;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 10px 0px 5px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt {\n  align-self: flex-start;\n  align-items: flex-start;\n  border: 1px solid #d2d0ce;\n  background-color: #ffffff;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 0px 0px 15px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt-designerlink {\n  text-decoration: none;\n  color: #b1470e;\n  margin-right: 4px;\n}\n\n.chat-log-suggestion ul {\n  padding-left: 15px;\n}\n\n.chat-log-suggestion {\n  align-self: flex-start;\n  text-align: start;\n  border: 1px solid rgb(210, 208, 206);\n  border-radius: 4px;\n  padding: 8px 10px;\n  max-width: 88%;\n  text-overflow: clip;\n  margin: 0px 0px 0px 15px;\n  white-space: pre-wrap !important;\n}\n\n.chat-log-suggestion-header {\n  font-weight: 600;\n  margin-bottom: 0.5vh;\n}\n\n.welcome-message {\n  margin-top: 100px;\n  padding-top: 20px;\n}\n\n.disclaimer {\n  font-size: 0.69rem;\n  line-height: 127%;\n  color: #707070;\n  margin: 4px 20px 0px 15px;\n}\n\n.chat-suggestionPane {\n  align-items: flex-end;\n  background: transparent;\n  margin-right: 10px;\n  margin-left: 10px;\n  justify-content: flex-start;\n  font-size: 12px;\n  padding: 4px 0px;\n  gap: 8px;\n  display: flex;\n  flex-wrap: wrap;\n  font-family: "Segoe UI";\n  font-style: normal;\n}\n\n.chat-suggestionPane-heading {\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  margin-bottom: 5px;\n  gap: 5px;\n}\n\n.chat-suggestionPane-headingImage {\n  width: 16px;\n  height: 16px;\n}\n\n.chat-suggestionPane-headingText {\n  font-weight: 700;\n  font-size: 10px;\n  line-height: 13px;\n  display: flex;\n  align-items: center;\n  text-align: right;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: #949494;\n}\n\n.chat-suggestionPane-icon {\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  vertical-align: middle;\n  border: 2px solid #107c41;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-radius: 6px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-suggestionPane-button {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  height: 32px;\n  background: #ffffff;\n  border: 2px solid #107c41;\n  border-radius: 6px;\n  line-height: 16px;\n  padding: 0px 10px;\n}\n\n.chat-suggestionPane-label {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  order: 0;\n  vertical-align: middle;\n  margin: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n.user-chat-query-container {\n  margin: 12px;\n}\n\n.chat-input {\n  border: 1px solid #d1d1d1;\n  border-radius: 8px;\n  background: #ffffff;\n  margin-left: 15px;\n  margin-right: 20px;\n  padding: 4px;\n  gap: 4px;\n  position: relative;\n  z-index: 1;\n}\n\n.chat-input-onfocus-border::after {\n  position: absolute;\n  z-index: -1;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 5px;\n  content: "";\n  border-radius: 0px 0px 8px 8px;\n  background-image: linear-gradient(90.5deg, #107c41 0%, #429537 100%);\n}\n\n.chat-fixed-input-text {\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n  color: #107c41;\n  white-space: pre-wrap;\n}\n\n.chat-fixed-input-text:focus {\n  outline: none;\n}\n\n.chat-input-ghost-text {\n  color: #bebebe;\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n}\n\n.chat-input-buttons {\n  align-items: flex-start;\n  background: #ffffff;\n  flex-direction: row;\n  gap: 2px;\n  margin-bottom: 10px;\n  justify-content: space-between;\n}\n\n.chat-input-buttons-suggestion {\n  align-self: flex-start;\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion > .ms-Button-flexContainer {\n  align-items: center;\n}\n\n.chat-input-buttons-suggestion:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-input-buttons-suggestion-clicked {\n  align-self: flex-start;\n  background-color: #edebe9;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion-clicked:hover {\n  background-color: #edebe9;\n}\n\n.chat-input-buttons-send {\n  align-self: flex-end;\n  background-image: url(${f});\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-right: 2px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-send:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-taskPane-learn-more-button {\n  align-items: center;\n  justify-content: center;\n  width: 77px;\n  height: 24px;\n  background: transparent;\n  border: 1px solid #616161;\n  border-radius: 4px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  color: #616161;\n  line-height: 16px;\n  box-sizing: border-box;\n}\n\n.chat-taskPane-learn-more-button:hover {\n  cursor: pointer;\n}\n\n/*\n  * This class is used to set the max height of the input field in the chat UI.\n  * It ensures that the input field does not exceed the height of its container,\n  * allowing for a better user experience when typing long messages.\n*/\n.fai-EditorInput {\n  max-height: 100%;\n}\n`,"",{version:3,sources:["webpack://./src/frontend/pages/ChatUiLanding/ChatUi.css"],names:[],mappings:"AAAA;EACE,kBAAkB;AACpB;AACA;;EAEE,YAAY;EACZ,WAAW;EACX,gBAAgB;EAChB,gCAAgC;AAClC;;AAEA;EACE,eAAe;EACf,eAAe;EACf,cAAc;EACd,yBAAyB;AAC3B;;AAEA;EACE,kBAAkB;EAClB,QAAQ;EACR,WAAW;EACX,OAAO;EACP,QAAQ;EACR,gCAAgC;AAClC;;AAEA;EACE,uBAAuB;EACvB,kBAAkB;EAClB,eAAe;EACf,gBAAgB;EAChB,iBAAiB;AACnB;;AAEA;EACE,yBAAyB;EACzB,gBAAgB;EAChB,uBAAuB;EACvB,kBAAkB;AACpB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,cAAc;EACd,YAAY;EACZ,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,iBAAiB;EACjB,+BAA+B;EAC/B,8BAA8B;EAC9B,cAAc;EACd,uBAAuB;EACvB,eAAe;AACjB;;AAEA;EACE,yDAAqD;EACrD,uBAAuB;EACvB,eAAe;EACf,4BAA4B;EAC5B,6BAA6B;EAC7B,0BAA0B;EAC1B,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yDAAwD;EACxD,gBAAgB;EAChB,uBAAuB;EACvB,eAAe;EACf,4BAA4B;EAC5B,6BAA6B;EAC7B,0BAA0B;EAC1B,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,yDAA4D;EAC5D,uBAAuB;EACvB,eAAe;EACf,gBAAgB;EAChB,4BAA4B;EAC5B,6BAA6B;EAC7B,0BAA0B;EAC1B,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,gBAAgB;EAChB,yBAAyB;EACzB,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,eAAe;EACf,gBAAgB;EAChB,iBAAiB;AACnB;;AAEA;EACE,oBAAoB;EACpB,uBAAuB;EACvB,yBAAyB;EACzB,yBAAyB;EACzB,kBAAkB;EAClB,cAAc;EACd,wBAAwB;EACxB,iBAAiB;EACjB,QAAQ;AACV;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,yBAAyB;EACzB,yBAAyB;EACzB,kBAAkB;EAClB,cAAc;EACd,wBAAwB;EACxB,iBAAiB;EACjB,QAAQ;AACV;;AAEA;EACE,qBAAqB;EACrB,cAAc;EACd,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;AACpB;;AAEA;EACE,sBAAsB;EACtB,iBAAiB;EACjB,oCAAoC;EACpC,kBAAkB;EAClB,iBAAiB;EACjB,cAAc;EACd,mBAAmB;EACnB,wBAAwB;EACxB,gCAAgC;AAClC;;AAEA;EACE,gBAAgB;EAChB,oBAAoB;AACtB;;AAEA;EACE,iBAAiB;EACjB,iBAAiB;AACnB;;AAEA;EACE,kBAAkB;EAClB,iBAAiB;EACjB,cAAc;EACd,yBAAyB;AAC3B;;AAEA;EACE,qBAAqB;EACrB,uBAAuB;EACvB,kBAAkB;EAClB,iBAAiB;EACjB,2BAA2B;EAC3B,eAAe;EACf,gBAAgB;EAChB,QAAQ;EACR,aAAa;EACb,eAAe;EACf,uBAAuB;EACvB,kBAAkB;AACpB;;AAEA;EACE,mBAAmB;EACnB,mBAAmB;EACnB,yBAAyB;EACzB,kBAAkB;EAClB,QAAQ;AACV;;AAEA;EACE,WAAW;EACX,YAAY;AACd;;AAEA;EACE,gBAAgB;EAChB,eAAe;EACf,iBAAiB;EACjB,aAAa;EACb,mBAAmB;EACnB,iBAAiB;EACjB,sBAAsB;EACtB,yBAAyB;EACzB,cAAc;AAChB;;AAEA;EACE,mBAAmB;EACnB,kBAAkB;EAClB,cAAc;EACd,6BAA6B;EAC7B,sBAAsB;EACtB,yBAAyB;EACzB,iBAAiB;EACjB,kBAAkB;EAClB,kBAAkB;EAClB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,aAAa;EACb,mBAAmB;EACnB,uBAAuB;EACvB,mBAAmB;EACnB,YAAY;EACZ,mBAAmB;EACnB,yBAAyB;EACzB,kBAAkB;EAClB,iBAAiB;EACjB,iBAAiB;AACnB;;AAEA;EACE,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,mBAAmB;EACnB,kBAAkB;EAClB,cAAc;EACd,6BAA6B;EAC7B,QAAQ;EACR,sBAAsB;EACtB,WAAW;EACX,iBAAiB;EACjB,kBAAkB;AACpB;;AAEA;EACE,YAAY;AACd;;AAEA;EACE,yBAAyB;EACzB,kBAAkB;EAClB,mBAAmB;EACnB,iBAAiB;EACjB,kBAAkB;EAClB,YAAY;EACZ,QAAQ;EACR,kBAAkB;EAClB,UAAU;AACZ;;AAEA;EACE,kBAAkB;EAClB,WAAW;EACX,SAAS;EACT,OAAO;EACP,WAAW;EACX,WAAW;EACX,WAAW;EACX,8BAA8B;EAC9B,oEAAoE;AACtE;;AAEA;EACE,uBAAuB;EACvB,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,QAAQ;EACR,iBAAiB;EACjB,cAAc;EACd,qBAAqB;AACvB;;AAEA;EACE,aAAa;AACf;;AAEA;EACE,cAAc;EACd,uBAAuB;EACvB,uBAAuB;EACvB,kBAAkB;EAClB,eAAe;EACf,QAAQ;EACR,iBAAiB;AACnB;;AAEA;EACE,uBAAuB;EACvB,mBAAmB;EACnB,mBAAmB;EACnB,QAAQ;EACR,mBAAmB;EACnB,8BAA8B;AAChC;;AAEA;EACE,sBAAsB;EACtB,uBAAuB;EACvB,eAAe;EACf,kBAAkB;EAClB,4BAA4B;EAC5B,2BAA2B;EAC3B,gBAAgB;EAChB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,mBAAmB;AACrB;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,sBAAsB;EACtB,yBAAyB;EACzB,eAAe;EACf,kBAAkB;EAClB,4BAA4B;EAC5B,2BAA2B;EAC3B,gBAAgB;EAChB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,oBAAoB;EACpB,yDAA4D;EAC5D,uBAAuB;EACvB,eAAe;EACf,kBAAkB;EAClB,4BAA4B;EAC5B,2BAA2B;EAC3B,iBAAiB;EACjB,WAAW;EACX,YAAY;AACd;;AAEA;EACE,yBAAyB;AAC3B;;AAEA;EACE,mBAAmB;EACnB,uBAAuB;EACvB,WAAW;EACX,YAAY;EACZ,uBAAuB;EACvB,yBAAyB;EACzB,kBAAkB;EAClB,uBAAuB;EACvB,kBAAkB;EAClB,gBAAgB;EAChB,eAAe;EACf,cAAc;EACd,iBAAiB;EACjB,sBAAsB;AACxB;;AAEA;EACE,eAAe;AACjB;;AAEA;;;;CAIC;AACD;EACE,gBAAgB;AAClB",sourcesContent:[':root {\n  --bgColor: #fafafa;\n}\nhtml,\nbody {\n  height: 100%;\n  width: 100%;\n  overflow: hidden;\n  background-color: var(--bgColor);\n}\n\n#log {\n  max-height: 92%;\n  max-width: 100%;\n  overflow: auto;\n  overflow-wrap: break-word;\n}\n\n.ChatUi {\n  position: absolute;\n  top: 5px;\n  bottom: 5px;\n  left: 0;\n  right: 0;\n  background-color: var(--bgColor);\n}\n\n.chat-input-text {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-page-fre {\n  overflow-wrap: break-word;\n  overflow-y: auto;\n  scroll-behavior: smooth;\n  margin-bottom: 5px;\n}\n\n.chat-input-text:focus {\n  outline: none;\n}\n\n.chat-footer-hyper-link-text {\n  /* Hyperlink */\n  height: 16px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  line-height: 16px;\n  text-decoration-line: underline;\n  /* Excel Colors / XL Primary */\n  color: #107c41;\n  /* Inside auto layout */\n  margin-top: 3px;\n}\n\n.chat-footer-like-button {\n  background-image: url("./../../assets/like-icon.svg");\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-like-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-dislike-button {\n  background-image: url("./../../assets/dislike-icon.svg");\n  margin-left: 8px;\n  background-color: white;\n  border: #ffffff;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-dislike-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-footer-info-button {\n  background-image: url("./../../assets/information-icon.svg");\n  background-color: white;\n  border: #ffffff;\n  margin-left: 8px;\n  background-repeat: no-repeat;\n  background-position-x: center;\n  background-position-y: 8px;\n  width: 28px;\n  height: 26px;\n}\n\n.chat-footer-info-button:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-log {\n  padding-top: 5px;\n  overflow-wrap: break-word;\n  overflow-y: scroll;\n  background-color: white;\n  margin-bottom: 5px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  font-weight: 400;\n  line-height: 20px;\n}\n\n.chat-log-human {\n  align-self: flex-end;\n  align-items: flex-start;\n  border: 1px solid #bebbb8;\n  background-color: #edebe9;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 10px 0px 5px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt {\n  align-self: flex-start;\n  align-items: flex-start;\n  border: 1px solid #d2d0ce;\n  background-color: #ffffff;\n  border-radius: 4px;\n  max-width: 80%;\n  margin: 0px 0px 0px 15px;\n  padding: 8px 10px;\n  gap: 4px;\n}\n\n.chat-log-chatgpt-designerlink {\n  text-decoration: none;\n  color: #b1470e;\n  margin-right: 4px;\n}\n\n.chat-log-suggestion ul {\n  padding-left: 15px;\n}\n\n.chat-log-suggestion {\n  align-self: flex-start;\n  text-align: start;\n  border: 1px solid rgb(210, 208, 206);\n  border-radius: 4px;\n  padding: 8px 10px;\n  max-width: 88%;\n  text-overflow: clip;\n  margin: 0px 0px 0px 15px;\n  white-space: pre-wrap !important;\n}\n\n.chat-log-suggestion-header {\n  font-weight: 600;\n  margin-bottom: 0.5vh;\n}\n\n.welcome-message {\n  margin-top: 100px;\n  padding-top: 20px;\n}\n\n.disclaimer {\n  font-size: 0.69rem;\n  line-height: 127%;\n  color: #707070;\n  margin: 4px 20px 0px 15px;\n}\n\n.chat-suggestionPane {\n  align-items: flex-end;\n  background: transparent;\n  margin-right: 10px;\n  margin-left: 10px;\n  justify-content: flex-start;\n  font-size: 12px;\n  padding: 4px 0px;\n  gap: 8px;\n  display: flex;\n  flex-wrap: wrap;\n  font-family: "Segoe UI";\n  font-style: normal;\n}\n\n.chat-suggestionPane-heading {\n  flex-direction: row;\n  align-items: center;\n  justify-content: flex-end;\n  margin-bottom: 5px;\n  gap: 5px;\n}\n\n.chat-suggestionPane-headingImage {\n  width: 16px;\n  height: 16px;\n}\n\n.chat-suggestionPane-headingText {\n  font-weight: 700;\n  font-size: 10px;\n  line-height: 13px;\n  display: flex;\n  align-items: center;\n  text-align: right;\n  letter-spacing: 0.04em;\n  text-transform: uppercase;\n  color: #949494;\n}\n\n.chat-suggestionPane-icon {\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  vertical-align: middle;\n  border: 2px solid #107c41;\n  padding-left: 5px;\n  padding-right: 5px;\n  border-radius: 6px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-suggestionPane-button {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n  height: 32px;\n  background: #ffffff;\n  border: 2px solid #107c41;\n  border-radius: 6px;\n  line-height: 16px;\n  padding: 0px 10px;\n}\n\n.chat-suggestionPane-label {\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 11px;\n  align-items: center;\n  text-align: center;\n  color: #242424;\n  background-color: transparent;\n  order: 0;\n  vertical-align: middle;\n  margin: 4px;\n  padding-left: 5px;\n  padding-right: 5px;\n}\n\n.user-chat-query-container {\n  margin: 12px;\n}\n\n.chat-input {\n  border: 1px solid #d1d1d1;\n  border-radius: 8px;\n  background: #ffffff;\n  margin-left: 15px;\n  margin-right: 20px;\n  padding: 4px;\n  gap: 4px;\n  position: relative;\n  z-index: 1;\n}\n\n.chat-input-onfocus-border::after {\n  position: absolute;\n  z-index: -1;\n  bottom: 0;\n  left: 0;\n  width: 100%;\n  height: 5px;\n  content: "";\n  border-radius: 0px 0px 8px 8px;\n  background-image: linear-gradient(90.5deg, #107c41 0%, #429537 100%);\n}\n\n.chat-fixed-input-text {\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 600;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n  color: #107c41;\n  white-space: pre-wrap;\n}\n\n.chat-fixed-input-text:focus {\n  outline: none;\n}\n\n.chat-input-ghost-text {\n  color: #bebebe;\n  align-items: flex-start;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-size: 14px;\n  gap: 1px;\n  line-height: 20px;\n}\n\n.chat-input-buttons {\n  align-items: flex-start;\n  background: #ffffff;\n  flex-direction: row;\n  gap: 2px;\n  margin-bottom: 10px;\n  justify-content: space-between;\n}\n\n.chat-input-buttons-suggestion {\n  align-self: flex-start;\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion > .ms-Button-flexContainer {\n  align-items: center;\n}\n\n.chat-input-buttons-suggestion:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-input-buttons-suggestion-clicked {\n  align-self: flex-start;\n  background-color: #edebe9;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-left: 4px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-suggestion-clicked:hover {\n  background-color: #edebe9;\n}\n\n.chat-input-buttons-send {\n  align-self: flex-end;\n  background-image: url("./../../assets/send-button-icon.svg");\n  background-color: white;\n  border: #ffffff;\n  border-radius: 8px;\n  background-repeat: no-repeat;\n  background-position: center;\n  margin-right: 2px;\n  width: 32px;\n  height: 32px;\n}\n\n.chat-input-buttons-send:hover {\n  background-color: #f2f2f2;\n}\n\n.chat-taskPane-learn-more-button {\n  align-items: center;\n  justify-content: center;\n  width: 77px;\n  height: 24px;\n  background: transparent;\n  border: 1px solid #616161;\n  border-radius: 4px;\n  font-family: "Segoe UI";\n  font-style: normal;\n  font-weight: 400;\n  font-size: 12px;\n  color: #616161;\n  line-height: 16px;\n  box-sizing: border-box;\n}\n\n.chat-taskPane-learn-more-button:hover {\n  cursor: pointer;\n}\n\n/*\n  * This class is used to set the max height of the input field in the chat UI.\n  * It ensures that the input field does not exceed the height of its container,\n  * allowing for a better user experience when typing long messages.\n*/\n.fai-EditorInput {\n  max-height: 100%;\n}\n'],sourceRoot:""}]);const C=h},818067:(e,t,a)=>{"use strict";a.d(t,{B:()=>l});var n=a(241273),o=a(660606),r=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},i=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},l=function(){function e(){this.apiHandlers=new Map}return e.getInstance=function(){return e.PrivateApi||(e.PrivateApi=new e),e.PrivateApi},e.prototype.initializePrivateApi=function(){return r(this,arguments,void 0,(function(e){var t,a=this;return void 0===e&&(e=0),i(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,OfficeFirstParty.PrivateApi.onPrivateEvent((function(t){return r(a,void 0,void 0,(function(){var a,n,r;return i(this,(function(i){switch(i.label){case 0:return(0,o.cY)("PrivateApi event: "+t),e>0?[4,new Promise((function(t){return setTimeout(t,e)}))]:[3,2];case 1:i.sent(),i.label=2;case 2:a=!1;try{n=JSON.parse(t)}catch(e){n=null}return(null==n?void 0:n.eventName)&&(r=this.apiHandlers.get(n.eventName))&&r instanceof Function&&(r(n),a=!0),a||(0,o.cY)("Could not dispatch PrivateApi event"),[2]}}))}))}))];case 1:return n.sent(),[3,3];case 2:return t=n.sent(),(0,o.cY)("Error initializing PrivateApi: "+t),[3,3];case 3:return[2]}}))}))},e.prototype.openMOSDialog=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){switch(t.label){case 0:return e={dispidMethod:n.T7.LaunchMos},[4,this.execute(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.getFullDocumentHtml=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){return e={dispidMethod:n.T7.GetFullDocumentHtml},[2,this.execute(e)]}))}))},e.prototype.execute=function(e){return r(this,void 0,void 0,(function(){return i(this,(function(t){return[2,OfficeFirstParty.PrivateApi.execute(JSON.stringify(e))]}))}))},e.prototype.triggerReadAloud=function(){return r(this,void 0,void 0,(function(){var e;return i(this,(function(t){return e={dispidMethod:n.T7.ReadAloud},[2,this.execute(e)]}))}))},e.prototype.attachPrivateEventHandler=function(e,t){this.apiHandlers.has(e)&&(0,o.cY)("Overwriting PrivateApi event handler for "+e),this.apiHandlers.set(e,t)},e}()},818977:(e,t,a)=>{"use strict";a.d(t,{Cn:()=>s,EQ:()=>l,S:()=>i,xq:()=>u,yc:()=>r});var n=a(893763);function o(e){e=e.replace("#","");for(;e.length<6;)e="0"+e;return e}function r(e){e=o(e);const t=parseInt(e,16);if(isNaN(t))throw new Error("NaN");return t}function i(e){let t=e.toString(16);for(;t.length<6;)t="0"+t;return"#"+t.toUpperCase()}function l(e){return(255&e)<<16|65280&e|(16711680&e)>>16}function s(e){return l(e)}function c(e){let t="",a="",r="";if(6!==(e=o(e)).length)throw new n.tF("Hex color value length is not 7.","convertHexToTuple");t=`0x${e[0]}${e[1]}`,a=`0x${e[2]}${e[3]}`,r=`0x${e[4]}${e[5]}`;const i={r:parseInt(t),g:parseInt(a),b:parseInt(r)};if(Number.isNaN(i.r)||Number.isNaN(i.g)||Number.isNaN(i.b))throw new n.tF("Failed to parse hex value into numbers.","convertHexToTuple");return i}function d(e){let t,a,n,o=e.r/255,r=e.g/255,i=e.b/255;return o=o>.04045?Math.pow((o+.055)/1.055,2.4):o/12.92,r=r>.04045?Math.pow((r+.055)/1.055,2.4):r/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,t=(.4124*o+.3576*r+.1805*i)/.95047,a=(.2126*o+.7152*r+.0722*i)/1,n=(.0193*o+.1192*r+.9505*i)/1.08883,t=t>.008856?Math.pow(t,1/3):7.787*t+16/116,a=a>.008856?Math.pow(a,1/3):7.787*a+16/116,n=n>.008856?Math.pow(n,1/3):7.787*n+16/116,{l:116*a-16,a:500*(t-a),b:200*(a-n)}}function u(e,t){if(-1!==e.findIndex((e=>e===t)))return t;{let a=0;const o=d(c(t)),r=e.reduce(((e,t)=>{const n=d(c(e)),r=d(c(t)),i=new m(n,o).getDeltaE(),l=new m(r,o).getDeltaE();return a=Math.min(l,i),l<i?t:e}));if(a<35)return r;throw new n.tF("No close color matched.","getClosestColor",n.tJ.ColorDistanceExceededThreshold)}}class m{getDeltaE(){try{this.hPrime1=this.gethPrime1(),this.hPrime2=this.gethPrime2(),this.deltahPrime=this.getDeltahPrime(),this.deltaHPrime=2*Math.sqrt(this.CPrime1*this.CPrime2)*Math.sin(this.degreesToRadians(this.deltahPrime)/2),this.HBarPrime=this.getHBarPrime(),this.T=this.getT(),this.SsubH=1+.015*this.CBarPrime*this.T,this.RsubT=this.getRsubT();const e=this.deltaLPrime/(this.ksubL*this.SsubL),t=this.deltaCPrime/(this.ksubC*this.SsubC),a=this.deltaHPrime/(this.ksubH*this.SsubH);return Math.sqrt(Math.pow(e,2)+Math.pow(t,2)+Math.pow(a,2)+this.RsubT*t*a)}catch{throw new n.tF("Error happened during calculating the color distance.","getDeltaE")}}getT(){return 1-.17*Math.cos(this.degreesToRadians(this.HBarPrime-30))+.24*Math.cos(this.degreesToRadians(2*this.HBarPrime))+.32*Math.cos(this.degreesToRadians(3*this.HBarPrime+6))-.2*Math.cos(this.degreesToRadians(4*this.HBarPrime-63))}getHBarPrime(){return Math.abs(this.hPrime1-this.hPrime2)>180?(this.hPrime1+this.hPrime2+360)/2:(this.hPrime1+this.hPrime2)/2}getDeltahPrime(){return 0===this.C1||0===this.C2?0:Math.abs(this.hPrime1-this.hPrime2)<=180?this.hPrime2-this.hPrime1:this.hPrime2<=this.hPrime1?this.hPrime2-this.hPrime1+360:this.hPrime2-this.hPrime1-360}gethPrime1(){return this.gethPrimeFn(this.x1.b,this.aPrime1)}gethPrime2(){return this.gethPrimeFn(this.x2.b,this.aPrime2)}gethPrimeFn(e,t){if(0===e&&0===t)return 0;const a=this.radiansToDegrees(Math.atan2(e,t));return a>=0?a:a+360}radiansToDegrees(e){return e*(180/Math.PI)}degreesToRadians(e){return e*(Math.PI/180)}constructor(e,t,a){this.hPrime1=0,this.hPrime2=0,this.deltahPrime=0,this.deltaHPrime=0,this.HBarPrime=0,this.T=0,this.SsubH=0,this.RsubT=0,this.getRsubT=()=>-2*Math.sqrt(Math.pow(this.CBarPrime,7)/(Math.pow(this.CBarPrime,7)+Math.pow(25,7)))*Math.sin(this.degreesToRadians(60*Math.exp(-Math.pow((this.HBarPrime-275)/25,2)))),this.x1=e,this.x2=t,this.weights=a??{lightness:1,chroma:1,hue:1},this.ksubL=this.weights.lightness,this.ksubC=this.weights.chroma,this.ksubH=this.weights.hue,this.deltaLPrime=t.l-e.l,this.LBar=(e.l+t.l)/2,this.C1=Math.sqrt(Math.pow(e.a,2)+Math.pow(e.b,2)),this.C2=Math.sqrt(Math.pow(t.a,2)+Math.pow(t.b,2)),this.CBar=(this.C1+this.C2)/2,this.aPrime1=e.a+e.a/2*(1-Math.sqrt(Math.pow(this.CBar,7)/(Math.pow(this.CBar,7)+Math.pow(25,7)))),this.aPrime2=t.a+t.a/2*(1-Math.sqrt(Math.pow(this.CBar,7)/(Math.pow(this.CBar,7)+Math.pow(25,7)))),this.CPrime1=Math.sqrt(Math.pow(this.aPrime1,2)+Math.pow(e.b,2)),this.CPrime2=Math.sqrt(Math.pow(this.aPrime2,2)+Math.pow(t.b,2)),this.CBarPrime=(this.CPrime1+this.CPrime2)/2,this.deltaCPrime=this.CPrime2-this.CPrime1,this.SsubL=1+.015*Math.pow(this.LBar-50,2)/Math.sqrt(20+Math.pow(this.LBar-50,2)),this.SsubC=1+.045*this.CBarPrime,this.hPrime1=0,this.hPrime2=0,this.deltahPrime=0,this.deltaHPrime=0,this.HBarPrime=0,this.T=0,this.SsubH=0,this.RsubT=0}}},820633:(e,t,a)=>{"use strict";a.d(t,{RJ:()=>c,r1:()=>g,u$:()=>m,u0:()=>d,w0:()=>h});var n=a(632512),o=a(83437),r=a(503079),i=a(965634),l=a(956258);const s={isLoaded:!1,deferredFlights:null,sessionId:null,buildNumber:[0,0]};function c(){if(!s.isLoaded){const e=new Error("Attempted to access deferred flights before they were set");throw l.M.getInstance().logErrorCode(n.O.FetchUnsetFlight,e,i.S2.Error,o.$b.Warning),e}return s.deferredFlights}function d(){if(!s.isLoaded){const e=new Error("Attempted to access flighting session id before they were set");throw l.M.getInstance().logErrorCode(n.O.FetchUnsetFlight,e,i.S2.Error,o.$b.Warning),e}return s.sessionId}let u=!1;const m=new r.d((async()=>{await async function(){if(!u)try{Office.context.platform===Office.PlatformType.OfficeOnline?u=!0:await Excel.run((async e=>{const t=e.flighting.getDeferredFlights(),a=e.flighting.getClientSessionId();await e.sync(),s.deferredFlights=t.value,s.sessionId=a.value;try{const e=Office.context.diagnostics.version.split(".").map((e=>parseInt(e,10))),t=Office.context.platform===Office.PlatformType.Mac?-1:0;e.length>=2-t&&(s.buildNumber=e.slice(-2+t,e.length+t)),u=!0}catch(e){l.M.getInstance().logErrorCode(n.O.FailedToParseClientVersion,e,i.S2.Error,o.$b.Warning),s.buildNumber=[0,0]}})),l.M.getInstance().logFlightingSuccess(),s.isLoaded=!0}catch(e){l.M.getInstance().logErrorCode(n.O.FlightingFailure,e,i.S2.Error,o.$b.Warning),s.isLoaded=!0}}()}));function h(e,t=!1){const a=e.map((e=>{const[t,a]=e.split(":"),[n,o]=a.split(".");return{platform:Office.PlatformType[t],majorOrDefaultValue:n,minorOrUndefined:o}})).find((e=>e.platform===Office.context.platform));if(!a)return t;try{if("true"===a.majorOrDefaultValue||"false"===a.majorOrDefaultValue)return"true"===a.majorOrDefaultValue;const e=Number.parseInt(a.majorOrDefaultValue,10),t=a.minorOrUndefined?Number.parseInt(a.minorOrUndefined,10):0,[r,c]=function(){if(!s.isLoaded){const e=new Error("Attempted to access build number before it was set");throw l.M.getInstance().logErrorCode(n.O.FetchUnsetFlight,e,i.S2.Error,o.$b.Warning),e}return s.buildNumber}();return r>e||e===r&&c>=t}catch(e){return!1}}const g=()=>h(["PC:17231","Mac:81.114","iOS:81.24010823","OfficeOnline:true"])},822606:(e,t,a)=>{"use strict";a.d(t,{$9:()=>d,Bx:()=>l,D0:()=>F,H9:()=>R,IQ:()=>s,KA:()=>I,MH:()=>S,Ng:()=>E,O1:()=>y,Rk:()=>i,Sh:()=>m,TZ:()=>C,VQ:()=>x,W2:()=>T,Xt:()=>n,aE:()=>v,bX:()=>g,f4:()=>f,hf:()=>b,kB:()=>L,oM:()=>A,pS:()=>p,ps:()=>k,qA:()=>u,qO:()=>c,s_:()=>w,u1:()=>r,w3:()=>h});var n,o=a(638753),r="",i=2e3,l="CopilotAgentsPage",s=function(){return"I wasn't able to apply a sensitivity label to this file. Please choose another file or try again."};!function(e){e.AtMention="AtMention",e.SwitcherMenu="SwitcherMenu",e.FooterButton="FooterButton"}(n||(n={}));var c=3e4,d="Copilot Extensions Dialog",u="3068386c-7a16-4f6a-a664-043b6b232816",m=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedCrossTenantError:"I can't complete this request because this content requires a sensitivity label that can only be applied within the organization where the file is stored."},h=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelDocumentReadOnlyError:"I can't complete this request because this content requires a sensitivity label that cant be applied when a file is read-only."},g=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelInsufficientPermissionError:"I can't complete this request because this content requires a sensitivity label that can only be applied by users who have permission to change the label on this file."},p=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},b=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedUdpError:"I can't complete this request because this content requires a sensitivity label with user-defined permissions."},f=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelingDisabledError:"I can't complete this request because this content requires a sensitivity label that is not available for your account."},C=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedContentTypeError:"I can't complete this request because this content requires a sensitivity label, and this type of file doesn't support sensitivity labels."},y=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelUnsupportedDkeError:"I can't complete this request because this content is protected with Double Key Encryption."},v=function(){return(0,o.Cs)()?OfficeaicopilotStrings.ApplyLabelLabelNotFoundError:"I can't complete this request because this content requires a sensitivity label that cannot be applied to this file."},x=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OsfControlContainerError:"I can't complete this request because there was a problem applying a sensitivity label."},T=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OMWorkflowUserNotFoundError:"I can't complete this request because there was a problem applying a sensitivity label."},S=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OMOfficePerpetualNotSupportedError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},w=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledProtectedViewError:"I can't complete this request because this file is in Protected View."},E=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledAppguardError:"I can't complete this request because this file is open in Application Guard."},I=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledPrivacySettingsError:"I can't complete this request because your privacy settings prevent access to content that has a sensitivity label."},R=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledUnsupportedLabelClientError:"I can't complete this request because this content requires a sensitivity label, and this version of Microsoft 365 doesn't support sensitivity labels."},A=function(){return(0,o.Cs)()?OfficeaicopilotStrings.LabelingDisabledNoSignedInClpCompatibleUsersError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},L=function(){return(0,o.Cs)()?OfficeaicopilotStrings.OMOfficeClientNotLicensedForLabelingError:"I can't complete this request because this content requires a sensitivity label, but sensitivity labeling is not turned on for your account."},k="https://go.microsoft.com/fwlink/?linkid=2271054",F="div[data-testid='MsgExtCardPreview']"},824737:(e,t,a)=>{"use strict";a.d(t,{Y:()=>r});const n={isLine:!1,isPie:!1,isClustered:!1,hasDoughnutHoleSize:!1,hasGapWidth:!1,hasDataMarkers:!1,hasSeriesOverlap:!1},o={area:{...n},areaStacked:{...n},areaStacked100:{...n},barClustered:{...n,hasGapWidth:!0,hasSeriesOverlap:!0,isClustered:!0},barStacked:{...n,hasGapWidth:!0},barStacked100:{...n,hasGapWidth:!0},columnClustered:{...n,hasGapWidth:!0,hasSeriesOverlap:!0,isClustered:!0},columnStacked:{...n,hasGapWidth:!0},columnStacked100:{...n,hasGapWidth:!0},line:{...n,isLine:!0},lineStacked:{...n,isLine:!0},lineStacked100:{...n,isLine:!0},doughnut:{...n,isPie:!0,hasDoughnutHoleSize:!0},pie:{...n,isPie:!0},scatter:{...n,hasDataMarkers:!0},bubble:{...n},radar:{...n,isLine:!0},histogram:{...n}};function r(e){return o[e]}},824815:(e,t,a)=>{"use strict";e.exports=a.p+"assets/information-icon.svg"},830166:(e,t,a)=>{"use strict";a.d(t,{g:()=>n});class n{getIsFirstColumnEntityResolved(){return this.isFirstColumnEntityResolved}getHasShownFirstColumnHint(){return this.hasShownFirstColumnHint}setIsFirstColumnEntityResolved(e,t){const a=JSON.parse(e);let n=!1;for(let e=0;e<a.length;e++)if(t?.includes(a[e])){n=!0;break}n||(this.isFirstColumnEntityResolved=!0)}setHiddenColumnSuffixMessage(e,t){const a=JSON.parse(e.headers),n=t.map((e=>a[e]));n.length>1?this.hiddenColumnSuffixMessage="I noticed that some columns are hidden, so you'll need to unhide them to see what I did.":this.hiddenColumnSuffixMessage=`I noticed that column ${n[0]} is hidden, so you'll need to unhide this column to see what I did.`}getHiddenColumnSuffixMessageAndReset(){const e=this.hiddenColumnSuffixMessage?.slice();return this.hiddenColumnSuffixMessage=void 0,e}setHasShownFirstColumnHint(e){this.hasShownFirstColumnHint=e}constructor(){this.isFirstColumnEntityResolved=!1,this.hasShownFirstColumnHint=!1}}n.instance=()=>(n._instance||(n._instance=new n),n._instance)},839945:(e,t,a)=>{"use strict";a.d(t,{jy:()=>x,I:()=>S,TQ:()=>T,fS:()=>w});var n=a(267324),o=a(518826),r=a(551499),i=a(689534),l=a(214289),s=a(923263),c=a(314998),d=a(797639),u=a(810646),m=a(157669),h=a(644665),g=a(83437),p=a(965634),b=a(956258),f=a(9847);const C=255,y=1;var v,x;async function T(e,t){const a=s.H.getInstance().getScripts();if(0===a.length)throw new c.Q0("No script found in the office script cache layer.",c.y3.scriptNotFound);const n=a.find((t=>t.name===e));if(!n)throw new c.Q0("No matched script to run.",c.y3.scriptNotFound);try{const e=new l.L;return await e.getScript(n,t)}catch{throw new c.Q0("Something went wrong while fetching the script to run.",c.y3.scriptNotFound)}}async function S(e,t){let a,l=!1,s=[];try{const h=JSON.parse(e.statements),v=new o.K,x=await v.convert(h),T=[];for(const e of x){if(e.agent!==r.w2.OfficeScripts)throw new c.Q0("ODSL cannot be saved other than Office Script agent.");T.push(...e.items)}s=(0,u.yC)(T).filter((e=>e!==i.O.MissingIntent));const S=function(e,t){const a=(0,n.QbU)(),o=[];let r=e;const i=new RegExp(/^(\s*)$/g);r&&!i.test(r)||(o.push("empty"),r=a);const l=new RegExp(/(["&%*:<>?/\\|.])/g);r.match(l)&&(o.push("invalid character"),r=r.replaceAll(l,""));const s=new RegExp(/(^((\.lock)|(CON)|(PRN)|(AUX)|(NUL)|(COM\d{1})|(LPT\d{1})|(desktop.ini))$)|(_vti_)|^~(\$)?/g);r.match(s)&&(o.push("invalid file name"),r=r.replaceAll(s,""));const c=new RegExp(/(table|Table)\s*\d+/g);r.match(c)&&(o.push("contains numbered table"),r=r.replaceAll(c,"Table"));const d=r.trim();if(d!==r&&(o.push("ends in whitespace"),r=d),r.length<y&&(o.push("too short"),r=a),r.length>C&&(o.push("too long"),r=r.substring(0,C)),0!==o.length){const e=[{key:f.ib.ErrorMessage,value:o.toString()},{key:f.ib.RequestId,value:t}];b.M.getInstance().logError({eventType:p.S2.OfficeScriptsRename,errorMessage:"",logLevel:g.$b.Warning},void 0,e)}return r}(e.scriptNameToSave,t),w=d.CP.getActiveTable();let E;w&&(0,d.En)(w)&&(E=w.name);const I=await(0,m.V)(T,S,s.join("\n"),E,n.U2P);if(!I.storageScript.body||!I.storageScript.description)throw new c.Q0("Script body or description is undefined when saving a script.");a={...I.storageScript,...I.localUpdates,body:I.localUpdates.body,description:I.storageScript.description},l=!0}catch(e){(e.isOfficeScriptSkillHandlerError||e.isExecutorError||e.isConverterError)&&(0,c.hs)(e,"save_script",t)}return{success:l,intents:s,scriptToSave:a}}async function w(e,t){let a;try{const n=s.H.getInstance(),o=new l.L;a=await o.saveCopilotScript(e,t),n.pushScript(a),(0,h.q)({operationName:"Publish",scriptMetadata:a})}catch(e){const a=new c.Q0("Something went wrong while saving the script.");(0,c.hs)(a,"save_script",t)}return a}!function(e){e.Empty="empty",e.TooLong="too long",e.TooShort="too short",e.InvalidCharacter="invalid character",e.InvalidFileName="invalid file name",e.EndsInWhitespace="ends in whitespace",e.ContainsNumberedTable="contains numbered table"}(v||(v={})),function(e){e.Recurrence="recurrence"}(x||(x={}))},840574:(e,t,a)=>{"use strict";function n(){return Office.context.platform===Office.PlatformType.PC||Office.context.platform===Office.PlatformType.Mac}a.d(t,{f:()=>n})},848403:(e,t,a)=>{"use strict";a.d(t,{X:()=>d});var n=a(944563),o=a(747377),r=a(57980),i=a(962127),l=a(208520);const s=(e,t)=>(0,l.useCallback)((()=>{const e=(0,i.wP)(),t=(0,i.Xj)(e).palette,a=(o=e)===i._f.Black||o===i._f.DarkGray;var o;return(0,r.l8)({errorOutput:{color:t.red},stringOutput:{color:t.themeSecondary,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"},staticOutput:{color:t.themeSecondary},numberOutput:{color:a?"#B5CEA8":"#098658",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"},booleanOutput:{color:a?"#569CD6":"#0000FF",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"},webImage:{objectFit:"contain",maxWidth:"calc(min(80%, 100px))",maxHeight:"100px"},localImage:{objectFit:"contain"},pythonProps:{color:t.neutralSecondary,fontSize:"12px","> code":{color:"inherit !important"}},pythonTable:{whiteSpace:"nowrap",overflowX:"auto",textOverflow:"ellipsis",display:"flow",width:"100%",tableLayout:"fixed",borderSpacing:0,borderCollapse:"collapse","& tr > td":{border:`1px solid ${t.neutralSecondaryAlt}`,padding:"2px 4px",minWidth:"30px"},"& > thead > tr > td":{background:t.neutralLight,fontWeight:r.BO.semibold,"> code":{fontWeight:"inherit !important",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",display:"flow"}},"& > tbody > tr > td":{}},showPythonCodeToggleButtonStyle:{color:n.k1.colorNeutralForeground3,paddingLeft:"2px !important",marginLeft:"4px !important","&:hover":{color:n.k1.colorNeutralForeground2Hover,paddingLeft:"2px",marginLeft:"4px"},"&:hover:active":{color:n.k1.colorNeutralForeground2Pressed,paddingLeft:"2px",marginLeft:"4px"},"@media (forced-colors: active)":{"> span":{color:"inherit","> svg":{color:"inherit"}}}},diagnosticsOutputContainer:{display:"flex",flexDirection:"column",alignItems:"flex-start",fontFamily:"Consolas, monospace",fontSize:"16px",fontWeight:"400",whiteSpace:"pre-wrap",lineHeight:"20px",marginBottom:"8px",overflowWrap:"anywhere"},stdOut:{color:t.neutralSecondary,padding:"2px 0 2px 0"},Error:{color:t.red,padding:"2px 0 2px 0"},outputText:{color:n.k1.colorNeutralForeground3,fontWeight:"600"}})}),[e,t]);var c=a(247967);function d(){const{sdxTheme:e,highContrastClientMode:t}=(0,l.useContext)(c.D),[a,r]=(0,l.useState)(t!==n.QJ.disabled);(0,l.useEffect)((()=>{r(t!==n.QJ.disabled)}),[t]);return{linkTheme:(0,n.eS)(e||o.G.defaultWhite,a),getStyles:s(e,a),sdxTheme:e,isHighContrast:a}}},863400:(e,t,a)=>{"use strict";a(223401);var n=a(208520),o=60103;if(t.Fragment=60107,"function"==typeof Symbol&&Symbol.for){var r=Symbol.for;o=r("react.element"),t.Fragment=r("react.fragment")}var i=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l=Object.prototype.hasOwnProperty,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,a){var n,r={},c=null,d=null;for(n in void 0!==a&&(c=""+a),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)l.call(t,n)&&!s.hasOwnProperty(n)&&(r[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===r[n]&&(r[n]=t[n]);return{$$typeof:o,type:e,key:c,ref:d,props:r,_owner:i.current}}t.jsx=c,t.jsxs=c},874066:(e,t,a)=>{"use strict";a.d(t,{F:()=>u,m:()=>d});var n=a(637211),o=a(993384),r=a(644476),i=a(241273),l=a(789787);const s={tokenState:"NotStarted",doesFluxTurnRequireUndo:!1,augloopModelWorkflowUnsupported:!1,userType:i.ut.Unknown,clientInfo:(0,l.z)(),localeInfo:(0,o.FZ)(),copilotState:void 0},c=(0,r.Z0)({name:"app",initialState:s,reducers:{loadAuth(e){e.tokenState="Loaded"},fetchTokenSuccess(e){e.tokenState="Cached"},fetchTokenFailed(e){e.tokenState="Error"},setDoesFluxTurnRequireUndo:e=>{e.doesFluxTurnRequireUndo=!0},resetDoesFluxTurnRequireUndo:e=>{e.doesFluxTurnRequireUndo=!1},setLocaleInfo:(e,t)=>{e.localeInfo=t.payload.localeInfo},setUserType:(e,t)=>{e.userType=t.payload},setAugloopModelWorkflowUnsupported:e=>{e.augloopModelWorkflowUnsupported=!0},setClientInfo:(e,t)=>{e.clientInfo={...t.payload,hostWindowObject:void 0}},setCopilotState:(e,t)=>{e.copilotState!==n.$.Enabled&&(e.copilotState=t.payload)}}}),{actions:d,reducer:u}=c},875136:(e,t,a)=>{"use strict";a.d(t,{$k:()=>k,BW:()=>L,Cc:()=>w,F5:()=>N,Fr:()=>F,Li:()=>q,MO:()=>O,Mg:()=>A,P_:()=>B,QO:()=>P,_F:()=>M,ek:()=>R,hb:()=>V,i5:()=>_,l5:()=>E,lu:()=>U,oO:()=>D,tW:()=>H,xk:()=>y});var n=a(965634),o=a(267324),r=a(956258),i=a(235373),l=a(797639),s=a(9847),c=a(977055),d=a(108869),u=a(507628);let m,h,g,p,b,f="",C=0;var y;function v(e,t){t.push({key:n.tM.PythonDurationEvent,value:e}),(t=t.concat((0,c.p1)())).push({key:n.tM.UserScenarioId,value:f});const a={eventType:n.S2.PythonDuration,eventData:t};r.M.getInstance().logEvent(a)}function x(e){const t=[];t.push({key:n.tM.TimerName,value:e}),v("TimerAlreadyRunning",t)}function T(e){const t=[];t.push({key:n.tM.TimerName,value:e}),v("TimerUndefined",t)}function S(e,t){const a=performance.measure(e,{start:t});return Math.round(a.duration)}function w(e,t,a,o){const r=(0,s.xJ)(t),i=l.CP.pythonContextManager.pythonContextBuilder.getPythonConversationHistory().length,c=l.CP.pythonContextManager.pythonContextBuilder.getOtherPythonCells().length,d=[];d.push({key:n.tM.Duration,value:r}),d.push({key:n.tM.IsPythonCellSelected,value:l.CP.isPythonCellSelected}),d.push({key:n.tM.ConversationHistoryCount,value:i}),d.push({key:n.tM.OtherPythonCellsCount,value:c}),d.push({key:n.tM.IsErrorCaught,value:a}),d.push({key:n.tM.WorksheetsProcessed,value:l.CP.pythonContextManager.pythonContextBuilder.getWorksheetsProcessed()}),d.push({key:n.tM.FormulasProcessed,value:l.CP.pythonContextManager.pythonContextBuilder.getFormulasProcessed()}),d.push({key:n.tM.FormulasProcessedPerWorksheet,value:l.CP.pythonContextManager.pythonContextBuilder.getFormulasProcessedPerWorksheet()}),o&&d.push({key:n.tM.OptionalDetails,value:o}),v(e,d)}function E(e,t,a,o=!1){const r=(0,s.xJ)(t),i=[];i.push({key:n.tM.Duration,value:r}),i.push({key:n.tM.IsErrorCaught,value:o}),a&&i.push({key:n.tM.RetryCount,value:a}),v(e,i)}function I(e,t,a){const o=(0,s.cc)(t),r=[];r.push({key:n.tM.Duration,value:o}),r.push({key:n.tM.IsErrorCaught,value:a||!1}),v(e,r)}async function R(e,t,a=!1){const n=performance.now();let o=!1;try{return await e()}catch(e){if(o=!0,!a)throw e}finally{I(t,n,o)}}async function A(e,t){const a=performance.now();let o=!1;try{return await e()}catch(e){throw o=!0,e}finally{if("GetPythonCellsFromSpecialCellsAreas"===t)!function(e,t,a){const o=(0,s.cc)(t),r=[];r.push({key:n.tM.Duration,value:o}),r.push({key:n.tM.IsErrorCaught,value:a||!1}),r.push({key:n.tM.FormulasProcessedPerWorksheet,value:l.CP.pythonContextManager.pythonContextBuilder.getFormulasProcessedPerWorksheet()}),v(e,r)}(t,a,o);else I(t,a,o)}}function L(e){e(i.m.setLoadingStrings((0,o.NCh)()))}function k(e){e(i.m.setLoadingStrings((0,o.ZYo)()))}function F(e){(m||h)&&x("codeExecutionTimer"),m=performance.now(),h=e}function _(e){const t=l.CP.pythonContextManager.isFirstCodeExecution;if(l.CP.pythonContextManager.isFirstCodeExecution=!1,!m||!h)return void T("codeExecutionTimer");const a=S(h,m),o=[];o.push({key:n.tM.Duration,value:a}),o.push({key:n.tM.DidInsert,value:e}),o.push({key:n.tM.IsFirstCodeExecution,value:t}),v(h,o),m=void 0,h=void 0}function P(e,t,a){const o=(0,s.xJ)(t),r=[];r.push({key:n.tM.Duration,value:o}),a&&r.push({key:n.tM.OptionalDetails,value:a}),v(e,r)}function N(){g&&x("PythonUserScenario"),g=performance.now(),""!==f&&l.CP.pythonContextManager.isPythonMode&&0===p||(f=(0,u.A)()),p=0}function M(){C++}function O(){$("UserScenarioQueryToCalculationComplete",!1)}function D(){$("UserScenarioQueryToFinalText",!0)}function B(e=!1,t=!1){$("UserScenarioQueryToError",!0,e,t)}function $(e,t,a=!1,o=!1){if(!g)return void T("PythonUserScenario."+e);const r=S(e,g),i=[];i.push({key:n.tM.ResponseNumber,value:p}),i.push({key:n.tM.Duration,value:r}),i.push({key:n.tM.DidAugloopCallFail,value:a}),i.push({key:n.tM.IsStopGenerating,value:o}),i.push({key:n.tM.CodeErrorCount,value:C});const s=l.CP.pythonContextManager.pythonContextBuilder.getOtherPythonCells().length;i.push({key:n.tM.OtherPythonCellsCount,value:s});const c=l.CP.pythonContextManager.pythonContextBuilder.getPythonConversationHistory().length;i.push({key:n.tM.ConversationHistoryCount,value:c}),v(e,i),t&&(0===p&&"UserScenarioQueryToError"!==e||(f=""),g=void 0,p=0,C=0)}function H(e,t,a){0===e&&(t||(0,d.i_)())&&$("UserScenarioQueryToFirstResponse",!1),a&&D()}function U(){b&&x("PythonAugloopCall"),b=performance.now()}function q(){(l.CP.pythonContextManager.isPythonMode||(0,d.i_)())&&p++,G("AugloopCallToSuccess")}function V(){(l.CP.pythonContextManager.isPythonMode||(0,d.i_)())&&p++,G("AugloopCallToError",!0)}function G(e,t=!1){if(!b)return void T("AugloopCall");const a=S(e,b),o=[];o.push({key:n.tM.ResponseNumber,value:p}),o.push({key:n.tM.Duration,value:a});const r=l.CP.pythonContextManager.pythonContextBuilder.getOtherPythonCells().length;o.push({key:n.tM.OtherPythonCellsCount,value:r});const i=l.CP.pythonContextManager.pythonContextBuilder.getPythonConversationHistory().length;o.push({key:n.tM.ConversationHistoryCount,value:i}),o.push({key:n.tM.DidAugloopCallFail,value:t}),v(e,o),b=void 0}!function(e){e.AdaContextExtraction="AdaContextExtraction",e.AugloopCallToSuccess="AugloopCallToSuccess",e.AugloopCallToError="AugloopCallToError",e.CallGetSpecialCellsOrNullObjectApi="CallGetSpecialCellsOrNullObjectApi",e.CodeExecution="CodeExecuted",e.ConnectOfficePySvcToExecutePythonCode="ConnectOfficePySvcToExecutePythonCode",e.DataFrameInsert="DataFrameInsert",e.ExecutePythonCodeApiCall="ExecutePythonCodeApiCall",e.FindDataFrameAddress="FindDataFrameAddress",e.GetActiveTableContext="GetActiveTableContext",e.GetAllPythonCellsUptoAnalysisSheet="GetAllPythonCellsUptoAnalysisSheet",e.GetAllPythonCellsOfAASessionAnalysisSheet="GetAllPythonCellsOfAASessionAnalysisSheet",e.GetExcelValueSingleCellOutput="GetExcelValueSingleCellOutput",e.GetLastPythonCellOnSheet="GetLastPythonCellOnSheet",e.GetOfficePyServiceAccessToken="GetOfficePyServiceAccessToken",e.GetPythonCellContext="GetPythonCellContext",e.GetPythonCellRange="GetPythonCellRange",e.GetPythonCellsFromSpecialCellsAreas="GetPythonCellsFromSpecialCellsAreas",e.GetPythonCellsFromWorksheet="GetPythonCellsFromWorksheet",e.GetPythonContextObjectApiCall="GetPythonContextObjectApiCall",e.GetPythonObjectOutput="GetPythonObjectOutput",e.GetPythonObjectReferenceIdWithRetry="GetPythonObjectReferenceIdWithRetry",e.GetUpdatedPythonTableContext="GetUpdatedPythonTableContext",e.GetUpdatedPythonTableContextForTableLikeRange="GetUpdatedPythonTableContextForTableLikeRange",e.HandlePythonAdaCellExecution="HandlePythonAdaCellExecution",e.InsertDataFrameAndGetPythonContext="InsertDataFrameAndGetPythonContext",e.InsertDataFrameIfNecessaryForStartAnalysis="InsertDataFrameIfNecessaryForStartAnalysis",e.InsertContentToGrid="InsertContentToGrid",e.InsertPostView="InsertPostView",e.InsertPreview="InsertPreview",e.IsPythonCell="IsPythonCell",e.PreloadOfficePyServiceAccessToken="PreloadOfficePyServiceAccessToken",e.RecalcSheet="RecalcSheet",e.StartAnalysisContextExtraction="StartAnalysisContextExtraction",e.TimerAlreadyRunning="TimerAlreadyRunning",e.TimerUndefined="TimerUndefined",e.UpdateConversationHistory="UpdateConversationHistory",e.UserScenarioQueryToError="UserScenarioQueryToError",e.UserScenarioQueryToFirstResponse="UserScenarioQueryToFirstResponse",e.UserScenarioQueryToCalculationComplete="UserScenarioQueryToCalculationComplete",e.UserScenarioQueryToFinalText="UserScenarioQueryToFinalText"}(y||(y={}))},877825:(e,t,a)=>{"use strict";a.d(t,{y:()=>p});var n=a(365319),o=a(923263),r=a(83437),i=a(965634),l=a(956258),s=a(9847);class c{constructor(e){this.camelToSnake=e=>e.replace(/([A-Z])/g,(e=>`_${e.toLowerCase()}`)),this.getRawStatements=e=>e.map((e=>{let t="";if(e.returns&&(t+=e.returns+"="),t+=this.camelToSnake(e.name)+"(",e.arguments){const a=Object.keys(e.arguments);for(let n=0;n<a.length;n++){const o=e.arguments[a[n]];if(o){switch(t+=a[n]+"=",o.type){case"number":t+=JSON.stringify(o.number);break;case"boolean":t+=JSON.stringify(o.boolean);break;case"jsonGrid":t+=JSON.stringify(o.json);break;case"stringList":t+=JSON.stringify(o.stringList);break;case"numberList":t+=JSON.stringify(o.numberList);break;case"color":case"string":t+=JSON.stringify(o.string);break;case"var":case"scope":t+=o.name;break;default:throw new Error("Type of the argument cannot be handled.")}n!==a.length-1&&(t+=", ")}}}return t=t.trim(),t=t.replace(/,$/,""),t+=")",t})),this.logConvertRawODSLError=()=>{const e=l.M.getInstance(),t={eventType:i.S2.OfficeScriptsContextManager,errorMessage:"",logLevel:r.$b.Error},a=[{key:s.ib.ErrorMessage,value:"Something went wrong while converting statements to raw format."}];e.logError(t,void 0,a)},this.convertToRawODSLString=()=>{try{return this.getRawStatements(this.statements).join("\n")}catch{return void this.logConvertRawODSLError()}},this.statements=e}}var d=a(267324),u=a(79458);const m=e=>{const t=l.M.getInstance(),a={eventType:i.S2.OfficeScriptsContextManager,errorMessage:"",logLevel:r.$b.Warning},n=[{key:s.ib.ErrorMessage,value:e}];t.logError(a,void 0,n)};var h=a(691097),g=a(495501);class p{constructor(){this.odslCacheList=[],this.tableNames=[],this.getOfficeScriptsContext=()=>{const e=o.H.getInstance();return{odslCache:JSON.stringify(this.odslCacheList),scriptNames:e.getScripts().map((e=>e.name)),tableNames:this.tableNames}},this.pushOdslCache=(e,t)=>{const a=new c(t).convertToRawODSLString();if(a){const t={query:e,odsl:a};this.odslCacheList.push(t)}},this.clearODSLCache=()=>{this.odslCacheList=[]},this.initOfficeScriptsContext=async()=>{this.tableNames=await async function(){try{return await Excel.run({delayForCellEdit:!0},(async e=>{const t=e.workbook.tables.load("items/name");return await e.sync(),t.items.map((e=>e.name))}))}catch{return m("Office JS call failed to get all tables on current workbook"),[]}}(),await o.H.getInstance().populateScriptsList(),(0,u.cY)(`Office Scripts Context: Initial tables ${this.tableNames}`)},this.removeTable=e=>{const t=this.tableNames.findIndex((t=>t===e));t>-1&&(this.tableNames.splice(t,1),(0,u.cY)(`Office Scripts Context: Removing table ${this.tableNames}`))},this.addTable=async e=>{const t=await async function(e){try{return await Excel.run({delayForCellEdit:!0},(async t=>{const a=t.workbook.tables.getItem(e).load("name");return await t.sync(),a.name}))}catch{return void m("Office JS call failed to get table name by id")}}(e);t&&(this.tableNames.push(t),(0,u.cY)(`Office Scripts Context: Adding table ${this.tableNames}`))},this.checkIfFlowCreatedFromPowerAutomate=async()=>{if((0,h.P)("FlowCreated")){const{message:e,telemetry:t}=g.n.getOfficeScriptSimpleResponse((0,d.ejy)(),s.a5.FlowCreatedConfirmation,!1);n.$.getInstance().displayResponse(e,t)}}}}p._instance=void 0,p.getInstance=()=>(void 0===p._instance&&(p._instance=new p),p._instance)},880496:(e,t,a)=>{"use strict";a.d(t,{By:()=>G,D$:()=>S,Fr:()=>W,H:()=>T,Jx:()=>$,K3:()=>I,O9:()=>F,Qy:()=>R,RV:()=>A,So:()=>v,Tq:()=>E,XR:()=>b,XZ:()=>q,Xw:()=>y,Z:()=>U,Z$:()=>z,a$:()=>j,cc:()=>w,dn:()=>x,gx:()=>g,hU:()=>H,me:()=>C,mg:()=>k,oc:()=>L,sq:()=>B,th:()=>V,uT:()=>f});var n=a(632512),o=a(373753),r=a(267324),i=a(83437),l=a(965634),s=a(956258),c=a(357781),d=a(528804),u=a(471742),m=a(64292),h=a(270750);function g(e){const t=e.lastIndexOf("!");if(-1===t)return e;const a=e.slice(t+1);return a.length>1e3?void 0:a}function p(e,t){const a=e.lastIndexOf("!");let n=null;return-1!==a&&(n=e.substr(0,a),!t&&n.startsWith("'")&&(n=n.substr(1,n.length-2))),n}function b(e,t,a,n){if(0===e.length||void 0===t)return[];let o=n?n.slice(t[0],t[t.length-1]+1):new Array(t[t.length-1]-t[0]+1).fill("");if(t.forEach(((a,n)=>{const r=a-t[0];r>=0&&r<o.length&&(o[r]=e[0][n])})),a){const e=n?n.slice(0,t[0]):new Array(t[0]).fill("");e[0]=r.olU.CalculatedRowsFormulaTotalHeader,o=e.concat(o)}return o}function f(e,t,a,n){if(e<0||t<0||a<0||n<0)throw new Error("Invalid indices");const o=e+1,r=t+1,i=e+a,l=t+n;return`${(0,c.LM)(o,r)}:${(0,c.LM)(i,l)}`}function C(e){const t=e.workbook.worksheets.getActiveWorksheet().getUsedRangeOrNullObject(!0);return()=>t.isNullObject}function y(e){const t=e.replace(/^\[\$-([a-z]+-[A-Za-z0-9]+(-[A-Z]+)?)?(,[0-9]{1,3})?\]/,"");return h.gv.some((e=>e===t))}function v(e){return"string"==typeof e&&(0===e.length||0===e.replace(/\s/g,"").length)}function x(e,t){const a=p(t);return null==a?e.workbook.worksheets.getActiveWorksheet():e.workbook.worksheets.getItem(a)}async function T(e,t){let a;for(;!a?.done;)a=t.next(),await e.sync();return a.value}function S(e){const t=e.indexOf(":");return-1===t?e:e.substring(0,t)}function w(e){const t=p(e,!0),a=g(e);if(a){const e=(0,u.AW)(a);return t?`${t}!${(0,u.z)(e.right+1)}${e.top}`:`${(0,u.z)(e.right+1)}${e.top}`}}function E(e,t,a,o){if(!(o>=a))return(0,c.LM)(t,e+o);s.M.getInstance().logErrorCode(n.O.CalculatedColumnPreviewColumnOffsetOutOfTable,new Error("getFirstCellAddressOfColumnInTable: columnOffset is out of table"),l.S2.FormulaGeneration,i.$b.Warning)}function I(e,t){const a=p(e,!0),n=g(e);if(n){const e=(0,u.AW)(n);return a?`${a}!${(0,u.z)(e.left+t)}${e.bottom+1}`:`${(0,u.z)(e.left+t)}${e.bottom+1}`}}const R=async e=>Excel.run((async t=>{const a=t.workbook.worksheets.getActiveWorksheet().getRange(e);return a.load("valueTypes"),await t.sync(),A(a)}));function A(e){return e.valueTypes.every((e=>e.every((e=>e===Excel.RangeValueType.empty))))}async function L(e,t){const a=(0,m.d)(e);await e.sync();const n=await a()(e);return t.push(n.undo),n.result}function k(e){return 0===e.length?e:e[0].map(((t,a)=>e.map((e=>e[a]))))}function F(e){return void 0!==e}const _="d",P="w",N=new RegExp("[0-9]","gm"),M=new RegExp(_,"gm"),O=new RegExp(`[^=\\[\\]\\.\\\\/%#\\-\\+,;\\(\\):?"&<>'!{}~\\^\\*$\\s\\ua0c2${_}]`,"gm");function D(e){return(e=(e=e.toLowerCase().replace(M,P)).replace(N,_)).replace(O,P)}function B(e){return e.flatMap((e=>e.map(D)))}function $(e){const t=e.match(/^(?:[^!]+!)?\$?([A-Z]{1,3})\$?\d+(?::\$?[A-Z]{1,3}\$?\d+)?$/);return t?.[1]?function(e){e=e.toUpperCase();let t=0;for(let a=0;a<e.length;a++)t*=26,t+=e.charCodeAt(a)-"A".charCodeAt(0)+1;return t}(t[1]):-1}function H(e){return e.calculatedFormulas.length<=1}function U(e){return!e.insertRowTitle&&q(e)}function q(e){if(!H(e))return!1;const t=e.calculatedFormulas[0].insertionIndexes;return void 0===t||t.length<=1}function V(e){return Boolean(e.isSingleFormula&&e.calculatedFormulas[0]?.insertionMode===o.PH.OverrideSelection)}function G(e){return Boolean((0,d.yw9)("OfficeVSO_9753947_insertCellToFixedRange")&&H(e)&&e.calculatedFormulas[0]?.insertionMode===o.PH.OverrideFixedRange&&e.calculatedFormulas[0]?.fixedInsertionRange)}async function W(){return Excel.run((async e=>{const t=e.workbook.worksheets.getActiveWorksheet();return t.load("name"),await e.sync(),t.name}))}async function z(){return Excel.run((async e=>{const t=e.workbook.getActiveCell();return t.load("address"),await e.sync(),t.address}))}async function j(){return g(await z())??""}},881707:(e,t,a)=>{"use strict";a.d(t,{n:()=>f});var n=a(822606),o=a(116510),r=a(73915),i=a(660606),l=a(638753),s=a(423905),c=a(507628),d=a(755657),u=a(241273),m=function(){return m=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},m.apply(this,arguments)},h=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},g=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}},p=null,b=(0,c.A)(),f=function(){function e(){this.labelChangedFromChatHistory=!1,this.inDocLabelInfo={labelId:n.u1,tenantId:n.u1},this.externalDocLabelInfo={labelId:n.u1,tenantId:n.u1},this.inDocLabelInfo.labelId=n.u1,this.inDocLabelInfo.tenantId=n.u1,this.externalDocLabelInfo.labelId=n.u1,this.externalDocLabelInfo.tenantId=n.u1}return e.getInstance=function(t,a,n,o,r){return(0,l.hX)(e.clpSensitivityHandler)&&(e.clpSensitivityHandler=new e),(0,l.hX)(t)||(e.clpSensitivityHandler.setBasicChatProps=t),(0,l.hX)(a)||(e.clpSensitivityHandler.setChatUiProps=a),(0,l.hX)(n)||(e.clpSensitivityHandler.copilotChatRef=n),(0,l.hX)(o)||(e.clpSensitivityHandler.removeCurrentContextId=o),(0,l.hX)(r)||(e.clpSensitivityHandler.getShouldStopLoadingUi=r),e.clpSensitivityHandler},e.prototype.setInDocSensitiveLabelInfoUsingOfcJs=function(){return h(this,void 0,void 0,(function(){var e,t,a;return g(this,(function(n){switch(n.label){case 0:if(null===(a=i.t6.IsCopilotInBackstageMode)||void 0===a?void 0:a.call(i.t6))return[2];n.label=1;case 1:return n.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=n.sent(),this.setInDocSensitivityLabelInfo(e),(0,s.Zy)("setInDocSensitiveLabelInfoUsingOfcJs"),[3,4];case 3:return t=n.sent(),(0,s.mQ)("error in getLabel Api: ".concat(t.message),t.code,t.stack),(0,d.Uk)(this.copilotChatRef,t.code,u.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while fetching and setting In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return[2]}}))}))},e.prototype.getInDocSensitiveLabelUsingOfcJs=function(){return h(this,void 0,void 0,(function(){var e,t,a;return g(this,(function(o){switch(o.label){case 0:if((0,i.cY)("Getting label"),e={labelId:n.u1,tenantId:n.u1},null===(a=i.t6.IsCopilotInBackstageMode)||void 0===a?void 0:a.call(i.t6))return[2,e];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getLabel()];case 2:return e=o.sent(),(0,s.Zy)("getLabel"),[3,4];case 3:return t=o.sent(),(0,s.mQ)("error in getLabel Api : ".concat(t.message),t.code,t.stack),(0,d.Uk)(this.copilotChatRef,t.code,u.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while fetching In Doc sensitivity label: ".concat(t.message,", error code: ").concat(t.code)),[3,4];case 4:return(0,i.cY)("Label is : ",e),[2,e]}}))}))},e.prototype.setInDocSensitivityLabelInfo=function(e){var t=this;(0,i.cY)("setting InDoc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.inDocLabelInfo.version=e.version,this.inDocLabelInfo.labelId=e.labelId,this.inDocLabelInfo.tenantId=e.tenantId,this.inDocLabelInfo.isEnabled=e.isEnabled,this.inDocLabelInfo.encryptionType=e.encryptionType,this.inDocLabelInfo.isDke=e.isDke,this.inDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.inDocLabelInfo.order=e.order,this.inDocLabelInfo.displayName=e.displayName,this.inDocLabelInfo.description=e.description,this.inDocLabelInfo.parentName=e.parentName,this.inDocLabelInfo.color=e.color,this.setBasicChatProps&&this.setBasicChatProps((function(a){var n,i;return m(m({},a),{sensitivityIndicatorData:t.shouldShowInDocSensitivityLabel()?{tooltipText:null!==(n=e.description)&&void 0!==n?n:"",badgeText:null!==(i=e.displayName)&&void 0!==i?i:"",iconType:e.encryptionType!==o.T.None?r.JF.Encryption:r.JF.NonEncryption}:void 0})})),this.setChatUiProps&&this.shouldShowInDocSensitivityLabel()&&this.setChatUiProps((function(e){return m(m({},e),{documentSensitivityProps:t.getSensitivity()})}))},e.prototype.updateSdxSensitiveLabelFromChatHistory=function(e){return h(this,void 0,void 0,(function(){var t;return g(this,(function(a){switch(a.label){case 0:return e&&0!==e.length?(t=e.map((function(e){return{labelId:e,tenantId:n.u1}})),this.labelChangedFromChatHistory?[4,this.setInDocSensitiveLabelInfoUsingOfcJs()]:[3,2]):((0,i.cY)("ClpSensitivityHandler: No labelIds passed to updateSdxSensitiveLabelFromChatHistory"),[2,"No labelIds passed to updateSdxSensitiveLabelFromChatHistory"]);case 1:a.sent(),this.labelChangedFromChatHistory=!1,a.label=2;case 2:return 1===t.length&&this.inDocLabelInfo.labelId===t[0].labelId?((0,i.cY)("ClpSensitivityHandler: No update required as labelId is same as current labelId"),[2,"No update required as labelId is same as current labelId. label:"+this.inDocLabelInfo.displayName]):(t.push(this.inDocLabelInfo),[4,this.setSensitivityLabelToHighestSensitivity(t)]);case 3:return a.sent(),this.labelChangedFromChatHistory=!0,[2,"Updated label to ".concat(this.inDocLabelInfo.displayName)]}}))}))},e.prototype.upgradeSensitivityLabelUsingOfcJs=function(e){return h(this,arguments,void 0,(function(e,t){var a,r,l,c,m,f,C,y,v=this;return void 0===t&&(t=!1),g(this,(function(x){switch(x.label){case 0:if((0,s.Zy)("tryUpgradeLabel"),!(null==e?void 0:e.labelId)||t&&!function(e){var t,a=/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$/;return null!=(null===(t=e.labelId)||void 0===t?void 0:t.match(a))}(e))return(0,i.cY)("Invalid label",e),(0,s.mQ)("Invalid label format id: ".concat(e.labelId),o.q[o.q.E_APPLYLABEL_FAIL],""),[2,{status:o.q[o.q.E_APPLYLABEL_FAIL],errorMessage:"Invalid label format"}];if(null===(C=i.t6.IsCopilotInBackstageMode)||void 0===C?void 0:C.call(i.t6))return(0,i.cY)("Upgrading sensitivity label disabled in backstage mode"),[2,{status:o.q[o.q.E_APPLYLABEL_FAIL],errorMessage:"disabled in backstage mode"}];(0,i.cY)("Upgrading sensitivity label: ".concat(JSON.stringify(e))),a=o.q[o.q.S_APPLYLABEL_OK],r=n.u1,x.label=1;case 1:return x.trys.push([1,6,,7]),this.inDocLabelInfo.tenantId!==e.tenantId||this.inDocLabelInfo.labelId!==e.labelId?[3,3]:[4,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,b)];case 2:return x.sent(),[2,{status:o.q[o.q.S_APPLYLABEL_OK]}];case 3:return l=function(){return h(v,void 0,void 0,(function(){return g(this,(function(t){try{return[2,OfficeFirstParty.Sensitivity.tryUpgradeLabel(e,b)]}catch(e){(0,s.mQ)("error while calling tryUpgradeLabel() Api : ".concat(e.message),e.code,e.stack),r=(0,d.Uk)(this.copilotChatRef,e.code,u.OZ.CLP_Upgrade,this.removeCurrentContextId),(0,i.cY)("Error while upgrading sensitivity label: ".concat(e.message,", error code: ").concat(e.code)),a=e.message}return[2]}))}))},c=new Promise((function(e){p=e})),m=new Promise((function(e,t){var a=n.qO;setTimeout((function(){return t(new Error("CallbackTimeout"))}),a)})),[4,Promise.race([Promise.all([c,l()]),m])];case 4:x.sent(),x.label=5;case 5:return[3,7];case 6:return f=x.sent(),(0,s.mQ)("Exception while waiting for tryUpgradeLabel() and Callback completion: ".concat(f.message),f.code,f.stack),(0,d.Uk)(this.copilotChatRef,f.code,u.OZ.CLP_Upgrade,this.removeCurrentContextId),"CallbackTimeout"===f.message?(0,i.cY)("Callback Timeout"):(0,i.cY)("Exception while upgrading sensitivity label: ".concat(f.message,", error code: ").concat(f.code)),a=null!==(y=o.q[f.message])&&void 0!==y?y:f.message,[3,7];case 7:return p=null,[2,{status:a,errorMessage:r}]}}))}))},e.prototype.setLabelChangeEventListener=function(e){var t;if(null===(t=i.t6.IsCopilotInBackstageMode)||void 0===t?void 0:t.call(i.t6))(0,i.cY)("setting label change EventListener disabled in backstage mode");else try{OfficeFirstParty.Sensitivity.onLabelChangedEvent(null!=e?e:C),(0,s.Zy)("Label Change Event Listener"),(0,i.cY)("Sensitivity Label Change Event Listener Set")}catch(e){(0,s.mQ)("error in setting listener for CLP : ".concat(e.message),e.code,e.stack),(0,d.Uk)(this.copilotChatRef,e.code,u.OZ.CLP_Upgrade,this.removeCurrentContextId),(0,i.cY)("Error while setting sensitivity label change event listener: ".concat(e.message,", error code: ").concat(e.code))}},e.prototype.updateExternalDocSensitivityLabelUsingOfsJs=function(e){return h(this,void 0,void 0,(function(){var t,a,n;return g(this,(function(o){switch(o.label){case 0:if(null===(n=i.t6.IsCopilotInBackstageMode)||void 0===n?void 0:n.call(i.t6))return(0,i.cY)("update external doc sensitivity label disabled in backstage mode"),[2];o.label=1;case 1:return o.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=o.sent(),(0,i.cY)("External Doc Sensitivity Label Fetched: ".concat(JSON.stringify(t))),this.setExternalDocSensitivityLabelInfo(t),(0,s.Zy)("External Doc HighestSensitivityLabel"),[3,4];case 3:return a=o.sent(),(0,s.mQ)("error in HighestSensitivityLabel Api : ".concat(a.message),a.code,a.stack),(0,d.Uk)(this.copilotChatRef,a.code,u.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while updating external doc sensitivity label: ".concat(a.message,", error code: ").concat(a.code)),[3,4];case 4:return[2]}}))}))},e.prototype.isSensitivityHigherThanDoc=function(e){return h(this,void 0,void 0,(function(){return g(this,(function(t){switch(t.label){case 0:return(null==e?void 0:e.labelId)?e.labelId===this.inDocLabelInfo.labelId?[2,Promise.resolve(!1)]:[4,this.getHighestDocumentSensitivityInfo([e,this.inDocLabelInfo])]:[2,Promise.resolve(!1)];case 1:return[2,t.sent().labelId!==this.inDocLabelInfo.labelId]}}))}))},e.prototype.getHighestDocumentSensitivityInfo=function(e){return h(this,void 0,void 0,(function(){var t,a,o;return g(this,(function(r){switch(r.label){case 0:if(t={labelId:n.u1,tenantId:n.u1},null===(o=i.t6.IsCopilotInBackstageMode)||void 0===o?void 0:o.call(i.t6))return(0,i.cY)("getHighestDocumentSensitivityInfo disabled in backstage mode"),[2,t];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,OfficeFirstParty.Sensitivity.getHighestSensitivityLabel(e)];case 2:return t=r.sent(),(0,i.cY)("Sensitivity info fetched for label ".concat(JSON.stringify(e),": ").concat(JSON.stringify(t))),(0,s.Zy)("HighestSensitivityLabel"),[3,4];case 3:return a=r.sent(),(0,s.mQ)("error in HighestSensitivityLabel Api : ".concat(a.message),a.code,a.stack),(0,d.Uk)(this.copilotChatRef,a.code,u.OZ.CLP_Get,this.removeCurrentContextId),(0,i.cY)("Error while fetching highest sensitivity label: ".concat(a.message,", error code: ").concat(a.code)),[3,4];case 4:return[2,t]}}))}))},e.prototype.setSensitivityLabelToHighestSensitivity=function(e){return h(this,void 0,void 0,(function(){var t;return g(this,(function(a){switch(a.label){case 0:return[4,this.getHighestDocumentSensitivityInfo(e)];case 1:return t=a.sent(),this.setInDocSensitivityLabelInfo(t),[2]}}))}))},e.prototype.getSensitivity=function(){var e,t;return{id:this.inDocLabelInfo.labelId,displayName:null!==(e=this.inDocLabelInfo.displayName)&&void 0!==e?e:"",tooltip:this.inDocLabelInfo.description,color:this.inDocLabelInfo.color,isEncrypted:this.inDocLabelInfo.encryptionType!==o.T.None,priority:null!==(t=this.inDocLabelInfo.order)&&void 0!==t?t:0}},e.prototype.setExternalDocSensitivityLabelInfo=function(e){(0,i.cY)("setting External Doc Sensitivity Label Info: ".concat(JSON.stringify(e))),this.externalDocLabelInfo.version=e.version,this.externalDocLabelInfo.labelId=e.labelId,this.externalDocLabelInfo.tenantId=e.tenantId,this.externalDocLabelInfo.isEnabled=e.isEnabled,this.externalDocLabelInfo.encryptionType=e.encryptionType,this.externalDocLabelInfo.isDke=e.isDke,this.externalDocLabelInfo.hasExtractForUser=e.hasExtractForUser,this.externalDocLabelInfo.order=e.order,this.externalDocLabelInfo.displayName=e.displayName,this.externalDocLabelInfo.description=e.description,this.externalDocLabelInfo.parentName=e.parentName,this.externalDocLabelInfo.color=e.color},e.prototype.getInDocSensitiveLabelInfo=function(){return this.inDocLabelInfo},e.prototype.getExternalDocSensitivityLabelInfo=function(){return this.externalDocLabelInfo},e.prototype.shouldShowExternalDocSensitivityLabel=function(){return(0,s.Zy)("Empty External Doc Label : ".concat(this.inDocLabelInfo.labelId===n.u1)),this.externalDocLabelInfo.labelId!==n.u1&&i.t6.IsUserTypeEnterprise()},e.prototype.shouldShowInDocSensitivityLabel=function(){return(0,s.Zy)("Empty In Doc Label : ".concat(this.inDocLabelInfo.labelId===n.u1)),this.inDocLabelInfo.labelId!==n.u1&&i.t6.IsUserTypeEnterprise()},e.prototype.isInDocSensitivityLabelEncrypted=function(){return this.inDocLabelInfo.encryptionType!==o.T.None},e.prototype.isExternalDocSensitivityLabelEncrypted=function(){return this.externalDocLabelInfo.encryptionType!==o.T.None},e}();function C(e,t,a,n){return h(this,void 0,void 0,(function(){return g(this,(function(r){switch(r.label){case 0:return(0,i.cY)("Sensitivity Label Change Event: ".concat(JSON.stringify(e)," to ").concat(JSON.stringify(t),", context:  ").concat(a,", error: ").concat(n)),(0,s.Zy)("Label change callback received, context:  ".concat(a)),p&&a===b&&(p("ignore"),p=null),n!==o.q.S_APPLYLABEL_OK?((0,s.mQ)("error in upgrading label : ".concat(n),n.code,n.stack),[2]):i.t6.IsClpEnabledInEnterpriseForSydney()&&(f.getInstance().getInDocSensitiveLabelInfo().labelId||t.labelId)?[4,f.getInstance().setSensitivityLabelToHighestSensitivity([f.getInstance().getInDocSensitiveLabelInfo(),t])]:[3,2];case 1:return r.sent(),[2];case 2:return i.t6.IsApplyLabelUsingTryUpgradeLabelEnabled(),f.getInstance().setInDocSensitivityLabelInfo(t),[2]}}))}))}},885930:(e,t,a)=>{"use strict";var n;a.d(t,{D:()=>n,J:()=>o}),function(e){e[e.None=0]="None",e[e.CellValue=1]="CellValue",e[e.ColorScale=2]="ColorScale",e[e.DataBar=3]="DataBar",e[e.IconSet=4]="IconSet",e[e.Preset=5]="Preset",e[e.TopBottom=6]="TopBottom",e[e.CustomCreated=7]="CustomCreated",e[e.Dates=8]="Dates",e[e.UniqueValue=9]="UniqueValue",e[e.TextComparison=10]="TextComparison"}(n||(n={}));class o{constructor(e=0,t,a,n,o,r,i){this.cardTitle=e,this.iconSetNumber=t,this.originalHexColors=a,this.customFormula=n,this.formulaExplanation=o,this.customFormat=r,this.dataBarFormat=i}}},888405:(e,t,a)=>{"use strict";a.d(t,{qv:()=>_,$v:()=>G,qK:()=>W});var n=a(252610),o=a(932367),r=a(754440),i=a(267324),l=a(365319),s=a(112134),c=a(680873),d=a(774370),u=a(644737),m=a(9847),h=a(83437),g=a(630079),p=a(937234),b=a(167447),f=a(715540),C=a(81051),y=a(697705),v=a(984691),x=a(477543),T=a(476730),S=a(965634),w=a(956258),E=a(235373),I=a(912477),R=a(139481);async function A(){const e=await F.create();let t;return{endCollectWorkbookChanges:async()=>(void 0===t&&(await Excel.run((async e=>{await e.sync(),await new Promise((e=>setTimeout(e,250)))})),await e.finalize(),t=e.getChanges()),t)}}class L{addEventRegistration(e){this.registeredEvents.push(e)}async unregisterEvents(){for(;this.registeredEvents.length>0;){const e=this.registeredEvents,t=e[0].context,a=[],n=[];e.forEach((e=>{e.context===t?a.push(e):n.push(e)})),this.registeredEvents=n,await Excel.run(t,(async()=>{a.forEach((e=>e.remove()))}))}}constructor(){this.registeredEvents=[]}}function k(e){const t=e=>e.referenceType===R.ss.Table;return e.reduce((({base:e,prevRangeEdit:a},n)=>(a&&t(n)&&e[e.length-1]?.operation===n.operation?(e.pop(),a=!1):a=n.referenceType===R.ss.Range,e.push(n),{base:e,prevRangeEdit:a})),{base:[],prevRangeEdit:!1}).base.reduce(((e,a)=>{const n=e[e.length-1];return n&&t(n)&&t(a)&&n.name===a.name&&n.operation===a.operation||e.push(a),e}),[])}class F{static async create(){const e=new F;return await e.initialize(),await e.registerEvents(),{getChanges:()=>e.changes,finalize:()=>e.finalize()}}async initialize(){return Excel.run({delayForCellEdit:!0},(async e=>{e.workbook.worksheets.load({id:!0,name:!0}),e.workbook.tables.load({id:!0,name:!0}),e.workbook.pivotTables.load({id:!0,name:!0,worksheet:{id:!0}}),await e.sync();for(const t of e.workbook.worksheets.items)this.worksheetInfo.set(t.id,{worksheetName:t.name});for(const t of e.workbook.tables.items)this.tableInfo.set(t.id,{name:t.name});for(const t of e.workbook.pivotTables.items)this.pivotTableInfo.set(t.id,{name:t.name,worksheetId:t.worksheet.id})}))}async finalize(){this.changes=k(this.changes),this.evtRegistrations.unregisterEvents()}updateSheetEntry(e){return Excel.run((async t=>{const a=t.workbook.worksheets.getItemOrNullObject(e).load("name");if(await t.sync(),a.isNullObject)return void this.worksheetInfo.delete(e);const n={worksheetName:a.name};return this.worksheetInfo.set(e,n),n}))}updateTableEntry(e){return Excel.run((async t=>{const a=t.workbook.tables.getItemOrNullObject(e).load("name");if(await t.sync(),a.isNullObject)return void this.tableInfo.delete(e);const n={name:a.name};return this.tableInfo.set(e,n),n}))}updatePivotTableEntry(e){return Excel.run((async t=>{const a=t.workbook.pivotTables.getItemOrNullObject(e).load({name:!0,worksheet:{id:!0}});if(await t.sync(),a.isNullObject)return void this.tableInfo.delete(e);const n={name:a.name,worksheetId:a.worksheet.id};return this.pivotTableInfo.set(e,n),n}))}getWorksheetName(e){return this.worksheetInfo.get(e)?.worksheetName??"{unknown}"}getTableName(e){return this.tableInfo.get(e)?.name??"{unknown}"}async registerEvents(){await Excel.run((async e=>{const t=e.workbook.worksheets;this.evtRegistrations.addEventRegistration(t.onAdded.add(this.handleWorksheetAdded.bind(this))),this.evtRegistrations.addEventRegistration(t.onDeleted.add((async e=>this.handleWorksheetDeleted(e)))),this.evtRegistrations.addEventRegistration(t.onNameChanged.add((async e=>this.handleWorksheetRenamed(e)))),this.evtRegistrations.addEventRegistration(t.onChanged.add((async e=>this.handleWorksheetChanged(e)))),this.evtRegistrations.addEventRegistration(e.workbook.tables.onAdded.add(this.handleTableAdded.bind(this))),this.evtRegistrations.addEventRegistration(e.workbook.tables.onDeleted.add((async e=>this.handleTableDeleted(e)))),this.evtRegistrations.addEventRegistration(e.workbook.tables.onChanged.add((async e=>this.handleTableChanged(e)))),this.evtRegistrations.addEventRegistration(e.workbook.pivotTables.onAdded.add(this.handlePivotTableAdded.bind(this))),this.evtRegistrations.addEventRegistration(e.workbook.pivotTables.onDeleted.add((async e=>this.handlePivotTableDeleted(e))))}))}async handleWorksheetAdded(e){const t=await this.updateSheetEntry(e.worksheetId);if(void 0!==t){const e={referenceType:R.ss.Sheet,operation:R.S5.Add,name:t.worksheetName};this.changes.push(e)}}handleWorksheetDeleted(e){const t=this.getWorksheetName(e.worksheetId);this.worksheetInfo.delete(e.worksheetId);const a={referenceType:R.ss.Sheet,operation:R.S5.Delete,name:t};this.changes.push(a);for(const[t,a]of this.pivotTableInfo)a.worksheetId===e.worksheetId&&this.handlePivotTableDeleted({pivotTableId:t})}handleWorksheetRenamed(e){this.worksheetInfo.set(e.worksheetId,{worksheetName:e.nameAfter});const t={referenceType:R.ss.Sheet,operation:R.S5.Rename,nameBefore:e.nameBefore,nameAfter:e.nameAfter};this.changes.push(t)}handleWorksheetChanged(e){const t={referenceType:R.ss.Range,operation:R.S5.Change,sheet:this.getWorksheetName(e.worksheetId),address:e.address,changeType:e.changeType};this.changes.push(t)}async handleTableAdded(e){const t=await this.updateTableEntry(e.tableId);if(void 0!==t){const e={referenceType:R.ss.Table,operation:R.S5.Add,name:t.name};this.changes.push(e)}}handleTableDeleted(e){const t=this.getTableName(e.tableId);this.tableInfo.delete(e.tableId);const a={referenceType:R.ss.Table,operation:R.S5.Delete,name:t};this.changes.push(a)}handleTableChanged(e){const t={referenceType:R.ss.Table,operation:R.S5.Change,name:this.getTableName(e.tableId)};this.changes.push(t)}async handlePivotTableAdded(e){const t=await this.updatePivotTableEntry(e.pivotTableId);if(void 0!==t){const e={referenceType:R.ss.PivotTable,operation:R.S5.Add,sheet:this.getWorksheetName(t.worksheetId),name:t.name};this.changes.push(e)}}handlePivotTableDeleted(e){const t=e.pivotTableId,a=this.pivotTableInfo.get(t);if(void 0!==a){this.pivotTableInfo.delete(t);const e={referenceType:R.ss.PivotTable,operation:R.S5.Delete,sheet:this.getWorksheetName(a.worksheetId),name:a.name};this.changes.push(e)}}constructor(){this.evtRegistrations=new L,this.worksheetInfo=new Map,this.tableInfo=new Map,this.pivotTableInfo=new Map,this.changes=[]}}var _,P=a(390624),N=a(797639),M=a(79458),O=a(528804),D=a(494554),B=a(940096),$=a(648870),H=a(4091),U=a(389298),q=a(936044),V=a(507628);!function(e){e[e.Success=0]="Success",e[e.PreviewUnavailable=1]="PreviewUnavailable",e[e.FailedValidation=2]="FailedValidation",e[e.InternalError=3]="InternalError",e[e.NoSuggestion=4]="NoSuggestion"}(_||(_={}));class G{async getOfficeScriptLibrary(){return(await a.e("ojsc-os-library","high").then(a.t.bind(a,887343,19))).code}async getWrapCode(e,t,n){const o=await a.e("ojsc-wrap-code","high").then(a.t.bind(a,219186,19));return this.codePrefix+o.code.replace(G.FUNCTION_TO_FIND_RETURN_VALUE,e?G.RETURN_OUTPUT_PROCESSED:G.RETURN_OUTPUT_IGNORED).replace(G.FUNCTION_TO_FIND_CODE,t).replace(G.FUNCTION_TO_FIND_PRELOADED_DATA,n)}async getWrapCodeForRawOfficeJsExecution(e){const t=await a.e("ojsc-wrap-code","high").then(a.t.bind(a,219186,19));return this.codePrefix+t.code.replace(G.FUNCTION_TO_FIND_RETURN_VALUE,G.RETURN_OUTPUT_STRINGIFIED).replace(G.FUNCTION_TO_FIND_CODE,e).replace(G.FUNCTION_TO_FIND_PRELOADED_DATA,"{}")}addCodeExplanationChatMessage(e,t,a,n,o){const r=$.n.getOfficeJsCodeExplanation(e,a,n);l.$.getInstance().displayResponse(r,o,{shouldShowWhenFluxSkillResponseRequired:!1});const i=(0,D.N)(r),s=(0,O.yw9)("OfficeVSO_9798167_SendFailureResponse");this.dispatch((0,H.nv)(i,!s||t?p.Aw.success:p.Aw.failed,o))}handleOfficeJsExecutionError(e){this.addCodeExplanationChatMessage(e,!1,(0,i.v3A)(),!1,{featureName:m.q.OfficeJsCommanding,eventType:m.a5.ErrorMessage,errorType:m.q0.OfficeJsExecutionFailed})}async onChangeAccepted(e,t,a,n,o,r,i=m.q.OfficeJsCommanding){this.dispatch(E.m.startExecutingCommand({command:m.OP.FluxReasoning,id:w.M.userQueryGuid}));let s=!1;if((0,O.IU1)())if(s=await this.applyBatches(a,r,i),s)this.dispatch(U.m.setCommandingResponseCompletion({queryId:e??"",codeCompletedSuccessfully:s,returnedMessage:void 0}));else{w.M.getInstance().logError({eventType:S.S2.OfficeJsOperations,errorMessage:"Apply on original workbook failed after Scratchpad validation succeeded",logLevel:h.$b.ASHA});const e=$.n.getOfficeJsApplicationFailure(a);l.$.getInstance().displayResponse(e.message,e.telemetry)}else s=await this.executeOfficeJs(e,t,a,!0,n,o);return await this.dispatch((0,H.L4)()),s}async applyBatches(e,t,a=m.q.OfficeJsCommanding){let n=!0;this.dispatch(E.m.startExecutingCommand({command:(0,O.yw9)("OfficeVSO_9687963_ShowChartChangesResponse")&&a===m.q.ChartDesignRecommendations?m.OP.ChartDesignRecommendations:m.OP.Commanding})),await(0,P.$r)((0,i.Eyh)()),N.CP.lockContextRefresh();try{if(!t)throw new Error("Missing processor: applyBatches requires a RichApiBatchProcessor.");await t.applyBatches()}catch(e){n=!1,(0,M.cY)(String(e))}if(N.CP.releaseContextLock(),await(0,P.TA)(),n){const{message:e,telemetry:t}=$.n.getOfficeJsGenericSuccess(!0,this.explainOfficeJsResult,void 0,void 0,a);l.$.getInstance().displayResponse(e,t);const n=(0,D.N)(e);this.dispatch((0,H.nv)(n,p.Aw.success,t))}else await(0,P.tN)(),this.handleOfficeJsExecutionError(e);return n}async validateOfficeJs(e,t,a,o,r,i){T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.CommandScratchpadValidateOfficeJsCalled},w.M.getInstance()),this.dataLocale=this.dataLocale||this.dispatch((0,B.Z)()).dataLocale;try{const t=await i??{},d=await this.getWrapCode(o,e,JSON.stringify(t));await this.runtimeHelper.prepareCustomParams(d,await this.getOfficeScriptLibrary(),r.makeBatchHandler()),await new Promise(((e,t)=>{const a=setTimeout((()=>{n(),t(new Error(G.ERROR_STRING_TIMEOUT))}),G.MAX_RUN_TIME),n=()=>{this.runtimeHelper.terminateCurrentRun(),clearTimeout(a);const e=new x.g0({parentPath:["Signal",s.dx.getTypeName()],items:[{id:g.r.generateId(),body:new s.dx({caller:"OfficeJsCommanding",requestId:(0,V.A)(),dataLocale:this.dataLocale})}]});try{l.$.getInstance().submitOperation({operation:e,workflowAnnotationType:c.Wh.getTypeName()})}catch(e){w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"New Session Error: "+JSON.stringify(e),logLevel:h.$b.ASHA}),this.logOfficeJsAshaError(new Error(G.ERROR_STRING_START_NEW_SESSION_FAILURE))}};this.runtimeHelper.executeScript().then((a=>{n(),"string"==typeof a||void 0===a?e(null):(w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"Error in response: "+JSON.stringify(this.stripFullStatementsFromRuntimeErrors(a)),logLevel:h.$b.ASHA}),t(a))})).catch((e=>{n(),w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"OfficeJs Internal Error: "+JSON.stringify(e),logLevel:h.$b.ASHA}),t(new Error(G.ERROR_STRING_SCRATCHPAD_OFFICE_JS_INTERNAL_ERROR))}))}));const u=r.getApiCalls();if((0,M.cY)("[1mAPI Call Summary:[0m",JSON.stringify(u)),u){const e=n.i.generateDescription(u);if(e.header){a.summary=e.header;const t=[];let n=0;for(const a of e.descriptions)t.push({title:a.scope,content:a.change}),a.change.length>n&&(n=a.change.length);a.expandableListItems=t,T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.CommandScratchpadHitlDescriptionTelemetry,[v.h3.ChatEventParameters]:JSON.stringify({changeListLength:t.length,longestDescriptionLength:n})},w.M.getInstance())}return!0}(0,M.cY)("[1mAPI Call failed[0m")}catch(e){this.logOfficeJsAshaError(e)}return this.handleOfficeJsExecutionError(t),!1}async executeOfficeJsRaw(e){await this.loadRawOfficeJsScriptIntoRuntime(e);const{returnResult:t,documentChanges:a}=await N.CP.runWithNoContextRefresh((()=>async function(e){try{return await t(e)}catch(e){throw await(0,P.tN)(m.q.Unset),e}async function t(e){await(0,P.$r)((0,i.Eyh)());try{return await e()}finally{await(0,P.TA)()}}}((()=>async function(e,t){const a=await A();try{const n=await e();return t(n,await a.endCollectWorkbookChanges())}finally{await a.endCollectWorkbookChanges()}}((()=>async function(e){let[t,a]=function(){let e=()=>{};const t=new Promise(((t,a)=>{const n=setTimeout((()=>{a(new d.f(G.ERROR_STRING_TIMEOUT))}),G.MAX_RUN_TIME);e=()=>clearTimeout(n)}));return[t,e]}();return t=t.catch((t=>{throw e.terminateCurrentRun(),t})),Promise.race([t,e.executeScript()]).finally(a)}(this.runtimeHelper)),((e,t)=>({returnResult:n(e),documentChanges:t})))))));return{returnResult:t,documentChanges:a,excelDocumentContext:await N.CP.getContextString(w.M.userQueryGuid)};function n(e){if("string"==typeof e||void 0===e)return e;throw function(e){let t="";t="object"==typeof e&&!Array.isArray(e)&&null!==e&&"error"in e?JSON.stringify(e.error):"createFromScriptResponse: Unknown error";return w.M.getInstance().logError({eventType:S.S2.ChatEvents,errorMessage:t,logLevel:h.$b.Error}),new d.f(t)}(e)}}async validateOfficeJsChartRecommendation(e,t,a,i,l,s,c,d,u,g){(0,M.cY)(`Api result Code is: ${t}`),T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsValidateOfficeJSResultCalled,[v.h3.ChatEventParameters]:JSON.stringify({chartId:s,index:e})},w.M.getInstance()),this.dataLocale=this.dataLocale||this.dispatch((0,B.Z)()).dataLocale;try{const a=await u??{},p=await this.getWrapCode(i,t,JSON.stringify(a));await this.runtimeHelper.prepareCustomParams(p,await this.getOfficeScriptLibrary(),l.makeBatchHandler());let b="",f=[];await new Promise(((t,a)=>{const n=setTimeout((()=>{i(),a(new Error(G.ERROR_STRING_TIMEOUT))}),G.MAX_RUN_TIME),i=()=>{this.runtimeHelper.terminateCurrentRun(),clearTimeout(n)};this.runtimeHelper.executeScript().then((n=>{if("string"==typeof n||void 0===n)this.triggerChartRecommendationSignal(((e,a)=>{i();let n=0;if(""===e){n=1;const e="[ChartDesignRecommendations]: Chart scene graph is empty.";(0,M.cY)(a?`${e} Error code: ${a}`:e),w.M.getInstance().logError({eventType:S.S2.ChartDesignRecommendations,errorMessage:a?`${e} Error code: ${a}`:e,logLevel:h.$b.ASHA}),w.M.getInstance().logStandardizedAshaErrorEvent(r.W.Unable_To_Complete_Task,o.c.ChartDesignRecommendationsEmptySceneGraph,m.BJ.ChartDesignRecommendations)}g?.(n,e,b,f),t(null)}),e,s,c,d),t(null);else{w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"[ChartDesignRecommendations]: Error in response: "+JSON.stringify(this.stripFullStatementsFromRuntimeErrors(n)),logLevel:h.$b.ASHA});const e="object"==typeof n&&null!==n&&"error"in n&&500!==n.error?.httpStatusCode?2:3;g?.(e,"",b,f),(0,M.cY)("[ChartDesignRecommendations]: validateOfficeJsChartRecommendation: "+JSON.stringify(this.stripFullStatementsFromRuntimeErrors(n))),a(n),i()}})).catch((e=>{i(),w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"[ChartDesignRecommendations]: OfficeJs Internal Error: "+JSON.stringify(e),logLevel:h.$b.ASHA});g?.(3,"",b,f),(0,M.cY)("[ChartDesignRecommendations]: validateOfficeJsChartRecommendation: "+JSON.stringify(this.stripFullStatementsFromRuntimeErrors(e))),a(new Error(G.ERROR_STRING_SCRATCHPAD_OFFICE_JS_INTERNAL_ERROR))}))}));const C=l.getApiCalls();if((0,M.cY)("[1mAPI Call Summary:[0m",JSON.stringify(C)),C){const t=n.i.generateDescription(C);if(t.header){b=t.header;const a=[];for(const e of t.descriptions)a.push({title:e.scope,content:e.change});T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsScratchpadHitlDescriptionTelemetry,[v.h3.ChatEventParameters]:JSON.stringify({chartId:s,index:e,changeListLength:a.length})},w.M.getInstance()),f=a}}return!0}catch(e){(0,M.cY)(JSON.stringify(e)),w.M.getInstance().logError({eventType:S.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: OfficeJs Internal Error: "+JSON.stringify(e),logLevel:h.$b.ASHA}),this.logOfficeJsAshaError(e,!0)}return this.handleOfficeJsExecutionError(a),!1}async executeOfficeJs(e,t,a,n,o,r){this.dispatch(E.m.startExecutingCommand({command:m.OP.Commanding})),I.MK.editStarted(e);let s=!1;try{await(0,P.$r)((0,i.Eyh)());const c=await r??{},d=await this.getWrapCode(o,t,JSON.stringify(c));await this.runtimeHelper.prepareCustomParams(d,await this.getOfficeScriptLibrary()),await new Promise(((t,o)=>{const r=setTimeout((()=>{c(),o(new Error(G.ERROR_STRING_TIMEOUT))}),G.MAX_RUN_TIME),c=()=>{N.CP.releaseContextLock(),this.runtimeHelper.terminateCurrentRun(),clearTimeout(r)};N.CP.lockContextRefresh(),this.runtimeHelper.executeScript().then((async r=>{if(c(),"string"==typeof r){s=!0;const{message:e,telemetry:t}=$.n.getOfficeJsGenericSuccess(n,this.explainOfficeJsResult,r,a);l.$.getInstance().displayResponse(e,t);const o=(0,D.N)(e);this.dispatch((0,H.nv)(o,p.Aw.success,t))}else if(void 0!==r)o(r);else if(!n&&a.length)s=!0,this.addCodeExplanationChatMessage(a,s,(0,i.DSt)(),n,{featureName:m.q.OfficeJsCommanding,eventType:m.a5.ActionConfirmationMessage});else{s=!0;const{message:e,telemetry:t}=$.n.getOfficeJsGenericSuccess(n,this.explainOfficeJsResult);l.$.getInstance().displayResponse(e,t);const a=(0,D.N)(e);this.dispatch((0,H.nv)(a,p.Aw.success,t))}s&&await(0,P.TA)(),this.dispatch(U.m.setCommandingResponseCompletion({queryId:e??"",codeCompletedSuccessfully:s,returnedMessage:"string"==typeof r?r:void 0})),I.MK.editFinished(e,m.q.OfficeJsCommanding,s,r),t(null)})).catch(o)}))}catch(t){this.handleOfficeJsExecutionError(a),this.logOfficeJsAshaError(t),I.MK.editFinished(e,m.q.OfficeJsCommanding,!1,t)}return s}async logOfficeJsAshaError(e,t=!1){if((0,O.yw9)("OfficeVSO_8814792_LogAshaCommandingTelemetry")){let a,n;const i=e;i.errorCode===G.ERROR_STRING_ACCESS_DENIED?(a=r.W.Unable_To_Complete_Task,n=o.c.Failed_Command_Execution_Due_To_Protection_Settings):i.message===G.ERROR_STRING_TIMEOUT?(a=r.W.Response_Delayed_Or_Timed_Out,n=o.c.Command_Execution_Took_Too_Long):i.message===G.ERROR_STRING_START_NEW_SESSION_FAILURE?(a=r.W.Unable_To_Complete_Task,n=o.c.Command_Scratchpad_Start_New_Session_Failed):i.message===G.ERROR_STRING_SCRATCHPAD_OFFICE_JS_INTERNAL_ERROR?(a=r.W.Unable_To_Complete_Task,n=o.c.Command_Scratchpad_Office_Js_Internal_Error):(0,O.IU1)()&&i.error?.name===G.ERROR_STRING_RICH_API_FAILURE_NAME?(a=r.W.Unable_To_Complete_Task,n=i.error?.code===G.ERROR_STRING_RICH_API_BATCH_SAFETY_FAILURE_CODE&&i.error?.message===G.ERROR_STRING_RICH_API_BATCH_SAFETY_FAILURE_Message?o.c.Command_Scratchpad_Non_Copilot_Safe_Apis_Generated:o.c.Command_Scratchpad_Office_Js_Execution_Failed_In_Runtime):(a=r.W.Unclassified_Chat_Failure,n=o.c.Failed_Command_Execution_Due_To_Other_Error),w.M.getInstance().logStandardizedAshaErrorEvent(a,n,t?m.BJ.ChartDesignRecommendations:m.BJ.Commanding)}}async handleOfficeJsResult(e,t){this.dispatch(U.m.setCommandingResponse({queryId:e,response:t})),I.MK.reachedSkillExecutor(e,m.q.OfficeJsCommanding,t);const{code:a,canMakeChanges:n,returnsValue:o,apiUsageMetadata:r}=t;let i;i=(0,O.IU1)()&&0===t.codeExplanation.trim().length?[]:t.codeExplanation.split("\n").map((e=>e.replace("-  ","")));let s=!1;if(n){const t=Excel.run((async e=>{let t=!1;const a=e.workbook,{setsTableName:n,setsWorksheetName:o,setsPivotTableName:i,setsTableStyleName:l,setsPivotTableStyleName:s,setsSlicerStyleName:c,setsTimelineStyleName:d}=r,u=[{name:"tableNames",needed:n,collection:a.tables},{name:"worksheetNames",needed:o,collection:a.worksheets},{name:"pivotTableNames",needed:i,collection:a.pivotTables},{name:"tableStyleNames",needed:l,collection:a.tableStyles},{name:"pivotTableStyleNames",needed:s,collection:a.pivotTableStyles},{name:"slicerStyleNames",needed:c,collection:a.slicerStyles},{name:"timelineStyleNames",needed:d,collection:a.timelineStyles}];for(const{needed:e,collection:a}of u)e&&(t=!0,a.load("items/name"));t&&await e.sync();const m={};for(const{name:e,needed:t,collection:a}of u)t&&(m[e]=a.items.map((e=>e.name)));return m}));if((0,O.IU1)()){const n=(0,C.L)(i);0===i.length&&(n.isNotAvailable=!0,w.M.getInstance().logError({eventType:S.S2.CommandingError,errorMessage:"Unable to generate code explanation",logLevel:h.$b.ASHA}));const r=new b.p(this.dataLocale||"en-us","OfficeJsCommanding"),{message:s,telemetry:c}=$.n.getOfficeJsInitialCodeExplanation(e,a,i,n,o,this,t,r);l.$.getInstance().displayResponse(s,c);const d=performance.now(),g=await this.validateOfficeJs(a,i,n,o,r,t);T.E.getInstance().logLatency(performance.now()-d,m.OP.CommandScratchpadValidateOfficeJsCompleted,g,m.q.OfficeJsCommanding),g?(n.isLoading=!1,(0,u.s_)(u.H0.EnableApply)):n.isNotAvailable=!0}else{const{message:n,telemetry:r}=$.n.getOfficeJsChangeWarning(e,a,i,o,this,t);l.$.getInstance().displayResponse(n,r);const s=(0,D.N)(n);this.dispatch((0,H.nv)(s,p.Aw.success,r))}}else s=await this.executeOfficeJs(e,a,i,n,o);return await this.dispatch((0,H.L4)()),s}async loadRawOfficeJsScriptIntoRuntime(e){const t=e.match(/await\s+Excel\.run\s*\(((?:.|\n)*?)\);?(?:\s|\n)*$/);if(!t){const e="OfficeJS code not in expected format";throw w.M.getInstance().logError({eventType:S.S2.ChatEvents,errorMessage:e,logLevel:h.$b.Error}),new d.f(e)}const a=t[1],n=await this.getWrapCodeForRawOfficeJsExecution(`async function main(__workbook) { return (${a})(__workbook.engine.context);}`);await this.runtimeHelper.prepareCustomParams(n,await this.getOfficeScriptLibrary())}async handleChartDesignNoRecommendationResult(){let e=!1;if((0,O.IU1)()){const t=[];for(let e=1;e<=4;e++)t.push({id:e,resultType:4,scenegraphJSON:"",code:"",codeExplanation:[],summary:"",expandableListItems:[]});l.$.getInstance().onChartNewRecommendationAvailable(t,!0),e=!0}return await this.dispatch((0,H.L4)()),e}async handleChartDesignRecommendationResult(e,t,a,n,o){const r=performance.now();let i=!1;if((0,O.IU1)()){const s=Promise.resolve({}),c=[];let d=0;const u=async(t,n,o,r,i,l,c,d,u,h)=>{y.B.getInstance().logKeptEvent(m.BJ.ChartDesignRecommendations,m.q.ChartDesignRecommendations,v.RX.Create);const g=await this.onChangeAccepted(e,o,r,!1,s,i,m.q.ChartDesignRecommendations);T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsSuggestionApplied,[v.h3.ChatEventParameters]:JSON.stringify({chartId:a,previewClickCount:n,chartIndex:t,success:g,isChartTypeChanged:l,isDarkMode:c,colorPaletteId:d,isTitleLeftAligned:u,isDataSourceRangeChanged:h})},w.M.getInstance())},h=async()=>{const e=t[d];e.officeJSCode=e.officeJSCode.replaceAll("(await seriesCollection.getItems())","seriesCollection");const g=new b.p(this.dataLocale||"en-us","OfficeJsChartDesignRecommendations");l.$.getInstance().onChartRecommendationPreprocessing(d,t.length);const p=performance.now();i=await this.validateOfficeJsChartRecommendation(d,e.officeJSCode,e.description.split("\n"),!1,g,a,n,o,s,(async(a,n,o,i)=>{if(c.push({id:d+1,resultType:a,scenegraphJSON:n,code:e.officeJSCode,codeExplanation:e.description.split("\n"),isChartTypeChanged:e.isChartTypeChanged,isDarkMode:e.isDarkMode,colorPaletteId:e.colorPaletteId,isTitleLeftAligned:e.isTitleLeftAligned,isDataSourceRangeChanged:e.isDataSourceRangeChanged,summary:o,expandableListItems:i,batchProcessor:g}),0===d?l.$.getInstance().onChartNewRecommendationAvailable(c,!1,u):l.$.getInstance().onChartNewRecommendationAvailable(c,3===d),++d<t.length)await h();else{for(let e=d;e<4;e++)c.push({id:e+1,resultType:4,scenegraphJSON:"",code:"",codeExplanation:["No recommendation available"],summary:"",expandableListItems:[]}),l.$.getInstance().onChartNewRecommendationAvailable(c,3===e);y.B.getInstance().logSeenEvent(m.BJ.ChartDesignRecommendations,m.q.ChartDesignRecommendations,v.RX.Create),T.E.getInstance().logLatency(performance.now()-r,m.OP.ChartDesignRecommendationsResponseCardShown,!0,m.q.ChartDesignRecommendations),W("OfficeJsChartDesignRecommendations",this.dataLocale||"en-us")}})),T.E.getInstance().logLatency(performance.now()-p,m.OP.ChartDesignRecommendationsScratchpadValidateOfficeJsCompleted,i,m.q.ChartDesignRecommendations)};await h()}return await this.dispatch((0,H.L4)()),i}stripFullStatementsFromRuntimeErrors(e){return e?.error?.debugInfo?.fullStatements&&delete e.error.debugInfo.fullStatements,e}constructor(e){this.dispatch=e,this.codePrefix="",this.explainOfficeJsResult=e=>{this.addCodeExplanationChatMessage(e,!0,(0,i.KVc)(),!1,{featureName:m.q.OfficeJsCommanding,eventType:m.a5.ActionConfirmationMessage})},this.triggerChartRecommendationSignal=async(e,t,a,n,o)=>{T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsChartRecommendationSignalTriggered,[v.h3.ChatEventParameters]:JSON.stringify({chartId:a,index:t})},w.M.getInstance());const r=(0,V.A)(),i=(0,O.yw9)("OfficeVSO_10396995_UseVisibleObserverForCharting"),l=new x.g0({parentPath:["Signal",s.uv.getTypeName()],items:[{id:g.r.generateId(),body:new s.uv({caller:"OfficeJsCommanding",requestId:r,chartId:a,chartName:n,worksheetId:o,...i&&{useVisibleObserver:!0}})}]});try{const n=performance.now();e((await(0,q.T)(l,r,S.S2.CommandingScratchpad,m.OP.Commanding,c.fm.getTypeName())).chartSceneGraph,""),T.E.getInstance().updateTelemetryChatEventData({[v.h3.ChatEventType]:m.a5.ChartDesignRecommendationsChartRecommendationSignalCompleted,[v.h3.ChatEventParameters]:JSON.stringify({chartId:a,index:t})},w.M.getInstance()),T.E.getInstance().logLatency(performance.now()-n,m.OP.ChartDesignRecommendationsChartScenegraphGenerationCompleted,!0,m.q.ChartDesignRecommendations)}catch(t){const a=t.error?.errorCode;throw e("",a),(0,M.cY)(String(t)),w.M.getInstance().logError({eventType:S.S2.ChartDesignRecommendations,errorMessage:"[ChartDesignRecommendations]: ChartRecommendationSignal Error: "+JSON.stringify(t),logLevel:h.$b.ASHA}),this.logOfficeJsAshaError(t,!0),new Error("[ChartDesignRecommendations]: triggerChartRecommendationSignal Error: "+JSON.stringify(t))}},this.runtimeHelper=f.b.instance(),(0,O.usH)()&&(this.codePrefix="OfficeExtension.config.extendedErrorLogging = true;\n")}}function W(e,t,a=!1){const n=new x.g0({parentPath:["Signal",s.dx.getTypeName()],items:[{id:g.r.generateId(),body:new s.dx({caller:e,requestId:(0,V.A)(),dataLocale:t,useVisibleObserver:a})}]});try{l.$.getInstance().submitOperation({operation:n,workflowAnnotationType:c.Wh.getTypeName()})}catch(e){w.M.getInstance().logError({eventType:S.S2.CommandingScratchpad,errorMessage:"New Session Error: "+JSON.stringify(e),logLevel:h.$b.ASHA})}}G.MAX_RUN_TIME=6e4,G.FUNCTION_TO_FIND_RETURN_VALUE="function toFindReturnValue(){}",G.FUNCTION_TO_FIND_CODE="async function main(){}",G.FUNCTION_TO_FIND_PRELOADED_DATA="function toFindPreloadedData(){}",G.RETURN_OUTPUT_PROCESSED=["(r) => {","if(r===undefined||r===null)return undefined;","if(Array.isArray(r)){","let lines='';","for(const l of r){","if(typeof l==='object')return;","lines+=l.toString()+'\\n';","}","return lines.trim();","}","if(typeof r==='object')return;","return r.toString();","}"].join(""),G.RETURN_OUTPUT_STRINGIFIED="(r) => (r == null) ? undefined : JSON.stringify(r)",G.RETURN_OUTPUT_IGNORED="r=>undefined",G.ERROR_STRING_TIMEOUT="Timeout",G.ERROR_STRING_START_NEW_SESSION_FAILURE="ExcelScratchpadStartNewSession Failure",G.ERROR_STRING_SCRATCHPAD_OFFICE_JS_INTERNAL_ERROR="Scratchpad OfficeJS Internal Failure",G.ERROR_STRING_ACCESS_DENIED="AccessDenied",G.ERROR_STRING_RICH_API_BATCH_SAFETY_FAILURE_CODE="AccessDenied",G.ERROR_STRING_RICH_API_FAILURE_NAME="RichApi.Error",G.ERROR_STRING_RICH_API_BATCH_SAFETY_FAILURE_Message="You cannot perform the requested operation."},888810:(e,t,a)=>{"use strict";a.d(t,{A:()=>o});var n=a(691097);function o(){return(0,n.P)("AudienceGroup")}},893763:(e,t,a)=>{"use strict";a.d(t,{Dd:()=>u,UP:()=>i,VD:()=>p,WD:()=>h,iG:()=>b,ip:()=>f,j4:()=>s,m2:()=>c,sF:()=>g,tF:()=>d,tJ:()=>n,vb:()=>o});var n,o,r,i,l=a(632512);class s extends Error{constructor(e,t){super(e),this.isOnlyUnsupportedEventsError=!0,this.unsupportedTypes=t}}class c extends Error{constructor(e){super(e),this.isMultipeEventsExecutionError=!0}}!function(e){e.General="General",e.ColumnRowOutOfBoundary="ColumnRowOutOfBoundary",e.ColumnRowBySelection="ColumnRowBySelection",e.ConditionalFormatFormulaInvalid="conditionalFormatFormulaInvalid",e.ConditionalFormatFormulaExplanationInvalid="conditionalFormatFormulaExplanationInvalid",e.ClearSortUnsupported="ClearSortUnsupported",e.NoColumnArgument="NoColumnArgument",e.ColorDistanceExceededThreshold="ColorDistanceExceededThreshold",e.DeleteUnexpectedTableRows="DeleteUnexpectedTableRows",e.DeleteWithInsertColumns="DeleteWithInsertColumns",e.MultipleTableStructureChanges="MultipleTableStructureChanges",e.NoActiveTable="NoActiveTable",e.NoSupportedNumberFormatCategoriesNumber="NoSupportedNumberFormatCategoriesNumber",e.NoSupportedNumberFormatCategoriesDate="NoSupportedNumberFormatCategoriesDate",e.NoSupportedNumberFormatCategoriesText="NoSupportedNumberFormatCategoriesText",e.NoSupportedNumberFormatCategoriesOther="NoSupportedNumberFormatCategoriesOther",e.NoVisibleRange="NoVisibleRange",e.NumericFilterOnNonNumberError="NumericFilterOnNonNumberError",e.TextualFilterOnNonTextError="TextualFilterOnNonTextError",e.VariableCacheEntityTypeMismatched="VariableCacheEntityTypeMismatched"}(n||(n={}));class d extends Error{constructor(e,t,a,n){super(e),this.isConverterError=!0,this.property=t,this.failureType=a??"General",this.dataFields=n}}!function(e){e.ArgumentUndefined="ArgumentUndefined",e.ArgumentTypeUndefined="ArgumentTypeUndefined",e.ArgumentValueUndefined="ArgumentValueUndefined",e.ArgumentTypeMismatch="ArgumentTypeMismatch"}(o||(o={}));class u extends Error{constructor(e,t,a,n){super(e),this.isStatementArgumentError=!0,this.reason=t,this.argumentType=a,this.expectedType=n}}!function(e){e.EmptyEntityArray="EmptyEntityArray",e.UnsupportedArguments="UnsupportedArguments",e.NoMatchedArguments="NoMatchedArguments",e.Unknown="Unknown"}(r||(r={}));class m extends Error{constructor(e,t,a,n){super(`No event generate for statement: ${e}.`),this.isNoEventGeneratedError=!0,this.statementName=e,this.argumentNames=Object.keys(t),this.reason=a,this.unsupportedArgumentTypes=n}}class h extends Error{constructor(e){super(e),this.isExecutorError=!0}}!function(e){e.General="General",e.MissingIntent="MissingIntent",e.NoActiveTable="NoActiveTable"}(i||(i={}));class g extends Error{constructor(e,t){super(e),this.isHumanInTheLoopError=!0,this.failureType=t??"General"}}function p(e,t,a,n=!1){throw 0===t?new m(e.name,e.arguments,"EmptyEntityArray"):a.length>0?new m(e.name,e.arguments,"UnsupportedArguments",a):new m(e.name,e.arguments,n?"NoMatchedArguments":"Unknown")}function b(e){return e.isStatementArgumentError||e.isOnlyUnsupportedEventsError||e.isConverterError||e.isStatementArgumentError||e.isNoEventGeneratedError||e.isExecutorError||e.isHumanInTheLoopError}function f(e){return e instanceof l.u&&e.errorCode===l.O.PayloadSizeError}},904182:(e,t,a)=>{"use strict";a.d(t,{O:()=>d});var n=a(182755),o=a(46692),r=a(12163),i=a(83437),l=function(){return l=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var o in t=arguments[a])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},l.apply(this,arguments)},s=function(e,t,a){if(a||2===arguments.length)for(var n,o=0,r=t.length;o<r;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))},c=function(){function e(){}return e.prototype.sendTelemetryEvent=function(e){"undefined"!=typeof Office&&Office.sendTelemetryEvent(e)},e}(),d=function(){function e(){this.alwaysCriticalEvents=null,this.oTelLogger=new n.M,this.telemSink=new c,this.setupTelemetryLogger(this.oTelLogger)}return e.prototype.getDefaultEventFlags=function(){return{dataCategories:o.o.DataCategories.ProductServicePerformance|o.o.DataCategories.ProductServiceUsage,diagnosticLevel:o.o.DiagnosticLevel.RequiredServiceData}},e.prototype.getTelemetrySink=function(){return this.telemSink},e.prototype.sendTelemetryEvent=function(e){this.isAlwaysCriticalEvent(e)&&(e.eventFlags.samplingPolicy=o.o.SamplingPolicy.CriticalUsage),this.oTelLogger.sendTelemetryEvent(e)},e.prototype.logEvent=function(e,t){this.logTelemetryEvent(e,t)},e.prototype.logUncaughtException=function(e){var t=[],a="";e instanceof Error&&(e.message&&(a=e.message),e.stack&&t.push({key:"Stack",value:e.stack})),this.logTelemetryErrorEvent({eventType:i.S2.UncaughtException,errorMessage:a,logLevel:i.$b.Critical},void 0,t)},e.prototype.logError=function(e,t,a){this.logTelemetryErrorEvent(e,t,a)},e.prototype.isAlwaysCriticalEvent=function(e){return!1},e.prototype.getTelemetryProperties=function(){return{ariaTenantToken:e.AriaTenantToken,nexusTenantToken:e.NexusTenantToken}},e.prototype.getDefaultEventDataFields=function(){return this.getDataFields(this.getDefaultTelemetryData())},e.prototype.getDefaultTelemetryData=function(){return[{key:"UserQueryGuid",value:e.userQueryGuid}]},e.prototype.logTelemetryEvent=function(e,t){var a={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.ActionAI."+e.eventType,eventFlags:t?l(l({},t),this.getDefaultEventFlags()):this.getDefaultEventFlags(),dataFields:s(s([],this.getDefaultEventDataFields(),!0),this.getDataFields(e.eventData||[]),!0)};this.sendTelemetryEvent(a)},e.prototype.getActionAITelemetryErrorEvent=function(e,t,a){return a||(a=[]),a.find((function(e){return"Message"===e.key}))||a.push({key:"Message",value:e.errorMessage}),a.find((function(e){return"LogLevel"===e.key}))||a.push({key:"LogLevel",value:e.logLevel}),{eventName:"Office.Voice.ActionAI."+i.S2.Error,error:{errorGroup:e.eventType,tag:0},eventFlags:t?l(l({},this.getDefaultEventFlags()),t):this.getDefaultEventFlags(),dataFields:s(s([],this.getDefaultEventDataFields(),!0),this.getDataFields(a),!0)}},e.prototype.logTelemetryErrorEvent=function(e,t,a){this.oTelLogger.sendError(this.getActionAITelemetryErrorEvent(e,t,a))},e.prototype.getDataFields=function(e){return e.map((function(e){return"number"==typeof e.value?(0,r.ip)(e.key,e.value):"string"==typeof e.value?(0,r.m9)(e.key,e.value):"boolean"==typeof e.value?(0,r.LK)(e.key,e.value):(0,r.m9)(e.key,String(e.value))}))},e.prototype.setupTelemetryLogger=function(t){t.setTenantToken("Office.Voice.ActionAI",e.AriaTenantToken,e.NexusTenantToken),t.setTenantToken("Office.Voice.Copilot",e.AriaTenantToken,e.NexusTenantToken),t.addSink(this.telemSink)},e.prototype.getLogLevelForErrorCategory=function(e){return i.$b.Error},e.AriaTenantToken="9783945ebc2b468fbb8a2890cdab903b-787355a5-74c8-4a89-b06a-9c82635d75fa-7162",e.NexusTenantToken=1763,e.userQueryGuid="",e.userQueryOrder=0,e.conversationId=void 0,e}()},906606:(e,t,a)=>{"use strict";a.d(t,{D0:()=>ae,fx:()=>st,XT:()=>Fe,H7:()=>ze,xQ:()=>De,CQ:()=>Ve,ge:()=>Ae,MN:()=>Be,oR:()=>Oe,QF:()=>We,Dz:()=>Ee,cQ:()=>je,aM:()=>Ge,m:()=>Ue,Vy:()=>Me,o4:()=>Ce,vW:()=>rt,at:()=>at,AR:()=>Qe,eS:()=>Je,z$:()=>pt,f0:()=>gt,A4:()=>ke,gG:()=>ft,Nn:()=>Pe,tP:()=>_e,VW:()=>He,v:()=>$e,Om:()=>ot,b9:()=>bt,GL:()=>be,Wc:()=>fe,mI:()=>ht});var n=a(267324),o=a(632512),r=a(932367),i=a(754440),l=a(365319),s=a(140280),c=a(397646),d=a(449650),u=a(255448),m=a(277718),h=a(832343),g=a(287761),p=a(547131),b=a(9847),f=a(83437),C=a(707314),y=a(78160),v=a(630079),x=a(699302),T=a(937234),S=a(697705),w=a(677871),E=a(984691),I=a(477543),R=a(755005),A=a(476730),L=a(965634),k=a(956258),F=a(173339),_=a(47262),P=a(401227),N=a(299512),M=a(974717),O=a(750927);const D=e=>{switch(e){case"Map":return(0,n.WpK)();case"ScatterChart":return(0,n.mnG)();case"ClusteredComboChart":return(0,n.Muj)();case"StackedComboChart":return(0,n.yMF)();case"HundredPercentComboChart":return(0,n.$Eq)();case"FunnelChart":return(0,n.YWO)();case"Treemap":return(0,n.OJx)();case"SunburstChart":return(0,n.etO)();case"ColorFilledMap":return(0,n.XsD)();case"CircularTreemap":return(0,n.q7F)();case"HeatMap":return(0,n.jdI)();case"WaterfallChart":return(0,n.iVS)();case"RoseChart":return(0,n.r9E)();case"NetworkMap":return(0,n.Tg4)();case"SmoothLineChart":return(0,n.FIy)();case"ComboChart":return(0,n.ICT)();case"LineChart":return(0,n.Kc4)();case"PieChart":return(0,n.gGJ)();case"DonutChart":return(0,n.K2I)();case"AreaChart":return(0,n.nuZ)();case"StackedArea":return(0,n.brP)();case"HundredPercentStackedArea":return(0,n.M_y)();case"ClusteredBarChart":return(0,n.vdP)();case"StackedBarChart":return(0,n.t3j)();case"HundredPercentStackedBarChart":return(0,n.koJ)();case"ClusteredColumnChart":return(0,n.KCq)();case"StackedColumnChart":return(0,n.Kve)();case"HundredPercentStackedColumnChart":return(0,n.hIB)();default:return(0,n.HRg)()}};var B=a(235373),$=a(357781),H=a(805027),U=a(797639),q=a(303943),V=a(348065),G=a(703227),W=a(69284),z=a(79458),j=a(528804);function Q(e){return{table:{orientation:"columnMajor",headerRowCount:1,headerColumnCount:0},useOnlyFields:e.visibleColumns}}function J(e){return{topLeft:{row:e.top-1,column:e.left-1},bottomRight:{row:e.bottom-1,column:e.right-1}}}var Y=a(590572),X=a(494554),Z=a(935785),K=a(270750);var ee=a(14086);function te(e){return-1===e.indexOf("!")?d.ExcelCalc.addressToExcelRange(e):d.ExcelCalc.addressToExcelRange(d.ExcelCalc.localAddressesFromSheetAddresses(e))}var ae,ne=a(522667),oe=a(162134),re=a(940096),ie=a(991869),le=a(64292),se=a(4091),ce=a(893763),de=a(804672),ue=a(495501),me=a(390624),he=a(507628);!function(e){e.Chart="Chart",e.Table="Table",e.Sheet="Sheet"}(ae||(ae={}));const ge="I don't find any suggestions",pe=2e6,be=e=>async(t,a)=>{const{activeTable:n,lastActiveTable:o}=a().selection;!(0,j.geU)()&&e&&(n&&n.name!==e.name||!n&&o?.name!==e.name)&&((0,j.ZAR)()&&U.CP.getHasTFCDeliveredQueryResult()||t((0,se.Nl)())),t(p.m.setActiveTable(e))},fe=e=>async t=>{const{type:a,table:n}=e;if(a!==R.lp.Range)try{await t(Se(n.name))}catch(e){e instanceof Error&&e.message===o.O.GetInterpretationsFailed?k.M.getInstance().logErrorCode(o.O.GetInterpretationsFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA):k.M.getInstance().logErrorCode(o.O.GetNLContextFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA)}},Ce=e=>async(t,a)=>{const{activeTable:n,lastActiveTable:o}=a().selection;n&&n.name===e?(t(p.m.setSelectionError("NOTHING_SELECTED")),t(p.m.clearTable(n.name)),t(p.m.setActiveTable(void 0))):(o&&o.name===e&&t(p.m.removeLastActiveTable()),t(p.m.clearTable(e)),t((0,se.YS)()))};function ye(e){return{data:{valueRows:e.values,formatRows:(0,H.vc)(e.formats),formatLocalRows:(0,H.vc)(e.formatLocals),textRows:e.text,mergedCells:e.mergedCells,formulas:e.formulas},contentLanguageHint:(0,ie.gl)()}}function ve(e,t,a){const n=(0,oe.z6)();if(!t)throw new Error("No active table");if(t.name!==e)throw new Error("The query is not aimed at the active table");if(0===t.visibleColumns.length)throw new Error("All columns in selected table are hidden");return{recommendationOptions:"NL"===a?void 0:{capabilities:{chart:{layouts:"ChartReco"===a?n:[]},pivotTable:"PivotTableReco"===a,pivotChart:{layouts:"ChartReco"===a?n:[]}},thresholdOfUsingBaseMiningLevel:15e3,maxNumOfSummaryPerClass:1,disableInterleaveExperiment:!1},dataFieldOptions:Q(t)}}function xe(e,t,a,n){return{...e,generateResults:ve(t,a,n)}}const Te=(e,t=()=>!1,a,n="NL",r=!1)=>async(i,l)=>{const{interpretations:s}=l().selection;if(s[e]&&s[e].length>0&&!r&&l().selection.postRangesRequestTypes[e]&&l().selection.postRangesRequestTypes[e].includes(n))return;a&&k.M.getInstance().addAnalyzeDataStep(a,"getInterpretationsIfNeeded");const c=performance.now();try{if((r||!l().selection.postRangesResults[e]||!l().selection.postRangesRequestTypes[e]||!l().selection.postRangesRequestTypes[e].includes(n))&&(await i(((e,t,a="NL",n=!1)=>async(o,r)=>{const{postRangesResults:i,postRangesRequestTypes:l}=r().selection;if(i[e]){if(!n&&l[e]&&l[e].includes(a))return;{const n=ve(e,r().selection.activeTable,a),l=await(0,x.GU)(i[e].location,n,(0,x.oO)(void 0,i[e].authToken,t));return void o(p.m.generateResultsSuccess({tableName:e,requestType:a,generateResultsResult:l}))}}t&&k.M.getInstance().addAnalyzeDataStep(t,"postRangesIfNeeded");const s=performance.now();try{const n=await o(Ge(e,t)),i=await o(He(e,t));if(i&&n.rowCount*n.columnCount<=(0,j.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataCellCountLimit",pe)){y.P.getNumberFormatCache().addNumberFormatPropertiesToCache([W.tN]);const l=await i.next();if(l.done)throw Error("Selection data generator returned nothing");const s=l.value,c=(0,x.oO)(void 0,void 0,t),d=(0,j.iPS)("Microsoft.Office.Excel.FA000000124.UseLLMFormula",!1),u=d?n.sheetName:void 0,m=d&&n.isTable&&n.tableName?n.tableName:void 0,h=await(0,x.gp)(ye(s),n,u,m,c);let{isComplete:g,authToken:b}=h,f=l.value.values.length;const C=(0,x.oO)(void 0,b,t);for await(const t of i){if(g)throw Error('Insights range returned with "Complete" status before all data was sent');const n=xe(ye(t),e,r().selection.activeTable,a);g=(await(0,x.yt)(h.location,n,f,C)).isComplete,f+=t.values.length}if(!g)throw Error('Insights range returned with "Incomplete" status after all data was sent');const v=ve(e,r().selection.activeTable,a),T=await(0,x.GU)(h.location,v,C);o(p.m.postRangesSuccess({tableName:e,postRangesResult:{...T,...h},requestType:a}))}}finally{t&&k.M.getInstance().removeAnalyzeDataStep(t,"postRangesIfNeeded"),k.M.getInstance().logDuration("PostRangesIfNeeded",performance.now()-s,t)}})(e,a,n,r)),t()))return;if(!nt(l().selection,e))return i(p.m.clearExpiredRanges(e)),void k.M.getInstance().logInvalidInsightsSession("getInterpretationsIfNeeded");const{postRangesResults:s}=l().selection;if(t())return;const c=s[e],d=(0,x.oO)(void 0,c.authToken,a);if(!c.operationLocation)throw new Error(o.O.MissingOperationLocation);await(0,x.mo)(c.operationLocation,{interpretations:async t=>{const r=await i(Ge(e,a)),l=await(0,x.ke)(t,r,d);if(0===l.interpretations.length)throw new Error(o.O.GetInterpretationsFailed);i(p.m.getInterpretationsSuccess({tableName:e,result:l,requestType:n}))},recommendations:"NL"===n?void 0:async t=>{const n=await i(Ge(e,a)),o=await(0,x.Dz)(t,n,d);o.recommendations.length>0&&i(p.m.getRecommendationsSuccess({tableName:e,recommendations:o.recommendations}))}},d)}finally{k.M.getInstance().logDuration("GetInterpretationsIfNeeded",performance.now()-c,a),a&&k.M.getInstance().removeAnalyzeDataStep(a,"getInterpretationsIfNeeded")}},Se=(e,t,a=()=>!1,n=!1)=>async(r,i)=>{t&&k.M.getInstance().addAnalyzeDataStep(t,"getNLContextIfNeeded");const l=performance.now(),{evaluateQueryLocations:s,generateResultForNLEvaluationLocations:c}=i().selection,d=(0,j.iPS)("Microsoft.Office.Excel.FA000000124.UseShortPollNLEvaluating",!1)||(0,j.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1);if((!d||!c[e])&&(d||!s[e])){if(i().selection.pendingNLContextFetches.includes(e))return t&&k.M.getInstance().addAnalyzeDataStep(t,"pendingNLContextFetches"),await new Promise((t=>{V.F_.startListening({predicate:(t,a)=>t.type===p.m.getNLContextFinished.type&&!a.selection.pendingNLContextFetches.includes(e),effect:(e,a)=>{a.unsubscribe(),t()}})})),k.M.getInstance().logDuration("GetNLContextIfNeeded",performance.now()-l,t),void(t&&(k.M.getInstance().removeAnalyzeDataStep(t,"pendingNLContextFetches"),k.M.getInstance().removeAnalyzeDataStep(t,"getNLContextIfNeeded")));r(p.m.getNLContextRequest(e));try{if((!i().selection.interpretations[e]||0===i().selection.interpretations[e].length)&&(await r(Te(e,a,t)),a()))return;if(!nt(i().selection,e))return r(p.m.clearExpiredRanges(e)),void k.M.getInstance().logInvalidInsightsSession("getNLContextIfNeeded");if(!i().selection.interpretations[e]||0===i().selection.interpretations[e].length)throw new Error(o.O.GetInterpretationsFailed);const{interpretations:n,postRangesResults:l}=i().selection,s=n[e][0];if(a())return;const c=(0,x.oO)(void 0,l[e].authToken,t),d=await(0,x.bl)(s.generateNLContextLocation,{headerNames:[],preferColumnsIndexes:[]},c);r(p.m.getNLContextSuccess({tableName:e,contextResponse:d}))}catch(i){if(!(i instanceof o.u)||i.errorCode!==o.O.Gone&&i.errorCode!==o.O.NotFound||n)throw i;r(p.m.clearExpiredRanges(e)),r(p.m.getNLContextFinished(e)),await r(Se(e,t,a,!0))}finally{r(p.m.getNLContextFinished(e)),k.M.getInstance().logDuration("GetNLContextIfNeeded",performance.now()-l,t),t&&k.M.getInstance().removeAnalyzeDataStep(t,"getNLContextIfNeeded")}}},we=(e,t,a,s,c,d)=>async(u,m)=>{const h=performance.now();try{if(k.M.getInstance().clearAnalyzeDataSteps(a),k.M.getInstance().addAnalyzeDataStep(a,"getInsights"),u(B.m.startExecutingCommand({command:b.OP.AnalyzeData,id:a})),u(p.m.setActiveRequestId({tableName:e,activeRequestId:a})),t.numColumns*t.numRows>(0,j.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataCellCountLimit",pe))throw new o.u(o.O.LargeData);const n=async(e=()=>()=>{})=>{await d(e),"failed"!==m().selection.requestState[a]&&u(p.m.evaluateQuerySuccess(a))};let r=()=>{};const i=new Promise(((e,t)=>{r=()=>t(new Error("timeout"))}));let l=setTimeout(r,F.R.getAnalyzeDataTimeout(U.CP.getActiveTableRowNumber()));const s=()=>(clearTimeout(l),()=>{l=setTimeout(r,F.R.getAnalyzeDataTimeout(U.CP.getActiveTableRowNumber()))}),c=(async()=>{try{await n(s)}finally{clearTimeout(l)}})();await Promise.race([c,i])}catch(e){e instanceof Error&&"timeout"===e.message&&k.M.getInstance().logErrorCode(o.O.AnalyzeDataTimeout,void 0,L.S2.AnalyzeDataDuration,f.$b.ASHA,{key:b.un.ErrorLocation,value:k.M.getInstance().getLastAnalyzeDataStep(a)??""},{key:b.un.EvaluateQueryCorrelationId,value:a}),u(p.m.evaluateQueryFailed(a)),k.M.getInstance().logEvent((0,b.SV)(b.he.NoResult,b.q.AnalyzeData,b.KZ.InsightsApi,void 0,void 0,void 0,...(0,b.r)(t)));let d=(0,n.Hum)(),m=s,h=b.q0.ClientError,g=i.W.Unable_To_Complete_Task,C=r.c.Analyze_Data_Get_Insights_Client_Error;e instanceof Error&&e.message===o.O.GetInterpretationsFailed?(d=(0,n.S5F)(),m=o.O.GetInterpretationsFailed,h=b.q0.NoSuggestions,g=i.W.User_Input_Could_Not_Be_Processed,C=r.c.Failed_Insight_Generation_Due_To_Not_Enough_Info):e instanceof o.u&&e.errorCode===o.O.LargeData?(d=4e6===(0,j.Z8j)("Microsoft.Office.Excel.FA000000124.AnalyzeDataCellCountLimit",pe)?(0,n.ynC)():(0,n.SqW)(),m=o.O.LargeData,h=b.q0.LargeData,g=i.W.User_Input_Could_Not_Be_Processed,C=r.c.Failed_Insight_Generation_Due_To_Too_Large_Data):e instanceof o.u&&e.errorCode===o.O.NetworkError?(d=(0,n.a0$)(),m=o.O.NetworkError,h=b.q0.NetworkError,g=i.W.Unable_To_Complete_Task,C=r.c.Analyze_Data_Network_Error):e instanceof Error&&"timeout"===e.message?(m=o.O.AnalyzeDataTimeout,h=b.q0.AgentTimeout,g=i.W.Response_Delayed_Or_Timed_Out,C=r.c.Analyze_Data_Insights_Services_Timeout):(0,ce.ip)(e)&&(d=(0,n.OX0)(),m=o.O.PayloadSizeError,h=b.q0.LargeData,g=i.W.User_Input_Could_Not_Be_Processed,C=r.c.Failed_Insight_Generation_Due_To_Too_Large_Data),k.M.getInstance().logErrorCode(m,e,L.S2.AnalyzeDataError,e instanceof Error&&"timeout"===e.message?f.$b.Error:f.$b.ASHA,...(0,b.r)(t)),k.M.getInstance().logStandardizedAshaErrorEvent(g,C,b.BJ.AnalyzeData);const{message:y,telemetry:v}=ue.n.getAnalyzeDataErrorResponse(d,h);if(l.$.getInstance().displayResponse(y,v,{shouldShowWhenFluxSkillResponseRequired:!1}),c){const e=(0,X.N)(y);u((0,se.nv)(e,T.Aw.failed,v))}}finally{c||await u((0,se.L4)()),u(p.m.resetIsAllowRewrite()),k.M.getInstance().logDuration("GetInsights",performance.now()-h,a),k.M.getInstance().clearAnalyzeDataSteps(a)}},Ee=(e,t,a,r)=>async(i,s)=>{await i(we(e,t,a,"ChartReco"===r?o.O.GetChartRecoFailed:o.O.GetPivotTableRecoFailed,!1,(async()=>{await i(Te(e,(()=>"failed"===s().selection.requestState[a]),a,r,!0))})));const c=s().selection.recommendations[e];if(c&&c.length>0){i((0,se.qc)(c,r));const n=c[0],{message:o,telemetry:s}=ue.n.getAnalyzeDataRecommendationResponse({visual:n,requestId:a,responseText:"",tableName:e,tableContext:t});l.$.getInstance().displayResponse(o,s)}else{const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,n.S5F)(),b.q0.NoSuggestions);l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1})}},Ie=(e,t,a,s,c=()=>()=>{},d=()=>!1,u=!1,m)=>async(h,g)=>{k.M.getInstance().addAnalyzeDataStep(s,"evaluateQuery");const y=performance.now();try{const y=(0,j.iPS)("Microsoft.Office.Excel.FA000000124.UseShortPollNLEvaluating",!1)||(0,j.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1),v=y&&!g().selection.generateResultForNLEvaluationLocations[e],S=!y&&!g().selection.evaluateQueryLocations[e];(v||S)&&await h(Se(e,s));const{postRangesResults:w,interpretations:E,evaluateQueryLocations:I,generateResultForNLEvaluationLocations:R,isAllowRewrite:A}=g().selection,F=function(e){if(""!==e)return{tokens:[{tokenType:"none",text:e}]}}(a);if(!F)throw new Error("No query tokens found");const _=(0,j.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)&&(0,j.yw9)("OfficeVSO_10375249_PassRawQueryToInsights")?g().selection.rawQueries[s]:void 0,P={visualPreviewOptions:{maxTableDataSize:function(){const e=K.U$+20,t=K.Pl+20;return{width:Math.max(W.y3,e),height:Math.max(W.m6,t)}}()},allowReorder:!1,allowRewrite:A,outputAnswerLanguage:m,rawQuery:_,...F},N=await h((0,re.gf)(c));if(!N)throw new Error("Failed to get token for evaluateQuery request");if(!nt(g().selection,e))return h(p.m.clearExpiredRanges(e)),void k.M.getInstance().logInvalidInsightsSession("evaluateQuery");const M=(0,x.oO)(N,w[e].authToken,s);try{let o;const r=await h(Ge(e,s));if(o=y?await Re(R[e],P,E[e][0],r,s,h,g,e,t,M,a,d):await(0,x.xX)(I[e],P,E[e][0],r,M),m&&(o.outputLanguage=m),d())return;h((0,se.PQ)(o,e,t));const i=g().selection.nlEvaluationStates[s]?.intermediateResults??[],c=(0,j.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)&&i&&i.length>0;if(c?i.forEach((e=>{k.M.getInstance().logEvaluateQuery(e,r)})):k.M.getInstance().logEvaluateQuery(o,r),o.responseType===C.WZ.Answered){h(p.m.getRecommendationsSuccess({tableName:e,recommendations:o.visualAnswer}));const r=!1===o.fullyUnderstoodRewrittenQuery;if(c){k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionShown,b.q.AnalyzeData,b.KZ.InsightsApi));const{telemetry:e}=ue.n.getAnalyzeDataInfoResponse(""),t=(0,Z.q)(i);U.CP.setQueryIdShouldNotShowFluxResponse(k.M.userQueryGuid),h((0,se.nv)(t,T.Aw.success,e))}else if(o.visualAnswer.every((e=>("QueryResultVisual"===e.visual.visualType||"QueryChartVisual"===e.visual.visualType)&&0===e.visual.result.fields.length))){k.M.getInstance().logEvent((0,b.SV)((0,j.nmB)()?b.he.PythonFallback:b.he.ElseFallback,b.q.AnalyzeData,b.KZ.InsightsApi));const{message:e,telemetry:t}=ue.n.getAnalyzeDataInfoResponse("");l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a={text:(0,n.S5F)(),visual:ge,mustExplain:o.explainToLLM,fallbackToElse:!0,fallbackToPython:(0,j.nmB)()},r=JSON.stringify(a);h((0,se.nv)(r,T.Aw.failed,t))}else if(o.caveats&&o.caveats.length>0)if(o.visualAnswer.some((e=>!(0,$.ch)(e.visual)))&&!(0,j.nmB)()){k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionShown,b.q.AnalyzeData,b.KZ.InsightsApi));const n=tt(o),r=o.visualAnswer[0],{message:i,telemetry:c}=ue.n.getAnalyzeDataRecommendationResponse({visual:r,requestId:s,responseText:"",caveats:o.caveats,tableName:e,tableContext:t,query:a});l.$.getInstance().displayResponse(i,c);const d=(0,Z.t)(r,"",o.textAnswer?.tokens.map((e=>e.text)).join(""),n);h((0,se.nv)(d,T.Aw.success,c))}else{k.M.getInstance().logEvent((0,b.SV)((0,j.nmB)()?b.he.PythonFallback:b.he.ElseFallback,b.q.AnalyzeData,b.KZ.InsightsApi));const{message:e,telemetry:t}=ue.n.getAnalyzeDataInfoResponse("");l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a={text:(0,n.$Sd)(),visual:ge,mustExplain:o.explainToLLM,fallbackToElse:!0,fallbackToPython:(0,j.nmB)()},r=JSON.stringify(a);h((0,se.nv)(r,T.Aw.failed,t))}else if(o.visualAnswer.every((e=>(0,$.ch)(e.visual)))){k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionShown,b.q.AnalyzeData,b.KZ.InsightsApi));const e=r?(0,n.aI5)():(0,n.hiC)(),t=(o.textAnswerSummary?.tokens??[]).map((e=>e.text)).join(""),a=t.length>0?e.replace("{0}",t[0].toLocaleLowerCase()+t.slice(1)):(0,n.V0i)(),{message:i,telemetry:s}=ue.n.getAnalyzeDataInfoResponse(a);l.$.getInstance().displayResponse(i,s,{shouldShowWhenFluxSkillResponseRequired:!1});const c=JSON.stringify({text:a,visual:ge,mustExplain:o.explainToLLM});h((0,se.nv)(c,T.Aw.failed,s))}else{k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionShown,b.q.AnalyzeData,b.KZ.InsightsApi));const i=(r?(0,n.bUh)():1===o.visualAnswer.length?(0,n.wT9)():(0,n.YTh)()).replace("{0}",(0,de.Yd)(o.visualAnswer[0].visual.visualType)??"visual");let c=o.textAnswer?.tokens.map((e=>e.text)).join("");c=r?o.textAnswer?.tokens.map((e=>e.text)).join("")+" "+i:o.visualAnswer.length>1&&o.visualAnswer[0].title?o.visualAnswer[0].title.runs.map((e=>e.text)).join(""):o.textAnswer?.tokens.map((e=>e.text)).join("");const d=tt(o),u=o.visualAnswer[0],m="TextAnalysisVisual"===o.visualAnswer[0].visual.visualType,g=(0,he.A)(),p={visual:m?{...u,id:g}:u,requestId:s,responseText:i,tableName:e,tableContext:t,query:a},{message:f,telemetry:C}=ue.n.getAnalyzeDataRecommendationResponse(p),y=(0,Z.t)(m?{...u,id:g}:u,i,c,d),v=()=>h((0,se.nv)(y,T.Aw.success,C,!0,!0,m));l.$.getInstance().displayResponse(f,C),m&&U.CP.setQueryIdShouldNotShowFluxResponse(k.M.userQueryGuid),m&&it(u.visual)&&lt(k.M.userQueryGuid,u.visual),v()}}else if((0,j.yw9)("OfficeVSO_10449020_LoopFallBack")&&!0===g().selection.shouldFallBack[s]){k.M.getInstance().logEvent((0,b.SV)((0,j.nmB)()?b.he.PythonFallback:b.he.ElseFallback,b.q.AnalyzeData,b.KZ.InsightsApi));const{message:e,telemetry:t}=ue.n.getAnalyzeDataInfoResponse("");l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a={text:(0,n.$Sd)(),visual:ge,mustExplain:o.explainToLLM,fallbackToElse:!0,fallbackToPython:(0,j.nmB)()},r=JSON.stringify(a);h((0,se.nv)(r,T.Aw.failed,t))}else{const e=(o.explainToLLM?.length??0)>0;let t,a;o.reasonForError===C.M$.AskForClarification&&e?t=b.he.SuggestionShown:mt(o.reasonForError)?t=b.he.PythonFallback:ut(o.reasonForError)?t=b.he.ElseFallback:(dt(o.reasonForError,e),t=b.he.NoResult),k.M.getInstance().logEvent((0,b.SV)(t,b.q.AnalyzeData,b.KZ.InsightsApi));let r,i=o.explainToLLM;if(o.reasonForError){const e=ct(o.reasonForError);a=e.errorMessage,e.explainToLLM&&(i&&i.length>0?(i+=". ",i+=e.explainToLLM):i=e.explainToLLM)}else a=(0,n.Rzj)();r=o.reasonForError===C.M$.AskForClarification&&e?ue.n.getAnalyzeDataInfoResponse(a):ut(o.reasonForError)||mt(o.reasonForError)?ue.n.getAnalyzeDataInfoResponse(""):ue.n.getAnalyzeDataErrorResponse(a,b.q0.NoSuggestions);const{message:s,telemetry:c}=r;l.$.getInstance().displayResponse(s,c,{shouldShowWhenFluxSkillResponseRequired:!1});const d={text:a,visual:ge,mustExplain:i,fallbackToElse:ut(o.reasonForError),fallbackToPython:mt(o.reasonForError)},u=JSON.stringify(d);h((0,se.nv)(u,T.Aw.failed,c))}}catch(g){let C=b.q0.ClientError,y=i.W.Unable_To_Complete_Task,v=r.c.Analyze_Data_Evaluate_Query_Client_Error,x=!1,S=(0,n.Hum)();if(g instanceof o.u)switch(g.errorCode){case o.O.Gone:case o.O.NotFound:if(!u)return h(p.m.clearExpiredRanges(e)),void await h(Ie(e,t,a,s,c,d,!0,m));break;case o.O.InternalServerError:C=b.q0.ServiceError,y=i.W.Unable_To_Complete_Task,v=r.c.Analyze_Data_Insights_Services_Error,x=(0,j.yw9)("OfficeVSO_10237986_FallbackPython500");break;case o.O.NetworkError:S=(0,n.a0$)(),C=b.q0.NetworkError,y=i.W.Unable_To_Complete_Task,v=r.c.Analyze_Data_Network_Error;break;case o.O.Unauthorized:(0,j.yw9)("OfficeVSO_9974407_RemoveAuthFallback")&&(S=(0,n.P6V)(),C=b.q0.Unauthorized,y=i.W.User_Access_Issue_For_Copilot)}if(k.M.getInstance().logErrorCode(o.O.EvaluateQueryFailed,g,L.S2.AnalyzeDataError,f.$b.ASHA),x){k.M.getInstance().logEvent((0,b.SV)(b.he.PythonFallback,b.q.AnalyzeData,b.KZ.InsightsApi));const e=JSON.stringify({text:S,visual:ge,fallbackToPython:!0});h((0,se.nv)(e,T.Aw.failed,{featureName:b.q.AnalyzeData,eventType:b.a5.ErrorMessage,errorType:C}))}else{k.M.getInstance().logStandardizedAshaErrorEvent(y,v,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse(S,C);l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a=(0,X.N)(e);h((0,se.nv)(a,T.Aw.failed,t))}}}finally{k.M.getInstance().removeAnalyzeDataStep(s,"evaluateQuery"),k.M.getInstance().logDuration("EvaluateQuery",performance.now()-y,s)}},Re=async(e,t,a,n,o,r,i,s,c,d,u,m)=>{const h=await(0,x.JU)(e,t,d);let g={};if(m())return g;return await(0,x.mo)(h.operationLocation,{nlEvaluationResult:async e=>{m()||(g=await(0,x.LS)(e,a,n,t.forceStaticAnswer,d))}},{nlEvaluationState:async e=>{if(!e)return{shouldDeleteOperation:!1};if(m())return{shouldDeleteOperation:!1};if((0,j.iPS)("Microsoft.Office.Excel.FA000000124.EnableDynamicPlanner",!1)){const t=i().selection.nlEvaluationStates[o]?.intermediateResults??[],a=e?.intermediateResults??[];for(let e=t.length;e<a.length;e++){const t=a[e];if(t.visualAnswer&&t.visualAnswer.length>0){if(t.caveats&&t.caveats.length>0)return r(p.m.setShouldFallBack({requestId:o,shouldFallBack:!0})),{shouldDeleteOperation:!0};const{message:e,telemetry:a}=ue.n.getAnalyzeDataRecommendationResponse({visual:t.visualAnswer[0],requestId:o,responseText:"",tableName:s,tableContext:c,query:u});l.$.getInstance().displayResponse(e,a);const n=t.visualAnswer[0].visual;"TextAnalysisVisual"===n.visualType&&it(n)&&lt(k.M.userQueryGuid,n)}else if(t.responseType===C.WZ.Answered&&t.textAnswer?.tokens&&t.textAnswer?.tokens.length>0){const{message:e,telemetry:a}=ue.n.getAnalyzeDataMarkdownResponse(t.textAnswer.tokens[0].text);l.$.getInstance().displayResponse(e,a)}else;}}return r(p.m.setNLEvaluationState({requestId:o,nlEvaluationState:e})),{shouldDeleteOperation:!1}}},d,a,n,m),g},Ae=(e,t,a,n,r)=>async(i,l)=>i(we(e,t,n,o.O.GetInsightsFailed,!0,(async o=>{const s=()=>"failed"===l().selection.requestState[n];await i(Se(e,n,s)),s()||await i(Ie(e,t,a,n,o,s,!1,r))}))),Le=e=>{switch(e){case"ChartVisual":case"ForecastVisual":case"PivotChartVisual":case"PivotTableVisual":case"QueryChartVisual":return(0,j.yw9)("OfficeVSO_9364126_UpdateAnalyzeDataInsertResponse")?(0,n.zGM)():(0,n.FxF)();case"QueryResultVisual":case"TextAnalysisVisual":return;default:(0,_.x)(e)}},ke=(e,t,a,s,c)=>async(d,u)=>{try{S.B.getInstance().logKeptEvent(b.BJ.AnalyzeData,b.q.AnalyzeData,E.RX.Analyze),k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionApplied,b.q.AnalyzeData,b.KZ.AddButton,t.id));const o="TextAnalysisVisual"===t.visual.visualType,r="ChartVisual"===t.visual.visualType||o?(0,n.zVb)():(0,n.W4k)(),{message:i,telemetry:m}=ue.n.getAnalyzeDataUserChat(r);l.$.getInstance().displayResponse(i,m),d((0,se.eM)(b.OP.InsertAnalyzeData));const h=c??await d(Ge(e)),g=null!=s?s:(0,$.gD)(t,u().selection.interpretations[e]);if(!h.sheetId)throw new Error("SheetId is not available in selection context");if(!h.sheetName)throw new Error("SheetName is not available in selection context");if(!h.address)throw new Error("Address is not available in selection context");const f=new w.N(h.sheetId,h.sheetName,h.address,h.isTable?h.tableName:null),C=await(0,P.h7)(t,f,g);if((0,P.Ns)(C,[],((e,a)=>(("Sheet"===a&&e===C.sheetId||e===C.objectId)&&(k.M.getInstance().logRejectedEvent(b.q.AnalyzeData,t.id),k.M.getInstance().logEvent((0,b.SV)(b.he.Deleted,b.q.AnalyzeData,b.KZ.GridAction,t.id))),Promise.resolve()))),await d((0,se.L4)()),o&&!C.range)throw new Error("No inserted range returned for text analysis insertion");const y=o?C.range.values[0][0]:t.title?.runs.map((e=>e.text)).join(""),v=o?(0,O.L)((0,n.OfU)(),y,(0,$.c3)(C.range.columnIndex+1)):(0,O.L)((0,n.mjl)(),y,C.sheetName),{message:x,telemetry:I}=ue.n.getAnalyzeDataInsertSuccessResponse({messageText:v,tableContext:a,confirmationMessage:(0,j.tgf)()?Le(t.visual.visualType):void 0,suggestionId:t.id,shouldShowGoBackToTableButton:null!=a&&"TextAnalysisVisual"!==t.visual.visualType,originalDataSheetId:h.sheetId});l.$.getInstance().displayResponse(x,I),o&&(d(p.m.clearTable(e)),await d(He(e)));const R=(0,X.N)(i);d((0,se.nv)(R,T.Aw.success,m))}catch(e){if(await d((0,se.L4)()),k.M.getInstance().logErrorCode(o.O.InsertionFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA),e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.accessDenied){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_Protection_Settings,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,n.V7x)());l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a=(0,X.N)(e);d((0,se.nv)(a,T.Aw.failed,t))}else if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_User_Edits,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,n.WJg)());l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a=(0,X.N)(e);d((0,se.nv)(a,T.Aw.failed,t))}else{k.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Failed_Insight_Insertion,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,n.OSb)());l.$.getInstance().displayResponse(e,t,{shouldShowWhenFluxSkillResponseRequired:!1});const a=(0,X.N)(e);d((0,se.nv)(a,T.Aw.failed,t))}}},Fe=(e,t,a)=>async(n,o)=>{const r=a.map((e=>d.ExcelCalc.addressToExcelRange((0,ee.r)(e))));if(r.some((e=>!(0,N.M$)(e))))return;const i=o().selection.tabularRanges[e]??{},l=(0,N.py)(t),s=i[l];if(!s)return;const c=s.range,u=r.map((e=>(0,M._)(c,e)));if(1!==Math.min(...u))return;const m=(0,N.GT)([c,...r]),h=(0,N.OK)(m,o().selection.tabularRanges[e]??{},l,e);n(p.m.updateTableInterpretationsForSheet({sheetId:e,newInterpretations:h}))},_e=(e,t)=>async(a,n)=>{let r,i,l,s,c={},m="";if(t?({coauthVersionDocId:i,coauthVersionXluid:l,coauthVersionXrevId:s}=JSON.parse(t)):k.M.getInstance().logErrorCode(o.O.TLRRevisionError,(0,b.Jr)("parentRevId is undefined"),L.S2.TabularRange,f.$b.Warning),i||l||s){m=`${i}.${l}.${s}`}else k.M.getInstance().logErrorCode(o.O.TLRRevisionError,(0,b.Jr)("revisionWaterline is undefined"),L.S2.TabularRange,f.$b.Warning);((0,j._mi)()||(0,j.JMu)())&&a(p.m.updateExcelRecognizedTableCache({revisionId:m,recognizedTable:e}));const h=e.range.worksheetId;if(A.E.getInstance().logTableRecognized(),(0,j.tgf)())({newInterpretations:c,range:r}=await(async(e,t)=>{const a={};let n;if(!e.tableName){if(e.interpretations.length>2){const n=e.interpretations[0],o=n.location;let{unsupportedFeatures:r,hasTotalRow:i}=(0,N.bp)(n,e);r|=u.ye.LowInterpretationConfidence;const{locationKey:l,range:s,sheetName:c}=await Ne(o,e);return a[l]={name:(0,G.Jm)(c,o),interpretation:n,hasMergedCells:e.hasMergedcells??!1,range:s,revisionWaterline:t,unsupportedFeatures:r,hasTotalRow:i},{newInterpretations:a,range:s}}for(const o of e.interpretations)if(o.confidence>=.75||.5===o.confidence&&"columnMajor"===o.orientation){const{unsupportedFeatures:r,hasTotalRow:i}=(0,N.bp)(o,e),l=o.location;let s,c;({sheetName:c,range:n,locationKey:s}=await Ne(l,e)),a[s]={name:(0,G.Jm)(c,l),interpretation:o,hasMergedCells:e.hasMergedcells??!1,range:n,revisionWaterline:t,unsupportedFeatures:r,hasTotalRow:i};break}}return{newInterpretations:a,range:n}})(e,m));else if(!e.hasMergedcells&&!e.tableName)for(const t of e.interpretations){let a=t.location,n=0===(t.aggregationLines?.length??0);const o=1===t.aggregationLines?.length,i=e.primaryTable?.hasTotalRow??!1;o&&i&&(a={...t.location,bottom:t.location.bottom-1},n=!0);const l=(0,j.iPS)("Microsoft.Office.Excel.FA000000124.CalculatedColumnsHeaderLessTLR",!1);if(t.confidence>=.75&&"columnMajor"===t.orientation&&(1===t.headerRowCount||l&&0===t.headerRowCount)&&0===t.headerColumnCount&&n){if(t.headerNames){if(new Set(t.headerNames.map((e=>e.toLowerCase()))).size!==a.right-a.left+1)continue}r=J(a);const n=(0,N.MQ)(r),o=await U.CP.ensureSheetName(e.sheetName,a.worksheetId);c[n]={name:(0,G.Jm)(o,a),interpretation:{...t,location:a},hasMergedCells:e.hasMergedcells??!1,range:r,revisionWaterline:m,unsupportedFeatures:u.ye.None,hasTotalRow:!1};break}}const g=n().selection.tabularRanges[h]??{};for(const[e,t]of Object.entries(g))r&&t.range&&d.ExcelCalc.IExcelRangeIntersect(r,t.range)&&a(p.m.clearTable(t.name)),t.revisionWaterline===m&&(c[e]=t);a(p.m.updateTableInterpretationsForSheet({sheetId:h,newInterpretations:c})),e.tableName||h!==U.CP.getActiveWorksheetId()||await U.CP.refreshSelectionContext()},Pe=(e,t)=>async(a,n)=>{let r,i,l,s="";if(t?({coauthVersionDocId:r,coauthVersionXluid:i,coauthVersionXrevId:l}=JSON.parse(t)):k.M.getInstance().logErrorCode(o.O.BlobRangeRevisionError,(0,b.Jr)("parentRevId is undefined"),L.S2.WorkbookContext,f.$b.Warning),r||i||l){s=`${r}.${i}.${l}`}else k.M.getInstance().logErrorCode(o.O.BlobRangeRevisionError,(0,b.Jr)("revisionWaterline is undefined"),L.S2.WorkbookContext,f.$b.Warning);a(p.m.updateExcelBlobRangeCache({revisionId:s,blobRange:e}))};async function Ne(e,t){const a=J(e);return{locationKey:(0,N.MQ)(a),range:a,sheetName:await U.CP.ensureSheetName(t.sheetName,e.worksheetId)}}const Me=(e,t)=>(a,n)=>{const o=n().selection.tabularRanges[e];if(!o)return;const r=te(t);let i;for(const e of Object.values(o)){const t=e.name,a=J(e.interpretation.location);if(d.ExcelCalc.IExcelRangeContainedIn(r,a))return{name:t,tabularRange:e,distance:0};if(d.ExcelCalc.IExcelRangeIntersect(r,a))return{name:t,tabularRange:e,distance:0};{const n=(0,M._)(r,a);(!i||n<i.distance)&&(i={name:t,tabularRange:e,distance:n})}}return i},Oe=(e,t)=>(a,n)=>{const o=n().selection.tabularRanges[e];if(!o)return[];const r=te(t);return Object.values(o).filter((e=>{const t=J(e.interpretation.location);return d.ExcelCalc.IExcelRangeIntersect(r,t)}))},De=e=>(t,a)=>{if(a().selection.selectionContexts[e])return{localeCacheDeprecated:a().selection.localeCacheDeprecated,theme:a().selection.themeColors}},Be=()=>(e,t)=>t().app.augloopModelWorkflowUnsupported,$e=(e,t)=>async(a,n)=>{if(!n().chat.isCurrentNLResultValid&&e?.tableLikeRangeFeatures!==u.ye.Unrecognized)return a(He(e.name,t))},He=(e,t)=>async(a,n)=>{if((0,j.tgf)()&&U.CP.activeChart)return;t&&k.M.getInstance().addAnalyzeDataStep(t,"resolveTableLikeEntity");const r=performance.now();try{const n=a(Ue(e));if(n)return await a(qe(n,t));if(e.includes("!"))throw new Error(o.O.TLRNotFound);return await a(((e,t)=>async a=>{t&&k.M.getInstance().addAnalyzeDataStep(t,"resolveTable");const n=performance.now();try{const n=await(0,ne.px)({type:R.lp.StandardTable,name:e},t),{context:o,dataGenerator:r,localeDeprecated:i,theme:l}=n;return a(p.m.setSelectionContext({context:o,tableName:e,localeCacheDeprecated:i,theme:l})),a(Ve(e,t)),r}finally{t&&k.M.getInstance().removeAnalyzeDataStep(t,"resolveTable"),k.M.getInstance().logDuration("ResolveTable",performance.now()-n,t)}})(e,t))}finally{k.M.getInstance().logDuration("ResolveTableLikeEntity",performance.now()-r,t),t&&k.M.getInstance().removeAnalyzeDataStep(t,"resolveTableLikeEntity")}},Ue=e=>(t,a)=>Object.values(a().selection.tabularRanges).flatMap(Object.values).find((t=>(0,N.$j)(e,t))),qe=(e,t)=>async a=>{t&&k.M.getInstance().addAnalyzeDataStep(t,"resolveTabularRange");const n=performance.now();try{const n={type:R.lp.TableLikeRange,name:e.name,sheetId:e.interpretation.location.worksheetId,showTotals:e.hasTotalRow,hasTableHeaders:e.interpretation.headerRowCount>0},o=await(0,ne.px)(n,t),{context:r,dataGenerator:i,localeDeprecated:l,theme:s}=o;return a(p.m.setSelectionContext({tableName:e.name,context:r,localeCacheDeprecated:l,theme:s})),a(Ve(e.name,t)),i}finally{k.M.getInstance().logDuration("ResolveTabularRange",performance.now()-n,t),t&&k.M.getInstance().removeAnalyzeDataStep(t,"resolveTabularRange")}},Ve=(e,t)=>async(a,n)=>{const{dataSourceApis:o}=n().selection;if(o[e])return n().selection.dataSourceApis[e];const r=await a(Ge(e,t)),{sheetId:i,rowIndex:l,rowCount:c,columnIndex:d,columnCount:u}=r,{text:m,values:h,formats:g,formulas:b}=await(0,ne.VQ)(Math.min(c,(0,j.xyg)("CalculatedColumnsMaxRows"),Math.floor((0,j.xyg)("CalculatedColumnsMaxCells")/u)),l,u,d,i,t),f=(0,s.O)({textRows:m,valueRows:h,formatRows:g,formulas:b});return a(p.m.setDataSourceApi({tableName:e,dataSourceApi:f})),f},Ge=(e,t)=>async(a,n)=>{let{selectionContexts:o}=n().selection;if(o[e])return n().selection.selectionContexts[e];if(await a(He(e,t)),o=n().selection.selectionContexts,o[e])return n().selection.selectionContexts[e];throw new Error("getSelectionContextIfNeeded: SelectionContext not found for table name")},We=(0,V.YQ)(((e,t)=>t().selection.excelRecognizedTablesAnnotationsCache)),ze=(0,V.YQ)(((e,t)=>t().selection.excelBlobRangeCache)),je=(0,V.YQ)(((e,t,a)=>t().selection.selectionContexts[a])),Qe=()=>(e,t)=>{let a,n;if((0,j.ZAR)()){const e=t().chat;a=e.currentNLResultTableContext,n=e.currentNLResultTableName}else a=U.CP.getActiveTable(),n=a?.name;if(!a||!n)return;const o=t().chat.currentRecos||[];e(Ye(n,o,a))},Je=()=>(e,t)=>{let a,n;if((0,j.ZAR)()){const e=t().chat;a=e.currentNLResultTableContext,n=e.currentNLResultTableName}else a=U.CP.getActiveTable(),n=a?.name;if(!a||!n)return;const o=t().chat.currentNLResult?.visualAnswer||[];e(Ye(n,o,a))},Ye=(e,t,a,r)=>async(i,s)=>{if(s().selection.isInserting)return Promise.resolve();i(p.m.startInsertRecommendations());const c=performance.now(),d={recommendationData:[],isSuccessful:!1,failureLocation:g.lA.unknown,failureReason:""};i((0,se.eM)(b.OP.InsertAnalyzeData));let u="",m="",h="";try{const o=await Xe();u=o.previousActiveSheetId,m=o.dashboardSheetName,h=o.dashboardSheetId;const s=function(e){const t=new Set,a=["ChartVisual","PivotTableVisual","PivotChartVisual"],n=e.filter((e=>{if(!e.visual)return!1;const n=e.visual.visualType;if(!a.includes(n))return!1;if("ChartVisual"===n){const a=e.title;if(a){const e=(0,Y.HW)(a);if(t.has(e))return!1;t.add(e)}}return!0}));return n}(t);await i(Ke(s,m,h,e,d,r)),await i((0,se.L4)());const c=(0,O.L)((0,n.ax8)(),e),p=(0,j.tgf)()?s.map((e=>Le(e.visual.visualType))).reduce(((e,t)=>e||t),void 0):void 0,b=await i(Ge(e));if(!b.sheetId)throw new Error("SheetId is not available in selection context");const{message:f,telemetry:C}=ue.n.getAnalyzeDataInsertSuccessResponse({messageText:c,tableContext:a,confirmationMessage:p,shouldShowGoBackToTableButton:null!=a,originalDataSheetId:b.sheetId});l.$.getInstance().displayResponse(f,C);const y=(0,X.N)(f);i((0,se.nv)(y,T.Aw.success,C)),d.isSuccessful=!0,d.failureLocation=g.lA.none}catch(e){await i((0,se.L4)());let t=(0,n.OSb)();e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.accessDenied?t=(0,n.V7x)():e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode&&(t=(0,n.WJg)());const{message:a,telemetry:r}=ue.n.getAnalyzeDataErrorResponse(t,b.q0.DashboardInsertFailed);l.$.getInstance().displayResponse(a,r,{shouldShowWhenFluxSkillResponseRequired:!1});const s=(0,X.N)(a);i((0,se.nv)(s,T.Aw.failed,r)),d.failureReason=e.message+(e.debugInfo?.errorLocation?` Location: ${e.debugInfo?.errorLocation}`:""),await Excel.run((async e=>Ze(e,h,u))),k.M.getInstance().logErrorCode(o.O.InsertionCleanupFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA)}finally{i(p.m.endInsertRecommendations()),S.B.getInstance().logKeptEvent(b.BJ.AnalyzeData,b.q.AnalyzeData,E.RX.Analyze),k.M.getInstance().logEvent((0,b.SV)(b.he.SuggestionApplied,b.q.AnalyzeData,b.KZ.DashboardSuggestionPill,h)),k.M.getInstance().logDuration("InsertRecommendationsDashboard",performance.now()-c),k.M.getInstance().logInsertRecommendationDashboard(d)}},Xe=async()=>{let e="",t="",a="";return await Excel.run((async n=>{const o=n.workbook.worksheets.getActiveWorksheet();n.workbook.worksheets.load("items"),await n.sync(),e=o.id;const r=(await(0,le.d)(n)()(n)).result;a=r.id,t=r.name})),{previousActiveSheetId:e,dashboardSheetName:t,dashboardSheetId:a}},Ze=async(e,t,a)=>{if(t){a&&e.workbook.worksheets.getItemOrNullObject(a).activate();const n=e.workbook.worksheets.getItemOrNullObject(t);await e.sync(),n.isNullObject||n.delete()}},Ke=(e,t,a,o,r,i)=>async function(l,s){const c=null!=i?i:s().selection.interpretations[o],d=await l(Ge(o));if(!d.sheetId)throw new Error("SheetId is not available in selection context");if(!d.sheetName)throw new Error("SheetName is not available in selection context");if(!d.address)throw new Error("Address is not available in selection context");const u=new w.N(d.sheetId,d.sheetName,d.address,d.isTable?d.tableName:null),{layoutPlacementsById:m,mainDataLocation:h,supportingDataLocation:p}=(0,g.zJ)(e,15);r.failureLocation=g.lA.findInterpretation,r.recommendationData=e.map((e=>{const{id:t}=e;return{id:t,type:e.visual.visualType,location:{chart:m[t].chart,pivotTable:m[t].pivotTable},pivotTableSizeData:et(e.visual)}}));const b=e.map((e=>{const t=(0,$.gD)(e,c);if(!t)throw l((0,se.YS)()),new Error(`insertAllRecommendationsCore: No interpretation for recommendation ${e.id}`);return{recommendation:e,interpretation:t,layoutPlacement:m[e.id]}}));r.failureLocation=g.lA.preFormatDashboardSheet,await async function(e,t,a){return Excel.run((async o=>{const r=o.workbook.worksheets.getItemOrNullObject(e);r.showGridlines=!1,r.getRange("A1").format.columnWidth=10,r.getRange("A1").format.rowHeight=10;const i=r.getRangeByIndexes(t.startRow-1,t.startColumn-1,t.rowCount+1,t.columnCount+1);if(i.format.fill.color=n.Ib6,i.format.columnWidth=n.NKv,a.rowCount&&a.columnCount){const e=a.startRow-2;r.getRangeByIndexes(e,a.startColumn,1,1).values=[[(0,n.PUb)()]];const o=r.getRangeByIndexes(e,1,1,Math.max(a.columnCount,t.columnCount+1));o.format.fill.color=n.Ib6,o.format.font.color=n.OXO,o.format.rowHeight=n.xqS,o.format.verticalAlignment="Center"}r.activate()}))}(a,h,p),r.failureLocation=g.lA.insertRecommendations,await(0,me.F5)((async e=>{await(0,P.q)(e,b,t,u,r),r.failureLocation=g.lA.postFormatDashboardSheet,await async function(e,t,a,o){const r=e.workbook.worksheets.getItemOrNullObject(t),i=r.getRangeByIndexes(a.startRow-1,a.startColumn-1,a.rowCount+1,a.columnCount+1);if(i.format.columnWidth=n.NKv,o.rowCount&&o.columnCount){const e=r.getRangeByIndexes(o.startRow,o.startColumn,o.rowCount,o.columnCount);e.format.wrapText=!0,e.format.rowHeight=15,e.format.verticalAlignment="Top"}}(e,a,h,p)})),r.failureLocation=g.lA.none};function et(e){if("PivotTableVisual"!==e.visualType&&"PivotChartVisual"!==e.visualType)return;const t=e?.pivotTable,a={};for(const[e,n]of Object.entries(t))a[e]="number"==typeof n||void 0===n?n:"object"==typeof n?n.length:typeof n;return a}function tt(e){let t=e.explainToLLM;if(e.caveats&&e.caveats.length>0){const a=(e.caveats||[]).map((e=>e.code===C.T6.ChartTypeNotSupported||e.code===C.T6.ChartTypeNotAppropriate?(0,O.L)((0,n._)(),D(e.detail)):null)).find((e=>null!==e&&e.length>0))||(0,O.L)((0,n._)(),(0,n.HRg)());t=t?t+" "+a:a}return t}function at(e,t){const{columnCount:a,columnIndex:n,rowCount:o,rowIndex:r}=e;return new h.pW({worksheetId:t,left:n+1,top:r+1,right:n+a,bottom:r+o})}function nt(e,t){return t in e.postRangesResults}const ot=(e,t,a)=>async(n,o)=>{try{const n=a.sheetRange.sheet,o=a.sheetRange.range.topLeft.row,r=a.sheetRange.range.bottomRight.column+1;await Excel.run((async a=>{const i=a.workbook.worksheets.getItem(n);i.activate();const l=i.rangeValuesPreview,s=d.ExcelCalc.IExcelRangeToAddress({topLeft:{row:o,column:r},bottomRight:{row:o,column:r}});l.show(s,[t,...e],{autoexpandTable:!0,autofitColumns:!1}),await a.sync()}))}catch(e){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.UI_Failed_To_Update_Or_Load,r.c.Preview_On_Grid_Failed_To_Display,b.BJ.AnalyzeData)}},rt=e=>async(t,a)=>{try{const t=e.sheetRange.sheet;await Excel.run((async e=>{e.workbook.worksheets.getItem(t).rangeValuesPreview.dismiss(),await e.sync()}))}catch(e){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.UI_Failed_To_Update_Or_Load,r.c.Preview_On_Grid_Failed_To_Display,b.BJ.AnalyzeData)}},it=e=>(0,j.iPS)("Microsoft.Office.Excel.FA000000124.EnableFullTheming",!1)&&"TextAnalysisVisual"===e.visualType&&e.textAnalysisResult.resultType===C.rb.QuickSummary,lt=(e,t)=>{const{message:a,telemetry:n}=ue.n.getFullThemingSuggestionResponse(e,t.textAnalysisResult.columnName);l.$.getInstance().displayResponse(a,n)},st=e=>async(t,a)=>{const n=a().selection.selectionContexts;for(const a in n)n[a].sheetId===e&&t(p.m.clearTable(a))},ct=e=>{let t,a;switch(e){case C.M$.LLMThrottledError:t=(0,n.mRA)(),a=(0,n.fDp)();break;case C.M$.LLMHttpRequestError:case C.M$.LLMTimeout:case C.M$.LLMGenericError:t=(0,n.mRA)(),a=(0,n._Q4)();break;case C.M$.MissingFunctionality:case C.M$.VisualConversionError:case C.M$.UnsupportedTextAnalysisType:t=(0,n.$Sd)();break;case C.M$.ContentTooLarge:t=(0,n.NUW)();break;case C.M$.InvalidJsonFormat:case C.M$.InvalidAE:case C.M$.InvalidResponseType:case C.M$.MismatchedColumnName:case C.M$.TextAnalysisUnexpectedLLMResult:case C.M$.BlockedByRAI:case C.M$.UnsupportedExecution:case C.M$.SymbolicLogicException:case C.M$.AskForClarification:case C.M$.UnanswerableQuery:case C.M$.UnsupportedLanguage:t=(0,n.P6V)();break;default:t=(0,n.Rzj)()}return{errorMessage:t,explainToLLM:a}},dt=(e,t)=>{let a,n;switch(e){case C.M$.LLMThrottledError:a=i.W.Unable_To_Generate_Response_Due_To_Capacity_Issue,n=r.c.LLM_Throttled;break;case C.M$.LLMHttpRequestError:a=i.W.LLM_Service_Side_Issue_Prevents_Output,n=r.c.LLM_HTTP_Request_Error;break;case C.M$.LLMTimeout:a=i.W.LLM_Service_Side_Issue_Prevents_Output,n=r.c.Analyze_Data_LLM_Timeout;break;case C.M$.LLMGenericError:a=i.W.LLM_Service_Side_Issue_Prevents_Output,n=r.c.LLM_Service_Error;break;case C.M$.InvalidJsonFormat:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_Json_Format;break;case C.M$.InvalidAE:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_AE_Generated;break;case C.M$.InvalidResponseType:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_Response_Type;break;case C.M$.MismatchedColumnName:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_Column_Name;break;case C.M$.TextAnalysisUnexpectedLLMResult:a=i.W.Unable_To_Complete_Task,n=r.c.Invalid_Text_Analysis_Response;break;case C.M$.BlockedByRAI:a=i.W.Responsible_AI_Filter_Blocked_Response,n=r.c.RAI_Validation_Failed;break;case C.M$.SymbolicLogicException:a=i.W.Unable_To_Complete_Task,n=r.c.Failed_During_Prompt_Construction_Or_Postprocessing;break;case C.M$.AskForClarification:a=i.W.User_Input_Could_Not_Be_Processed,n=r.c.LLM_Thinks_Ambiguous;break;case C.M$.UnsupportedLanguage:a=i.W.Missing_Copilot_Functionality,n=r.c.Analyze_Data_Text_Analysis_Unsupported_Language;break;case C.M$.ContentTooLarge:case C.M$.UnsupportedTextAnalysisType:case C.M$.MissingFunctionality:a=i.W.Missing_Copilot_Functionality,n=r.c.Features_In_Development;break;case C.M$.VisualConversionError:a=i.W.Missing_Copilot_Functionality,n=r.c.Insights_Visual_Converter_Unsupported;break;case C.M$.UnsupportedExecution:a=i.W.Missing_Copilot_Functionality,n=r.c.AE_Execution_Unsupported;break;case C.M$.UnanswerableQuery:a=i.W.Missing_Copilot_Functionality,n=r.c.LLM_Identifies_UnanswerableQuery;break;default:a=t?i.W.Missing_Copilot_Functionality:i.W.Unable_To_Complete_Task,n=t?r.c.Failed_Insight_Generation_Due_To_Out_Of_Scope_Error:r.c.Failed_Insight_Generation_Due_To_Other_Error}k.M.getInstance().logStandardizedAshaErrorEvent(a,n,b.BJ.AnalyzeData)},ut=e=>{if(!e)return!1;switch(e){case C.M$.ContentTooLarge:case C.M$.MissingFunctionality:case C.M$.VisualConversionError:case C.M$.UnsupportedLanguage:case C.M$.UnanswerableQuery:case C.M$.UnsupportedExecution:case C.M$.UnsupportedTextAnalysisType:return!0;case C.M$.AskForClarification:case C.M$.LLMThrottledError:case C.M$.LLMHttpRequestError:case C.M$.LLMTimeout:case C.M$.LLMGenericError:case C.M$.InvalidJsonFormat:case C.M$.InvalidAE:case C.M$.InvalidResponseType:case C.M$.MismatchedColumnName:case C.M$.SymbolicLogicException:case C.M$.TextAnalysisUnexpectedLLMResult:case C.M$.BlockedByRAI:return!1;default:(0,_.x)(e)}},mt=e=>{if(!(0,j.nmB)())return!1;if(!e)return!1;switch(e){case C.M$.MissingFunctionality:case C.M$.VisualConversionError:case C.M$.UnanswerableQuery:case C.M$.UnsupportedExecution:case C.M$.InvalidJsonFormat:case C.M$.InvalidAE:case C.M$.InvalidResponseType:case C.M$.MismatchedColumnName:case C.M$.SymbolicLogicException:case C.M$.TextAnalysisUnexpectedLLMResult:return!0;case C.M$.ContentTooLarge:case C.M$.UnsupportedLanguage:case C.M$.UnsupportedTextAnalysisType:case C.M$.AskForClarification:case C.M$.LLMThrottledError:case C.M$.LLMHttpRequestError:case C.M$.LLMTimeout:case C.M$.LLMGenericError:case C.M$.BlockedByRAI:return!1;default:(0,_.x)(e)}},ht=(e,t,a)=>(n,o)=>{const r=o().selection.tabularRanges[e]??{},i=(0,N.f_)(t,r,a);n(p.m.updateTableInterpretationsForSheet({sheetId:e,newInterpretations:i}))},gt=(e,t,a)=>async n=>{const o=await n(Ge(a)),r=new c.y(o.sheetId),i=r.getTranslations(o.rowIndex,o.columnIndex),l=(0,q.gT)(i,e,t,!0,!1);await r.resolveJobs();const s=await l;return n(ke(a,s,void 0,t))},pt=(e,t,a)=>async n=>{const o=await n(Ge(a)),r=new c.y(o.sheetId),i=r.getTranslations(o.rowIndex,o.columnIndex),l=e.map((e=>(0,q.gT)(i,e,t,!0,!1)));await r.resolveJobs();const s=await Promise.all(l);return n(Ye(a,s,void 0,[t]))},bt=(e,t,a,n)=>async o=>{try{const{message:r,telemetry:i}=ue.n.getAnalyzeDataUserChat("Reanalyze");l.$.getInstance().displayResponse(r,i);const s=n??(0,he.A)();k.M.userQueryGuid=s,S.B.userQueryGuid=s,o(B.m.setLatestRequestId(s)),o((0,se.eM)(b.OP.AnalyzeData));const c=await o(He(e)),d={data:{valueRows:[],formatRows:[],formatLocalRows:[],textRows:[]},contentLanguageHint:"en"};if(c)for await(const e of c){const t=ye(e);d.data.valueRows.push(...t.data.valueRows),d.data.formatRows.push(...t.data.formatRows),d.data.formatLocalRows.push(...t.data.formatLocalRows),d.data.textRows.push(...t.data.textRows)}const u=new I.g0({parentPath:["Signal","AugLoop_ExcelAnalysis_ExcelAnalysisSignal"],items:[{id:v.r.generateId(),body:{H_:{T_:"AugLoop_ExcelAnalysis_ExcelAnalysisSignal",B_:["AugLoop_Signals_Signal"]},query:t,queryId:s,context:JSON.stringify(d),config:{model:a}}}]});l.$.getInstance().submitOperation({operation:u,workflowAnnotationType:m.Yn.getTypeName()})}catch(e){(0,z.cY)("Error in submitOperation",e),await o((0,se.L4)())}},ft=e=>async t=>{try{const a=(0,n.W4k)(),{message:o,telemetry:r}=ue.n.getAnalyzeDataUserChat(a);l.$.getInstance().displayResponse(o,r),t((0,se.eM)(b.OP.InsertAnalyzeData)),await(0,P.Ms)(e),await t((0,se.L4)())}catch(e){if(await t((0,se.L4)()),k.M.getInstance().logErrorCode(o.O.InsertionFailed,e,L.S2.AnalyzeDataError,f.$b.ASHA),e instanceof OfficeExtension.Error&&e.code===OfficeExtension.ErrorCodes.accessDenied){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_Protection_Settings,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,n.V7x)());l.$.getInstance().displayResponse(e,t)}else if(e instanceof OfficeExtension.Error&&e.code===Excel.ErrorCodes.invalidOperationInCellEditMode){k.M.getInstance().logStandardizedAshaErrorEvent(i.W.User_Access_Issue_For_Copilot,r.c.Failed_Insight_Insertion_Due_To_User_Edits,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,n.WJg)());l.$.getInstance().displayResponse(e,t)}else{k.M.getInstance().logStandardizedAshaErrorEvent(i.W.Unable_To_Complete_Task,r.c.Failed_Insight_Insertion,b.BJ.AnalyzeData);const{message:e,telemetry:t}=ue.n.getAnalyzeDataErrorResponse((0,n.OSb)());l.$.getInstance().displayResponse(e,t)}}}},911126:(e,t,a)=>{"use strict";a.d(t,{$o:()=>v,X$:()=>x,rE:()=>w});var n=a(700853),o=a(322466),r=a(83437),i=a(267324),l=a(255448),s=a(9847),c=a(965634),d=a(956258),u=a(797639),m=a(299512),h=a(186998),g=a(528804),p=a(644737),b=a(703227),f=a(463345),C=a(479592),y=a(507628);function v(e){return e===s.q0.UnsupportedTabularRange||e===s.q0.NoTableLikeEntityFound||e===s.q0.UnsupportedObjectDetected||e===s.q0.TLRAutofixSuggestion}async function x(e){const t=u.CP.getActiveTable()?.address,a=u.CP.getActiveTable()?.tableLikeRangeFeatures,v=()=>({message:I((0,i.MKr)().replace("\n\n","\n\n&nbsp;\n\n")),telemetry:{featureName:s.q.ContextInference,eventType:s.a5.ErrorMessage,errorType:s.q0.NoTableLikeEntityFound}}),x=(0,m.kB)(e);if(t&&a&&x){const e=x&a;if(0===e)return d.M.getInstance().logError({eventType:c.S2.TabularRange,errorMessage:"No unsupported TLR features found",logLevel:r.$b.Warning}),v();const s=(0,m.kw)(e),u=await(0,m.Ks)(s);return 1===u.length?await E(t,e,u):await async function(e,t,a){let r=a;t&l.ye.RowMajor&&(r=[l.ye.RowMajor]);if(r=(0,m.S5)(r),1===r.length)return E(e,t,r);if(await(0,C.f6)(t)){return{message:await(0,h.ge)(e,t),telemetry:S(t)}}const s=r.map((e=>({header:(0,m.Ah)(e),description:(0,m.f0)(e)}))),c=(0,i.S7l)().replace("{range}",(0,b.G2)(e)),d=(0,g.yw9)("OfficeVSO_9267571_DisplayConvertToTableConclusionMessage")?(0,m.hd)(r):(0,i.VH3)(),u=function(e,t,a){const r=(0,y.A)();return{chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:R(e,t,a),horizontalTableScroll:!0,componentsOverride:(0,f.G)(e)}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,feedbackData:{feedbackArea:"Copilot\\Context Inference"},shouldShowFeedbackSection:!0,messageId:r,actionButtonList:(0,g.jHv)()?[(0,p.yo)(r)]:void 0},addCardToChatHistory:!0}}(s,c,d),v=T(t);return{message:u,telemetry:v}}(t,e,u)}return v()}function T(e){return{featureName:s.q.ContextInference,eventType:s.a5.ErrorMessage,errorType:s.q0.UnsupportedTabularRange,errorDetails:{TabularRangeUnsupportedFeature:e}}}function S(e){return{featureName:s.q.ContextInference,eventType:s.a5.ErrorMessage,errorType:s.q0.TLRAutofixSuggestion,errorDetails:{TabularRangeUnsupportedFeature:e}}}function w(e){const t=function(e){const t=(0,y.A)();return{chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:"chat",messageHeader:{text:e}}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,g.jHv)()?[(0,p.yo)(t)]:void 0,feedbackData:{feedbackArea:"Copilot\\Context Inference"}},addCardToChatHistory:!0}}((0,m.ey)(e)),a=function(e){const t=e===l.b_.PayloadTooLarge?s.q0.LargeData:s.q0.UnsupportedObjectDetected;return{featureName:s.q.ContextInference,eventType:s.a5.ErrorMessage,errorType:t,errorDetails:{UnsupportedContextFeature:e}}}(e);return{message:t,telemetry:a}}async function E(e,t,a){const n=a[0];let o;if(await(0,C.f6)(n)){o=await(0,h.ge)(e,n);return{message:o,telemetry:S(n)}}o=I((0,m.Zv)(n).replace("{range}",(0,b.G2)(e)));return{message:o,telemetry:T(t)}}function I(e){const t=(0,y.A)();return{chatCardType:n._.MarkdownCard,chatMessageData:{markDownCardProps:{user:"chat",message:e,horizontalTableScroll:!0}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!0,feedbackSectionPosition:o.O.Footer,shouldShowFeedbackSection:!0,messageId:t,actionButtonList:(0,g.jHv)()?[(0,p.yo)(t)]:void 0,feedbackData:{feedbackArea:"Copilot\\Context Inference"}},addCardToChatHistory:!0}}function R(e,t,a){let n=`${t}\n`;return e.forEach((e=>{n+=`\n- ${e.header}\n\n`})),n+=`\n\n${a}`,n}},911443:(e,t,a)=>{"use strict";a.d(t,{DY:()=>l,_s:()=>o,dD:()=>s});var n,o,r=a(352628),i=(n=function(e,t){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])},n(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}),l=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return i(t,e),t}(function(e){function t(t,a){var n=e.call(this,a)||this;return n.name=t,n}return i(t,e),t}(Error));!function(e){e.FailedToLoadStrings="FailedToLoadStrings",e.InvalidInput="InvalidInput"}(o||(o={}));var s=function(){function e(){this.DEFAULT_LOCALE="en-US",this.isTier2LanguageSupportEnabled=!1,this.isTier2RTLLanguageEnabled=!1,this.isTier3LanguagesEnabled=!1,this.isTier2Point5LanguagesEnabled=!1,this.isTier4LanguagesEnabled=!1,this.supportedLanguages=[]}return Object.defineProperty(e.prototype,"IsTier2LanguageSupportEnabled",{set:function(e){this.isTier2LanguageSupportEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2RTLLanguageEnabled",{set:function(e){this.isTier2RTLLanguageEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier3LanguagesEnabled",{set:function(e){this.isTier3LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier2Point5LanguagesEnabled",{set:function(e){this.isTier2Point5LanguagesEnabled=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"IsTier4LanguagesEnabled",{set:function(e){this.isTier4LanguagesEnabled=e},enumerable:!1,configurable:!0}),e.prototype.GetSupportedLanguageCode=function(e){switch(e){case"es-US":case"es-419":case"es-PE":return"es-MX";case"en":case"en-CA":return"en-US";case"sv":return"sv-SE";case"it":return"it-IT";case"th":return"th-TH";case"de":return"de-DE";default:return e}},e.prototype.FormatLanguageCode=function(e){var t=e.split("-");if(1===t.length)return t[0].toLowerCase();if(t.length>1&&(t[0]=t[0].toLowerCase(),t[t.length-1]=t[t.length-1].toUpperCase()),t.length>2)for(var a=1;a<t.length-1;a++)t[a]=t[a].charAt(0).toUpperCase()+t[a].slice(1).toLowerCase();return t.join("-")},e.prototype.GetDefaultLanguageCode=function(e){for(var t=e.split("-"),a=0;a<this.supportedLanguages.length;a++){var n=this.supportedLanguages[a];if(t[0]===n.split("-")[0])return n}return e},e.prototype.getUserLanguage=function(e){var t="";if(null==e)throw new l(o.InvalidInput," Display Language is undefined or null");var a=this.FormatLanguageCode(e);return t=this.GetSupportedLanguageCode(a),this.SetSupportedLanguagesList(),-1===this.supportedLanguages.indexOf(t)&&(t=this.GetDefaultLanguageCode(t)),-1===this.supportedLanguages.indexOf(t)&&(t=this.DEFAULT_LOCALE),t},e.prototype.SetSupportedLanguagesList=function(){this.supportedLanguages=r.h7,this.isTier2LanguageSupportEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.k$),this.isTier2RTLLanguageEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.b_))),this.isTier3LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.LJ)),this.isTier2Point5LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.zi)),this.isTier4LanguagesEnabled&&(this.supportedLanguages=this.supportedLanguages.concat(r.GN))},e}()},912477:(e,t,a)=>{"use strict";a.d(t,{uq:()=>v,KF:()=>D,U2:()=>p,xR:()=>_,GM:()=>S,MK:()=>B,pE:()=>x});var n=a(507628),o=a(365319),r=a(888405),i=a(9847),l=a(758651);const s={Equals:async function(e){if(!e.path||void 0===e.value)throw new Error("Invalid 'Equals' assertion data");const t=e.path.match(/worksheets\.\[(\d+)\]\.\[([A-Z0-9:]+)\]\.value/);if(!t)return!1;const a=parseInt(t[1],10),n=t[2];return Excel.run((async t=>{const o=t.workbook.worksheets;o.load("items"),await t.sync();const r=o.items[a],i=r.getRange(n);return i.load("values"),await t.sync(),l.log(`Grading: Checking if values: ${i.values} on range address ${n} in worksheet ${r.name} matches assertion values ${e.value}`),JSON.stringify(i.values)===JSON.stringify(e.value)}))}};async function c(e){const t=e.expression.map((e=>e.map((e=>e.startsWith("!")?{name:e.substring(1),negate:!0}:{name:e,negate:!1}))));const a={};for(const t of Object.keys(e.assertions)){const n=e.assertions[t],o=s[n.kind];void 0!==o?a[t]=await o(n):l.log(`Grading: Skipping computing assertions of the kind, "${n.kind}", for it to be computed in the later stages.`)}for(const e of t){let t=!0,n=!0;for(const o of e){const e=a[o.name];if(void 0===e){n=!1;break}if(e===o.negate){t=!1;break}}if(t||!n)return!0}return!1}var d=a(528804),u=a(267324),m=a(533972),h=a(922873);class g{static generateRows(e){return e.map(((e,t)=>{const a=e.test,n=a.worked?"Passed":"Failed",o=a.endToEndTime,r=a.create.workbook;return`\n          <tr class="${n}">\n              <td>${t+1}</td>\n              <td>${a.query}</td>\n              <td>${r}</td>\n              <td>${n}</td>\n              <td>${o}</td>\n          </tr>\n        `})).join("")}static generateHTMLReport(e){return`\n      <!DOCTYPE html>\n      <html lang="en">\n      <head>\n          <meta charset="UTF-8">\n          <title>Automated End-to-End Tests Report</title>\n          <style>\n              body { font-family: Arial, sans-serif; padding: 20px; }\n              table { width: 100%; border-collapse: collapse; margin-top: 20px; }\n              th, td { border: 1px solid #ccc; padding: 8px; text-align: left; }\n              th { background-color: #f2f2f2; }\n              .passed { background-color: #d4edda; }\n              .failed { background-color: #f8d7da; }\n          </style>\n      </head>\n      <body>\n          <h1>Automated End-to-End Tests Report</h1>\n          <table>\n              <thead>\n                  <tr>\n                      <th>#</th>\n                      <th>Query</th>\n                      <th>File</th>\n                      <th>Status</th>\n                      <th>End-To-End Time(ms)</th>\n                  </tr>\n              </thead>\n              <tbody>\n                  ${this.generateRows(e)}\n              </tbody>\n          </table>\n      </body>\n      </html>\n    `}}var p,b=a(797639),f=a(386552),C=a(79458),y=a(758651);!function(e){e[e.Running=0]="Running",e[e.Success=1]="Success",e[e.Failure=2]="Failure"}(p||(p={}));const v=["None","Test Started","Creating Test Workbook","Using Existing Workbook State","Test Workbook Created","Deleting temporary worksheet","Starting Test Execution","Using Prefetched Server Output","Using Prefetched Server Error","Creating AugLoop Signal","Sending Augloop Signal","Augloop Data Received","Reached Executor","Finished Editing","Test Execution Finished","Manually Checking Test Changes","Automatically Checking Test Changes","Automatically Checking Test With No Checking Code","Workbook Context Extracted"];function x(e){return v.includes(e)}class T extends Error{extractAllProperties(e){if("object"==typeof e){if(Array.isArray(e))return e.map((e=>this.extractAllProperties(e)));if(null===e)return e;const t={},a=new Set(Object.getOwnPropertyNames(e));for(const t of Object.keys(e))a.add(t);for(const n of a)t[n]=e[n];return t}return e}assign(e){e[this.name[0].toLowerCase()+this.name.substring(1)]=this.extractAllProperties(this.propertyValue)}constructor(e,t=!0){super(),this.propertyValue=t,this.name=e}}class S extends T{constructor(e){super("WorkbookPreparationError",e)}}class w extends T{constructor(e){super("WorkbookCheckingError",e)}}class E extends T{constructor(){super("ManualChangeCheckFailed")}}class I extends T{constructor(){super("AutomatedChangeCheckFailed")}}class R extends T{constructor(){super("NoCheckProvidedError")}}class A extends T{constructor(){super("TimeoutError")}}class L extends T{constructor(e,t){super("WrongSkillCalledError",{actual:e,required:t})}}class k extends T{constructor(e){super("AugloopServerError",e)}}class F extends T{constructor(e){super("EditingError",e)}}class _ extends T{constructor(e,t){super("TestingError",{testingFunction:e,error:t})}}class P{tryTestingFunction(e,t,a){if(this.activeTestId===e&&this.callbacks)try{a()}catch(e){this.callbacks.error(new _(t.name,e))}}startTest(e,t,a,n=!1,o){(0,d.usH)()&&(this.startAugloopCallTime=Date.now(),this.activeTestId=e,this.callbacks=a,this.requiredSkillUsed=t,this.receivedAugloopResponse=!1,this.isEvalVNextFlow=n,this.evalVNextOptions=o,this.cancelTimeout=window.setTimeout((()=>this.callbacks?.error(new A)),P.TEST_TIME_LIMIT))}stopTest(){this.activeTestId=null,this.callbacks=null,this.requiredSkillUsed=void 0,this.startAugloopCallTime=null,this.endAugloopCallTime=null,this.startEditTime=null,this.endEditTime=null,this.receivedAugloopResponse=!1,clearTimeout(this.cancelTimeout),this.cancelTimeout=void 0}getAugloopCallTime(){return null!==this.startAugloopCallTime&&null!==this.endAugloopCallTime?this.endAugloopCallTime-this.startAugloopCallTime:null}getEditTime(){return null!==this.startEditTime&&null!==this.endEditTime?this.endEditTime-this.startEditTime:null}augloopErrorReceived(e,t){this.tryTestingFunction(e,this.augloopErrorReceived,(()=>{const e=t.json?JSON.parse(t.json):t;this.callbacks.error(new k(e))}))}augloopResponseReceived(e,t,a){this.tryTestingFunction(e,this.augloopResponseReceived,(()=>{if(this.receivedAugloopResponse)return;this.endAugloopCallTime=Date.now(),!0===a.isFinalResponse&&(this.receivedAugloopResponse=!0);let e="";switch(this.requiredSkillUsed){case i.q.OfficeJsCommanding:e=h.w.EditDocumentName;break;case i.q.CalculatedColumns:e=h.w.CalculatedColumnsName;break;case i.q.AnalyzeData:e=h.w.ChartsAndPivotTablesName;break;case i.q.DataShaping:e=h.w.DataShapingName;break;case i.q.Python:e=(0,d.yw9)("OfficeVSO_10393641_UpdateAASkillName")&&(0,d.EJJ)()?h.w.NewPythonSkillName:h.w.PythonSkillName;break;case i.q.Answers:e=h.w.AnswersName}if(this.callbacks.augloopResponseReceived(t,a),e&&e!==t)this.callbacks.error(new L(t,e));else if(this.isEvalVNextFlow&&this.receivedAugloopResponse)if(this.endAugloopCallTime=Date.now(),this.evalVNextOptions?.applySuggestion){const e=o.$.getInstance().getLastMessage(),t=e&&Array.isArray(e.actionBarButtons)?e.actionBarButtons:[],a=t.length>0?t[0]:void 0;if(a){a.handleButtonOnClick();const e=5e3,t=this.evalVNextOptions?.pageOperationTimeout??9e4,n=Date.now(),r=o.$.getInstance().getLastMessage(!1),i=(e,a)=>e.getLastMessage(!1)?.messageId===a?.messageId?Date.now()-n>t?(clearInterval(this.pollInterval),clearTimeout(this.pollTimeout),void this.callbacks.finished()):void 0:(clearInterval(this.pollInterval),clearTimeout(this.pollTimeout),void this.callbacks.finished());i(o.$.getInstance(),r),this.pollInterval=window.setInterval((()=>i(o.$.getInstance(),r)),e),this.pollTimeout=window.setTimeout((()=>{clearInterval(this.pollInterval),this.callbacks.finished(),clearTimeout(this.pollTimeout)}),t)}else this.callbacks.error(new F("No suggestion button found to apply"))}else this.callbacks.finished()}))}reachedSkillExecutor(e,t,...a){this.tryTestingFunction(e,this.reachedSkillExecutor,(()=>{this.callbacks.reachedSkillExecutor(t,...a)}))}acceptUpcomingChange(e,t){this.tryTestingFunction(e,this.acceptUpcomingChange,(async()=>{const e=`button[title="${(0,u.yZI)()}"]`;try{await new Promise(((t,a)=>{let n=0;const o=window.setInterval((()=>{const a=document.querySelector(e);a&&!a.disabled&&(clearInterval(o),clearTimeout(n),t(a))}),200);n=window.setTimeout((()=>{clearInterval(o),a(new Error(`"${e}" not enabled within 50000ms`))}),5e4)})),t()}catch(e){this.callbacks.error(new F(e))}}))}editStarted(e){this.tryTestingFunction(e,this.editStarted,(()=>{this.startEditTime=Date.now()}))}editFinished(e,t,a,...n){this.tryTestingFunction(e,this.editFinished,(()=>{this.endEditTime=Date.now(),this.callbacks.editFinished(t,a,...n),a?this.callbacks.finished(t):this.callbacks.error(new F(n))}))}constructor(){this.activeTestId=null,this.callbacks=null,this.requiredSkillUsed=void 0,this.isEvalVNextFlow=!1,this.evalVNextOptions=void 0,this.startAugloopCallTime=null,this.endAugloopCallTime=null,this.startEditTime=null,this.endEditTime=null,this.cancelTimeout=void 0,this.receivedAugloopResponse=!1,this.pollInterval=void 0,this.pollTimeout=void 0}}async function N(){let e,t=0,a=0,n=new Uint8Array(0);return new Promise((o=>{function r(i){e?.getSliceAsync(i,(e=>{if(e.status===Office.AsyncResultStatus.Succeeded){const{data:l}=e.value,s=new Uint8Array(n.length+l.length);s.set(n),s.set(l,n.length),n=s,t++,t===a?o(n):r(i+1)}}))}Office.context.document.getFileAsync(Office.FileType.Compressed,{sliceSize:4194304},(function(t){t.status===Office.AsyncResultStatus.Succeeded?(e=t.value,a=e.sliceCount,r(0)):o(null)}))})).finally((()=>e?.closeAsync()))}async function M(e,t){const a=await N();a&&(0,f.PE)(a,"application/octet-stream",e+".xlsx",t)}async function O(){const e=await N();if(!e)return null;let t="";for(let a=0;a<e.length;a++)t+=String.fromCharCode(e[a]);return btoa(t)}P.TEST_TIME_LIMIT=18e4;class D{addTestToActive(e){this.setTestInfo((t=>(t.push({test:e,state:0,runningState:"Test Started",stateDetails:["Test Started"],initialWorkbookBase64:"",finalWorkbookBase64:""}),this.finishedTests=[...t])))}updateActiveTestInfo(e,t){this.setTestInfo((a=>{const n=a.find((t=>t.test===e));return t(n),this.finishedTests=[...a]}))}failTest(e,t){return this.updateActiveTestInfo(e,(a=>{const n=e.endToEndErrors=e.endToEndErrors??{};n.statesBeforeError=a.stateDetails,a.state=2,a.stateDetails.push("Failed"),t instanceof T?(t.assign(n),a.stateDetails.push(t.name)):(n.unclassified=n.unclassified??[],n.unclassified.push(t)),e.worked=!!e.expectedFailureStates&&e.expectedFailureStates.includes(a.runningState),a.runningState="None"})),!1}passTest(e){this.updateActiveTestInfo(e,(e=>{e.state=1,e.runningState="None",e.stateDetails.push("Passed"),e.test.worked=!0}))}updateTestStateDetails(e,t,a){this.updateActiveTestInfo(e,(e=>{e.runningState=t,a&&e.stateDetails.push(t+": "+a),e.stateDetails.push(t)}))}addTestData(e,t){this.updateActiveTestInfo(e,(e=>{Object.assign(e.test,t)}))}async usePrefetchedData(e,t,a){if(a===i.q.OfficeJsCommanding)this.officeJsCommanding.handleOfficeJsResult(e,t)}transformMessagesToCopilotResponse(e){const t=[];for(const a of e)"bot"===a.author&&(a.text&&t.push({type:"text",content:a.text}),a.code&&t.push({type:"code",content:a.code}),a.output&&t.push({type:"output",content:a.output}));return t}addChatLogToTest(e,t){const a=t?.chatResponse;let n=[];Array.isArray(a?.messagesToAddOrReplace)?n=a.messagesToAddOrReplace:Array.isArray(a?.messages)&&(n=a.messages);const o=e.chatLog??{},r=n.length>0?this.transformMessagesToCopilotResponse(n):void 0,i=[...o.errors??[],...t?.error?[t.error]:[]],l={augloopAnnotations:[...o.augloopAnnotations??[],t],copilotResponse:r?[...o.copilotResponse??[],...r]:o.copilotResponse,messages:n.length>0?[...o.messages??[],...n]:o.messages,errors:i.length>0?i:o.errors};this.addTestData(e,{chatLog:l})}async startTestCase(e){if(this.addTestToActive(e),!e.create.workbook)return this.updateTestStateDetails(e,"Using Existing Workbook State"),!0;this.updateTestStateDetails(e,"Creating Test Workbook"),b.CP.lockContextRefresh();const t=await async function(){return Excel.run((async e=>{const t=e.workbook,a=t.worksheets.load("items");await e.sync();const n="_"+Math.random().toString(16)+"__";t.worksheets.add(n),a.items.forEach((e=>e.delete()));const o=t.names.load("items"),r=t.queries.load("items"),i=t.slicerStyles.load("items/readOnly"),l=t.tableStyles.load("items/readOnly"),s=t.timelineStyles.load("items/readOnly"),c=t.pivotTableStyles.load("items/readOnly");await e.sync(),o.items.forEach((e=>e.delete())),r.items.forEach((e=>e.delete())),i.items.forEach((e=>!e.readOnly&&e.delete())),l.items.forEach((e=>!e.readOnly&&e.delete())),s.items.forEach((e=>!e.readOnly&&e.delete())),c.items.forEach((e=>!e.readOnly&&e.delete()));try{const a=t.styles.load("items/builtIn");await e.sync(),a.items.forEach((e=>!e.builtIn&&e.delete()))}catch{}return n}))}();return this.isEvalVNextFlow||await(0,C.uk)(2e3),await Excel.run((async t=>{const a=this.workbooks[e.create.workbook];if(t.workbook.insertWorksheetsFromBase64(a),this.evalVNextOptions?.fetchWorkbookBase64){await t.sync();const a=await O();this.updateActiveTestInfo(e,(e=>{e.initialWorkbookBase64=a||""}))}})),this.isEvalVNextFlow||await(0,C.uk)(2e3),await Excel.run((async t=>{await async function(e,t){const a=e.workbook;let n=a.worksheets.getActiveWorksheet(),o=t?.name,r="",i=null;switch(t?.type){case"range":{const[i,l]=t.name.split("!");r=l??t.name,o=i;const s=a.worksheets.getItemOrNullObject(o);await e.sync(),s.isNullObject||(n=s);break}case"chart":{const o=a.worksheets.load("items");await e.sync();const r=[];for(const e of o.items)r.push(e.charts.getItemOrNullObject(t.name));await e.sync();const l=r.find((e=>!e.isNullObject));l&&(i=l,n=l.worksheet);break}case"worksheet":{const t=void 0===o||""===o?a.worksheets.getActiveWorksheet():a.worksheets.getItemOrNullObject(o);await e.sync(),t.isNullObject||(n=t,r="A1");break}case"table":{const o=a.tables.getItemOrNullObject(t.name),i=o.getRange().getCell(0,0).load("address");await e.sync(),o.isNullObject||(n=o.worksheet,r=i.address.split("!")[1]??i.address);break}case"pivot table":{const o=a.pivotTables.getItemOrNullObject(t.name),i=o.layout.getRange().getCell(0,0).load("address");await e.sync(),o.isNullObject||(n=o.worksheet,r=i.address.split("!")[1]??i.address);break}}await e.sync(),n.activate(),r&&n.getRange(r).select(),i&&i.activate()}(t,e.create)})),e.create.afterCreationScript&&await new Function("return "+e.create.afterCreationScript.replace(/^await /,""))(),this.updateTestStateDetails(e,"Deleting temporary worksheet"),this.isEvalVNextFlow||await(0,C.uk)(2e3),await Excel.run((async e=>{e.workbook.worksheets.getItemOrNullObject(t).delete()})),await b.CP.releaseContextLock(),this.updateTestStateDetails(e,"Test Workbook Created"),!0}async executeTestCase(e){let t,a,r=null;if(this.updateTestStateDetails(e,"Starting Test Execution"),e.requiredFeatureUsed===i.q.OfficeJsCommanding)e.officeScripts&&(t=e.officeScripts,a=e.officeScripts.error);t&&(r=e.serverTime?e.serverTime:0);let l=null;await new Promise(((r,i)=>{const l=(0,n.A)();return B.startTest(l,e.requiredFeatureUsed,{finished:r,error:i,augloopResponseReceived:this.augloopResponseReceived.bind(this,e),reachedSkillExecutor:this.reachedSkillExecutor.bind(this,e),editFinished:this.editFinished.bind(this,e)},this.isEvalVNextFlow,this.evalVNextOptions),a?(this.updateTestStateDetails(e,"Using Prefetched Server Error"),void B.augloopErrorReceived(l,a)):t?(this.updateTestStateDetails(e,"Using Prefetched Server Output"),this.reachedSkillExecutor(e,e.requiredFeatureUsed,t),void this.usePrefetchedData(l,t,e.requiredFeatureUsed)):(this.updateTestStateDetails(e,"Creating AugLoop Signal"),void this.communicationHandler.getDefaultSignalOperation(e.query,l).then((t=>{this.updateTestStateDetails(e,"Sending Augloop Signal");const a=t.operation.items[0].body;a.context=e.context=e.context??a.context,this.addTestData(e,{augloopInputBody:a}),o.$.getInstance().submitOperation(t)})))})).catch((e=>l=e)),r=r||B.getAugloopCallTime();const s=B.getEditTime(),c=null!==r&&null!==s?r+s:null;if(this.addTestData(e,{endToEndTime:c,serverTime:r,editTime:s}),B.stopTest(),l)throw l;return this.updateTestStateDetails(e,"Test Execution Finished"),!0}async checkTestCase(e){if(this.manuallyCheckTest){this.updateTestStateDetails(e,"Manually Checking Test Changes");const t=await new Promise((t=>{this.manuallyCheckTest({test:e,resolve:t})}));return this.manuallyCheckTest(void 0),t?this.passTest(e):this.failTest(e,new E),t}let t=e.check;if(e.grader&&!t&&(t=`evaluateGrader(JSON.parse(${JSON.stringify(JSON.stringify(e.grader))}));`),t){this.updateTestStateDetails(e,"Automatically Checking Test Changes");const a=await new Function("checkHelpers","evaluateGrader","return "+t.replace(/^await /,""))(D.checkHelpers,c);let n=!1;return"boolean"==typeof a?n=a:(n=a?.passed,this.addTestData(e,{evaluationDetails:a})),n?this.passTest(e):this.failTest(e,new I),n}return this.updateTestStateDetails(e,"Automatically Checking Test With No Checking Code"),this.passOnNoCheck?(this.passTest(e),!0):(this.failTest(e,new R),!1)}async run(){let e=!1;const t=Math.ceil(Math.log10(this.tests.length)),a=this.tests.map((e=>e.category)).filter(((e,t,a)=>e&&a.indexOf(e)===t)).length===this.tests.length;for(const[n,o]of this.tests.entries()){n&&!this.isEvalVNextFlow&&await(0,C.uk)(2e3);const r=a?`${o.category}.${this.testFilename}`:`#${n.toString().padStart(t,"0")} (${o.query.length>50?o.query.substring(0,50)+" ...":o.query})`;try{this.setCancelTests({reject:()=>{e=!0,t=!1}});let t=!0;if(t=await this.startTestCase(o).catch((e=>this.failTest(o,new S(e)))),!t)continue;if(this.saveStates&&await M(`${r}  --  (before)`,this.workbookDirHandle),t=await this.executeTestCase(o).catch((e=>this.failTest(o,e))),this.saveStates&&await M(`${r}  --  (after)`,this.workbookDirHandle),!t)continue;if(await this.checkTestCase(o).catch((e=>{this.failTest(o,new w(e))})),this.evalVNextOptions?.fetchWorkbookBase64){const e=await O();this.updateActiveTestInfo(o,(t=>{t.finalWorkbookBase64=e||""}))}this.setCancelTests({reject:()=>{}})}catch(e){this.failTest(o,new _(this.run.name,e))}if(e)return this.finishedTests}y.log(this.finishedTests);let n=JSON.stringify(this.finishedTests.map((e=>e.test)));for(const[e,t]of Object.entries(this.workbooks))n=n.replace(t,`<${e} base64 data>`);if(!this.isEvalVNextFlow){const e=g.generateHTMLReport(this.finishedTests);await(0,f.PE)(n,"application/json",`results-${this.testFilename}.json`,this.resultFileDirHandle),await(0,f.PE)(e,"text/html",`report-${this.testFilename}.html`,this.resultFileDirHandle)}return this.finishedTests}constructor(e,t,a,n,o,l,s,c,d,u,m,h=!1,g=void 0){this.workbooks=t,this.communicationHandler=n,this.passOnNoCheck=o,this.saveStates=l,this.setTestInfo=s,this.setCancelTests=c,this.manuallyCheckTest=d,this.resultFileDirHandle=u,this.workbookDirHandle=m,this.isEvalVNextFlow=h,this.evalVNextOptions=g,this.finishedTests=[],this.augloopResponseReceived=(e,t,a)=>{this.addChatLogToTest(e,a),this.addTestData(e,{skillCalled:t,augloopOutputBody:a}),!0===a.isFinalResponse&&this.updateTestStateDetails(e,"Augloop Data Received")},this.reachedSkillExecutor=(e,t,...a)=>{switch(this.updateTestStateDetails(e,"Reached Executor",t),t){case i.q.OfficeJsCommanding:{const t=a[0];this.addTestData(e,{officeScripts:t});break}}},this.editFinished=(e,t,a,...n)=>{switch(this.updateTestStateDetails(e,"Finished Editing",t),t){case i.q.OfficeJsCommanding:{const t=n[0],o={...e.officeScripts=e.officeScripts??{}};o.codeCompletedSuccessfully=a,this.addTestData(e,{officeScripts:o,returnedMessage:t});break}}},this.tests=e.tests,this.testFilename=e.filename,this.officeJsCommanding=new r.$v(a),this.evalVNextOptions=g,this.isEvalVNextFlow=h}}D.checkHelpers=new class{getExactColorName(e){return m.g.colorNameFromHEX(e)?.toLowerCase()??""}getGeneralColorName(e){return m.g.colorNameFromHEX(e,!0)?.toLowerCase()??""}levenshteinDistance(e,t){let a=e,n=t;a.length>n.length&&(a=t,n=e);const o=[];for(let e=0;e<=a.length;e++)o[e]=e;for(let e=1;e<=n.length;e++){let t=e;for(let r=1;r<=a.length;r++){let i=-1;i=n.charAt(e-1)===a.charAt(r-1)?o[r-1]:Math.min(o[r-1]+1,t+1,o[r]+1),o[r-1]=t,t=i}o[a.length]=t}return o[a.length]}closestString(e,t){let a="",n=1/0;for(const o of t){const t=this.levenshteinDistance(e,o);if(0===t)return o;t<n&&(a=o,n=t)}return a}getGeneralChartType(e){switch(e){case Excel.ChartType.columnClustered:case Excel.ChartType.columnStacked:case Excel.ChartType.columnStacked100:case Excel.ChartType._3DColumn:case Excel.ChartType._3DColumnClustered:case Excel.ChartType._3DColumnStacked:case Excel.ChartType._3DColumnStacked100:return Excel.ChartType.columnClustered;case Excel.ChartType.barClustered:case Excel.ChartType.barStacked:case Excel.ChartType.barStacked100:case Excel.ChartType._3DBarClustered:case Excel.ChartType._3DBarStacked:case Excel.ChartType._3DBarStacked100:return Excel.ChartType.barClustered;case Excel.ChartType.line:case Excel.ChartType.lineStacked:case Excel.ChartType.lineStacked100:case Excel.ChartType.lineMarkers:case Excel.ChartType.lineMarkersStacked:case Excel.ChartType.lineMarkersStacked100:case Excel.ChartType._3DLine:return Excel.ChartType.line;case Excel.ChartType.pie:case Excel.ChartType.pieOfPie:case Excel.ChartType.pieExploded:case Excel.ChartType._3DPieExploded:case Excel.ChartType.barOfPie:case Excel.ChartType._3DPie:return Excel.ChartType.pie;case Excel.ChartType.xyscatter:case Excel.ChartType.xyscatterSmooth:case Excel.ChartType.xyscatterSmoothNoMarkers:case Excel.ChartType.xyscatterLines:case Excel.ChartType.xyscatterLinesNoMarkers:return Excel.ChartType.xyscatter;case Excel.ChartType.area:case Excel.ChartType.areaStacked:case Excel.ChartType.areaStacked100:case Excel.ChartType._3DArea:case Excel.ChartType._3DAreaStacked:case Excel.ChartType._3DAreaStacked100:return Excel.ChartType.area;case Excel.ChartType.surface:case Excel.ChartType.surfaceWireframe:case Excel.ChartType.surfaceTopView:case Excel.ChartType.surfaceTopViewWireframe:return Excel.ChartType.surface;case Excel.ChartType.doughnut:case Excel.ChartType.doughnutExploded:return Excel.ChartType.doughnut;case Excel.ChartType.radar:case Excel.ChartType.radarMarkers:case Excel.ChartType.radarFilled:return Excel.ChartType.radar;case Excel.ChartType.bubble:case Excel.ChartType.bubble3DEffect:return Excel.ChartType.bubble;case Excel.ChartType.stockHLC:case Excel.ChartType.stockOHLC:case Excel.ChartType.stockVHLC:case Excel.ChartType.stockVOHLC:return Excel.ChartType.stockHLC;case Excel.ChartType.cylinderColClustered:case Excel.ChartType.cylinderColStacked:case Excel.ChartType.cylinderColStacked100:case Excel.ChartType.cylinderBarClustered:case Excel.ChartType.cylinderBarStacked:case Excel.ChartType.cylinderBarStacked100:case Excel.ChartType.cylinderCol:return Excel.ChartType.cylinderBarClustered;case Excel.ChartType.coneColClustered:case Excel.ChartType.coneColStacked:case Excel.ChartType.coneColStacked100:case Excel.ChartType.coneBarClustered:case Excel.ChartType.coneBarStacked:case Excel.ChartType.coneBarStacked100:case Excel.ChartType.coneCol:return Excel.ChartType.coneColClustered;case Excel.ChartType.pyramidColClustered:case Excel.ChartType.pyramidColStacked:case Excel.ChartType.pyramidColStacked100:case Excel.ChartType.pyramidBarClustered:case Excel.ChartType.pyramidBarStacked:case Excel.ChartType.pyramidBarStacked100:case Excel.ChartType.pyramidCol:return Excel.ChartType.pyramidColClustered;default:return e}}};const B=new P},922873:(e,t,a)=>{"use strict";var n,o;a.d(t,{w:()=>n,x:()=>o}),function(e){e.AnswersName="answers",e.CannedResponse="annrules",e.ElseSkillName="excel_else",e.GetInsightsName="get_insights",e.ChartsAndPivotTablesName="charts_and_pivot_tables",e.TextAnalysisName="text_analysis",e.SelfHelpSkillName="self_help_search",e.CalculatedColumnsName="calculated_columns",e.CreateCalculatedColumnsName="create_calculated_columns",e.DataShapingName="data_shaping",e.EditDocumentName="edit_document",e.SearchEnterpriseName="search-enterprise",e.OfficeScriptsName="office_scripts",e.PythonSkillName="get_python_code",e.PythonCalculatedColumnsName="python_calculated_columns",e.GenerateResponseName="generate_response",e.ImageChatName="image-chat",e.AugLoopEvalName="AugmentationLoopEval",e.AugLoopName="AugmentationLoop",e.GetContextName="get_context",e.FormulasName="formulas",e.FormatDocumentName="format_document",e.Workflow="workflow",e.DeepLeo="DeepLeo",e.SearchToolsRequestInterstitialsPublisher="SearchToolsRequestInterstitialsPublisher",e.SearchToolsResponseInterstitials="SearchToolsResponseInterstitials",e.Unknown="Unknown",e.ExcelAnalysis="excel_analysis",e.NewPythonSkillName="start_analysis_mode"}(n||(n={})),function(e){e.QuickAnswer="QuickAnswer",e.HelpArticle="HelpArticle"}(o||(o={}))},923263:(e,t,a)=>{"use strict";a.d(t,{H:()=>r});var n=a(214289),o=a(507628);class r{constructor(){this.scripts=[],this.scriptListPopulated=!1,this.getScriptExists=e=>this.scripts.findIndex((t=>t.name===e))>-1,this.getScripts=()=>this.scripts,this.pushScript=e=>{this.scripts.push(e)},this.popScript=()=>{this.scripts.pop()},this.populateScriptsList=async()=>{if(!this.scriptListPopulated)try{const e=new n.L;this.scripts=await e.getCopilotScripts((0,o.A)()),this.scriptListPopulated=!0}catch{return}}}}r._instance=void 0,r.getInstance=()=>(void 0===r._instance&&(r._instance=new r),r._instance)},923971:(e,t,a)=>{"use strict";a.d(t,{X:()=>$,u:()=>V});var n=a(725556),o=(a(117463),a(267324)),r=a(95151),i=a(632512),l=a(944032),s=a(932367),c=a(754440),d=a(576583),u=a(376116),m=a(340267),h=a(486092),g=a(178502),p=a(9847),b=a(416223),f=a(654417),C=a(70100),y=a(476730),v=a(956258),x=a(8745);const T=(0,d.n)({description:{...u.g.body1,"& > p:first-child":{marginTop:0}}});function S({id:e,suggestionId:t,title:a,formula:r,explanation:i,description:l,role:c,onFirstTimeExplanationShown:d,loadingTimeouts:u,icon:y,descriptionAfterFormula:v}){const x=(0,m.Bi)("formula-title-"),S=T(),E=w(`explanation[${e}]`,Boolean(i),u.explanation,s.c.Formula_Explanation_Failed_To_Display,p.OP.FormulaExplanationAvailable),I=w(`description[${e}]`,Boolean(l),u.description,s.c.Formula_Description_Failed_To_Display,p.OP.FormulaDescriptionAvailable);const R=(0,n.jsx)(b.u,{text:function(e){switch(I){case"loading":return;case"timeout":return o.olU.FormulaSuggestion_Description_NotAvailable;default:return e}}(l),className:(0,h.z)(S.description,"formula-description")});return(0,n.jsxs)(C.B,{role:c,tokens:{childrenGap:8},"aria-labelledby":x,children:[a&&(0,n.jsx)(g.V,{id:x,role:"heading","aria-level":2,"data-testid":"formula-title",children:a}),!v&&R,(0,n.jsx)(f.$,{icon:y??"math",content:r,explanation:{explanation:i,isLoading:"loading"===E,isNotAvailable:"timeout"===E,onFirstTimeExplanationShown:d},telemetryUsageFeatureName:p.q.CalculatedColumns,suggestionId:t,getClipboardItem:async()=>new ClipboardItem({"text/plain":new Blob([r],{type:"text/plain"})}),ariaAttributes:{"aria-label":o.olU.FormulaSuggestion_FormulaSnippet_AriaLabel}}),v&&R]})}function w(e,t,a,n,o){return(0,x.rK)(e,t,a,{onTimeout(){v.M.userQueryGuid&&v.M.getInstance().logStandardizedAshaErrorEvent(c.W.UI_Failed_To_Update_Or_Load,n,p.BJ.FormulaGeneration)},onLoaded(e,t){y.E.getInstance().logLatency(e,o,!t)}})}var E=a(278306),I=a(626128),R=a(980214),A=a(135973);const L=({title:e,preview:t,loadingTimeout:a})=>{const o=(0,x.rK)("previewForHeader",Boolean(t),a),r=null!==t&&"object"==typeof t&&"string"==typeof t.headerPreviewValue;switch(o){case"loading":return(0,n.jsx)(R.E,{animation:"wave",appearance:"translucent",style:{width:"100%",height:12,marginLeft:4,marginRight:4},children:(0,n.jsx)(A.H,{size:12})});case"timeout":return null;default:return(0,n.jsxs)(g.V,{children:[e," ",r?`: ${t.headerPreviewValue}`:""]})}};var k=a(83437),F=a(231160),_=a(800862),P=a(965634),N=a(173339),M=a(79458),O=a(528804),D=a(509779),B=a(208442);function $({recommendation:e,...t}){return e?(0,n.jsx)(H,{recommendation:e,...t}):(v.M.getInstance().logErrorCode(i.O.ColumnRecommendationsNotAvailable,new Error("No visible recommendation"),P.S2.FormulaGeneration,k.$b.Warning),(0,n.jsx)(q,{}))}function H({requestId:e,recommendation:t,isMainRecommendation:a,targetAddress:o,targetSheet:r,columnLetters:s,rowNumber:c,showPreview:d,isChatHistoryRehydration:u}){(0,M.cY)("FormulaSuggestion.render",{requestId:e,recommendation:t,isMainRecommendation:a,targetAddress:o,targetSheet:r,columnLetters:s,rowNumber:c,isChatHistoryRehydration:u});const m=(0,B.i)(e,t);void 0===t.suggestionType&&(t.suggestionType=I.VS.Column);const g=(0,D.t)();(0,x.IC)(function(e,t){return t&&"object"==typeof e.preview&&String(e.preview.columnLetters)!==String(t)}(t,s),(()=>{const e={key:p.un.RecommendationId,value:`${t.id}`};v.M.getInstance().logError({logLevel:k.$b.Warning,eventType:P.S2.FormulaGeneration,errorMessage:"columnLetters in the header are different than in the preview."},void 0,[e])}));const b=t.calculatedFormulas.length>1,f=N.R.getFormulaSuggestionUiTimeouts();return(0,n.jsx)(l.lJ,{contentBody:(0,n.jsxs)(C.B,{tokens:{childrenGap:12},className:(0,h.z)(g.columnRecommendation,"column-recommendation"),children:[U(t)&&(0,n.jsx)(L,{title:t.calculatedFormulas[0]?.title,preview:t.preview,loadingTimeout:f.preview}),(0,n.jsx)(E.A,{recommendation:t,isMainRecommendation:a,targetAddress:o,targetSheet:r,columnLetters:s,rowNumber:c}),(0,n.jsx)(C.B,{tokens:{childrenGap:12},role:b?"list":void 0,children:t.calculatedFormulas.map(((e,a)=>(0,n.jsx)(S,{loadingTimeouts:f,id:`${t.id}_${e.id}`,suggestionId:t.id,role:b?"listitem":"group",title:U(t)?void 0:b?`${a+1}. ${e.title}`:e.title,description:e.description,descriptionAfterFormula:U(t),formula:e.formula,explanation:e.formulaExplanation,onFirstTimeExplanationShown:()=>{V(t.id,p.a5.CalculatedColumnsExplainButtonClicked)}},e.id)))}),d&&(0,n.jsx)(_.J,{uiTimeout:f.preview,theme:F.Q1.neutralV2,preview:t.preview,type:t.suggestionType,errorData:{errorCode:i.O.CalculatedColumnPreviewNotUpdated,telemetryType:P.S2.FormulaGeneration,telemetryFeature:p.BJ.FormulaGeneration},isChatHistoryRehydration:!!(0,O.yw9)("OfficeVSO_9899849_dontSendAshaOnRehydration")&&u})]}),requestId:e,cardButtons:m})}function U(e){return e.suggestionType===I.VS.Cell&&!!e.isSingleFormula}function q(){return(0,n.jsx)(r.DefaultMessage,{body:{user:"chat",messageHeader:{text:(0,o.HGr)()}},styles:(0,D.t)(),shouldShowAIGeneratedIndicator:!1})}function V(e,t){y.E.getInstance().updateTelemetryChatEventData({[p.h3.ChatEventType]:t,[p.h3.ChatEventParameters]:e},v.M.getInstance())}},932367:(e,t,a)=>{"use strict";var n;a.d(t,{c:()=>n}),function(e){e.AE_Execution_Unsupported="AE execution unsupported",e.Analyze_Data_AugLoop_Timeout="Analyze Data AugLoop timeout",e.Analyze_Data_Insights_Services_Error="Analyze Data Insights Services error",e.Analyze_Data_Insights_Services_Timeout="Analyze Data Insights Services timeout",e.Analyze_Data_Network_Error="Analyze Data network error",e.Analyze_Data_Other_Error="Analyze Data other error",e.Analyze_Data_Get_Insights_Client_Error="Analyze Data get insights client error",e.Analyze_Data_Evaluate_Query_Client_Error="Analyze Data evaluate query client error",e.Analyze_Data_Text_Analysis_Unsupported_Language="Analyze Data text analysis unsupported language",e.Analyze_Data_LLM_Timeout="Analyze Data LLM timeout",e.Analyze_Data_Undo_Failed="Analyze Data undo failed",e.Answers_Undo_Failed="Answers Undo Failed",e.Answers_User_Thumbs_Down="Answers User Thumbs Down",e.Answers_PostView_Failed="Answers Postview Failed",e.Answers_Bad_Response="Answers Bad Response",e.Answers_Processing_Failed="Answers Processing Failed",e.Apply_Table_Creation_Failed_Due_To_Issue_With_Location="Apply table creation failed due to issue with location",e.Augloop_Error="Unclassified AugLoop error",e.Augloop_Error_Occurred_No_Chat_Response="Augloop Error Occurred with No Chat Response",e.Augloop_Failed_Entitlement_Validation="AugLoop failed to validate the user's Copilot entitlement",e.Augloop_Failed_Input_Error="AugLoop faileddue to AugLoop input error",e.Augloop_Failed_License_Check_Due_To_Missing_Service_Plan_BYOA="AugLoop failed Copilot license check due to missing service plan BYOA",e.Augloop_Failed_License_Check_Due_To_Uncategorized_Error_Code="AugLoop failed Copilot license check due to uncategorized error code",e.Augloop_Failed_License_Check_Due_To_Uncategorized_Error_Reason="AugLoop failed Copilot license check due to uncategorized error reason",e.Augloop_Failed_Token_Validation="AugLoop failed to validate the Copilot user token",e.Augloop_Response_Timed_Out="Augloop Response Timed Out",e.Calculate_Preview_Timeout="Calculate preview timeout",e.Calculate_Suggestion_Timeout="Calculate suggestion timeout",e.Calculated_Column_Out_Of_Scope_Scenarios="Calculated column out of scope scenarios",e.ChartDesignRecommendationsEmptySceneGraph="Chart Recommendation Signal Returned Empty Scenegraph",e.ChartDesignRecommendationsWorkflowFailed="Chart Design Recommendations Workflow Failures",e.Chat_Error_Message_Shown="Chat error message shown (catch-all, may overlap with other errors)",e.Chat_History_Response_Timed_Out="Chat history response timed out",e.Chat_User_Thumbs_Down="Chat user thumbs down",e.Client_Program_Response_Error="Client program response error",e.Command_Execution_Blocked_By_Capacity="Command execution blocked by capacity",e.Command_Execution_Happened_With_No_Confirmation_Of_Action="Command execution happened with no confirmation of action",e.Command_Execution_Took_Too_Long="Command execution took too long",e.Command_Execution_Undo_Failed="Command execution undo failed",e.Command_Scratchpad_Start_New_Session_Failed="Command Scratchpad start new session failed",e.Command_Scratchpad_Office_Js_Execution_Failed_In_Runtime="Command Scratchpad office js execution failed in runtime",e.Command_Scratchpad_Office_Js_Internal_Error="Command Scratchpad office js internal error",e.Command_Scratchpad_Non_Copilot_Safe_Apis_Generated="Command Scratchpad non-copilot safe APIs generated",e.Conditional_Formatting_Execution_Took_Too_Long="Conditional Formatting execution took too long",e.Conditional_Formatting_Failed_Due_To_Out_Of_Scope_Prompt="Conditional Formatting failed due to out of scope prompt",e.Conditional_Formatting_Failed_Due_To_Invalid_Formula="Conditional Formatting failed due to invalid formula",e.Conditional_Formatting_Failed_Due_To_Invalid_Formula_Explanation="Conditional Formatting failed due to invalid formula explanation",e.Conditional_Formatting_Failed_Due_To_Invalid_Targets="Conditional Formatting failed due to invalid targets",e.Conditional_Formatting_No_Suggestions_Error="Conditional Formatting no suggestions error",e.Conditional_Formatting_Suggestions_Error="Conditional Formatting suggestions error",e.Conditional_Formatting_Suggestions_Error_Due_To_No_Table_Selected="Conditional Formatting suggestions error due to no table selected",e.Conditional_Formatting_Undo_Failed="Conditional Formatting execution undo failed",e.Context_Extraction_Error="Context extraction error",e.Disengaged_Error="AugLoop faileddue to Sydney disengage",e.Else_Response_Blocked_Bad_Formula="Response blocked due to invalid formula",e.Else_Response_Blocked_Security_Restricted_Formula="Response blocked due to security restricted formula",e.Else_Response_Blocked_External_Workbook_Reference_Formula="Response blocked due to external workbook reference formula",e.Else_Response_Blocked_Unsupported_Chaining="Response blocked due to unsupported chaining",e.Else_Service_Timed_Out="Service timed out",e.Else_Service_Error="Service error",e.Else_User_Thumbs_Down="User dissatisfied with the suggestion",e.Failed_Column_Insertion="Failed column insertion",e.Failed_Column_Insertion_Due_To_Conflict_In_The_Target_Range="Failed column insertion due to conflict in the target range",e.Failed_Column_Insertion_Due_To_Protection_Settings="Failed column insertion due to protection settings",e.Failed_Column_Insertion_Due_To_Target_Table_Error="Failed column insertion due to target table error",e.Failed_Column_Suggestion_Generation_For_Suggestion_Pill="Failed column suggestion generation for suggestion pill",e.Failed_Column_Suggestion_Generation_For_User_Prompt="Failed column suggestion generation for user prompt",e.Failed_Command_Execution_Due_To_Other_Error="Failed command execution due to other error",e.Failed_Command_Execution_Due_To_Protection_Settings="Failed command execution due to protection settings",e.Failed_Conditional_Formatting_Execution_Due_To_Other_Error="Failed onditional formatting execution due to other error",e.Failed_Conditional_Formatting_Execution_Due_To_Protection_Settings="Failed conditional formatting execution due to protection settings",e.Failed_Due_To_Skill_Failure="Failed due to Service Error (Skill failure)",e.Failed_During_Prompt_Construction_Or_Postprocessing="Failed during prompt construction or postprocessing",e.Failed_Parse_ODSL="Failed to parse generated ODSL",e.Failed_Parse_ODSL_Zero="Failed to parse generated ODSL (no ODSL present)",e.Failed_Parse_ODSL_Date_Logic="Failed to parse generated ODSL (unsupported date logic)",e.Failed_Parse_ODSL_No_Op="Failed to parse generated ODSL (no program effect)",e.Failed_Insight_Generation_Due_To_No_Patterns_In_Data="Failed insight generation due to no patterns in data",e.Failed_Insight_Generation_Due_To_No_Requested_Data_In_The_Source_Data="Failed insight generation due to no requested data in the source data",e.Failed_Insight_Generation_Due_To_Not_Enough_Info="Failed insight generation due to not enough info",e.Failed_Insight_Generation_Due_To_Other_Error="Failed insight generation due to other error",e.Failed_Insight_Generation_Due_To_Out_Of_Scope_Error="Failed insight generation due to out of scope error",e.Failed_Insight_Generation_Due_To_Too_Large_Data="Failed insight generation due to too large data",e.Failed_Insight_Insertion="Failed insight insertion",e.Failed_Insight_Insertion_Due_To_Protection_Settings="Failed insight insertion due to protection settings",e.Failed_Insight_Insertion_Due_To_User_Edits="Failed insight insertion due to user edits",e.Failed_To_Copy_Code="Failed to copy code",e.Failed_To_Copy_Response="Failed to copy chat response",e.Failed_To_Insert_Table="Failed to insert table from chat response",e.Features_In_Development="Features in development or under flight",e.Formula_Description_Failed_To_Display="Formula description failed to display",e.Formula_Explanation_Failed_To_Display="Formula explanation failed to display",e.Formula_Generation_Columns_Letters_Mismatch_Between_Title_And_Preview="Columns letters mismatch between title and preview",e.Formula_Generation_Failed_To_Send_Signal="Failed to send formula generation signal",e.Formula_Generation_Unsupported_Multiple_Columns="Unsupported multiple columns generation",e.Formula_Generation_Unsupported_Multiple_Rows="Unsupported multiple rows generation",e.Generated_Output_Error="Offensivecontentdetectedingeneratedoutput",e.InferenceAPI="Inference API",e.InferenceAPI_Not_Available="Inference API not available",e.InferenceAPI_Timeout="Inference API timeout",e.Input_Blocked_Guardlist="Input blocked by dynamic guard list so no response",e.Input_Blocked_Prompt_Injection="Input blocked due to prompt injection so no response",e.Input_Failed_Due_To_Augloop_Session_Close="Input failed due to Augloop session close",e.Input_Failed_Due_To_Memory="Input failed due to memory",e.Input_Language_Unsupported="Input language unsupported",e.Insights_Visual_Converter_Unsupported="Insights visual converter unsupported",e.Invalid_AE_Generated="Invalid AE response was generated by LLM",e.Invalid_Column_Name="Invalid column name was generated by LLM",e.Invalid_Json_Format="Invalid Json format was generated by LLM",e.Invalid_ODSL_Generated="Invalid ODSL was generated",e.Invalid_Response_Type="Invalid response type was generated by LLM",e.Invalid_Text_Analysis_Response="Invalid text analysis response was generated by LLM",e.Input_Resulted_In_Unsupported_Command="Input resulted in unsupported command",e.Input_Was_Offensive_So_No_Response="Input was offensive so no response",e.Inserting_Column_Took_Too_Long_Time="Inserting column took too long time",e.Input_Exceeded_Max_Length="Input exceeded max length",e.Input_Too_Long="Input Query is too long, or has too many tokens",e.Input_Too_Short="Input too short",e.Input_Query_Error="Erroroccurredbecauseinputqueryisoffensive",e.Input_Query_Error_Invalid="The program/app name cannot be determined because the input is invalid",e.Input_Query_Error_Out_Of_Scope="The intent for the input cannot be determined because the input is out of scope",e.Import_Data_Card_Rendering_Error="Error occurred while trying to render the import card",e.Import_Data_File_Fetching_Error="Error occurred while trying to fetch file metadata",e.Import_Data_File_Fetching_Timeout="Timeout occurred while trying to fetch file metadata",e.Import_Data_Relevancy_Error="Error occurred while trying to run relevancy signal",e.Import_Data_Relevancy_Timeout="Timeout occurred while trying to run relevancy signal",e.Import_Data_Load_Query_Error="Error occurred while trying load query from import data",e.Import_Data_RAI_Error="RAI error during import data",e.Import_Data_General_Error="General error on import data",e.import_Data_Thumbs_Down="Thumbs down for import data card",e.LLM_HTTP_Request_Error="LLM HTTP request error",e.LLM_Identifies_UnanswerableQuery="LLM identifies the query is unanswerable",e.LLM_Thinks_Ambiguous="LLM thinks the query is too ambiguous",e.LLM_Throttled="LLM throttled",e.LLM_Service_Error="LLM service error",e.Mismatch_Between_Preview_And_Grid_Values="Mismatch between preview and grid values",e.Missing_HITL_Intent_String="Missing human in the loop intent string",e.Multiple_Intents_Detected="Orchestration failed due to multiple intents",e.ODSL_Execution_Failed_Due_To_Converter_Error="ODSL execution failed due to a converter error",e.ODSL_Execution_Failed_Due_To_Invalid_Targets="ODSL execution failed due to invalid targets",e.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Prompt="ODSL execution failed due to out of scope prompt",e.ODSL_Execution_Failed_Due_To_Out_Of_Scope_Targets="ODSL execution failed due to out of scope targets",e.ODSL_Execution_Failed_Due_To_Payload_Too_Large="ODSL execution failed due to payload too large",e.ODSL_Execution_Failed_Due_To_Entity_Type_Mismatch="ODSL execution failed due to entity type mismatch",e.ODSL_Execution_Failed_Due_To_Unsupported_Commands="ODSL execution failed due to unsupported commands",e.ODSL_Execution_Failed_General_Error="ODSL execution failed general error",e.ODSL_Execution_Failed_With_Multiple_Events="ODSL execution failed with multiple events",e.Orchestration_Failed_Sydney="Orchestration faileddue to Service Error (Sydney)",e.Orchestration_Failed_When_Calling_OfficeJS_Sensitivity_API="Orchestration failed when calling OfficeJS sensitivity API",e.Orchestration_Failed_When_Could_Not_Fetch_Sensitivity_Label="Orchestration failed when could not fetch sensitivity label",e.Organization_Policy_Does_Not_Allow_This_Type_Of_Content="Organization policy does not allow this type of content",e.Other_Input_Attack_Detected="Other input attack detected",e.Out_Of_Credits="Customer has no remaining Copilot credits",e.Output_Blocked_By_Guard_List="Output blocked by guard list",e.Output_Deemed_Offensive="Output deemed offensive",e.Pane_Crashed="Pane crashed",e.Pane_Failed_To_Hydrate_Previous_Chat_History="Pane failed to hydrate previous chat history",e.Pane_Taking_Too_Long_To_Load="Pane taking too long to load",e.Pane_Taking_Too_Long_To_Load_After_Disabled_Screen="Pane taking too long to load after disabled screen",e.Pane_Taking_Too_Long_To_Load_Due_To_CellEditMode_PrivateHost="Pane taking too long to load due to cell edit mode in private host",e.Pane_Taking_Too_Long_To_Load_Due_To_CellEditMode_InitializeTasks="Pane taking too long to load due to cell edit mode in initialize tasks",e.Preview_On_Card_Failed_To_Display="Preview on card failed to display",e.Preview_On_Grid_Failed_To_Display="Preview on grid failed to display",e.Prompt_Injection_Detected="Prompt injection detected",e.Pre_Python_Mode_Error="Pre Python mode error",e.Python_Add_Results_To_New_Sheet="Adding results to new sheet failed",e.Python_Analysis_Sheet_Deleted="Python analysis sheet deleted",e.Python_Analysis_Sheet_Metadata_Error="Python analysis sheet metadata error",e.Python_AugLoop_Calls_Per_Query_Maximum_Hit="Python AugLoop calls per query maximum hit",e.Python_Bad_Object_Reference="Python Bad Object Reference",e.Python_Cell_Edit_Mode="Python Cell Edit Mode",e.Python_Load_Cells_Start_Analysis_Error="Python load cells start analysis error",e.Python_Code_Retry_Maximum_Hit="Python code retry maximum hit",e.Python_Code_And_PostView_Props_Not_Serializable="Python code and PostView card props not serializable.",e.Python_Exit_Analysis="Python failed to exit analysis",e.Python_Failed_To_Insert_Code="Python failed to insert code",e.Python_Failed_To_Get_Diagnostics="Python failed to get diagnostics object",e.Python_Failed_To_Print_Formatted_Number="Python failed to print formatted number",e.Python_General_Grid_Error="Python general grid error",e.Python_Access_Error="Python access error",e.Python_Calc_Error="Python calc error",e.Python_Missing_Or_Invalid_Response="Python missing or invalid response",e.Python_Payload_Empty="Python payload empty",e.Python_PostView_Failed="Python inserting PostView failed",e.Python_Runtime_Busy="Python runtime busy",e.Python_Runtime_In_Bad_State="Python runtime in bad state",e.Python_Teaching_Callout_Not_Shown="Python teaching callout not shown",e.Python_TLR_Unsupported_Features="Python TLR unsupported features",e.Python_Unknown_Error="Python unknown error",e.Python_User_Thumbs_Down="Python user thumbs down",e.Python_Multiple_Open_Workbooks="Python multiple open workbooks",e.Python_Undo_Failed="Python undo failed",e.RAI_Validation_Failed="RAI Validation failed",e.Requested_Visual_Type_Unsupported="Requested visual type unsupported",e.Scenario_Throttled="Scenario has issued too many requests",e.Search_Sensitivity_API_Error="Search sensitivity API error",e.Search_User_Thumbs_Down="Search user thumbs down",e.Service_Error_Augloop="Service error (AugLoop)",e.Service_Error_Unknown_Error="Service Error (unknown error)",e.Service_Timeout="Service timed out waiting on the client",e.Suggestion_Blocked_Due_To_Code_Generated_Being_Protected_By_Copyright_Licensing="Suggestion blocked due to code generated being protected by copyright/licensing",e.Suggestion_Blocked_Due_To_RAI="Suggestion blocked due to RAI",e.Sydney_Bad_Converstaion_Id="Sydney failed due to bad conversation id",e.Sydney_Cancelled_Error="ConnectiontoSydneyiscancelled",e.Sydney_Error="Sydney error",e.Sydney_Timeout="Sydney timeout",e.Sydney_Unknown_Error="Sydney unknown error",e.Sydney_Websocket_Failed="Sydney failed to connect",e.Tabular_Range_Unsupported="Tabular Range Unsupported",e.Throttled="Server too busy",e.Undo_Calculated_Columns_Error="Undo calculated column error (Undo button error)",e.Unsupported_Platform_For_Python_In_Excel="Unsupported platform for Python in Excel",e.User_Dissatisfied_With_Suggestion_Calculated_Columns="User dissatisfied with the suggestion",e.User_Input_Deemed_Offensive="User input deemed offensive",e.User_Stopped_Execution="User stopped execution",e.User_Stopped_Execution_Short="User stopped execution (short duration)",e.User_Throttled="User has issued too many requests",e.Users_Python_License_Could_Not_Be_Validated="User's Python license could not be validated",e.Table_Like_Entity_Not_Found="Table-like entity not found",e.Unsupported_Object_Selected="Unsupported object selected",e.Payload_Too_Large="Table Data Too Large",e.TLR_Auto_Fix_Undo_Failed="Tabular range auto fix undo failed",e.Python_Failed_Due_To_Protected_Sheet="Python failed due to protected sheet",e.Python_Skill_Failed="Python skill failed",e.Python_Image_Unavailable_Due_To_Analysis_Sheet_Deleted="PythonImageUnavailableAnalysisSheetDeletedError",e.Answers_Insert_Failed="Answers insert failed",e.Answers_Collapsable_Code_On_Click_Failed="Answers collapsable code on click failed",e.Answers_Component_Props_Not_Serializable="Answers_Component_Props_Not_Serializable",e.Python_Execution_Blocked_By_Admin="Python execution blocked by admin",e.Answers_Interactive_Chart_Failed="Answers interactive charts failed",e.Python_Start_Analysis_Failed="Python start analysis failed",e.RichAPI_General_Exception="RichAPI general exception"}(n||(n={}))},935785:(e,t,a)=>{"use strict";a.d(t,{q:()=>l,t:()=>i});var n=a(267324),o=a(47262),r=a(944058);const i=(e,t,a,n)=>{switch(e.visual.visualType){case"PivotTableVisual":{const o=e.visual.pivotTable,i=(0,r.OY)(o);return c(i,a??t,"PivotTable",n)}case"PivotChartVisual":{const o=e.visual.pivotTable,i=(0,r.OY)(o);return c(i,a??t,"PivotChart",n)}case"QueryResultVisual":case"QueryChartVisual":{const o=e.visual.result,i=(0,r.ub)(o);return c(i,a??t,"QueryResultVisual"===e.visual.visualType?"QueryResult":"QueryChart",n)}case"TextAnalysisVisual":{const{interpretationId:t,...a}=e;return c(a,void 0,"TextAnalysisVisual",n)}case"ChartVisual":case"ForecastVisual":{let o=t;a&&(o=a);const r=s(e);return c(r,o,void 0,n)}default:(0,o.x)(e.visual)}},l=e=>{const t=[];let a=1;for(let o=e.length-1;o>=0;o--){const r=e[o];if(r.visualAnswer&&r.visualAnswer.length>0){const e=i(r.visualAnswer[0],"",r.textAnswer?.tokens.map((e=>e.text)).join("")),o=a+e.length+3;if(o>n._A_)break;t.unshift(e),a=o}}return JSON.stringify(t)},s=e=>{const{id:t,interpretationId:a,...n}=e;return n},c=(e,t,a,o)=>{let r=JSON.stringify({text:t,visualType:a,visual:e,mustExplain:o});return r.length>n._A_&&(r="TextAnalysisVisual"===a?(0,n.NOF)():JSON.stringify({text:t,visualType:a,mustExplain:o})),r}},936044:(e,t,a)=>{"use strict";a.d(t,{T:()=>b,o:()=>f});var n=a(365319),o=a(353033),r=a(831310),i=a(9847),l=a(83437),s=a(476730),c=a(965634),d=a(956258),u=a(883);const m=3e4,h=d.M.getInstance(),g=new Map,p=s.E.getInstance();async function b(e,t,a,i,s,c=m,d=void 0){try{const l=(0,o.p)();(0,u.debuglog)(`SENDING AWAITABLE SIGNAL: ${JSON.stringify(e)}`),n.$.getInstance().submitOperation({operation:e,workflowAnnotationType:s});const m=setTimeout((()=>{C({id:t,body:{requestId:t,error:{errorCode:r.O.Timeout,errorMessage:`triggerSignalAndWaitForAnnotation Request timed out after ${c} ms. request id ${t}`,...d||{}}}},t)}),c);if(g.has(t))throw new Error(`triggerSignalAndWaitForAnnotation: requestId ${t} already exists`);return g.set(t,{deferredPromise:l,requestId:t,timeoutId:m,telemetryEventType:a,latencyOperation:i,startTime:performance.now()}),l.promise}catch(e){throw h.logError({eventType:a,errorMessage:`Error while submitting signal. requestID: ${t}, error: ${e}`,logLevel:l.$b.Error}),e}}function f(e,t){C(e,t)}function C(e,t){const a=g.get(t);if(a){const n=function(e,t){g.delete(e),clearTimeout(t.timeoutId);const a=performance.now()-t.startTime;return p.logLatency(a,t.latencyOperation),a}(t,a);e.body&&"error"in e.body&&e.body.error?a.deferredPromise.reject(e.body):a.deferredPromise.resolve(e.body),h.logEvent((0,i.P1)(a.telemetryEventType,{[c.IC.RequestId]:t,[c.IC.ExecutionTime]:n,[c.IC.Success]:!(e instanceof Error),[c.IC.Error]:e instanceof Error?e.message:""}))}else h.logError({eventType:c.S2.Error,errorMessage:`Received annotation for unknown request ${t}`,logLevel:l.$b.Warning})}},940096:(e,t,a)=>{"use strict";a.d(t,{OA:()=>v,Z:()=>y,f1:()=>f,gf:()=>C});var n=a(700853),o=a(856656),r=a(365319),i=a(637211),l=a(965634),s=a(39609),c=a(99394),d=a(9847),u=a(267324),m=a(956258),h=a(874066),g=a(235373),p=a(390624),b=a(173491);const f=()=>async(e,t)=>{(0,p.TA)({ignoreIfNotOpened:!0}),t().app.doesFluxTurnRequireUndo&&((0,p.tN)(),e(h.m.resetDoesFluxTurnRequireUndo()),s.Z.getInstance().setShowUndoButton(!1))},C=(e=()=>()=>{})=>async(t,a)=>{const i=performance.now();try{if("NotStarted"===a().app.tokenState)try{await(0,b.Nd)(),t(h.m.loadAuth())}catch{return void t(h.m.fetchTokenFailed())}if("Loaded"!==a().app.tokenState&&"Cached"!==a().app.tokenState)return;try{let i;if(Office.context.platform===Office.PlatformType.OfficeOnline&&(i=await(0,b.EH)(),i))return t(h.m.fetchTokenSuccess()),m.M.getInstance().logEvent({eventType:l.S2.AuthSuccess,eventData:[{key:l.Wg.FetchType,value:"OAuthManager"}]}),i;if(i=await(0,b.js)(),i)return t(h.m.fetchTokenSuccess()),m.M.getInstance().logEvent({eventType:l.S2.AuthSuccess,eventData:[{key:l.Wg.FetchType,value:"Silent"}]}),i;const s=e(),{executingCommand:c,executingId:p}=a().chat;let f;const C=new Promise((e=>{f=e})),y=u.olU.ShowPopupMessage,[v,x]=y.split("{0}");return r.$.getInstance().displayResponse({chatCardType:n._.WarningMessage,chatMessageData:{warningMessageCardProps:{user:"chat",warningPrefix:v,warningEmphasizedText:u.olU.ShowPopupButton,warningSuffix:x}},chatMessageBodyData:{actionButtonList:[{type:o.jA.Default,text:u.olU.ShowPopupButton,title:u.olU.ShowPopupButton,handleButtonOnClick:()=>{t(g.m.startExecutingCommand({command:c??d.OP.AnalyzeData,id:p})),f((0,b.IN)())}}]}},{featureName:d.q.AnalyzeData,eventType:d.a5.PromptAuthPopup}),i=await C,i?(s(),t(h.m.fetchTokenSuccess()),m.M.getInstance().logEvent({eventType:l.S2.AuthSuccess,eventData:[{key:l.Wg.FetchType,value:"Popup"}]}),i):void 0}catch{return void t(h.m.fetchTokenFailed())}}finally{m.M.getInstance().logDuration("GetToken",performance.now()-i)}},y=()=>(e,t)=>t().app.localeInfo,v=e=>c.V.IsSettingTrue(c.z.ButtonEnabledForLocalFiles)?e.app.copilotState:i.$.Enabled},944032:(e,t,a)=>{"use strict";a.d(t,{lJ:()=>f,r1:()=>p,x8:()=>b});var n=a(725556),o=a(824088),r=a(381277),i=a(95151),l=a(797639),s=a(528804),c=a(944563),d=a(215592),u=a(576583);const m={contentCard:{width:"100%",...d.shorthands.margin("0"),boxShadow:"none",...d.shorthands.border("0","none"),...d.shorthands.borderRadius("0"),...d.shorthands.padding("0")},contentHeader:{color:c.k1.black}},h=(0,u.n)(m);var g=a(887648);a(208520);const p=e=>({buttonTitle:e,buttonText:e,icon:(0,n.jsx)(o.rz9,{})}),b=e=>({buttonTitle:e,buttonText:e,icon:(0,n.jsx)(r.wm0,{})});function f({requestId:e,cardButtons:t,contentBody:a,contentHeader:o,pythonUserRequestId:r,renderHeader:c,renderBody:d,renderFooter:u}){let m=(0,g.d4)((e=>e.chat.latestRequestId))===e;const p=(0,g.d4)((e=>e.chat.lastPythonQueryId));return(0,s.cGu)()&&r?m=l.CP.pythonContextManager.isPythonMode&&r===p:l.CP.pythonContextManager.isPythonMode&&r&&(m=r===p),(0,n.jsx)(i.ContentCard,{body:{cardContent:{contentBody:a,contentHeader:o,cardButtons:m?t:void 0},renderHeader:c,renderBody:d,renderFooter:u},styles:h()})}},944058:(e,t,a)=>{"use strict";a.d(t,{Fl:()=>r,OY:()=>c,ub:()=>d});var n=a(267324),o=a(69284);function r(e,t,a){if(t)return"...";const n=Number.parseFloat(e.toPrecision(9));return-1===a?n.toString():n.toFixed(a)}function i(e,t){let a;return a="number"!=typeof e||t?e?.value?.toString()||"":r(e,!1,-1),a}function l(e){return e?n.olU.NoValueAnswerTextForNLInsight:n.olU.NoValueAnswerTextForIdeas}function s(e,t){const a=e=>"|"+e.join("|")+"|\n";let n="";for(let t=0;t<e.length;t++)n+=a(e[t]);n+=a(e[0].map((e=>"---")));for(let e=0;e<t.length;e++)n+=a(t[e]);return n}function c(e){const{pivotTableData:t,grandTotalRowIndex:a,subTotalRowIndices:n}=e;if(t&&0===t.length)return l(!1);const r=(0,o.HF)(e),c=t[0].map(((e,a)=>t.map((e=>e[a]))));return s(c.slice(0,r).map((e=>e.map((e=>i(e,!0))))),(()=>{const e=[],t=c.slice(r,a);for(let a=0;a<t.length;a++){if(!!n&&n.length>0&&n.some((e=>e===a+r)))continue;const o=t[a].map((e=>i(e,!1)));e.push(o)}return e})())}function d(e){if(0===e.fields.length)return l(!0);if(0===e.fields[0].values.raw.length)return l(!1);const t=[e.fieldHeaders.map((e=>i({value:e.runs.map((e=>e.text)).join(""),isNumber:!1,indent:0},!0)))],a=e.fields[0].values.raw.length,n=[];for(let t=0;t<a;t++){const a=[];for(let n=0;n<e.fields.length;n++){const o=e.fields[n].values;if(o.formattedValues){const e=o.formattedValues[t];a.push(i(e,!1))}else{const e=o.strings[t],n=o.raw[t],r={value:e||n,isNumber:!1,indent:0};a.push(i(r,!1))}}n.push(a)}return s(t,n)}},944563:(e,t,a)=>{"use strict";a.d(t,{QJ:()=>n,eS:()=>g,j2:()=>h,k1:()=>y,mR:()=>m,v1:()=>v});var n,o=a(241273),r=a(479504),i=a(991869),l=a(95151),s=a(670802),c=a(113510);!function(e){e.dark="highcontrast_dark",e.light="highcontrast_light",e.disabled="highcontrast_none"}(n||(n={}));const d=[{excelPrimaryBackgroundColor:"#FFFFFF",sdxPrimaryBackgroundColor:"#fafafa",sdxTheme:o.Gm.defaultWhite},{excelPrimaryBackgroundColor:"#1B1A19",sdxPrimaryBackgroundColor:"#292827",sdxTheme:o.Gm.defaultBlack},{excelPrimaryBackgroundColor:"#262626",sdxPrimaryBackgroundColor:"#292827",sdxTheme:o.Gm.defaultBlack},{excelPrimaryBackgroundColor:"#666666",sdxPrimaryBackgroundColor:"#292827",sdxTheme:o.Gm.defaultBlack},{excelPrimaryBackgroundColor:"#323232",sdxPrimaryBackgroundColor:"#323232",sdxTheme:o.Gm.defaultBlack}],u=[{excelPrimaryBackgroundColor:"#ffffff",sdxPrimaryBackgroundColor:"#F5F5F5",sdxTheme:o.Gm.defaultWhite},{excelPrimaryBackgroundColor:"#000000",sdxPrimaryBackgroundColor:"#141414",sdxTheme:o.Gm.defaultBlack}],m=(e,t)=>{const a=(0,r.dD)()?u.find((t=>t.excelPrimaryBackgroundColor.toLowerCase()===e.toLowerCase())):d.find((t=>t.excelPrimaryBackgroundColor.toLowerCase()===e.toLowerCase()));return(0,l.setClientThemeType)(a?.sdxTheme??o.Gm.defaultWhite),t&&f(a?.sdxPrimaryBackgroundColor??"#fafafa"),a?.sdxTheme??o.Gm.defaultWhite},h=e=>e===o.Gm.defaultDarkGrey||e===o.Gm.defaultBlack,g=(e,t)=>{const a=e!==o.Gm.defaultWhite?{isDarkModeEnabled:!0,isHighContrastModeEnabled:t,...b}:{isDarkModeEnabled:!1,isHighContrastModeEnabled:t,...p};return a.dir=(0,i.xt)()?"rtl":"ltr",a},p={themePrimary:"#107c41",themeSecondary:"#007c85",themeLight:"#CAEAD8",themeDark:"#A0D8B9",themeDarker:"#37A660",themeTertiary:"#0f703b",themeLighter:"#42B8B2",themeMedium:"#A0D8B9",themeDarkAlt:"#107C41",themeLighterAlt:"#DCF51D",neutralLighter:"#f5f5f5",neutralDark:"#242424",black:"#292827",white:"#ffffff",lightBlue:"#dce6f1"},b={themePrimary:"#55B17E",themeSecondary:"#007c85",themeLight:"#084625",themeDark:"#0f7c41",themeDarker:"#0a5f33",themeTertiary:"#0f703b",themeLighter:"#42B8B2",themeMedium:"#0f7c41",themeDarkAlt:"#107C41",themeLighterAlt:"#DCF51D",neutralLighter:"#757575",neutralDark:"#ffffff",black:"#ffffff",white:"#292827",lightBlue:"#292827"},f=e=>{document.body.style.backgroundColor=e},C={...s.o,...p},y=(0,c.Q)(C),v={10:"#03160A",20:"#052912",30:"#094624",40:"#0A5325",50:"#0C5F32",60:"#0F703B",70:"#0F7937",80:"#107C41",90:"#218D51",100:"#10893C",110:"#1F954A",120:"#37A660",130:"#55B17E",140:"#60BD82",150:"#A0D8B9",160:"#CAEAD8"}},947621:(e,t,a)=>{"use strict";a.d(t,{R:()=>l,j:()=>s});var n=a(83437),o=a(9847),r=a(965634),i=a(956258);function l(e){const t={eventType:r.S2.ConverterError,errorMessage:e.message,logLevel:n.$b.ASHA};let a=[{key:o.Sn.ODSLProperty,value:e.property},{key:o.xL.ErrorMessage,value:e.message}];e.dataFields&&(a=a.concat(e.dataFields));i.M.getInstance().logError(t,void 0,a)}function s(e){const t=(0,o.b6)();e.forEach((e=>{t[e.key]=e.value}));i.M.getInstance().logEvent((0,o.gY)(t))}},949404:(e,t,a)=>{"use strict";a.d(t,{v:()=>d});var n=a(700853),o=a(63919),r=a(322466),i=a(9847),l=a(644737),s=a(528804),c=a(507628);function d(e,t={},a={},d={},u={}){const m=(0,c.A)();return{message:{...u,chatCardType:n._.Default,chatMessageData:{defaultMessageProps:{user:o.Q9.Chat,messageHeader:{text:e},...a}},chatMessageBodyData:{shouldShowAIGeneratedIndicator:!1,feedbackSectionPosition:r.O.Footer,feedbackData:{feedbackArea:"Copilot"},isFailure:!0,messageId:m,actionButtonList:(0,s.jHv)()?[(0,l.yo)(m)]:void 0,...d}},telemetry:{featureName:i.q.CopilotChat,eventType:i.a5.ErrorMessage,...t}}}},951903:(e,t,a)=>{"use strict";a.d(t,{LQ:()=>s,pi:()=>l});var n=a(740967),o=a(507628),r=a(936997),i=function(e){return/^data:image\/[a-zA-Z]+;base64,/.test(e)},l=function(e){if(i(e)){for(var t=e.split(",")[1],a=atob(t),r=new Uint8Array(new ArrayBuffer(a.length)),l=0;l<a.length;l++)r[l]=a.charCodeAt(l);var s=function(e){return e.startsWith("data:image/png")?{format:n.f.Png}:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?{format:n.f.Jpg}:e.startsWith("data:image/bmp")?{format:n.f.Bmp}:{format:n.f.Other,otherFormat:e.split(";")[0].split(":")[1]}}(e),c=s.format,d=s.otherFormat;return{contents:[{id:(0,o.A)(),size:n.h.Unspecified,format:c,otherFormat:d,data:Array.from(r),sizeBytes:r.length}],widthPx:0,heightPx:0}}},s=function(e){if(i(e)){var t=e.split(",")[1],a=function(e){return e.startsWith("data:image/png")?r.kd.PNG:e.startsWith("data:image/jpg")||e.startsWith("data:image/jpeg")?r.kd.JPEG:void 0}(e);return t&&a?{screenshotBase64:[t],screenshotImageFormat:a}:void 0}}},952978:(e,t,a)=>{"use strict";e.exports=a.p+"assets/dislike-icon.svg"},956258:(e,t,a)=>{"use strict";a.d(t,{M:()=>L});var n,o,r,i=a(632512),l=a(932367),s=a(754440),c=a(922873),d=a(46692),u=a(24784),m=a(965634),h=a(267324),g=a(722307),p=a(9847);!function(e){e.AnalyzeReceived="AnalyzeReceived",e.AnswersReceived="AnswersReceived",e.FormulaGenerationReceived="GenerateReceived",e.CommandReceived="CommandReceived",e.DeeperAnalysisReceived="DeeperAnalysisReceived",e.CopilotChatReceived="CopilotChatReceived",e.ElseReceived="ElseReceived",e.DataShapingReceived="DataShapingReceived"}(n||(n={})),function(e){e.AnalyzeApplied="AnalyzeApplied",e.AnswersApplied="AnswersApplied",e.FormulaGenerationApplied="GenerateApplied",e.CommandApplied="CommandApplied",e.DeeperAnalysisApplied="DeeperAnalysisApplied",e.CopilotChatApplied="CopilotChatApplied",e.ElseApplied="ElseApplied",e.DataShapingApplied="DataShapingApplied"}(o||(o={})),function(e){e.AppLevelReceived="AppLevelReceived",e.AppLevelApplied="AppLevelApplied"}(r||(r={}));const b="Office.Excel.Copilot";var f=a(904182),C=a(83437),y=a(993821),v=a(287761),x=a(198784),T=a(95151),S=a(173339);var w=a(528804),E=a(107295),I=a(272487),R=a(581431);const A=(e,t)=>({dataCategories:d.o.DataCategories.ProductServiceUsage,samplingPolicy:t||d.o.SamplingPolicy.Measure,diagnosticLevel:e||d.o.DiagnosticLevel.FullEvent});class L extends f.O{static getInstance(){return L.telemetryLogger||(L.telemetryLogger=new L),L.telemetryLogger}clearAnalyzeDataSteps(e){delete this.analyzeDataSteps[e]}addAnalyzeDataStep(e,t){this.analyzeDataSteps[e]?this.analyzeDataSteps[e].push(t):this.analyzeDataSteps[e]=[t]}removeAnalyzeDataStep(e,t){if(!this.analyzeDataSteps[e])return;const a=this.analyzeDataSteps[e].indexOf(t);a>-1&&this.analyzeDataSteps[e].splice(a,1)}getLastAnalyzeDataStep(e){if(this.analyzeDataSteps[e]&&0!==this.analyzeDataSteps[e].length)return this.analyzeDataSteps[e][this.analyzeDataSteps[e].length-1]}log(e,t){e.push({key:p.W0.CorrelationId,value:this.correlationId}),this.excelCorrelationId&&e.push({key:p.W0.ExcelCorrelationId,value:this.excelCorrelationId}),this.fetchRecommendationsCorrelationId&&e.push({key:p.W0.FetchRecommendationsCorrelationId,value:this.fetchRecommendationsCorrelationId}),this.logEvent({eventType:m.S2.AnalyzeDataEvents,eventData:e},t)}runTimedAsyncFunction(e,t,a,n){return(0,R.H)(t(),(t=>this.logDuration(e,t,a,n)))}logDuration(e,t,a,n){this.checkForAshaTimeouts(e,t);const o=[{key:p.EB.Type,value:e},{key:p.EB.Duration,value:t},{key:p.EB.CorrelationId,value:this.correlationId}];this.excelCorrelationId&&o.push({key:p.EB.ExcelCorrelationId,value:this.excelCorrelationId}),this.fetchRecommendationsCorrelationId&&o.push({key:p.EB.FetchRecommendationsCorrelationId,value:this.fetchRecommendationsCorrelationId}),a&&o.push({key:p.EB.RequestId,value:a}),n&&o.push({key:p.EB.SuggestionId,value:n}),this.logEvent({eventType:m.S2.AnalyzeDataDuration,eventData:o},A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}checkForAshaTimeouts(e,t){"InsertColumn"===e&&t>S.R.getInsertColumnTimeout()&&this.logStandardizedAshaErrorEvent(s.W.Response_Delayed_Or_Timed_Out,l.c.Inserting_Column_Took_Too_Long_Time,p.BJ.FormulaGeneration)}logGetSelectionContext(e,t,a,n,o,r){const{isTable:i,hasTableHeaders:l}=n,s=[{key:p.W0.EventType,value:"GetSelectionContext"},{key:p.W0.NumRows,value:t},{key:p.W0.NumColumns,value:e},{key:p.W0.SelectionExpanded,value:a},{key:p.W0.IsSmallSelection,value:o},{key:p.W0.IsTable,value:i},{key:p.W0.HasTableHeaders,value:l},{key:p.W0.AreaCount,value:r}];this.log(s,A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logGetDataFromRange(e){this.log([{key:p.W0.EventType,value:"GetDataFromRange"},{key:p.W0.HasInvalidValues,value:e}],A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logInsightsApiCall(e,t,a,n,o){const r=[{key:p.W0.EventType,value:"InsightsApiCall"},{key:p.W0.Method,value:e},{key:p.W0.Api,value:t},{key:p.W0.ResponseCode,value:a},{key:p.W0.RetryCount,value:n},...o],i=A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact);this.log(r,i)}logRangeDataPerformance(e){const t=A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact);e.push({key:p.W0.EventType,value:"RangeDataPerformance"}),this.log([{key:p.W0.EventType,value:"RangeDataPerformance"},...e],t)}logInsertRecommendationDashboard(e){this.log([{key:p.W0.EventType,value:"InsertRecommendationsDashboard"},{key:p.W0.IsSuccessful,value:e.isSuccessful},{key:p.W0.FailureReason,value:e.failureReason},{key:p.W0.FailureLocation,value:v.lA[e.failureLocation]},{key:p.W0.RecommendationData,value:JSON.stringify(e.recommendationData)}],A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logFlightingSuccess(){this.log([{key:p.W0.EventType,value:"FlightingSuccess"}],A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logLoadDataWithChunking(e,t,a,n,o,r,i,l){this.log([{key:p.W0.EventType,value:"LoadDataWithChunking"},{key:p.W0.Type,value:e},{key:p.W0.Duration,value:t},{key:p.W0.NumRows,value:a},{key:p.W0.NumColumns,value:n},{key:p.W0.IsSuccessful,value:o},{key:p.W0.NumChunks,value:r},{key:p.W0.NumSyncs,value:i},{key:p.W0.MinRowsInChunk,value:l}],A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logLoadFormulaData(e,t,a){this.log([{key:p.W0.EventType,value:"LoadFormulaData"},{key:p.W0.Duration,value:e},{key:p.W0.NumRows,value:t},{key:p.W0.NumColumns,value:a}],A(d.o.DiagnosticLevel.NecessaryServiceDataEvent,d.o.SamplingPolicy.CriticalBusinessImpact))}logEvaluateQuery(e,t){const a=[{key:p.W0.EventType,value:"EvaluateQuery"},{key:p.W0.ResponseType,value:e.responseType}],n=e.visualAnswer?.at(0)?.visual?.visualType;if(n&&a.push({key:p.W0.VisualType,value:n}),"TextAnalysisVisual"===n){const n=e.visualAnswer.at(0).visual.textAnalysisResult;a.push({key:p.W0.TextAnalysisResultType,value:n?.resultType}),a.push({key:p.W0.NumRowsSelected,value:t.rowCount});const o=n?.bulletList?.flatMap((e=>e.reference))??[],r=new Set([...o]).size;a.push({key:p.W0.NumRowsReferenced,value:r})}e.reasonForError&&a.push({key:p.W0.ReasonForError,value:e.reasonForError}),e.queryType&&a.push({key:p.W0.QueryType,value:e.queryType}),e.caveats&&e.caveats.length>0&&a.push({key:p.W0.Caveats,value:e.caveats.map((e=>e.code)).join(", ")}),this.log(a,A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}logInvalidInsightsSession(e){const t=[{key:p.W0.InvalidInsightsSessionSource,value:e},{key:p.W0.IsInvalidInsightsSession,value:!0}];this.log(t,A(d.o.DiagnosticLevel.RequiredServiceData,d.o.SamplingPolicy.CriticalBusinessImpact))}getLogLevelForErrorCategory(e){switch(e){case"UnsupportedLanguageError":case"LicensingError":case"ODSLParseError":case"ODSLSyntaxError":case"InputQueryError":case"":return C.$b.Warning;default:return C.$b.Error}}logUncaughtException(e){const t=[];let a="";(e instanceof Error||e instanceof OfficeExtension.Error)&&(e.message&&(a=e.message),e.stack&&t.push({key:p.un.Stack,value:e.stack})),this.logTelemetryErrorEvent({eventType:m.S2.UncaughtException,errorMessage:a,logLevel:C.$b.Critical},void 0,t)}logStandardizedAshaErrorEvent(e,t,a,n){if(I.isSDXRenderingForPreload)return void this.heldAshaErrorEvents.push({ashaVeto:e,ashaError:t,featureName:a,ashaInStaging:n});const o=this.getDefaultTelemetryData();o.push({key:"AshaScenarioName",value:a}),T.TelemetryLoggerUtils.getInstance().logErrorWithAshaVetoAndError(o,a,h.u1i,this.getVerbForStandardizedFeature(a)+" "+a+" "+e,t,n)}logAshaEvent(e,t,a,n){const o=this.getDefaultTelemetryData();o.push({key:"AshaScenarioName",value:a}),T.TelemetryLoggerUtils.getInstance().logErrorWithAshaVetoAndError(o,a,h.u1i,e,t,n)}logErrorCode(e,t,a,n,...o){const r=[{key:p.un.ErrorCode,value:e}],l=t instanceof i.u&&t.error?t.error:t;(l instanceof Error||l instanceof OfficeExtension.Error)&&(r.push({key:p.un.Name,value:l.name},{key:p.un.InnerError,value:l.message}),l.stack&&r.push({key:p.un.Stack,value:l.stack}),l instanceof OfficeExtension.Error&&(r.push({key:p.un.OfficeErrorCode,value:l.code}),l.debugInfo.errorLocation&&r.push({key:p.un.ErrorLocation,value:l.debugInfo.errorLocation}))),r.push(...o),this.logTelemetryErrorEvent({eventType:a??m.S2.Error,errorMessage:e,logLevel:n??C.$b.Warning},void 0,r)}releaseHeldTelemetryEvents(){this.heldTelemetryEvents.forEach((({featureName:e,telemetryEvent:t})=>{this.sendTelemetryEvent(t),this.seenEvents.add(e)})),this.heldTelemetryEvents=[],this.heldAshaErrorEvents.forEach((({ashaVeto:e,ashaError:t,featureName:a,ashaInStaging:n})=>{const o=this.getDefaultTelemetryData();o.push({key:"AshaScenarioName",value:a}),T.TelemetryLoggerUtils.getInstance().logErrorWithAshaVetoAndError(o,a,h.u1i,this.getVerbForStandardizedFeature(a)+" "+a+" "+e,t,n)})),this.heldAshaErrorEvents=[]}startTriedActivity(e){null!=this.pendingTriedActivity&&this.endTriedActivityFailure();const t={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!0),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,e)};this.pendingTriedActivity=this.oTelLogger.createActivity(t),this.currentStandardizedFeature=void 0,this.currentUsageFeature=void 0}endTriedActivitySuccess(e){if(null==this.pendingTriedActivity)return void(0,x.J)("CopilotResponseDisplayed");if(this.pendingTriedActivity.dataFields=this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,e),this.pendingTriedActivity.success=!0,this.pendingTriedActivity.endNow(),this.pendingTriedActivity=void 0,this.sendSurveyTriggerEvent(!1,e),(0,w.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")&&e===p.q.CopilotChat)return;const t=this.getStandardizedFeatureForSubFeature(e);(0,w.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")&&this.assertFeatureIsActive(t,"endTriedActivitySuccess: Feature from tried success does not match active feature from AugLoop."),this.currentStandardizedFeature=t,this.currentUsageFeature=e}endTriedActivityFailure(e){null!=this.pendingTriedActivity?(e?this.pendingTriedActivity.dataFields=this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,e):(0,w.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")&&this.currentUsageFeature?this.pendingTriedActivity.dataFields=this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,this.currentUsageFeature):(0,w.yw9)("OfficeVSO_9249393_AttributionFromAugLoop")&&(this.pendingTriedActivity.dataFields=this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,this.getUsageFeatureForStandardizedFeature(this.currentStandardizedFeature))),this.pendingTriedActivity.success=!1,this.pendingTriedActivity.endNow(),this.pendingTriedActivity=void 0):(0,x.J)("CopilotResponseDisplayed")}resetActiveFeature(){this.currentStandardizedFeature=void 0,this.currentUsageFeature=void 0,L.querySource=L.nextQuerySource?L.nextQuerySource:p.BC.Default,L.nextQuerySource=p.BC.Default,L.querySource===p.BC.ExternalQuery?L.currentEntryPoint=p.Y9.Canvas:L.currentEntryPoint=p.Y9.Chat}setQuerySource(e){L.nextQuerySource=e}setActiveFeature(e){this.currentStandardizedFeature=this.getStandardizedFeatureForSubFeature(e),this.currentUsageFeature=e}setActiveFeatureWithContentOrigin(e){if(e&&e!==c.w.AugLoopEvalName&&e!==c.w.AugLoopName&&e!==c.w.DeepLeo&&e!==c.w.Workflow)if(e.includes(",")){const t=e.split(",");for(const a of t){const t=(0,p.eQ)(a);if(t){if(void 0!==this.currentStandardizedFeature&&t===p.BJ.ExcelChatHelper)continue;this.assertFeatureIsActive(t,"setActiveFeatureWithContentOrigin, multiple skills"),void 0===this.currentStandardizedFeature&&(this.currentStandardizedFeature=t,this.currentUsageFeature=void 0,this.logError({eventType:m.S2.ChatEvents,errorMessage:`AugLoop returned multiple skills: ${e}, and we are setting feature as ${this.currentStandardizedFeature}`,logLevel:C.$b.Warning}));break}}}else{const t=(0,p.eQ)(e);if(t){if(void 0!==this.currentStandardizedFeature&&t===p.BJ.ExcelChatHelper)return;this.assertFeatureIsActive(t,"setActiveFeatureWithContentOrigin, single skill"),void 0===this.currentStandardizedFeature&&(this.currentStandardizedFeature=t,this.currentUsageFeature=void 0)}}}getActiveFeature(){return this.currentStandardizedFeature?this.currentStandardizedFeature:p.BJ.CopilotChat}logRejectedEvent(e,t){if(t&&this.rejectedIds.has(t))return;const a={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsRejected,e)};this.sendTelemetryEvent(a),t&&this.rejectedIds.add(t)}logThumbsUpEvent(e,t,a,n){const o=(0,p.rI)(e),r={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(void 0,o,!0,(0,w.yw9)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")?t:void 0,a,n)};this.sendTelemetryEvent(r)}logThumbsDownEvent(e,t,a,n){const o=(0,p.rI)(e),r={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!1),dataFields:this.getCopilotDataFields(void 0,o,!1,(0,w.yw9)("OfficeVSO_8546828_SupportingSuggestionIdForExcelCopilotCC")?t:void 0,a,n)};this.sendTelemetryEvent(r),this.logUserThumbsDownAshaError(o)}logCitationOnClickEvent(){const e={telemetryProperties:this.getTelemetryProperties(),eventName:"Office.Voice.Copilot.Chat",eventFlags:this.getCopilotEventFlags(!0),dataFields:this.getCopilotDataFields(u.TA.FeatureActionType.IsTried,p.q.AnalyzeData)};this.sendTelemetryEvent(e)}logUserThumbsDownAshaError(e){let t,a;switch(e){case p.q.CalculatedColumns:case p.q.CalculatedRows:case p.q.NLToFormula:t=l.c.User_Dissatisfied_With_Suggestion_Calculated_Columns,a=this.getStandardizedFeatureForSubFeature(a);break;case p.q.Search:t=l.c.Search_User_Thumbs_Down,a=p.BJ.Search;break;case p.q.ImportDataFromSearch:t=l.c.import_Data_Thumbs_Down,a=p.BJ.ImportData;break;case p.q.Else:t=l.c.Else_User_Thumbs_Down,a=p.BJ.ExcelChatHelper;break;case p.q.Python:t=l.c.Python_User_Thumbs_Down,a=p.BJ.Python;break;case p.q.Answers:t=l.c.Answers_User_Thumbs_Down,a=p.BJ.Answers;break;default:t=l.c.Chat_User_Thumbs_Down,a=p.BJ.CopilotChat}t&&a&&L.getInstance().logStandardizedAshaErrorEvent(s.W.User_Rejected_Or_Cancelled_Response,t,a)}sendSurveyTriggerEvent(e,t){if(!(0,w.yw9)("OfficeVSO_8378717_TriggerExcelCopilotSurvey")||void 0===t)return;const a=function(e,t){let a;switch(e){case p.q.AnalyzeData:a=t?"AnalyzeApplied":"AnalyzeReceived";break;case p.q.CalculatedColumns:case p.q.CalculatedRows:case p.q.NLToFormula:a=t?"GenerateApplied":"GenerateReceived";break;case p.q.Commanding:case p.q.ConditionalFormatting:a=t?"CommandApplied":"CommandReceived";break;case p.q.Python:a=t?"DeeperAnalysisApplied":"DeeperAnalysisReceived";break;case p.q.CopilotChat:a=t?"CopilotChatApplied":"CopilotChatReceived";break;case p.q.Else:a=t?"ElseApplied":"ElseReceived";break;case p.q.DataShaping:a=t?"DataShapingApplied":"DataShapingReceived";break;case p.q.Answers:a=t?"AnswersApplied":"AnswersReceived";break;default:return}return b+"."+a}(t,e),n=function(e){return b+"."+(e?"AppLevelApplied":"AppLevelReceived")}(e);this.logEventName(n),void 0!==a&&(this.logEventName(a),(0,w.yw9)("OfficeVSO_8396253_sendToHostCopilotVerticals")&&(0,x.J)(a))}logEventName(e){const t={telemetryProperties:this.getTelemetryProperties(),eventName:e,eventFlags:this.getCopilotEventFlags(!1)};this.sendTelemetryEvent(t)}featureNameToFeedbackArea(e){switch(e){case p.q.Commanding:return"Copilot\\Commanding";case p.q.ConditionalFormatting:return(0,w.yw9)("OfficeVSO_9575103_AddFeedBackAreaToHiTLCard")?"Copilot\\Commanding Conditional Formatting":"Copilot\\Commanding CF Suggestions";case p.q.AnalyzeData:return"Copilot\\Analyze Data";case p.q.CalculatedColumns:return"Copilot\\Formula Generation";case p.q.Search:return"Copilot\\Search";case p.q.ImportDataFromSearch:return"Copilot\\Import Data";case p.q.Answers:return"Copilot\\Answers";case p.q.Python:return"Copilot\\Python";case p.q.PythonForms:return"Copilot\\PythonForms";case p.q.ChartDesignRecommendations:return"Copilot\\Chart Design Recommendations";case p.q.Else:return"Copilot\\Else";default:return"Copilot"}}getDefaultTelemetryData(){const e=[{key:m.Wg.UserQueryGuid,value:L.userQueryGuid},{key:m.Wg.ClientVersion,value:"9.58.16"},{key:m.Wg.GroundingMode,value:(0,p.Q6)()},{key:m.Wg.IsDevBuild,value:!1},{key:m.Wg.UiLanguage,value:(0,g.Yd)()}];return void 0!==L.querySource&&e.push({key:m.Wg.QuerySource,value:L.querySource}),(0,w.yw9)("OfficeVSO_9979155_PythonFlightsAsJSONString")?e.push({key:m.Wg.PythonFlights,value:(0,w.bdK)()}):e.push({key:m.Wg.IsPythonAdaInCopilotEnabled,value:(0,w.H2A)()}),e.push({key:m.Wg.IsModelessPythonAAEnabled,value:(0,E.i)()}),(0,w.yw9)("OfficeVSO_10534295_LogCopilotExperience")&&(0,w.UW0)()&&e.push({key:m.Wg.CopilotExperience,value:(0,y.dL)()?.PrimaryUserAccountInfo?.CopilotExperience??"AppChat"}),e}isAlwaysCriticalEvent(e){if(!(0,w.yw9)("OfficeVSO_9246195_AllowAlwaysCriticalEvents"))return!1;if(null===this.alwaysCriticalEvents){const e=(0,w.beW)("Microsoft.Office.Excel.FA000000124.AlwaysCriticalEvents","");this.alwaysCriticalEvents=e?e.split("|"):["Office.Voice.ActionAI.ChatEvents","Office.Voice.ActionAI.ShowMe","Office.Voice.ActionAI.Commanding","Office.Voice.ActionAI.OfficeJsOperations","Office.Voice.ActionAI.Latency","Office.Voice.ActionAI.Usage","Office.Voice.ActionAI.Error","Office.Voice.ActionAI.PythonEvents","Office.Voice.ActionAI.PythonDuration"]}return this.alwaysCriticalEvents.includes(e.eventName)}getCopilotEventFlags(e){return{dataCategories:d.o.DataCategories.ProductServiceUsage,diagnosticLevel:e?d.o.DiagnosticLevel.RequiredServiceData:d.o.DiagnosticLevel.Optional,samplingPolicy:d.o.SamplingPolicy.CriticalUsage}}getCopilotDataFields(e,t,a,n,o,r,i,l){t!==p.q.UndoMessage&&t!==p.q.CopyMessage&&t!==p.q.ExternalTriggeredQuery||(t=void 0);const s=null!=t?this.getStandardizedFeatureForSubFeature(t):null!=this.currentStandardizedFeature?this.currentStandardizedFeature:p.BJ.CopilotChat,c=s,d=t,h=this.getVerbForStandardizedFeature(s),g=e===u.TA.FeatureActionType.IsTried||e===u.TA.FeatureActionType.IsKept||e===u.TA.FeatureActionType.IsRejected||void 0!==a,b=e===u.TA.FeatureActionType.IsTried||e===u.TA.FeatureActionType.IsKept||e===u.TA.FeatureActionType.IsRejected||void 0!==a,f=(0,w.yw9)("OfficeVSO_10216180_AddActiveFeatureName")?{key:m.Wg.ActiveFeatureName,value:this.getActiveFeature()??""}:{key:"",value:""};return[...u.TA.getFields({featureActionType:null==e?"":u.TA.FeatureActionType[e],isUserInitiated:!0,verb:h,featureName:c,subFeatureName:d,isThumbsUp:a,interactionId:g?o??L.userQueryGuid:"",conversationId:b?l??L.conversationId:"",entryPoint:i??L.currentEntryPoint}),...this.getDefaultEventDataFields(),...this.getDataFields([{key:m.Wg.SuggestionId,value:n??""},{key:m.Wg.GroundingMode_,value:r??""},f])]}getStandardizedFeatureForSubFeature(e){switch(e){case p.q.AnalyzeData:return p.BJ.AnalyzeData;case p.q.CalculatedColumns:case p.q.CalculatedRows:case p.q.NLToFormula:return p.BJ.FormulaGeneration;case p.q.Commanding:case p.q.OfficeJsCommanding:case p.q.ShowHeaders:case p.q.SmartHelp:return p.BJ.Commanding;case p.q.ConditionalFormatting:case p.q.ConditionalFormattingSuggestion:return(0,w.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?p.BJ.ConditionalFormatting:p.BJ.Commanding;case p.q.DataShaping:return p.BJ.PrepareData;case p.q.HandOff:return p.BJ.Handoff;case p.q.ImportDataFromSearch:return p.BJ.ImportData;case p.q.Search:return p.BJ.Search;case p.q.OfficeScripts:return p.BJ.OfficeScripts;case p.q.Python:case p.q.PythonForms:return p.BJ.Python;case p.q.SelfHelp:return p.BJ.ChatQnA;case p.q.ChatPaneLoad:case p.q.ConvertToTable:case p.q.CopilotChat:case p.q.SampleData:case p.q.ContextInference:case p.q.InsertTable:return p.BJ.CopilotChat;case p.q.ChartDesignRecommendations:return p.BJ.ChartDesignRecommendations;case p.q.Else:return p.BJ.ExcelChatHelper;case p.q.Answers:return p.BJ.Answers;case p.q.CopyMessage:case p.q.ExternalTriggeredQuery:case p.q.UndoMessage:default:return this.logError({eventType:m.S2.ChatEvents,errorMessage:`StandardizedFeature mapping error for: ${e}`,logLevel:C.$b.Error}),p.BJ.CopilotChat}}getUsageFeatureForStandardizedFeature(e){switch(e){case p.BJ.AnalyzeData:return p.q.AnalyzeData;case p.BJ.FormulaGeneration:return p.q.CalculatedColumns;case p.BJ.Commanding:return p.q.Commanding;case p.BJ.ConditionalFormatting:return(0,w.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")?p.q.ConditionalFormatting:p.q.Commanding;case p.BJ.PrepareData:return p.q.DataShaping;case p.BJ.Handoff:return p.q.HandOff;case p.BJ.ImportData:return p.q.ImportDataFromSearch;case p.BJ.Search:return p.q.Search;case p.BJ.OfficeScripts:return p.q.OfficeScripts;case p.BJ.Python:return p.q.Python;case p.BJ.ChatQnA:return p.q.SelfHelp;case p.BJ.ChartDesignRecommendations:return p.q.ChartDesignRecommendations;case p.BJ.CopilotChat:return p.q.CopilotChat;case p.BJ.ExcelChatHelper:return p.q.Else;case p.BJ.Answers:return p.q.Answers;default:return this.logError({eventType:m.S2.ChatEvents,errorMessage:`UsageFeature mapping error for: ${e}`,logLevel:C.$b.Error}),p.q.CopilotChat}}getVerbForStandardizedFeature(e){switch(e){case p.BJ.AnalyzeData:case p.BJ.Python:case p.BJ.PrepareData:case p.BJ.Answers:return p.uF.Analyze;case p.BJ.ChatQnA:case p.BJ.Search:return p.uF.Ask;case p.BJ.FormulaGeneration:case p.BJ.ImportData:case p.BJ.ChartDesignRecommendations:return p.uF.Create;case p.BJ.Commanding:case p.BJ.ConditionalFormatting:case p.BJ.OfficeScripts:return p.uF.Command;case p.BJ.CopilotChat:case p.BJ.ExcelChatHelper:case p.BJ.Handoff:return p.uF.UnknownIntent;default:!function(e,t){if(!1===e)throw new Error(t)}(!1,"Missing verb map.")}}assertFeatureIsActive(e,t){if((!(0,w.yw9)("OfficeVSO_9564930_SplitCommandingTelemetry")||e!==p.BJ.Commanding||this.getActiveFeature()!==p.BJ.ConditionalFormatting)&&e&&e!==this.getActiveFeature()&&this.getActiveFeature()!==p.BJ.CopilotChat){const a=t+" - feature: "+e+" activeFeature: "+this.getActiveFeature();this.logError({eventType:m.S2.AssertionFailed,errorMessage:a,logLevel:C.$b.Error})}}constructor(){super(),this.seenEvents=new Set,this.rejectedIds=new Set,this.heldTelemetryEvents=[],this.heldAshaErrorEvents=[],this.correlationId="",this.excelCorrelationId="",this.fetchRecommendationsCorrelationId=null,this.analyzeDataSteps={},this.logException=()=>e=>t=>{const a=t.type;try{e(t)}catch(e){throw this.logErrorCode(i.O.ReducerException,e,m.S2.AnalyzeDataError,C.$b.Warning,{key:p.un.Source,value:a}),e}}}}L.querySource=void 0,L.nextQuerySource=void 0,L.currentEntryPoint=void 0},956933:(e,t,a)=>{"use strict";a.d(t,{Eb:()=>f,Q9:()=>h,Yw:()=>m,oR:()=>b,qH:()=>p,yu:()=>g});var n=a(822606),o=a(881707),r=a(116510),i=a(73915),l=a(83437),s=a(660606),c=a(423905),d=function(e,t,a,n){return new(a||(a=Promise))((function(o,r){function i(e){try{s(n.next(e))}catch(e){r(e)}}function l(e){try{s(n.throw(e))}catch(e){r(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof a?t:new a((function(e){e(t)}))).then(i,l)}s((n=n.apply(e,t||[])).next())}))},u=function(e,t){var a,n,o,r={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=l(0),i.throw=l(1),i.return=l(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(l){return function(s){return function(l){if(a)throw new TypeError("Generator is already executing.");for(;i&&(i=0,l[0]&&(r=0)),r;)try{if(a=1,n&&(o=2&l[0]?n.return:l[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,l[1])).done)return o;switch(n=0,o&&(l=[2&l[0],o.value]),l[0]){case 0:case 1:o=l;break;case 4:return r.label++,{value:l[1],done:!1};case 5:r.label++,n=l[1],l=[0];continue;case 7:l=r.ops.pop(),r.trys.pop();continue;default:if(!(o=r.trys,(o=o.length>0&&o[o.length-1])||6!==l[0]&&2!==l[0])){r=0;continue}if(3===l[0]&&(!o||l[1]>o[0]&&l[1]<o[3])){r.label=l[1];break}if(6===l[0]&&r.label<o[1]){r.label=o[1],o=l;break}if(o&&r.label<o[2]){r.label=o[2],r.ops.push(l);break}o[2]&&r.ops.pop(),r.trys.pop();continue}l=t.call(e,r)}catch(e){l=[6,e],n=0}finally{a=o=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,s])}}};function m(){0}var h=function(e){var t,a;if(e){(0,s.cY)("ClpUtils: Fetching clpSensitivityIndicatorData");var n,o={labelId:e.labelId,iconType:(n=e.encryptionType,n!==r.T.None?i.JF.Encryption:i.JF.NonEncryption),tooltipText:null!==(t=e.description)&&void 0!==t?t:"",badgeText:null!==(a=e.displayName)&&void 0!==a?a:""};return(0,s.cY)("ClpUtils: Returning clpSensitivityIndicatorData as ",o),o}(0,s.cY)("ClpUtils: Label is undefined")},g=function(){(0,s.cY)("ClpUtils: Fetching CLP label info..");var e=o.n.getInstance().getInDocSensitiveLabelInfo();if((0,s.cY)("ClpUtils: Label is : ".concat(JSON.stringify(e))),e.labelId)return(0,s.cY)("ClpUtils: Doc is labelled",e),e;(0,s.cY)("ClpUtils: Doc is not labelled")},p=function(e){return d(void 0,void 0,void 0,(function(){var t,a;return u(this,(function(r){switch(r.label){case 0:return e?(t={labelId:e.id,tenantId:e.tenantId},[4,o.n.getInstance().getHighestDocumentSensitivityInfo([t])]):[3,2];case 1:if(a=r.sent())return[2,h(a)];r.label=2;case 2:return[2,{tooltipText:(0,n.IQ)(),iconType:i.JF.Warning}]}}))}))},b=function(e){return e?{labelId:e.id,tenantId:"",displayName:e.displayName,description:e.tooltip,color:e.color,encryptionType:e.isEncrypted?r.T.IRMTemplate:r.T.None,order:e.priority}:{labelId:n.u1,tenantId:n.u1}},f=function(e,t){return d(void 0,void 0,void 0,(function(){var a,i,m,h,g,p,b,f,C,y,v,x;return u(this,(function(T){switch(T.label){case 0:return(null===(y=s.t6.IsCopilotInBackstageMode)||void 0===y?void 0:y.call(s.t6))?((0,s.cY)("getSensitivityConfig - skipping documentConfig in backstage mode"),[2,{copilotConfig:e()}]):[4,d(void 0,void 0,void 0,(function(){var e,t;return u(this,(function(a){switch(a.label){case 0:return e=o.n.getInstance().getInDocSensitiveLabelInfo(),s.t6.IsClpEnabledInEnterpriseForSydney()?[4,o.n.getInstance().getInDocSensitiveLabelUsingOfcJs()]:[3,3];case 1:return t=a.sent(),[4,o.n.getInstance().getHighestDocumentSensitivityInfo([e,t])];case 2:(e=a.sent()).isDke=t.isDke,e.hasExtractForUser=t.hasExtractForUser,a.label=3;case 3:return[2,e]}}))}))];case 1:return a=T.sent(),i={id:a.labelId,displayName:null!==(v=a.displayName)&&void 0!==v?v:"",tooltip:a.description,color:a.color,isEncrypted:a.encryptionType!==r.T.None,priority:null!==(x=a.order)&&void 0!==x?x:0},b={documentSensitivity:i},null==t?[3,2]:(h=t,[3,4]);case 2:return[4,s.t6.getOfficeJSDocumentURL()];case 3:h=T.sent(),T.label=4;case 4:return b.documentURL=h,b.hasExtract=a.labelId===n.u1||a.hasExtractForUser,b.isDKE=a.labelId!==n.u1&&a.isDke,m=b,(g={copilotConfig:e(),documentConfig:m}).copilotConfig&&s.EG.sendChatEventTelemetry((0,c.pN)(((f={})[l.h3.ChatEventType]=l.a5.CopilotConfig,f[l.h3.ChatEventParameters]=JSON.stringify(g.copilotConfig),f))),p=void 0===m.hasExtract&&void 0===m.isDKE,s.EG.sendChatEventTelemetry((0,c.pN)(((C={})[l.h3.ChatEventType]=l.a5.IsDocumentProtected,C[l.h3.ChatEventParameters]=!!p||!(!m.hasExtract||m.isDKE),C))),[2,g]}}))}))}},962127:(e,t,a)=>{"use strict";a.d(t,{_f:()=>l,wP:()=>c,Xj:()=>s});var n=a(586041),o=a(528804);function r(e){switch(e){case l.Colorful:case l.White:return{buttonBackgroundDisabled:"#F0F0F0",buttonBackgroundHovered:"#FAFAFA",buttonBackgroundPressed:"#F5F5F5",menuBackground:"#FAFAFA",menuItemBackgroundHovered:"#F0F0F0",menuItemBackgroundPressed:"#DBDBDB"};case l.Black:return{buttonBackgroundDisabled:"#0A0A0A",buttonBackgroundHovered:"#1F1F1F",buttonBackgroundPressed:"#000000",menuBackground:"#1F1F1F",menuItemBackgroundHovered:"#333333",menuItemBackgroundPressed:"#141414"};case l.DarkGray:return{buttonBackgroundDisabled:"#2E2E2E",buttonBackgroundHovered:"#3D3D3D",buttonBackgroundPressed:"#242424",menuBackground:"#424242",menuItemBackgroundHovered:"#525252",menuItemBackgroundPressed:"#383838"};default:return{}}}const i={White:"#FFFFFF",GrayB:"#E6E6E6",GrayE2:"#666666",GrayI:"#262626",GrayJ:"#0a0a0a",Gray18:"#2e2e2e",Gray94:"#f0f0f0",Gray96:"#f5f5f5",ExcelGreen:"#107C41",MacDark:"#323232"};var l;function s(e){const t=function(e){switch(e){case l.DarkGray:return{neutralLight:"#242424",neutralSecondary:"#FFFFFF",themeSecondary:"#E6E6E6"};case l.Black:case l.MacDark:return{neutralLight:"#000000",neutralSecondary:"#FFFFFF",themeSecondary:"#D6D6D6"};case l.White:case l.Colorful:default:return{neutralLight:"#F5F5F5",neutralSecondary:"#212121",themeSecondary:"#424242"}}}(e),a=(0,n.a)({palette:t,semanticColors:r(e)});a.name=e,function(e){const t=document.getElementsByTagName("body").item(0);switch(e){case"DarkGray":return t.classList.toggle("black",!1),void t.classList.toggle("dark-gray",!0);case"Black":return t.classList.toggle("dark-gray",!1),void t.classList.toggle("black",!0);default:t.classList.toggle("dark-gray",!1),t.classList.toggle("black",!1)}}(e);const o=document.documentElement;return o.style.setProperty("--theme-themePrimary",a.palette.themePrimary),o.style.setProperty("--theme-themeLighterAlt",a.palette.themeLighterAlt),o.style.setProperty("--theme-themeLighter",a.palette.themeLighter),o.style.setProperty("--theme-themeLight",a.palette.themeLight),o.style.setProperty("--theme-themeTertiary",a.palette.themeTertiary),o.style.setProperty("--theme-themeSecondary",a.palette.themeSecondary),o.style.setProperty("--theme-themeDarkAlt",a.palette.themeDarkAlt),o.style.setProperty("--theme-themeDark",a.palette.themeDark),o.style.setProperty("--theme-themeDarker",a.palette.themeDarker),o.style.setProperty("--theme-neutralLighterAlt",a.palette.neutralLighterAlt),o.style.setProperty("--theme-neutralLighter",a.palette.neutralLighter),o.style.setProperty("--theme-neutralLight",a.palette.neutralLight),o.style.setProperty("--theme-neutralQuaternaryAlt",a.palette.neutralQuaternaryAlt),o.style.setProperty("--theme-neutralQuaternary",a.palette.neutralQuaternary),o.style.setProperty("--theme-neutralTertiaryAlt",a.palette.neutralTertiaryAlt),o.style.setProperty("--theme-neutralTertiary",a.palette.neutralTertiary),o.style.setProperty("--theme-neutralSecondary",a.palette.neutralSecondary),o.style.setProperty("--theme-neutralPrimaryAlt",a.palette.neutralPrimaryAlt),o.style.setProperty("--theme-neutralPrimary",a.palette.neutralPrimary),o.style.setProperty("--theme-neutralDark",a.palette.neutralDark),o.style.setProperty("--theme-white",a.palette.white),o.style.setProperty("--theme-redDark",a.palette.redDark),o.style.setProperty("--theme-whiteTranslucent40",a.palette.whiteTranslucent40),o.style.setProperty("--theme-green",a.palette.green),o.style.setProperty("--theme-black",a.palette.black),a}function c(){if(!!!window.Office)return"Colorful";try{const e=Office.context.officeTheme;return function(e){switch(e){case i.GrayB:return"Colorful";case i.GrayE2:return"DarkGray";case i.GrayI:return"Black";case i.White:return"White";case i.MacDark:return(0,o.yw9)("OfficeVSO_9748572_PythonAccessibilityBugFixForMac")?"MacDark":"Colorful";default:return"Colorful"}}(e?e.bodyBackgroundColor.toUpperCase():"")}catch{return"Colorful"}}!function(e){e.Colorful="Colorful",e.DarkGray="DarkGray",e.Black="Black",e.White="White",e.MacDark="MacDark"}(l||(l={}))},964747:(e,t,a)=>{"use strict";a.d(t,{f:()=>o});var n=a(89477);class o{hasMore(){return this.providers.length>0}removeCurrent(){this.providers.shift()}getCurrent(){if(!this.hasMore())throw new Error("No AuthProviders available");return this.providers[0]}reset(e){this.providers=e||[new n.f]}constructor(e){this.providers=[],this.reset(e)}}},965634:(e,t,a)=>{"use strict";var n,o,r,i,l,s,c,d,u,m,h,g,p,b,f,C,y,v,x,T,S;a.d(t,{$:()=>m,A:()=>S,E_:()=>i,HR:()=>C,IC:()=>c,IM:()=>x,IX:()=>p,L3:()=>g,Qs:()=>s,S2:()=>n,Wg:()=>o,Zf:()=>T,d:()=>h,f8:()=>y,fQ:()=>d,j9:()=>v,jo:()=>b,nn:()=>r,tE:()=>l,tM:()=>u,xm:()=>f}),function(e){e.Augloop="Augloop",e.Error="Error",e.Latency="Latency",e.Warning="Warning",e.ChatEvents="ChatEvents",e.OfficeJsOperations="OfficeJsOperations",e.Converter="Converter",e.Executor="Executor",e.NoEventGenerated="NoEventGenerated",e.NoEventExecuted="NoEventExecuted",e.StatementArgumentError="StatementArgumentError",e.ConverterError="ConverterError",e.AnalyzeDataDuration="AnalyzeDataDuration",e.AnalyzeDataError="AnalyzeDataError",e.AnalyzeDataEvents="AnalyzeDataEvents",e.SuggestionEvents="SuggestionEvents",e.ContextManager="ContextManager",e.CitationFileUtils="CitationFileUtils",e.ImportData="ImportData",e.PowerQueryHelper="PowerQueryHelper",e.Usage="Usage",e.TabularRange="TabularRange",e.WorkbookContext="WorkbookContext",e.AuthError="AuthError",e.Undo="Undo",e.FormulaGeneration="FormulaGeneration",e.UncaughtException="UncaughtException",e.PythonDuration="PythonDuration",e.PythonEvents="PythonEvents",e.PythonError="PythonError",e.OfficeScriptSkillHandler="OfficeScriptSkillHandler",e.OfficeScriptsContextManager="OfficeScriptsContextManager",e.OfficeScriptsRename="OfficeScriptsRename",e.Localization="Localization",e.FetchCitationMetadata="FetchCitationMetadata",e.FetchTablesRelevancy="FetchTablesRelevancy",e.GetResolvedCitations="GetResolvedCitations",e.StreamHandler="StreamHandler",e.RefreshRibbonGallery="RefreshRibbonGallery",e.MakerStorageEvent="MakerStorageEvent",e.SpecialRefApiUpdated="SpecialRefApiUpdated",e.UserContextAnnotation="UserContextAnnotation",e.AssertionFailed="AssertionFailed",e.AuthSuccess="AuthSuccess",e.AutoFixTLR="AutoFixTLR",e.ImageChat="ImageChat",e.FormatMetadataFallback="FormatMetadataFallback",e.AugloopDiagnostics="AugloopDiagnostics",e.DataShaping="DataShaping",e.ZeroQueryMessageClicks="ZeroQueryMessageClicks",e.CommandingScratchpad="CommandingScratchpad",e.CommandingError="CommandingError",e.ChartDesignRecommendations="ChartDesignRecommendations",e.Safelinks="Safelinks"}(n||(n={})),function(e){e.UserQueryGuid="UserQueryGuid",e.UserQueryGuid_="userQueryGuid",e.ClientVersion="ClientVersion",e.GroundingMode="GroundingMode",e.IsDevBuild="IsDevBuild",e.UiLanguage="UiLanguage",e.QuerySource="querySource",e.IsPythonAdaInCopilotEnabled="IsPythonAdaInCopilotEnabled",e.GroundingMode_="groundingMode",e.SuggestionId="suggestionId",e.Source="Source",e.SelectionChange="selectionChange",e.UnsupportedWorkflow="UnsupportedWorkflow",e.TableMetadata="TableMetadata",e.FetchType="FetchType",e.PythonFlights="PythonFlights",e.IsPythonThinkDeeperMode="IsPythonThinkDeeperMode",e.IsModelessPythonAAEnabled="IsModelessPythonAAEnabled",e.ActiveFeatureName="ActiveFeatureName",e.CopilotExperience="CopilotExperience"}(o||(o={})),function(e){e.Operation="operation"}(r||(r={})),function(e){e.Event="event",e.QueryId="queryId",e.Success="success",e.FoundCallback="foundCallback",e.Duration="duration"}(i||(i={})),function(e){e.ActionType="ActionType",e.FeatureName="FeatureName",e.Source="Source",e.SuggestionId="SuggestionId",e.UserQueryGuid="UserQueryGuid",e.ActionVariant="ActionVariant"}(l||(l={})),function(e){e.PromptDescription="PromptDescription"}(s||(s={})),function(e){e.RequestId="RequestId",e.Success="Success",e.ExecutionTime="ExecutionTime",e.Error="Error",e.TotalFiles="TotalFiles",e.ResolvedCitations="ResolvedCitations",e.ResolvedValidCitations="ResolvedValidCitations",e.UnresolvedCitations="UnresolvedCitations",e.ResolvedDataSources="ResolvedDataSources",e.ValidDataSources="ValidDataSources"}(c||(c={})),function(e){e.Source="Source",e.Operations="Operations"}(d||(d={})),function(e){e.ConversationHistoryCount="ConversationHistoryCount",e.DidAugloopCallFail="DidAugloopCallFail",e.DidInsert="DidInsert",e.Duration="Duration",e.CodeErrorCount="CodeErrorCount",e.FormulasProcessed="FormulasProcessed",e.FormulasProcessedPerWorksheet="FormulasProcessedPerWorksheet",e.IsErrorCaught="IsErrorCaught",e.IsPythonCellSelected="IsPythonCellSelected",e.IsStopGenerating="IsStopGenerating",e.IsSuccess="IsSuccess",e.OptionalDetails="OptionalDetails",e.OtherPythonCellsCount="OtherPythonCellsCount",e.PythonDurationEvent="PythonDurationEvent",e.RetryCount="RetryCount",e.TimerName="TimerName",e.IsFirstCodeExecution="IsFirstCodeExecution",e.ResponseNumber="ResponseNumber",e.UserScenarioId="UserScenarioId",e.WorksheetsProcessed="WorksheetsProcessed"}(u||(u={})),function(e){e.AddLocalImageReferenceCellAddress="AddLocalImageReferenceCellAddress",e.ApiFailure="ApiFailure",e.AugLoopCalls="AugLoopCalls",e.CalculationMode="CalculationMode",e.CalloutScenario="CallOutScenario",e.CardInsertionButtonType="CardInsertionButtonType",e.CardInsertionContentType="CardInsertionContentType",e.CardType="CardType",e.ChartType="ChartType",e.ChunkType="ChunkType",e.Code="Code",e.ColumnHidden="ColumnHidden",e.CurrentIsPythonCellSelected="CurrentIsPythonCellSelected",e.ErrorMessage="ErrorMessage",e.ErrorName="ErrorName",e.ErrorStack="ErrorStack",e.ErrorSubType="ErrorSubType",e.ErrorType="ErrorType",e.ExecutePythonCodeCorrelationId="ExecutePythonCodeCorrelationId",e.FinalText="FinalText",e.IsSuccess="IsSuccess",e.MissingData="MissingData",e.OldPythonCellSelected="OldPythonCellSelected",e.OutputType="OutputType",e.PythonComplexType="PythonComplexType",e.RequestId="RequestId",e.RetryAttempts="RetryAttempts",e.RowHidden="RowHidden",e.StartAnalysis="StartAnalysis",e.StatusMessage="StatusMessage",e.Suggestions="Suggestions",e.TableNameHasBackslash="TableNameHasBackslash",e.Text="Text"}(m||(m={})),function(e){e.LabelRowHidden="LabelRowHidden",e.LabelColumnHidden="LabelColumnHidden",e.ContentRowHidden="ContentRowHidden",e.ContentColumnHidden="ContentColumnHidden"}(h||(h={})),function(e){e.AddLocalImageReference="AddLocalImageReference",e.AddResultsToAnotherSheetButtonClicked="AddResultsToAnotherSheetButtonClicked",e.AugLoopCallsCompleted="AugLoopCallsCompleted",e.AdvancedAnalysisStartedFromAnalysisSheet="AdvancedAnalysisStartedFromAnalysisSheet",e.CannotConnectToOfficePyService="CannotConnectToOfficePyService",e.CardInsertionButtonClicked="CardInsertionButtonClicked",e.CardShownWithInsertionButton="CardShownWithInsertionButton",e.CopyButtonClicked="CopyButtonClicked",e.DataFrameCodeProperty="DataFrameCodeProperty",e.ExecutePythonCodeApi="ExecutePythonCodeApi",e.ExecutionResult="ExecutionResult",e.ExitAnalysisClicked="ExitAnalysis",e.ForcedCalculation="ForcedCalculation",e.GetOfficePyServiceAccessTokenFailed="GetOfficePyServiceAccessTokenFailed",e.GetPythonContextObjectFailed="GetPythonContextObjectFailed",e.GoBackToAnalysisSheetFailed="GoBackToAnalysisSheetFailed",e.IncompleteContext="IncompleteContext",e.InsertInHiddenCell="InsertInHiddenCell",e.InteractiveChartImageInserted="InteractiveChartImageInserted",e.InteractiveChartRendered="InteractiveChartRendered",e.IsPythonCellFailed="IsPythonCellFailed",e.Key="PythonEvent",e.ListenerAttached="ListenerAttached",e.MessageToAugLoopIsTooLarge="MessageToAugLoopIsTooLarge",e.ModelessMissingProperty="ModelessMissingProperty",e.ModelessUnsupportedType="ModelessUnsupportedType",e.PickAWinnerAdvancedAnalysisClicked="PickAWinnerAdvancedAnalysisClicked",e.PickAWinnerPivotsAndChartsClicked="PickAWinnerPivotsAndChartsClicked",e.PythonComplexTypeEncountered="PythonComplexTypeEncountered",e.RecalcSheetMissingSheetId="RecalcSheetMissingSheetId",e.ResponseShown="ResponseCardShown",e.StartAnalysisClicked="StartAnalysisClicked",e.StaticChartImageInserted="StaticChartImageInserted",e.StaticChartRendered="StaticChartRendered",e.TrimmedContextModified="TrimmedContextModified",e.UpdateContextTLRCalledOnNonTLR="UpdateContextTLRCalledOnNonTLR",e.UpdateIsPythonCellSelected="UpdateIsPythonCellSelected"}(g||(g={})),function(e){e.OperationSize="OperationSize",e.ContextMemoSize="ContextMemoSize",e.MessageTextSize="MessageTextSize",e.QueryAnnotationSize="QueryAnnotationSize",e.ImageTileSize="ImageTileSize"}(p||(p={})),function(e){e.PythonAnalysisSessionId="PythonAnalysisSessionId",e.PythonModeValue="PythonModeValue",e.IsPythonThinkDeeperMode="IsPythonThinkDeeperMode",e.IsModelessPythonAAEnabled="IsModelessPythonAAEnabled",e.IsModelessPython="IsModelessPython"}(b||(b={})),function(e){e.IsPythonAdaInCopilotEnabled="IsPythonAdaInCopilotEnabled",e.IsPythonManualPromptEnabled="IsPythonManualPromptEnabled",e.IsPythonPlannerEnabled="IsPythonPlannerEnabled",e.IsModelessPythonAAEnabled="IsModelessPythonAAEnabled",e.IsPythonAAStartAnalysisButtonGreenExperimentEnabled="IsPythonAAStartAnalysisButtonGreenExperimentEnabled"}(f||(f={})),function(e){e.DetailedErrorMessage="DetailedErrorMessage",e.FormulasProcessed="FormulasProcessed",e.Stack="Stack",e.IsAceImpacting="IsAceImpacting",e.WorksheetsProcessed="WorksheetsProcessed",e.FeatureName="FeatureName"}(C||(C={})),function(e){e.IsPythonFormula="IsPythonFormula"}(y||(y={})),function(e){e.Operation="Operation",e.IsQueryNull="QueryNull",e.Stack="Stack"}(v||(v={})),function(e){e.InsertButton="InsertButton",e.InsertToSheetButton="InsertToSheetButton"}(x||(x={})),function(e){e.Image="Image",e.Table="Table"}(T||(T={})),function(e){e.AutoRefreshEnabled="autoRefreshEnabled"}(S||(S={}))},974717:(e,t,a)=>{"use strict";a.d(t,{_:()=>s});var n=a(449650);function o(e,t){return null===e.column||null===e.row||null===t.column||null===t.row?1/0:Math.sqrt(Math.pow(e.column-t.column,2)+Math.pow(e.row-t.row,2))}function r(e,t){if(null===e.column||null===e.row||null===t.bottomRight.row||null===t.bottomRight.column||null===t.topLeft.row||null===t.topLeft.column)return 1/0;if(e.row>=t.topLeft.row&&e.row<=t.bottomRight.row)return Math.abs(e.column-t.topLeft.column);const a=o(e,t.topLeft),n=o(e,t.bottomRight);return Math.min(a,n)}function i(e,t){if(null===e.column||null===e.row||null===t.bottomRight.row||null===t.bottomRight.column||null===t.topLeft.row||null===t.topLeft.column)return 1/0;if(e.column>=t.topLeft.column&&e.column<=t.bottomRight.column)return Math.abs(e.row-t.topLeft.row);const a=o(e,t.topLeft),n=o(e,t.bottomRight);return Math.min(a,n)}function l(e,t){const a=[{topLeft:t.topLeft,bottomRight:{row:t.topLeft.row,column:t.bottomRight.column}},{topLeft:{row:t.bottomRight.row,column:t.topLeft.column},bottomRight:t.bottomRight}],n=[{topLeft:t.topLeft,bottomRight:{row:t.bottomRight.row,column:t.topLeft.column}},{topLeft:{row:t.topLeft.row,column:t.bottomRight.column},bottomRight:t.bottomRight}];let o=1/0;for(const t of a){const a=i(e,t);o=Math.min(o,a)}for(const t of n){const a=r(e,t);o=Math.min(o,a)}return o}function s(e,t){const a=[{row:e.topLeft.row,column:e.topLeft.column},{row:e.topLeft.row,column:e.bottomRight.column},{row:e.bottomRight.row,column:e.topLeft.column},{row:e.bottomRight.row,column:e.bottomRight.column}];if(n.ExcelCalc.IExcelRangeIntersect(e,t))return 0;let o=1/0;for(const e of a){const a=l(e,t);o=Math.min(o,a)}return o}},977055:(e,t,a)=>{"use strict";a.d(t,{$J:()=>L,$y:()=>F,Am:()=>n,BA:()=>w,DC:()=>S,Jr:()=>E,Lv:()=>M,M5:()=>f,PB:()=>y,Qc:()=>v,Rj:()=>C,S$:()=>x,SG:()=>g,XB:()=>T,_8:()=>p,_T:()=>_,eA:()=>P,fL:()=>b,fU:()=>I,hp:()=>A,nQ:()=>R,oA:()=>N,p1:()=>D,xX:()=>k,yQ:()=>O});var n,o=a(755005),r=a(965634),i=a(83437),l=a(697705),s=a(956258),c=a(984691),d=a(9847),u=a(797639),m=a(528804),h=a(108869);function g(){return u.CP.pythonContextManager.isPythonMode?d.q.Python:d.q.Answers}function p(e){s.M.getInstance().logEvent((0,d.SV)(d.he.SuggestionShown,d.q.Python,e)),s.M.getInstance().endTriedActivitySuccess(d.q.Python)}function b(e){s.M.getInstance().logEvent((0,d.SV)(d.he.SuggestionShown,d.q.Answers,e)),s.M.getInstance().endTriedActivitySuccess(d.q.Answers)}function f(){s.M.getInstance().logEvent((0,d.SV)(d.he.SuggestionApplied,d.q.Python,d.KZ.PythonAdaCodeInserted)),l.B.getInstance().logKeptEvent(d.BJ.Python,d.q.Python,c.RX.Analyze)}function C(e){const t=(0,d.SV)(d.he.TeachingCalloutShown,d.q.Python,d.KZ.PythonAdaCodeInserted);t.eventData?.push({key:r.$.CalloutScenario,value:e}),s.M.getInstance().logEvent(t)}function y(e,t){t.push({key:r.L3.Key,value:e}),t=t.concat(D());const a={eventType:r.S2.PythonEvents,eventData:t};s.M.getInstance().logEvent(a)}function v(e,t,a){const n=[];n.push({key:r.$.CardInsertionButtonType,value:t}),n.push({key:r.$.CardInsertionContentType,value:a}),y(e,n)}function x(e,t){const a=[];let n=!0;if(t.outputType===o.qf.Error){const{errorName:t,errorType:o,errorSubType:i,errorMessage:l}=(0,h.$e)(e);n=!1,a.push({key:r.$.ErrorName,value:t}),a.push({key:r.$.ErrorType,value:o}),a.push({key:r.$.ErrorSubType,value:i}),"ModuleNotFoundError"===t&&a.push({key:r.$.ErrorMessage,value:l}),a.push({key:r.$.RetryAttempts,value:u.CP.pythonContextManager.codeRetryAttempts})}a.push({key:r.$.IsSuccess,value:n}),a.push({key:r.$.OutputType,value:t.outputType}),y(r.L3.ExecutionResult,a)}function T(e,t,a,n){const o=[];o.push({key:r.d.LabelRowHidden,value:e}),o.push({key:r.d.LabelColumnHidden,value:t}),o.push({key:r.d.ContentRowHidden,value:a}),o.push({key:r.d.ContentColumnHidden,value:n}),y(r.L3.InsertInHiddenCell,o)}function S(e,t){const a=[];a.push({key:r.$.CardType,value:e}),t&&a.push({key:r.$.CalculationMode,value:t}),y(r.L3.ResponseShown,a)}function w(e){const t=[];t.push({key:r.$.RequestId,value:e}),y(r.L3.ListenerAttached,t)}function E(e,t){const a=[];a.push({key:r.$.AugLoopCalls,value:e}),a.push({key:r.$.RetryAttempts,value:t}),y(r.L3.AugLoopCallsCompleted,a)}function I(e,t,a,n,o){const i=[{key:r.IX.OperationSize,value:e},{key:r.IX.ContextMemoSize,value:t},{key:r.IX.MessageTextSize,value:a},{key:r.IX.QueryAnnotationSize,value:n},{key:r.IX.ImageTileSize,value:o}];y(r.L3.MessageToAugLoopIsTooLarge,i)}function R(e,t){const a=[];a.push({key:r.$.ExecutePythonCodeCorrelationId,value:e}),t&&a.push({key:r.$.ApiFailure,value:t}),y(r.L3.ExecutePythonCodeApi,a)}function A(e,t){const a=[{key:r.$.OldPythonCellSelected,value:e},{key:r.$.CurrentIsPythonCellSelected,value:t}];y(r.L3.UpdateIsPythonCellSelected,a)}function L(e){const t=[];t.push({key:r.f8.IsPythonFormula,value:e}),y(r.L3.ForcedCalculation,t)}function k(e,t,a){const n=[{key:r.j9.Operation,value:e},{key:r.j9.IsQueryNull,value:t},{key:r.j9.Stack,value:a??"No stack available."}];y(r.L3.TrimmedContextModified,n)}function F(e){const t=[];t.push({key:r.$.PythonComplexType,value:e}),y(r.L3.PythonComplexTypeEncountered,t)}function _(e){const t=[];t.push({key:r.$.ChartType,value:e}),y(r.L3.InteractiveChartRendered,t)}function P(){y(r.L3.ModelessUnsupportedType,[])}function N(e){const t=[];t.push({key:r.$.ChunkType,value:e}),y(r.L3.ModelessMissingProperty,t)}function M(e,t){const a={eventType:e.eventType,errorMessage:e.errorCode,logLevel:i.$b.ASHA};let n=[{key:r.HR.DetailedErrorMessage,value:e.errorDetailsNoPII??e.message},{key:r.HR.Stack,value:e.stack??""}];n.push({key:r.HR.IsAceImpacting,value:e.isAceImpacting}),n.push({key:r.HR.FeatureName,value:e.telemetryStandardizedFeature}),t&&n.push(...t),n=n.concat(D()),s.M.getInstance().logError(a,void 0,n)}function O(e){const t=e.telemetryStandardizedFeature;s.M.getInstance().logStandardizedAshaErrorEvent(e.ashaVeto,e.ashaError,t)}function D(){const e=[];return e.push({key:r.jo.PythonAnalysisSessionId,value:u.CP.pythonContextManager.analysisSessionId??""}),e.push({key:r.jo.IsPythonThinkDeeperMode,value:u.CP.pythonContextManager.isPythonThinkDeeperMode}),(0,m.yw9)("OfficeVSO_9979155_PythonFlightsAsJSONString")||e.push(...function(){const e=[];return e.push({key:r.xm.IsPythonAdaInCopilotEnabled,value:(0,m.H2A)()}),e.push({key:r.xm.IsPythonManualPromptEnabled,value:(0,m.w9F)()}),e.push({key:r.xm.IsPythonPlannerEnabled,value:(0,m.gnD)()}),e.push({key:r.xm.IsModelessPythonAAEnabled,value:(0,m.EJJ)()}),e.push({key:r.xm.IsPythonAAStartAnalysisButtonGreenExperimentEnabled,value:(0,m.iq2)()}),e}()),e}!function(e){e.Update="Update",e.Clear="Clear"}(n||(n={}))},979426:(e,t,a)=>{"use strict";a.d(t,{C:()=>l,_:()=>s});var n=a(686576),o=a(977055);const r=e=>e.every((e=>e.every((e=>!e.includes("[object Object]")))))?n.z.Table:n.z.TableWithObjects,i=e=>{if(null===e)return"None";if(Array.isArray(e)){if(e.some((e=>Array.isArray(e)||"object"==typeof e&&null!==e))){return`[${e.map((e=>Array.isArray(e)||"object"==typeof e&&null!==e?"[object Object]":null===e?"null":String(e))).join(",")}]`}return JSON.stringify(e)}if("object"==typeof e&&null!==e&&"type"in e){if("datetime"===e.type&&"value"in e)return String(e.value);if(!("value"in e))return e.type}return String(e)};function l(e){return"string"==typeof e?isFinite(Number(e.trim())):"number"==typeof e}function s(e,t){if(!e)return{output:e,outputType:n.z.None};if(t===n.z.Image)return{output:e,outputType:n.z.Image};if(!isNaN(Number(e))&&""!==e.trim()||l(e))return{output:e,outputType:n.z.Number};if("true"===e.toLowerCase()||"false"===e.toLowerCase())return{output:e,outputType:n.z.Boolean};try{const t=JSON.parse(e);if(Array.isArray(t)&&t.length>0){if(t.every((e=>Array.isArray(e)&&e.length===t[0].length&&t[0].length>0))){const e=t.map((e=>e.map((e=>i(e)))));return{output:e,outputType:r(e)}}return{output:e,outputType:n.z.Json}}if(typeof t===n.z.Object)return{output:e,outputType:n.z.Json}}catch(t){return(0,o.eA)(),{output:e,outputType:n.z.String}}return{output:e,outputType:n.z.String}}},988013:(e,t,a)=>{"use strict";a.d(t,{U:()=>g,j:()=>h});var n=a(956258),o=a(874066),r=a(235373),i=a(420715),l=a(644476),s=a(10021),c=a(348065),d=a(547131),u=a(389298),m=a(887648);const h=()=>(0,m.wA)();function g(e){const t={app:o.F,chat:r.F,dataAI:s.F,selection:d.F,telemetry:u.F},a=(0,i.HY)(t);return(0,l.U1)({reducer:a,middleware:e=>e().concat(n.M.getInstance().logException,c.F_.middleware),preloadedState:e})}},991869:(e,t,a)=>{"use strict";a.d(t,{C6:()=>f,XX:()=>y,gl:()=>p,xt:()=>C});var n=a(722307),o=a(83437),r=a(911443),i=a(352628),l=a(965634),s=a(956258),c=a(79458),d=a(528804),u=a(267324);const m="en-US";function h(e,t){const a=document.createElement("script");a.type="text/javascript",a.src=e,(0,c.cY)("Loading Localized strings for Language: "+e);const i=new Promise(((i,d)=>{a.onload=()=>{(0,c.cY)("Loaded Localized strings for Language: "+e),i()},a.onerror=a.onabort=()=>{const a=(0,n.Yd)();s.M.getInstance().logError({eventType:l.S2.Localization,errorMessage:"Failed to load script url = "+e.split("/")?.pop()+" with mapped language = "+t+" and display language = "+a,logLevel:o.$b.Warning}),d(new r.DY(r._s.FailedToLoadStrings,"Failed to load strings with mapped language = "+t+" and display language = "+a))}}));return document.head.appendChild(a),i}let g="";function p(){return g}let b="";function f(){return g!==b}function C(){return i.b_.includes(g)}async function y(){const e=(0,n.Yd)();(0,c.cY)("Display Language Detected: "+e);const t=new r.dD;t.IsTier2LanguageSupportEnabled=(0,d.vK$)(),t.IsTier2RTLLanguageEnabled=(0,d.vCb)(),t.IsTier2Point5LanguagesEnabled=(0,d.GpD)(),t.IsTier3LanguagesEnabled=(0,d.oVT)(),t.IsTier4LanguagesEnabled=(0,d.J_)(),g=t.getUserLanguage(e),b=function(e,t){return-1===t.indexOf(e)?m:e}(e,i.$9),(0,u.N1d)(i.$n.includes(g),i.$n.includes(b));const a="office-online-strings/"+g.toLowerCase()+"/officeaicopilot-strings.min.js",o="excel-copilot-strings",l=o+"/"+g.toLowerCase()+"/excel-copilot-strings.js",s=o+"/"+b.toLowerCase()+"/excel-copilot-strings-n-tier.js",p=o+"/"+g.toLowerCase()+"/excel-copilot-commanding-hitl-strings.js";try{return(0,d.k64)()?Promise.all([h(l,g),h(a,g),h(s,b),h(p,g)]):Promise.all([h(l,g),h(a,g),h(s,b)])}catch(e){const t=(0,n.Yd)();throw new r.DY(r._s.FailedToLoadStrings,"Failed to load strings with mapped language = "+g+", unclassified Tier Language = "+b+" and display language = "+t)}}},993384:(e,t,a)=>{"use strict";a.d(t,{FZ:()=>r,dI:()=>i,xs:()=>c});var n=a(820633),o=a(528804);function r(){return{isLoaded:!1,localeInfo:{},calcLocaleInfo:{}}}function i(e){e.application.cultureInfo.load("name");const t=e.application.cultureInfo.numberFormat,a=e.application.cultureInfo.datetimeFormat;let r;return t.load("numberGroupSeparator"),t.load("numberDecimalSeparator"),(0,n.r1)()&&(r=e.application.cultureInfo.formulaCulture,r?.load(),a.load(),t.load()),e.application.cultureInfo.numberFormat.load("currencySymbol"),()=>{const i={isLoaded:!1,localeInfo:{},calcLocaleInfo:{}},c=e.application.cultureInfo.name.toLowerCase();i.dataLocale=c,"."!==e.application.cultureInfo.numberFormat.numberDecimalSeparator&&(i.localeInfo.decimalPoint=e.application.cultureInfo.numberFormat.numberDecimalSeparator),","!==e.application.cultureInfo.numberFormat.numberGroupSeparator&&(i.localeInfo.digitGrouping=e.application.cultureInfo.numberFormat.numberGroupSeparator),"$"!==e.application.cultureInfo.numberFormat.currencySymbol&&(i.localeInfo.currencySymbol=e.application.cultureInfo.numberFormat.currencySymbol);const d=(0,o.yw9)("OfficeVSO_9573790_crashOnLocaleNotBCPFormatted");if(d||"en-us"===c||(i.localeInfo.longDay=s(c,"long"),i.localeInfo.shortDay=s(c,"short"),i.localeInfo.longMonth=l(c,"long"),i.localeInfo.medMonth=l(c,"short"),i.localeInfo.shortMonth=l(c,"narrow")),(0,n.r1)()){i.calcLocaleInfo.falseName=r?.falseName,i.calcLocaleInfo.trueName=r?.trueName,i.calcLocaleInfo.errorTypeNames=r?.errorTypeNames,i.calcLocaleInfo.leftBrace=r?.leftBrace,i.calcLocaleInfo.leftBracket=r?.leftBracket,i.calcLocaleInfo.listSeparator=r?.listSeparator,i.calcLocaleInfo.rightBracket=r?.rightBracket,i.calcLocaleInfo.rightBrace=r?.rightBrace,i.calcLocaleInfo.specialRefNames=r?.specialRefNames,i.calcLocaleInfo.uppercaseColumnLetter=r?.uppercaseColumnLetter,i.calcLocaleInfo.uppercaseRowLetter=r?.uppercaseRowLetter,i.calcLocaleInfo.worksheetFunctionNames=r?.worksheetFunctionNames;try{i.calcLocaleInfo.rowSeparator=r?.rowSeparator,i.calcLocaleInfo.columnSeparator=r?.columnSeparator}catch(e){}i.calcLocaleInfo.dateSeparator=a.dateSeparator,i.calcLocaleInfo.longDatePattern=a.longDatePattern,i.calcLocaleInfo.shortDatePattern=a.shortDatePattern,i.calcLocaleInfo.timeSeparator=a.timeSeparator,i.calcLocaleInfo.longTimePattern=a.longTimePattern,i.calcLocaleInfo.amSymbol=a.amSymbol,i.calcLocaleInfo.dateOrder=a.dateOrder,i.calcLocaleInfo.dateSeparatorAlternative=a.dateSeparatorAlternative,i.calcLocaleInfo.dayNameLong=a.dayNameLong,i.calcLocaleInfo.dayNameShort=a.dayNameShort,i.calcLocaleInfo.isAmPmSeparatedBySpace=a.isAmPmSeparatedBySpace,i.calcLocaleInfo.isClock24Hour=a.isClock24Hour,i.calcLocaleInfo.isDayTwoDigits=a.isDayTwoDigits,i.calcLocaleInfo.isHourTwoDigits=a.isHourTwoDigits,i.calcLocaleInfo.isLongDateFormat=a.isLongDateFormat,i.calcLocaleInfo.isMonthTwoDigits=a.isMonthTwoDigits,i.calcLocaleInfo.isYearFourDigits=a.isYearFourDigits,i.calcLocaleInfo.isYearFourDigits=a.isYearFourDigits,i.calcLocaleInfo.monthNameLong=a.monthNameLong,i.calcLocaleInfo.monthNameShort=a.monthNameShort,i.calcLocaleInfo.pmSymbol=a.pmSymbol,i.calcLocaleInfo.timeSeparatorAlternative=a.timeSeparatorAlternative,i.calcLocaleInfo.numberDecimalSeparator=t.numberDecimalSeparator,i.calcLocaleInfo.numberGroupSeparator=t.numberGroupSeparator,i.calcLocaleInfo.currencySymbol=t.currencySymbol,i.calcLocaleInfo.currencyDecimals=t.currencyDecimals,i.calcLocaleInfo.currencyNegative=t.currencyNegative,i.calcLocaleInfo.fractionSeparator=t.fractionSeparator,i.calcLocaleInfo.isCurrencySeparatedBySpace=t.isCurrencySeparatedBySpace,i.calcLocaleInfo.isCurrencySymbolLeading=t.isCurrencySymbolLeading,i.calcLocaleInfo.nonCurrencyNumberDecimals=t.nonCurrencyNumberDecimals,i.calcLocaleInfo.numberGrouping=t.numberGrouping,i.calcLocaleInfo.spaceBeforePercentage=t.spaceBeforePercentage,i.calcLocaleInfo.spaceInScientificNotation=t.spaceInScientificNotation,d&&(i.localeInfo.longDay=a.dayNameLong,i.localeInfo.shortDay=a.dayNameShort,i.localeInfo.longMonth=a.monthNameLong,i.localeInfo.medMonth=a.monthNameShort,i.localeInfo.shortMonth=a.monthNameShort)}else if(d&&"en-us"!==c){const t=e.application.cultureInfo.name.toLowerCase().split("_")[0];i.localeInfo.longDay=s(t,"long"),i.localeInfo.shortDay=s(t,"short"),i.localeInfo.longMonth=l(t,"long"),i.localeInfo.medMonth=l(t,"short"),i.localeInfo.shortMonth=l(t,"narrow")}return i.isLoaded=!0,i}}function l(e,t){const a=new Intl.DateTimeFormat(e,{month:t}),n=[];for(let e=1;e<13;e++){const t=new Date(Date.UTC(2e3,e,1,0,0,0));n.push(a.format(t))}return n}function s(e,t){const a=new Intl.DateTimeFormat(e,{weekday:t}),n=[];for(let e=0;e<7;e++){const t=new Date(Date.UTC(2e3,1,e,0,0,0));n.push(a.format(t))}return n}function c(e){const t=e.toLowerCase();return!!(t.includes("dd")||t.includes("mm")||t.includes("yy")||t.includes("aa")||t.includes("jj")||t.includes("rr")||t.includes("vv")||t.includes("")||t.includes(""))}},993821:(e,t,a)=>{"use strict";a.d(t,{FF:()=>l,dL:()=>s,gt:()=>c,pH:()=>d});var n,o=a(207545),r=a(795917),i=a(758651);function l(e){return null==e?void 0:e.TrustedBrokerDomain}function s(e){return function(e){if((0,r.d)(e))return e;if("string"!=typeof e)return;try{var t=JSON.parse(e);return(0,r.d)(t)?t:void 0}catch(e){return void i.error("Failed to parse BizChatHostContext:",e)}}(o.kH.getSetting(o.zj.BizChatHostContext,e))}function c(e,t){void 0===n&&d(s(),e,t);return n}function d(e,t,a){var o,i,l,s,c,d=null===(o=null==e?void 0:e.PrimaryUserAccountInfo)||void 0===o?void 0:o.CopilotExperience,u=null!==(c=null!==(l=null===(i=null==e?void 0:e.PrimaryUserAccountInfo)||void 0===i?void 0:i.AggregatedLicensedFeatures)&&void 0!==l?l:null===(s=null==e?void 0:e.PrimaryUserAccountInfo)||void 0===s?void 0:s.LicensedFeatures)&&void 0!==c?c:void 0,m=!a||(!!(null==u?void 0:u.includes("Copilot"))||!!(null==u?void 0:u.includes("CopilotStarter"))),h=t&&m;n=d===r.$.M365CopilotChat||d===r.$.Researcher||d===r.$.Analyst||d===r.$.DataShaping||!!h&&!d}},999963:(e,t,a)=>{"use strict";a.d(t,{i:()=>p,X:()=>v});var n=a(477595),o=a(477543),r=a(365319),i=a(630079),l=a(9847),s=a(797639),c=a(267324),d=a(46922),u=a(449650),m=a(805027),h=a(528804);async function g(e){return await Excel.run({delayForCellEdit:!0},(async t=>{const a=await async function(e){const t=e.workbook.getActiveCell();return t.load("address"),await e.sync(),t}(t),n=u.ExcelCalc.sheetAddressToExcelSheetRange(a.address);let o;if(-1===e.address.indexOf("!"))o=u.ExcelCalc.addressToExcelRange(e.address);else{o=u.ExcelCalc.sheetAddressToExcelSheetRange(e.address).range}if(e.sheetRange.sheet!==n.sheet)throw new Error((0,c.LNV)());const{firstRow:r,firstColumn:i,numRows:l,numColumns:s,targetColumn:g}=function(e,t,a){const n=100,o=50;let r=!0;const i=Math.min(n,a.numRows)+1,l=Math.min(o,a.numColumns);let s=t.topLeft.row;const c=t.topLeft.column;let d=t.bottomRight.row;const m=t.bottomRight.column;null==s&&null==d&&null!==c&&null!==m&&(s=0,d=a.numRows);let h=e.topLeft.row,g=e.topLeft.column;if(null==s||null==c||null==m||null==d||null==h||null==g)return{firstRow:0,firstColumn:0,numRows:0,numColumns:0};if(!u.ExcelCalc.IExcelRangeIntersect(u.ExcelCalc.getIExcelRangeTopLeftCell(e),t)){const e=function(e,t,a,n,o,r){const i=Math.abs(o-e),l=Math.abs(a-o),s=Math.abs(r-t),c=Math.abs(n-r);let d=o;i<l?d=e:l<i&&(d=a);let u=r;s<c?u=t:c<s&&(u=n);o>=e&&o<=a&&(d=o);r>=t&&r<=n&&(u=r);return{row:d,column:u}}(s,c,d,m,h,g);h=e.row,g=e.column,r=!1}let p=Math.max(h-Math.floor(i/2),s),b=p+i-1;b>d&&(b=d,p=b-i+1);let f=Math.max(g-Math.floor(l/2),c),C=f+l-1;C>m&&(C=m,f=C-l+1);return{firstRow:p,firstColumn:f,numRows:i,numColumns:l,targetColumn:r?g:void 0}}(n.range,o,e),p=t.workbook.worksheets.getActiveWorksheet().getRangeByIndexes(r,i,l,s);await async function(e,t){t.load("address"),t.load({address:!0,values:!0,numberFormatCategories:!0,numberFormat:!0,text:!0,rowIndex:!0,rowCount:!0,columnIndex:!0,columnCount:!0}),await e.sync()}(t,p);const b=function(e,t,a,n){const o={Name:e.name,Columns:[],TargetColumnId:void 0},r=t.text,i=t.values,l=t.numberFormatCategories,s=JSON.parse(e.headers),u=(0,h.yw9)("OfficeVSO_9637243_FixCFSuggestionsTLRHeaderCheck")?s.length>0:""!==e.headers;if(!u)throw new Error((0,c.LNV)());return i.forEach(((e,a)=>{e.forEach(((e,i)=>{const c=a+t.rowIndex,h=i+t.columnIndex;if(void 0===o.Columns[i]){const e=h-n;o.Columns[i]={HeaderName:u?s[e]:"",Values:[],Index:h}}else{const t=l[a][i],n=function(e,t,a,n,o){let r=function(e){switch(e){case"General":default:return d.v.General;case"Number":return d.v.Number;case"Text":return d.v.Text;case"Date":return d.v.Date;case"Time":return d.v.Time;case"Currency":return d.v.Currency;case"Accounting":return d.v.Accounting}}(a),i=e;if(isNaN(Number(e)))i=t;else if(r===d.v.Date||r===d.v.Time){const{date:a}=(0,m.f9)(e);e<1||isNaN(a.getDay())?(i=t,r=d.v.Text):i=a}return{Value:i,Style:{Bold:!1,Italic:!1,Underline:!1,Strikethrough:!1,FillColor:"",FontColor:""},Type:r,Row:n,Column:o}}(e,r[a][i],t,c,h);o.Columns[i].Values.push(n)}}))})),o.Columns.forEach(((e,t)=>{e.Index===a&&(o.TargetColumnId=t+1)})),o}(e,p,g,o.topLeft.column??0);return b}))}var p,b=a(495501),f=a(4091),C=a(722307),y=a(937234);!function(e){e.Chat="Chat",e.SuggestionPill="SuggestionPill"}(p||(p={}));const v=async(e,t,a,n)=>{if(0===e.length)return!1;for(const o of e)a(x(o,t,a,n));return!0},x=(e,t,a,n)=>async()=>{if("conditionalFormatSuggestion"!==e.func)throw new Error(`Unsupported function ${e.func} for Conditional Format Suggestion agent`);if(2!==e.args.length)throw new Error(`Incorrect number of parameters for ${e.func}`);const o=e.args[1],i=s.CP.getActiveTable();if(!i){const{message:e,telemetry:t}=b.n.getConditionalFormattingSuggestionsErrorResponse((0,c.LNV)(),l.q0.ClientError);return r.$.getInstance().displayResponse(e,t),void await S(o,y.Aw.failed,a)}await T(i,t,o,a,n),await S(o,y.Aw.success,a)},T=async(e,t,a,s,d)=>{try{const l=new n.u;l.guid=t,l.uiLocale=(0,C.Yd)(),l.outputLanguage=d,l.Table=await g(e);const c=new o.g0({parentPath:["Signal",n.u.getTypeName()],items:[{id:i.r.generateId(),body:l}]});r.$.getInstance().submitOperation({operation:c,workflowAnnotationType:n.b.getTypeName()}),await S(a,y.Aw.success,s)}catch(e){let t=(0,c.t_C)();e?.message===(0,c.LNV)()&&(t=e.message);const{message:n,telemetry:o}=b.n.getConditionalFormattingSuggestionsErrorResponse(t,l.q0.ClientError);r.$.getInstance().displayResponse(n,o),await S(a,y.Aw.failed,s),await s((0,f.L4)(!1))}},S=async(e,t,a)=>{if("Chat"!==e)return;const n=JSON.stringify({text:"ConditionalFormattingSuggestion",publishPreference:"Never"}),o={featureName:l.q.ConditionalFormattingSuggestion,eventType:l.a5.SuggestionMessage};await a((0,f.nv)(n,t,o))}}},__webpack_module_cache__={},deferred,leafPrototypes,getProto,inProgress,dataWebpackPrefix;function __webpack_require__(e){var t=__webpack_module_cache__[e];if(void 0!==t)return t.exports;var a=__webpack_module_cache__[e]={id:e,loaded:!1,exports:{}};return __webpack_modules__[e].call(a.exports,a,a.exports,__webpack_require__),a.loaded=!0,a.exports}__webpack_require__.m=__webpack_modules__,__webpack_require__.amdO={},deferred=[],__webpack_require__.O=(e,t,a,n)=>{if(!t){var o=1/0;for(s=0;s<deferred.length;s++){for(var[t,a,n]=deferred[s],r=!0,i=0;i<t.length;i++)(!1&n||o>=n)&&Object.keys(__webpack_require__.O).every((e=>__webpack_require__.O[e](t[i])))?t.splice(i--,1):(r=!1,n<o&&(o=n));if(r){deferred.splice(s--,1);var l=a();void 0!==l&&(e=l)}}return e}n=n||0;for(var s=deferred.length;s>0&&deferred[s-1][2]>n;s--)deferred[s]=deferred[s-1];deferred[s]=[t,a,n]},__webpack_require__.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return __webpack_require__.d(t,{a:t}),t},getProto=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var a=Object.create(null);__webpack_require__.r(a);var n={};leafPrototypes=leafPrototypes||[null,getProto({}),getProto([]),getProto(getProto)];for(var o=2&t&&e;"object"==typeof o&&!~leafPrototypes.indexOf(o);o=getProto(o))Object.getOwnPropertyNames(o).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,__webpack_require__.d(a,n),a},__webpack_require__.d=(e,t)=>{for(var a in t)__webpack_require__.o(t,a)&&!__webpack_require__.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},__webpack_require__.f={},__webpack_require__.e=(e,t)=>Promise.all(Object.keys(__webpack_require__.f).reduce(((a,n)=>(__webpack_require__.f[n](e,a,t),a)),[])),__webpack_require__.u=e=>(({0:"vendors~2","vendors-npm_store_sdx_officecopilot_1js-scc-react-streaming-renderer_6_5_119-49b79e688c42bcda-6e7345":"vendors~14","vendors-npm_store_sdx_officecopilot_1js-scc-service-ciq_5_5_543-ca8df83e87c35e172ae9_node_mod-80c080":"vendors~15","vendors-npm_store_sdx_officecopilot_1js-fai-react-copilot-chat_1_0_65-fe848b5168e6d33c88ea_no-7679ae":"vendors~17","vendors-npm_store_sdx_officecopilot_1js-fai-react-attachments_1_0_63-9b1cb461966f346470e5_nod-1da88d":"vendors~23","vendors-npm_store_sdx_officecopilot_1js-m365card-people-picker-persona_1_9_32-6a39c7e1cdf53e4-4e6023":"vendors~31","vendors-npm_store_sdx_officecopilot_showdown_2_1_0-c9b3b1d37b0ef403be6c_node_modules_showdown-2e0888":"vendors~121","vendors-npm_store_sdx_officecopilot_1js-fai-react-suggestions_1_0_68-dc3b3890a980f106fb42_nod-ab058f":"vendors~9","vendors-npm_store_sdx_officecopilot_embla-carousel-autoplay_8_5_1-532b4b7582d510648f16_node_m-ec3914":"vendors~19","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-chat_51_8_1-5cc36e23403172ec3f6b_node-2123cf":"vendors~22","vendors-npm_store_sdx_officecopilot_1js-copilot-entity-data_24_11_17-024154b255c9e6210c4c_nod-844a1c":"vendors~20","vendors-npm_store_sdx_officecopilot_1js-copilot-plugins-file_23_9_300-58926800602cf9963e0f_no-48665e":"vendors~126","vendors-npm_store_sdx_officecopilot_1js-copilot-plugins-event_30_2_46-52fcd6a811f0e928f997_no-3ff874":"vendors~29","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-voice-realtime_7_27_3-92b101252f1ac40-ef1228":"vendors~125","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-assistant_4_8_3-c5256f8f1e56f2a2f9e2_-99589f":"vendors~124","vendors-npm_store_sdx_officecopilot_1js-scc-service-voice-augloop_4_1_737-ea4a56b487da9a9bbd0-053c13":"vendors~33","vendors-npm_store_sdx_officecopilot_1js-scc-react-api-card-extensions_1_11_89-ad57d1fbe8b249e-084365":"vendors~129","vendors-npm_store_sdx_officecopilot_azure-msal-common_15_8_0-5ddec09c577d7d05edc7_node_module-52eaa3":"vendors~16","vendors-npm_store_sdx_officecopilot_azure-msal-common_14_16_1-a642071c9e14ebf745be_node_modul-ef38e2":"vendors~28","vendors-npm_store_sdx_officecopilot_1js-density-externals_9_11_43-968677182053f4739145_node_m-0ea162":"vendors~30","vendors-npm_store_sdx_officecopilot_1js-excel-copilot-calc_8_3_43-1adabd76bb06679768ec_node_m-dd2f81":"vendors~122","vendors-npm_store_sdx_officecopilot_typescript_5_0_4-007004e2f84938dc12ca_node_modules_typesc-351a83":"vendors~12","vendors-npm_store_sdx_officecopilot_office-script-synchronous_0_0_126-8c43e2bff2458e92cb38_no-9fc215":"vendors~24","vendors-npm_store_sdx_officecopilot_monaco-editor_0_46_0-51dbdf7e44e9cf33acc3_node_modules_mo-e5e20f":"vendors~123","vendors-npm_store_sdx_officecopilot_1js-scc-react-markdown-renderer_13_11_64-faee61981fbcc6b0-c150c9":"vendors~32","vendors-npm_store_sdx_officecopilot_mobx-react_7_6_0-b3d1e376fc41f8f7207f_node_modules_mobx-r-81b505":"vendors~21","npm_store_sdx_officecopilot_1js-m365-chat-editor-client_3_13_2-575384011449d2d54e02_node_modu-c084ac":"vendors~0","vendors-npm_store_sdx_officecopilot_1js-m365-chat-editor-client_3_13_2-575384011449d2d54e02_n-35e4f8":"vendors~128","npm_store_sdx_officecopilot_1js-m365-chat-editor-client_3_13_2-575384011449d2d54e02_node_modu-6f20a3":"vendors~1","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-2928b9":"vendors~120","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-dc4872":"vendors~119","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-bcab09":"vendors~118","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-10973f":"vendors~117","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-630705":"vendors~116","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-3eb1fa":"vendors~115","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-173ac6":"vendors~114","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-9a3f5e":"vendors~113","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-82e0dc":"vendors~112","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-c0e709":"vendors~111","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-eda3ed":"vendors~110","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-3ad338":"vendors~109","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-8c0af2":"vendors~108","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-7ea5d3":"vendors~107","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-960539":"vendors~106","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-fbe8c2":"vendors~105","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-04c210":"vendors~104","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-f1c46e":"vendors~103","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-94a1e9":"vendors~102","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-d7f3c2":"vendors~101","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-6bab32":"vendors~100","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-b6277b":"vendors~99","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-904525":"vendors~98","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-adc923":"vendors~97","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-efa945":"vendors~96","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-08ff60":"vendors~95","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-aedb25":"vendors~94","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-a8c262":"vendors~93","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-3eca67":"vendors~92","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-8cda5a":"vendors~91","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-60d7cd":"vendors~90","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-5d2c04":"vendors~89","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-24d34a":"vendors~88","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-2e1b21":"vendors~87","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-81bf95":"vendors~86","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-8d2e3e":"vendors~85","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-ca3b00":"vendors~84","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-342c4c":"vendors~83","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-394ce6":"vendors~82","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-f6e0e5":"vendors~81","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-97d2a7":"vendors~80","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-a60fe1":"vendors~79","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-3b7078":"vendors~78","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-262e92":"vendors~77","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-c65dfc":"vendors~76","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-c33872":"vendors~75","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-f9c430":"vendors~74","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-0f30d3":"vendors~73","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-4be0c7":"vendors~72","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-b6e301":"vendors~71","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-9235b7":"vendors~70","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-a6af7c":"vendors~69","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-78dd7d":"vendors~68","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-eaf20c":"vendors~67","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-7b60c2":"vendors~66","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-087c9f":"vendors~65","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-12f99e":"vendors~64","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-583a9b":"vendors~63","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-76cec5":"vendors~62","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-675db5":"vendors~61","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-d8a748":"vendors~60","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-9e6329":"vendors~59","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-69c517":"vendors~58","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-a9d075":"vendors~57","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-f0af65":"vendors~56","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-3c195f":"vendors~55","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-b75418":"vendors~54","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-0746ec":"vendors~53","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-1ec4eb":"vendors~52","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-2f8bcb":"vendors~51","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-f57efa":"vendors~50","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-0beee7":"vendors~49","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-3d51a5":"vendors~48","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-760166":"vendors~47","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-c6d901":"vendors~46","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-9e47c5":"vendors~45","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-e7473e":"vendors~44","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-bedbc5":"vendors~43","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-d5c592":"vendors~42","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-22b732":"vendors~41","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-bc1a92":"vendors~40","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-75e3d8":"vendors~39","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-82b839":"vendors~38","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-497f78":"vendors~37","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-6ec007":"vendors~36","vendors-npm_store_sdx_officecopilot_editor-strings-web_49_106_1-79504ed7ee9eddb5bfca_node_mod-5147a8":"vendors~35","npm_store_sdx_officecopilot_uuid_11_1_0-d5f35c39c5172d0e2dc3_node_modules_uuid_dist_esm-brows-2e0d9d":"vendors~3","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-inlinecreationhvc_5_1_377-68d95d7ae57-4d42c5":"vendors~25","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-podcast-ui_3_6_80-4e9b1685243fdfa3d24-43f77c":"vendors~127","vendors-npm_store_sdx_officecopilot_1js-scc-react-markdown-dialog_2_5_2-e0492bf3a480b697ecf5_-5e0264":"vendors~26","vendors-npm_store_sdx_officecopilot_microsoft-1ds-analytics-js_4_3_10-c04af46b54ae0b0c8d05_no-38c45a":"vendors~27"}[e]||e)+".js"),__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),inProgress={},dataWebpackPrefix="TypeScriptModule:",__webpack_require__.l=(e,t,a,n,o)=>{if(inProgress[e])inProgress[e].push(t);else{var r,i;if(void 0!==a)for(var l=document.getElementsByTagName("script"),s=0;s<l.length;s++){var c=l[s];if(c.getAttribute("src")==e||c.getAttribute("data-webpack")==dataWebpackPrefix+a){r=c;break}}r||(i=!0,(r=document.createElement("script")).charset="utf-8",r.timeout=120,__webpack_require__.nc&&r.setAttribute("nonce",__webpack_require__.nc),r.setAttribute("data-webpack",dataWebpackPrefix+a),o&&r.setAttribute("fetchpriority",o),r.src=e),inProgress[e]=[t];var d=(t,a)=>{r.onerror=r.onload=null,clearTimeout(u);var n=inProgress[e];if(delete inProgress[e],r.parentNode&&r.parentNode.removeChild(r),n&&n.forEach((e=>e(a))),t)return t(a)},u=setTimeout(d.bind(null,void 0,{type:"timeout",target:r}),12e4);r.onerror=d.bind(null,r.onerror),r.onload=d.bind(null,r.onload),i&&document.head.appendChild(r)}},__webpack_require__.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),__webpack_require__.j="appchat",(()=>{var e;__webpack_require__.g.importScripts&&(e=__webpack_require__.g.location+"");var t=__webpack_require__.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var a=t.getElementsByTagName("script");if(a.length)for(var n=a.length-1;n>-1&&(!e||!/^http(s?):/.test(e));)e=a[n--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),__webpack_require__.p=e})(),(()=>{__webpack_require__.b=document.baseURI||self.location.href;var e={appchat:0,"appchat-lazy":0,"default~appchat-lazy~excelagentexperimental-lazy":0,taskpane:0,"vendors-npm_store_sdx_officecopilot_react-dom_17_0_2-4995b43301c5c55b1aab_node_modules_react--9b0fa7":0};__webpack_require__.f.j=(t,a,n)=>{var o=__webpack_require__.o(e,t)?e[t]:void 0;if(0!==o)if(o)a.push(o[2]);else{var r=new Promise(((a,n)=>o=e[t]=[a,n]));a.push(o[2]=r);var i=__webpack_require__.p+__webpack_require__.u(t),l=new Error;__webpack_require__.l(i,(a=>{if(__webpack_require__.o(e,t)&&(0!==(o=e[t])&&(e[t]=void 0),o)){var n=a&&("load"===a.type?"missing":a.type),r=a&&a.target&&a.target.src;l.message="Loading chunk "+t+" failed.\n("+n+": "+r+")",l.name="ChunkLoadError",l.type=n,l.request=r,o[1](l)}}),"chunk-"+t,t,n)}},__webpack_require__.O.j=t=>0===e[t];var t=(t,a)=>{var n,o,[r,i,l]=a,s=0;if(r.some((t=>0!==e[t]))){for(n in i)__webpack_require__.o(i,n)&&(__webpack_require__.m[n]=i[n]);if(l)var c=l(__webpack_require__)}for(t&&t(a);s<r.length;s++)o=r[s],__webpack_require__.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return __webpack_require__.O(c)},a=self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))})(),__webpack_require__.nc=void 0,__webpack_require__.O(void 0,["chunk1jsfluent","chatcore","augloop-chunk","office-iss","vendors-npm_store_sdx_officecopilot_parse5_6_0_1-6346061a9d49819048e1_node_modules_parse5_lib-b0e687","vendors-npm_store_sdx_officecopilot_inherits_2_0_4-811c5d3b9f8b99c1e7a4_node_modules_inherits-c2e038","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-utils_5_5_3-80056aa94553011f54c1_node-37a59a","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-biz-native-utils_1_10_15-c70c59a66d40-e4c1b7","vendors-npm_store_sdx_officecopilot_1js-guid_5_1_57-3f65ea288655a83a438a_node_modules_1js_gui-62b04a","vendors-npm_store_sdx_officecopilot_hoist-non-react-statics_3_3_2-2c5f76ff0fb3eca13720_node_m-889939","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-chat_51_8_1-5cc36e23403172ec3f6b_node-69544b","vendors-npm_store_sdx_officecopilot_1js-m365card-runtime-types_16_0_16-11280aee659226d5e733_n-e3bdce"],(()=>__webpack_require__(653012)));var __webpack_exports__=__webpack_require__.O(void 0,["chunk1jsfluent","chatcore","augloop-chunk","office-iss","vendors-npm_store_sdx_officecopilot_parse5_6_0_1-6346061a9d49819048e1_node_modules_parse5_lib-b0e687","vendors-npm_store_sdx_officecopilot_inherits_2_0_4-811c5d3b9f8b99c1e7a4_node_modules_inherits-c2e038","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-utils_5_5_3-80056aa94553011f54c1_node-37a59a","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-biz-native-utils_1_10_15-c70c59a66d40-e4c1b7","vendors-npm_store_sdx_officecopilot_1js-guid_5_1_57-3f65ea288655a83a438a_node_modules_1js_gui-62b04a","vendors-npm_store_sdx_officecopilot_hoist-non-react-statics_3_3_2-2c5f76ff0fb3eca13720_node_m-889939","vendors-npm_store_sdx_officecopilot_1js-officeaicopilot-chat_51_8_1-5cc36e23403172ec3f6b_node-69544b","vendors-npm_store_sdx_officecopilot_1js-m365card-runtime-types_16_0_16-11280aee659226d5e733_n-e3bdce"],(()=>__webpack_require__(233488)));__webpack_exports__=__webpack_require__.O(__webpack_exports__),TypeScriptModule=__webpack_exports__})();
//# sourceMappingURL=appchat.js.map