"use strict";(self.webpackChunkTypeScriptModule=self.webpackChunkTypeScriptModule||[]).push([["editor"],{944:(e,t,i)=>{i.d(t,{L:()=>b});var n=i(252723),s=i(108520),o=i(756857),r=i(184226),a=i(465701),l=i(323283),d=i(163573),c=i(150099),u=i(811861),g=i(77127),h=i(343154),p=i(564333),m=i(281769),f=i(287587);const v=(e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let i=e.parentElement,n=window.getComputedStyle(i);for(;i&&"relative"!==n.position&&i!==document.body;)i=i.parentElement,n=window.getComputedStyle(i);return i},y=()=>!0;var _=i(377253),I=i(208520),C=i(252843);const S=(0,n.F5)({predictionStateStore:s.A.on(u.Tc),localizer:s.A.on(o.H),themeStore:s.A.on(g.YQ).optional(),hostSettings:s.A.on(d.n),languageScriptDirectionDetector:s.A.on(r.iw),safeWindow:s.A.on(c.j),isMobile:s.A.on(a.n).optional()}),b=I.memo((e=>{var t;const{prediction:i,predictionDisplayText:s,targetLocation:o,onApplyCurrentPrediction:r,onClearCurrentPrediction:a,isInputPointerAtPrediction:d,onCurrentPredictionMayOverlapNextLine:c,onEntityDropdownOpened:g,predictionContentEditableParentElement:b,predictionParentElement:T}=e,{hostSettings:E,isMobile:N,languageScriptDirectionDetector:w,localizer:x,predictionStateStore:L,themeStore:D,safeWindow:A}=(0,n.KN)(S),F=I.useRef(null),q=I.useRef(null),R=I.useRef(),P=I.useRef({top:0,left:0}),[O,k]=I.useState({zIndex:"auto",element:void 0,shouldRender:()=>!0,shouldRenderPrediction:()=>!0,shouldObserveSize:()=>[],addHandlers:()=>()=>null,predictionInlineStyles:()=>{},transformPredictionRects:e=>e,getForbiddenRects:()=>[]}),[M,z]=I.useState(!1),[j,W]=I.useState({container:{},overlay:{},anchorStyle:{position:"static"}}),B=Object.assign(Object.assign({},j.overlay),{zIndex:null!==(t=O.zIndex)&&void 0!==t?t:j.overlay.zIndex}),U=I.useCallback((()=>{const e=b.scrollLeft,t=b.scrollTop;F.current&&(F.current.scrollLeft=e,F.current.scrollTop=t)}),[b.scrollLeft,b.scrollTop]),H=I.useCallback((e=>A.requestAnimationFrame(e)),[A]),V=I.useCallback((()=>{const e=(0,m.dB)(b,q.current,P),t=(0,m.Cf)(b);P.current={top:e.top,left:e.left},W((()=>(U(),z(!0),{container:e,overlay:t.overlay,anchorStyle:t.anchor})))}),[b,U]),G=I.useCallback((()=>{H(V)}),[H,V]),Q=()=>(setTimeout((()=>{G(),b.dispatchEvent(new Event("BX-ForceReflow",{bubbles:!0}))}),500),!0),K=()=>{H(U)},$=async e=>{h.x.isKey(e,p.m.tab)?(e.stopPropagation(),e.preventDefault(),await r(e.keyCode)):h.x.isKey(e,[p.m.arrowLeft,p.m.arrowUp,p.m.arrowRight,p.m.arrowDown,p.m.enter,p.m.escape])&&await a("invalid key press",u.R8.ExplicitRejection)},J=async e=>{e.preventDefault(),e.stopPropagation(),N&&await r(u.XG)},Z=()=>{setTimeout((async()=>{L.multiPredictionMenuOpen||await a("lost focus",u.R8.ImplicitRejection)}),100)},Y=()=>{A.requestIdleCallback((async()=>{await X()}),100)},X=async()=>{await d()||await a("input pointer not at prediction",u.R8.ImplicitRejection)};I.useEffect((()=>{G()}),[G]),I.useEffect((()=>{k(((e,t,i=!0)=>{var n;const s=y,o=y,r=()=>[],a=()=>()=>null,l=()=>{},d=e=>e,c=()=>[];return"body"!==e.tagName.toLowerCase()&&e.parentElement?{element:i?v(e,t):e.parentElement,zIndex:void 0,shouldRender:s,shouldRenderPrediction:o,shouldObserveSize:r,addHandlers:a,predictionInlineStyles:l,transformPredictionRects:d,getForbiddenRects:c}:{element:null!==(n=e.parentElement)&&void 0!==n?n:window.document.body,zIndex:"auto",shouldRender:s,shouldRenderPrediction:o,shouldObserveSize:r,addHandlers:a,predictionInlineStyles:l,transformPredictionRects:d,getForbiddenRects:c}})(b,j.anchorStyle.position))}),[j.anchorStyle.position,b]),I.useEffect((()=>{const e={passive:!0,capture:!0},t=new l.J(window),i=new l.J(document),n=new l.J(b);t.addListener("resize",G,e),t.addListener("hashchange",Q,e),t.addListener("popstate",Q,e),i.addListener("mouseup",Q,e),i.addListener("selectionchange",Y,e),n.addListener("paste",Q,e),n.addListener("scroll",K,e),n.addListener("keydown",$),n.addListener("focusout",Z,e),(()=>{if(!R.current&&window.ResizeObserver&&(Q(),R.current=new window.ResizeObserver((()=>{G()}))),R.current){R.current.observe(b);for(const e of O.shouldObserveSize(b))R.current.observe(e)}})();const s=O.addHandlers(b,{queueUpdateOverlay:G,updateOverlayAndNotifyInput:Q});return()=>{t.removeAllListeners(),i.removeAllListeners(),n.removeAllListeners(),R.current&&R.current.disconnect(),s()}}),[]),I.useEffect((()=>{if(!q.current)return;const e=new l.J(q.current);return e.addListener("mousedown",J),()=>{e.removeAllListeners()}}),[q,J]);const ee=I.useCallback((async e=>{await c(e)}),[c]),te=I.useCallback((e=>{g(e)}),[g]),ie=window.getComputedStyle(b),ne=parseInt(ie.paddingLeft,10),se=parseInt(ie.paddingTop,10),oe=(o.x,o.y-se);return O.element?I.createElement(C.Ay.div,{className:"ms-editor-text-prediction"},I.createElement(f.J,{hostSettings:E,themeStore:D}),I.createElement("div",{ref:q,style:j.container},I.createElement("div",{id:"ms-editor-text-prediction-overlay",style:B,className:"hc-noadjust"},I.createElement("div",{style:{paddingTop:oe+"px"}}),M&&(0,_.r)(x,null!=N&&N,w,i,s,T,te,ee,ne)))):null}))},1144:(e,t,i)=>{i.d(t,{f:()=>l,l:()=>d});var n=i(379490),s=i(852748),o=i(83010),r=i(538045),a=i(553164);let l=class{constructor(e,t,i,n){this._guidGenerator=e,this._proofingDom=t,this.eventSeqId=0,this.nodeType=a.Z.ParagraphNode,this.id=this._guidGenerator.generate(),this.children=void 0,this.element=i,this.parent=n,this._proofingDom.registerNode(this)}retire(){this.parent=void 0,this._proofingDom.unregisterNode(this)}move(e,t){return this._proofingDom.unregisterNode(this),e&&(this.element=e),t&&(this.parent=t),this.id=this._guidGenerator.generate(),this._proofingDom.registerNode(this),this}resetState(){}};function d(e){var t;return(null==e?void 0:e.nodeType)===a.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element&&(null===(t=e.parent)||void 0===t?void 0:t.nodeType)===a.Z.TileNode&&!!e.parent.element&&!!e.parent.children}l=(0,n.__decorate)([(0,n.__param)(0,(0,o.W)(s.G)),(0,n.__param)(1,(0,o.W)(r.w))],l)},1543:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Ortografija"}}')},2111:(e,t,i)=>{if(i.d(t,{X:()=>r}),0!=i.j)var n=i(576516);if(0!=i.j)var s=i(614313);if(0!=i.j)var o=i(696767);function r(e,t){const i=(0,o.$)().getStringsFor("InlineSuggestionStrings");switch(e){case n.c.File:return i("fileEntityLabel");case n.c.People:return i("peopleEntityLabel");case n.c.Loop:return i("loopsEntityLabel");case n.c.Topic:return i("topicsEntityLabel");case n.c.External:return i("externalEntityLabel");case n.c.MessageExtensionApp:return i("appEntityLabel");case n.c.Scope:return i("scopeEntityLabel");case n.c.Event:return i("eventEntityLabel");case n.c.Channel:return i("channelEntityLabel");case n.c.Chat:return i("chatEntityLabel");case n.c.Team:return i("teamEntityLabel");case n.c.Message:return i("emailEntityLabel");case n.c.PIM:return t===s.Nm.Address?i("addressEntityLabel"):t===s.Nm.Membership?i("membershipEntityLabel"):i("phoneEntityLabel");default:return e}}},7325:(e,t,i)=>{i.d(t,{v:()=>d});var n=i(379490),s=i(496814),o=i(226331),r=i(904196),a=i(229906),l=i(83010);let d=class{constructor(e,t){this._proofingStore=e,this._hostSettings=t}async buildDescriptors(){var e;const t="FlightIds";let i;try{i=JSON.parse(await this._proofingStore.read(s.l.Descriptors))}catch(e){i=JSON.parse(this._proofingStore.getDefaultValue(s.l.Descriptors))}let n="";if(this._hostSettings.flightsToTrack&&this._hostSettings.flightsToTrack.length>0&&(n=`${n}${this._hostSettings.flightsToTrack.join(";")}`),""!==n){const e=i.find((e=>e.name===t));e?e.value=`${e.value};${n}`:i.push({name:t,value:n})}return(null===(e=this._hostSettings.hostMetadata)||void 0===e?void 0:e.releaseAudienceGroup)&&i.push({name:"Audience",value:c(this._hostSettings.hostMetadata.releaseAudienceGroup)}),i}};function c(e){switch(e){case"Local":case"Staging":case"Dogfood":case"DogFood":return"DogFood";case"Microsoft":return"Microsoft";default:return"Production"}}d=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(o.K)),(0,n.__param)(1,(0,l.W)(r.n))],d)},10075:(e,t,i)=>{i.d(t,{o:()=>c});var n=i(379490),s=i(83605),o=i(538045),r=i(229906),a=i(83010),l=i(427603),d=i(1144);let c=class{constructor(e,t){this._proofingDom=e,this._tileNodeTraverser=t}getParagraphText(e){let t=null;if(t="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,d.l)(t)){const e=t.parent.plainText,i=t.element.offset,n=t.element.span,s=t.element.span?i+n:void 0;return e.substring(i,s).replace(/\u00A0/g," ")}}getQueryString(e,t,i){const n=this.getParagraphText(e);if(!n)return 0===t.start&&0===t.length&&""===t.prefix?"":void 0;return n.substring(t.start+(i?0:void 0===t.prefix?1:t.prefix.length),t.start+t.length)}getTextBetween(e,t,i=0,n=-1){var s;let o=null;o="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let r=null;if(r="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,d.l)(o)&&(0,d.l)(r)){if(o.parent.element===r.parent.element)return this.getSubsetOfParagraph(o.parent,o.element.offset+i,r.element.offset+(-1===n?r.element.span:n));{let e,t=this.getSubsetOfParagraph(o.parent,o.element.offset+i,void 0)+"\n",a=o.parent;do{if(e=null===(s=this._tileNodeTraverser)||void 0===s?void 0:s.findNextTileNode(a),!e||"#tail#"===e)return;a=e,t+=this.getSubsetOfParagraph(a,0,a.id===r.parent.id?r.element.offset+(-1===n?r.element.span:n):void 0)+(a.id===r.parent.id?"":"\n")}while(a.id!==r.parent.id);return t}}}getSubsetOfParagraph(e,t,i){return e.plainText.substring(t,i).replace(/\u00A0/g," ")}};c=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.w)),(0,n.__param)(1,(0,a.W)(s.M)),(0,n.__param)(1,(0,l.l)())],c)},10996:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Mopeleto"}}')},11353:(e,t,i)=>{i.d(t,{K:()=>s,g:()=>n});const n={defaultScope:"Singleton",skipBaseClassChecks:!0};class s{constructor(e){this.container=e}bind(e){return new o(this,this.container.bind(e))}rebind(e){return new o(this,this.container.rebind(e))}unbind(e){try{return this.container.unbind(e),!0}catch(e){return!1}}get(e){return this.container.get(e)}getOptional(e){return this.container.isBound(e)?this.container.get(e):void 0}getAll(e){return this.container.isBound(e)?this.container.getAll(e):[]}isBound(e){return this.container.isBound(e)}createChildContainer(){return new s(this.container.createChild(n))}unbindAll(){this.container.unbindAll()}resolveNew(e){return this.container.resolve(e)}getBindings(){const e=(t=this.container,t._bindingDictionary).getMap();var t;const i=[];for(const[t,n]of e)i.push({token:t,boundServices:n});return i}}class o{constructor(e,t){this.container=e,this.bindingTo=t}to(e){this.bindingTo.to(e)}toSelf(){this.bindingTo.toSelf()}toValue(e){this.bindingTo.toConstantValue(e)}toDynamicValue(e){this.bindingTo.toDynamicValue((()=>e(this.container)))}toFactory(e){this.bindingTo.toFactory((()=>e(this.container)))}toExisting(e){this.bindingTo.toService(e)}toTransient(e){this.bindingTo.to(e).inTransientScope()}}},11653:(e,t,i)=>{if(i.d(t,{$:()=>p}),0!=i.j)var n=i(379490);var s=i(208520);if(0!=i.j)var o=i(897578);if(0!=i.j)var r=i(288296);if(0!=i.j)var a=i(93659);if(0!=i.j)var l=i(318391);if(0!=i.j)var d=i(896761);if(0!=i.j)var c=i(343154);if(0!=i.j)var u=i(564333);var g=i(77127);if(0!=i.j)var h=i(62876);const p=e=>{var t,i,p,m,f,v,y,_,I,C,S,b,T,E,N,w,x;const L=s.useContext(g.O1),D=s.useContext(h.b),{maxHeightCallback:A,targetLocation:F,isMobile:q}=e,{isLoading:R,isFlightEnabled:P,onDismissed:O,onFirstRender:k,onPreventDismissOnEvent:M,onRenderResults:z,onRestoreFocus:j,style:W,styles:B,theme:U}=e.calloutProps;let H=!0;const[V,G]=s.useState(!0);s.useEffect((()=>{k()}),[k]),s.useEffect((()=>{R||z()}),[R,z]);const Q=s.useCallback((e=>{e&&"key"in e&&c.x.isKey(e,u.m.escape)&&(e.preventDefault(),e.stopPropagation()),e&&"focus"===e.type&&(H=!1),O(!1)}),[O]),K=s.useCallback((e=>{if(!H)return;j(e,(()=>{var t;null===(t=e.originalElement)||void 0===t||t.focus()}))}),[j,H]),$=B||{},{calloutStyles:J}=$,Z=(0,n.__rest)($,["calloutStyles"]),Y=Z.containerStyles||{},X=P("mc-editor-expanded-ecc-responsive"),ee=null!==(m=null!==(i=null===(t=null==B?void 0:B.calloutStyles)||void 0===t?void 0:t.borderRadius)&&void 0!==i?i:null===(p=null==U?void 0:U.callout)||void 0===p?void 0:p.borderRadius)&&void 0!==m?m:D?12:8;if(!e.targetLocation)return null;const te=null==A?void 0:A(e.targetLocation,null!==(f=e.targetWindow.deref())&&void 0!==f?f:window),ie=null===(v=e.directionalHintCallback)||void 0===v?void 0:v.call(e,e.targetLocation,null!==(y=e.targetWindow.deref())&&void 0!==y?y:window,te);let ne,se="absolute";if(q&&(se="fixed",ne=!0),L){const t=X?{borderRadius:ee,width:"fit-content"}:Object.assign({borderRadius:ee,width:null===(T=null==U?void 0:U.callout)||void 0===T?void 0:T.width},J),i={moveFocusIntoModalizer:!0,popover:{unstable_disableAutoFocus:!0,trapFocus:!1,withArrow:null!==(N=null===(E=null==U?void 0:U.callout)||void 0===E?void 0:E.isBeakVisible)&&void 0!==N&&N,open:V,onOpenChange:(e,t)=>{!t.open&&(null==M?void 0:M(e))||(G(t.open),t.open||Q())},positioning:Object.assign(Object.assign({},(0,a.Sg)(ie)),{target:(0,a.ug)(F),strategy:se,autoSize:ne})},surface:{className:"ms-ecc-callout",style:Object.assign({padding:0,maxWidth:480,maxHeight:te,overflow:"hidden",border:null===(w=null==U?void 0:U.callout)||void 0===w?void 0:w.border,boxShadow:null===(x=null==U?void 0:U.callout)||void 0===x?void 0:x.shadow},t)}};return s.createElement(l.v,Object.assign({},i),s.createElement(d.V,{calloutProps:e.calloutProps,themeType:e.currentThemeType,fluentV9Theme:e.fluentV9Theme,isRtl:e.isRtl,styles:(null==W?void 0:W.fitToContent)||Y.maxHeight?Object.assign(Object.assign({},Z),{containerStyles:Object.assign(Object.assign({},Y),{maxHeight:te})}):Z}))}return s.createElement(o.U,{className:"ms-ecc-callout",target:(0,r.K)(F),shouldDismissOnWindowFocus:!1,onDismiss:Q,preventDismissOnEvent:M,gapSpace:0,doNotLayer:!1,isBeakVisible:null!==(I=null===(_=null==U?void 0:U.callout)||void 0===_?void 0:_.isBeakVisible)&&void 0!==I&&I,directionalHint:ie,alignTargetEdge:!0,onRestoreFocus:K,calloutMaxHeight:te,style:X?{borderRadius:ee,width:"fit-content"}:Object.assign({borderRadius:ee,width:null===(C=null==U?void 0:U.callout)||void 0===C?void 0:C.width},J),styles:{beakCurtain:{borderRadius:ee},calloutMain:{overflow:"hidden",border:null===(S=null==U?void 0:U.callout)||void 0===S?void 0:S.border,borderRadius:ee,boxShadow:null===(b=null==U?void 0:U.callout)||void 0===b?void 0:b.shadow},root:{borderRadius:ee,width:"fit-content",maxHeight:"none !important"}}},s.createElement(o.d.Consumer,null,(t=>s.createElement(d.V,{calloutProps:e.calloutProps,isRtl:e.isRtl,styles:(null==W?void 0:W.fitToContent)||Y.maxHeight?Object.assign(Object.assign({},Z),{containerStyles:Object.assign(Object.assign({},Y),{maxHeight:te})}):Z,themeType:e.currentThemeType,layerHostId:t}))))}},12870:(e,t,i)=>{i.d(t,{U:()=>g,n:()=>h});var n=i(379490),s=i(331408),o=i(163573),r=i(756857),a=i(668952),l=i(229906),d=i(83010),c=i(669332),u=i(745107);const g=(0,a.f)("ISquiggleTooltipMessageBuilder");let h=class{constructor(e,t){this.localizer=e,this.hostSettings=t,this.getTitleCritique=(e,t,i)=>{switch(e){case s.bx.Low:return t===s.L9.TopicSuggestion?this.localizer.getMessage("ebx_SquiggleTooltipTopicTitle"):this.localizer.getMessage("ebx_SquiggleTooltipRefinementTitle");case s.bx.Medium:return this.localizer.getMessage("ebx_SquiggleTooltipGrammarTitle");case s.bx.High:return this.localizer.getMessage("ebx_SquiggleTooltipSpellingTitle");case s.bx.Informational:return null!=i?i:""}},this.getTitleAutocorrect=()=>this.localizer.getMessage("ebx_SquiggleTooltipAutoCorrectTitle")}getInteractionExplanationText(e){if((0,c.k)(e))return this.localizer.getMessage("ebx_AutoCorrectTooltipText");{const e=(0,u.i)()?this.localizer.getMessage("ebx_SquiggleTooltipCombinationMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipCombinationAlt":"ebx_SquiggleTooltipCombination");return`${this.localizer.getMessage("ebx_SquiggleTooltipText")} ${e}`}}getInteractionExplanationAriaLabel(e){return(0,c.k)(e)?this.localizer.getMessage("ebx_AutocorrectTooltipAriaText"):(0,u.i)()?this.localizer.getMessage("ebx_SquiggleTooltipAriaTextMac"):this.localizer.getMessage(this.hostSettings.useAlternativeSquiggleHotkey?"ebx_SquiggleTooltipAriaTextAlt":"ebx_SquiggleTooltipAriaText")}combineSentences(e,t){return this.localizer.getMessage("combineSentences",[e,t])}getTooltipTitle(e,t,i,n){return(0,c.k)(t)?this.getTitleAutocorrect():this.getTitleCritique(e,i,n)}};h=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(r.H)),(0,n.__param)(1,(0,d.W)(o.n))],h)},13251:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true}}')},15142:(e,t,i)=>{i.d(t,{V:()=>_});var n=i(379490),s=i(630501),o=i(920117),r=i(825948),a=i(163573),l=i(184226),d=i(355495),c=i(39183),u=i(240874),g=i(615930),h=i(118673),p=i(419728),m=i(229906),f=i(83010),v=i(427603),y=i(637224);let _=class extends s.z{get uxLanguageDir(){return this.hostSettings.manageRtlInEditorUx?this._uxLanguageDir:l.K3.auto}get optionsUxLanguageDir(){return this._uxLanguageDir}constructor(e,t,i,n,s,r){super(),this.languageInfoProvider=e,this.languageDetector=t,this.proofingStore=i,this.hostSettings=n,this.targetRenderElement=s,this.emitter=r,this._proofingLanguageDirCache={},this._defaultProofingLanguageDir=l.K3.auto,this._uxLanguageDir=l.K3.auto,this.updateProofingLanguageDir=e=>{this._defaultProofingLanguageDir=this.getLanguageDir(e)},this.updateUxLanguageDir=()=>{const e=this.languageDetector.getUILanguage();this._uxLanguageDir=this.getLanguageDir(e),this.publishEvent("stateUpdated",{uxLanguageDir:this.uxLanguageDir,optionsUxLanguageDir:this.optionsUxLanguageDir})},this.getLanguageDir=e=>{const t=this.languageInfoProvider.getLanguageInfo(e);return t?t.isRtl?l.K3.rtl:l.K3.ltr:l.K3.auto},(0,y.Gn)(this),this.updateUxLanguageDir(),this.proofingStore.read(o.l.ProofingLanguages).then((e=>this.updateProofingLanguageDir(d.z.getDefaultLanguageCode(e)))).catch((()=>{})),this.emitter&&this.emitter.on("proofingLanguageChanged",(async e=>{e.proofingLanguagesChanged&&this.updateProofingLanguageDir(e.data.defaultLanguageCode)}))}isRtl(){var e,t;if(this.uxLanguageDir!==l.K3.auto)return this.uxLanguageDir===l.K3.rtl;const i=null===(e=this.targetRenderElement())||void 0===e?void 0:e.deref();return void 0!==i&&(null!==(t=i.ownerDocument.defaultView)&&void 0!==t?t:window).getComputedStyle(i).direction===l.K3.rtl}dir(){return this.isRtl()?"rtl":"ltr"}getProofingLanguageDir(e){if(!this.hostSettings.manageRtlForProofingLanguage)return l.K3.auto;if(!e)return this._defaultProofingLanguageDir;let t=this._proofingLanguageDirCache[e];return t||(t=this.getLanguageDir(e),this._proofingLanguageDirCache[e]=t),t}};(0,n.__decorate)([p.observable],_.prototype,"_uxLanguageDir",void 0),(0,n.__decorate)([p.computed],_.prototype,"uxLanguageDir",null),(0,n.__decorate)([p.action],_.prototype,"updateProofingLanguageDir",void 0),(0,n.__decorate)([p.action],_.prototype,"updateUxLanguageDir",void 0),_=(0,n.__decorate)([(0,m._)(),(0,n.__param)(0,(0,f.W)(c.d)),(0,n.__param)(1,(0,f.W)(u.v)),(0,n.__param)(2,(0,f.W)(r.K)),(0,n.__param)(3,(0,f.W)(a.n)),(0,n.__param)(4,(0,f.W)(g.oA)),(0,n.__param)(5,(0,v.l)()),(0,n.__param)(5,(0,f.W)(h.o))],_)},17384:(e,t,i)=>{i.d(t,{$:()=>n});const n=(0,i(668952).f)("IStyleDefinitions")},18233:(e,t,i)=>{i.d(t,{c:()=>n});const n=(0,i(668952).f)("IFeatureFlagsReader")},18926:(e,t,i)=>{i.d(t,{b:()=>n});const n=(0,i(668952).f)("IPreOrderTraverser")},19061:(e,t,i)=>{i.r(t),i.d(t,{mockInlineSuggestions:()=>o});var n=i(576516),s=i(100966);const o=[{entities:[{entityType:n.c.People,Id:"0",text:"Annie Reid",EmailAddresses:["areid@microsoft.com"],confidence:0},{entityType:n.c.People,Id:"0",text:"Ed Taylor",EmailAddresses:["et@microsoft.com"],confidence:0},{entityType:n.c.People,Id:"0",text:"Clippy",EmailAddresses:["clippy@microsoft.com"],confidence:0}],entityType:n.c.People},{entities:[{entityType:n.c.File,Id:"0",FileSourceType:"Unknown",text:"Feature Spec",FileName:"Feature Spec",FileExtension:"Docx",FileSize:1e3,AccessUrl:"mockFile.gg/FeatureSpec",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:n.c.File,Id:"1",FileSourceType:"Unknown",text:"Planning Deck",FileName:"Planning Deck",FileExtension:"pptx",FileSize:1e3,AccessUrl:"mockFile.gg/PlanningDeck",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",isBestMatch:!0,confidence:0},{entityType:n.c.File,Id:"2",FileSourceType:"Unknown",text:"Crunched Numbers",FileName:"Crunched Numbers",FileExtension:"xls",FileSize:1e3,AccessUrl:"mockFile.gg/CrunchedNumbers",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:n.c.File,Id:"3",FileSourceType:"Unknown",text:"Some Contract with a very very long name",FileName:"Some Contract with a very very long name",FileExtension:"pdf",FileSize:1e3,AccessUrl:"mockFile.gg/contract",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0},{entityType:n.c.File,Id:"4",FileSourceType:"Unknown",text:"Even more files",FileName:"Even more files",FileExtension:"txt",FileSize:1e3,AccessUrl:"mockFile.gg/txt",DateAccessed:"2020-07-20T00:00:00.000Z",DateModified:"2020-07-20T00:00:00.000Z",DateCreated:"",confidence:0}],entityType:n.c.File},{entities:[{ContentDomainName:"People",ScopeTitle:"Insert People",ScopeDescription:"Search people in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",entityType:n.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.1",text:"Insert People",scopeInfo:{entityType:"People",contentSource:""},confidence:0},{ContentDomainName:"Files",ScopeTitle:"Insert Files",ScopeDescription:"Search files in your organization",ReferenceId:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",entityType:n.c.Scope,Id:"92175cf8-f00e-b976-ed00-d6805e7146d9.8000.2",text:"Insert Files",scopeInfo:{entityType:"File",contentSource:""},confidence:0},{ItemId:"Ci7lEZX87y1MfPYPsAnbHw",Title:"FL Desktop 2.0",Url:"https://www.figma.com/file/Ci7lEZX87y1MfPYPsAnbHw",IconUrl:"https://figmaconnector.blob.core.windows.net/assets/icons/figma-logo.svg",ContentDomainId:"nonEssFigmaConnector",Authors:[],LastModifiedDateTimeUtc:"2022-04-26T03:57:42",CreatedTimeUtc:"2022-04-26T03:57:42",Text:"FL Desktop 2.0",PropertyHits:[],ReferenceId:"e60f6f30-9164-8d5e-7451-1da86e66df64.7000.22",entityType:n.c.External,Id:"Ci7lEZX87y1MfPYPsAnbHw",text:"FL Desktop 2.0",confidence:0}],entityType:n.c.Scope},{entities:[{entityType:n.c.Loop,Id:"0",text:"Action Items",icon:{iconName:"FFXCCompleted"},confidence:0},{entityType:n.c.Loop,Id:"0",text:"Bulleted List",icon:{iconName:"FFXCBulletedList"},confidence:0},{entityType:n.c.Loop,Id:"0",text:"Checklist",icon:{iconName:"FFXCChecklist"},confidence:0}],entityType:n.c.Loop},{entities:[{entityType:n.c.MessageExtensionApp,AppId:"ExcelOnline",DisplayName:"Excel",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.1",Id:"ExcelOnline",text:"Excel",confidence:0},{entityType:n.c.MessageExtensionApp,AppId:"f12466e6-a66c-495f-86f5-135938125391",DisplayName:"Azure DevOps (Internal)",ReferenceId:"31385e54-3f90-7623-1903-3585cfb212ac.4000.2",Id:"f12466e6-a66c-495f-86f5-135938125391",text:"Azure DevOps (Internal)",confidence:0}],entityType:n.c.MessageExtensionApp},{entityType:n.c.Event,entities:[{entityType:n.c.Event,confidence:1,text:"Multiday meeting",EventId:{Id:"id1"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",HasRecording:!0,isBestMatch:!0},{entityType:n.c.Event,confidence:1,text:"Sameday meeting",EventId:{Id:"id2"},Start:"2023-05-12T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",isBestMatch:!0},{entityType:n.c.Event,confidence:1,text:"Multiday all day meeting",EventId:{Id:"id3"},Start:"2023-05-08T21:05:00.000Z",End:"2023-05-12T22:00:00.000Z",IsAllDay:!0}]},{entityType:n.c.Message,entities:[{entityType:n.c.Message,confidence:1,text:"Error while running Local IIS",Subject:"Error while running Local IIS",From:{EmailAddress:{Name:"John Doe"}},ItemId:{Id:"id1"}},{entityType:n.c.Message,confidence:1,text:"RE: Enable console logging question",Subject:"RE: Enable console logging question",From:{EmailAddress:{Name:"Jane Doe"}},ItemId:{Id:"id2"}}]},{entityType:n.c.Chat,entities:[{entityType:n.c.Chat,confidence:1,text:"Group Chat",Name:"Group Chat",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4,ChatMembers:[{Id:"1",ResultSource:s.F.Server,confidence:1,entityType:n.c.People,text:"John Doe"}]},{entityType:n.c.Chat,confidence:1,text:"Group Chat 2",Name:"Group Chat 2",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:5,ChatMembers:[{Id:"1",ResultSource:s.F.Server,confidence:1,entityType:n.c.People,text:"John Doe"},{Id:"2",ResultSource:s.F.Server,confidence:1,entityType:n.c.People,text:"Jane Doe"}]}]},{entityType:n.c.Channel,entities:[{entityType:n.c.Channel,confidence:1,text:"Developer Channel",Name:"Developer Channel",TeamName:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entityType:n.c.Team,entities:[{entityType:n.c.Team,confidence:1,text:"Editor-SDK",Name:"Editor-SDK",ThreadId:"id1",AffinityScore:1,TotalChatMembersCount:4}]},{entities:[{entityType:n.c.App,id:"id",Title:"Sales meetings",text:"",subtitle:"Turned on last week",imageUrl:"https://vivasales.dynamics.com/outlookaddin/manifestimages/appLogoCopilotForSales_64px.png",confidence:0},{entityType:n.c.App,Title:"Bing",subtitle:"Available on Copilot",text:"Turned on last week",imageUrl:"https://content.powerapps.com/resource/powerbiwfe/images/PowerBI96x96.c2c49fdb8eb6008a98b3.png",confidence:0}],entityType:n.c.App}]},19952:(e,t,i)=>{i.d(t,{U:()=>a});var n=i(145402);if(0!=i.j)var s=i(251439);if(0!=i.j)var o=i(483432);if(0!=i.j)var r=i(229906);class a{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(505680981)}configureRootServices(e){!function(e,t,i){try{(0,o.Yi)(e,t,i)}catch(e){}}((0,r._)(),n.bk)}}},23544:(e,t,i)=>{i.d(t,{E:()=>l});var n=i(379490),s=i(229906);let o=class{triggerCallback(e,t){t?(this.userInfo=void 0,this.lastError=t):this.lastError=void 0,this.userInfo=e(this.userInfo)}async executeAsync(e=!0){return new Promise(((t,i)=>{this.execute(e,(e=>(this.lastError?i(this.lastError):t(e),e)))}))}};o=(0,n.__decorate)([(0,s._)()],o);var r=i(163573),a=i(83010);let l=class extends o{constructor(e){super(),this._hostSettings=e}update(e){this._updatedUserInfo=e}execute(e=!0,t){this._updatedUserInfo?this.userInfo=this._updatedUserInfo:this._hostSettings.userId&&(this.userInfo={userId:this._hostSettings.userId.puid,tenantId:this._hostSettings.userId.tenantId,email:void 0,licenseType:this._hostSettings.licenseType,identityProvider:this._hostSettings.userId.identityProvider}),this.triggerCallback(t)}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,a.W)(r.n))],l)},23603:(e,t,i)=>{if(i.d(t,{B:()=>r}),0!=i.j)var n=i(35865);var s=i(208520);if(0!=i.j)var o=i(120733);const r=(e,t)=>{const i=(0,o.E)("locale"),r=(0,s.useCallback)((e=>e.reduce(((e,t)=>(e[t]="",e)),{})),[]),[a,l]=(0,s.useState)(r(t)),d=(0,s.useCallback)((async(e,t,i)=>{var s;return null!==(s=await n.e.getStringForLocale(e,t,i))&&void 0!==s?s:n.e.getStringForFallbackLocale(t,i)}),[]),c=(0,s.useCallback)((async(e,t,i)=>{const n=r(i);for(const s of i)n[s]=await d(e,t,s);l(n)}),[d,r]);return(0,s.useEffect)((()=>{c(i,e,t)}),[c,e,i,t]),a}},24201:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Kortfattethed","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Konsistente staveformer"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Inkluderende sprog","IsImplemented":true},"Typing errors":{"LocalizedName":"Tastefejl","IsImplemented":false},"Clarity":{"IsImplemented":true,"LocalizedName":"Klarhed"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Omskrivning"},"Error Corrections":{"LocalizedName":"Fejlkorrigering","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Ordvalg","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammatik"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"Formelt sprog","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Tegnsætning"},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Skriftkonventioner"},"Spelling":{"LocalizedName":"Stavekontrol","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Curriculum Vitae"},"Sensitive Geopolitical References":{"LocalizedName":"Følsomme geopolitiske betegnelser","IsImplemented":false}}')},26922:(e,t,i)=>{if(i.d(t,{X:()=>o}),0!=i.j)var n=i(219515);var s=i(208520);const o=e=>{const{autoCorrectProps:t}=e;return s.createElement(n.u,Object.assign({},e,{squigglerId:t.id,squigglesProps:[t],opacity:1,isAutoCorrection:!0,ariaStatusUpdatesOnly:!1,anchorElement:e.anchorElement}))}},27335:(e,t,i)=>{i.d(t,{d:()=>r});var n=i(379490),s=i(225918),o=i(229906);let r=class{getPluginCalloutMaxHeight(e,t,i){var n;const s=null!==(n=e.y)&&void 0!==n?n:e.top;if(s)return Math.max(t.innerHeight-s,s)-20}getCalloutDirection(e,t,i,n){return e?s.A.topRightEdge:s.A.topLeftEdge}};r=(0,n.__decorate)([(0,o._)()],r)},28387:(e,t,i)=>{i.d(t,{h:()=>n});const n=(0,i(668952).f)("IEditorClientSettings")},30126:(e,t,i)=>{function n(e,t){if(!function(e){if(0===e.trim().length)return!1;try{return new URL(e),!0}catch(e){return!1}}(e))return e;const i=new URL(e),n=t.trim();return i.pathname.endsWith("/")?i.pathname+=n:i.pathname=`${i.pathname}/${n}`,i.toString()}i.d(t,{W:()=>n})},30379:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"అక్షరక్రమం"}}')},37615:(e,t,i)=>{if(i.d(t,{C:()=>o}),0!=i.j)var n=i(137464);var s=i(758651);class o{constructor(e){this._loggerSettings=e}logData(e){this._loggerSettings.logToConsole&&s.log((0,n.v)(e))}}},37741:(e,t,i)=>{if(i.d(t,{OE:()=>a}),0!=i.j)var n=i(379490);if(0!=i.j)var s=i(855304);if(0!=i.j)var o=i(420821);if(0!=i.j)var r=i(676959);function a(e){const{annotationId:t,typeId:i,traceId:a,sourceData:l,priority:d,supportedActions:c,suggestions:u,textInContext:g,start:h,length:p,metadata:m,nodeId:f,tileId:v,categoryTitle:y,isStealth:_,endNode:I,explanationTitle:C,explanationLabel:S,explanation:b,shouldShowMultilingualFre:T,languageId:E,shouldAttemptLanguageDetection:N}=e,w=(0,n.__rest)(e,["annotationId","typeId","traceId","sourceData","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign({annotationId:t,typeId:(0,o.e3)(i),typeIdRaw:i,traceId:a,sourceData:l,priority:d,supportedActions:(0,s.z)(c),suggestions:u.map(r.S),textInContext:g,start:h,length:p,metadata:m,nodeId:f,tileId:v,categoryTitle:y,isStealth:_,endNode:I,explanationTitle:C,explanationLabel:S,explanation:b,shouldShowMultilingualFre:T,languageId:E,shouldAttemptLanguageDetection:N},w)}},38403:(e,t,i)=>{i.d(t,{N:()=>a});var n=i(189784),s=i(688557),o=i(577059),r=i(208520);const a=r.memo((e=>{var t,i;const{prediction:a,parentElement:l}=e,d=parseInt(window.getComputedStyle(l).fontSize,10),c=(0,o.S)(null!==(i=null===(t=a.entityResults.entities[0].icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"");return r.createElement(n.I,Object.assign({},e,{showDropdownChevron:a.entityResults.entities.length>1}),r.createElement(s.I,{type:null!=c?c:"Cloud",style:{width:d,height:d},fontSize:d}))}))},39183:(e,t,i)=>{i.d(t,{d:()=>n});const n=(0,i(668952).f)("ILanguageInfoProvider")},39952:(e,t,i)=>{i.d(t,{q:()=>n});const n=(0,i(668952).f)("ICompositionEventHandler")},42568:(e,t,i)=>{if(i.d(t,{W:()=>o,n:()=>s}),0!=i.j)var n=i(46692);function s(e,t,i,s){return{name:e,value:t,dataType:(null!=s?s:"boolean"==typeof t)?n.o.DataFieldType.Boolean.valueOf():"number"==typeof t?n.o.DataFieldType.Int64.valueOf():n.o.DataFieldType.String.valueOf(),classification:null!=i?i:n.o.DataClassification.EssentialServiceMetadata}}function o(...e){return e.map((([e,t,i,n])=>s(e,t,i,n)))}},46183:(e,t,i)=>{i.d(t,{O:()=>o});var n=i(379490),s=i(229906);let o=class{getUILanguage(){return navigator.language}async getBrowserLanguages(){return Promise.resolve([navigator.language])}};o=(0,n.__decorate)([(0,s._)()],o)},46437:(e,t,i)=>{i.d(t,{H:()=>n});const n=(0,i(668952).f)("ISessionTelemetryTracker")},48644:(e,t,i)=>{if(i.d(t,{G:()=>r}),0!=i.j)var n=i(323283);if(0!=i.j)var s=i(380737);var o=i(208520);const r=e=>{const t=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1);o.useEffect((()=>{const t=new n.J(e.anchor);return t.addListener("click",(()=>{var t;e.isMouseOver&&!e.isCalloutOpened&&(null===(t=e.onClick)||void 0===t||t.call(e))})),()=>{t.removeAllListeners()}}),[e.isCalloutOpened,e.critique,e.isMouseOver,e.anchor,e.onClick]);const i=i=>{var n,s,o;const r=i;e.isCaretOver&&(null===(n=e.openCalloutPredicate)||void 0===n?void 0:n.call(e,r))&&!e.isCalloutOpened?(t(i),"keyup"===r.type&&(null===(s=e.onKeyboardEvent)||void 0===s||s.call(e))):"Escape"===r.key&&"keyup"===r.type&&(null===(o=e.onEscapePress)||void 0===o||o.call(e))};return o.useEffect((()=>{if(e.isCaretOver||e.isMouseOver){const s=new n.J(e.anchor);return s.addListener("keyup",i),s.addListener("focus",t),s.addListener("blur",t),s.addListener("keydown",i),()=>{s.removeAllListeners()}}}),[e.isCaretOver,e.isMouseOver,e.isCalloutOpened,e.critique,e.anchor,e.openCalloutPredicate,e.onKeyboardEvent,e.onEscapePress]),o.createElement("span",{ref:e.squiggleRef,id:e.id,role:e.role,className:e.className,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,style:{opacity:e.opacity}},o.createElement("span",{"aria-hidden":"true"},e.data.text),e.useSvgUnderline&&o.createElement(s.a,{width:"100%",left:0,patternName:e.patternName,styleOverrides:{opacity:e.opacity}}))}},49095:(e,t,i)=>{i.d(t,{x:()=>o});const n=0!=i.j?[]:null;let s;const o=e=>{s||(s=(()=>{const e=window.document.createElement("div");e.style.width="100px",e.style.height="100px",e.style.top="-9999px",e.style.overflow="scroll",e.style.position="absolute",window.document.body.appendChild(e);const t=e.offsetWidth-e.clientWidth;return window.document.body.removeChild(e),t})());const t=n.find((e=>{var t;return!!(null===(t=e.search)||void 0===t?void 0:t.test(window.location.href))}));if(!(null==t?void 0:t.getWidth)){const t=!e.isInput&&"hidden"!==e.computedOverflow&&e.anchor.scrollHeight-e.anchor.clientHeight&&"content-box"!==e.boxSizing&&!navigator.platform.startsWith("mac"),i=Number.parseFloat(e.computedWidth);return t?i-s:e.computedWidth}return t.getWidth(e)}},49947:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Tahajia","IsImplemented":true}}')},55386:(e,t,i)=>{i.d(t,{P:()=>r});var n=i(535912),s=i(93469),o=i(262185);class r{constructor(e){var t,i,n,s;this._initialized=!1,this._disposed=!1,this.triggers=null!==(t=e.triggers)&&void 0!==t?t:new Set,this.maxQueryLength=null!==(i=e.maxQueryLength)&&void 0!==i?i:r.DEFAULT_MAX_QUERY_LENGTH,this.maxWordsCount=null!==(n=e.maxWordsCount)&&void 0!==n?n:r.DEFAULT_MAX_WORDS_COUNT,this.forbiddenChars=new Set([...null!==(s=e.forbiddenChars)&&void 0!==s?s:[]].filter((e=>!this.triggers.has(e))))}get initialized(){return this._initialized}get disposed(){return this._disposed}init(){this._initialized=!0}dispose(){this.unregisterAllTriggers(),this._initialized=!1,this._disposed=!0}get registeredTriggers(){return this.triggers}registerTriggers(e){this.triggers=e}unregisterAllTriggers(){this.triggers=new Set}detectQuery(e,t,i,s){const{start:a,trigger:l}=this.findTrigger(e,t,s);if(-1===a)return;if(a>0&&!this.isWhitespace(e[a-1])&&!r.ALLOWED_PREVIOUS_CHARS.includes(e[a-1]))return;const d=this.getQueryEnd(e,a,i,s);if(-1===d||t>d)return;if(a+1<e.length&&a+1<d&&this.isWhitespace(e[a+1]))return;const c={tileId:"",queryRange:{start:a,length:d-a},additionalData:{logicalId:(0,n.D)(),conversationId:(null==s?void 0:s.queryRange.start)===a?s.additionalData.conversationId:(0,n.D)(),triggerKey:l}};return(0,o.S$)(Object.assign({isEmptyQuery:0===c.queryRange.length,queryLength:c.queryRange.length},c.additionalData)),c}findTrigger(e,t,i){for(let n=t>0?t-1:t;n>=0&&n<e.length;n--){if(this.forbiddenChars.has(e[n]))return{start:-1,trigger:""};if(!i&&this.isWhitespace(e[n]))return{start:-1,trigger:""};const t=e[n];if((0,s.LY)(t)&&this.triggers.has(t))return{start:n,trigger:t}}return{start:-1,trigger:""}}getQueryEnd(e,t,i,n){if(!n||n.queryRange.start!==t){const i=e.substring(t);if(i.length>=this.maxQueryLength)return-1;const n=i.length,s=i.search(/\s/);return-1===s?t+n:s+t}const s=t+n.queryRange.length+i;return e.substring(t,s).split(/\s+/).length>this.maxWordsCount?-1:s}isWhitespace(e){return 0===e.trim().length}}r.DEFAULT_MAX_QUERY_LENGTH=300,r.DEFAULT_MAX_WORDS_COUNT=4,r.ALLOWED_PREVIOUS_CHARS=["(","/","+","מ"]},56745:(e,t,i)=>{if(i.d(t,{AJ:()=>c,Fj:()=>r,Jr:()=>d,kj:()=>a,td:()=>u,vy:()=>l}),0!=i.j)var n=i(863307);if(0!=i.j)var s=i(647879);if(0!=i.j)var o=i(93469);const r=e=>{const t=(0,o.ZX)(e);(0,n._v)().logActivity("CiqIntentDetectionTriggered",(0,s.W)(["wordCount",t.wordCount],["length",t.length]))},a=(e,t)=>{const i=(0,o.ZX)(e);(null==t?void 0:t.length)?(0,n._v)().logActivity("CiqIntentDetectionCacheHit",(0,s.W)(["wordCount",i.wordCount],["length",i.length],["cachedIntentsCount",t.length])):(0,n._v)().logActivity("CiqIntentDetectionCacheMiss",(0,s.W)(["wordCount",i.wordCount],["length",i.length]))},l=e=>{const t=(0,o.ZX)(e.text);(0,n._v)().logActivity("CiqInvokeIntentDetectionStarted",(0,s.W)(["wordCount",t.wordCount],["length",t.length]),(0,s.W)(["intentRequestId",e.requestId]))},d=e=>{const t=(0,o.ZX)(e.text);(0,n._v)().logActivity("CiqIntentDetectionInvokeCompleted",(0,s.W)(["wordCount",t.wordCount],["length",t.length]),(0,s.W)(["intentRequestId",e.requestId]))},c=(e,t)=>{const i=(0,o.ZX)(t),r=JSON.stringify(e.intents);(0,n._v)().logActivity("CiqIntentDetectionCacheAddition",(0,s.W)(["wordCount",i.wordCount],["length",i.length],["intentsCount",e.intents.length],["intents",r]),(0,s.W)(["intentRequestId",e.request.requestId]))},u=e=>{var t;const i=(0,o.ZX)(e.prefix||"");e.intent?(0,n._v)().logActivity("CiqEntitiesRequestScoped",(0,s.W)(["intent",e.intent.suggestionEntityType],["intentScore",e.intent.score],["intentSource",e.intent.source||""],["prefixWordCount",i.wordCount],["prefixLength",i.length]),(0,s.W)(["conversationId",e.conversationId],["logicalId",e.logicalId])):(null===(t=e.prefix)||void 0===t?void 0:t.length)&&(0,n._v)().logActivity("CiqEntitiesRequestNotScoped",(0,s.W)(["prefixWordCount",i.wordCount],["prefixLength",i.length]),(0,s.W)(["conversationId",e.conversationId],["logicalId",e.logicalId]))}},58215:(e,t,i)=>{i.d(t,{W:()=>o,u:()=>s});var n=i(668952);const s=(0,n.f)("IParagraphNodesBuilderFactory"),o=(0,n.f)("IParagraphNodesBuilder")},60759:(e,t,i)=>{i.d(t,{Q:()=>d});var n=i(379490),s=i(518341),o=i(77127),r=i(229906),a=i(427603),l=i(83010);let d=class{constructor(e){var t,i;this.themeStore=e,this.browserSupportsHighContrastMode=null!==(i=null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,"not all and (forced-colors), (forced-colors), not all and (-ms-high-contrast), (-ms-high-contrast)").matches)&&void 0!==i&&i}get enabled(){var e,t;return(null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme)===o.SV.highContrast||(null===(t=window.matchMedia)||void 0===t?void 0:t.call(window,s.Rr.replace("@media ","")).matches)}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.l)()),(0,n.__param)(0,(0,l.W)(o.YQ))],d)},60836:(e,t,i)=>{i.d(t,{D:()=>h});var n=i(379490),s=i(537969),o=i(553164),r=i(639397),a=i(878790),l=i(229906),d=i(427603),c=i(83010);function u(e,t){if(!t)return;const i={nodeType:o.Z.TileNode,id:e.id,parent:t.parent,element:t.element,children:void 0,critiques:[],textFormattingInfo:e.cachedText,plainText:e.cachedText.content,pullText:()=>e.cachedText,retire:()=>e.retire,resetState:()=>e.resetState,reconcile:(t,i,n,s,o,r)=>e.reconcile({text:e.cachedText,mutationChangeType:t,rehydrateCritiques:s,forceTileDiffEmission:o,mutationWasTextReplacement:r,brokerOptions:{critiques:i,forceReflow:n}}),move:(t,n)=>(e.move(),i),getPreviousTileId:()=>e.previousNodeId,getNextTileId:()=>e.nextNodeId};return e.children.length>0&&(i.children=e.children.map((e=>g(e,i)))),i}function g(e,t){const i={nodeType:o.Z.ParagraphNode,id:e.id,element:e.range,parent:t,children:void 0,eventSeqId:e.eventSeqId,retire:()=>e.retire,move:()=>(e.move(),i),resetState:()=>{}};return i}let h=class{constructor(e){this._hostEmitter=e,this._tileNodeDictionary={},this._terminalNodeDictionary={},this._paragraphNodeDictionary={},this._preOrderTraverser=new r.y}get shadowGraph(){return this._shadowGraph}registerNode(e){const t=this._selectDictionary(e.nodeType);t&&(t[e.id]=e)}unregisterNode(e){const t=this._selectDictionary(e.nodeType);t&&delete t[e.id]}findNode(e){var t,i;const n=null!==(i=null!==(t=this.findParagraphNode(e))&&void 0!==t?t:this.findTileNode(e))&&void 0!==i?i:this.findTerminalNode(e);return n||(this.ensureCanFindNode()?this._iterateGraph(e):null)}findTileNode(e){var t;return null!==(t=this.findTileRootNode(e))&&void 0!==t?t:this._tileNodeDictionary[e]}get tileNodes(){const e=Object.values(this._tileNodeDictionary);if(!this._paragraphFinder)return e;const t=[];for(const i of e){const e=this.findTileRootNode(i.id);e?t.push(e):t.push(i)}return t}findParagraphNode(e){var t;return null!==(t=this.findTextTileNode(e))&&void 0!==t?t:this._paragraphNodeDictionary[e]}findTerminalNode(e){return this._terminalNodeDictionary[e]}getTileNodeV2Paragraphs(e){var t;const i=null===(t=this._paragraphFinder)||void 0===t?void 0:t.getTileNodeParagraphs(e.id);return i?i.map((t=>g(t,e))):null}addNode(e){var t;if(e.parent){const t=this.findNode(e.parent.id);t&&(t.children||(t.children=[]),t.children.push(e))}else{this._shadowGraph||(this._shadowGraph=new a.j),this._shadowGraph.rootNodes.push(e);const i=this._selectDictionary(e.nodeType);i&&(i[e.id]=e),null===(t=this._hostEmitter)||void 0===t||t.emit(s.pD.hostModelAddedRootNode,{address:void 0,message:e.id})}}removeNode(e){var t;if(!this.findNode(e.id))return;let i,n=!1;if(e.parent?i=e.parent.children:this._shadowGraph&&(i=this._shadowGraph.rootNodes,n=!0),n){const i=this._selectDictionary(e.nodeType);i&&delete i[e.id],null===(t=this._hostEmitter)||void 0===t||t.emit(s.pD.hostModelRemovedRootNode,{address:void 0,message:e.id})}!function(e,t){if(t){const i=t.indexOf(e);if(-1!==i)return t.splice(i,1),!0}}(e,i),e.retire()}async initialize(){}shutDown(){var e;this.retireAllShadowGraphRootNodes(),null===(e=this._shadowGraph)||void 0===e||e.clear()}_selectDictionary(e){switch(e){case o.Z.TileNode:return this._tileNodeDictionary;case o.Z.ParagraphNode:return this._paragraphNodeDictionary;case o.Z.TerminalNode:return this._terminalNodeDictionary;default:return}}ensureCanFindNode(){return!!this._shadowGraph&&(this._preOrderTraverser.rootAtNodes(this._shadowGraph.rootNodes),!0)}retireAllShadowGraphRootNodes(){if(this._shadowGraph)for(const e of this._shadowGraph.rootNodes)e.retire()}_iterateGraph(e){const t=this._preOrderTraverser.getIterator();let i=t.next();for(;!i.done;){if(i.value&&i.value.id===e)return i.value;i=t.next()}return null}setTextProcessingParagraphFinder(e){this._paragraphFinder=e}findTileRootNode(e){var t;if(!this._paragraphFinder)return null;const i=this._paragraphFinder.getTileRootNodeById(e);if(!i)return null;return null!==(t=u(i,this._tileNodeDictionary[e]))&&void 0!==t?t:null}findTextTileNode(e){if(!this._paragraphFinder)return null;const t=this._paragraphFinder.findParagraph(e);if(!t)return null;let i;if(t.parent){const e=this._tileNodeDictionary[t.parent.id];i=u(t.parent,e)}return g(t,i)}};h=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.l)()),(0,n.__param)(0,(0,c.W)(s.M5))],h)},61176:(e,t,i)=>{i.d(t,{B:()=>d});var n=i(379490),s=i(229906),o=i(83010),r=i(303610),a=i(118673),l=i(541647);let d=class{constructor(e,t){this.proofingEventListener=e,this.container=t,this.messages=[],this.uxInitialized=!1,this.onCritiqueForUiEvent=e=>{if(this.uxInitialized){this.container.get(l.C).onCritiqueForUiEvent(e)}else this.messages.push(e)},this.onSquiggleUXReadyEvent=async e=>{const t=this.container.get(l.C);let i;for(;i=this.messages.shift();)await t.onCritiqueForUiEvent(i);this.uxInitialized=!0},this.onRecomputeSquigglesEvent=async e=>{if(!this.uxInitialized)return;this.container.get(l.C).updateSquiggleRanges()}}async initialize(){this.proofingEventListener.on("squiggleUXReadyEvent",this.onSquiggleUXReadyEvent),this.proofingEventListener.on("recomputeSquiggles",this.onRecomputeSquigglesEvent),this.proofingEventListener.on("squiggleDataEvent",this.onCritiqueForUiEvent)}shutDown(){}};d=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(a.o)),(0,n.__param)(1,(0,o.W)(r.p))],d)},61971:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(668952).f)("ICritiqueCalloutStateStoreBase")},62049:(e,t,i)=>{function n(e){return"File"===e.type}function s(e){return"People"===e.type}function o(e){return"Message"===e.type}function r(e){return"Event"===e.type}function a(e){return"Command"===e.type}function l(e){return"App"===e.type}i.d(t,{$N:()=>l,XU:()=>s,gu:()=>n,hV:()=>a,kS:()=>r,w2:()=>o})},63689:(e,t,i)=>{i.d(t,{M:()=>l});var n=i(379490),s=i(163573),o=i(229906),r=i(83010),a=i(342892);let l=class{constructor(e,t){this._wordCount=e,this._hostSettings=t}hasWordCountChanged(e,t,i,n=!1){let s,o=0;n?({wordCount:o,wordBoundaries:s}=this.computeValidWordCountAndBoundariesForRange(i,0,i.length)):o=this.computeValidWordCountForRange(i,0,i.length);const r={isWordCountChanged:!1,wordCount:o,wordBoundaries:s};if(o>0&&0===e.firstDiffLeft&&0===e.firstDiffRight)return r.isWordCountChanged=!0,r;if(e.firstDiffLeft+e.firstDiffRight<=i.length){if(this._wordCount.getWordCountInRange(i,e.firstDiffLeft,i.length-e.firstDiffRight)>1)return r.isWordCountChanged=!0,r}if(t>o)return r.isWordCountChanged=!0,r;const a=this.computeValidWordCountForRange(i,0,i.length-e.firstDiffRight);if(0===a)return r.isWordCountChanged=!1,r;const l=this.computeValidWordCountForRange(i,0,e.firstDiffLeft);return r.isWordCountChanged=a>l,r}getWordCount(e){return this.computeValidWordCountForRange(e,0,e.length)}computeValidWordCountForRange(e,t,i){if(t>=i||t<0||i>e.length)return 0;const{wordCount:n,wordBreaks:s}=this._wordCount.getWordCountAndBreaksInRange(e,t,i);return this.correctWordCountForIncompleteWord(s,e.length,n)}computeValidWordCountAndBoundariesForRange(e,t,i){if(t>=i||t<0||i>e.length)return{wordCount:0,wordBoundaries:[]};const{wordCount:n,wordBreaks:s,wordBoundaries:o}=this._wordCount.getWordCountWithBoundariesAndBreaksInRange(e,t,i);return{wordCount:this.correctWordCountForIncompleteWord(s,e.length,n),wordBoundaries:o}}correctWordCountForIncompleteWord(e,t,i){if(i<=0||0===e.length)return 0;const n=e.length-1;return"WhiteSpace"!==e[n].wordBreakType&&(this._hostSettings.newLineSentenceSeparatorEnabled||this._hostSettings.useParagraphAsTileSeparator||"Punctuation"!==e[n].wordBreakType)&&e[n].cp+1<=t?i-1:i}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(a.t)),(0,n.__param)(1,(0,r.W)(s.n))],l)},68800:(e,t,i)=>{i.d(t,{T:()=>a});var n=i(379490),s=i(445801),o=i(553164),r=i(229906);let a=class extends s.W{constructor(e,t,i,n,s){super(o.Z.OutlineNode,e,t,i,n,s),this._observer=e,this.element&&this._observer.observe(this.element)}move(e,t){return super.move(e,t),this.element&&this._observer.observe(this.element),this}};a=(0,n.__decorate)([(0,r._)()],a)},68852:(e,t,i)=>{if(i.d(t,{H:()=>g}),0!=i.j)var n=i(958594);if(0!=i.j)var s=i(188694);if(0!=i.j)var o=i(89609);var r=i(258545);if(0!=i.j)var a=i(341524);if(0!=i.j)var l=i(120733);if(0!=i.j)var d=i(23603);var c=i(208520);const u=Object.values(r.U).concat(["noResults","noResultsFor","noResultsForTab","eitherOr","tryDifferentSearch","provideFeedback"]),g=()=>{const e=(0,l.E)("activeTab"),t=(0,l.E)("requestEntitiesParams").query.text,i=(0,d.B)("InlineSuggestionStrings",u),g=(0,a.b)("searchExclamation"),p=(0,c.useMemo)((()=>t?"All"===e?s.$.format(i.noResultsFor,t):s.$.format(i.noResultsForTab,t,i[r.U[e]]):i.noResults),[t,e,i]);return c.createElement(n.J,{style:(0,o.BO)(),image:{src:g},heading:p,body:c.createElement(h,null)})},h=()=>{const e=(0,l.E)("onSearchChange"),t=(0,d.B)("InlineSuggestionStrings",u);return c.createElement(c.Fragment,null,c.createElement("span",{style:(0,o.fR)(),onClick:()=>{null==e||e("")},"data-automation-id":"try-different-search-text","aria-hidden":"true"},t.tryDifferentSearch),s.$.format(t.eitherOr,"",""),c.createElement("span",{style:(0,o.fR)(),"data-automation-id":"provide-feedback-text"},t.provideFeedback))}},69654:(e,t,i)=>{i.d(t,{h:()=>a});var n,s=i(379490),o=i(229906),r=i(323283);let a=n=class{constructor(){this.eventListener=new r.J(document)}async initialize(){}shutDown(){this.eventListener.removeAllListeners()}async set(e){const t=Object.keys(e),i={};for(const n of t){const t=e[n];i[n]={oldValue:localStorage.getItem(n),newValue:t};try{localStorage.setItem(n,t)}catch(e){return Promise.reject(e)}}const n=new CustomEvent("storageItemInserted",{detail:i});return document.dispatchEvent(n),Promise.resolve()}async remove(e){if("string"==typeof e)localStorage.removeItem(e);else if(Array.isArray(e))for(const t of e)localStorage.removeItem(t);return Promise.resolve()}async get(e){const t={};if("string"==typeof e)t[e]=n._getItem(e);else if(Array.isArray(e))for(const i of e)t[i]=n._getItem(i);else if(e instanceof Object){const i=Object.keys(e);for(const s of i){const i=n._getItem(s);t[s]=i||e[s]}}return Promise.resolve(t)}addChangeListener(e){this.eventListener.addListener("storageItemInserted",(t=>{t.detail&&e(t.detail,"")}))}removeEventListener(e){this.eventListener.removeAllListeners()}static _getItem(e){const t=localStorage.getItem(e);if(t)try{const e=JSON.parse(t);return void 0!==e.value&&e.lastUpdated&&void 0!==e.manualOverride?t:e}catch(e){return t}return null}};a=n=(0,s.__decorate)([(0,o._)()],a)},70119:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":""},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":false,"LocalizedName":""},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":false},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Verificare ortografică"},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},70303:(e,t,i)=>{if(i.d(t,{z:()=>o}),0!=i.j)var n=i(829088);const s=1e4;class o{constructor(e){this._hostSettings=e,this._clearanceIntervalId=void 0,this._requestedFrames=[],this._requestedIdleFrames=[]}async initialize(){this._hostSettings.enableClearingOfRequestedAnimationFrames&&this.setIntervals()}shutDown(){var e;this._clearanceIntervalId&&(clearInterval(this._clearanceIntervalId),this._clearanceIntervalId=void 0);for(const{id:t,targetWindowRef:i}of this._requestedFrames)null===(e=i.deref())||void 0===e||e.cancelAnimationFrame(t);this._requestedFrames=[]}requestAnimationFrame(e,t=window){const i=(0,n.E)(t)?t:new n.O(t),s=i.deref();if(!s)return-1;const o=s.requestAnimationFrame(e);return this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedFrames.push({id:o,targetWindowRef:i,time:(new Date).getTime()}),o}cancelAnimationFrame(e,t=window){const i=((0,n.E)(t)?t:new n.O(t)).deref();if(i&&(i.cancelAnimationFrame(e),this._hostSettings.enableClearingOfRequestedAnimationFrames)){const t=this._requestedFrames.findIndex((t=>t.id===e));-1!==t&&this._requestedFrames.splice(t,1)}}requestIdleCallback(e,t,i=window){const s=(0,n.E)(i)?i:new n.O(i),o=s.deref();if(!o)return-1;let r;return r="requestIdleCallback"in o?o.requestIdleCallback(e,{timeout:t}):o.setTimeout(e,t),this._hostSettings.enableClearingOfRequestedAnimationFrames&&this._requestedIdleFrames.push({id:r,targetWindowRef:s,time:(new Date).getTime()}),r}cancelIdleCallback(e,t=window){const i=((0,n.E)(t)?t:new n.O(t)).deref();i&&("requestIdleCallback"in i?i.cancelIdleCallback(e):i.clearTimeout(e))}setIntervals(){this._clearanceIntervalId=setInterval((()=>{var e;const t=(new Date).getTime();let i=this._requestedFrames.findIndex((({time:e})=>t-e<s)),n=-1===i?this._requestedFrames.splice(0,this._requestedFrames.length):this._requestedFrames.splice(0,i);if(n.length)for(const{id:t,targetWindowRef:i}of n)null===(e=i.deref())||void 0===e||e.cancelAnimationFrame(t);if(i=this._requestedIdleFrames.findIndex((({time:e})=>t-e<s)),n=-1===i?this._requestedIdleFrames.splice(0,this._requestedIdleFrames.length):this._requestedIdleFrames.splice(0,i),n.length)for(const{id:e,targetWindowRef:t}of n){const i=t.deref();i&&("requestIdleCallback"in i?i.cancelIdleCallback(e):i.clearTimeout(e))}}),s)}}},74372:(e,t,i)=>{i.d(t,{$K:()=>o,tp:()=>s});var n=i(668952);(0,n.f)("InputControlsV2ProxyOptionsToken");const s=(0,n.f)("IInputControlsStateStoreFactory"),o=(0,n.f)("InputControlsSquigglerComponent")},77127:(e,t,i)=>{i.d(t,{UC:()=>R,YQ:()=>o,h1:()=>W,ZP:()=>se,SV:()=>n,O1:()=>oe.O,w:()=>F,Cx:()=>D,iN:()=>q,yF:()=>A});var n,s=i(668952);!function(e){e.light="light",e.dark="dark",e.highContrast="highContrast",e.custom="custom"}(n||(n={}));const o=(0,s.f)("IThemeStore"),r=new Map([[n.light,{fill:{color:"#424242"}}],[n.dark,{fill:{color:"#FFFFFF"}}],[n.highContrast,{fill:{color:"#FFFFFF"}}]]),a="CopilotEccIcon",l=new Map([[n.light,{background:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9",disabled:"#A19F9D"},border:"#FFFFFF",text:{resting:"#201F1E",disabled:"#A19F9D"},tag:{resting:"#605E5C"},altText:{resting:"#605E5C"},icon:{resting:"#797775",disabled:"#A19F9D"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},grammarText:{resting:"#3355FF"},refinementText:{resting:"#5A4EBC"},rewriteText:{resting:"#5A4EBC"},suggestionMenuHoverBackground:"#F3F2F1",header:"#3B3A39",subheader:"#605E5C",dialogText:"#605E5C",iconText:"#605E5C",contextText:"#605E5C",errorText:"#FF0000",separator:"#E1DFDD",focusRing:"#201F1E",link:"#1651AA",linkPressed:"#13458F",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},addOnFooterBackground:"#F3F2F1",upsellFooterColor:"#EFF6FC",addOnFooterMessage:"#201F1E",premiumEmphasis:"#185ABD",addOnAction:"#185ABD",editorIcon:"#185ABD",correctionHighlight:"#D4EDD4",helpLink:{text:{resting:"#1651AA",hover:"#13458F",pressed:"#13458F",disabled:"#A19F9D"},focusRing:"#201F1E"}}],[n.dark,{background:{resting:"#1B1A19",hover:"#252423",pressed:"#292827",disabled:"#797775"},border:"#1B1A19",text:{resting:"#FAF9F8",disabled:"#797775"},tag:{resting:"#A19F9D"},altText:{resting:"#A19F9D"},icon:{resting:"#A19F9D",disabled:"#797775"},altIcon:{resting:"#616161",hover:"#82ABF1",pressed:"#82ABF1",disabled:"#797775"},grammarText:{resting:"#99AAF5"},refinementText:{resting:"#ADA2F2"},rewriteText:{resting:"#ADA2F2"},suggestionMenuHoverBackground:"#252423",header:"#C8C6C4",subheader:"#A19F9D",dialogText:"#A19F9D",iconText:"#A19F9D",contextText:"#A19F9D",errorText:"#FF0000",separator:"#484644",focusRing:"#C8C6C4",link:"#3D7CE8",linkPressed:"#598FEC",branding:{type:"IconAndTextButton",background:{resting:"#1B1A19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},addOnFooterBackground:"#252423",upsellFooterColor:"#092C47",addOnFooterMessage:"#FAF9F8",premiumEmphasis:"#598FEC",addOnAction:"#598FEC",editorIcon:"#598FEC",correctionHighlight:"#095E09",helpLink:{text:{resting:"#3D7CE8",hover:"#598FEC",pressed:"#598FEC",disabled:"#797775"},focusRing:"#C8C6C4"}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},border:"#FFFFFF",text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tag:{resting:"#FFFFFF",hover:"#000000"},altText:{resting:"#FFFFFF",hover:"#000000"},icon:{resting:"#FFFFFF",disabled:"#FFFFFF"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},grammarText:{resting:"#FFFFFF",hover:"#000000"},refinementText:{resting:"#FFFFFF",hover:"#000000"},rewriteText:{resting:"#FFFFFF"},suggestionMenuHoverBackground:"#000000",header:"#FFFFFF",subheader:"#FFFFFF",dialogText:"#FFFFFF",iconText:"#FFFFFF",contextText:"#FFFFFF",errorText:"#FFFFFF",separator:"#FFFFFF",focusRing:"#1AEBFF",link:"#FFFF01",linkPressed:"#FFFF01",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},addOnFooterBackground:"#000000",upsellFooterColor:"#000000",addOnFooterMessage:"#FFFFFF",premiumEmphasis:"#FFFFFF",addOnAction:"#FFFFFF",editorIcon:"#FFFFFF",correctionHighlight:"#FFFFFF",helpLink:{text:{resting:"#FFFF01",hover:"#FFFF01",pressed:"#FFFF01",disabled:"#FFFF01"},focusRing:"#FFFF01"},callout:{borderColor:"#FFFFFF"}}]]),d="CritiqueCallout";var c=i(524812),u=i(639793);const g=new Map([[n.light,{background:{resting:u.kd.white,hover:"#F5F5F5",pressed:"#CFE4FA"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:u.kd.gray190,disabled:"#707070"},altIcon:{resting:"#616161",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},actionButtonForeground:{resting:"#0078D4"},highlightingBorderColor:u.kd.gray190,branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},highlighting:"#EBF3FC",altText:{resting:u.kd.gray130},shimmer:{shimmerColor:u.kd.gray20,shimmerWaveColor:u.kd.gray30},scroll:{thumbColor:"#676767"},tooltip:{directionHint:c.A8.rightCenter},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#EBEBEB"},meetingBanner:{backgroundColor:"#FAF9F8",text:"#424242",iconPrimaryColor:"#616161",borderColor:"#d1d1d1"},noSuggestions:{descriptionTextColor:u.kd.gray130,item:{background:{resting:u.kd.white,hover:"#F5F5F5",pressed:"#CFE4FA",disabled:void 0},text:{resting:"#115EA3"},actionButtonForeground:{resting:"#5D92CC"},highlighting:"#F5F5F5"}}}],[n.dark,{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD"},footerButtonBackground:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},text:{resting:u.kd.white,disabled:"#707070"},highlightingBorderColor:u.kd.white,altText:{resting:"#D6D6D6"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#115EA3",branding:{type:"IconAndTextButton",background:{resting:"#2E2E2E",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#FFFFFF80"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF",directionHint:c.A8.rightCenter},tag:{background:"#082338",textColor:"#62ABF5"},headerUnderlineColor:"#106CBD",fallbackIcon:{background:"#3D3D3D"},meetingBanner:{backgroundColor:"#141414",text:"#ffffff",iconPrimaryColor:"#adadad",borderColor:"#666666"},noSuggestions:{descriptionTextColor:"#707070",item:{background:{resting:"#2E2E2E",hover:"#1F1F1F",pressed:"#0F6CBD",disabled:void 0},text:{resting:"#598FEC"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}]]),h="ExpandedInlineSuggestion",p=new Map([[n.light,{background:"linear-gradient(93.85deg, #EEF3FB 58.87%, #EAE9FF 100%)",buttonBackground:"white",textColor:"#323130",linkColor:"#2E6AC5",dismissColor:"#323130",iconColor:"#185ABD",newTag:{shadow:"0px 1.6px 3.56px 0px rgba(0, 0, 0, 0.13)",background:"#FFFFFF",textColor:"#185ABD"},pagination:{textColor:"#185ABD",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#FFFFFF",textColor:"#201F1E"}}],[n.dark,{background:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",buttonBackground:"linear-gradient(93.85deg, #0C2145 58.87%, #0C2145 100%)",textColor:"white",linkColor:"#82ABF1",dismissColor:"white",iconColor:"#82ABF1",newTag:{background:"#82ABF1",textColor:"#0C2145"},pagination:{textColor:"#82ABF1",arrow:{background:{resting:"transparent",hover:"transparent"},disabledButtonColor:"grey"}},tooltip:{background:"#1B1A19",textColor:"#FFFFFF"},shimmer:{shimmerColor:"#052865"}}]]),m="FooterFRE",f=new Map([[n.light,{background:"#0F6CBD",shadow:"0px 4px 8px rgba(0, 0, 0, 0.14), 0px 0px 2px rgba(0, 0, 0, 0.12)",borderRadius:{default:"4px",disabled:"0px"},display:"flex",width:"32px",height:"32px",color:"#FFFFFF",border:"none",critiqueCategoryText:{fontFamily:"segoeUi",fontSize:"14px",lineHeight:"18px",fontStyle:"normal",padding:"5px",color:"#000000",minWidth:"unset",fontWeight:"600"},critiqueCategoryNumber:{fontFamily:"bahnschrift",font:"bahnschrift",fontSize:"16px",lineHeight:"18px"},indicatorButtonText:{textAlign:"center",fontFamily:"bahnschrift",fontSize:"16px",minWidth:"unset",padding:"12px",fontWeight:"600"},suggestionNumberText:{padding:"3px"}}]]),v="Indicator",y=new Map([[n.light,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[n.dark,{background:{resting:"#EBEBEB",hover:"#f5f5f5"},text:{resting:"#616161"}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),_="InlineNudgeBubble",I=new Map([[n.light,{background:{resting:"#FFFFFF",hover:"#F0F0F0"},footerButtonBackground:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},text:{resting:"#201F1E",disabled:"#A19F9D"},altIcon:{resting:"#424242",hover:"#185ABD",pressed:"#185ABD",disabled:"#CCCCCC"},altText:{resting:"#605E5C"},highlightingBorderColor:"#201F1E",actionButtonForeground:{resting:"#0078D4"},highlighting:"#F5F5F5",branding:{type:"IconAndTextButton",background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#E0E0E0",disabled:"#FFFFFF"},icon:{resting:"#185ABD",disabled:"#BDBDBD"},title:{resting:"#185ABD",disabled:"#BDBDBD"},tooltip:{textColor:"#201F1E"},focusRing:"#323130"},shimmer:{shimmerColor:"#F3F2F1",shimmerWaveColor:"#EDEBE9"},scroll:{thumbColor:"#bdbdbd"},tag:{background:"#EBF3FC",textColor:"#0F6CBD"},noSuggestions:{descriptionTextColor:"#616161",item:{background:{resting:"#FFFFFF",hover:"#F5F5F5",pressed:"#F0F0F0"},text:{resting:"#185ABD",disabled:"#707070"},actionButtonForeground:{resting:"#0078D4",disabled:"#707070"},highlighting:"#F5F5F5"}}}],[n.dark,{background:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},footerButtonBackground:{resting:"#1B1A19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#FAF9F8",disabled:"#797775"},highlightingBorderColor:"#FAF9F8",altText:{resting:"#A19F9D"},altIcon:{resting:"#FFFFFF",hover:"#82ABF1",pressed:"#82ABF1"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929",branding:{type:"IconAndTextButton",background:{resting:"#1b1a19",hover:"#383838",pressed:"#2E2E2E",disabled:"#383838"},icon:{resting:"#82ABF1",disabled:"#5C5C5C"},title:{resting:"#82ABF1",disabled:"#5C5C5C"},tooltip:{textColor:"#FFFFFF"},focusRing:"#323130"},shimmer:{shimmerColor:"#3D3D3D",shimmerWaveColor:"#474747"},scroll:{thumbColor:"#D6D6D6"},tooltip:{backgroundColor:"#1B1A19",textColor:"#FFFFFF"},tag:{background:"#082338",textColor:"#62ABF5"},noSuggestions:{descriptionTextColor:"#D6D6D6",item:{background:{resting:"#1b1a19",hover:"#3D3D3D",pressed:"#292827",disabled:"#797775"},text:{resting:"#296FE6",disabled:"#707070"},actionButtonForeground:{resting:"#598FEC"},highlighting:"#292929"}}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},footerButtonBackground:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},highlightingBorderColor:"#FFFFFF",altText:{resting:"#FFFFFF",hover:"#000000"},altIcon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF",branding:{type:"IconAndTextButton",background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},icon:{resting:"#FFFFFF",hover:"#000000",pressed:"#000000",disabled:"#FFFFFF"},title:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},tooltip:{textColor:"#FFFFFF"},focusRing:"#1AEBFF"},shimmer:{shimmerColor:"#FFFFFF",shimmerWaveColor:"#FFFFFF"},scroll:{thumbColor:"#FFFFFF"},tooltip:{backgroundColor:"#000000",textColor:"#FFFFFF"},callout:{border:"1px solid #FFFFFF"},userAvatarBorderColor:"#FFFFFF",noSuggestions:{descriptionTextColor:"#FFFFFF",item:{background:{resting:"#000000",hover:"#1AEBFF",pressed:"#1AEBFF",disabled:"#000000"},text:{resting:"#FFFFFF",hover:"#000000",disabled:"#FFFFFF"},actionButtonForeground:{resting:"#FFFF01"},highlighting:"#1AEBFF"}}}]]),C="InlineSuggestion",S=new Map([[n.light,{background:{resting:"#FFFFFF",hover:"#f3f2f1"},text:{resting:"#605e5c"}}],[n.dark,{background:{resting:"#333333",hover:"#212121"},text:{resting:"#f4f4f4"}}],[n.highContrast,{background:{resting:"#000000",hover:"#1AEBFF"},text:{resting:"white",hover:"black"}}]]),b="NudgeBubble",T=new Map([[n.light,{background:{resting:"#f5f5f5",hover:"#eee8ff"},text:"#605e5c",entityText:{resting:"#707070",hover:"#8230ff"},tabText:"#707070",highlightColor:"#EBEBEB"}],[n.dark,{background:{resting:"#141414",hover:"#4c0aa8"},text:"#a19f9d",entityText:{resting:"#999999",hover:"#a375ff"},tabText:"#999999"}],[n.highContrast,{background:{resting:"#000000",hover:"#8ee3f0"},text:"#3FF23F",entityText:{resting:"#ffffff",hover:"#263b50"},tabText:"#3FF23F"}]]),E="PredictionContainer",N=new Map([[n.light,{background:"#FFFFFF",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#424242",altText:"#616161"}],[n.dark,{background:"#1B1A19",shadow:"0 4px 8px rgba(0, 0, 0, 0.14), 0 0 2px rgba(0, 0, 0, 0.12)",text:"#FFFFFF",altText:"#ADADAD"}]]),w="SquiggleTooltip",x=new Map([[n.light,{primaryButtonBackground:{resting:"#0078D4",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#FFFFFF",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#FFFFFF",hover:"#F3F2F1",pressed:"#EDEBE9"},defaultButtonText:{resting:"#201F1E",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",primaryButtonFocusRing:"#FFFFFF",backgroundColor:"#FFFFFF",link:"#1651AA",titleColor:"#201F1E",descriptionColor:"#605E5C",rejectionTextColor:"#201F1E",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#DEECF9",dismissButtonColor:"#000000",highContrast:{iconPrimaryColor:"#000000",iconSecondaryColor:"#FFFFFF"}}],[n.dark,{primaryButtonBackground:{resting:"#2899F5",hover:"#1651AA",pressed:"#0E336A"},primaryButtonText:{resting:"#1B1A19",disabled:"#A19F9D"},defaultButtonBackground:{resting:"#1B1A19",hover:"#484644",pressed:"#979593"},defaultButtonText:{resting:"#FAF9F8",disabled:"#A19F9D"},defaultBorder:"1px solid #8A8886",backgroundColor:"#1B1A19",link:"#2899F5",titleColor:"#FAF9F8",descriptionColor:"#C8C6C4",rejectionTextColor:"#FAF9F8",primaryButtonFocusRing:"#FFFFFF",defaultButtonFocusRing:"#FFFFFF",iconPrimaryColor:"#0078D4",iconSecondaryColor:"#043862",dismissButtonColor:"#FAF9F8",highContrast:{iconPrimaryColor:"#FFFFFF",iconSecondaryColor:"#000000"}}]]),L="TonalFirstRunCard",D=new Map([[d,l],[h,g],[m,p],[C,I],[a,r],[L,x],[b,S],[_,y],[E,T],[w,N],[v,f]]),A={critiqueCalloutComponentName:d,expandedInlineSuggestionComponentName:h,footerFreComponentName:m,inlineSuggestionComponentName:C,copilotEccIconComponentName:a,indicatorComponentName:v,tonalFreComponentName:L,nudgeBubbleComponentName:b,inlineNudgeBubbleComponentName:_,predictionContainerComponentName:E,squiggleTooltipComponentName:w},F=new Map([[b,{}]]),q={critiqueCalloutComponentName:d,footerFreComponentName:m,nudgeBubbleComponentName:b,advancedEditorSettingsDialogComponentName:"AdvancedEditorSettingsDialog"},R=(0,s.f)("IStyleStore");var P=i(379490),O=i(419728);function k(e){return new Map(JSON.parse(JSON.stringify(Array.from(e))))}function M(e){return e&&"object"==typeof e&&Object.keys(e).length?JSON.parse(JSON.stringify(e)):e}var z=i(229906),j=i(637224);let W=class{constructor(){this._styles=new Map,(0,j.Gn)(this)}get components(){return Array.from(this._styles.keys())}getComponentStyle(e){const t=this._styles.get(e);return t&&M(t)}updateComponentStyle(e,t){this._styles.set(e,t)}};(0,P.__decorate)([O.observable],W.prototype,"_styles",void 0),(0,P.__decorate)([O.computed],W.prototype,"components",null),(0,P.__decorate)([O.action],W.prototype,"getComponentStyle",null),(0,P.__decorate)([O.action],W.prototype,"updateComponentStyle",null),W=(0,P.__decorate)([(0,z._)()],W);var B=i(675211);const U=(0,B.a)({semanticColors:{cardShadow:"0px 1px 2.5px 0px rgba(0, 0, 0, 0.12),0px 2px 4px 0px rgba(0, 0, 0, 0.08)",cardShadowHovered:"0 8px 24px 0 rgba(0,0,0,0.1), 0 8px 16px 0 rgba(0,0,0,0.12)",buttonBackground:"#ffffff",buttonBackgroundHovered:"#f5f5f5",buttonBackgroundPressed:"#e0e0e0",buttonBorder:"#e1dfdd",bodyStandoutBackground:"#c4c4c4",buttonText:"#242424",buttonTextDisabled:"#616161",primaryButtonText:"#ffffff",disabledText:"#bdbdbd",disabledBodyText:"#605e5c",errorText:"#a80000",accentButtonText:"#185abd",accentButtonBackground:"#d2e0f4",bodyDivider:"#c7e0f4",focusBorder:"#242424",variantBorder:"#bdbdbd",infoIcon:"#185abd",successBackground:"#d2e0f4",successIcon:"#185ABD",menuDivider:"#e0e0e0",warningBackground:"#d4edd4",warningIcon:"#094609",errorBackground:"#fde5e5",errorIcon:"#3f1011",buttonTextChecked:"#185ABD",buttonBackgroundChecked:"#d2e0f4",buttonTextCheckedHovered:"#185ABD",buttonBackgroundCheckedHovered:"#d2e0f4",actionLink:"#185ABD",actionLinkHovered:"#185ABD",linkHovered:"#185ABD",bodySubtext:"#616161",bodyBackground:"#f5f5f5",cardStandoutBackground:"#ebf3fc",infoBackground:"#F0F0F0",listItemBackgroundHovered:"#f3f2f1",inputBackground:"F5F5F5",primaryButtonBackground:"#185ABD",primaryButtonBackgroundHovered:"#1651AA",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#185abd",themeDark:"#185abd",themeDarkAlt:"#185abd",themePrimary:"#185abd",themeSecondary:"#185abd",themeTertiary:"#185abd",themeLight:"#d2e0f4",themeLighter:"#d2e0f4",black:"#242424",neutralDark:"#242424",neutralPrimary:"#242424",neutralPrimaryAlt:"#242424",neutralSecondary:"#616161",neutralSecondaryAlt:"#616161",neutralTertiary:"#bdbdbd",neutralTertiaryAlt:"#bdbdbd",neutralQuaternary:"#e0e0e0",neutralQuaternaryAlt:"#e0e0e0",neutralLight:"#e0e0e0",neutralLighter:"#f5f5f5",neutralLighterAlt:"#f5f5f5",white:"#ffffff"}}),H=(0,B.a)({semanticColors:{cardShadow:"none",cardShadowHovered:"none",buttonBackground:"#292929",buttonBackgroundHovered:"#3d3d3d",buttonBackgroundPressed:"#1f1f1f",buttonBorder:"#3d3d3d",bodyStandoutBackground:"default",buttonText:"#ffffff",buttonTextDisabled:"#ADADAD",primaryButtonText:"#ffffff",disabledText:"#ADADAD",disabledBodyText:"#d6d6d6",errorText:"#f1707b",accentButtonText:"#82ABF1",accentButtonBackground:"#0c2145",bodyDivider:"#598fec",focusBorder:"#ffffff",variantBorder:"#5c5c5c",infoIcon:"#82ABF1",successBackground:"#071225",successIcon:"#82ABF1",menuDivider:"#666666",warningBackground:"#094609",warningIcon:"#d4edd4",errorBackground:"#3f1011",errorIcon:"#fde5e5",buttonTextChecked:"#82ABF1",buttonBackgroundChecked:"#0c2145",buttonTextCheckedHovered:"#82ABF1",buttonBackgroundCheckedHovered:"#0c2145",actionLink:"#82ABF1",actionLinkHovered:"#82ABF1",linkHovered:"#82ABF1",bodySubtext:"#adadad",bodyBackground:"#141414",cardStandoutBackground:"#3d3d3d",infoBackground:"#292929",listItemBackgroundHovered:"#1651AA",inputBackground:"#141414",primaryButtonBackground:"#1651AA",primaryButtonBackgroundHovered:"#185ABD",primaryButtonBackgroundPressed:"#0E336A"},palette:{themeDarker:"#82abf1",themeDark:"#82abf1",themeDarkAlt:"#82abf1",themePrimary:"#82abf1",themeSecondary:"#82abf1",themeTertiary:"#82abf1",themeLight:"#0c2145",themeLighter:"#071225",black:"#ffffff",neutralDark:"#ffffff",neutralPrimary:"#ffffff",neutralPrimaryAlt:"#ffffff",neutralSecondary:"#adadad",neutralSecondaryAlt:"#adadad",neutralTertiary:"#858585",neutralTertiaryAlt:"#858585",neutralQuaternary:"#666666",neutralQuaternaryAlt:"#5c5c5c",neutralLight:"#1f1f1f",neutralLighter:"#3d3d3d",neutralLighterAlt:"#292929",white:"#141414"},isInverted:!0});var V;let G;function Q(){return null!=G?G:G=(0,O.observable)({theme:U})}!function(e){e.Light="Light",e.Dark="Dark"}(V||(V={}));const K=(0,O.action)((e=>{Q().theme=e===V.Dark?H:U}));(0,O.action)((e=>{Q().theme=e}));var $=i(830665),J=i(630501),Z=i(163573),Y=i(83010),X=i(670802),ee=i(65314),te=i(672356),ie=i(639026),ne=i(62018);let se=class extends J.z{constructor(e){super(),this.hostSettings=e,this._defaultTheme=n.light,this._currentTheme=n.light,this._themes=new Map,this._fluentThemes=new Map,this._isDarkMode=void 0,this._useFluentV9=void 0,(0,j.Gn)(this),this._isDarkMode=this.hostSettings.isDarkMode,this._currentTheme=this.hostSettings.isDarkMode?n.dark:n.light,this._currentTheme===n.dark?K(V.Dark):K(V.Light),this._useFluentV9=this.hostSettings.useFluentV9}get isDarkMode(){return this._isDarkMode}get defaultTheme(){return this._defaultTheme}get currentTheme(){return this._currentTheme}get components(){return Array.from(this._themes.keys())}getFluentActiveTheme(){let e={};if(!this._fluentThemes.get(this._currentTheme))switch(this._currentTheme){case n.light:e=X.o;break;case n.dark:e=ee.C;break;case n.highContrast:e=te.e}const t=this._currentTheme===n.light?0:this._currentTheme===n.dark?1:this._currentTheme===n.highContrast?2:0,i=Object.assign(Object.assign(Object.assign({},$.Ks[t]),$.zw[t]),$.nY[t]);return Object.assign(Object.assign({},e),i)}getComponentActiveTheme(e,t=!1){var i;if(this._useFluentV9&&!t)return;const n=this._themes.get(e),s=M(null==n?void 0:n.get(this._currentTheme)),o=M(null==n?void 0:n.get(this._defaultTheme));return null!==(i=null!=s?s:o)&&void 0!==i?i:void 0}getComponentThemes(e){const t=this._themes.get(e);return t&&k(t)}updateDarkMode(e){this._isDarkMode=e,this.hostSettings.isDarkMode=e,this._currentTheme=e?n.dark:n.light,K(e?V.Dark:V.Light),this.publishEvent("currentThemeUpdated",this._currentTheme)}updateDefaultTheme(e){this._defaultTheme=e,this.publishEvent("defaultThemeUpdated",this._defaultTheme)}updateCurrentTheme(e){this._currentTheme=e,e===n.dark?K(V.Dark):K(V.Light),this.publishEvent("currentThemeUpdated",this._currentTheme)}updateComponentThemes(e,t){this._themes.set(e,k(t)),this.publishEvent("themesUpdated",{})}updateFluentThemes(e){this._fluentThemes.clear();for(const[t,i]of e)this._fluentThemes.set(t,i);this.publishEvent("fluentThemesUpdated",{})}getExpandedEccFluentTheme(){switch(this._currentTheme){case n.light:default:return ie.u;case n.dark:return ne.k}}};(0,P.__decorate)([O.observable],se.prototype,"_defaultTheme",void 0),(0,P.__decorate)([O.observable],se.prototype,"_currentTheme",void 0),(0,P.__decorate)([O.observable],se.prototype,"_themes",void 0),(0,P.__decorate)([O.observable],se.prototype,"_fluentThemes",void 0),(0,P.__decorate)([O.observable],se.prototype,"_isDarkMode",void 0),(0,P.__decorate)([O.observable],se.prototype,"_useFluentV9",void 0),(0,P.__decorate)([O.computed],se.prototype,"isDarkMode",null),(0,P.__decorate)([O.computed],se.prototype,"defaultTheme",null),(0,P.__decorate)([O.computed],se.prototype,"currentTheme",null),(0,P.__decorate)([O.computed],se.prototype,"components",null),(0,P.__decorate)([O.action],se.prototype,"updateDarkMode",null),(0,P.__decorate)([O.action],se.prototype,"updateDefaultTheme",null),(0,P.__decorate)([O.action],se.prototype,"updateCurrentTheme",null),(0,P.__decorate)([O.action],se.prototype,"updateComponentThemes",null),(0,P.__decorate)([O.action],se.prototype,"updateFluentThemes",null),se=(0,P.__decorate)([(0,z._)(),(0,P.__param)(0,(0,Y.W)(Z.n))],se);var oe=i(62876)},78737:(e,t,i)=>{i.d(t,{U:()=>u});var n=i(208171),s=i(146078),o=i(227710),r=i(659506),a=i(208520);const l=e=>{const t=(0,r.G)();return a.createElement(d,Object.assign({},e,{parentContainer:t}))};class d extends a.Component{constructor(e){super(e),this.state={injector:void 0}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){const e=s.z.createContainer(this.props.parentContainer),t=new n.E(e,this.rootInjector.generateModuleKey);this.props.onConfigureInjector(t),this.setState({injector:t})}render(){const{injector:e}=this.state;return e?a.createElement(n.r.Provider,{value:e},this.props.children):null}}d.contextType=o.S;class c extends a.Component{constructor(e){super(e),this.onConfigureInjector=e=>{e.addModule(this.props.value)},this.state={rootInjectorConfigured:!1}}get rootInjector(){if(!this.context)throw new Error("Component must be within RootInjector context");return this.context}componentDidMount(){this.onConfigureInjector(this.rootInjector),this.setState({rootInjectorConfigured:!0})}render(){return this.state.rootInjectorConfigured?a.createElement(l,{onConfigureInjector:this.onConfigureInjector},this.props.children):null}}c.contextType=o.S;class u extends a.PureComponent{constructor(e){var t;super(e),this.injector=null!==(t=e.injector)&&void 0!==t?t:new o.J,this.entryModule=e.entryModule}render(){return this.entryModule?a.createElement(o.S.Provider,{value:this.injector},a.createElement(c,{value:this.entryModule},this.props.children)):a.createElement(o.S.Provider,{value:this.injector},this.props.children)}}},78827:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(668952).f)("IEnabledCritiqueTypes")},83518:(e,t,i)=>{i.d(t,{k:()=>c});var n=i(379490),s=i(753031),o=i(46692),r=i(877931),a=i(118673),l=i(229906),d=i(83010);let c=class{constructor(e,t){this.logger=e,this.proofingEmitter=t,this.loggerEventName="AggregateEventCount",this.dataToLog={eventCountMap:{},metadata:{locales:[]}}}async initialize(){this.proofingEmitter.on("proofingLanguageChanged",(e=>{this.updateMetadata({locales:e.data.codesList.slice()})}))}incrementEventCount(e,t,i=1){var n,s,o;const r=null!==(n=(o=this.dataToLog.eventCountMap)[e])&&void 0!==n?n:o[e]={};null!==(s=r[t])&&void 0!==s||(r[t]=0),r[t]+=i}shutDown(){this.logger.logEvent(505447893,this.loggerEventName,s.q.Info,void 0,o.o.SamplingPolicy.Measure,this.dataToLog,void 0)}updateMetadata(e){this.dataToLog.metadata=Object.assign(Object.assign({},this.dataToLog.metadata),e)}};c=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(r.g)),(0,n.__param)(1,(0,d.W)(a.o))],c)},83605:(e,t,i)=>{i.d(t,{M:()=>n});const n=(0,i(668952).f)("INodeTraverser")},83807:(e,t,i)=>{if(i.d(t,{L:()=>d}),0!=i.j)var n=i(660458);if(0!=i.j)var s=i(256002);if(0!=i.j)var o=i(386311);if(0!=i.j)var r=i(585272);if(0!=i.j)var a=i(502653);if(0!=i.j)var l=i(556940);class d{constructor(e){this.params=e,this._initialized=!1,this._disposed=!1,this._elementId=null,this._textReaderInternal=null,this._internalLogger=null,this._disposeLegacy=null,this._handleTextChange=e=>{const{editor:t}=this.params;t.pushText(e.data,e.messageType)},this._handleTextStyleChange=()=>{const{editor:e}=this.params;e.textLayoutReset()},this._handleCritiqueReset=()=>{var e;null===(e=this._textReaderInternal)||void 0===e||e.refreshNodes()},this._handleTelemetryLog=e=>{const{editor:t}=this.params;t.submitTelemetryEvent({telemetryLog:e})},this._mapElement()}get disposed(){return this._disposed}get initialized(){return this._initialized}get elementId(){return this._elementId}async init(){var e,t,i;if(this._initialized)return;this._initialized=!0,await this._initLegacyReader();const{editor:n}=this.params;n.subscribe("reset",this._handleCritiqueReset),null===(e=this._textReaderInternal)||void 0===e||e.subscribe("textChange",this._handleTextChange),null===(t=this._textReaderInternal)||void 0===t||t.subscribe("styleChange",this._handleTextStyleChange),null===(i=this._textReaderInternal)||void 0===i||i.initialize()}async dispose(){if(this._disposed)return;this._disposed=!0;const{editor:e}=this.params;if(e.unsubscribe("reset",this._handleCritiqueReset),this._internalLogger&&(this._internalLogger.unsubscribe("telemetryLog",this._handleTelemetryLog),this._internalLogger.dispose(),this._internalLogger=null),this._textReaderInternal&&(this._textReaderInternal.unsubscribe("textChange",this._handleTextChange),this._textReaderInternal.unsubscribe("styleChange",this._handleTextStyleChange),await this._textReaderInternal.dispose(),this._textReaderInternal=null),this._disposeLegacy&&(await this._disposeLegacy(),this._disposeLegacy=null),this._elementId){const{elementManager:e}=this.params;e.removeElement(this._elementId)}}_mapElement(){const{target:e,elementManager:t}=this.params,i=t.getIdFromElement(e);if(i)return void(this._elementId=i);const n=(0,l.h)();this._elementId=n,t.addElement(n,e)}async _initLegacyReader(){var e;const{target:t,elementManager:i}=this.params,l=(0,a.JL)(new Map([[null!==(e=this._elementId)&&void 0!==e?e:"",t]])),d=(0,a.m1)(),c=(0,a.yy)(),u=(0,a.Xr)(),g=new n.c(d),h=null!==i.targetDocument.defaultView?new s.N(i.targetDocument.defaultView):void 0;this._internalLogger=new r.O,await this._internalLogger.initialize(),this._internalLogger.subscribe("telemetryLog",this._handleTelemetryLog),this._textReaderInternal=new o.r(t,l,d,c,u,g,!0,h,this._internalLogger.loggerInstance),this._disposeLegacy=async()=>{await l.dispose(),g.shutDown()}}}},86314:(e,t,i)=>{i.d(t,{cO:()=>d});var n=i(72715);class s{constructor(e,t){this.name=e,this.version=t}}class o{constructor(e){this.version=e,this.name="node"}}class r{constructor(){this.bot=!0,this.name="bot",this.version=null}}const a=3,l=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["vivaldi",/Vivaldi\/([0-9\.]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/Edg\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FBAV\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["searchbot",/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/]];function d(e){return e?c(e):navigator?c(navigator.userAgent):n.version?new o(n.version.slice(1)):null}function c(e){const t=""!==e&&l.reduce(((t,[i,n])=>{if(t)return t;const s=n.exec(e);return!!s&&[i,s]}),!1);if(!t)return null;const[i,n]=t;if("searchbot"===i)return new r;let o=n[1].split(/[._]/).slice(0,3);return o?o.length<a&&(o=[...o,...u(a-o.length)]):o=[],new s(i,o.join("."))}function u(e){const t=[];for(let i=0;i<e;i+=1)t.push("0");return t}},86439:(e,t,i)=>{function n(e){if(e){return/[^\u0000-\u007f]/.test(e)}return!1}i.d(t,{c:()=>n})},87492:(e,t,i)=>{i.d(t,{F:()=>a});var n=i(379490),s=i(229906),o=i(851840),r=i(122107);let a=class extends o.W{constructor(){super(),this.disablers=[],this.enablers=[!1]}openSettings(e){const t={eventId:r.d2.SettingsClicked,sender:e};this.emitAndEvaluate(t)}};a=(0,n.__decorate)([(0,s._)()],a)},89609:(e,t,i)=>{if(i.d(t,{BO:()=>a,WS:()=>o,bL:()=>r,e$:()=>s,fR:()=>l}),0!=i.j)var n=i(852853);const s=({isFullWidth:e})=>({backgroundColor:n.L.colorNeutralBackground1,width:"100%",maxWidth:e?void 0:592,overflow:"hidden"}),o=()=>({marginRight:n.L.spacingHorizontalS,marginLeft:n.L.spacingHorizontalS,marginTop:n.L.spacingVerticalS,marginBottom:n.L.spacingVerticalS}),r=()=>({display:"flex",flexDirection:"column",alignItems:"center"}),a=()=>({paddingLeft:n.L.spacingHorizontalM,paddingRight:n.L.spacingHorizontalM}),l=()=>({color:n.L.colorBrandForegroundLink,textDecoration:"underline",cursor:"pointer"})},90393:(e,t,i)=>{var n;i.d(t,{N:()=>n}),function(e){e[e.GENERIC=0]="GENERIC",e[e.OFFICE=1]="OFFICE",e[e.SVG=2]="SVG"}(n||(n={}))},93469:(e,t,i)=>{i.d(t,{DH:()=>r,LY:()=>s,WL:()=>a,ZX:()=>l,ri:()=>o});const n=0!=i.j?["","@","/","#"]:null;function s(e){return!!n.find((t=>t===e))}function o(e){return"char"===e.type}function r(e){switch(e.type){case"char":return e.triggerChar;case"event":return e.eventId;default:throw new Error(`Unhandled trigger type: ${JSON.stringify(e)}`)}}const a=(e,t)=>e.trim()===t.trim(),l=e=>({wordCount:e.split(/\s+/).filter(Boolean).length,length:e.length})},93659:(e,t,i)=>{if(i.d(t,{K2:()=>o,Pe:()=>s,Sg:()=>a,ug:()=>r}),0!=i.j)var n=i(225918);const s=e=>{const t=e;return void 0!==t.x&&void 0!==t.y},o=e=>{const t=e;return void 0!==t.left&&void 0!==t.top&&void 0!==t.width&&void 0!==t.height};function r(e){if(e)return o(e)?{getBoundingClientRect:()=>{var t,i;return{x:e.left,y:e.top,top:e.top,left:e.left,bottom:null!==(t=e.bottom)&&void 0!==t?t:0,right:null!==(i=e.right)&&void 0!==i?i:0,width:e.width,height:e.height}}}:s(e)?{getBoundingClientRect:()=>({x:e.x,y:e.y,top:e.y,left:e.x,bottom:e.y,right:e.x,width:0,height:0})}:e}function a(e){if(void 0===e)return{position:"below",align:"start"};switch(e){case n.A.topLeftEdge:return{position:"above",align:"start"};case n.A.topCenter:case n.A.topAutoEdge:return{position:"above",align:"center"};case n.A.topRightEdge:return{position:"above",align:"end"};case n.A.bottomLeftEdge:return{position:"below",align:"start"};case n.A.bottomCenter:case n.A.bottomAutoEdge:return{position:"below",align:"center"};case n.A.bottomRightEdge:return{position:"below",align:"end"};case n.A.leftTopEdge:return{position:"before",align:"top"};case n.A.leftCenter:return{position:"before",align:"center"};case n.A.leftBottomEdge:return{position:"before",align:"bottom"};case n.A.rightTopEdge:return{position:"after",align:"top"};case n.A.rightCenter:return{position:"after",align:"center"};case n.A.rightBottomEdge:return{position:"after",align:"bottom"}}}},95749:(e,t,i)=>{function n(e){var t,i,n,s,o,r,a;const{oaSettings:l,serviceSettings:d,hostMetadata:c}=e,{flagAnnotationSettings:u,nudge:g,predictions:h}=null!=d?d:{};return{ecc:{enabled:null!==(t=null==l?void 0:l.isContextualCardEnabled)&&void 0!==t&&t,entities:null==l?void 0:l.entitiesEnabled,bestMatch:null==l?void 0:l.bestMatchConfig,scopes:(null==l?void 0:l.scopesConfig)&&{entities:l.scopesConfig.entities,enabled:l.scopesConfig.enabled,maxResults:l.scopesConfig.maxResults}},flag:{enabled:null!==(i=null==u?void 0:u.enabled)&&void 0!==i&&i,entities:null!==(n=null==u?void 0:u.entityConfigs)&&void 0!==n?n:[]},nudge:{enabled:null!==(s=null==g?void 0:g.enabled)&&void 0!==s&&s,entities:null!==(o=null==g?void 0:g.entityConfigs)&&void 0!==o?o:[]},prediction:{enabled:null!==(r=null==h?void 0:h.enabled)&&void 0!==r&&r,entities:null!==(a=null==h?void 0:h.entityConfigs)&&void 0!==a?a:[],enableMiddleOfSentencePredictions:null==h?void 0:h.allowMiddleOfSentencePredictions,enableMultiPredict:null==h?void 0:h.enableMultiPredict},metadata:{appScenario:null==c?void 0:c.appScenario}}}i.d(t,{e:()=>n})},96668:(e,t,i)=>{if(i.d(t,{J:()=>a}),0!=i.j)var n=i(523769);if(0!=i.j)var s=i(541647);if(0!=i.j)var o=i(188835);if(0!=i.j)var r=i(251439);class a{constructor(){this.imports=[n.$,o.k]}get uniqueId(){return(0,r.z)(507918337)}configureRootServices(e){e.bind(s.Q).toDynamicValue((e=>()=>e.getOptional(s.C)))}}},102998:(e,t,i)=>{i.d(t,{Z:()=>l});var n=i(379490),s=i(818955),o=i(229906),r=i(83010),a=i(436672);let l=class extends a.t{constructor(e){super(e)}checkUserInfo(){return!!this.isLoggedIn}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.e))],l)},104072:(e,t,i)=>{i.d(t,{d:()=>n});const n=(0,i(668952).f)("ITileContent")},104836:(e,t,i)=>{i.d(t,{D:()=>D});var n=i(379490),s=i(787924),o=i(753031),r=i(46692),a=i(105244),l=i(42568);const d="NumProofingLanguages";var c=i(442316),u=i(922630),g=i(233653),h=i(359310),p=i(489009),m=i(177929);class f{constructor(e,t,i,n,s,a,l=window){this._logger=e,this._eventName=i,this._logToTelemetry=s,this._onTimeout=a,this._onCommitMeasure=e=>{this._logToTelemetry(e.measures,e.correlationKeys,e.customData,e.eventName)},this._onCoreTimeout=e=>{var t;if(this._onTimeout){const i=(null===(t=e.customData)||void 0===t?void 0:t.length)?e.customData[0]:void 0;this._onTimeout(e.id,e.storedCorrelationKeys,i)}},this._onErrorEntryNotFound=e=>{this._logger.logEvent(505436036,p.f.TelemetryError,o.q.Error,`Unable to find performance entry by name: ${e.entryName}`,r.o.SamplingPolicy.CriticalExperimentation)},this._onErrorAddingCheckpoint=e=>{this._logger.logEvent(505436035,p.f.TelemetryError,o.q.Error,`Error while adding a checkpoint measure to a telemetry entry, error: ${e.errorCaught}`,r.o.SamplingPolicy.CriticalExperimentation)},this._onErrorCommitMeasure=e=>{this._logger.logEvent(505436034,p.f.TelemetryError,o.q.Error,`Error while commiting a telemetry entry, error: ${e.errorCaught}`,r.o.SamplingPolicy.CriticalExperimentation)},this._metricCore=new m.c(l,t,i,n),this._metricCore.subscribe("errorEntryNotFound",this._onErrorEntryNotFound),this._metricCore.subscribe("errorAddingCheckpoint",this._onErrorAddingCheckpoint),this._metricCore.subscribe("errorCommitMeasure",this._onErrorCommitMeasure),this._metricCore.subscribe("commitMeasure",this._onCommitMeasure),this._metricCore.subscribe("timeout",this._onCoreTimeout)}dispose(){this._metricCore.unsubscribe("errorEntryNotFound",this._onErrorEntryNotFound),this._metricCore.unsubscribe("errorAddingCheckpoint",this._onErrorAddingCheckpoint),this._metricCore.unsubscribe("errorCommitMeasure",this._onErrorCommitMeasure),this._metricCore.unsubscribe("commitMeasure",this._onCommitMeasure),this._metricCore.unsubscribe("timeout",this._onCoreTimeout)}startEntry(e,t,i){this._metricCore.startEntry(e,t,i)}addMeasure(e,t,i){this._metricCore.addMeasure(e,t,i)}commitEntry(e,t=this._eventName,i){this._metricCore.commitEntry(e,t,i)}setOnTimeout(e){this._onTimeout=e}}var v=i(668952),y=i(229906),_=i(83010);const I=(0,v.f)("IE2eMetric");let C=class{constructor(e,t,i,n){var s;this._logger=e,this._hostSettings=t,this._proofingStore=i,this._eventName="End2EndTelemetry",this._alEventName="IsAL",this._performanceApiGarbageCollectorIntervalInMs=1e4,this._logToTelemetry=e=>{const t=this._logger.getNewActivity(this._eventName,r.o.SamplingPolicy.CriticalExperimentation);if(!t)return;const i=this._proofingStore.getCachedEntry(a.l.ProofingLanguages).storeEntryValue;t.dataFields.push(...e.map((e=>(0,l.n)(e.name,e.duration,void 0,r.o.DataFieldType.Double.valueOf())))),t.dataFields.push(...(0,l.W)([this._alEventName,this._isAlEnabled],[d,i.length])),t.success=!0,t.endNow()},this._isAlEnabled=!0===this._hostSettings.enableOrchestration&&!0===(null===(s=this._hostSettings.orchestratorSettings)||void 0===s?void 0:s.enableAugLoop),this.metric=new f(e,n,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry)}startEntry(e){this._hostSettings.enableE2eMetric&&this.metric.startEntry(e)}addMeasure(e,t,i){this._hostSettings.enableE2eMetric&&this.metric.addMeasure(e,t,i)}commitEntry(e,t=this._eventName){this._hostSettings.enableE2eMetric&&this.metric.commitEntry(e,t)}setOnTimeout(e){this.metric.setOnTimeout(e)}};C=(0,n.__decorate)([(0,y._)(),(0,n.__param)(0,(0,_.W)(c.g)),(0,n.__param)(1,(0,_.W)(u.n)),(0,n.__param)(2,(0,_.W)(g.K)),(0,n.__param)(3,(0,_.W)(h.j))],C);var S,b=i(823325),T=i(118673),E=i(609062);!function(e){e.StorageUserInfoV2Strategy="StorageUserInfoV2Strategy",e.None="None"}(S||(S={}));const N=(0,v.f)("IUserInfoStrategy");var w=i(335009),x=i(538045),L=i(272512);let D=class{constructor(e,t,i,n,a,l,d,c){this._proofingDom=e,this._proofingEmitter=t,this._nodePoller=i,this._proofingPersistedStore=n,this._hostSettings=a,this._userInfoStrategy=l,this._logger=d,this._e2eMetric=c,this._websiteProvedOnce=!1,this.onCritiqueEvent=e=>{try{this._detectWebSiteProved(e),this.updateCritiques(e)}catch(e){this._logger.logEvent(536978384,s.s.UpdateCritiqueException,o.q.Error,"Error while updating critiques on the shadow graph.",r.o.SamplingPolicy.CriticalBusinessImpact,e)}},this.updateCritiques=e=>{const t=e.data,i=new Map,n=[],s=new Set;for(const e of t){if(!e.tileId)continue;const t=e.tileId.elementId.id;s.has(t)||(this._e2eMetric.commitEntry(t),s.add(t));const o=i.get(e.tileId.nodeId);if(o)o.push(e);else{i.set(e.tileId.nodeId,[e]);const t=this._proofingDom.findTileNode(e.tileId.nodeId);t&&n.push(t)}}n.length&&this._nodePoller.pollNodes(b.G.NewData,n,E.Q0.Code,void 0,!1,i)}}async initialize(){this._proofingEmitter.on("critiqueEvent",this.onCritiqueEvent)}shutDown(){}_detectWebSiteProved(e){!this._websiteProvedOnce&&e.messageType===b.G.NewData&&e.data&&e.data.length&&(this._websiteProvedOnce=!0,(0,L.Q)(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}};D=(0,n.__decorate)([(0,y._)(),(0,n.__param)(0,(0,_.W)(x.w)),(0,n.__param)(1,(0,_.W)(T.o)),(0,n.__param)(2,(0,_.W)(w.G)),(0,n.__param)(3,(0,_.W)(g.K)),(0,n.__param)(4,(0,_.W)(u.n)),(0,n.__param)(5,(0,_.W)(N)),(0,n.__param)(6,(0,_.W)(c.g)),(0,n.__param)(7,(0,_.W)(I))],D)},105244:(e,t,i)=>{var n;i.d(t,{l:()=>n}),function(e){e.AppId="appId",e.EnableCopilotInsert="enableCopilotInsert",e.EnableCopilotRewrite="enableCopilotRewrite",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.EnableSynonymsToggle="enableSynonymsToggle",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.HashedUserDictionary="hashedUserDictionary",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.OverriddenInlineEditingSettings="overriddenInlineEditingSettings",e.PaneOverriddenCritiqueTypeOptions="paneOverriddenCritiqueTypeOptions",e.StealthOverriddenCritiqueTypeOptions="stealthOverriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.DefaultLoggingLevel="defaultLoggingLevel",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId",e.CritiqueValuePerLanguage="critiqueValuePerLanguage",e.EnableTextPrediction="enableTextPrediction",e.EnableCIQFlags="enableCIQFlags",e.EnableCIQMenu="enableCIQMenu",e.IsLanguageAutoDetectEnabled="isLanguageAutoDetectEnabled",e.TonalFREAccepted="tonalFREAccepted"}(n||(n={}))},105815:(e,t,i)=>{i.d(t,{K:()=>n});i(220029);const n=(0,i(668952).f)("ReactComponentModules")},106463:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"বানান","IsImplemented":true}}')},106623:(e,t,i)=>{i.d(t,{B:()=>T,U:()=>E});var n=i(379490),s=i(67573),o=i(823325),r=i(537969),a=i(756857),l=i(279e3),d=i(937126),c=i(826663),u=i(392632),g=i(331408),h=i(163573),p=i(877931),m=i(576516),f=i(538045),v=i(955377),y=i(157698),_=i(965285),I=i(229906),C=i(66008),S=i(83010),b=i(427603);let T=class extends _.H{constructor(e,t,i,n,r,a,l,d,c,u){super(e,t,i,n,a,l,d,u),this._localizer=r,this._paragraphTextExtractor=c,this.onFlagAnnotationUpdate=e=>{var t,i,n;const r=e.message.messageType,a=e.message.data;if(r===o.G.NewData&&a.results.length>0){const n=a.results.filter((e=>"GraphSearch"===e.ownerId));if(E(this._hostSettings)){const o=n.filter((e=>e.results[0].entityType===m.c.File)),r=[];for(const e of o){const n={entities:e.results,entityType:m.c.File,groupTitle:this._localizer.getMessage("fileEntityLabel")},o=this._paragraphTextExtractor.getParagraphText(a.tileId),l=null!==(t=e.context)&&void 0!==t?t:null==o?void 0:o.substring(e.range.start,e.range.start+e.range.length),d=a.annotationId+(null===(i=e.M_)||void 0===i?void 0:i.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(a.annotationId);e||(e=new Set),e.add(d)}l&&r.push({annotationId:d,traceId:d,languageId:e.language,nodeId:a.tileId,nodeVersion:a.tileVersion,textInContext:l,start:e.range.start,length:e.range.length,supportedActions:s.lb.Ignore,supportedEntityTypes:[m.c.File],suggestionItems:[n],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagFileTooltipTitle")})}this.addFlags(e.address,r)}}else if(r===o.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(a.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,a.annotationId)}},this.onApplyFlag=(e,t,i,n)=>{var s,o;if(!t.annotationId)return;this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return g.L9.CIQFlag_File}};function E(e){var t,i;return(0,u.f1)(e.flightsToTrack,null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,m.c.File,"mc-editor-oa-files-flag")}T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.t)(r.zJ)),(0,n.__param)(1,(0,S.W)(h.n)),(0,n.__param)(2,(0,S.W)(f.w)),(0,n.__param)(3,(0,S.W)(p.g)),(0,n.__param)(4,(0,S.W)(a.H)),(0,n.__param)(5,(0,S.W)(l.$)),(0,n.__param)(6,(0,S.W)(v.W)),(0,n.__param)(6,(0,b.l)()),(0,n.__param)(7,(0,S.W)(d.f)),(0,n.__param)(8,(0,S.W)(y.b)),(0,n.__param)(9,(0,b.l)()),(0,n.__param)(9,(0,S.W)(c.K))],T)},107500:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Prägnanz","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Konsistente Schreibformen","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Neutrale Sprache"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Tippfehler"},"Clarity":{"IsImplemented":true,"LocalizedName":"Verständlichkeit"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Akronyme"},"Rewrite":{"IsImplemented":false,"LocalizedName":"Umschreibung"},"Error Corrections":{"LocalizedName":"Fehlerkorrigierungen","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Wortwahl","IsImplemented":true},"Grammar":{"LocalizedName":"Grammatik","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Formelle Sprache"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Interpunktion","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Schreibkonventionen"},"Spelling":{"LocalizedName":"Rechtschreibung","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Lebenslauf"},"Sensitive Geopolitical References":{"LocalizedName":"Problematische geopolitische Bezeichnungen","IsImplemented":true}}')},107613:(e,t,i)=>{i.d(t,{A:()=>s});var n=i(208520);const s=e=>{const{enableAriaStatusInNonRootIFrames:t,politeUpdates:i,assertiveUpdates:s,status:o,statusSeverity:r}=e,a={width:0,height:0,color:"transparent",background:"none",border:"none",outline:"none",overflow:"hidden",pointerEvents:"none"};return window.self===window.top||t?n.createElement(n.Fragment,null,o&&n.createElement("div",{role:"status","aria-live":r,"aria-label":o,style:a}),0!==s.length&&n.createElement("div",{role:"log","aria-live":"assertive",style:a},s),0!==i.length&&n.createElement("div",{role:"log","aria-live":"polite",style:a},i)):null}},108520:(e,t,i)=>{if(i.d(t,{A:()=>s}),0!=i.j)var n=i(736416);class s{constructor(e,t){this._isOptional=!1,this._injectionIdentifier=e,this._isArray=t}static on(e){return new s(e,!1)}static onAll(e){return new s(e,!0)}optional(){return this._isOptional=!0,this}build(){return new n.o(this._injectionIdentifier,this._isOptional,this._isArray)}}},108993:(e,t,i)=>{i.d(t,{qy:()=>s});var n=i(668952);(0,n.f)("IOnCanvasKpiHelper"),(0,n.f)("ILoggerSettings"),(0,n.f)("IEditorSdkLogger"),(0,n.f)("IKpiTracker");const s=(0,n.f)("TelemetrySink")},111791:(e,t,i)=>{i.d(t,{F:()=>n});const n=(0,i(668952).f)("IPaneOpenState")},112533:(e,t,i)=>{if(i.d(t,{k:()=>r}),0!=i.j)var n=i(821003);if(0!=i.j)var s=i(251439);if(0!=i.j)var o=i(851600);class r{get uniqueId(){return(0,s.z)(507917961)}configureRootServices(e){e.bind(n.J).to(o.I)}}},112874:(e,t,i)=>{i.d(t,{L:()=>d});var n=i(379490),s=i(522674),o=i(229906),r=i(83010),a=i(818955),l=i(460855);let d=class{constructor(e,t,i){this.baseOTelLogger=new l.G(e,t,i)}async initialize(e,t,i,n,s,o){await this.baseOTelLogger.initialize(e,t,i,n,s,o)}logEvent(e,t,i,n,s,o,r){this.baseOTelLogger.logEvent(e,t,i,n,s,o,r)}getNewActivity(e,t,i){return this.baseOTelLogger.getNewActivity(e,t,i)}addCorrelationID(e){this.baseOTelLogger.addCorrelationID(e)}sendLog(e,t,i,n,s,o,r){this.baseOTelLogger.sendLog(e,t,i,n,s,o,r)}};d=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.qy)),(0,n.__param)(1,(0,r.W)(s.k_)),(0,n.__param)(2,(0,r.W)(a.e))],d)},112932:(e,t,i)=>{function n(e){const t=e.reduce(((e,{entityType:t,entities:i})=>(e[t]=(e[t]||0)+i.length,e)),{});return{suggestionsCount:e.reduce(((e,{entities:t})=>e+t.length),0),suggestionGroupsCount:e.length,entityTypesCount:JSON.stringify(t)}}i.d(t,{L:()=>n})},116102:(e,t,i)=>{i.d(t,{p:()=>n});const n=(0,i(668952).f)("IEnabledPremiumCritiqueTypes")},117862:(e,t,i)=>{if(i.d(t,{I:()=>h}),0!=i.j)var n=i(963116);if(0!=i.j)var s=i(104836);if(0!=i.j)var o=i(918770);if(0!=i.j)var r=i(636234);if(0!=i.j)var a=i(695257);if(0!=i.j)var l=i(251439);if(0!=i.j)var d=i(206264);if(0!=i.j)var c=i(386675);if(0!=i.j)var u=i(781729);if(0!=i.j)var g=i(835113);class h{constructor(){this.imports=[a.l]}get uniqueId(){return(0,l.z)(507908323)}configureRootServices(e){e.bind(d.B).to(n.C),e.bind(c.S).toExisting(d.B),e.bind(r.v).toSelf(),e.bind(c.S).to(s.D),e.bind(c.S).to(o.n),e.bind(c.S).toExisting(u.s),e.bind(u.s).to(g.H)}}},117996:(e,t,i)=>{i.d(t,{G:()=>a});var n=i(379490);var s=i(229906),o=i(83010),r=i(439550);let a=class{constructor(e){this._browserStorage=e,this.registrations={},this.eventNamesUsed=new Set,this._storageChangeDispatcherCallback=async(e,t)=>this._storageChangeDispatcher(e,t)}safelyGetRegistration(e){return this.registrations[e]||(this.registrations[e]={listeners:[]}),this.registrations[e]}on(e,t){this.safelyGetRegistration(e).listeners.push(t),this.eventNamesUsed.add(e)}async initialize(){this._browserStorage.addChangeListener(this._storageChangeDispatcherCallback)}shutDown(){this._browserStorage.removeEventListener(this._storageChangeDispatcherCallback);for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}_storageChangeDispatcher(e,t){for(const t of Object.keys(e)){const i=JSON.parse(e[t].oldValue),n=JSON.parse(e[t].newValue);(null==i?void 0:i.value)!==(null==n?void 0:n.value)&&this.callListeners(t,e[t].newValue)}}callListeners(e,t){const i=e,n=this.safelyGetRegistration(i);for(const e of n.listeners)e(t)}onFirst(e,t){throw Error("onFirst is not implemented for SettingsEmitter")}onAny(e){throw Error("onAny is not implemented for SettingsEmitter")}async waitFor(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}async waitForFirst(e){throw Error("waitForFirst is not implemented for SettingsEmitter")}off(e,t){if(void 0===e)return void(this.registrations={});if(void 0===t)return void(this.registrations[e]={listeners:[]});if(!((e,t)=>{let i=!1;for(let n=0;n<e.length;n+=1)e[n]===t&&(i=!0,e.splice(n,1),n-=1);return i})(this.safelyGetRegistration(e).listeners,t))throw new Error(`Tried to remove a non-existent listener for event name '${e}'.`)}emit(e,...t){const i=this.safelyGetRegistration(e);for(const e of i.listeners)e(...t)}};a=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.D))],a)},118673:(e,t,i)=>{i.d(t,{o:()=>n});const n=(0,i(668952).f)("IProofingEmitter")},119427:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(668952).f)("IAggregateLogger")},120733:(e,t,i)=>{if(i.d(t,{E:()=>a,Z:()=>r}),0!=i.j)var n=i(842117);var s=i(208520);const o=(0,s.createContext)(null),r=({store:e,children:t})=>s.createElement(o.Provider,{value:e},t),a=e=>(0,n.P)((()=>{const e=(0,s.useContext)(o);if(!e)throw new Error("useMenuStateStore must be used within a StoreProvider");return e})(),(t=>t[e]))},122107:(e,t,i)=>{i.d(t,{In:()=>r,d2:()=>n,kY:()=>s});var n,s,o=i(668952);!function(e){e[e.SettingsClicked=0]="SettingsClicked"}(n||(n={})),function(e){e[e.dropdown=0]="dropdown",e[e.languageDetectionNotificationBar=1]="languageDetectionNotificationBar",e[e.toneRewriteFre=2]="toneRewriteFre",e[e.multilingualFooterFre=3]="multilingualFooterFre",e[e.manageLanguages=4]="manageLanguages"}(s||(s={}));const r=(0,o.f)("IExternalSettingsFeature")},122336:(e,t,i)=>{i.d(t,{B:()=>a,Y:()=>r});var n=i(379490),s=i(668952),o=i(229906);const r=(0,s.f)("IParagraphNodeDictionary");let a=class{};a=(0,n.__decorate)([(0,o._)()],a)},123739:(e,t,i)=>{i.d(t,{C:()=>n});const n=(0,i(668952).f)("ITransportActivity")},136939:(e,t,i)=>{i.d(t,{p:()=>c});i(220029);if(0!=i.j)var n=i(797452);if(0!=i.j)var s=i(227710);if(0!=i.j)var o=i(303610);if(0!=i.j)var r=i(198596);if(0!=i.j)var a=i(163573);if(0!=i.j)var l=i(105815);if(0!=i.j)var d=i(522674);const c=(e,t,i,c,u,g,h)=>{const p=new s.J(t.generateModuleKey),m=p.container;m.bind(o.p).toValue(m),m.bind(o.k).toValue(m.resolveNew),m.bind(s.J).toValue(p),m.bind(r.y).toValue(e),m.bind(a.n).toValue(t),m.bind(l.K).toValue(g),i&&m.bind(n.P).toValue(i),null==h||h(m),"configureRootServices"in c?p.addModule(c):m.bind(d.qy).toValue(c);for(const e of u)p.addModule(e);return p}},137464:(e,t,i)=>{function n(e){return e instanceof Error?JSON.stringify(e,["name","message","stack"]):JSON.stringify(e)}i.d(t,{v:()=>n})},137773:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Zwięzłość"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Spójność zapisu"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Język równościowy","IsImplemented":true},"Typing errors":{"LocalizedName":"Literówki","IsImplemented":false},"Clarity":{"LocalizedName":"Przejrzystość","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Przeformułowanie"},"Error Corrections":{"LocalizedName":"Korekta błędów","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Słownictwo"},"Grammar":{"LocalizedName":"Gramatyka","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Język literacki","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Interpunkcja","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Konwencje zapisu"},"Spelling":{"IsImplemented":true,"LocalizedName":"Pisownia"},"Resume":{"LocalizedName":"Życiorys","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Poprawność geopolityczna","IsImplemented":false}}')},137796:(e,t,i)=>{i.d(t,{g:()=>c});var n=i(379490),s=i(719249),o=i(904196),r=i(383714),a=i(326323),l=i(229906),d=i(83010);let c=class{constructor(e,t,i){this.isEnabled=!0,this.graphSearchLocalAnnotationListener=new s.N(e,t,i)}onInitialize(){}register(e,t){}unregister(){}createAnnotationListener(){return this.graphSearchLocalAnnotationListener}onSessionReconnected(){}onDocumentCreated(){}};c=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(o.n)),(0,n.__param)(1,(0,d.W)(r.g)),(0,n.__param)(2,(0,d.W)(a.J))],c)},138697:(e,t,i)=>{i.d(t,{x:()=>n});const n=(0,i(668952).f)("IUndoCalloutStateStoreBase")},139052:(e,t,i)=>{if(i.d(t,{u:()=>q}),0!=i.j)var n=i(19952);if(0!=i.j)var s=i(653196);if(0!=i.j)var o=i(862220);if(0!=i.j)var r=i(146507);if(0!=i.j)var a=i(692551);if(0!=i.j)var l=i(112874);if(0!=i.j)var d=i(319968);if(0!=i.j)var c=i(522674);if(0!=i.j)var u=i(852748);if(0!=i.j)var g=i(590974);if(0!=i.j)var h=i(123739);if(0!=i.j)var p=i(877931);if(0!=i.j)var m=i(215926);if(0!=i.j)var f=i(163573);if(0!=i.j)var v=i(118673);if(0!=i.j)var y=i(771588);if(0!=i.j)var _=i(715604);if(0!=i.j)var I=i(435143);if(0!=i.j)var C=i(87492);if(0!=i.j)var S=i(122107);if(0!=i.j)var b=i(537969);if(0!=i.j)var T=i(184226);if(0!=i.j)var E=i(386675);if(0!=i.j)var N=i(592568);if(0!=i.j)var w=i(270793);if(0!=i.j)var x=i(907142);if(0!=i.j)var L=i(102998);if(0!=i.j)var D=i(533622);if(0!=i.j)var A=i(251439);if(0!=i.j)var F=i(86314);class q{constructor(){this.imports=[n.U]}get uniqueId(){return(0,A.z)(505680980)}configureRootServices(e){e.bind(y.V).to(I.w),e.bind(b.M5).to(_.N),e.bind(E.S).toExisting(b.M5),e.bind(b.zJ).toExisting(b.M5),e.bind(v.o).to(_.N),e.bind(E.S).toExisting(v.o),e.bind(u.G).to(a.L),e.bind(l.L).toSelf(),e.bind(g.l).toExisting(l.L),e.bind(h.C).toExisting(l.L),e.bind(p.g).to(d.V);const t=new s.a,i=e.getOptional(c.qy);if(i){const{logGroupName:n,tenant:s,logToConsole:a,logToKusto:l}=t,d=new o.V({logGroupName:n,tenant:s,defaultEventName:"",logToConsole:a,logToKusto:l},i,!0);(0,r.L)(d),e.bind(c.ZL).toValue(d)}e.bind(c.k_).toValue(t),e.bind(T.aP).toValue((()=>e.getOptional(T.iw))),e.bind(x.r).toSelf(),e.bind(S.In).to(C.F),e.bind(N.Zp).to(D.K),e.bind(L.Z).toSelf(),e.bind(w.tq).to(w.Gv),e.bind(m.a).toDynamicValue((e=>{let t;const i=e.get(f.n);return async()=>t?Promise.resolve(t):new Promise((n=>{var s,o,r,a,l,d;const c=(0,F.cO)();t={os:void 0,arch:void 0,browserType:null!==(s=null==c?void 0:c.name)&&void 0!==s?s:"",browserVersion:null!==(o=null==c?void 0:c.version)&&void 0!==o?o:null,extensionStoreId:"",languageUxId:"",extensionVersion:"",extensionVersionName:"",sessionId:null!==(a=null===(r=i.hostMetadata)||void 0===r?void 0:r.sessionId)&&void 0!==a?a:e.get(u.G).generate(),composeSessionId:null!==(d=null===(l=i.hostMetadata)||void 0===l?void 0:l.composeSessionId)&&void 0!==d?d:e.get(u.G).generate()},n(t)}))}))}}},140649:(e,t,i)=>{i.d(t,{C:()=>o});var n=i(379490),s=i(229906);let o=class{retrieveElements(e,t){if(!e.querySelectorAll)return[];const i=t.join(",");return e.querySelector(i)?Array.from(e.querySelectorAll(i)):[]}};o=(0,n.__decorate)([(0,s._)()],o)},140969:(e,t,i)=>{function n(e,t){return e===t||s(e.bottom,t.bottom)&&s(e.height,t.height)&&s(e.left,t.left)&&s(e.right,t.right)&&s(e.top,t.top)&&s(e.width,t.width)}function s(e,t,i=.01){return Math.abs(e-t)<i}i.d(t,{a:()=>n})},141381:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Spelling"}}')},142713:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"ବନାନ୍","IsImplemented":true}}')},146078:(e,t,i)=>{if(i.d(t,{z:()=>o}),0!=i.j)var n=i(956844);if(0!=i.j)var s=i(425811);class o{static createContainer(e){return e?e.createChildContainer():(0,n.n)()}clear(){this.container.unbindAll(),this.addedModuleKeys.clear(),this._addedModuleClassNames.clear(),this._modulesSharingSameModuleKeyButDifferentClassname.clear()}constructor(e,t){this.addedModuleKeys=new Set,this._addedModuleClassNames=new Set,this._modulesSharingSameModuleKeyButDifferentClassname=new Set,this.container=e,this.generateModuleKey=t}get addedModuleClassNames(){return this._addedModuleClassNames}get modulesSharingSameModuleKeyButDifferentClassname(){return this._modulesSharingSameModuleKeyButDifferentClassname}addModule(e){var t;const i="function"!=typeof e?e.constructor.name:e.name,n=this.getModuleKey(e);if(this.addedModuleKeys.has(n))return void(this._addedModuleClassNames.has(i)||this._modulesSharingSameModuleKeyButDifferentClassname.add(i));this._addedModuleClassNames.add(i),this.addedModuleKeys.add(n);const s=this.getModuleInstance(e);this.addModules(null!==(t=s.imports)&&void 0!==t?t:[]),this.onAddModule(s)}addModules(e){for(const t of e)t&&(Array.isArray(t)?this.addModules(t):this.addModule(t))}bindProvidersToContainer(e,t){for(const i of t)if(i)if((0,s.C)(i))e.isBound(i)||e.bind(i).toSelf();else{const t=i.provide;if(!i.multiple&&e.isBound(t))throw new Error(`Duplicate provider type: ${String(t)}`);if("useClass"in i)e.bind(t).to(i.useClass);else if("useDynamicValue"in i)e.bind(t).toDynamicValue(i.useDynamicValue);else if("useExisting"in i)e.bind(t).toExisting(i.useExisting);else{if(!("useValue"in i))throw new Error("Unknown provider type");e.bind(t).toValue(i.useValue)}}}getModuleKey(e){var t,i;const n=this.getModuleInstance(e);return n.uniqueId?n.uniqueId:e instanceof Function&&null!==(i=null===(t=this.generateModuleKey)||void 0===t?void 0:t.call(this,e))&&void 0!==i?i:e}getModuleInstance(e){return e instanceof Function?new e:e}}},146507:(e,t,i)=>{i.d(t,{C:()=>l,L:()=>a});var n=i(42464),s=i(37615);const o=new class{constructor(e=!1){this.useConsoleLogger=e,this._consoleLogger=new s.C({logToConsole:!0})}logEvent(e,t,i,n,s,o,r,a){const l=`${i}.${t}`;this.useConsoleLogger&&this._consoleLogger.logData({message:l,data:s})}logKpi(e,t,i,n,s){const o=`KPIs.${e}`;this.useConsoleLogger&&this._consoleLogger.logData({kpiEvent:`${o}.${t}`,engagement:i,data:s})}logStandaloneMetric(e,t,i,n,s){this.useConsoleLogger&&this._consoleLogger.logData({standaloneMetric:e})}createActivity(e,t){const i=`${t}.${e}`;return this.useConsoleLogger&&this._consoleLogger.logData({activity:i}),{cv:new n.CV(""),setResult:()=>{},endNow:()=>{},createChildActivity:()=>{throw new Error("Not implemented")},telemetryProperties:{},dataFields:[],eventName:"",eventFlags:{}}}};let r;function a(e){r=e}function l(){return r||o}},147090:(e,t,i)=>{if(i.d(t,{u:()=>s}),0!=i.j)var n=i(419728);function s(e){return(0,n.isObservableArray)(e.EmailAddresses)||Array.isArray(e.EmailAddresses)?e.EmailAddresses[0]:e.EmailAddresses}},150099:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(668952).f)("ISafeWindow")},150231:(e,t,i)=>{if(i.d(t,{cl:()=>r,nv:()=>l}),0!=i.j)var n=i(692551);if(0!=i.j)var s=i(959994);if(0!=i.j)var o=i(270935);const r=(0,i(668952).f)("HostCallbacksTransformer");class a{constructor(e,t,i,n,s,o){this.hostCallbacksCustomizations=(e,t)=>e,this.hostSettings=e,this.descriptorManager=t,this.telemetrySink=i,this.logger=n,this.clientRuntime=s,this.aggregateLogger=o}withHostCallbacksCustomizations(e){return this.hostCallbacksCustomizations=t=>{let i=t;for(const t of e)i=t(i,this);return i},this}async build(e,t){try{const e=await this.createClientMetadata(),i=this.hostCallbacksCustomizations(this.createHostCallbacks(),this),n=this.createRuntimeOptions();await this.runPreRuntimeInit(e,n),await this.initClientRuntime(e,i,n);return{session:await this.createSession(t),runtime:this.clientRuntime}}catch(e){return this.logger.error(507392469,"Initializing augloop session runtime failed",e),{}}}logAnnotationResultOperation(e){var t;const i=s.h.getTypeNameFor(e);null===(t=this.aggregateLogger)||void 0===t||t.incrementEventCount(0,JSON.stringify({message:"Operation received",operationType:i,nItems:e.items.length}));for(const t of e.items)this.logAnnotationResultItem(i,t)}logAnnotationResultItem(e,t){var i;const n=t.body?s.h.getTypeNameFor(t.body):"unknown";null===(i=this.aggregateLogger)||void 0===i||i.incrementEventCount(0,JSON.stringify({message:"Annotation received",annotationType:n,operationType:e}))}async createClientMetadata(){var e,t,i,n,s,o;const r={appName:null!==(t=null===(e=this.hostSettings.hostMetadata)||void 0===e?void 0:e.appName)&&void 0!==t?t:"EditorBX",appPlatform:null!==(n=null===(i=this.hostSettings.hostMetadata)||void 0===i?void 0:i.appPlatform)&&void 0!==n?n:"Online",releaseAudienceGroup:null===(s=this.hostSettings.hostMetadata)||void 0===s?void 0:s.releaseAudienceGroup,uiLanguage:this.hostSettings.defaultLocale,sessionId:null===(o=this.hostSettings.hostMetadata)||void 0===o?void 0:o.sessionId},a=(await this.descriptorManager.buildDescriptors()).find((e=>"FlightIds"===e.name));return a&&(r.flights=a.value),r}createHostCallbacks(){return{onAnnotationResult:e=>{this.logAnnotationResultOperation(e)},isFeatureEnabled:async(e,t)=>{var i;let n;return n=(null===(i=this.hostSettings.orchestratorSettings)||void 0===i?void 0:i.augLoopIsFeatureEnabledCallback)?await this.hostSettings.orchestratorSettings.augLoopIsFeatureEnabledCallback(e,t):"Production"===t,n},onResult:()=>{},executeLocalLambda:async()=>{},areLicenseFeaturesEnabled:async()=>Promise.resolve(!1),requestAuthToken:async e=>{var t;return(async e=>({Token:e?await e():void 0}))(null===(t=this.hostSettings.orchestratorSettings)||void 0===t?void 0:t.augLoopAuthTokenCallback)},sendTelemetryEvent:(0,o.U)(this.telemetrySink)}}createRuntimeOptions(){var e;return{telemetryAggregationIntervalSec:100,initSession:!1,batchOptions:(null===(e=this.hostSettings.orchestratorSettings)||void 0===e?void 0:e.enableBatching)?{maxInputSize:128e3,delayMs:50}:void 0}}async runPreRuntimeInit(e,t){var i;(null===(i=this.hostSettings.orchestratorSettings)||void 0===i?void 0:i.preRuntimeInit)&&await Promise.all(this.hostSettings.orchestratorSettings.preRuntimeInit.map((i=>i(e,t))))}async initClientRuntime(e,t,i){await this.clientRuntime.init(this.hostSettings.orchestratorSettings.augLoopEndpoint,e,t,i)}createSession(e){var t;const i=null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:(new n.L).generate();return this.clientRuntime.createSession({docSessionId:i})}}const l=(e,t,i,n,s,o)=>new a(e,t,i,n,s,o)},151468:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(668952).f)("IEnabledCritiqueTypesSetter")},152746:(e,t,i)=>{if(i.d(t,{Z:()=>h}),0!=i.j)var n=i(696767);const s=6e4,o=60*s,r=24*o,a=7,l=24,d=1,c=2,u=.8,g=-10*s;function h(e,t){const i=(0,n.$)().getStringsFor("DateTimeStrings"),h=(e,...t)=>{let n=i(e);return t.filter(Boolean).forEach(((e,t)=>{n=n.replace(`{${t}}`,e)})),n},p=t.getTime()-e.getTime();if(p<0)return p<=g?"":h("justNow");const m=Math.round(p/r),f=Math.round(p/o);if(m>a)return function(e,t){const i=(0,n.$)(),s=i.getStringsFor("MonthsNames"),o=[s("January"),s("February"),s("March"),s("April"),s("May"),s("June"),s("July"),s("August"),s("September"),s("October"),s("November"),s("December")][e.getMonth()],r=`${o} ${e.getDate().toString()}, ${e.getFullYear().toString()}`,a=`${o} ${e.getDate().toString()}`,l=t.getFullYear()===e.getFullYear()?a:r;return l}(e,t);if(f>=l)return m>1?h("daysAgo",m.toString()):h("oneDayAgo");if(f>=c)return f>1?h("hoursAgo",f.toString()):h("oneHourAgo");if(f>=u)return d>1?h("hoursAgo",d.toString()):h("oneHourAgo");const v=Math.round(p/s);return v<=c?h("justNow"):h("minutesAgo",v.toString())}},157165:(e,t,i)=>{i.d(t,{$:()=>I,v:()=>_});var n=i(208520);if(0!=i.j)var s=i(381277);if(0!=i.j)var o=i(857074);if(0!=i.j)var r=i(818935);if(0!=i.j)var a=i(852853);var l=i(252723),d=i(108520),c=i(138697);if(0!=i.j)var u=i(897578);if(0!=i.j)var g=i(288296);if(0!=i.j)var h=i(93659);if(0!=i.j)var p=i(318391);if(0!=i.j)var m=i(218679);var f=i(77127);if(0!=i.j)var v=i(855897);if(0!=i.j)var y=i(66790);const _=(0,l.F5)({state:d.A.on(c.x)}),I=()=>{const e=n.useContext(f.O1),{state:t}=(0,l.KN)(_),[i,d]=n.useState(!1);n.useEffect((()=>(t.subscribe("visibilityUpdated",d),()=>{t.unsubscribe("visibilityUpdated",d)})),[t]);const{undoAriaLabel:c,undoTitle:I,localizer:C,target:S,styles:b,showEditorBranding:T,gapSpace:E}=t,N=C.getMessage("ebx_settingsButtonTooltip"),w=C.getMessage("ebx_undoCalloutAriaLabel"),x=n.useCallback((()=>{t.applyUndo()}),[t]),L=n.useCallback((()=>{t.openSettings()}),[t]),D=n.useCallback((e=>{t.updateCalloutPosition((null==e?void 0:e.alignmentEdge)===y.x.right,!1)}),[t]),A=(0,v.I)(),F=n.createElement("div",{style:Object.assign({display:"flex",flexDirection:"row",flexWrap:"nowrap"},b.calloutContainer)},n.createElement(r.$,{icon:n.createElement(s.t2R,{style:e?void 0:b.buttonIcon.icon,className:A.icon}),appearance:"subtle",className:`${m.g.undoButton}`,"data-automation-id":"undo-callout-undo-button",key:"Undo",role:"button",style:b.buttonIcon,title:I,"aria-label":c,onClick:x}),n.createElement(r.$,{icon:n.createElement(o.$Dw,{style:e?void 0:b.buttonIcon.icon,className:A.icon}),appearance:"subtle",className:m.g.settingsButton,key:"Settings","data-automation-id":"undo-callout-settings-button",role:"button",style:Object.assign({marginLeft:2},b.buttonIcon),title:N,"aria-label":N,onClick:L}),T&&n.createElement("span",{role:"none presentation","aria-hidden":!0,style:b.logoButtonBase},C.getMessage("ebx_brandText")));if(e){const e={popover:{trapFocus:t.setInitialFocus,withArrow:!1,open:i,ariaLabel:w,ariaRole:"group",positioning:{target:(0,h.ug)(S),align:"center",position:"above",offset:e=>(t.updateCalloutPosition("end"===e.alignment,!0),{mainAxis:E})}},surface:{style:Object.assign({padding:0,background:a.L.colorNeutralBackground1,borderRadius:8},b.calloutV9)}};return n.createElement(p.v,Object.assign({ref:t.undoCardV9Ref},e),F)}return i?n.createElement(u.U,{ref:t.undoCardRef,isBeakVisible:!1,gapSpace:E,target:(0,g.K)(S),doNotLayer:!0,role:"group",ariaLabel:w,setInitialFocus:t.setInitialFocus,onRestoreFocus:()=>{},onPositioned:D,styles:b.calloutMain},F):n.createElement(n.Fragment,null)}},157698:(e,t,i)=>{i.d(t,{b:()=>n});const n=(0,i(668952).f)("IParagraphTextExtractor")},163573:(e,t,i)=>{i.d(t,{d:()=>n,n:()=>o});var n,s=i(668952);!function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email",e[e.EditorLandingPage=3]="EditorLandingPage"}(n||(n={}));const o=(0,s.f)("IHostSettings")},164942:(e,t,i)=>{i.d(t,{F:()=>r});var n=i(379490),s=i(630501),o=i(229906);let r=class extends s.z{constructor(){super(...arguments),this.stores=new Map}setCanvasElement(e,t){this.stores.set(e,new a(t)),this.publishEvent("stateUpdated",{stores:this.stores})}getShadowElementStore(e){return this.stores.get(e)}removeShadowElementStore(e){this.stores.delete(e),this.publishEvent("stateUpdated",{stores:this.stores})}};r=(0,n.__decorate)([(0,o._)()],r);class a extends s.z{constructor(e){super(),this.anchor=e,this.container=void 0,this.overlay=void 0,this._updateOverlay=()=>new Promise((()=>{})),this.updateOverlay=async()=>{await this._updateOverlay()},this.setUpdateOverlay=e=>{this._updateOverlay=e,this.publishStateChange()},this.setShadowElement=(e,t)=>{this.container=e,this.overlay=t,this.publishStateChange()}}publishStateChange(){this.publishEvent("stateUpdated",{anchor:this.anchor,container:this.container,overlay:this.overlay})}}},166137:(e,t,i)=>{i.d(t,{M:()=>s,g:()=>o});var n=i(668952);const s=(0,n.f)("IFeedbackStore"),o=(0,n.f)("IFeedbackStoreFactory")},168492:(e,t,i)=>{async function n(e,t,i,n){return new Promise(((s,o)=>{const r=setTimeout((()=>{o(null!=i?i:new Error(`Promise failed to resolve within the timeout of ${t}ms`))}),t);e.then((e=>{clearTimeout(r),s(e)})).catch((e=>{clearTimeout(r),n&&(n.message=e.message),o(null!=n?n:e)}))}))}async function s(e){return Promise.all(e.map((e=>e.then((e=>({status:"fulfilled",value:e}))).catch((e=>({status:"rejected",reason:e}))))))}function o(){let e,t;if(new Promise(((i,n)=>{e=i,t=n})),!e||!t)throw new Error("Promise resolver is not defined");return[e,t]}i.d(t,{Lu:()=>n,sG:()=>s,vP:()=>o})},171836:(e,t,i)=>{if(i.d(t,{p:()=>u}),0!=i.j)var n=i(260566);if(0!=i.j)var s=i(904196);if(0!=i.j)var o=i(508030);if(0!=i.j)var r=i(251439);if(0!=i.j)var a=i(386675);if(0!=i.j)var l=i(290053);if(0!=i.j)var d=i(302198);if(0!=i.j)var c=i(904923);class u{constructor(){this.imports=[d.H,o.k]}get uniqueId(){return(0,r.z)(507918238)}configureRootServices(e){e.bind(n.qq).toDynamicValue((e=>{const t=e.get(s.n);return new n.qq({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(l.$).to(c.o),e.bind(a.S).toExisting(l.$)}}},172245:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Beknoptheid"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Consistent taalgebruik"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Inclusief taalgebruik"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Typefouten"},"Clarity":{"IsImplemented":true,"LocalizedName":"Duidelijkheid"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"Herschrijving"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Foutcorrectie"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Woordkeuze","IsImplemented":true},"Grammar":{"LocalizedName":"Grammatica","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Formeel taalgebruik"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Interpunctie","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Schrijfregels"},"Spelling":{"LocalizedName":"Spelling","IsImplemented":true},"Resume":{"LocalizedName":"CV","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":true,"LocalizedName":"Gevoelige geopolitieke referenties"}}')},174077:(e,t,i)=>{i.d(t,{J:()=>o,a:()=>s});var n=i(668952);const s=(0,n.f)("AugloopSessionFactory"),o=(0,n.f)("IOrchestrator")},174978:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":true,"LocalizedName":"簡明性"},"Consistent Written Forms":{"LocalizedName":"異體詞統一用法","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"包容性語言"},"Typing errors":{"IsImplemented":false,"LocalizedName":"筆誤"},"Clarity":{"LocalizedName":"清晰性","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"改寫"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"糾錯"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"詞彙選擇","IsImplemented":false},"Grammar":{"IsImplemented":true,"LocalizedName":"語法"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"正式語言","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"標點符號規則","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"書寫規則"},"Spelling":{"IsImplemented":false,"LocalizedName":"拼字檢查"},"Resume":{"LocalizedName":"履歷","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"敏感地緣政治參照","IsImplemented":false}}')},175602:(e,t,i)=>{i.d(t,{UM:()=>s,Yn:()=>r,mU:()=>o});const n=0!=i.j?[".ms-ecc-callout",".ms-critique-callout","editor-card","ms-cc-overflow",".ms-cc-overflow","ms-ecc-expanded-inline-suggestions-results"]:null;function s(e){return!!(e&&"closest"in e&&(e.closest('[id="ms-ecc-expanded-inline-suggestions-results"]')||e.closest('[id^="ms-ecc-header-option"]')||e.closest('[id^="eccMenuTrigger"]')||e.closest('[id^="ms-ecc-option"]')||e.closest('[id^="eccSearchButton"]')))}function o(e,t){return!!(e&&"closest"in e&&e.closest((null!=t?t:n).join(", ")))}function r(e){return!!(e&&"isConnected"in e&&!e.isConnected&&"closest"in e&&e.closest('[role="menuitem"]'))}},175954:(e,t,i)=>{i.d(t,{l:()=>n});const n=(0,i(668952).f)("ITerminalNodeBuilder")},176043:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(668952).f)("IPresentationDomSettings")},177822:(e,t,i)=>{if(i.d(t,{J:()=>a}),0!=i.j)var n=i(276961);if(0!=i.j)var s=i(978129);if(0!=i.j)var o=i(757439);if(0!=i.j)var r=i(251439);class a{constructor(){this.imports=[o.E]}get uniqueId(){return(0,r.z)(507918404)}configureRootServices(e){e.bind(n.T).to(s.k)}}},177929:(e,t,i)=>{i.d(t,{c:()=>s});var n=i(807582);class s extends n.z{constructor(e,t,i,n){super(),this._targetWindow=e,this._safeWindow=t,this._eventName=i,this._performanceApiGarbageCollectorIntervalInMs=n,this._performanceMarksInGarbageCollection=[],this._measuresNames=new Map,this._performanceMarksInGCCorrelationKeysHistory=new Map}startEntry(e,t,i){const[n]=this._getPerformanceEntryNames(e);let s=this._targetWindow.performance.mark(n);if(void 0===s){const e=this._targetWindow.performance.getEntriesByName(n);if(1!==e.length)return void this.publishEvent("errorEntryNotFound",{entryName:n});s=e[0]}this._performanceMarksInGarbageCollection.push(s),t&&this._performanceMarksInGCCorrelationKeysHistory.set(s.name,{correlationKeys:t,customData:i?[i]:[]}),this._scheduleGarbageCollection(!1)}_getPerformanceEntryNames(e,t=this._eventName){const i=`${t}-${e}`;return[e,`${i}--${s.END_SUFFIX}`,i]}addMeasure(e,t,i){const[n,s,o]=this._getPerformanceEntryNames(e,t);if(0!==this._targetWindow.performance.getEntriesByName(n).length)try{if(this._targetWindow.performance.mark(s),this._targetWindow.performance.measure(o,n,s),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:this._targetWindow.performance.getEntriesByName(o)[0].duration}]),this._targetWindow.performance.clearMarks(s),this._targetWindow.performance.clearMeasures(o),i){const e=this._performanceMarksInGCCorrelationKeysHistory.get(n);if(null==e?void 0:e.correlationKeys){const t=e.correlationKeys,s=[...e.customData||[],i];this._performanceMarksInGCCorrelationKeysHistory.set(n,{correlationKeys:t,customData:s})}}}catch(e){this.publishEvent("errorAddingCheckpoint",{measureName:t,errorCaught:e})}}commitEntry(e,t=this._eventName,i){const[n,s,o]=this._getPerformanceEntryNames(e,t),r=this._targetWindow.performance.getEntriesByName(n);if(0!==r.length)try{this._targetWindow.performance.mark(s),this._targetWindow.performance.measure(o,n,s),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:this._targetWindow.performance.getEntriesByName(o)[0].duration}]);const a=this._performanceMarksInGCCorrelationKeysHistory.get(n);this.publishEvent("commitMeasure",{measures:this._measuresNames.get(e)||[],correlationKeys:null==a?void 0:a.correlationKeys,customData:null==a?void 0:a.customData,eventName:i}),this._targetWindow.performance.clearMarks(n),this._targetWindow.performance.clearMarks(s),this._targetWindow.performance.clearMeasures(o),this._measuresNames.delete(e),this._removeGCTracedPerformanceMark(r[0])}catch(e){this.publishEvent("errorCommitMeasure",{measureName:t,errorCaught:e})}}_clearAndReschedule(e){const t=Date.now(),i=[],n=this._performanceMarksInGarbageCollection.filter((n=>{const s=this._targetWindow.performance.timeOrigin+n.startTime;if(e&&!e.didTimeout&&0===e.timeRemaining()||t-s<this._performanceApiGarbageCollectorIntervalInMs)return!0;const o=this._performanceMarksInGCCorrelationKeysHistory.get(n.name);return o&&(o.correlationKeys.isTimeout=!0,this.publishEvent("timeout",{id:o.correlationKeys.logicalId,storedCorrelationKeys:o.correlationKeys,customData:o.customData})),i.push(n),this._targetWindow.performance.clearMarks(n.name),this._targetWindow.performance.clearMeasures(n.name),this._measuresNames.delete(n.name),!1}));for(const e of i)this._removeGCTracedPerformanceMark(e);this._garbageCollectionScheduler=void 0,n.length>0&&this._scheduleGarbageCollection(!0)}_removeGCTracedPerformanceMark(e){const t=this._performanceMarksInGarbageCollection.indexOf(e);t>=0&&this._performanceMarksInGarbageCollection.splice(t,1),this._performanceMarksInGCCorrelationKeysHistory.has(e.name)&&this._performanceMarksInGCCorrelationKeysHistory.delete(e.name)}_scheduleGarbageCollection(e){this._garbageCollectionScheduler||e||(this._garbageCollectionScheduler=this._safeWindow.requestIdleCallback((e=>this._clearAndReschedule(e)),this._performanceApiGarbageCollectorIntervalInMs))}}s.END_SUFFIX="end"},180994:(e,t,i)=>{i.d(t,{U:()=>r});var n=i(77127);if(0!=i.j)var s=i(670802);if(0!=i.j)var o=i(65314);function r(e,t,i){if(void 0!==e)return e;let r;switch(t){case n.SV.light:r=s.o;break;case n.SV.dark:default:r=o.C}return Object.assign(Object.assign({},r),function(e,t){return t?{colorBrandBackground2:"light"===e?"#EBEFFF":"#1E1D40",colorCompoundBrandStroke:"light"===e?"#464FEB":"#5F71FA",colorBrandBackground2Hover:"light"===e?"#CCD6FF":"#2E2E78",colorCompoundBrandStrokeHover:"light"===e?"#3E45C9":"#7385FF",colorBrandBackground2Pressed:"light"===e?"#96A8FF":"#16152B",colorCompoundBrandStrokePressed:"light"===e?"#3B3FB2":"#515EF5",colorBrandForeground2:"light"===e?"#3E45C9":"#7385FF",colorBrandForeground2Hover:"light"===e?"#3B3FB2":"#96A8FF",colorBrandForeground2Pressed:"light"===e?"#27265C":"#5F71FA"}:{}}("light"===t?"light":"dark",i))}},181731:(e,t,i)=>{i.d(t,{M:()=>N});var n=i(208520),s=i(716588);const o=e=>{const{squigglerId:t,theme:i,forcedHighContrast:s,squiggleVerticalAdjustment:o,autoCorrectionEnabled:a}=e,l=e=>s?"highlight":e,{highPriorityColors:d,mediumPriorityColors:c,lowPriorityColors:u,ciqFlagColors:g,headingDetectionColors:h}=i;return n.createElement("style",null,`@media not print {\n        ::highlight(SpellingSquiggle-${t}) {\n          text-decoration: ${l(d.tile)} wavy underline;\n          text-decoration-skip-ink: none;\n          text-decoration-thickness: ${d.underlineThickness};\n          text-underline-offset: ${o}px;\n        }\n        ::highlight(SpellingSquiggle-${t}-hl) {\n          background-color: ${l(d.highlight)};\n        }\n        ::highlight(GrammarSquiggle-${t}) {\n          text-decoration: ${l(c.tile)} double underline;\n          text-decoration-skip-ink: none;\n          text-underline-offset: ${.5+o}px;\n          text-decoration-thickness: ${c.underlineThickness};\n        }\n        ::highlight(GrammarSquiggle-${t}-hl) {\n          background-color: ${l(c.highlight)};\n        }\n        ::highlight(AdvancedSquiggle-${t}) {\n          text-decoration: ${l(u.tile)} dashed underline;\n          text-decoration-skip-ink: none;\n          text-underline-offset: ${o}px;\n          text-decoration-thickness: ${u.underlineThickness};\n        }\n        ::highlight(AdvancedSquiggle-${t}-hl) {\n          background-color: ${l(u.highlight)};\n        }\n        ::highlight(CIQFlagSquiggle-${t}) {\n          text-decoration: ${l(g.tile)} dotted underline;\n          text-decoration-skip-ink: none;\n          text-underline-offset: ${1+o}px;\n          text-decoration-thickness: ${g.underlineThickness};\n        }\n        ::highlight(CIQFlagSquiggle-${t}-hl) {\n          background-color: ${l(g.highlight)};\n        }\n        ::highlight(HeadingDetectionSquiggle-${t}) {\n          text-decoration: ${l(h.tile)} dashed underline;\n          text-decoration-skip-ink: none;\n          text-underline-offset: ${o}px;\n          text-decoration-thickness: ${h.underlineThickness};\n        }\n        ::highlight(HeadingDetectionSquiggle-${t}-hl) {\n          background-color: ${l(h.highlight)};\n        }\n        ${function(e,t,i,n,s){if(!s)return"";let o="";for(let s=10;s<=100;s+=10)o+=r(e,t,i,n,s);const a=e=>t?"highlight":e;return`\n    ${o}\n    ::highlight(AutoCorrectSquiggle-${e}-hl) {\n      text-decoration: ${a(i.autoCorrectColors.tile)} solid underline;\n      background-color: ${a(i.autoCorrectColors.highlight)};\n    }`}(t,s,i,o,a)}\n      }`)};function r(e,t,i,n,o){const r=e=>t?"highlight":e;return`\n    ::highlight(AutoCorrectSquiggle-${`${o}-${e}`}) {\n      text-decoration: ${r((0,s.$v)(i.autoCorrectColors.tile,o/100))} solid underline;\n      background-color: ${r((0,s.$v)(i.autoCorrectColors.highlight,o/100))};\n      text-decoration-skip-ink: none;\n      text-underline-offset: ${1+n}px;\n      text-decoration-thickness: ${i.autoCorrectColors.underlineThickness};\n    }`}var a=i(266885),l=i(272432);const d=e=>n.createElement(a.M,{map:e.squigglerState.squigglesMap,renderEntry:(t,i)=>n.createElement(c,Object.assign({key:t,squiggles:i},e))}),c=(0,l.PA)((e=>{var t;const i=[],s=[];let o=0,r=0;for(const t of e.squiggles.values()){const n=t.filter((t=>{var i;return t.isVisible&&e.squigglerState.anchorElement&&(null===(i=e.squigglerState.hostElement)||void 0===i?void 0:i.shouldRenderSquiggle(t.data.range.startContainer,e.squigglerState.anchorElement))})),a=e.squigglerState.getSquiggleProps(n);a.length>0&&"critique"!==a[0].squiggleKind?s.push(...a):i.push(...a);for(const e of a)o=Math.max(o,e.data.clientRect.right),r=Math.max(r,e.data.clientRect.bottom)}const a=n.createElement(n.Fragment,null,n.createElement(u,Object.assign({},e,{squiggles:i,squiggleKind:"critique",anchorElement:e.squigglerState.anchorElement})),n.createElement(u,Object.assign({},e,{squiggles:s,squiggleKind:"autocorrection",anchorElement:e.squigglerState.anchorElement})));if(e.squigglerState.disableAutoBrowserVirtualizationOfSquiggles)return a;const l=o,d=r;return n.createElement("div",{key:null===(t=e.squigglerState.anchorElement)||void 0===t?void 0:t.id,style:{contentVisibility:"auto",containIntrinsicSize:`${l}px ${d}px`,contain:"strict",position:"absolute",width:l,height:d}},a)})),u=(0,l.PA)((e=>{var t;const i=e.squigglerUXFactory(e.squiggleKind);return n.createElement(n.Fragment,{key:e.squiggleKind},i.getSquiggles(e.squigglerId+(null===(t=e.anchorElement)||void 0===t?void 0:t.id),e.squiggles,e.theme,e.forcedHighContrast,e.anchorElement))}));var g=i(518341),h=i(966727);const p=e=>{const{theme:t}=e,i="squiggleHighlightStrokeColor",s="squiggleHighlightFillColor",o=`\n      ${g.Rr} {\n        .${i} {\n          stroke: highlight;\n        }\n        .${s} {\n          fill: highlight;\n        }\n      }`;return n.createElement(n.Fragment,null,n.createElement("style",null,o),n.createElement("svg",{width:"0",height:"0",style:{position:"absolute"}},n.createElement("defs",null,n.createElement("pattern",{id:h.Bn.SpellingSquiggle,width:"5",height:h.fQ.SpellingSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("path",{d:"M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3",className:i,stroke:t.highPriorityColors.tile,strokeWidth:"1",fill:"transparent"})),n.createElement("pattern",{id:h.Bn.GrammarSquiggle,width:"5",height:h.fQ.GrammarSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd",strokeLinecap:"round"},n.createElement("g",{className:i,stroke:t.mediumPriorityColors.tile},n.createElement("path",{d:"M0,0.5 L5,0.5"}),n.createElement("path",{d:"M0,2.5 L5,2.5"})))),n.createElement("pattern",{id:h.Bn.AdvancedSquiggle,width:"10",height:h.fQ.AdvancedSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M1,1 L5,1",className:i,stroke:t.lowPriorityColors.tile,strokeWidth:"2",strokeLinecap:"round"}))),n.createElement("pattern",{id:h.Bn.AutoCorrectSquiggle,width:"5",height:h.fQ.AutoCorrectSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none"},n.createElement("path",{d:"M0,0.5 L5,0.5",className:i,strokeWidth:"1",stroke:t.autoCorrectColors.tile}))),n.createElement("pattern",{id:h.Bn.CIQFlagSquiggle,width:"6",height:h.fQ.CIQFlagSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("circle",{cx:"1.5",cy:"1.5",r:"1.5",className:s,fill:t.ciqFlagColors.tile}))),n.createElement("pattern",{id:h.Bn.HeadingDetectionSquiggle,width:"10",height:h.fQ.HeadingDetectionSquiggle,patternUnits:"userSpaceOnUse"},n.createElement("g",{stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},n.createElement("path",{d:"M1,1 L5,1",className:i,stroke:t.headingDetectionColors.tile,strokeWidth:"2",strokeLinecap:"round"}))))))};var m=i(786132),f=i(90393),v=i(829088),y=i(923256),_=i(851244),I=i(331408);function C(e,t){switch(e){case f.N.OFFICE:return function(e){return`\n    span.ms-squiggle-${I.bx.High} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.spellingTile};\n    }\n\n    span.ms-squiggle-${I.bx.Medium} {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.grammarTile};\n    }\n\n    span.ms-squiggle-${I.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 3px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      background-image: ${e.insightTile};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      border-image-slice: 0 0 100% 0;\n      border-bottom: solid 1px transparent;\n      background-repeat: repeat-x;\n      background-position: bottom left;\n      border-image-source: ${e.autoCorrectTile};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t);case f.N.SVG:return function(e){return`\n  span.ms-squiggle-autocorrect-hl, svg.ms-squiggle-autocorrect-hl {\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      box-sizing: border-box;\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-autocorrect, svg.ms-squiggle-autocorrect {\n      opacity: 0%;\n    }\n  `}(t);case f.N.GENERIC:default:return function(e){return`\n    span.ms-squiggle-${I.bx.High} {\n      border-bottom: 4px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.highPriorityColors.tile};\n      border-image-source: ${e.spellingTileBorder};\n    }\n\n    span.ms-squiggle-${I.bx.Medium} {\n      border-bottom: 3px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.mediumPriorityColors.tile};\n      border-image-source: ${e.grammarTileBorder};\n    }\n\n    span.ms-squiggle-${I.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px solid;\n      border-image-slice: 0 1 100%;\n      box-sizing: border-box;\n      border-color: ${e.theme.lowPriorityColors.tile};\n      border-image-source: ${e.insightTileBorder};\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid;\n      border-image-slice: 0 2 100%;\n      box-sizing: border-box;\n      border-image-source: ${e.autoCorrectTileBorder};\n      background-color: ${e.theme.autoCorrectColors.highlight};\n      opacity: 100%;\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_File, .ms-squiggle-CIQFlag_Time, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n      background-image: linear-gradient(to right, ${e.theme.ciqFlagColors.tile} 33%, rgba(0,0,0,0) 0%);\n      background-position: bottom;\n      background-size: 6px 2px;\n      background-repeat: repeat-x;\n    }\n\n    span.ms-squiggle-HeadingDetection {\n      background-image: ${e.headingDetectionTile};\n      background-size: 4px 1px;\n      background-repeat: repeat-x;\n      background-position: 0 100%;\n    }\n  `}(t)}}const S=(e=f.N.GENERIC,t,i,n)=>{const s=C(e,t),o=`\n        span.ms-squiggle {\n            position: absolute;\n            border-radius: 2px;\n            border-image-repeat: repeat;\n            background-clip: content-box;\n            cursor: text;\n            pointer-events: none;\n            box-sizing: ${e===f.N.OFFICE?"content-box":"border-box"};\n        }\n\n        span.ms-squiggle.stealth, svg.ms-squiggle.stealth {\n          opacity: 0%;\n          transition: opacity 0.25s;\n        }\n\n        span.ms-squiggle.stealth.hl, svg.ms-squiggle.stealth.hl {\n          opacity: 100%;\n        }\n\n        ${s}\n        ${function(e){return`\n    span.ms-squiggle-${I.bx.High}.hl {\n      background-color: ${e.theme.highPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${I.bx.Medium}.hl {\n      background-color: ${e.theme.mediumPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-${I.bx.Low}.hl:not(.ms-squiggle-TopicSuggestion.hl) {\n      background-color: ${e.theme.lowPriorityColors.highlight};\n    }\n\n    span.ms-squiggle-CIQFlag_PersonEntityRecognition.hl, .ms-squiggle-CIQFlag_DateEntityRecognition.hl, .ms-squiggle-CIQFlag_SatoriEntityRecognition.hl, .ms-squiggle-CIQFlag_Location.hl, .ms-squiggle-CIQFlag_File.hl, .ms-squiggle-CIQFlag_Time.hl, .ms-squiggle-CIQFlag_Topic.hl, .ms-squiggle-CIQFlag_TaskRecognition.hl, .ms-squiggle-TopicSuggestion.hl, .ms-squiggle-CIQFlag_LocalBusiness.hl {\n      background-color: ${e.theme.ciqFlagColors.highlight};\n    }\n\n    span.ms-squiggle-HeadingDetection.hl {\n      background-color:${e.theme.headingDetectionColors.highlight};\n    }\n  `}(t)}\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n    `,r=`\n        span.hc-noadjust {\n          -ms-high-contrast-adjust: none;\n          forced-color-adjust: none;\n        }\n\n        span.ms-squiggle {\n          forced-color-adjust:none;\n          cursor: text;\n          box-sizing: border-box;\n          pointer-events: none;\n          border-color: highlight;\n          border-image-source: none;\n          background-image: none;\n          position: absolute;\n          border-radius: 0px;\n        }\n\n        ${function(e){return e===f.N.SVG?"":`\n    span.ms-squiggle-${I.bx.High} {\n      border-bottom: 4px solid highlight;\n    }\n\n    span.ms-squiggle-${I.bx.Medium} {\n      border-bottom: 3px double highlight;\n    }\n\n    span.ms-squiggle-${I.bx.Low}:not(.ms-squiggle-TopicSuggestion) {\n      border-bottom: 2px dashed highlight;\n    }\n\n    span.ms-squiggle-autocorrect {\n      border-bottom: none;\n    }\n\n    span.ms-squiggle-autocorrect-hl {\n      border-bottom: 1px solid highlight;\n    }\n  `}(e)}\n\n        span.ms-squiggle-autocorrect {\n          border-bottom: none;\n        }\n\n        span.hl {\n          outline: 2px solid highlight;\n        }\n\n        @media print {\n          .ms-squiggle {\n              display:none !important;\n          }\n        }\n\n        span.ms-squiggle-CIQFlag_PersonEntityRecognition, .ms-squiggle-CIQFlag_DateEntityRecognition,, .ms-squiggle-CIQFlag_SatoriEntityRecognition, .ms-squiggle-CIQFlag_Location, .ms-squiggle-CIQFlag_Topic, .ms-squiggle-CIQFlag_TaskRecognition, .ms-squiggle-TopicSuggestion, .ms-squiggle-CIQFlag_LocalBusiness {\n          background-image: linear-gradient(to right, #3c97dd 33%, rgba(0,0,0,0) 0%);\n          background-position: bottom;\n          background-size: 6px 2px;\n          background-repeat: repeat-x;\n        }\n    `;return i?r:n?`\n    @media not (forced-colors: active) {\n      ${o}\n    }\n    ${g.Rr} {\n      ${r}\n    }`:o};var b=i(794329),T=i(252843);class E extends n.Component{constructor(e){super(e),this.connectSquiggler=()=>{this.squigglerEvents.connectSquiggler()},this.disconnectSquiggler=()=>{this.squigglerEvents.disconnectSquiggler()},this.setSquigglerRef=e=>{this.props.state.setSquigglerRef(e),this.squigglerEvents.updatePositionIfRelative()},this.shouldRender=()=>{var e,t;return null!==(t=null===(e=this.props.state.hostElement)||void 0===e?void 0:e.shouldRender(this.props.state.anchorElement))&&void 0!==t&&t},this.selectorRef=n.createRef();const t=new v.O(this.props.state.anchorElement?(0,m.e)(this.props.state.anchorElement):window);this.squigglerEvents=this.props.state.squigglerEventManager.createEventManager(t,this.props.state,this.props.deps.safeWindow)}componentDidUpdate(e){var t;const i=this.props.state.isVisible,n=e.state.isVisible;i?(this.props.state.reactOnComponentUpdate&&(this.squigglerEvents.updatePositionIfRelative(),this.squigglerEvents.checkHighlight()),n||this.connectSquiggler()):n&&this.disconnectSquiggler(),this.selectorRef.current&&(null===(t=this.props.state.hostElement)||void 0===t||t.squigglerUpdated(this.selectorRef.current))}async componentDidMount(){this.connectSquiggler(),await this.props.state.updateRanges(),this.squigglerEvents.checkHighlight(),this.squigglerEvents.updatePositionIfRelative()}componentWillUnmount(){this.disconnectSquiggler(),this.props.state.disconnectVisibilityTracker(),this.squigglerEvents.dispose()}render(){let e={};const{isRelativePositionEnabled:t,squiggleStyleType:i,id:s,top:r,left:a,anchorElement:l,isVisible:c,parentToRenderTo:u,hostElement:g,theme:h,scaleTransformValue:m,forcedHighContrast:v,autoCorrectionEnabled:_,squiggleVerticalAdjustment:I}=this.props.state;if(!l||!u||!g)return null;e=t?{pointerEvents:"none",position:"relative",flexGrow:0,msHighContrastAdjust:"none",display:"block",top:`${r}px`,left:`${a}px`}:{pointerEvents:"none",position:"absolute",msHighContrastAdjust:"none",flexGrow:0,top:`${r}px`,left:`${a}px`};const C=g.squigglerInlineStyles(l,m),E=i===f.N.SVG,N=S(i,h,v,this.props.deps.highConstrastModeDetector.browserSupportsHighContrastMode),w=n.createElement(d,{squigglerState:this.props.state,squigglerId:s,theme:h.theme,forcedHighContrast:v,squigglerUXFactory:this.props.deps.squigglerUXFactory});return(0,y.g)(this.props.deps.hostSettings,l)?c&&this.shouldRender()?n.createElement(n.Fragment,null,n.createElement(o,{squigglerId:s+l.id,theme:h.theme,forcedHighContrast:v,squiggleVerticalAdjustment:I,autoCorrectionEnabled:_}),w):null:b.createPortal(n.createElement("editor-squiggler",{"aria-hidden":this.props.state.ariaEnabled,tabindex:-1,style:{height:"0px",width:"0px"},ref:this.selectorRef},n.createElement(n.Fragment,null,n.createElement("style",null,"\n  @media print {\n    .ms-editor-squiggler {\n        display:none !important;\n    }\n  }\n  .ms-editor-squiggler {\n    all: initial;\n    display: block !important;\n    height: 0px !important;\n    width: 0px !important;\n  }"),n.createElement(T.Ay.div,{className:"ms-editor-squiggler",ref:this.setSquigglerRef,style:C},n.createElement("style",{type:"text/css"},N),E&&n.createElement(p,{theme:h.theme}),n.createElement("div",{style:e},c&&this.shouldRender()&&w)))),u)}}const N=(0,_.PA)(E)},183715:(e,t,i)=>{if(i.d(t,{l:()=>s}),0!=i.j)var n=i(538588);class s{constructor(e){this.params=e}create(e){const{settings:t}=this.params;return new n.n({settings:t})}}},184226:(e,t,i)=>{i.d(t,{K3:()=>n,aP:()=>r,iw:()=>o});var n,s=i(668952);!function(e){e.auto="auto",e.ltr="ltr",e.rtl="rtl"}(n||(n={}));const o=(0,s.f)("ILanguageScriptDirectionDetector"),r=(0,s.f)("ILanguageScriptDirectionDetectorFactory")},186438:(e,t,i)=>{if(i.d(t,{A_:()=>p,MG:()=>h,W:()=>a,dP:()=>g,dt:()=>c,ht:()=>l,qB:()=>d,r:()=>r,r6:()=>u}),0!=i.j)var n=i(331408);if(0!=i.j)var s=i(762413);if(0!=i.j)var o=i(976333);function r(e){const t=[n.L9.ContextualSpelling,n.L9.WrongSpelling];return!!e&&e.typeId!==n.L9.Synonyms&&(e.priority===n.bx.High||!!e.typeId&&t.includes(e.typeId))}function a(e){return!!e&&e.typeId===n.L9.TopicSuggestion}function l(e){return!0===("number"==typeof e.supportedActions?(0,s.z)(e.supportedActions):e.supportedActions).delete}function d(e){const t="number"==typeof e.action?(0,o.fO)(e.action):e.action;return!0===t.changeAll||!0===t.changeOnce||!0===t.autoCorrect||!0===t.personalizedAutoCorrect}function c(e){return!!e&&(l(e)&&!e.suggestions.some((e=>d(e))))}function u(e){return(null==e?void 0:e.typeId)===n.L9.TonalRewrite}function g(e){return!0===("number"==typeof e.action?(0,o.fO)(e.action):e.action).personalizedAutoCorrect}function h(e){for(const t of e.suggestions)if(!0===t.action.autoCorrect)return t}function p(e){return!!function(e){for(const t of e.suggestions)if(4===t.action)return t}(e)}},187738:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"বানান","IsImplemented":true}}')},188694:(e,t,i)=>{i.d(t,{$:()=>n});class n{static hash(e){let t=0,i=0;for(;i<e.length;)t=(t<<5)-t+e.charCodeAt(i++)|0;return t>0?t:-1*t}static format(e,...t){const i=t.length;return e.replace(/\{(\d+)\}/g,((e,n)=>n<i?t[n]:e))}static trimLeft(e){return e.replace(/^\s+/,"")}static trimRight(e){return e.replace(/\s+$/,"")}}},188835:(e,t,i)=>{if(i.d(t,{k:()=>l}),0!=i.j)var n=i(234605);if(0!=i.j)var s=i(251439);if(0!=i.j)var o=i(756857);if(0!=i.j)var r=i(35865);if(0!=i.j)var a=i(696767);class l{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918298)}configureRootServices(e){var t;const i=null!==(t=(0,a.$)())&&void 0!==t?t:new r.z;(0,a.Y)(i),e.bind(o.H).to(n.M)}}},189784:(e,t,i)=>{i.d(t,{I:()=>o});var n=i(108031),s=i(208520);const o=s.memo((e=>{const{children:t,predictionDisplayText:i,shouldShowInsertionHelperText:o,showDropdownChevron:r,localizer:a,isMobile:l,onTextMayOverlapLine:d,onDropdownOpened:c,leftPadding:u,parentElement:g,showIconWithMultipleComponents:h}=e,p=s.useRef(null),m=s.useRef(null),f=s.useCallback((()=>{r&&p.current&&c(p.current)}),[p,c,r]),v=s.useCallback((e=>{"Tab"===e.code&&r&&p.current&&c(p.current)}),[p,c,r]);s.useEffect((()=>{if(!m.current)return;let e=0;const t=m.current.getClientRects();1!==t.length&&(e+=t.length-1),d(e)}));const y=parseInt(window.getComputedStyle(g).fontSize,10);return s.createElement(s.Fragment,null,s.createElement("span",{className:"ms-entity-prediction-wrapper",style:{marginLeft:u?u+"px":void 0},ref:p,onClick:f,onKeyDown:v,role:"combobox"},"​‌",(!r||h)&&s.createElement("span",{className:"ms-entity-prediction-icon"},t),s.createElement("span",{id:"textPrediction",className:"ms-entity-prediction",contentEditable:!1,ref:m},i),r?s.createElement("span",{className:"ms-entity-prediction-dropdown"},s.createElement(n.yuG,{style:{width:y-4,height:y-4}})):s.createElement(s.Fragment,null),"​‌"),o?s.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"​‌",a.getMessage(l?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),"​‌"):s.createElement(s.Fragment,null))}))},189929:(e,t,i)=>{i.d(t,{q:()=>d});var n=i(252723),s=i(108520),o=i(811861);if(0!=i.j)var r=i(944);var a=i(208520);const l=(0,n.F5)({predictionStateStore:s.A.on(o.Tc)}),d=()=>{const{predictionStateStore:e}=(0,n.KN)(l),[t,i]=a.useState(),[s,o]=a.useState(),d=()=>{i(e.prediction),o(e.predictionDisplayText)};a.useEffect((()=>(e.setOnUpdate(d),()=>{e.setOnUpdate(void 0)})),[e]);const c=a.useCallback((async t=>{await e.applyCurrentPrediction(t)}),[]),u=a.useCallback((async(t,i)=>{e.prediction&&await e.clearCurrentPrediction(e.prediction,t,i)}),[]),g=a.useCallback((async()=>e.isInputPointerAtPrediction()),[]),h=a.useCallback((async t=>{await e.predictionMayOverlapNextLine(t)}),[]),p=a.useCallback((i=>{e.onEntityDropdownOpened(t,i)}),[]);return t&&e.prediction&&e.predictionDisplayLocation&&e.predictionParentElement&&e.predictionContentEditableParentElement?a.createElement(r.L,{prediction:t,predictionDisplayText:s,targetLocation:e.predictionDisplayLocation,predictionContentEditableParentElement:e.predictionContentEditableParentElement,predictionParentElement:e.predictionParentElement,onApplyCurrentPrediction:c,onClearCurrentPrediction:u,isInputPointerAtPrediction:g,onCurrentPredictionMayOverlapNextLine:h,onEntityDropdownOpened:p}):null}},191359:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"எழுத்து சரிபார்ப்பு"}}')},192590:(e,t,i)=>{i.d(t,{R:()=>o});var n=i(379490),s=i(229906);let o=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map}handleApplyCritiqueSuggestion(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyCritiqueSuggestion(e,t,i,n){const s=this._applyHandlerMap.get(t.typeId);return!!s&&s(e,t,i,n)}handleIgnoreCritiqueSuggestion(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreCritiqueSuggestion(e,t){const i=this._ignoreHandlerMap.get(t.typeId);return!!i&&i(e,t)}};o=(0,n.__decorate)([(0,s._)()],o)},195305:(e,t,i)=>{function n(e){if(!e)return[];const t=[];for(const i of e.stores){const e=i.getCritiques();e.sort(((e,t)=>e.start-t.start));for(const n of e){const e={critique:n,store:i};t.push(e)}}return t}i.d(t,{v:()=>n})},196957:(e,t,i)=>{i.d(t,{Q:()=>l});var n=i(208520);if(0!=i.j)var s=i(596882);if(0!=i.j)var o=i(26922);if(0!=i.j)var r=i(219515);if(0!=i.j)var a=i(923256);class l{constructor(e,t){this.hostSettings=e,this.autoCorrectionBroker=t}getSquiggles(e,t,i,l,d){const c=(0,a.g)(this.hostSettings,d);if(c)return n.createElement(n.Fragment,null,t.map(((e,t)=>n.createElement(o.X,{key:t.toString(),autoCorrectProps:e,theme:i,forcedHighContrast:l,hostSettings:this.hostSettings,anchorElement:d}))));{const o=c&&n.createElement(r.u,{squigglerId:e,squigglesProps:t,theme:i,forcedHighContrast:l,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!0,ariaStatusUpdatesOnly:!0,anchorElement:d});return n.createElement(n.Fragment,null,o,t.map(((e,t)=>n.createElement(s.v,Object.assign({key:t.toString()},e,{useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey,autoCorrectionBroker:this.autoCorrectionBroker})))))}}getFormInputSquiggle(e,t,i,o){return n.createElement(s.d,Object.assign({key:e},t,{initializationProgress:i,setInitializationProgress:o}))}}},198596:(e,t,i)=>{i.d(t,{y:()=>n});const n=(0,i(668952).f)("IEditorClient")},199737:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"ಕಾಗುಣಿತ","IsImplemented":true}}')},203390:(e,t,i)=>{i.d(t,{$:()=>s,y:()=>n});const n="OAResultStoreUpdates",s="OAPredictionReceived"},203907:(e,t,i)=>{i.d(t,{O:()=>T});var n=i(379490),s=i(786132),o=i(756857),r=i(537969),a=i(118673),l=i(728671),d=i(163573),c=i(877931),u=i(671303),g=i(83010),h=i(427603),p=i(576516),m=i(657338),f=i(243879),v=i(857132),y=i(928452),_=i(538045),I=i(157698),C=i(104072),S=i(811861),b=i(225443);let T=class extends b.p{constructor(e,t,i,n,s,o,r,a,l,d,c,u,g){super(e,t,i,n,s,o,r,l,a,c,u,g,d),this._predictionHasWrappedOntoNewLineCount=0,this.isInputPointerAtPrediction=async()=>{var e,t;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const i=await this._tileContent.getTextSelection();return!!i&&(!!this._prediction&&(i.startPosition===i.endPosition&&(null===(e=i.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&i.endPositionInParagraphNode===(null===(t=i.endParagraphNode)||void 0===t?void 0:t.element).span-(void 0===this.getNextParagraphAfterPrediction()?0:1)))},this.removeWrappingNewLines=async()=>{var e;const t=this.getNextParagraphAfterPrediction();(null===(e=null==t?void 0:t.parent)||void 0===e?void 0:e.element)&&t.element&&0!==this._predictionHasWrappedOntoNewLineCount&&await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount)},this.insertNewLines=async(e,t,i)=>{let n="";for(let e=0;e<i;e++)n+="\n";this._isActivelyAddingWrappingNewLines=!0,await this._tileContent.insert(e,void 0,t,n,!1,void 0,!0,!1),this._isActivelyAddingWrappingNewLines=!1},this.removeNewLines=async(e,t,i)=>{this._isActivelyAddingWrappingNewLines=!0;for(let n=0;n<i;n++)await this._tileContent.remove(e,void 0,t-1,1,!1,void 0,!0,!1);this._isActivelyAddingWrappingNewLines=!1},this.getNextParagraphAfterPrediction=()=>{var e;if(this._prediction){const t=this._proofingDom.findParagraphNode(this._prediction.tileId);if((null==t?void 0:t.parent)&&t.element&&"offset"in t.element){const i=t.element.offset+t.element.span;let n;return null===(e=t.parent.children)||void 0===e||e.forEach((e=>{e.element&&"offset"in e.element&&e.element.offset>=i&&(!n||n.element&&e.element.offset<n.element.offset)&&(n=e)})),n}}}}allowMiddleOfSentencePredictions(){return!1}async applyCurrentPrediction(e,t){var i,n;if(!this._prediction)return;const s=this._prediction,o=this.determineIfPredictionTextIsValid(s);if("result"in o)return void await this.clearCurrentPrediction(s,"invalid application",S.R8.ImplicitRejection);const{paragraphNode:r,paragraphNodeOffset:a,insertableTextStart:l,predictionText:d}=o,c=d.substring(l);this._predictionHasWrappedOntoNewLineAtStartOfTile&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0);const u=await this._tileContent.getNodeInsertionPosition(r.parent,a+l,!0);if(await this._predictionStore.clearPrediction(),this.isEntityPrediction(s.entityType)){const e=null!=t?t:this.getPredictionFirstItem(s);e&&u&&(null===(n=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===n?void 0:n.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(s,e,u,r.parent.element)}else r.parent&&await this._tileContent.insert(r.parent,void 0,a+l,c,!0,u,!1,!1);this.logAcceptedTelemetry(s,l-s.startIndex,!0,e,!!s.entityResults)}async predictionMayOverlapNextLine(e){var t,i,n;if(!this._prediction||this._prediction.entityType!==p.c.File&&this._prediction.entityType!==p.c.People){if(this._predictionHasWrappedOntoNewLineAtStartOfTile){if(e>this._predictionHasWrappedOntoNewLineCount){const i=this.getNextParagraphAfterPrediction();(null===(t=null==i?void 0:i.parent)||void 0===t?void 0:t.element)&&i.element&&(await this.insertNewLines(i.parent,i.element.offset,e-this._predictionHasWrappedOntoNewLineCount),this._predictionHasWrappedOntoNewLineAtStartOfTile=i.id,this._predictionHasWrappedOntoNewLineCount=e)}else if(e<this._predictionHasWrappedOntoNewLineCount){const t=this.getNextParagraphAfterPrediction();(null===(i=null==t?void 0:t.parent)||void 0===i?void 0:i.element)&&t.element&&(await this.removeNewLines(t.parent,t.element.offset,this._predictionHasWrappedOntoNewLineCount-e),this._predictionHasWrappedOntoNewLineCount=e)}}else if(0!==e){const t=this.getNextParagraphAfterPrediction();(null===(n=null==t?void 0:t.parent)||void 0===n?void 0:n.element)&&t.element&&(this._predictionHasWrappedOntoNewLineAtStartOfTile=t.id,this._predictionHasWrappedOntoNewLineCount=e,await this.insertNewLines(t.parent,t.element.offset,e))}}else 0!==e&&await this.clearCurrentPrediction(this._prediction,"Entity cannot wrap",S.R8.NotSeen)}async onPredictionUpdated(){const e=this._predictionUpdate+1;this._predictionUpdate=e;const t=this._predictionStore.getCurrentPrediction();t?await this.determineIfPredictionIsValidAndApply(t,e):(this._predictionHasWrappedOntoNewLineAtStartOfTile&&await this.removeWrappingNewLines(),this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionDisplayLocation=void 0,this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0,this._predictionFirstDisplayedTime=void 0,this._onUpdate&&this._onUpdate())}async determineIfPredictionIsValidAndApply(e,t,i,n,o,r,a){var d;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,S.R8.NotSeen);if(void 0!==o&&o!==l.Q0.Local&&r&&n&&i)return void await this.handleRemotePredictionUpdate(e,i,n,r);if(n&&n!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",S.R8.ExplicitRejection);const c=this.determineIfPredictionTextIsValid(e,r,a);if("result"in c){if(c.dueToMissingContainingHTMLElement)return;return void(c.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",S.R8.ExplicitRejection))}const{paragraphNode:u,paragraphNodeOffset:g,insertableTextStart:h,htmlParentElement:p,contentEditableHtmlParentElement:m,predictionText:f}=c,v=this._paragraphTextExtractor.getParagraphText(e.tileId),y=await this._tileContent.getRangeOfNode(u.parent,void 0,g+h-1,1),_=null==y?void 0:y.commonAncestorContainer.parentElement;if(y&&_){const i=y.getBoundingClientRect(),n=p.getBoundingClientRect();let o=0;if((0,s.C)(_,"HTMLElement")){const e=_.getBoundingClientRect(),t=new Range;t.setStart(_,0),t.setEnd(_,1);o=t.getBoundingClientRect().top-e.top}if(this._predictionHasWrappedOntoNewLineAtStartOfTile&&(null===(d=this.prediction)||void 0===d?void 0:d.annotationId)!==e.annotationId&&(await this.removeWrappingNewLines(),this._predictionHasWrappedOntoNewLineAtStartOfTile=void 0,this._predictionHasWrappedOntoNewLineCount=0),t<this._predictionUpdate)return;if(v!==this._paragraphTextExtractor.getParagraphText(e.tileId)){this._predictionDisplayText=void 0;const t=this._predictionUpdate+1;return this._predictionUpdate=t,void await this.determineIfPredictionIsValidAndApply(e,t)}const r=void 0===this._prediction;if(this._prediction=e,this._predictionParentElement=p,this._predictionContentEditableParentElement=m,this._predictionDisplayLocation={x:i.right-n.left,y:i.top-o-n.top},f.substring(h)===this._predictionDisplayText)return;this._predictionDisplayText=f.substring(h),r&&(this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e)),this._onUpdate&&this._onUpdate()}else await this.clearCurrentPrediction(e,"unable to determine range for prediction",S.R8.NotSeen)}};T=(0,n.__decorate)([(0,n.__param)(0,(0,g.W)(o.H)),(0,n.__param)(1,(0,g.W)(d.n)),(0,n.__param)(2,(0,g.W)(c.g)),(0,n.__param)(3,(0,g.W)(u.m)),(0,n.__param)(4,(0,g.W)(v.o)),(0,n.__param)(5,(0,g.W)(_.w)),(0,n.__param)(6,(0,g.W)(I.b)),(0,n.__param)(7,(0,g.W)(r.M5)),(0,n.__param)(8,(0,g.W)(C.d)),(0,n.__param)(9,(0,g.W)(a.o)),(0,n.__param)(10,(0,h.l)()),(0,n.__param)(10,(0,g.W)(m.A)),(0,n.__param)(11,(0,h.l)()),(0,n.__param)(11,(0,g.W)(f.V)),(0,n.__param)(12,(0,h.l)()),(0,n.__param)(12,(0,g.W)(y.Y))],T)},206264:(e,t,i)=>{i.d(t,{B:()=>n});const n=(0,i(668952).f)("ICritiqueFilterer")},206528:(e,t,i)=>{i.d(t,{K:()=>o});var n=i(794300);class s{async getEntry(e){return null}async setEntry(e,t){}async removeEntry(e){}}class o extends n.z{constructor(e){super(),this.params=e,this._initialized=!1,this._disposed=!1,this._onTileNodeCritiquesUpdated=e=>{this.publishEvent("tileNodeCritiquesUpdated",e)},this._onTilingEvent=e=>{var t;this.publishEvent("tilingEvent",e),null===(t=this._textAugmentationCore)||void 0===t||t.handleTilingEvent(e)},this._onTileCritiquesUpdated=e=>{var t;this.publishEvent("tileCritiquesUpdated",e),null===(t=this._textProcessorCore)||void 0===t||t.processTileCritiques({tileId:e.tileId,critiques:e.critiques})},this._onTileAdded=e=>{this.publishEvent("tileAdded",e)},this._onTileRemoved=e=>{this.publishEvent("tileRemoved",e)},this._onTileDelta=e=>{this.publishEvent("tileDelta",e)},this._onTextAugmentationReset=()=>{this.publishEvent("reset")},this._onLocalesChanged=async e=>{await this.setLocales(e.languageIds)},this._onTelemetryLog=e=>{this.publishEvent("telemetryLog",e)},this.initBaseServices()}get initialized(){return this._initialized}get disposed(){return this._disposed}get isDictionaryEnabled(){var e;return!!(null===(e=this._textAugmentationCore)||void 0===e?void 0:e.isDictionaryEnabled)}get isMultilingual(){var e;return!!(null===(e=this._textAugmentationCore)||void 0===e?void 0:e.isMultilingual)}async init(){this._initialized||(this._initialized=!0,await this.initDefinitions(),this.initEventsListeners())}async dispose(){var e,t,i;this._disposed||(this._disposed=!0,this.disposeEventsListeners(),await Promise.all([null===(e=this._ciqCore)||void 0===e?void 0:e.dispose(),null===(t=this._textProcessorCore)||void 0===t?void 0:t.dispose(),null===(i=this._textAugmentationCore)||void 0===i?void 0:i.dispose()]),this._baseServices=void 0,this._ciqCore=void 0,this._textAugmentationCore=void 0,this._textProcessorCore=void 0)}pushText(e,t){var i;null===(i=this._textProcessorCore)||void 0===i||i.pushText(e,t)}textLayoutReset(){this.publishEvent("textLayoutReset")}requestEntities(e){var t;null===(t=this._ciqCore)||void 0===t||t.requestEntities(e)}processSquiggleAction(e){var t;null===(t=this._textAugmentationCore)||void 0===t||t.processSquiggleAction(e)}async setLocales(e){var t,i;await(null===(t=this._textProcessorCore)||void 0===t?void 0:t.setLocales(e)),await(null===(i=this._textAugmentationCore)||void 0===i?void 0:i.setLocales(e))}async updateCritiqueSettings(e){var t;await(null===(t=this._textAugmentationCore)||void 0===t?void 0:t.updateCritiqueSettings(e))}async addWordToDictionary(e){var t;await(null===(t=this._textAugmentationCore)||void 0===t?void 0:t.addWordToDictionary(e))}submitTelemetryEvent(e){e.telemetryLog.timestamp||(e.telemetryLog.timestamp=(new Date).toISOString()),this.publishEvent("telemetryLog",e.telemetryLog)}instrument(e,t){var i;null===(i=this._textAugmentationCore)||void 0===i||i.instrument(e,t)}initBaseServices(){this._baseServices={localCache:new s}}async initDefinitions(){var e,t,i,n,s;if(!this._baseServices)return;const{definitions:{ciq:o,textProcessor:r,textAugmentation:a}}=this.params;this._ciqCore=null==o?void 0:o.create(),this._textProcessorCore=null==r?void 0:r.create(this._baseServices),await Promise.all([null===(e=this._ciqCore)||void 0===e?void 0:e.init(),null===(t=this._textProcessorCore)||void 0===t?void 0:t.init()]),this._textAugmentationCore=null==a?void 0:a.create(this._baseServices,null!==(n=null===(i=this._textProcessorCore)||void 0===i?void 0:i.getParagraphFinder())&&void 0!==n?n:void 0),await(null===(s=this._textAugmentationCore)||void 0===s?void 0:s.init())}initEventsListeners(){this.initTextProcessorCoreEventListeners(),this.initAugmentationCoreEventListeners(),this.initCiqCoreEventListeners()}disposeEventsListeners(){var e,t,i,n,s,o,r,a,l,d,c,u,g,h,p;null===(e=this._textProcessorCore)||void 0===e||e.unsubscribe("tilingEvent",this._onTilingEvent),null===(t=this._textProcessorCore)||void 0===t||t.unsubscribe("tileNodeCritiquesUpdated",this._onTileNodeCritiquesUpdated),null===(i=this._textProcessorCore)||void 0===i||i.unsubscribe("telemetryLog",this._onTelemetryLog),null===(n=this._textAugmentationCore)||void 0===n||n.unsubscribe("tileCritiquesUpdated",this._onTileCritiquesUpdated),null===(s=this._textAugmentationCore)||void 0===s||s.unsubscribe("tileAdded",this._onTileAdded),null===(o=this._textAugmentationCore)||void 0===o||o.unsubscribe("tileRemoved",this._onTileRemoved),null===(r=this._textAugmentationCore)||void 0===r||r.unsubscribe("tileDelta",this._onTileDelta),null===(a=this._textAugmentationCore)||void 0===a||a.unsubscribe("reset",this._onTextAugmentationReset),null===(l=this._textAugmentationCore)||void 0===l||l.unsubscribe("telemetryLog",this._onTelemetryLog),null===(d=this._textAugmentationCore)||void 0===d||d.unsubscribe("localesChanged",this._onLocalesChanged),null===(c=this._ciqCore)||void 0===c||c.unsubscribe("entitiesPartiallyUpdated",this._onEntitiesPartiallyUpdated.bind(this)),null===(u=this._ciqCore)||void 0===u||u.unsubscribe("entitiesUpdated",this._onEntitiesUpdated.bind(this)),null===(g=this._ciqCore)||void 0===g||g.unsubscribe("entitiesRequested",this._onEntitiesRequested.bind(this)),null===(h=this._ciqCore)||void 0===h||h.unsubscribe("entitiesRequestDismissed",this._onEntitiesRequestDismissed.bind(this)),null===(p=this._ciqCore)||void 0===p||p.unsubscribe("entitiesError",this._onEntitiesError.bind(this))}initTextProcessorCoreEventListeners(){this._textProcessorCore&&(this._textProcessorCore.subscribe("tilingEvent",this._onTilingEvent),this._textProcessorCore.subscribe("tileNodeCritiquesUpdated",this._onTileNodeCritiquesUpdated),this._textProcessorCore.subscribe("telemetryLog",this._onTelemetryLog))}initAugmentationCoreEventListeners(){this._textAugmentationCore&&(this._textAugmentationCore.subscribe("tileCritiquesUpdated",this._onTileCritiquesUpdated),this._textAugmentationCore.subscribe("tileAdded",this._onTileAdded),this._textAugmentationCore.subscribe("tileRemoved",this._onTileRemoved),this._textAugmentationCore.subscribe("tileDelta",this._onTileDelta),this._textAugmentationCore.subscribe("reset",this._onTextAugmentationReset),this._textAugmentationCore.subscribe("telemetryLog",this._onTelemetryLog),this._textAugmentationCore.subscribe("localesChanged",this._onLocalesChanged))}initCiqCoreEventListeners(){this._ciqCore&&(this._ciqCore.subscribe("entitiesPartiallyUpdated",this._onEntitiesPartiallyUpdated.bind(this)),this._ciqCore.subscribe("entitiesUpdated",this._onEntitiesUpdated.bind(this)),this._ciqCore.subscribe("entitiesRequested",this._onEntitiesRequested.bind(this)),this._ciqCore.subscribe("entitiesRequestDismissed",this._onEntitiesRequestDismissed.bind(this)),this._ciqCore.subscribe("entitiesError",this._onEntitiesError.bind(this)))}_onQueryDetected(e){var t;null===(t=this._ciqCore)||void 0===t||t.requestEntities(e)}_onTriggerIntentDetection(e){var t;null===(t=this._ciqCore)||void 0===t||t.triggerIntentDetection(e)}_onEntitiesPartiallyUpdated(e){this.publishEvent("entitiesPartiallyUpdated",e)}_onEntitiesUpdated(e){this.publishEvent("entitiesUpdated",e)}_onEntitiesRequested(e){this.publishEvent("entitiesRequested",e)}_onEntitiesError(e){this.publishEvent("entitiesError",e)}_onEntitiesRequestDismissed(){this.publishEvent("entitiesRequestDismissed")}getTileOffset(e){var t,i,n,s;return null!==(s=null===(n=null===(i=null===(t=this._textProcessorCore)||void 0===t?void 0:t.getParagraphFinder())||void 0===i?void 0:i.findParagraph(e))||void 0===n?void 0:n.range.offset)&&void 0!==s?s:-1}queryDetected(e){this._onQueryDetected(e)}triggerIntentDetection(e){this._onTriggerIntentDetection(e)}queryDismissed(){var e;null===(e=this._ciqCore)||void 0===e||e.dismissEntitiesRequest()}}},208171:(e,t,i)=>{i.d(t,{E:()=>o,r:()=>r});var n=i(146078),s=i(208520);class o extends n.z{constructor(e,t){super(e,t)}onAddModule(e){var t;"configureScopedServices"in e?null===(t=e.configureScopedServices)||void 0===t||t.call(e,this.container):"scopedProviders"in e&&e.scopedProviders&&this.bindProvidersToContainer(this.container,e.scopedProviders)}}const r=(0,s.createContext)(void 0)},210172:(e,t,i)=>{i.d(t,{z:()=>n});const n=(0,i(668952).f)("IPresentationSettings")},210934:(e,t,i)=>{function n(e,t,i){const n={};for(const s in i)n[e+"-"+s]=`${t} (${i[s]})`;return n}i.d(t,{p:()=>s});const s=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({"aa-dj":"Qafar (Yabuuti)","aa-er":"Qafar (Eretria)","aa-et":"Qafar (Otobbia)","af-na":"Afrikaans (Namibië)","af-za":"Afrikaans (Suid-Afrika)","agq-cm":"Aghem (Kàmàlûŋ)","ak-gh":"Akan (Gaana)","am-et":"አማርኛ (ኢትዮጵያ)","ar-001":["العربية (العالم)",!0],"ar-ae":["العربية (الإمارات العربية المتحدة)",!0],"ar-bh":["العربية (البحرين)",!0],"ar-dj":["العربية (جيبوتي)",!0],"ar-dz":["العربية (الجزائر)",!0],"ar-eg":["العربية (مصر)",!0],"ar-er":["العربية (إريتريا)",!0],"ar-il":["العربية (إسرائيل)",!0],"ar-iq":["العربية (العراق)",!0],"ar-jo":["العربية (الأردن)",!0],"ar-km":["العربية (جزر القمر)",!0],"ar-kw":["العربية (الكويت)",!0],"ar-lb":["العربية (لبنان)",!0],"ar-ly":["العربية (ليبيا)",!0],"ar-ma":["العربية (المملكة المغربية)",!0],"ar-mr":["العربية (موريتانيا)",!0],"ar-om":["العربية (عمان)",!0],"ar-ps":["العربية (السلطة الفلسطينية)",!0],"ar-qa":["العربية (قطر)",!0],"ar-sa":["العربية (المملكة العربية السعودية)",!0],"ar-sd":["العربية (السودان)",!0],"ar-so":["العربية (الصومال)",!0],"ar-ss":["العربية (جنوب السودان)",!0],"ar-sy":["العربية (سوريا)",!0],"ar-td":["العربية (تشاد)",!0],"ar-tn":["العربية (تونس)",!0],"ar-ye":["العربية (اليمن)",!0],"arn-cl":"Mapudungun (Chile)","as-in":"অসমীয়া (ভাৰত)","asa-tz":"Kipare (Tadhania)","ast-es":"asturianu (España)","az-cyrl-az":"азәрбајҹан (Азәрбајҹан)","az-latn-az":"azərbaycan (Azərbaycan)","ba-ru":"Башҡорт (Рәсәй)","bas-cm":"Ɓàsàa (Kàmɛ̀rûn)","be-by":"Беларуская (Беларусь)","bem-zm":"Ichibemba (Zambia)","bez-tz":"Hibena (Hutanzania)","bg-bg":"български (България)","bin-ng":"Ẹ̀dó (Nigeria)","bm-latn-ml":"bamanakan (Mali)","bn-bd":"বাংলা (বাংলাদেশ)","bn-in":"বাংলা (ভারত)","bo-cn":"བོད་ཡིག (ཀྲུང་ཧྭ་མི་དམངས་སྤྱི་མཐུན་རྒྱལ་ཁབ།)","bo-in":"བོད་སྐད་ (རྒྱ་གར་)","br-fr":"brezhoneg (Frañs)","brx-in":"बड़ो (भारत)","bs-cyrl-ba":"босански (Босна и Херцеговина)","bs-latn-ba":"bosanski (Bosna i Hercegovina)","byn-er":"ብሊን (ኤርትራ)","ca-ad":"català (Andorra)","ca-es":"català (català)","ca-es-valencia":"valencià (Espanya)","ca-fr":"català (França)","ca-it":"català (Itàlia)","ccp-cakm-bd":"𑄌𑄋𑄴𑄟𑄳𑄦 (𑄝𑄁𑄣𑄘𑄬𑄌𑄴)","ccp-cakm-in":"𑄌𑄋𑄴𑄟𑄳𑄦 (𑄞𑄢𑄧𑄖𑄴)","ce-ru":"нохчийн (Росси)","ceb-latn-ph":"Cebuano (Pilipinas)","cgg-ug":"Rukiga (Uganda)","chr-cher-us":"ᏣᎳᎩ (ᏌᏊ ᎢᏳᎾᎵᏍᏔᏅ ᏍᎦᏚᎩ)","co-fr":"Corsu (Francia)","cs-cz":"čeština (Česko)","cu-ru":"церковнослове́нскїй (рѡссі́а)","cy-gb":"Cymraeg (Y Deyrnas Unedig)","da-dk":"dansk (Danmark)","da-gl":"dansk (Grønland)","dav-ke":"Kitaita (Kenya)"},n("de","Deutsch",{at:"Österreich",be:"Belgien",ch:"Schweiz",de:"Deutschland",it:"Italien",li:"Liechtenstein",lu:"Luxemburg"})),{"dje-ne":"Zarmaciine (Nižer)","dsb-de":"dolnoserbšćina (Nimska)","dua-cm":"duálá (Cameroun)","dv-mv":["ދިވެހިބަސް (ދިވެހި ރާއްޖެ)",!0],"dyo-sn":"joola (Senegal)","dz-bt":"རྫོང་ཁ (འབྲུག)","ebu-ke":"Kĩembu (Kenya)","ee-gh":"Eʋegbe (Ghana nutome)","ee-tg":"Eʋegbe (Togo nutome)","el-cy":"Ελληνικά (Κύπρος)","el-gr":"Ελληνικά (Ελλάδα)"}),n("en","English",{"001":"World","029":"Caribbean",150:"Europe",ae:"United Arab Emirates",ag:"Antigua & Barbuda",ai:"Anguilla",as:"American Samoa",at:"Austria",au:"Australia",bb:"Barbados",be:"Belgium",bi:"Burundi",bm:"Bermuda",bs:"Bahamas",bw:"Botswana",bz:"Belize",ca:"Canada",cc:"Cocos (Keeling) Islands",ch:"Switzerland",ck:"Cook Islands",cm:"Cameroon",cx:"Christmas Island",cy:"Cyprus",de:"Germany",dk:"Denmark",dm:"Dominica",er:"Eritrea",fi:"Finland",fj:"Fiji",fk:"Falkland Islands",fm:"Micronesia",gb:"United Kingdom",gd:"Grenada",gg:"Guernsey",gh:"Ghana",gi:"Gibraltar",gm:"Gambia",gu:"Guam",gy:"Guyana",hk:"Hong Kong SAR",id:"Indonesia",ie:"Ireland",il:"Israel",im:"Isle of Man",in:"India",io:"British Indian Ocean Territory",je:"Jersey",jm:"Jamaica",ke:"Kenya",ki:"Kiribati",kn:"St. Kitts & Nevis",ky:"Cayman Islands",lc:"St. Lucia",lr:"Liberia",ls:"Lesotho",mg:"Madagascar",mh:"Marshall Islands",mo:"Macao SAR",mp:"Northern Mariana Islands",ms:"Montserrat",mt:"Malta",mu:"Mauritius",mw:"Malawi",my:"Malaysia",na:"Namibia",nf:"Norfolk Island",ng:"Nigeria",nl:"Netherlands",nr:"Nauru",nu:"Niue",nz:"New Zealand",pg:"Papua New Guinea",ph:"Philippines",pk:"Pakistan",pn:"Pitcairn Islands",pr:"Puerto Rico",pw:"Palau",rw:"Rwanda",sb:"Solomon Islands",sc:"Seychelles",sd:"Sudan",se:"Sweden",sg:"Singapore",sh:"St Helena, Ascension, Tristan da Cunha",si:"Slovenia",sl:"Sierra Leone",ss:"South Sudan",sx:"Sint Maarten",sz:"Eswatini",tc:"Turks & Caicos Islands",tk:"Tokelau",to:"Tonga",tt:"Trinidad & Tobago",tv:"Tuvalu",tz:"Tanzania",ug:"Uganda",um:"U.S. Outlying Islands",us:"United States",vc:"St. Vincent & Grenadines",vg:"British Virgin Islands",vi:"U.S. Virgin Islands",vu:"Vanuatu",ws:"Samoa",za:"South Africa",zm:"Zambia",zw:"Zimbabwe"})),{"eo-001":"esperanto (Mondo)"}),n("es","español",{419:"Latinoamérica",ar:"Argentina",bo:"Bolivia",br:"Brasil",bz:"Belice",cl:"Chile",co:"Colombia",cr:"Costa Rica",cu:"Cuba",do:"República Dominicana",ec:"Ecuador",es:"España, alfabetización internacional",es_tradnl:"España, alfabetización tradicional",gq:"Guinea Ecuatorial",gt:"Guatemala",hn:"Honduras",mx:"México",ni:"Nicaragua",pa:"Panamá",pe:"Perú",ph:"Filipinas",pr:"Puerto Rico",py:"Paraguay",sv:"El Salvador",us:"Estados Unidos",uy:"Uruguay",ve:"Venezuela"})),{"et-ee":"eesti (Eesti)","eu-es":"euskara (euskara)","ewo-cm":"ewondo (Kamərún)","fa-ir":["فارسی (ایران)",!0]}),n("ff-latn","Pulaar",{bf:"Burkibaa Faaso",cm:"Kameruun",gh:"Ganaa",gm:"Gammbi",gn:"Gine",gw:"Gine-Bisaawo",lr:"Liberiyaa",mr:"Muritani",ne:"Nijeer",ng:"Nijeriyaa",sl:"Seraa liyon",sn:"Senegaal"})),{"fi-fi":"suomi (Suomi)","fil-ph":"Filipino (Pilipinas)","fo-dk":"føroyskt (Danmark)","fo-fo":"føroyskt (Føroyar)"}),n("fr","français",{"029":"caraïbes",be:"Belgique",bf:"Burkina Faso",bi:"Burundi",bj:"Bénin",bl:"Saint-Barthélemy",ca:"Canada",cd:"Congo, République démocratique du",cf:"République centrafricaine",cg:"Congo",ch:"Suisse",ci:"Côte d’Ivoire",cm:"Cameroun",dj:"Djibouti",dz:"Algérie",fr:"France",ga:"Gabon",gf:"Guyane française",gn:"Guinée",gp:"Guadeloupe",gq:"Guinée équatoriale",ht:"Haïti",km:"Comores",lu:"Luxembourg",ma:"Maroc",mc:"Monaco",mf:"Saint-Martin",mg:"Madagascar",ml:"Mali",mq:"Martinique",mr:"Mauritanie",mu:"Maurice",nc:"Nouvelle-Calédonie",ne:"Niger",pf:"Polynésie française",pm:"Saint-Pierre-et-Miquelon",re:"La Réunion",rw:"Rwanda",sc:"Seychelles",sn:"Sénégal",sy:"Syrie",td:"Tchad",tg:"Togo",tn:"Tunisie",vu:"Vanuatu",wf:"Wallis-et-Futuna",yt:"Mayotte"})),{"fur-it":"furlan (Italie)","fy-nl":"Frysk (Nederlân)","ga-ie":"Gaeilge (Éire)","gd-gb":"Gàidhlig (An Rìoghachd Aonaichte)","gl-es":"galego (galego)","gn-py":"Avañe’ẽ (Paraguái)","gsw-ch":"Schwiizertüütsch (Schwiiz)","gsw-fr":"Elsässisch (Frànkrisch)","gsw-li":"Schwiizertüütsch (Liächteschtäi)","gu-in":"ગુજરાતી (ભારત)","guz-ke":"Ekegusii (Kenya)","gv-im":"Gaelg (Ellan Vannin)","ha-latn-gh":"Hausa (Gana)","ha-latn-ne":"Hausa (Nijar)","ha-latn-ng":"Hausa (Najeriya)","haw-us":"ʻŌlelo Hawaiʻi (ʻAmelika Hui Pū ʻIa)","he-il":["עברית (ישראל)",!0],"hi-in":"हिन्दी (भारत)","hr-ba":"hrvatski (Bosna i Hercegovina)","hr-hr":"hrvatski (Hrvatska)","hsb-de":"hornjoserbšćina (Němska)","hu-hu":"magyar (Magyarország)","hy-am":"Հայերեն (Հայաստան)","ia-001":"interlingua (Mundo)","ibb-ng":"Ibibio-Efik (Nigeria)","id-id":"Indonesia (Indonesia)","ig-ng":"Asụsụ Igbo (Naịjịrịa)","ii-cn":"ꆈꌠꁱꂷ (ꍏꉸꏓꂱꇭꉼꇩ)","is-is":"íslenska (Ísland)","it-ch":"italiano (Svizzera)","it-it":"italiano (Italia)","it-sm":"italiano (San Marino)","it-va":"italiano (Città del Vaticano)","iu-cans-ca":"ᐃᓄᒃᑎᑐᑦ (ᑲᓇᑕᒥ)","iu-latn-ca":"Inuktitut (Kanatami)","ja-jp":"日本語 (日本)","jgo-cm":"Ndaꞌa (Kamɛlûn)","jmc-tz":"Kimachame (Tanzania)","jv-java-id":"ꦧꦱꦗꦮ (Indonesia)","jv-latn-id":"Basa Jawa (Indonesia)","ka-ge":"ქართული (საქართველო)","kab-dz":"Taqbaylit (Lezzayer)","kam-ke":"Kikamba (Kenya)","kde-tz":"Chimakonde (Tanzania)","kea-cv":"kabuverdianu (Kabu Verdi)","khq-ml":"Koyra ciini (Maali)","ki-ke":"Gikuyu (Kenya)","kk-kz":"қазақ тілі (Қазақстан)","kkj-cm":"kakɔ (Kamɛrun)","kl-gl":"kalaallisut (Kalaallit Nunaat)","kln-ke":"Kalenjin (Emetab Kenya)","km-kh":"ខ្មែរ (កម្ពុជា)","kn-in":"ಕನ್ನಡ (ಭಾರತ)","ko-kp":"한국어 (조선민주주의인민공화국)","ko-kr":"한국어(대한민국)","kok-in":"कोंकणी (भारत)","kr-latn-ng":"Kanuri (Nigeria)","ks-arab-in":"کٲشُر (اَربی)","ks-deva-in":"कॉशुर","ksb-tz":"Kishambaa (Tanzania)","ksf-cm":"rikpa (kamɛrún)","ksh-de":"Kölsch (Doütschland)","ku-arab-iq":["کوردیی ناوەڕاست (عێراق)",!0],"ku-arab-ir":"کوردی (ئێران)","kw-gb":"kernewek (Rywvaneth Unys)","ky-kg":"кыргызча (Кыргызстан)","la-001":"lingua latīna (World)","lag-tz":"Kɨlaangi (Taansanía)","lb-lu":"Lëtzebuergesch (Lëtzebuerg)","lg-ug":"Luganda (Yuganda)","lkt-us":"Lakȟólʼiyapi (Mílahaŋska Tȟamákȟočhe)","ln-ao":"lingála (Angóla)","ln-cd":"lingála (Republíki ya Kongó Demokratíki)","ln-cf":"lingála (Repibiki ya Afríka ya Káti)","ln-cg":"lingála (Kongo)","lo-la":"ລາວ (ລາວ)","lrc-iq":"لۊری شومالی (Iraq)","lrc-ir":"لۊری شومالی (Iran)","lt-lt":"lietuvių (Lietuva)","lu-cd":"Tshiluba (Ditunga wa Kongu)","luo-ke":"Dholuo (Kenya)","luy-ke":"Luluhia (Kenya)","lv-lv":"latviešu (Latvija)","mas-ke":"Maa (Kenya)","mas-tz":"Maa (Tansania)","mer-ke":"Kĩmĩrũ (Kenya)","mfe-mu":"kreol morisien (Moris)","mg-mg":"Malagasy (Madagasikara)","mgh-mz":"Makua (Umozambiki)","mgo-cm":"metaʼ (Kamalun)","mi-nz":"te reo Māori (Aotearoa)","mk-mk":"македонски (Северна Македонија)","ml-in":"മലയാളം (ഇന്ത്യ)","mn-mn":"монгол (Монгол)","mn-mong-cn":"ᠮᠣᠩᠭᠣᠤᠯ ᠬᠡᠯᠡ (ᠪᠦᠭᠦᠳᠡ ᠨᠠᠢᠷᠠᠮᠳᠠᠬᠤ ᠳᠤᠮᠳᠠᠳᠤ ᠠᠷᠠᠳ ᠣᠯᠣᠰ)","mn-mong-mn":"ᠮᠣᠩᠭᠣᠯ ᠬᠡᠯᠡ (ᠮᠣᠩᠭᠣᠯ ᠣᠯᠣᠰ)","mni-in":"মৈতৈলোন্ (India)","moh-ca":"Kanien'kéha","mr-in":"मराठी (भारत)","ms-bn":"Melayu (Brunei)","ms-my":"Melayu (Malaysia)","ms-sg":"Melayu (Singapura)","mt-mt":"Malti (Malta)","mua-cm":"MUNDAŊ (kameruŋ)","my-mm":"မြန်မာ (မြန်မာ)","mzn-ir":"مازرونی (ایران)","naq-na":"Khoekhoegowab (Namibiab)","nb-no":"norsk bokmål (Norge)","nb-sj":"norsk bokmål (Svalbard og Jan Mayen)","nd-zw":"isiNdebele (Zimbabwe)","nds-de":"Neddersass’sch (Düütschland)","nds-nl":"Neddersass’sch (Nedderlannen)","ne-in":"नेपाली (भारत)","ne-np":"नेपाली (नेपाल)"}),n("nl","Nederlands",{aw:"Aruba",be:"België",bq:"Bonaire, Sint Eustatius en Saba",cw:"Curaçao",nl:"Nederland",sr:"Suriname",sx:"Sint-Maarten"})),{"nmg-cm":"Kwasio (Kamerun)","nn-no":"nynorsk (Noreg)","nnh-cm":"Shwóŋò ngiembɔɔn (Kàmalûm)","nqo-gn":["ߒߞߏ (ߖߌ߬ߣߍ߬ ߞߊ߲ߓߍ߲)",!0],"nr-za":"isiNdebele (South Africa)","nso-za":"Sesotho sa Leboa (Afrika Borwa)","nus-ss":"Thok Nath (South Sudan)","nyn-ug":"Runyankore (Uganda)","oc-fr":"Occitan (França)","om-et":"Oromoo (Itoophiyaa)","om-ke":"Oromoo (Keeniyaa)","or-in":"ଓଡ଼ିଆ (ଭାରତ)","os-ge":"ирон (Гуырдзыстон)","os-ru":"ирон (Уӕрӕсе)","pa-arab-pk":["پنجابی (پاکستان)",!0],"pa-in":"ਪੰਜਾਬੀ (ਭਾਰਤ)","pap-029":"Papiamentu (Caribbean)","pl-pl":"polski (Polska)","prg-001":"prūsiskan (swītai)","prs-af":["درى (افغانستان)",!0],"ps-af":["پښتو (افغانستان)",!0],"ps-pk":["پښتو (پاکستان)",!0]}),n("pt","português",{ao:"Angola",br:"Brasil",ch:"Suíça",cv:"Cabo Verde",gq:"Guiné Equatorial",gw:"Guiné-Bissau",lu:"Luxemburgo",mo:"RAE de Macau",mz:"Moçambique",pt:"Portugal",st:"São Tomé e Príncipe",tl:"Timor-Leste"})),{"qps-latn-x-sh":"Pśęüďό Sęłfhóšť","qps-ploc":"[Þšéųδô (Ρŝέũδθ) !!! !!]","qps-ploca":"[Ρšēŭďõ ₤áηğűãĝè (Þ§эūðò Αśĩä) !!! !!! ]","qps-plocm":["[Þ§ėΰðό £äπĝúаğę (Рŝéûďб Μίяřóŗ℮ď) !!! !!! !]",!0],"quc-latn-gt":"K'iche' (Guatemala)","quz-bo":"Runasimi (Bolivia)","quz-ec":"Runasimi (Ecuador)","quz-pe":"Runasimi (Perú)","rm-ch":"rumantsch (Svizra)","rn-bi":"Ikirundi (Uburundi)","ro-md":"română (Republica Moldova)","ro-ro":"română (România)","rof-tz":"Kihorombo (Tanzania)"}),n("ru","русский",{by:"Беларусь",kg:"Киргизия",kz:"Казахстан",md:"Молдова",ru:"Россия",ua:"Украина"})),{"rw-rw":"Kinyarwanda (U Rwanda)","rwk-tz":"Kiruwa (Tanzania)","sa-in":"संस्कृत (भारतम्)","sah-ru":"Саха (Россия)","saq-ke":"Kisampur (Kenya)","sbp-tz":"Ishisangu (Tansaniya)","sd-arab-pk":["سنڌي (پاکستان)",!0],"sd-deva-in":"सिन्धी (India)","se-fi":"davvisámegiella (Suopma)","se-no":"davvisámegiella (Norga)","se-se":"davvisámegiella (Ruoŧŧa)","seh-mz":"sena (Moçambique)","ses-ml":"Koyraboro senni (Maali)","sg-cf":"Sängö (Ködörösêse tî Bêafrîka)","shi-latn-ma":"Tashelḥiyt (lmɣrib)","shi-tfng-ma":"ⵜⴰⵛⵍⵃⵉⵜ (ⵍⵎⵖⵔⵉⴱ)","si-lk":"සිංහල (ශ්‍රී ලංකාව)","sk-sk":"slovenčina (Slovensko)","sl-si":"slovenščina (Slovenija)","sma-no":"åarjelsaemiengïele (Nöörje)","sma-se":"åarjelsaemiengïele (Sveerje)","smj-no":"julevusámegiella (Vuodna)","smj-se":"julevusámegiella (Svierik)","smn-fi":"anarâškielâ (Suomâ)","sms-fi":"sää´mǩiõll (Lää´ddjânnam)","sn-latn-zw":"chiShona (Zimbabwe)"}),n("so","Soomaali",{dj:"Jabuuti",et:"Itoobiya",ke:"Kenya",so:"Soomaaliya"})),{"sq-al":"shqip (Shqipëri)","sq-mk":"shqip (Maqedonia e Veriut)","sq-xk":"shqip (Kosovë)"}),n("sr-cyrl","српски",{ba:"Босна и Херцеговина",cs:"Србија и Црна Гора (Бивша)",me:"Црна Гора",rs:"Србија",xk:"Косово"})),n("sr-latn","srpski",{ba:"Bosna i Hercegovina",cs:"Srbija i Crna Gora (Bivša)",me:"Crna Gora",rs:"Srbija",xk:"Kosovo"})),{"ss-sz":"siSwati (eSwatini)","ss-za":"siSwati (South Africa)","ssy-er":"Saho (Eretria)","st-ls":"Sesotho (Lesotho)","st-za":"Sesotho (South Africa)","sv-ax":"svenska (Åland)","sv-fi":"svenska (Finland)","sv-se":"svenska (Sverige)"}),n("sw","Kiswahili",{cd:"Jamhuri ya Kidemokrasia ya Kongo",ke:"Kenya",tz:"Tanzania",ug:"Uganda"})),{"syr-sy":["ܣܘܪܝܝܐ (ܣܘܪܝܐ)",!0],"ta-in":"தமிழ் (இந்தியா)","ta-lk":"தமிழ் (இலங்கை)","ta-my":"தமிழ் (மலேசியா)","ta-sg":"தமிழ் (சிங்கப்பூர்)","te-in":"తెలుగు (భారతదేశం)","teo-ke":"Kiteso (Kenia)","teo-ug":"Kiteso (Uganda)","tg-cyrl-tj":"тоҷикӣ (Тоҷикистон)","th-th":"ไทย (ไทย)","ti-er":"ትግርኛ (ኤርትራ)","ti-et":"ትግርኛ (ኢትዮጵያ)","tig-er":"ትግረ (ኤርትራ)","tk-tm":"Türkmen dili (Türkmenistan)","tn-bw":"Setswana (Botswana)","tn-za":"Setswana (Aforika Borwa)","to-to":"lea fakatonga (Tonga)","tr-cy":"Türkçe (Kıbrıs)","tr-tr":"Türkçe (Türkiye)","ts-za":"Xitsonga (South Africa)","tt-ru":"Татар (Россия)","twq-ne":"Tasawaq senni (Nižer)","tzm-arab-ma":["أطلس المركزية التامازيتية (Morocco)",!0],"tzm-latn-dz":"Tamaziɣt n laṭlaṣ (Djazaïr)","tzm-latn-ma":"Tamaziɣt n laṭlaṣ (Meṛṛuk)","tzm-tfng-ma":"ⵜⴰⵎⴰⵣⵉⵖⵜ (ⵍⵎⵖⵔⵉⴱ)","ug-cn":["ئۇيغۇرچە (جۇڭخۇا خەلق جۇمھۇرىيىتى)",!0],"uk-ua":"українська (Україна)","ur-in":["اردو (بھارت)",!0],"ur-pk":["اُردو (پاکستان)",!0],"uz-arab-af":"اوزبیک (افغانستان)","uz-cyrl-uz":"ўзбекча (Ўзбекистон)","uz-latn-uz":"o‘zbek (Oʻzbekiston)","vai-latn-lr":"Vai (Laibhiya)","vai-vaii-lr":"ꕙꔤ (ꕞꔤꔫꕩ)","ve-za":"Tshivenḓa (South Africa)","vi-vn":"Tiếng Việt (Việt Nam)","vo-001":"Volapük (World)","vun-tz":"Kyivunjo (Tanzania)","wae-ch":"Walser (Schwiz)","wal-et":"ወላይታቱ (ኢትዮጵያ)","wo-sn":"Wolof (Senegaal)","xh-za":"isiXhosa (eMzantsi Afrika)","xog-ug":"Olusoga (Yuganda)","yav-cm":"nuasue (Kemelún)","yi-001":["ייִדיש (וועלט)",!0],"yo-bj":"Èdè Yorùbá (Orílɛ́ède Bɛ̀nɛ̀)","yo-ng":"Èdè Yorùbá (Orilẹ̀-èdè Nàìjíríà)","zgh-tfng-ma":"ⵜⴰⵎⴰⵣⵉⵖⵜ (ⵍⵎⵖⵔⵉⴱ)","zh-cn":"中文(中国)","zh-hk":"中文(香港特別行政區)","zh-hans-hk":"中文 (香港特别行政区)","zh-hans-mo":"中文 (澳门特别行政区)","zh-mo":"中文(澳門特別行政區)","zh-sg":"中文(新加坡)","zh-tw":"中文(台灣)","zu-za":"isiZulu (iNingizimu Afrika)"})},211751:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":true,"LocalizedName":"Краткость"},"Consistent Written Forms":{"LocalizedName":"Единообразие написания","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Недискриминационный язык","IsImplemented":true},"Typing errors":{"LocalizedName":"Опечатки","IsImplemented":false},"Clarity":{"LocalizedName":"Ясность","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"Переписывание","IsImplemented":false},"Error Corrections":{"LocalizedName":"Исправление ошибок","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Выбор слов и выражений","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Грамматика"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Официальный язык"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Стандарты пунктуации"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"LocalizedName":"Стандарты письменной речи","IsImplemented":false},"Spelling":{"LocalizedName":"Орфография","IsImplemented":true},"Resume":{"LocalizedName":"Автобиография","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":true,"LocalizedName":"Геополитические термины"}}')},212107:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Takikupu"}}')},213633:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Litreachadh","IsImplemented":true}}')},213983:(e,t,i)=>{function n(e,t,i,n){return s((i=>e.requestAnimationFrame(i,t)),i,n)}function s(e,t,i){let n=!1,o=!1;const r=[];let a=!1;return()=>new Promise((async l=>{if("Immediately"===i){if(!n){n=!0;try{await t()}catch(e){}e((()=>{n=!1,l()}))}}else n?(a&&(o=!0),r.push(l)):(n=!0,e((async()=>{a=!0;try{await t()}catch(e){}a=!1,n=!1,l();for(const e of r)e();o&&(o=!1,s(e,t,i))})))}))}i.d(t,{ek:()=>s,hQ:()=>n})},215926:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(668952).f)("ISessionContextProvider")},218679:(e,t,i)=>{i.d(t,{f:()=>b,g:()=>S});var n=i(379490),s=i(630501),o=i(754270),r=i(163573),a=i(877931),l=i(494888),d=i(46692),c=i(122107),u=i(756857),g=i(937126),h=i(93659),p=i(429712),m=i(17384),f=i(486138),v=i(781729),y=i(229906),_=i(83010),I=i(427603),C=i(208520);const S={undoButton:"ebx_undoButton",settingsButton:"ebx_settingsButton"};let b=class extends s.z{get undoCardRef(){return this._undoCardRef}get undoCardV9Ref(){return this._undoCardV9Ref}get isVisible(){return this._isVisible}get target(){return this._target}get targetRect(){return this._targetRect||(this._targetRect=this.getTargetRect()),this._targetRect}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:0}get setInitialFocus(){var e;return null!==(e=this._setInitialFocus)&&void 0!==e&&e}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}get mainFocusZoneId(){return"calloutMain--undo"}get undoTitle(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,i=this.localizer.getMessage("ebx_autoCorrectRevertTo",t);return this.validator.validate(i)}get undoAriaLabel(){var e;if(!(null===(e=this.critique)||void 0===e?void 0:e.suggestions[0]))return"";const t=this.critique.suggestions[0].text,i=t.split("").join(" "),n=this.localizer.getMessage("ebx_autoCorrectRevertTo",t),s=this.localizer.getMessage("ebx_undoButtonAriaLabel");return this.validator.validate(`${s}, ${n}, ${i}`)}get showEditorBranding(){return!!this.hostSettings.undoCardShowEditorLogo}get styles(){return this.styleDefinitions.undoCallout}constructor(e,t,i,n,s,o,r,a,l,d){var u;let g;super(),this.localizer=e,this.hostSettings=t,this.externalSettingsFeature=i,this.logger=n,this.wordDictionary=s,this._ariaStatusStateStore=o,this._featureFlagsReader=r,this.validator=a,this.instrumentationProcessor=l,this.styleDefinitions=d,this._undoCardRef=C.createRef(),this._undoCardV9Ref=C.createRef(),this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._unsignedInEditorFeatureEnabled=!1,this.getTargetRect=()=>{var e,t;if(this.target)return(0,h.Pe)(this.target)?{left:this.target.x,right:this.target.x,top:this.target.y,bottom:this.target.y,width:0,height:0}:(0,h.K2)(this.target)?{left:this.target.left,right:null!==(e=this.target.right)&&void 0!==e?e:0,top:this.target.top,bottom:null!==(t=this.target.bottom)&&void 0!==t?t:0,width:this.target.width,height:this.target.height}:this.target.getBoundingClientRect()},this.executeShowOptionsAction=()=>{this.showOptionsAction&&this.showOptionsAction()},this.setShowOptionsAction=e=>{e&&(this.showOptionsAction=e)},this.notifyAriaStatusChange=(e,t)=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(this.localizer.getMessage(e,t),"assertive")},this.recordInstrumentationEventId=e=>{this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e)},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:this.critique,eventId:e})},(null===(u=this.externalSettingsFeature)||void 0===u?void 0:u.openSettings)&&(g=()=>{var e;null===(e=this.externalSettingsFeature)||void 0===e||e.openSettings(c.kY.dropdown)}),this.setShowOptionsAction(g)}checkShowConditions(e){return!!this.hostSettings.enableAutoCorrect}async prepareShowContent(e){const{onApplySuggestion:t,critique:i,onCalloutPositionUpdated:n}=e;this.critique=i,this.onApplySuggestion=t,this.onCalloutPositionUpdated=n}hide(e){this.isVisible&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isVisible&&(this.resetVariablesAfterHide(),this.onDismiss(e))}resetVariablesAfterHide(){this._isVisible=!1,this._target=void 0,this._targetRect=void 0,this._gapSpace=void 0,this.instrumentationEventId=void 0,this.onApplySuggestion=void 0,this.critique=void 0,this.publishEvent("visibilityUpdated",this._isVisible)}onDismiss(e){var t;null===(t=this.onDismissCallback)||void 0===t||t.call(this,e),this.onDismissCallback=void 0}async show(e){if(!this.checkShowConditions(e))return;const{setInitialFocus:t,target:i,onDismiss:n,gapSpace:s}=e;this._target=i,this._gapSpace=s,this._setInitialFocus=t,this.onDismiss(!1),this.onDismissCallback=n,await this.prepareShowContent(e),this._isVisible=!0,this.publishEvent("visibilityUpdated",this._isVisible),this.doAfterShow()}doAfterShow(){this.logUndoCalloutOpened()}logUndoCalloutOpened(){const e=this.logger.getNewActivity(o.n.UndoCalloutShown,d.o.SamplingPolicy.CriticalExperimentation);e&&(e.success=!0,e.endNow())}clickNoActionHide(e){this.isVisible&&this.recordInstrumentationEventId(12),this.hide(e)}applyUndo(){if(this.onApplySuggestion&&this.critique&&this.critique.suggestions.length){const e=this.critique.suggestions[0];this.onApplySuggestion(this.critique,e),this.wordDictionary.addWordToIgnoreList(e.text),this.notifyAriaStatusChange("ebx_autoCorrectIgnored",e.text),this.recordInstrumentationEventId(16)}this.hide()}openSettings(){this.executeShowOptionsAction(),this.hide()}updateCalloutPosition(e,t){var i,n,s;if(this.onCalloutPositionUpdated){const o=t?null===(s=null===(n=this._undoCardV9Ref.current)||void 0===n?void 0:n.getElementRef().current)||void 0===s?void 0:s.firstChild:null===(i=this._undoCardRef.current)||void 0===i?void 0:i.firstChild;if(o){const t=o.getBoundingClientRect();this.onCalloutPositionUpdated(e,t)}}}};b=(0,n.__decorate)([(0,y._)(),(0,n.__param)(0,(0,_.W)(u.H)),(0,n.__param)(1,(0,_.W)(r.n)),(0,n.__param)(2,(0,I.l)()),(0,n.__param)(2,(0,_.W)(c.In)),(0,n.__param)(3,(0,_.W)(a.g)),(0,n.__param)(4,(0,_.W)(v.s)),(0,n.__param)(5,(0,_.W)(p.QV)),(0,n.__param)(6,(0,_.W)(l.c)),(0,n.__param)(7,(0,_.W)(f.$)),(0,n.__param)(8,(0,_.W)(g.f)),(0,n.__param)(9,(0,_.W)(m.$))],b)},219515:(e,t,i)=>{if(i.d(t,{u:()=>o}),0!=i.j)var n=i(502929);var s=i(208520);const o=e=>{const{squigglesProps:t,hostSettings:i,ariaStatusUpdatesOnly:o}=e;return o?s.createElement(s.Fragment,null):s.createElement(s.Fragment,null,t.map(((e,t)=>s.createElement(n.hJ,Object.assign({key:t.toString()},e,{squiggleKind:"critique",useAltHotkey:!!i.useAlternativeSquiggleHotkey})))))}},221489:(e,t,i)=>{var n,s,o;i.d(t,{jf:()=>s}),function(e){e[e.Unknown=0]="Unknown",e[e.Title=1]="Title",e[e.Subtitle=2]="Subtitle",e[e.Heading1=3]="Heading1",e[e.Heading2=4]="Heading2",e[e.Heading3=5]="Heading3"}(n||(n={})),function(e){e.Installed="Installed",e.NotInstalled="NotInstalled"}(s||(s={})),function(e){e.Query="Query",e.Action="Action"}(o||(o={}))},222139:(e,t,i)=>{i.d(t,{z:()=>n});const n=4e3},222145:(e,t,i)=>{i.d(t,{o:()=>n});const n={NumProofingLanguages:"NumProofingLanguages"}},224557:(e,t,i)=>{i.d(t,{b:()=>b});var n=i(379490),s=i(823325),o=i(329423),r=i(279e3),a=i(781729),l=i(438343),d=i(494888),c=i(877931);var u=i(412694),g=i(909113),h=i(766535),p=i(186438),m=i(799873),f=i(659175);function v(e,t,i,n,r,a,l=!1,d,c,g=!0){if(!t&&0===n&&!r)return;const f={offset:e.start,span:e.length},v={offset:i,span:n},_=(!y(t,g)||i===e.start)&&(i!==e.start+e.length||a!==s.G.RemoveData||void 0===r||!y(r,g))&&(l||i+n===e.start||i===e.start+e.length)&&function(e){return!(0,h.oe)(e.typeId)||e.typeId===h.L9.CIQFlag_DateEntityRecognition||e.typeId===h.L9.CIQFlag_PersonEntityRecognition||e.typeId===h.L9.HeadingDetection||e.typeId===h.L9.CIQFlag_TaskRecognition}(e);if((0,u.D)(f,v)||_&&(0,u.M)(f,v)){if((0,p.A_)(e)){if(null==c?void 0:c.getAutoCorrectionIsBeingApplied(e))return;(0,m.yf)(e,d)}return{critique:e,critiqueDiffType:o.K.Delete}}}function y(e,t){return 1===e.length&&(g.xC(e.charCodeAt(0))||t&&(0,f.B)(e))}var _=i(413835),I=i(229906),C=i(83010),S=i(427603);let b=class{constructor(e,t,i,n,o){this._critiqueStore=e,this._featureFlagsReader=t,this._logger=i,this._wordDictionary=n,this._autoCorrectionBroker=o,this.calcLengths=e=>function(e,t,i,n=!1){var o;let r=null!=t?t:0,a=0;switch(i){case s.G.NewData:a=null!==(o=null==e?void 0:e.length)&&void 0!==o?o:r,n||(r=a);break;case s.G.RemoveData:a=-r;break;case s.G.ChangeData:a=e?e.length-r:a}return{length:r,lengthDiff:a}}(e.content,e.length,e.eventType,this._featureFlagsReader.flags.disableCalcLengthForAddDeltasInPresentation),this.deletedDiff=(e,t,i,n,s,o,r=!1)=>v(e,t,i,n,s,o,r,this._wordDictionary,this._autoCorrectionBroker)}onEvent(e){var t,i;const n=this._critiqueStore.getCritiques(e.tileId);if(!n||!(0,_.d)(n,e.tileVersion))return;const{length:r,lengthDiff:a}=this.calcLengths(e),l=null!==(t=e.position)&&void 0!==t?t:0,d=[];for(const t of n.critiques){const n=this.deletedDiff(t,null!==(i=e.content)&&void 0!==i?i:"",l,r,e.deletedOrReplacedCharacters,e.eventType,e.eventType!==s.G.ChangeData);if(n)d.push(n);else if(t.start>=l&&0!==a){const e=t.start;t.start+=a,d.push({critique:t,critiqueDiffType:o.K.Move,oldStart:e})}}this._critiqueStore.updateNode(d,e.tileId,e.tileVersion)}};b=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.W)(r.$)),(0,n.__param)(1,(0,C.W)(d.c)),(0,n.__param)(2,(0,C.W)(c.g)),(0,n.__param)(3,(0,S.l)()),(0,n.__param)(3,(0,C.W)(a.s)),(0,n.__param)(4,(0,S.l)()),(0,n.__param)(4,(0,C.W)(l.m))],b)},225443:(e,t,i)=>{i.d(t,{p:()=>f});var n=i(379490),s=i(576516),o=i(728671),r=i(647879),a=i(823325),l=i(537969),d=i(909113);var c=i(811861),u=i(418876),g=i(955146),h=i(147090),p=i(229906),m=i(1144);let f=class{get prediction(){return this._prediction}get predictionDisplayText(){return this._predictionDisplayText}get predictionDisplayLocation(){return this._predictionDisplayLocation}get predictionParentElement(){return this._predictionParentElement}get predictionContentEditableParentElement(){return this._predictionContentEditableParentElement}get multiPredictionMenuOpen(){return this._multiPredictionMenuOpen}get predictionFirstDisplayedTime(){return this._predictionFirstDisplayedTime}get localizer(){return this._localizer}constructor(e,t,i,n,l,d,g,p,m,f,v,y,_){this._localizer=e,this._hostSettings=t,this._logger=i,this._oaLogger=n,this._predictionStore=l,this._proofingDom=d,this._paragraphTextExtractor=g,this._tileContent=p,this._hostEmitter=m,this._userProfilePictureCache=f,this._inlineSuggestionsRenderer=v,this._nudgeStore=y,this._proofingEmitter=_,this._isActivelyAddingWrappingNewLines=!1,this._predictionUpdate=0,this._multiPredictionMenuOpen=!1,this.supportsPredictionType=e=>e===s.c.Text||e===s.c.PIM||e===s.c.Topic||this.isEntityPrediction(e),this.isEntityPrediction=e=>e===s.c.File||e===s.c.People||e===s.c.Loop||e===s.c.PIM,this.eccStateChanged=e=>{var t;e.messageType===a.G.RemoveData&&(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableZeroQueryHintText)&&this._predictionStore.clearPrediction()},this.getPredictionFirstItem=e=>e.entityResults&&e.entityResults.entities[0],this.onPredictionUpdatedInternal=async()=>{var e,t,i,n,s,o,r,a;const l=this._predictionStore.getCurrentPrediction();if(l){if(this.isPredictionDisabledForEntityType(null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions,l.entityType))return void await this._predictionStore.clearPrediction();if((null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===i?void 0:i.shouldRenderPrediction)&&!this._hostSettings.serviceSettings.predictions.shouldRenderPrediction(l))return void await this._predictionStore.clearPrediction();if(void 0!==(null===(n=this._inlineSuggestionsRenderer)||void 0===n?void 0:n.getCurrentMenuInfo())&&!l.isHelperText)return void(this._multiPredictionMenuOpen||(this._prediction?await this.clearCurrentPrediction(l,"ECC open",c.R8.ImplicitRejection):await this._predictionStore.clearPrediction()));if(this.isEntityPrediction(l.entityType)){if(!(null===(o=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.predictions)||void 0===o?void 0:o.onInsertEntityPrediction)||!this._inlineSuggestionsRenderer)return void await this._predictionStore.clearPrediction();if(!await this.prepareEntityPredictions(l))return void await this._predictionStore.clearPrediction()}if((null===(r=this._prediction)||void 0===r?void 0:r.context)&&l.context&&l.context+l.text===this._prediction.context+this._prediction.text&&l.context.startsWith(this._prediction.context))return;(null===(a=this._nudgeStore)||void 0===a?void 0:a.getCurrentNudge())&&await this._nudgeStore.clearNudge()}await this.onPredictionUpdated()},this.prepareEntityPredictions=async e=>{var t,i,n;if(e.entityType===s.c.People){if(e.entityResults){if((null===(t=e.context)||void 0===t?void 0:t.endsWith(e.text))||(null===(i=e.context)||void 0===i?void 0:i.endsWith(e.text+" ")))return!1;for(const t of e.entityResults.entities)t.imageUrl=await(null===(n=this._userProfilePictureCache)||void 0===n?void 0:n.fetchProfilePicture((0,h.u)(t)))}}else e.shouldDismissOnTextChange=!0;return!0},this.checkIfEntityPredictionContextIsValid=(e,t,i)=>(e.entityType===s.c.People&&e.entityResults&&(t.endsWith(" ")||this.prepareEntityPredictionForTextUpdate(e,t)),!0),this.prepareEntityPredictionForTextUpdate=(e,t)=>{var i;if(e.entityType===s.c.People){if(null===(i=e.entityResults)||void 0===i?void 0:i.entities){const i=t.substring(e.startIndex);for(const t of e.entityResults.entities)if(t.text.startsWith(i)){e.text=t.text;break}}e.entityResults=void 0}},this.onEntityDropdownOpened=(e,t)=>{var i;if(!this._prediction)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no prediction was available");let n=[];const o=this._prediction.entityType;if(o===s.c.File)n=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:s.c.File,text:e.FileName,isBestMatch:!1}))),entityType:this._prediction.entityType}];else if(o===s.c.People){const e=this._prediction;if(!e.entityResults)return void this._oaLogger.logDiagnostics("Entity prediction dropdown selected, but no people prediction items were available");n=[{entities:e.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:s.c.People,text:e.DisplayName,isBestMatch:!1}))),entityType:this._prediction.entityType}]}else o===s.c.Loop?n=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:s.c.Loop,text:e.text,isBestMatch:!1}))),entityType:this._prediction.entityType}]:o===s.c.PIM&&(n=[{entities:this._prediction.entityResults.entities.map((e=>Object.assign(Object.assign({},e),{entityType:s.c.PIM,isBestMatch:!1}))),entityType:this._prediction.entityType}]);this._multiPredictionMenuOpen=!0,null===(i=this._inlineSuggestionsRenderer)||void 0===i||i.showEntityPrediction(this._prediction.tileId,this._prediction.startIndex,n,this.onApplyEntityPrediction,(()=>{this._multiPredictionMenuOpen=!1}),t.getBoundingClientRect())},this.onApplyEntityPrediction=e=>{this.applyCurrentPrediction(c.Vn,e)},this.handleTextTile=e=>{if(this._prediction&&e.message.messageType===a.G.RemoveData){const t=e.message.data.tileId;this._prediction.tileId!==t&&this._proofingDom.findParagraphNode(this._prediction.tileId)||this.clearCurrentPrediction(this._prediction,"tile removed",c.R8.ImplicitRejection)}},this.hostModelVisualStateChange=e=>{var t,i;const n=null!==(t=this._prediction)&&void 0!==t?t:this._predictionStore.getCurrentPrediction();if(n&&e.message.created){const t=this._proofingDom.findParagraphNode(n.tileId);if(t&&(n.tileId===e.message.tileId||(null===(i=t.parent)||void 0===i?void 0:i.id)===e.message.tileId)){const e=this._predictionUpdate+1;this._predictionUpdate=e,this.determineIfPredictionIsValidAndApply(n,e)}}},this.handleDelta=e=>{var t,i;const n=e.message;if(n.sourceType===o.pf.TileNode)return;if(this.checkForECCHintTextPrediction())return;if(this._isActivelyAddingWrappingNewLines)return;if(!n.delta||!this._prediction)return void(this.lastPredictedTile&&n.tileId!==this.lastPredictedTile.id&&(this.lastPredictedTile=void 0));if(n.delta.deltaType===u.WI.Add&&!n.delta.content)return;if(n.delta.deltaType===u.WI.Update&&!n.delta.content&&!n.delta.length)return;if(n.delta.deltaType===u.WI.Update&&(n.delta.unit===u.OD.Sentence||n.delta.unit===u.OD.Paragraph)&&"\n"===n.delta.content&&0===n.delta.position)return;if((n.delta.unit===u.OD.Sentence||n.delta.unit===u.OD.Paragraph)&&(n.delta.deltaType===u.WI.Add||n.delta.deltaType===u.WI.Update)&&(null!==(i=null===(t=n.delta.content)||void 0===t?void 0:t.length)&&void 0!==i?i:0)>1)return;const s=this._predictionUpdate+1;this._predictionUpdate=s,this.determineIfPredictionIsValidAndApply(this._prediction,s,this._predictionDisplayText,n.tileId,n.changeType,n.delta,n.deletedOrReplacedCharacters)},this.trimLineEnding=e=>e&&"\n"===e[e.length-1]?e.substring(0,e.length-1):e,this.logDisplayedTelemetry=e=>{var t,i;e.isFromAugLoop&&((null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===i?void 0:i.onPredictionDisplayed)&&this._hostSettings.serviceSettings.predictions.onPredictionDisplayed(e),this._oaLogger.logActivity("OAPredictionDisplayed",void 0,this.getBasePredictionLogFields(e)))},this.logAcceptedTelemetry=(e,t,i,n,s)=>{var o,a;e.isFromAugLoop&&((null===(a=null===(o=this._hostSettings.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===a?void 0:a.onPredictionAccepted)&&this._hostSettings.serviceSettings.predictions.onPredictionAccepted(e,t,i),this._oaLogger.logActivity("OAPredictionApplied",void 0,[...this.getBasePredictionLogFields(e),...(0,r.W)(["charactersTyped",t],["acceptedViaUserAction",i],["keyPressedForAccept",n],["acceptanceTime",(new Date).toISOString()],["isOpeningECCForEntityPrediction",s])]))},this.logDismissedTelemetry=(e,t,i)=>{var n,s;e.isFromAugLoop&&((null===(s=null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.predictions)||void 0===s?void 0:s.onPredictionDismissed)&&this._hostSettings.serviceSettings.predictions.onPredictionDismissed(e,e.currentEndIndex?e.currentEndIndex-e.startIndex:0,t),void 0!==this._prediction&&this._oaLogger.logActivity("OAPredictionDismissed",void 0,[...this.getBasePredictionLogFields(e),...(0,r.W)(["charactersTyped",e.currentEndIndex?e.currentEndIndex-e.startIndex:0],["dismissalReason",t],["dismissalType",i],["rejectionTime",(new Date).toISOString()])]))},this._predictionStore.setOnUpdatedPrediction(this.onPredictionUpdatedInternal)}async initialize(){this._hostEmitter.on(l.pD.hostModelDelta,this.handleDelta),this._hostEmitter.on(l.pD.hostModelTextTile,this.handleTextTile),this._hostEmitter.on(l.pD.hostModelVisualStateChange,this.hostModelVisualStateChange),this._proofingEmitter.on("eccStateChanged",this.eccStateChanged)}shutDown(){this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0}setOnUpdate(e){this._onUpdate=e}async clearCurrentPrediction(e,t,i){this.logDismissedTelemetry(e,t,i),await this._predictionStore.clearPrediction()}isPredictionDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}checkForECCHintTextPrediction(){return!1}async handleRemotePredictionUpdate(e,t,i,n){var s,o,r,a,l;if(e.tileId!==i)return;const d=null!==(s=n.position)&&void 0!==s?s:0,g=e.startIndex+t.length;if(d>=e.startIndex&&d<g)await this.clearCurrentPrediction(e,"remote edit dismissed",c.R8.ImplicitRejection);else{const t=n.deltaType===u.WI.Add?null!==(r=null===(o=n.content)||void 0===o?void 0:o.length)&&void 0!==r?r:0:n.deltaType===u.WI.Delete?-1*n.length:n.deltaType===u.WI.Update?(null!==(l=null===(a=n.content)||void 0===a?void 0:a.length)&&void 0!==l?l:0)-n.length:0,i=this._predictionUpdate+1;this._predictionUpdate=i,await this.determineIfPredictionIsValidAndApply(Object.assign(Object.assign({},e),{startIndex:e.startIndex+t}),i)}}determineIfPredictionTextIsValid(e,t,i){var n,o,r,a,l,h,p,f,v;const y=this._proofingDom.findParagraphNode(e.tileId),_=this.trimLineEnding(this._paragraphTextExtractor.getParagraphText(y)),I=null!==(o=null===(n=this.lastPredictedTile)||void 0===n?void 0:n.predictionContext.length)&&void 0!==o?o:0;if(e.entityType===s.c.Loop&&e.tileId===(null===(r=this.lastPredictedTile)||void 0===r?void 0:r.id)&&e.entityType===this.lastPredictedTile.predictionType&&(null!==(l=null===(a=e.context)||void 0===a?void 0:a.length)&&void 0!==l?l:0)>I+3)return{result:!1};if(t&&e.shouldDismissOnTextChange)return{result:!1};const C=null!==(h=null==t?void 0:t.position)&&void 0!==h?h:0;if(_&&(0,m.l)(y)){const n=_.substring(e.startIndex);t&&this.isEntityPrediction(e.entityType)&&this.prepareEntityPredictionForTextUpdate(e,_);const s=(e.context?e.context.substring(0,e.startIndex):_.substring(0,e.startIndex))+e.text;let o=0;for(let s=0;s<e.text.length;s++){const r=e.text.charAt(s),a=(null==t?void 0:t.deltaType)===u.WI.Delete?1:0;if(s>=n.length||t&&s+e.startIndex>C-a)break;if(t&&t.deltaType===u.WI.Delete&&s+e.startIndex===C-a&&i&&1===i.length&&r===i)break;if(r===n.charAt(s))o++;else{if(!this.allowMiddleOfSentencePredictions()){if(e.shouldDismissOnTextChange)break;return{result:!1}}if(!t)break;if(t.deltaType!==u.WI.Add||!t.content||!(t.content===n.charAt(s)||d.Yv(t.content.charCodeAt(0))&&d.Yv(n.charCodeAt(s))))return{result:!1}}}const r=_.substring(0,e.startIndex+o);if(e.currentEndIndex&&e.currentEndIndex>r.length&&(!t||t.deltaType!==u.WI.Delete||C<e.startIndex))return{result:!1};if(e.currentEndIndex=r.length,e.entityResults&&!this.checkIfEntityPredictionContextIsValid(e,_,o))return{result:!1};if(s.startsWith(r)&&r!==s){const t=r.length,i=this._tileContent.getContainingElement(y);if(!i)return{result:!1,dueToMissingContainingHTMLElement:!0};const n=null!==(p=(0,g.m)(i))&&void 0!==p?p:i;return(null===(f=this.lastPredictedTile)||void 0===f?void 0:f.id)!==e.tileId&&(this.lastPredictedTile={id:e.tileId,predictionType:e.entityType,predictionContext:null!==(v=e.context)&&void 0!==v?v:""}),{paragraphNode:y,paragraphNodeOffset:y.element.offset,insertableTextStart:t,htmlParentElement:i,contentEditableHtmlParentElement:n,predictionText:s}}if(r===s)return this.logAcceptedTelemetry(e,e.text.length,!1,c.r7,!!e.entityResults),{result:!1,dueToEntirePredictionTyped:!0}}return{result:!1}}getBasePredictionLogFields(e){const t=(0,r.W)(["predictionTextLength",e.text.length],["entityType",e.entityType]);return void 0!==this._predictionFirstDisplayedTime&&t.push((0,r.n)("firstDisplayedTime",this._predictionFirstDisplayedTime.toISOString())),t}};f=(0,n.__decorate)([(0,p._)()],f)},225916:(e,t,i)=>{i.d(t,{g:()=>c});var n=i(379490),s=i(163573),o=i(671303),r=i(615930),a=i(229906),l=i(83010),d=i(427603);let c=class{constructor(e,t,i){this._hostSettings=e,this._oaLogger=t,this.targetDocumentFactory=i}async getTargetLocationOfECC(e,t){var i,n,s,o,r,a,l,d,c,u,g;const h=null===(n=null===(i=this.targetDocumentFactory)||void 0===i?void 0:i.call(this))||void 0===n?void 0:n.deref(),p=null==h?void 0:h.getElementById(null!==(r=null===(o=null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.enableECCForMobileDevice)||void 0===o?void 0:o.inputBoxId)&&void 0!==r?r:"m365chat-input-formTextBox"),m=null==p?void 0:p.getBoundingClientRect();if(!p||!m||0===m.top&&0===m.bottom&&0===m.left&&0===m.right&&0===m.height&&0===m.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;const f=null!==(d=null===(l=null===(a=this._hostSettings.oaSettings)||void 0===a?void 0:a.enableECCForMobileDevice)||void 0===l?void 0:l.mainAxisOverride)&&void 0!==d?d:0,v=null!==(g=null===(u=null===(c=this._hostSettings.oaSettings)||void 0===c?void 0:c.enableECCForMobileDevice)||void 0===u?void 0:u.crossAxisOverride)&&void 0!==g?g:0,y=new DOMRect(m.left-v,m.top-f,m.width,m.height);return function(e,t,i){const n=null==t?void 0:t.defaultView;if(!n)return!1;const s={x:e.left+e.width/2,y:e.top+e.height/2};let o=t.elementFromPoint(s.x,s.y),r=!1;do{if(o===i){r=!0;break}o=null==o?void 0:o.parentNode}while(o);if(!r)return!1;return s.x<0||s.y<0||s.x>(n.innerWidth||t.documentElement.clientWidth)||s.y>(n.innerHeight||t.documentElement.clientHeight)}(y,h,p)?null:y}};c=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(s.n)),(0,n.__param)(1,(0,l.W)(o.m)),(0,n.__param)(2,(0,d.l)()),(0,n.__param)(2,(0,l.W)(r.Ze))],c)},226331:(e,t,i)=>{i.d(t,{K:()=>n});const n=(0,i(668952).f)("IProofingPersistedStore")},227710:(e,t,i)=>{i.d(t,{J:()=>o,S:()=>r});var n=i(146078),s=i(208520);class o extends n.z{constructor(e){super(n.z.createContainer(),e)}onAddModule(e){"configureRootServices"in e?e.configureRootServices(this.container):e.providers&&this.bindProvidersToContainer(this.container,e.providers)}}const r=(0,s.createContext)(void 0)},229105:(e,t,i)=>{if(i.d(t,{W:()=>s}),0!=i.j)var n=i(71357);const s=()=>(0,n.y)((e=>({isMenuShown:!1,setIsMenuShown:t=>e({isMenuShown:t}),rect:void 0,setRect:t=>e({rect:t}),isFullWidth:!1,setIsFullWidth:t=>e({isFullWidth:t}),isMenuAtBottom:!1,setIsMenuAtBottom:t=>e({isMenuAtBottom:t}),availableTabs:[],setAvailableTabs:t=>e({availableTabs:t}),activeTab:"All",setActiveTab:t=>e({activeTab:t}),preventNextDefaultActiveTab:!1,setPreventNextDefaultActiveTab:t=>e({preventNextDefaultActiveTab:t}),locale:"en-US",setLocale:t=>e({locale:t}),autoFocusSearchOnOpen:!1,setAutoFocusSearchOnOpen:t=>e({autoFocusSearchOnOpen:t}),searchOpened:!0,setSearchOpened:t=>e({searchOpened:t}),userDisplayName:"",setUserDisplayName:t=>e({userDisplayName:t}),refreshEntities:e=>{},setRefreshEntities:t=>e({refreshEntities:t}),getPeopleIconURL:e=>`https://microsoft.sharepoint-df.com/_layouts/15/UserPhoto.aspx?size=m&accountName=${e}&default=none`,setGetPeopleIconURL:t=>e({getPeopleIconURL:t}),requestEntitiesParams:{targetId:"",conversationId:"",logicalId:"",query:{start:0,text:""},triggerKey:""},setRequestEntitiesParams:t=>e({requestEntitiesParams:t}),onSearchChange:void 0,setOnSearchChange:t=>e({onSearchChange:t}),onEntitySelect:()=>{},setOnEntitySelect:t=>e({onEntitySelect:t}),onMenuClose:()=>{},setOnMenuClose:t=>e({onMenuClose:t}),onClickedOutsideMenu:e=>{},setOnClickedOutsideMenu:t=>e({onClickedOutsideMenu:t}),fileUploadSettings:{},setFileUploadSettings:t=>e({fileUploadSettings:t}),clickOutIgnoredRefs:[],setClickOutIgnoredRefs:t=>{e({clickOutIgnoredRefs:t})}})))},229464:(e,t,i)=>{i.d(t,{d:()=>n});const n=(0,i(668952).f)("IHostTilingEmitter")},233653:(e,t,i)=>{i.d(t,{K:()=>n});const n=(0,i(668952).f)("IProofingPersistedStore")},234483:(e,t,i)=>{i.d(t,{P:()=>n});const n=(0,i(668952).f)("IHighContrastModeDetector")},234605:(e,t,i)=>{i.d(t,{M:()=>a});var n=i(379490),s=i(696767),o=i(188694),r=i(229906);let a=class{getMessage(e,t){const i=(0,s.$)(),n=i.getString("OnCanvasCalloutStrings",e)||i.getString("CopywriterStrings",e)||i.getString("EditorBrowserExtensionStrings",e)||i.getString("AiInsertStrings",e)||i.getString("InlineSuggestionStrings",e)||"";if(void 0===t)return n;const r=Array.isArray(t)?t:[t];return o.$.format(n,...r)}};a=(0,n.__decorate)([(0,r._)()],a)},234979:(e,t,i)=>{i.d(t,{W:()=>l});var n=i(379490),s=i(229906),o=i(83010),r=i(494888),a=i(774592);let l=class{constructor(e,t){this._featureFlagsReader=e,this._paragraphDeltasEnabled=t}check(){return this._paragraphDeltasEnabled.check()&&this._featureFlagsReader.flags.enableOptimizedRehydration}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.c)),(0,n.__param)(1,(0,o.W)(a.H))],l)},236845:(e,t,i)=>{if(i.d(t,{FO:()=>r,jh:()=>a,yT:()=>o}),0!=i.j)var n=i(647879);const s=0!=i.j?["facetCodes","statusCode","innerMostErrorCode","sprequestguid"]:null;function o(e){return e.map((e=>e[1]?r(e[0],e[1]):void 0)).filter((e=>!!e))}function r(e,t,i){return(0,n.n)(e,t,4,i)}function a(e){const t={};return function(e,t){var i;const n="object"==typeof e&&null!==e;function o(t){if(!n)return;const i=e[t];return"string"==typeof i?i:void 0}t.errorMessage=null!==(i=o("message"))&&void 0!==i?i:String(e),t.errorName=o("name"),t.stack=o("stack"),t.errorType=o("errorType"),t.errorInstanceId=o("errorInstanceId"),s.forEach((i=>{const n=e[i];n&&(t[i]="object"==typeof n?JSON.stringify(n):n)}))}(e,t),t.message?t.message=`${t.message}\n${t.errorMessage}`:t.message=t.errorMessage,void 0===t.stack&&(t.stack=function(){let e=(new Error).stack;if(!e)try{throw new Error}catch(t){e=t.stack}return e}()),t}},239835:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(379490),s=i(163573),o=i(229906),r=i(83010);let a=class{constructor(e){this.hostSettings=e,this._profilePicturesUrlsCache={},this.fetchProfilePicture=async e=>{if(!e)return;if(this._profilePicturesUrlsCache[e])return this._profilePicturesUrlsCache[e];const t=await this.getProfilePictureUrl(e);return this._profilePicturesUrlsCache[e]=t,t},this.fetchCachedProfilePicture=e=>{if(e)return this._profilePicturesUrlsCache[e]},this.getDefaultProfilePictureUrl=e=>`https://microsoft.sharepoint-df.com/_layouts/15/UserPhoto.aspx?size=m&accountName=${e}&default=none`}async getProfilePictureUrl(e){var t;if(null==e?void 0:e.includes("@")){if(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.getProfilePictureUrl){return await this.hostSettings.oaSettings.getProfilePictureUrl(e)}return this.getDefaultProfilePictureUrl(e)}return""}};a=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.n))],a)},240874:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(668952).f)("IUxLanguageDetector")},242721:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Concisión","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Coherencia","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Lenguaje no discriminatorio","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Erratas"},"Clarity":{"LocalizedName":"Claridad","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acrónimos"},"Rewrite":{"IsImplemented":false,"LocalizedName":"Reformulaciones"},"Error Corrections":{"LocalizedName":"Corrección de errores","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulario"},"Grammar":{"LocalizedName":"Gramática","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Lenguaje formal","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Puntuación","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Convenciones de escritura"},"Spelling":{"LocalizedName":"Ortografía","IsImplemented":true},"Resume":{"LocalizedName":"CV","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Referencias geopolíticas sensibles","IsImplemented":true}}')},242739:(e,t,i)=>{var n;i.d(t,{u:()=>n}),function(e){e.calloutMain="calloutMain",e.moreActions="moreActions"}(n||(n={}))},243879:(e,t,i)=>{i.d(t,{P:()=>n,V:()=>o});var n,s=i(668952);!function(e){e.AttachFile="AttachFile",e.TriggerChar="TriggerChar",e.Fre="Fre"}(n||(n={}));const o=(0,s.f)("IInlineSuggestionsRenderer")},244826:(e,t,i)=>{i.d(t,{z:()=>c});var n=i(379490),s=i(229906),o=i(83010),r=i(877931),a=i(150099),l=i(163573),d=i(543943);let c=class{constructor(e,t,i,n){this.baseOaMetric=new d.w(e,t,i,n)}log(e,t,i,n){this.baseOaMetric.log(e,t,i,n)}info(e,t,i){this.baseOaMetric.info(e,t,i)}warn(e,t,i){this.baseOaMetric.warn(e,t,i)}error(e,t,i){this.baseOaMetric.error(e,t,i)}debug(e,t,i){this.baseOaMetric.debug(e,t,i)}logEvent(e,t,i,n,s,o,r){this.baseOaMetric.logEvent(e,t,i,n,s,o,r)}getNewActivity(e,t,i){return this.baseOaMetric.getNewActivity(e,t,i)}addCorrelationID(e){this.baseOaMetric.addCorrelationID(e)}async initialize(e,t,i,n,s,o,r){return this.baseOaMetric.initialize(e,t,i,n,s,o,r)}logDiagnostics(e,t,i,n){this.baseOaMetric.logDiagnostics(e,t,i,n)}logActivity(e,t,i,n){this.baseOaMetric.logActivity(e,t,i,n)}config({transports:e,activityTransport:t}){return this.baseOaMetric.config({transports:e,activityTransport:t})}startEntry(e,t,i){this.baseOaMetric.startEntry(e,t,i)}setOnTimeout(e){this.baseOaMetric.setOnTimeout(e)}addMeasure(e,t,i){this.baseOaMetric.addMeasure(e,t,i)}commitEntry(e,t,i){this.baseOaMetric.commitEntry(e,t,i)}};c=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.g)),(0,n.__param)(1,(0,o.W)(a.j)),(0,n.__param)(2,(0,o.W)("OAMetricEventName")),(0,n.__param)(3,(0,o.W)(l.n))],c)},244839:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Ejaan"}}')},245145:(e,t,i)=>{i.d(t,{X:()=>n});const n=(0,i(668952).f)("ILanguageDetectionSubscriber")},245645:(e,t,i)=>{i.d(t,{b:()=>a});var n=i(379490),s=i(229906),o=i(83010),r=i(439550);let a=class{constructor(e){this._extensionStorage=e}getLastError(){return this._lastError}setLastError(e){this._lastError=e}async writeSetting(e,t){const i={value:JSON.stringify(t),lastUpdated:Date.now(),manualOverride:!1},n={};n[e]=JSON.stringify(i),await this._extensionStorage.set(n)}};a=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.D))],a)},246429:(e,t,i)=>{if(i.d(t,{u:()=>f}),0!=i.j)var n=i(542812);if(0!=i.j)var s=i(642810);if(0!=i.j)var o=i(413612);if(0!=i.j)var r=i(294890);if(0!=i.j)var a=i(251439);if(0!=i.j)var l=i(826663);if(0!=i.j)var d=i(386675);if(0!=i.j)var c=i(163573);if(0!=i.j)var u=i(321889);if(0!=i.j)var g=i(106623);if(0!=i.j)var h=i(665238);if(0!=i.j)var p=i(883984);if(0!=i.j)var m=i(493434);class f{constructor(){this.imports=[r.v,s.d,o.r]}get uniqueId(){return(0,a.z)(507918358)}configureRootServices(e){var t,i;e.bind(l.K).to(n.r);const s=e.get(c.n);(null===(i=null===(t=s.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.enabled)&&((0,u.iO)(s)&&e.bind(d.S).to(u.lJ),(0,g.U)(s)&&e.bind(d.S).to(g.B),(0,h.p)(s)&&e.bind(d.S).to(h.C),(0,p.f)(s)&&e.bind(d.S).to(p.C),(0,m.f)(s)&&e.bind(d.S).to(m.C))}}},246608:(e,t,i)=>{if(i.d(t,{B5:()=>l,PG:()=>a}),0!=i.j)var n=i(35865);const s=6e4,o=36e5;function r(e,t){const i=n.e.getStringsFor("DateTimeStrings"),r=(e,...t)=>{let n=i(e),s=0;for(const e of t.filter(Boolean))n=n.replace(`{${s}}`,e),s++;return n},a=t.getTime()-e.getTime();if(a<0)return a<=-6e5?"":r("justNow");const l=Math.round(a/864e5),d=Math.round(a/o);if(l>7)return function(e,t){const i=n.e.getStringsFor("MonthsNames"),s=[i("January"),i("February"),i("March"),i("April"),i("May"),i("June"),i("July"),i("August"),i("September"),i("October"),i("November"),i("December")][e.getMonth()],o=`${s} ${e.getDate().toString()}, ${e.getFullYear().toString()}`,r=`${s} ${e.getDate().toString()}`,a=t.getFullYear()===e.getFullYear()?r:o;return a}(e,t);if(d>=24)return r("daysAgo",l.toString());if(d>=2)return r("hoursAgo",d.toString());if(d>=.8&&d<=2)return r("oneHourAgo");const c=Math.round(a/s);return c<=2?r("justNow"):r("minutesAgo",c.toString())}const a=e=>{if(!e)return"";const t=e.includes("Z")?e:`${e}Z`;return r(new Date(t),new Date)};function l(e,t,i,s){const o=s||n.e.fallbackLocale,r=Date.parse(e);if(Number.isNaN(r))return"";return function(e,t,i,n){let s,o=!1;const r=Number.isNaN(i);if(r&&(s=new Date(i),o=e.getFullYear()===s.getFullYear()&&e.getMonth()===s.getMonth()&&e.getDate()===s.getDate()),n)return r?o?e.toLocaleString(t,{weekday:"short"})+" "+e.toLocaleDateString(t):e.toLocaleDateString(t)+" - "+(null==s?void 0:s.toLocaleDateString(t)):e.toLocaleString(t,{weekday:"short"})+" "+e.toLocaleDateString(t);let a=e.toLocaleString(t,{weekday:"short"})+" "+e.toLocaleDateString(t)+" "+e.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"});return r?a+" - "+(null==s?void 0:s.toLocaleTimeString(t,{hour:"numeric",minute:"2-digit"})):a}(new Date(r),o,Date.parse(t),i)}},246886:(e,t,i)=>{i.d(t,{R:()=>u});var n=i(252723),s=i(108520),o=i(305507),r=i(61971),a=i(756857);if(0!=i.j)var l=i(748227);var d=i(208520);const c=(0,n.F5)({multilingualStore:s.A.on(o.j),critiqueCalloutStateStore:s.A.on(r.v),localizer:s.A.on(a.H)}),u=e=>{var t;const{theme:i,style:s}=e,{critiqueCalloutStateStore:o,multilingualStore:r,localizer:a}=(0,n.KN)(c);return d.createElement("div",{style:Object.assign({color:null!==(t=null==i?void 0:i.textColor)&&void 0!==t?t:"#323130"},s)},d.createElement("div",{style:{marginBottom:8}},d.createElement("b",null,a.getMessage("multilingualFRE_HeadingText"))),a.getMessage("multilingualFRE_DescriptionText")," ",d.createElement("br",null),d.createElement(l.N,{style:{fontSize:12},onClick:()=>{o.hide(),r.showEditorSettings()},"aria-label":a.getMessage("multilingualFRE_DescriptionButtonLinkAriaLabel"),"data-is-focusable":!0},a.getMessage("multilingualFRE_DescriptionButtonLink")))}},248401:(e,t,i)=>{i.d(t,{f:()=>s,u:()=>o});var n=i(668952);const s=(0,n.f)("ISquigglerStateStoreFactory"),o=(0,n.f)("ContentEditableSquigglerComponent")},249901:(e,t,i)=>{if(i.d(t,{O:()=>a}),0!=i.j)var n=i(498689);if(0!=i.j)var s=i(525809);if(0!=i.j)var o=i(570046);if(0!=i.j)var r=i(251439);class a{constructor(){this.imports=[o.C,n.D,s.f]}get uniqueId(){return(0,r.z)(507918281)}configureRootServices(e){}}},251439:(e,t,i)=>{function n(e){return e}i.d(t,{z:()=>n})},252097:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Правопис"}}')},252723:(e,t,i)=>{if(i.d(t,{F5:()=>o,KN:()=>r,SM:()=>a}),0!=i.j)var n=i(659506);var s=i(208520);function o(e){const t={};for(const i of Object.keys(e)){const n=e[i];t[i]=n.build()}return t}function r(e){const t=(0,n.G)();return(0,s.useMemo)((()=>{const i={};for(const n of Object.keys(e))i[n]=e[n].resolveFrom(t);return i}),[t,e])}function a(e){const t=(0,n.N)();return(0,s.useMemo)((()=>{const i={};for(const n of Object.keys(e))i[n]=t&&e[n].resolveFrom(t);return i}),[t,e])}},254831:(e,t,i)=>{i.d(t,{e:()=>c});var n=i(379490),s=i(877646);class o{constructor(e,t){this.ariaStatusStateStore=e,this.localizer=t,this.existingCritiques=new Set,this.completeStatusMessage=(e,t)=>{const i=this.getMessageKey(t);if(!i)return e;let n=this.localizer.getMessage(i,e);return t===s.J.AutoCorrectHover&&(n=`${n} ${this.localizer.getMessage("ebx_autoCorrectedKeyboardAccess")}`),n},this.getMessageKey=e=>e===s.J.AutoCorrectAppearance||e===s.J.AutoCorrectHover?"ebx_autoCorrected":e===s.J.SingleIssueOnLine?"ebx_issuesOnLineSingular":e===s.J.IssuesOnLine?"ebx_issuesOnLinePlural":void 0}setStatus(e,t,i=!1,n,s){if(n&&i){if(this.existingCritiques.has(n))return;this.existingCritiques.add(n)}const o=void 0===s?e:this.completeStatusMessage(e,s);this.ariaStatusStateStore.setStatus(o,t,i)}addPreservedStatuses(e,t){const i=e.filter((e=>{const t=this.existingCritiques.has(e.id);return t||this.existingCritiques.add(e.id),!t})).map((e=>void 0===e.messageKind?e.text:this.completeStatusMessage(e.text,e.messageKind)));this.ariaStatusStateStore.addPreservedStatuses([i.join(". ")],t)}setLineNavStatus(e,t,i){e<1||this.setStatus(e.toLocaleString(),t,i,void 0,1===e?s.J.SingleIssueOnLine:s.J.IssuesOnLine)}}var r=i(429712),a=i(756857),l=i(229906),d=i(83010);let c=class{constructor(e,t){this.ariaStatusStateStore=e,this.localizer=t,this.ariaStatusUniqueProxy=new o(this.ariaStatusStateStore,this.localizer)}setStatus(e,t,i=!1,n,s){this.ariaStatusUniqueProxy.setStatus(e,t,i,n,s)}addPreservedStatuses(e,t){this.ariaStatusUniqueProxy.addPreservedStatuses(e,t)}setLineNavStatus(e,t,i){this.ariaStatusUniqueProxy.setLineNavStatus(e,t,i)}};c=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(r.QV)),(0,n.__param)(1,(0,d.W)(a.H))],c)},255517:(e,t,i)=>{i.d(t,{M:()=>n});const n=(0,i(668952).f)("IUserInfoUpdater")},256002:(e,t,i)=>{i.d(t,{N:()=>o,k:()=>r});var n=i(379490),s=i(229906);class o{get targetWindow(){var e;return null!==(e=this._customWindow)&&void 0!==e?e:window}constructor(e){this._customWindow=e,this._timeouts=new Map,this._intervals=new Map}clearTimer(e){const t=this._timeouts.get(e);t&&(this.targetWindow.clearTimeout(t),this._timeouts.delete(e));const i=this._intervals.get(e);i&&(this.targetWindow.clearInterval(i),this._intervals.delete(e))}setInterval(e,t,i){this.clearTimer(e);const n=this.targetWindow.setInterval(t,i);return this._intervals.set(e,n),e}setIntervalWithDelay(e,t,i,n){this.clearTimer(e);const s=this.targetWindow.setTimeout((()=>{t();const n=this.targetWindow.setInterval(t,i);this._intervals.set(e,n)}),n);return this._timeouts.set(e,s),e}setTimeout(e,t,i){this.clearTimer(e);const n=this.targetWindow.setTimeout(t,i);return this._timeouts.set(e,n),e}async initialize(){}shutDown(){for(const e of this._timeouts.values())this.targetWindow.clearTimeout(e);for(const e of this._intervals.values())this.targetWindow.clearInterval(e);this._intervals.clear(),this._timeouts.clear()}}let r=class{constructor(){this._timer=new o}clearTimer(e){this._timer.clearTimer(e)}setInterval(e,t,i){return this._timer.setInterval(e,t,i)}setIntervalWithDelay(e,t,i,n){return this._timer.setIntervalWithDelay(e,t,i,n)}setTimeout(e,t,i){return this._timer.setTimeout(e,t,i)}async initialize(){}shutDown(){this._timer.shutDown()}};r=(0,n.__decorate)([(0,s._)()],r)},258545:(e,t,i)=>{i.d(t,{U:()=>n});const n={All:"allEntityTypeLabel",Recent:"recentEntityTypeLabel",Message:"emailEntityLabel",People:"peopleEntityLabel",Event:"eventEntityLabel",File:"fileEntityLabel",Command:"commandEntityLabel",App:"appEntityTypeLabel"}},260131:(e,t,i)=>{if(i.d(t,{q:()=>u}),0!=i.j)var n=i(818935);if(0!=i.j)var s=i(958594);if(0!=i.j)var o=i(89609);if(0!=i.j)var r=i(341524);if(0!=i.j)var a=i(120733);if(0!=i.j)var l=i(23603);var d=i(208520);const c=0!=i.j?["resultDidntLoad","somethingWentWrongTryRefresh","refresh"]:null,u=()=>{const e=(0,l.B)("InlineSuggestionStrings",c),t=(0,r.b)("warning");return d.createElement(s.J,{style:(0,o.BO)(),image:{src:t},heading:e.resultDidntLoad,body:d.createElement(g,null)})},g=()=>{const e=(0,a.E)("requestEntitiesParams").query.text,t=(0,a.E)("onSearchChange"),i=(0,l.B)("InlineSuggestionStrings",c);return d.createElement(d.Fragment,null,d.createElement("span",{"data-automation-id":"something-went-wrong-text"},i.somethingWentWrongTryRefresh),d.createElement("span",{style:(0,o.bL)()},d.createElement(n.$,{style:(0,o.WS)(),onClick:()=>{null==t||t(e)},"data-automation-id":"refresh-data-button"},i.refresh)))}},260566:(e,t,i)=>{i.d(t,{qq:()=>de,R9:()=>ce});var n={};i.r(n),i.d(n,{BrowserExtensionRequestV1:()=>P,BrowserExtensionResponseV1:()=>j,CommonAppIdProperty:()=>h,CommonAppVersionProperty:()=>A,CommonCritique:()=>N,CommonDescriptorsProperty:()=>I,CommonLanguageIdProperty:()=>v,CommonLanguageUXIdProperty:()=>S,CommonOverriddenCritiqueTypeOptions:()=>T,CommonRequestIdProperty:()=>m,CommonResponseStatusProperty:()=>p,CommonRevisionIdProperty:()=>L,CommonRunOnProfileIdProperty:()=>b,CommonTextUnitProperty:()=>y,CommonTileIdProperty:()=>x,ConfigRequestV2:()=>k,ConfigResponseV2:()=>B,CritiqueCategoryInfo:()=>F,CritiqueTypeInfo:()=>q,CritiqueTypeOption:()=>G,Descriptor:()=>C,EditorServiceConfigV2Headers:()=>J,EditorServiceInstrumentationHeaders:()=>Y,EditorServiceLanguageinfoHeaders:()=>Z,EditorServicePostTileCheckHeaders:()=>$,InstrumentationRequestV1:()=>z,LanguageInfoRequestV1:()=>M,LanguageInfoResponseV1:()=>U,Metadatum:()=>w,Suggestion:()=>E,SupportedActions:()=>D,SupportedLanguage:()=>Q,TileCheckCritique:()=>K,TileCheckRequestV1:()=>O,TileCheckResponseV1:()=>W,TileCheckSpan:()=>H,TileContent:()=>f,TileElement:()=>V,TopologyNode:()=>_,UserIdentity:()=>R});var s=i(773080),o=i(732950);const r="Composite",a="String",l="Number",d="Sequence",c={xCorrelationId:{serializedName:"x-correlationid",type:{name:"Uuid"}}};function u(e){const t={};for(const a of e)t[(r=a[0],r.charAt(0).toLowerCase()+r.slice(1))]=(i=a[0],n=a[1],s=a[2],o=a[3],{serializedName:i,required:s,defaultValue:o,type:{name:n}});var i,n,s,o,r;return t}function g(e,t){return{type:{name:r,className:e,modelProperties:t}}}const h=g("CommonAppIdProperty",u([["AppId",a]])),p=g("CommonResponseStatusProperty",u([["ResponseStatus",l,!1,0]])),m=g("CommonRequestIdProperty",u([["RequestId",a]])),f=g("TileContent",Object.assign(Object.assign({},u([["TileId",a,!0],["RevisionId",a,!0]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},tileElements:{serializedName:"TileElements",type:{name:d,element:{type:{name:r,className:"TileElement"}}}}})),v=g("CommonLanguageIdProperty",u([["LanguageId",a]])),y=g("CommonTextUnitProperty",u([["TextUnit",l]])),_=g("TopologyNode",Object.assign(Object.assign({},u([["Id",a,!0],["RevisionId",a,!0],["Type",l,!0],["NumberOfChildren",l],["AreChildsOrdered","Boolean",void 0,!1]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},children:{serializedName:"Children",type:{name:d,element:{type:{name:r,className:"TopologyNode"}}}}})),I=g("CommonDescriptorsProperty",{descriptors:{serializedName:"Descriptors",type:{name:d,element:{type:{name:r,className:"Descriptor"}}}}}),C=g("Descriptor",u([["Name",a,!0],["Value",a,!0]])),S=g("CommonLanguageUXIdProperty",u([["LanguageUXId",a]])),b=g("CommonRunOnProfileIdProperty",u([["RunOnProfileId","Uuid"]])),T=g("CommonOverriddenCritiqueTypeOptions",{overriddenCritiqueTypeOptions:{serializedName:"OverriddenCritiqueTypeOptions",type:{name:d,element:{type:{name:r,className:"CritiqueTypeOption"}}}}}),E=g("Suggestion",u([["Text",a,!0],["Description",a],["ConfidenceLevel",l],["Source",l],["Action",l,!0],["BucketId",l],["NumberOfInstances",l]])),N=g("CommonCritique",Object.assign(Object.assign({},u([["TraceId","Uuid"],["TypeId","Uuid"],["CategoryTitle",a],["Context",a],["Start",l,void 0,0],["StartInContext",l,void 0,0],["Length",l,void 0,0],["LanguageId",a],["Priority",l]])),{metadata:{serializedName:"Metadata",type:{name:d,element:{type:{name:r,className:"Metadatum"}}}}})),w=g("Metadatum",u([["Name",a,!0],["Value",a,!0]])),x=g("CommonTileIdProperty",u([["TileId",a]])),L=g("CommonRevisionIdProperty",u([["RevisionId",a]])),D=g("SupportedActions",u([["SupportedActions",l]])),A=g("CommonAppVersionProperty",u([["AppVersion",a]])),F=g("CritiqueCategoryInfo",Object.assign(Object.assign({},u([["Id","Uuid",!0],["Name",a,!0],["Priority",l]])),{critiqueTypeInfoList:{serializedName:"CritiqueTypeInfoList",type:{name:d,element:{type:{name:r,className:"CritiqueTypeInfo"}}}}})),q=g("CritiqueTypeInfo",Object.assign(Object.assign({},u([["Id","Uuid",!0],["Name",a,!0],["IsBinaryCritiqueType","Boolean"],["DefaultCritiqueValue",l,!0],["CritiquePriority",l],["CritiqueTag",a]])),{critiqueTypeValues:{serializedName:"CritiqueTypeValues",type:{name:d,element:{type:{name:a}}}}})),R=g("UserIdentity",u([["IdentityProvider",l,!0],["Puid",a,!0],["TenantId",a],["Cid",a]])),P=g("BrowserExtensionRequestV1",Object.assign(Object.assign({},h.type.modelProperties),u([["Browser",a],["BrowserVersion",a],["ClientId",a],["Email",a],["ExtensionId",a],["FirstInstallVersion",a],["LanguageId",a],["LanguageUxId",a],["LicenseType",a],["StoreId",a],["TenantId",a]]))),O=g("TileCheckRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h.type.modelProperties),I.type.modelProperties),S.type.modelProperties),b.type.modelProperties),T.type.modelProperties),u([["SessionId",a,!0],["RequestOrderInSession",l]])),{content:{serializedName:"Content",type:{name:d,element:{type:{name:r,className:"TileContent"}}}},topology:{serializedName:"Topology",type:{name:r,className:"TopologyNode"}}})),k=g("ConfigRequestV2",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h.type.modelProperties),A.type.modelProperties),I.type.modelProperties),v.type.modelProperties),S.type.modelProperties),b.type.modelProperties)),M=g("LanguageInfoRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h.type.modelProperties),I.type.modelProperties),v.type.modelProperties),S.type.modelProperties),b.type.modelProperties)),z=g("InstrumentationRequestV1",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},h.type.modelProperties),v.type.modelProperties),I.type.modelProperties),u([["TraceId","Uuid",!0],["CritiqueGenerationTime",l],["CritiquePriority",l,!0],["CritiqueTypeId","Uuid",!0],["EventId",l,!0],["OriginalText",a],["PreContextBegin",l],["PostContextEnd",l],["SubstrateEventName",a]])),{flaggedText:{constraints:{MaxLength:2e4,MinLength:1},serializedName:"FlaggedText",required:!0,type:{name:a}},metadata:{serializedName:"Metadata",type:{name:d,element:{type:{name:r,className:"Metadatum"}}}},substrateEventCustomFields:{serializedName:"SubstrateEventCustomFields",type:{name:"Dictionary",value:{type:{name:"any"}}}},suggestions:{serializedName:"Suggestions",type:{name:d,element:{type:{name:a}}}},suggestionText:{constraints:{MaxLength:2e4},serializedName:"SuggestionText",type:{name:a}}})),j=g("BrowserExtensionResponseV1",Object.assign(Object.assign(Object.assign(Object.assign({},p.type.modelProperties),m.type.modelProperties),u([["UseTileCheck","Boolean",void 0,!1],["Descriptors",a],["StyleObserverIntervalTime",l,void 0,0],["StyleSampleTime",l,void 0,0],["RootContentMaxLengthInChars",l,void 0,2e3],["SchedulerDefaultWaitingTime",l,void 0,0],["SchedulerDefaultWaitingTimeIncrement",l,void 0,0],["SchedulerDefaultMaxTime",l,void 0,0],["RefreshCritiqueWaitingTime",l,void 0,0],["RequestCritiqueDelay",l,void 0,0],["EnableDirtyRangeAutoRehydration","Boolean",void 0,!1],["TelemetryTenant",a],["LogGroupName",a],["SendToAria","Boolean",void 0,!1],["IntervalForActivityCleanup",l,void 0,0],["MaxAllowedTimeForActivities",l,void 0,0],["CalloutHoverTimeout",l,void 0,0],["MaxSuggestionItemsDisplayNumber",l,void 0,0],["EditorClientState",l],["ConfigurationId",a]])),{disabledWebSites:{serializedName:"DisabledWebSites",type:{name:d,element:{type:{name:a}}}},allowedUrls:{serializedName:"AllowedUrls",type:{name:d,element:{type:{name:a}}}},disabledGrammars:{serializedName:"DisabledGrammars",type:{name:d,element:{type:{name:a}}}},versionEmergencyOverrides:{serializedName:"VersionEmergencyOverrides",type:{name:"Dictionary",value:{type:{name:a}}}},featureFlags:{serializedName:"FeatureFlags",type:{name:"Dictionary",value:{type:{name:a}}}},dynamicSettings:{serializedName:"DynamicSettings",type:{name:"Dictionary",value:{type:{name:"any"}}}},spellCheckAttributes:{serializedName:"SpellCheckAttributes",type:{name:d,element:{type:{name:a}}}},conflictingElements:{serializedName:"ConflictingElements",type:{name:d,element:{type:{name:a}}}},editorCanvas:{serializedName:"EditorCanvas",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),W=g("TileCheckResponseV1",Object.assign(Object.assign({},p.type.modelProperties),{critiques:{serializedName:"Critiques",type:{name:d,element:{type:{name:r,className:"TileCheckCritique"}}}}})),B=g("ConfigResponseV2",Object.assign(Object.assign({},p.type.modelProperties),{critiqueCategoryInfoList:{serializedName:"CritiqueCategoryInfoList",required:!0,type:{name:d,element:{type:{name:r,className:"CritiqueCategoryInfo"}}}}})),U=g("LanguageInfoResponseV1",Object.assign(Object.assign({},p.type.modelProperties),{supportedLanguages:{serializedName:"SupportedLanguages",required:!0,type:{name:d,element:{type:{name:r,className:"SupportedLanguage"}}}}})),H=g("TileCheckSpan",Object.assign(Object.assign(Object.assign({},v.type.modelProperties),u([["Start",l,void 0,0],["Length",l,void 0,"tileElement.Text.Length - span.Start"],["DoNotCheck","Boolean"]])),{analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}}})),V=g("TileElement",Object.assign(Object.assign(Object.assign(Object.assign({},v.type.modelProperties),y.type.modelProperties),u([["Text",a,!0],["IsClean","Boolean"]])),{enabledLanguages:{serializedName:"EnabledLanguages",type:{name:d,element:{type:{name:d,element:{type:{name:r,className:"CommonLanguageIdProperty"}}}}}},analyzerData:{serializedName:"AnalyzerData",type:{name:"Dictionary",value:{type:{name:"any"}}}},spans:{serializedName:"Spans",type:{name:d,element:{type:{name:r,className:"TileCheckSpan"}}}}})),G=g("CritiqueTypeOption",Object.assign(Object.assign({},v.type.modelProperties),u([["Id","Uuid",!0],["Name",a],["TypeName",a],["Value",a,!0]]))),Q=g("SupportedLanguage",Object.assign(Object.assign(Object.assign({},v.type.modelProperties),y.type.modelProperties),u([["SupportedCritiqueTag",a]]))),K=g("TileCheckCritique",Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},N.type.modelProperties),x.type.modelProperties),L.type.modelProperties),D.type.modelProperties),u([["BucketId",l],["ExplanationTitle",a],["ExplanationLabel",a],["Explanation",a],["Status",l],["Tag",l]])),{suggestions:{serializedName:"Suggestions",type:{name:d,element:{type:{name:r,className:"Suggestion"}}}}})),$=g("EditorServicePostTileCheckHeaders",c),J=g("EditorServiceConfigV2Headers",c),Z=g("EditorServiceLanguageinfoHeaders",c),Y=g("EditorServiceInstrumentationHeaders",c),X={parameterPath:["options","contentType"],mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Content-Type",type:{name:"String"}}},ee={parameterPath:"body",mapper:P},te={parameterPath:"accept",mapper:{defaultValue:"application/json",isConstant:!0,serializedName:"Accept",type:{name:"String"}}},ie={parameterPath:"$host",mapper:{serializedName:"$host",required:!0,type:{name:"String"}},skipEncoding:!0},ne={parameterPath:"xCorrelationId",mapper:{serializedName:"X-CorrelationId",type:{name:"Uuid"}}},se={parameterPath:"xUserSessionId",mapper:{serializedName:"X-UserSessionId",type:{name:"Uuid"}}},oe={parameterPath:"xUserId",mapper:{serializedName:"X-UserId",type:{name:"String"}}},re={parameterPath:"xUserComposeSessionId",mapper:{serializedName:"X-UserComposeSessionId",type:{name:"Uuid"}}},ae={parameterPath:"body",mapper:z};class le extends s.Nl{constructor(e){var t,i;e||(e={});const n="@editor/client-rest-api/2.0.0",r=e.userAgentOptions&&e.userAgentOptions.userAgentPrefix?`${e.userAgentOptions.userAgentPrefix} ${n}`:`${n}`,a=Object.assign(Object.assign(Object.assign({},{requestContentType:"application/json; charset=utf-8"}),e),{userAgentOptions:{userAgentPrefix:r},baseUri:null!==(i=null!==(t=e.endpoint)&&void 0!==t?t:e.baseUri)&&void 0!==i?i:"https://nleditor.osi.officeppe.net/NLEditor"});super(a);let l=!1;if((null==e?void 0:e.pipeline)&&e.pipeline.getOrderedPolicies().length>0){l=e.pipeline.getOrderedPolicies().some((e=>e.name===o.uQ))}e&&e.pipeline&&0!=e.pipeline.getOrderedPolicies().length&&l||(this.pipeline.removePolicy({name:o.uQ}),this.pipeline.addPolicy(o.N$({credential:null==e?void 0:e.credential,scopes:`${a.credentialScopes}`,challengeCallbacks:{authorizeRequestOnChallenge:s.fj}}))),this.pipeline.removePolicy({name:o.PR}),this.pipeline.removePolicy({name:o.OD}),this.$host=e.$host||"https://nleditor.osi.officeppe.net/NLEditor"}}class de extends le{browserextension(e,t){return this.sendOperationRequest({body:e,options:t},ge)}}class ce extends le{instrumentation(e,t){return this.sendOperationRequest({body:e,options:t},he)}}const ue=s.rl(n,!1),ge={path:"/api/V1/BrowserExtension",httpMethod:"POST",responses:{200:{bodyMapper:j},400:{},500:{}},requestBody:ee,urlParameters:[ie],headerParameters:[X,te,ne,se,oe],mediaType:"json",serializer:ue},he={path:"/api/V1/Instrumentation",httpMethod:"POST",responses:{200:{headersMapper:Y},400:{},500:{}},requestBody:ae,urlParameters:[ie],headerParameters:[X,ne,se,re,{parameterPath:"authorization",mapper:{serializedName:"Authorization",type:{name:"String"}}},{parameterPath:"serverToServerId",mapper:{serializedName:"ServerToServerId",type:{name:"String"}}}],mediaType:"json",serializer:ue}},261234:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Ուղղագրություն","IsImplemented":true}}')},262185:(e,t,i)=>{if(i.d(t,{CT:()=>c,Ep:()=>a,MO:()=>d,S$:()=>r,rZ:()=>l}),0!=i.j)var n=i(379490);if(0!=i.j)var s=i(863307);if(0!=i.j)var o=i(112932);function r(e,t){(0,s._v)().startEntry(e.logicalId,e,t)}function a(e,t){var i;const{status:n,lastDataSourceName:o}=t,r=(0,s._v)();"Error"!==n?(o&&(t.measureName=null!==(i=t.measureName)&&void 0!==i?i:`RankingCompletedFrom${o}`,r.addMeasure(e,t.measureName,Object.assign({},t))),"Complete"===n&&r.addMeasure(e,"RankingCompleted",Object.assign({},t))):r.addMeasure(e,"SuggestionsRankingError",Object.assign({},t))}function l(e,t){var i;const n=()=>{"Complete"===o&&(0,s._v)().commitEntry(e,"SuggestionsDisplayFinished")},o=t.state;"PartiallyLoaded"!==o&&"Complete"!==o||(t.lastDataSourceName?(t.measureName=null!==(i=t.measureName)&&void 0!==i?i:`EntitiesLoadedFrom${t.lastDataSourceName}`,(0,s._v)().addMeasure(e,t.measureName,Object.assign({},t)),n()):n())}function d(e,t){var i;t.lastDataSourceName&&(t.measureName=null!==(i=t.measureName)&&void 0!==i?i:`EntitiesReceivedFrom${t.lastDataSourceName}`,(0,s._v)().addMeasure(e,t.measureName,Object.assign({},(e=>{const{suggestions:t}=e,i=(0,n.__rest)(e,["suggestions"]);return t?Object.assign(Object.assign({},i),(0,o.L)(t)):i})(t))))}function c(e,t){var i;t.lastDataSourceName&&(t.measureName=null!==(i=t.measureName)&&void 0!==i?i:`EntitiesRequestedFrom${t.lastDataSourceName}`,(0,s._v)().addMeasure(e,t.measureName))}},262255:(e,t,i)=>{var n;i.d(t,{Q:()=>o,t:()=>s}),function(e){e[e.None=0]="None",e[e.Processed=1]="Processed",e[e.SquiggleInitialized=2]="SquiggleInitialized"}(n||(n={}));const s=15;class o{constructor(){this._processedCritiques=new Map,this._invalidatedItems=new Map,this._keystrokesCount=0,this.items=new Map,this.setItem=(e,t)=>{this.items.set(e,t)},this.process=e=>!(!e||this._processedCritiques.has(e))&&(this._processedCritiques.set(e,{status:n.Processed,progress:0}),!0),this.setInitializationProgress=(e,t)=>{if(!e)return!1;const i=this._processedCritiques.get(e);return!(!i||i.status!==n.Processed&&i.status!==n.SquiggleInitialized)&&(this._processedCritiques.set(e,{status:n.SquiggleInitialized,progress:t}),!0)},this.getSquiggleInitializationProgress=e=>{if(!e)return 0;const t=this._processedCritiques.get(e);return(null==t?void 0:t.status)===n.SquiggleInitialized?t.progress:0},this.forEachCritiqueForItems=(e,t)=>{for(const i of e){const e=this.items.get(i);if(!e)return;for(const n of e){const s=n[0];t({squiggles:n[1],key:s,elementCritiques:e,elementId:i})}}},this.removeForCritique=(e,t,i=!1)=>{const n=this.items.get(e);if(!n)return;const s=n.get(t);return s?(i&&this._invalidatedItems.set(t,{squiggles:s,keystrokes:this._keystrokesCount}),n.delete(t),s):void 0},this.isEmpty=e=>void 0===this.items.get(e)&&0===this._invalidatedItems.size,this.checkInvalidatedAutoCorrections=e=>{if(0===this._invalidatedItems.size)return void(this._keystrokesCount=0);if(this._keystrokesCount+=1,!e)return;const t=[];for(const i of this._invalidatedItems.entries()){const n=i[1];this._keystrokesCount-n.keystrokes>s&&t.push(i[0]),e(n.squiggles)&&t.push(i[0])}for(const e of t)this._invalidatedItems.delete(e)}}}},262281:(e,t,i)=>{i.d(t,{X:()=>p});var n=i(379490),s=i(163573),o=i(671303),r=i(340064),a=i(104072),l=i(627223),d=i(243879),c=i(229906),u=i(83010),g=i(427603),h=i(786132);let p=class{constructor(e,t,i,n){this._hostSettings=e,this._oaLogger=t,this._tileContent=i,this._shadowElementsStore=n}async getTargetLocationOfECC(e,t){var i,n,s,o,a,l,c;if((null===(i=t.menuCurrentlyOpen)||void 0===i?void 0:i.enableExpandedECCSearchBar)&&(this._hostSettings.flightsToTrack||[]).includes("mc-editor-attachbutton-searchbar-position")&&t.triggerMethod===d.P.AttachFile){const t=null===(n=(0,r.q)(this._tileContent,e))||void 0===n?void 0:n.parentNode,i=null!==t?t.getBoundingClientRect():void 0;if(i)return{x:i.left,y:i.top}}if(!t.menuCurrentlyOpen)return null;const{targetOffset:u,queryRange:g}=t.menuCurrentlyOpen,p=e.element.offset+g.start;let m=this._tileContent.getContainingElement(e);if((0,h.C)(m,"HTMLInputElement")||(0,h.C)(m,"HTMLTextAreaElement")){const t=null===(s=this._shadowElementsStore)||void 0===s?void 0:s.getShadowElementStore(e.parent.id);t?(await t.updateOverlay(),m=t.container):this._oaLogger.logDiagnostics("Attempted to render ECC on an input/textarea, but no shadow element store was available, so the ECC will most likely be placed in the wrong place.")}const f=await this._tileContent.getRangeOfNode(e.parent,m,p,null!==(a=null===(o=g.prefix)||void 0===o?void 0:o.length)&&void 0!==a?a:1);if(!m)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element could not be determined"),null;if(!m.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but the parent html element was disconnected"),null;if(!f)return this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid range for the menu character could be found"),null;if(!f.startContainer.isConnected)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range was returned containing a detached HTML node"),null;if((null===(l=this._hostSettings.oaSettings)||void 0===l?void 0:l.atMentionClassName)&&this.hasSomeParentWithAnyClass(f.startContainer,[this._hostSettings.oaSettings.atMentionClassName]))return null;if((null===(c=this._hostSettings.oaSettings)||void 0===c?void 0:c.disabledClassNames)&&this.hasSomeParentWithAnyClass(f.startContainer,this._hostSettings.oaSettings.disabledClassNames))return null;let v=f.getBoundingClientRect();if(0===v.top&&0===v.bottom&&0===v.left&&0===v.right&&0===v.height&&0===v.width){if(f.startContainer!==f.endContainer||!f.startContainer.parentElement)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found and the parent containing element wasn't available"),null;if(v=f.startContainer.parentElement.getBoundingClientRect(),0===v.top&&0===v.bottom&&0===v.left&&0===v.right&&0===v.height&&0===v.width)return this._oaLogger.logDiagnostics("Attempted to render ECC, but an invalid range for the menu character was found"),null}const y=u?new DOMRect(v.left-u.x,v.top-u.y,v.width+2*u.x,v.height+2*u.y):v;return function(e,t,i){const n=t.commonAncestorContainer.ownerDocument,s=null==n?void 0:n.defaultView;if(!s)return!1;const o={x:e.left+e.width/2,y:e.top+e.height/2};let r=n.elementFromPoint(o.x,o.y),a=!1;do{if(r===i){a=!0;break}r=null==r?void 0:r.parentNode}while(r);if(!a)return!1;return o.x<0||o.y<0||o.x>(s.innerWidth||n.documentElement.clientWidth)||o.y>(s.innerHeight||n.documentElement.clientHeight)}(y,f,m)?null:y}hasSomeParentWithAnyClass(e,t){return!!t.find((t=>{var i;return null===(i=e.className)||void 0===i?void 0:i.split(" ").includes(t)}))||!!e.parentElement&&this.hasSomeParentWithAnyClass(e.parentElement,t)}};p=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(s.n)),(0,n.__param)(1,(0,u.W)(o.m)),(0,n.__param)(2,(0,u.W)(a.d)),(0,n.__param)(3,(0,g.l)()),(0,n.__param)(3,(0,u.W)(l.S))],p)},262282:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Chính tả"}}')},266885:(e,t,i)=>{i.d(t,{M:()=>o});var n=i(208520);if(0!=i.j)var s=i(419728);const o=e=>{const[t,i]=n.useState(0),o=n.useRef([]);n.useEffect((()=>(0,s.observe)(e.map,(e=>{o.current.push(e.name),i((e=>e+1))}))),[e.map]);const a=o.current;return o.current=[],n.createElement(n.Fragment,null,Array.from(e.map).map((([t,i])=>n.createElement(r,{key:t,id:t,value:i,changedReferences:a,renderEntry:e.renderEntry}))))},r=n.memo((e=>e.renderEntry(e.id,e.value)),((e,t)=>e.id===t.id&&(t.changedReferences.length>0&&!t.changedReferences.includes(e.id))))},266935:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Правописна проверка"}}')},268402:(e,t,i)=>{i.d(t,{KM:()=>l,Kc:()=>o,Nz:()=>r,OW:()=>c,S1:()=>a,tu:()=>d});var n=i(924083);if(0!=i.j)var s=i(745107);const o=n.v.MainButtonPressed,r=n.v.Hover,a=(n.v.SecondaryButtonPressed,e=>(0,s.i)()?!e.shiftKey&&e.ctrlKey&&e.altKey&&"ArrowDown"===e.key:!e.shiftKey&&!e.ctrlKey&&e.altKey&&"ArrowDown"===e.key),l=e=>!e.shiftKey&&e.ctrlKey&&e.altKey&&"ArrowDown"===e.key,d=e=>!e.shiftKey&&!e.altKey&&"Control"===e.key;function c(e,t){switch(e){case n.c.MainButtonPressed:return{eventName:"CritiqueCardShownViaLeftClickAction",data:t};case n.c.SecondaryButtonPressed:return{eventName:"CritiqueCardShownViaRightClickAction",data:t};case n.c.AuxiliaryButtonPressed:return{eventName:"CritiqueCardShownViaMiddleClickAction",data:t};case n.c.FourthButton:return{eventName:"CritiqueCardShownViaBrowserBackButtonAction",data:t};case n.c.FifthButton:return{eventName:"CritiqueCardShownViaBrowserForwardButtonAction",data:t}}}},268638:(e,t,i)=>{if(i.d(t,{B:()=>l}),0!=i.j)var n=i(722864);if(0!=i.j)var s=i(341755);if(0!=i.j)var o=i(545208);if(0!=i.j)var r=i(890928);if(0!=i.j)var a=i(251439);class l{constructor(){this.imports=[r.Q,n.E]}get uniqueId(){return(0,a.z)(507918302)}configureRootServices(e){e.bind(s.i).toValue(o._)}}},268809:(e,t,i)=>{i.d(t,{S:()=>c});var n=i(379490),s=i(208520),o=i(522775),r=i(246886),a=i(229906),l=i(83010);const d="multilingualProofingFre";let c=class{constructor(e){this.footerFreStore=e}addMultilingualProofingFre(){this.footerFreStore.addFooterPage(o.Y.critique,d,{icon:"LocaleLanguage",content:(e,t)=>s.createElement(r.R,{style:e,theme:t})})}removeMultilingualProofingFre(){this.footerFreStore.removeFooterPage(o.Y.critique,d)}setOnShowEditorSettings(e){this._onShowEditorSettings=e}showEditorSettings(){this._onShowEditorSettings&&this._onShowEditorSettings(!0)}};c=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(o.D))],c)},270793:(e,t,i)=>{i.d(t,{Gv:()=>p,o9:()=>n,tq:()=>h,v$:()=>s});var n,s,o=i(379490),r=i(668952),a=i(229906),l=i(83010),d=i(851840),c=i(494888),u=i(240874),g=i(102998);!function(e){e[e.SettingsShown=0]="SettingsShown",e[e.CalloutShown=1]="CalloutShown",e[e.PageContext=2]="PageContext"}(n||(n={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout",e[e.PageContext=2]="PageContext"}(s||(s={}));const h=(0,r.f)("IUnsignedInEditorFeature");let p=class extends d.W{constructor(e,t,i){super(),this._featureFlagsReader=t,this._languageDetector=i,this.enablers=[!0],this.disablers.push(this),this.disablers.push(e)}check(){return!this._featureFlagsReader.flags.enableUnsignedInEditor}async emitAndEvaluateAsync(e){return this.emitAndEvaluate(e)&&this.checkForMultipleLanguages()}async checkForMultipleLanguages(){const e=await this.countUniqueLanguages();return!this._featureFlagsReader.flags.enableSuppressUnsignedInEditorForMultiLang||e<=1}async countUniqueLanguages(){return(await this._languageDetector.getBrowserLanguages()).reduce(((e,t)=>{const i=t.split("-");if(i.length>0){const t=i[0];e.add(t)}return e}),new Set).size}};p=(0,o.__decorate)([(0,a._)(),(0,o.__param)(0,(0,l.W)(g.Z)),(0,o.__param)(1,(0,l.W)(c.c)),(0,o.__param)(2,(0,l.W)(u.v))],p)},270935:(e,t,i)=>{i.d(t,{U:()=>o});const n="beee531d6e2444fe9a9a1c9aaa5b53cd-78755306-c8fb-4c51-9e77-9eb483e17ceb-6535",s=(e,t)=>{const i=[];for(const s of Object.keys(e)){if(void 0===e[s]||null===e[s])continue;const o={name:t?`${t}.${s}`:s,dataType:(n=e[s],"string"==typeof n?0:"boolean"==typeof n?1:"number"==typeof n?2:0),value:e[s],classification:4};i.push(o)}var n;return i};function o(e){return(t,i,o,r,a,l,d,c)=>{const u=t===n;let g,h=s(o);if(r){let e=s(a,r.split(".").slice(-1)[0]);u&&(e=[...e,...h],h=[]),g={name:r,dataFields:e}}const p={telemetryProperties:{ariaTenantToken:t,nexusTenantToken:-1},eventName:i,dataFields:h,eventFlags:{dataCategories:d,diagnosticLevel:c},eventContract:g};e.sendTelemetryEvent(p)}}},271826:(e,t,i)=>{i.d(t,{U:()=>E});var n=i(379490),s=i(823325);var o=i(433858),r=i(329423),a=i(794300),l=i(766535),d=i(957242);class c extends a.z{constructor(e,t,i){super(),this._settings=e,this._logger=t,this._fre=i,this._critiquesByNode=new Map,this._latestNodeVersion=new Map,this._wordBoundaries=new Map,this.removeCritique=(e,t,i)=>{const n=null==i?void 0:i(t);if(!n)return"removeCritique - Unable to find tileNode";const s=this._critiquesByNode.get(n),o=s?this.findCritiqueInCritiques(s,e):void 0;if(!s||!o)return"removeCritique - Unable to find critique on tile";this.removeKnownCritique(o,s,o),this.dispatchCritiquesForNode(n,"Update")},this.getCritique=(e,t,i)=>{var n;const s=null==i?void 0:i(t);if(!s)return void(null===(n=this._logger)||void 0===n||n.error(507900049,"getCritique - Unable to find tileNode"));const o=this._critiquesByNode.get(s);return o?this.findCritiqueInCritiques(o,e):void 0},this.dispatchCritiquesForNode=(e,t)=>{const i=this._critiquesByNode.get(e),n=i?this.getCritiquesToDispatch(i):[];this.publishEvent("dispatchCritiques",{critiques:n,nodeId:e,messageType:s.G.NewData,reason:t})},this.removeAllCritiquesOfType=e=>{for(const t of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeFromNode(t,e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{for(const i of this._critiquesByNode.keys())this.removeAllCritiquesOfTypeAndTextFromNode(i,e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{const i=this.getCritiques(e);if(!i)return;const n=[];for(const e of i.critiques.values())e.typeId===t&&n.push(e);if(n.length>0){for(const e of n)this.removeSpecifiedCritique(e,i.critiques);this.dispatchCritiquesForNode(i.tileId,"Clear")}},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,i)=>{const n=this.getCritiques(e);if(!n)return;const s=[];for(const e of n.critiques.values())e.typeId===t&&e.textInContext===i&&s.push(e);if(s.length>0){for(const e of s)this.removeSpecifiedCritique(e,n.critiques);this.dispatchCritiquesForNode(n.tileId,"Clear")}},this.removeSpecifiedCritique=(e,t)=>{for(const i of t.values())if(i.traceId===e.traceId)return this.removeKnownCritique(e,t,i),!0;return!1},this.removeKnownCritique=(e,t,i)=>{(function(e){return"isFlagCritique"in e})(e)&&e.isIgnored||t.delete(i),this.publishEvent("removeCritiques",{critiques:new Set([i])})},this.getOverlappingCritiques=(e,t)=>{var i;const n=[];let s=1/0,r=!1,a=!1;for(const d of e)d.traceId!==t.traceId&&(0,o.tw)(d,t)&&(s=Math.min(s,d.priority),r=r||d.typeId===l.L9.TopicSuggestion,a=a||null!==(i=d.isIgnored)&&void 0!==i&&i,n.push(d));return{shouldOverrideCritiques:!a&&(t.typeId===l.L9.TopicSuggestion||!r&&s>=t.priority),critiques:n}},this.getCritiquesToDispatch=e=>{var t;const i=Array.from(e.values()).filter((e=>e.isVisible&&!e.isIgnored));return null===(t=this._fre)||void 0===t||t.setFor(i),i},this.findCritiqueInCritiques=(e,t)=>{for(const i of e.values())if(i.traceId===t)return i}}clearNode(e){let t=!1;const i=this._critiquesByNode.get(e);i&&(this._critiquesByNode.delete(e),this._wordBoundaries.delete(e),this.publishEvent("removeCritiques",{critiques:i}),this._latestNodeVersion.has(e)&&this._latestNodeVersion.delete(e),t=!0),t&&this.publishEvent("dispatchCritiques",{critiques:[],nodeId:e,messageType:s.G.RemoveData,reason:"Clear"})}resetNode(e){this.clearNode(e),this.updateNode([],e,0)}getAllCritiques(){const e=[];for(const t of this._critiquesByNode.keys()){const i=this.getCritiques(t);i&&e.push(i)}return e}getCritiques(e){var t;const i=this._critiquesByNode.get(e);if(i){return{critiques:i,tileId:e,tileVersion:null!==(t=this._latestNodeVersion.get(e))&&void 0!==t?t:0}}}setWordBoundaries(e,t,i,n){var s,o;let r=this._wordBoundaries.get(e);r||(r=new Map,this._wordBoundaries.set(e,r));const a=null!==(o=null===(s=r.get(t.id))||void 0===s?void 0:s.length)&&void 0!==o?o:0,l=t.range.span-a;if(r.set(t.id,{offset:t.range.offset,length:n&&a?a:t.range.span,boundaries:i}),!n)for(const e of r.values())e.offset>t.range.offset&&(e.offset+=l)}removeWordBoundariesByPosition(e,t,i){const n=this._wordBoundaries.get(e);if(!n)return;const s=t+i-1;for(const[e,o]of n)if(o.offset<t){const e=o.offset+o.length-1;e>t&&(o.length-=e-t)}else o.offset>=t&&o.offset+o.length-1<=s?n.delete(e):o.offset>=t&&o.offset<=s?(o.length-=t+i-o.offset,o.offset=t):o.offset-=i}updateNode(e,t,i,n=!1){var s,o;i>=(null!==(s=this._latestNodeVersion.get(t))&&void 0!==s?s:0)&&this._latestNodeVersion.set(t,i);const a=this._critiquesByNode.get(t),l=this._wordBoundaries.get(t);if(a){if(n||(null!==(o=this._settings.enableDispatchCritiquesOnEmptyDiffs)&&void 0!==o?o:e.length>0)){for(const t of e){const e=this.getOverlappingCritiques(a,t.critique);switch(t.critiqueDiffType){case r.K.Add:case r.K.Update:if(e.critiques.length){if(e.shouldOverrideCritiques){for(const t of e.critiques)this.removeSpecifiedCritique(t,a);this.isNotPartialCritique(t.critique,l)&&a.add(t.critique)}}else this.isNotPartialCritique(t.critique,l)&&a.add(t.critique);break;case r.K.Delete:this.removeSpecifiedCritique(t.critique,a);case r.K.Move:}}const i=[];if(i.push(t),c=e,(0,d.A)(c)){const e=function(e,t){const i=[];return i.concat((0,d.o)(e,t)),i}(this._critiquesByNode,!!this._settings.enableStealthSquiggles);for(const t of e)t.nodeId&&i.push(t.nodeId)}for(const e of i)this.dispatchCritiquesForNode(e,"Update")}}else this._critiquesByNode.set(t,new Set);var c}isNotPartialCritique(e,t){if(!0===this._settings.disableWordBoundaries||!t||0===t.size)return!0;for(const i of t.values())if(e.start>=i.offset&&e.start<i.offset+i.length){const t=i.offset;for(const n of i.boundaries){const i=n.start+t,s=n.end+t+1,o=s-i;if(e.start>=i&&e.start+e.length<=s&&e.length<o)return!1}return!0}return!0}setAugLoopProcessingHandler(e){}}const u=(0,i(668952).f)("ICritiquesFre");var g=i(537969),h=i(118673),p=i(411995),m=i(904196),f=i(383714),v=i(553164),y=i(761799),_=i(538045),I=i(281795),C=i(46437),S=i(229906),b=i(83010),T=i(427603);let E=class{get core(){return this._critiqueStoreCore}constructor(e,t,i,n,s,o,r,a,l){this._hostSettings=e,this._upsellStore=t,this._proofingEmitter=i,this._hostEmitter=n,this._proofingDom=s,this._logger=o,this._indicatorStore=r,this._fre=a,this._sessionTelemetryTracker=l,this.removeCritique=(e,t)=>{const i=this._critiqueStoreCore.removeCritique(e,t,this.nodeIdFinder);return i&&this._logger.error(505295058,i),i},this.getCritique=(e,t)=>this._critiqueStoreCore.getCritique(e,t,this.nodeIdFinder),this.nodeIdFinder=e=>{var t;if(!e)return;const i=this._proofingDom.findNode(e);return(null==i?void 0:i.nodeType)===v.Z.TileNode?i.id:(null==i?void 0:i.nodeType)===v.Z.ParagraphNode?null===(t=i.parent)||void 0===t?void 0:t.id:void 0},this.removeAllCritiquesOfType=e=>{this._critiqueStoreCore.removeAllCritiquesOfType(e)},this.removeAllCritiquesOfTypeAndText=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndText(e,t)},this.removeAllCritiquesOfTypeFromNode=(e,t)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeFromNode(e,t)},this.removeAllCritiquesOfTypeAndTextFromNode=(e,t,i)=>{this._critiqueStoreCore.removeAllCritiquesOfTypeAndTextFromNode(e,t,i)},this.onDispatchCritiques=({critiques:e,nodeId:t,messageType:i,reason:n})=>{var s;const o=this._proofingDom.findTileNode(t);if(o){if("VisualStateChange"===n&&0===e.length)return;this._proofingEmitter.emit("squiggleDataEvent",{messageType:i,data:{critiquesToElementsMap:[{elementId:t,element:o.element,critiques:e.map(p.OE)}],isVisualStateChange:"VisualStateChange"===n}}),null===(s=this._sessionTelemetryTracker)||void 0===s||s.update(e,t)}},this.onRemoveCritiques=e=>{var t,i;for(const n of e.critiques.values())null===(t=this._upsellStore)||void 0===t||t.removePremiumCritique(n),null===(i=this._indicatorStore)||void 0===i||i.removePaneCritique(n.traceId,n.categoryTitle)},this._critiqueStoreCore=new c(this._hostSettings,this._logger,this._fre),this._critiqueStoreCore.subscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.subscribe("removeCritiques",this.onRemoveCritiques)}async initialize(){this._proofingEmitter.on("proofingLanguageChanged",(e=>{if(e.proofingLanguagesChanged&&!this.augLoopProcessingHandler)for(const e of this._proofingDom.tileNodes)this.resetNode(e.id)})),this._hostEmitter.on(g.pD.hostModelTileStateReset,(e=>{this.augLoopProcessingHandler||this.resetNode(e.message)})),this._hostEmitter.on(g.pD.hostModelVisualStateChange,(e=>{e.message.created&&!this.augLoopProcessingHandler&&this._critiqueStoreCore.dispatchCritiquesForNode(e.message.tileId,"VisualStateChange")}))}shutDown(){this._proofingEmitter.off("proofingLanguageChanged"),this._hostEmitter.off(g.pD.hostModelTileStateReset),this._hostEmitter.off(g.pD.hostModelVisualStateChange),this._critiqueStoreCore.unsubscribe("dispatchCritiques",this.onDispatchCritiques),this._critiqueStoreCore.unsubscribe("removeCritiques",this.onRemoveCritiques)}clearNode(e){this.augLoopProcessingHandler?this.augLoopProcessingHandler.clearNode(e):this._critiqueStoreCore.clearNode(e)}resetNode(e){this.augLoopProcessingHandler||this._critiqueStoreCore.resetNode(e)}getAllCritiques(){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getAllCritiques():this._critiqueStoreCore.getAllCritiques()}getCritiques(e){return this.augLoopProcessingHandler?this.augLoopProcessingHandler.getCritiques(e):this._critiqueStoreCore.getCritiques(e)}updateNode(e,t,i,n=!1){this.augLoopProcessingHandler?this.augLoopProcessingHandler.updateNode(e,t,i,n):this._critiqueStoreCore.updateNode(e,t,i,n)}setAugLoopProcessingHandler(e){this.augLoopProcessingHandler=e}};E=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.W)(m.n)),(0,n.__param)(1,(0,T.l)()),(0,n.__param)(1,(0,b.W)(y.Ey)),(0,n.__param)(2,(0,b.W)(h.o)),(0,n.__param)(3,(0,b.W)(g.M5)),(0,n.__param)(4,(0,b.W)(_.w)),(0,n.__param)(5,(0,b.W)(f.g)),(0,n.__param)(6,(0,T.l)()),(0,n.__param)(6,(0,b.W)(I.y)),(0,n.__param)(7,(0,T.l)()),(0,n.__param)(7,(0,b.W)(u)),(0,n.__param)(8,(0,T.l)()),(0,n.__param)(8,(0,b.W)(C.H))],E)},272385:(e,t,i)=>{i.d(t,{$:()=>c});var n=i(379490),s=i(753031),o=i(46692),r=i(609062),a=i(786132),l=i(787924),d=i(229906);let c=class{constructor(e,t,i){this._mutationObserverFactory=e,this.elementTransformers=t,this._logger=i,this.connectMutationObserver=(e,t,i,n)=>{this._mutationObserver=this._mutationObserverFactory((e=>{e.forEach(((e,s,o)=>{const l=null==n?void 0:n.filterSelector;let d=!1;t.ignoredMutationElementsSelectors&&(0,a.C)(e.target,"Element")&&(d=e.target.matches(t.ignoredMutationElementsSelectors)),l&&l!==e.target.nodeName&&d||this.handleMutation(e,r.Q0.Local,null==i?void 0:i(e,s,o))}))})),this._mutationObserver.observe(e,t)},this.flushMutationObserver=e=>{this._mutationObserver&&this._mutationObserver.takeRecords().forEach(((t,i,n)=>this.handleMutation(t,r.Q0.Local,e?e(t,i,n):void 0)))},this.handleMutation=(e,t,i)=>{var n;try{const n=this.onElementRemoved,s=this.onElementAdded,o=this.onElementChanged;switch(e.type){case"childList":if(n){Array.from(e.removedNodes).forEach((e=>{n(e,t,i)}))}if(s){Array.from(e.addedNodes).forEach((e=>{s(e,t,i)}))}break;case"characterData":o&&o(e.target,t);break;case"attributes":this.handleAttributeChange(e,t,s,o,n)}}catch(e){null===(n=this._logger)||void 0===n||n.logEvent(508146690,l.s.MutationError,s.q.Error,"Error while processing a mutation.",o.o.SamplingPolicy.CriticalBusinessImpact,e)}}}handleAttributeChange(e,t,i,n,s){const o=e.attributeName,r=e.target;this.elementTransformers&&o&&this.elementTransformers.forEach((e=>{e.attributeList.includes(o)&&e.transform(r)})),null==n||n(r,t,void 0)}disconnect(e){this._mutationObserver&&(this._mutationObserver.takeRecords(),this._mutationObserver.disconnect())}};c=(0,n.__decorate)([(0,d._)()],c)},272512:(e,t,i)=>{if(i.d(t,{Q:()=>a}),0!=i.j)var n=i(105244);if(0!=i.j)var s=i(42568);if(0!=i.j)var o=i(46692);if(0!=i.j)var r=i(787924);const a=(e,t,i,a)=>{if(!e||!t)return;const l=e.getNewActivity(r.M.WebSiteProvedOnce,o.o.SamplingPolicy.CriticalBusinessImpact),d=t.getCachedEntry(n.l.ProofingLanguages).storeEntryValue;let c;a.execute(!1,(e=>(c=null==e?void 0:e.regionScope,e))),l&&(l.dataFields.push(...(0,s.W)(["Proofing_Languages",d.join(",")],["Region_Scope",null!=c?c:"unknown"],["IsAL",!0===i.enableOrchestration&&i.orchestratorSettings&&!0===i.orchestratorSettings.enableAugLoop||!1])),l.success=!0,l.endNow())}},272585:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Pravopis","IsImplemented":true}}')},274606:(e,t,i)=>{if(i.d(t,{I:()=>r,S:()=>o}),0!=i.j)var n=i(379490);if(0!=i.j)var s=i(976333);function o(e){const{text:t,action:i,languages:o,metadataJSON:r,description:a}=e,l=(0,n.__rest)(e,["text","action","languages","metadataJSON","description"]);return Object.assign({text:t,action:(0,s.fO)(i),languages:o,metadataJSON:r,description:a},l)}function r(e){const{text:t,action:i,languages:o,metadataJSON:r,description:a}=e,l=(0,n.__rest)(e,["text","action","languages","metadataJSON","description"]),{confidenceLevel:d,source:c}=l;return Object.assign({text:t,action:(0,s.BJ)(i),languages:o,metadataJSON:r,description:a,confidenceLevel:d||0,source:c||0},l)}},276646:(e,t,i)=>{i.d(t,{AK:()=>b,CL:()=>N,JZ:()=>r,N2:()=>D,OE:()=>o,OY:()=>u,R7:()=>E,RK:()=>I,Ss:()=>C,Uj:()=>q,WT:()=>c,cc:()=>f,dm:()=>s,fL:()=>l,g7:()=>_,h8:()=>F,hG:()=>h,hf:()=>d,hk:()=>v,iI:()=>x,iL:()=>y,l1:()=>p,mj:()=>L,pp:()=>R,qS:()=>a,rE:()=>m,rN:()=>g,s1:()=>n,tb:()=>w,v3:()=>T,vb:()=>S,xe:()=>A});const n="OAPanelDisplayed",s="OAPanelUserInteraction",o="OAValueInserted",r="keptMetricEnabled",a="OAValueKept",l="OAPanelClosed",d="OACurrentQueryDismiss",c="OAPanelRequestUpdate",u="OAPanelUpdated",g="OAPanelClearQuery",h="OAPanelRetry",p="MouseEntering",m="DownArrow",f="UpArrow",v="Enter",y="Escape",_="Tab",I="Space",C="OAClientLayout",S="OAResponseReceived",b="OAClientDataSource",T="OAAutomaticScopeDetected",E="suggestions",N="GraphSearch",w="OAShowMoreEntitiesOpened",x="OAShowMoreEntitiesError",L="OAShowMoreEntitiesClosed",D="OAShowMoreEntitiesSearchCleared",A="OAShowMoreEntitiesSearchChanged",F="ExpandedEccSearchBarTextChaged",q="ExpandedEccSearchBarResultSelected",R="ExpandedEccUploadMenuEvent"},276961:(e,t,i)=>{i.d(t,{T:()=>n});const n=(0,i(668952).f)("IClientSubscriber")},277922:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Výstižnost","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Konzistentní psané tvary","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Nediskriminující jazyk"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Překlepy"},"Clarity":{"LocalizedName":"Jasnost","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"Přeformulování","IsImplemented":false},"Error Corrections":{"LocalizedName":"Oprava chyb","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Slovní zásoba","IsImplemented":true},"Grammar":{"LocalizedName":"Gramatika","IsImplemented":true},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"Formální vyjadřování"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Interpunkce","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"Pravopis","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Pravopis"},"Resume":{"LocalizedName":"Životopis","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Citlivé geopolitické odkazy"}}')},278301:(e,t,i)=>{i.d(t,{U:()=>s});var n=i(668952);(0,n.f)("IEditorCritiqueGroups");const s=(0,n.f)("ICIQFlagEditorCategories")},278406:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"간결성","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"일관된 서식","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"가치 중립적 언어"},"Typing errors":{"IsImplemented":false,"LocalizedName":"오타"},"Clarity":{"LocalizedName":"명료성","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"다시 쓰기","IsImplemented":false},"Error Corrections":{"LocalizedName":"오류 수정","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"어휘 선택"},"Grammar":{"LocalizedName":"어법","IsImplemented":true},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"형식 언어","IsImplemented":false},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"구두법","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"글쓰기 규칙"},"Spelling":{"LocalizedName":"맞춤법","IsImplemented":true},"Resume":{"LocalizedName":"이력서","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"민감한 지정학적 용어"}}')},279e3:(e,t,i)=>{i.d(t,{$:()=>o});var n,s=i(668952);!function(e){e[e.Add=0]="Add",e[e.Move=1]="Move",e[e.Update=2]="Update",e[e.Delete=4]="Delete"}(n||(n={}));const o=(0,s.f)("ICritiqueStore")},279009:(e,t,i)=>{if(i.d(t,{a:()=>r}),0!=i.j)var n=i(844517);if(0!=i.j)var s=i(278913);var o=i(208520);const r=({listBoxProps:e,ariaLabel:t})=>o.createElement(n.O,Object.assign({},e,{"aria-label":t}),o.createElement(s.B,null),o.createElement(s.B,null),o.createElement(s.B,null),o.createElement(s.B,null),o.createElement(s.B,null))},279215:(e,t,i)=>{i.d(t,{c:()=>h});var n=i(379490),s=i(576240),o=i(481593),r=i(442316),a=i(359310),l=i(538045),d=i(615930),c=i(229906),u=i(83010),g=i(427603);let h=class extends s.Z{constructor(e,t,i,n,s){super(e,t,n,i,s),this.attachedToParagraphLevelDivs=!0}};h=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(l.w)),(0,n.__param)(1,(0,u.W)(o.h)),(0,n.__param)(2,(0,u.W)(r.g)),(0,n.__param)(3,(0,u.W)(a.j)),(0,n.__param)(4,(0,u.W)(d.sh)),(0,n.__param)(4,(0,g.l)())],h)},280767:(e,t,i)=>{i.d(t,{DS:()=>u,KW:()=>g,OV:()=>n,xr:()=>s});var n,s,o=i(379490),r=i(668952),a=i(229906),l=i(83010),d=i(851840),c=i(907142);!function(e){e[e.ShowPage=0]="ShowPage",e[e.GetMoreCommands=1]="GetMoreCommands"}(n||(n={})),function(e){e[e.SettingsPage=0]="SettingsPage",e[e.CritiqueCallout=1]="CritiqueCallout"}(s||(s={}));const u=(0,r.f)("IShowSynonymsFeature");let g=class extends d.W{constructor(e){super(),this._isPremiumUser=e,this.disablers=[],this.enablers=[!1,this._isPremiumUser]}};g=(0,o.__decorate)([(0,a._)(),(0,o.__param)(0,(0,l.W)(c.r))],g)},281672:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Правопис"}}')},281769:(e,t,i)=>{if(i.d(t,{Cf:()=>o,dB:()=>r,uE:()=>a}),0!=i.j)var n=i(786132);if(0!=i.j)var s=i(49095);const o=e=>{const t={},i=window.getComputedStyle(e),o=(0,n.C)(e,"HTMLInputElement");if(t.whiteSpace="pre-wrap",t.wordWrap="break-word",["position","direction","boxSizing","writingMode","width","height","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","borderStyle","paddingTop","paddingRight","paddingBottom","paddingLeft","fontStyle","fontVariant","fontWeight","fontStretch","fontSize","fontSizeAdjust","lineHeight","fontFamily","textAlign","textTransform","textIndent","textDecoration","letterSpacing","wordSpacing","tabSize","MozTabSize","display","visibility"].forEach((e=>{t[e]=i[e]})),t.paddingBottom="0px"===t.paddingBottom?0:t.paddingBottom,o){const n=i.boxSizing&&"content-box"!==i.boxSizing?parseFloat(i.height)-parseFloat(i.paddingTop)-parseFloat(i.paddingBottom)-parseFloat(i.borderTopWidth)-parseFloat(i.borderBottomWidth):i.height;t.lineHeight=Number.isNaN(Number(n))?n:`${n}px`,t.whiteSpace="pre",t.overflow="hidden",t.height=parseFloat(t.height)+3,"search"===e.getAttribute("type")&&(t.direction&&"ltr"!==t.direction?t.paddingLeft=`${parseFloat(i.paddingLeft||0)+15}px`:t.paddingRight=`${parseFloat(i.paddingRight||0)+15}px`)}const r={anchor:e,computedWidth:t.width,computedOverflow:i.overflowY||"",boxSizing:i.boxSizing,isInput:o};let a="auto";if(i.zIndex&&"auto"!==i.zIndex){const e=parseInt(i.zIndex,10);a=isNaN(e)?0:e+1}return{overlay:Object.assign(Object.assign({},t),{left:0,top:0,position:"absolute",pointerEvents:"none",resize:"unset",backgroundColor:"transparent",borderColor:"transparent",WebkitTextFillColor:"none",color:"transparent",willChange:"contents",outline:"none",zIndex:a,lineHeight:Number.isNaN(t.lineHeight)?"unset":t.lineHeight,height:Number.isNaN(t.height)?"unset":t.height,width:Number.isNaN(t.width)?"unset":(0,s.x)(r)}),anchor:t}},r=(e,t,i)=>{var n;if(!t)return{top:0,left:0};const s=null!==(n=i.current)&&void 0!==n?n:{top:0,left:0},o=e.getBoundingClientRect(),r=t.getBoundingClientRect(),a=o.top-r.top,l=o.left-r.left;return{top:Math.abs(a)>0?s.top+a:s.top,left:Math.abs(l)>0?s.left+l:s.left,position:"relative",height:"0px"}},a=(e,t)=>({width:"100%",overflow:"hidden",height:e.scrollHeight-e.clientHeight===0?`calc(100% + ${null!=t?t:"2px"})`:"calc(100% + 2px)"})},281795:(e,t,i)=>{i.d(t,{y:()=>n});const n=(0,i(668952).f)("IIndicatorStore")},287364:(e,t,i)=>{i.d(t,{p:()=>m});var n=i(379490),s=i(537969),o=i(823325),r=i(105244),a=i(609062),l=i(442316),d=i(233653),c=i(922630),u=i(335009),g=i(538045),h=i(229906),p=i(83010);let m=class{constructor(e,t,i,n,s,o){this._logger=e,this._proofingDom=t,this._proofingPersistedStore=i,this._nodePoller=n,this._hostEmitter=s,this._hostSettings=o,this.getLocalesForSameLanguage=async e=>{var t,i,n,s;const o=[],a=await this._proofingPersistedStore.read(r.l.ProofingLanguages),l=e.suggestions.length&&(null===(t=e.suggestions[0].languages)||void 0===t?void 0:t.length)?e.suggestions[0].languages[0]:null!==(s=null!==(i=a[0])&&void 0!==i?i:null===(n=this._hostSettings.proofingLocales)||void 0===n?void 0:n[0])&&void 0!==s?s:this._hostSettings.defaultLocale;if(l){const e=l.split("-")[0];for(const t of a)e===t.split("-")[0]&&o.push(t)}else this._logger.error(557953868,"Expected language in ISuggestion or the list of Proofing Languages");return o}}async disableCritique(e){if(void 0===e.typeId)return;const t=await this._proofingPersistedStore.read(r.l.OverriddenCritiqueTypeOptions);let i=!1;for(const n of t)n.id===e.typeId&&(n.value="0",i=!0);if(!i){const i=await this.getLocalesForSameLanguage(e);for(const n of i)t.push({id:e.typeId,languageId:n,name:"",value:"0"})}await this._proofingPersistedStore.write(r.l.OverriddenCritiqueTypeOptions,t),this._hostEmitter.emit(s.pD.critiqueSettingsChange,{address:void 0,message:t}),this._nodePoller.pollNodes(o.G.ChangeData,this._proofingDom.tileNodes,a.Q0.Code),this._onDisableCritique&&this._onDisableCritique(e.typeId)}setOnDisableCritique(e){this._onDisableCritique=e}};m=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,p.W)(l.g)),(0,n.__param)(1,(0,p.W)(g.w)),(0,n.__param)(2,(0,p.W)(d.K)),(0,n.__param)(3,(0,p.W)(u.G)),(0,n.__param)(4,(0,p.W)(s.M5)),(0,n.__param)(5,(0,p.W)(c.n))],m)},287587:(e,t,i)=>{i.d(t,{J:()=>a});var n=i(77127);if(0!=i.j)var s=i(400377);if(0!=i.j)var o=i(728178);var r=i(208520);const a=e=>{const{hostSettings:t,themeStore:i}=e,a=(0,o.ZY)(),[l,d]=r.useState(null==i?void 0:i.getComponentActiveTheme(n.yF.predictionContainerComponentName,!0));r.useEffect((()=>{if(!i)return()=>{};const e=()=>{d(i.getComponentActiveTheme(n.yF.predictionContainerComponentName,!0))};return i.subscribe("currentThemeUpdated",e),i.subscribe("defaultThemeUpdated",e),i.subscribe("themesUpdated",e),()=>{i.unsubscribe("currentThemeUpdated",e),i.unsubscribe("defaultThemeUpdated",e),i.unsubscribe("themesUpdated",e)}}),[i]);const c=(0,s.A)(l);return r.useEffect((()=>{if(!t.disableInlineStyleTagInCanvas||!a||!c)return;const e=a.getElementById("ms-prediction-style");if(null===e){const e=a.createElement("style");e.type="text/css",e.id="ms-prediction-style",e.appendChild(a.createTextNode(c)),a.head.appendChild(e)}else e.innerText=c}),[t,a,c]),t.disableInlineStyleTagInCanvas?null:r.createElement("style",{type:"text/css"},c)}},287704:(e,t,i)=>{i.d(t,{Q:()=>r});var n=i(379490),s=i(494163),o=i(229906);let r=class extends s.z{};r=(0,n.__decorate)([(0,o._)()],r)},288296:(e,t,i)=>{if(i.d(t,{K:()=>r}),0!=i.j)var n=i(904255);if(0!=i.j)var s=i(93659);if(0!=i.j)var o=i(786132);function r(e){return e?(0,o.C)(e,"HTMLElement")?e:(0,s.K2)(e)?new n.M(e.left,e.right,e.top,e.bottom):(0,s.Pe)(e)?e:e.getBoundingClientRect():null}},289062:(e,t,i)=>{if(i.d(t,{C:()=>r}),0!=i.j)var n=i(753031);var s=i(758651);const o=(e,t,i,n)=>{const s={eventName:e,tagID:`0x${`00000000${t.toString(16)}`.slice(-8)}`,message:i,data:n};return JSON.stringify(s)};class r{async initialize(){}addCorrelationID(e){s.log(`CorrelationID is: ${e}`)}log(e,t,i,n){this.dispatchLog(null,e,t,i,n)}debug(e,t,i){this.dispatchLog(null,e,n.q.Debug,t,i)}error(e,t,i){this.dispatchLog(null,e,n.q.Error,t,i)}warn(e,t,i){this.dispatchLog(null,e,n.q.Warn,t,i)}info(e,t,i){this.dispatchLog(null,e,n.q.Info,t,i)}logEvent(e,t,i,n,s,o){this.dispatchLog(t,e,i,n,o)}dispatchLog(e,t,i,r,a){switch(i){case n.q.Debug:s.log(o(e,t,r,a));break;case n.q.Error:s.error(o(e,t,r,a));break;case n.q.Info:s.info(o(e,t,r,a));break;case n.q.Warn:s.warn(o(e,t,r,a));break;default:throw new Error("Invalid logging level")}}getNewActivity(e,t,i){s.log(e)}}},290053:(e,t,i)=>{i.d(t,{$:()=>n});const n=(0,i(668952).f)("IRemoteSettingsSyncer")},290719:(e,t,i)=>{if(i.d(t,{a:()=>u}),0!=i.j)var n=i(818935);var s=i(252723),o=i(108520);if(0!=i.j)var r=i(455115);var a=i(522775),l=i(756857),d=i(208520);const c=(0,s.F5)({localizer:o.A.on(l.H),footerFreStore:o.A.on(a.D)}),u=e=>{var t;const{theme:i,style:o,languageName:l,undoCallback:u,manageLanguagesCallback:g}=e,{localizer:h,footerFreStore:p}=(0,s.KN)(c),m=()=>{p.removeFooterPage(a.Y.languageAutoDetection,r.Id)};return d.createElement("div",{style:Object.assign({color:null!==(t=null==i?void 0:i.textColor)&&void 0!==t?t:"#323130",minWidth:250},o)},d.createElement("div",{style:{marginBottom:12,paddingRight:14}},h.getMessage("autoDetectionFRE_HeadingText",l)),d.createElement("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-end"}},d.createElement(n.$,{appearance:"transparent",style:{fontSize:12,padding:2,minWidth:"fit-content",height:"revert",minHeight:24},onClick:()=>{u(),m()}},h.getMessage("autoDetectionFRE_UndoButtonText",l)),d.createElement(n.$,{style:{borderRadius:4,marginLeft:8,fontSize:12,height:"fit-content",minHeight:24,textAlign:"left",paddingLeft:4,paddingRight:4,paddingTop:2,paddingBottom:2},onClick:()=>{g(),m()}},h.getMessage("autoDetectionFRE_ManageLanguagesText",l))))}},291688:(e,t,i)=>{if(i.d(t,{p:()=>c}),0!=i.j)var n=i(177822);if(0!=i.j)var s=i(276961);if(0!=i.j)var o=i(150231);if(0!=i.j)var r=i(137796);if(0!=i.j)var a=i(508030);if(0!=i.j)var l=i(251439);if(0!=i.j)var d=i(806988);class c{constructor(){this.imports=[n.J,a.k]}get uniqueId(){return(0,l.z)(507918226)}configureRootServices(e){e.bind(s.T).to(r.g),e.bind(o.cl).toDynamicValue((e=>(e,t)=>{var i;const n=(0,d.g)(e,null===(i=t.hostSettings.orchestratorSettings)||void 0===i?void 0:i.substrateAuthTokenCallback);return Object.assign(Object.assign({},e),{isFeatureEnabled:n.isFeatureEnabled,requestAuthToken:n.requestAuthToken})}))}}},293447:(e,t,i)=>{i.d(t,{C:()=>d});var n=i(379490),s=i(538045),o=i(378071),r=i(229906),a=i(83010),l=i(1144);let d=class{constructor(e){this._proofingDom=e}getFormattingAt(e,t=0,i=-1){let n=null;if(n="string"==typeof e?this._proofingDom.findParagraphNode(e):e,(0,l.l)(n)){const e=n.parent.textFormattingInfo;if(e){const s=n.element.offset+t;return(0,o.FD)(e,s,i<0?s+n.element.span:s+i)}}}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(s.w))],d)},294149:(e,t,i)=>{if(i.d(t,{A:()=>l}),0!=i.j)var n=i(979075);if(0!=i.j)var s=i(83518);if(0!=i.j)var o=i(939074);if(0!=i.j)var r=i(251439);if(0!=i.j)var a=i(386675);class l{constructor(){this.imports=[o.A]}get uniqueId(){return(0,r.z)(505680092)}configureRootServices(e){e.bind(a.S).toExisting(n.v),e.bind(n.v).to(s.k)}}},294890:(e,t,i)=>{if(i.d(t,{v:()=>_}),0!=i.j)var n=i(117862);if(0!=i.j)var s=i(611103);if(0!=i.j)var o=i(434340);if(0!=i.j)var r=i(974943);if(0!=i.j)var a=i(46437);if(0!=i.j)var l=i(362172);if(0!=i.j)var d=i(271826);if(0!=i.j)var c=i(306555);if(0!=i.j)var u=i(537205);if(0!=i.j)var g=i(303170);if(0!=i.j)var h=i(843785);if(0!=i.j)var p=i(251439);if(0!=i.j)var m=i(386675);if(0!=i.j)var f=i(279e3);if(0!=i.j)var v=i(383806);if(0!=i.j)var y=i(224557);class _{constructor(){this.imports=[n.I]}get uniqueId(){return(0,p.z)(507908322)}configureRootServices(e){e.bind(m.S).to(u.o),e.bind(c.S).toSelf(),e.bind(g.F).toSelf(),e.bind(h.o).toSelf(),e.bind(v.l).toSelf(),e.bind(y.b).toSelf(),e.bind(a.H).to(l.y),e.bind(f.$).to(d.U),e.bind(m.S).toExisting(f.$),e.bind(s.D).to(o.H),e.bind(s.D).to(r.o)}}},294965:(e,t,i)=>{var n,s,o,r,a,l;i.d(t,{G_:()=>a}),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(n||(n={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(s||(s={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(o||(o={})),function(e){e.GCC="GCC",e.Worldwide="WW"}(r||(r={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(l||(l={}))},296048:(e,t,i)=>{if(i.d(t,{Q:()=>r,b:()=>a}),0!=i.j)var n=i(842117);var s=i(208520);const o=(0,s.createContext)(null),r=({store:e,children:t})=>s.createElement(o.Provider,{value:e},t),a=e=>(0,n.P)((()=>{const e=(0,s.useContext)(o);if(!e)throw new Error("useEntitiesStore must be used within a StoreProvider");return e})(),(t=>t[e]))},296181:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Pravopis","IsImplemented":true}}')},296205:(e,t,i)=>{if(i.d(t,{I:()=>c}),0!=i.j)var n=i(96668);if(0!=i.j)var s=i(251439);if(0!=i.j)var o=i(184226);if(0!=i.j)var r=i(386675);if(0!=i.j)var a=i(383490);if(0!=i.j)var l=i(487368);if(0!=i.j)var d=i(15142);class c{constructor(){this.imports=[n.J,l.R]}get uniqueId(){return(0,s.z)(507918214)}configureRootServices(e){e.bind(o.iw).to(d.V),e.bind(r.S).to(a.z)}}},296690:(e,t,i)=>{var n;i.d(t,{g:()=>s}),function(e){e[e.Start=0]="Start",e[e.End=1]="End"}(n||(n={}));class s{constructor(e,t){this._textRetrieverFactory=e,this._indexReadjuster=t,this.findOffsetPositions=async(e,t,i=!1,s)=>{const o=new Map;let r=0;t.sort(((e,t)=>e.index-t.index));const a=this.getTargetDocument(e).createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let l,d=0;if(l=void 0!==s?s:this._textRetrieverFactory(e).retrieve().content,t[0]&&t[0].index<0||t[t.length-1]&&t[t.length-1].index>l.length)return o;const c=await this._indexReadjuster.getReadjustedIndices(e,t,l);let u;for(;a.nextNode();){const e=a.currentNode,s=r,l=e.textContent?e.textContent.length:0,g=s+l;for(let r=d;r<t.length;r+=1){const a=c[r];if(a.indexType===n.Start&&a.index>=s&&(i?a.index<=g:a.index<g))d+=1,o.set(t[r].startIndex,{startNode:e,startOffset:a.index-s});else{if(!(a.indexType===n.End&&a.index>=s&&a.index<=g))break;{d+=1;const i=o.get(t[r].startIndex);if(!i)throw new Error("The critique's end index has no conforming start index.");i.endNode=e,i.endOffset=a.index-s,o.set(t[r].startIndex,i)}}}if(r+=l,l>0&&(u=e),d===t.length)break}if(d!==t.length)if(u){const e=r-(u.textContent?u.textContent.length:0);for(let i=d;i<t.length;i+=1){const s=c[i];if(s.indexType===n.Start&&s.index===r)d+=1,o.set(t[i].startIndex,{startNode:u,startOffset:s.index-e});else{if(s.indexType!==n.End||s.index!==r)break;{d+=1;const n=o.get(t[i].startIndex);if(!n)throw new Error("The critique's end index has no conforming start index.");n.endNode=u,n.endOffset=s.index-e,o.set(t[i].startIndex,n)}}}}else for(let i=d;i<t.length;i+=1){const s=c[i];if(s.indexType===n.Start&&0===s.index)o.set(t[i].startIndex,{startNode:e,startOffset:0});else{if(s.indexType!==n.End||0!==s.index)break;{const n=o.get(t[i].startIndex);if(!n)throw new Error("The critique's end index has no conforming start index.");n.endNode=e,n.endOffset=0,o.set(t[i].startIndex,n)}}}return o},this.createRange=(e,t)=>{if(!(null==t?void 0:t.endNode)||void 0===t.endOffset)return;const i=e.createRange();return i.setStart(t.startNode,t.startOffset),i.setEnd(t.endNode,t.endOffset),i},this.getTargetDocument=e=>{var t;return null!==(t=e.ownerDocument)&&void 0!==t?t:document}}async dispose(){var e,t;null===(t=(e=this._indexReadjuster).shutDown)||void 0===t||t.call(e)}async getCritiqueRanges(e,t){const i=[];for(const e of t)i.push({index:e.start,indexType:n.Start,startIndex:e.start}),i.push({index:e.start+e.length,indexType:n.End,startIndex:e.start});const s=await this.findOffsetPositions(e,i),o=this.getTargetDocument(e);return t.map((e=>{const t=s.get(e.start);return{critique:e,range:this.createRange(o,t)}}))}async getRangeOfNode(e,t,i,s){const o=[];o.push({index:t,indexType:n.Start,startIndex:t}),o.push({index:t+i,indexType:n.End,startIndex:t});const r=await this.findOffsetPositions(e,o,!1,s),a=this.getTargetDocument(e);return this.createRange(a,r.get(t))}async getNodeInsertionPosition(e,t,i){const s=[];s.push({index:t,indexType:n.Start,startIndex:t}),s.push({index:t,indexType:n.End,startIndex:t});const o=await this.findOffsetPositions(e,s,i),r=this.getTargetDocument(e);return this.createRange(r,o.get(t))}includePrecedingSpace(e,t){let i;if(t.startOffset>=0&&t.startContainer.textContent&&" "===t.startContainer.textContent.charAt(t.startOffset-1))i={startNode:t.startContainer,startOffset:t.startOffset-1};else if(0===t.startOffset){const n=this.getTargetDocument(e).createTreeWalker(e,NodeFilter.SHOW_TEXT,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});for(n.currentNode=t.startContainer;n.previousNode();){const e=n.currentNode;if(e.nodeType===e.TEXT_NODE&&e.textContent&&e.textContent.length>0){e.textContent.endsWith(" ")&&(i={startNode:e,startOffset:e.textContent.length-1});break}}}return i&&t.setStart(i.startNode,i.startOffset),t}}},298070:(e,t,i)=>{if(i.d(t,{EM:()=>o,Hs:()=>r,Tm:()=>s}),0!=i.j)var n=i(927154);const s=(e,t)=>({name:e,storeEntryType:n._.Remote,defaultValue:t,lastValueFromStorage:void 0}),o=(e,t,i)=>({name:e,storeEntryType:n._.User,defaultValue:t,lastValueFromStorage:void 0,shouldNotWriteDefaultValue:i});var r;!function(e){e.FeatureFlags="featureFlags",e.DynamicSettings="dynamicSettings"}(r||(r={}))},298770:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Àyẹ̀wò Ẹyọ Ọ̀rọ̀","IsImplemented":true}}')},301062:(e,t,i)=>{if(i.d(t,{Hz:()=>s}),0!=i.j)var n=i(12163);function s(e){var t;return[(0,n.m9)("App.Name",e.appName),(0,n.m9)("App.Platform",e.appPlatform),(0,n.m9)("App.Scenario",e.appScenario),(0,n.m9)("Copilot.Scenario",e.isCopilotScenario),(0,n.m9)("Session.Id",e.sessionId),(0,n.m9)("User.PrimaryIdentityHash",e.userId),...void 0!==e.userType?[(0,n.m9)("User.Type",e.userType)]:[],(0,n.m9)("Release.AudienceGroup",e.releaseAudienceGroup),(0,n.m9)("App.Version",e.clientVersion),(0,n.m9)("Tenant.Id",e.tenantId),(0,n.m9)("User.IdentityProvider",e.identityProvider),(0,n.m9)("App.CiqVersion",null!==(t=e.ciqPackageVersion)&&void 0!==t?t:"")]}},302198:(e,t,i)=>{if(i.d(t,{H:()=>m}),0!=i.j)var n=i(489282);if(0!=i.j)var s=i(439550);if(0!=i.j)var o=i(742035);if(0!=i.j)var r=i(251439);if(0!=i.j)var a=i(386675);if(0!=i.j)var l=i(691474);if(0!=i.j)var d=i(838630);if(0!=i.j)var c=i(689878);if(0!=i.j)var u=i(69654);if(0!=i.j)var g=i(117996);if(0!=i.j)var h=i(632153);if(0!=i.j)var p=i(694069);class m{constructor(){this.imports=[]}get uniqueId(){return(0,r.z)(507918231)}configureRootServices(e){e.bind(o.c).to(n.tx),e.bind(a.S).toExisting(o.c),e.bind(d.A).to(h.t),e.bind(c.a).to(p.r),e.bind(s.D).to(u.h),e.bind(a.S).toExisting(s.D),e.bind(l.E).to(g.G),e.bind(a.S).toExisting(l.E)}}},302246:(e,t,i)=>{i.d(t,{B:()=>n});const n=(0,i(668952).f)("IWordCountDetector")},303043:(e,t,i)=>{i.d(t,{b:()=>g});var n=i(252723),s=i(108520),o=i(163573),r=i(243879),a=i(184226);if(0!=i.j)var l=i(11653);if(0!=i.j)var d=i(62876);var c=i(208520);const u=(0,n.F5)({hostSettings:s.A.on(o.n),inlineSuggestionsRenderer:s.A.on(r.V),languageScriptDirectionDetector:s.A.on(a.iw).optional()}),g=()=>{var e,t,i,s,o;const{hostSettings:r,inlineSuggestionsRenderer:a,languageScriptDirectionDetector:g}=(0,n.KN)(u),[h,p]=c.useState(null!==(e=a.getCalloutStateStore().getCalloutState())&&void 0!==e?e:null);return c.useEffect((()=>{const e=a.getCalloutStateStore(),t=()=>{var t;p(null!==(t=e.getCalloutState())&&void 0!==t?t:null)};return e.subscribe("menuUpdated",t),()=>{e.unsubscribe("menuUpdated",t)}}),[a]),(null==h?void 0:h.targetLocation)?c.createElement(d.b.Provider,{value:!!r.useUiCoherence},c.createElement(l.$,Object.assign({},h,{isRtl:null!==(t=null==g?void 0:g.isRtl())&&void 0!==t&&t,isMobile:null!==(o=null===(s=null===(i=r.oaSettings)||void 0===i?void 0:i.enableECCForMobileDevice)||void 0===s?void 0:s.enabled)&&void 0!==o&&o}))):null}},303170:(e,t,i)=>{i.d(t,{F:()=>u});var n=i(379490),s=i(329423),o=i(279e3),r=i(206264),a=i(281795),l=i(229906),d=i(83010),c=i(427603);let u=class{constructor(e,t,i){this._critiqueStore=e,this._critiqueFilterer=t,this._indicatorStore=i}onEvent(e){var t;const i=this._critiqueStore.getAllCritiques();null===(t=this._indicatorStore)||void 0===t||t.clearPaneCritiques();for(const e of i){const t=this._critiqueFilterer.applyFilters(Array.from(e.critiques.values())).map((e=>({critique:e,critiqueDiffType:s.K.Update})));t.length>0&&this._critiqueStore.updateNode(t,e.tileId,e.tileVersion)}}};u=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(o.$)),(0,n.__param)(1,(0,d.W)(r.B)),(0,n.__param)(2,(0,c.l)()),(0,n.__param)(2,(0,d.W)(a.y))],u)},303610:(e,t,i)=>{i.d(t,{k:()=>o,p:()=>s});var n=i(668952);const s=(0,n.f)("IContainer"),o=(0,n.f)("IResolveNew")},304274:(e,t,i)=>{i.d(t,{e:()=>o});var n,s=i(668952);!function(e){e.StorageUserInfoV2Strategy="StorageUserInfoV2Strategy",e.None="None"}(n||(n={}));const o=(0,s.f)("IUserInfoStrategy")},305507:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(668952).f)("IMultilingualFreStore")},306555:(e,t,i)=>{i.d(t,{S:()=>D});var n=i(379490),s=i(433858),o=i(279e3),r=i(206264),a=i(438343),l=i(643513),d=i(877931),c=i(163573),u=i(825948),g=i(818955),h=i(494888),p=i(272512),m=i(1144),f=i(538045),v=i(157698);class y{get id(){return this.paragraphNode.id}get range(){var e,t,i,n,s,o,r;return{offset:null!==(t=null===(e=this.paragraphNode.element)||void 0===e?void 0:e.offset)&&void 0!==t?t:0,span:null!==(n=null===(i=this.paragraphNode.element)||void 0===i?void 0:i.span)&&void 0!==n?n:0,textUnit:null===(s=this.paragraphNode.element)||void 0===s?void 0:s.textUnit,validEndBoundary:null===(o=this.paragraphNode.element)||void 0===o?void 0:o.validEndBoundary,enforcedCompleteTileTextUnit:null===(r=this.paragraphNode.element)||void 0===r?void 0:r.enforcedCompleteTileTextUnit}}constructor(e){this.paragraphNode=e}}var _=i(700509),I=i(766535),C=i(909113),S=i(659175),b=i(86439);class T{constructor(e={enablePhraseTextUnitClientSide:!0,ignoreNonLatinZeroSquiggles:!0,enableSquigglesOnlyOnWholeWords:!0}){this.settings=e}isValid(e,t,i,n,s){var o,r,a,l;if(!e.nodeId||!t)return!1;const d=new S.a;if(this.settings.enablePhraseTextUnitClientSide&&e.priority!==I.bx.High&&!(0,I.oe)(e.typeId)&&t.range.textUnit!==_.fT.Sentence&&t.range.textUnit!==_.fT.Paragraph)return!1;if(this.settings.ignoreNonLatinZeroSquiggles&&(!e.suggestions.length||0===e.suggestions[0].action)&&(0,b.c)(e.textInContext))return!1;null==s||s(e);let c=e.textInContext;c&&(c=c.replace(/\u00A0/g," "));const u=t.range.offset,g=n(e);if(c!==g)return!1;if((e.priority===I.bx.High||e.priority===I.bx.Informational)&&(void 0===e.endNode||e.endNode.nodeId===t.id)&&this.settings.enableSquigglesOnlyOnWholeWords){const t=i;if(!t)return!1;const n=e.start-u,s=n+e.length,c=s===t.length;let[h,p]=function(e,t,i,n,s){if(!e)return["",0];let o=0;(t===n||t+1===n&&C.Yv(e.charCodeAt(t+1)))&&(o+=1);i===s&&(o+=1);return[e.substring(t,i),o]}(t,null!==(r=null===(o=d.getBackwardBreak(t,n+1))||void 0===o?void 0:o.cp)&&void 0!==r?r:0,null!==(l=null===(a=d.getForwardBreak(t,s-1))||void 0===a?void 0:a.cp)&&void 0!==l?l:s,n,s);if(g&&!c&&"￼"===g[g.length-1]&&(p+=1),C._1(h))return!0;if(C.tF(h))return!0;return p===2}return!0}}var E=i(329423);function N(e,t){var i;const n=e?t.findParagraphNode(e):null;return{paragraphNode:n,htmlElement:null===(i=null==n?void 0:n.parent)||void 0===i?void 0:i.element}}var w=i(229906),x=i(83010),L=i(427603);let D=class{constructor(e,t,i,n,s,o,r,a,l,d,c){this._critiqueStore=e,this._critiqueFilterer=t,this._logger=i,this._hostSettings=n,this._proofingPersistedStore=s,this._userInfoStrategy=o,this._e2eMetric=r,this._featureFlagReader=a,this._proofingDom=l,this._paragraphTextExtractor=d,this._autoCorrectionBroker=c,this._websiteProvedOnce=!1}onEvent(e){var t,i;const{added:n,removedIds:o,source:r,tileId:a,tileVersion:l}=e,{paragraphNode:d}=N(a,this._proofingDom),c=null!==(i=null===(t=null==d?void 0:d.parent)||void 0===t?void 0:t.id)&&void 0!==i?i:a,u=this.onCommonCritiquesRemoved(o,r),g=n.filter((e=>{const t=u.findIndex((t=>(0,s.gS)(e,t.critique)));return!(t>=0)||(u.splice(t,1),!1)}));u.push(...this.onCommonCritiquesAdded(g,a)),u.length>0&&this._critiqueStore.updateNode(u,c,l),this._e2eMetric.commitEntry(`${a}--${l}`)}logWebsiteProvedOnce(){this._websiteProvedOnce||(this._websiteProvedOnce=!0,(0,p.Q)(this._logger,this._proofingPersistedStore,this._hostSettings,this._userInfoStrategy))}onCommonCritiquesAdded(e,t){var i,n;if(0===e.length)return[];const{paragraphNode:o}=N(t,this._proofingDom),r=null!==(n=null===(i=null==o?void 0:o.parent)||void 0===i?void 0:i.id)&&void 0!==n?n:t,a=new T({enablePhraseTextUnitClientSide:this._featureFlagReader.flags.enablePhraseTextUnitClientSide,ignoreNonLatinZeroSquiggles:!!this._hostSettings.ignoreNonLatinZeroSquiggles,enableSquigglesOnlyOnWholeWords:this._featureFlagReader.flags.enableSquigglesOnlyOnWholeWords}),l=this._paragraphTextExtractor.getParagraphText(o),d=function(e,t,i,n,o,r,a,l,d,c,u){if(0===e.length)return[];const g=a.getCritiques(i);if(!g)return[];const h=new Map,p=new Set;for(const e of g.critiques)d(e)&&h.set(e.start,e);const m=[];for(const i of e)if(i&&u.isValid(i,t,n,o,l)){const e=h.get(i.start);if(e&&(0,s.gS)(e,i)){e.annotationId=i.annotationId,m.push({critique:e,critiqueDiffType:E.K.Update}),p.add(i.start);continue}if(!r)for(const e of h.values())(0,s.tw)(e,i)&&m.push({critique:e,critiqueDiffType:E.K.Delete});c.applyFilters([i]),m.push({critique:i,critiqueDiffType:E.K.Add})}if(r)for(const e of h.values())p.has(e.start)||m.push({critique:e,critiqueDiffType:E.K.Delete});return m}(e,null===o?null:new y(o),r,l,(e=>{var t,i;const n=null!==(i=null===(t=null==o?void 0:o.element)||void 0===t?void 0:t.offset)&&void 0!==i?i:0;let s="";return s=void 0===e.endNode?this._paragraphTextExtractor.getTextBetween(o,o,e.start-n,e.start-n+e.length):this._paragraphTextExtractor.getTextBetween(o,e.endNode.nodeId,e.start-n,e.endNode.end),s}),this._featureFlagReader.flags.enableForceClearCritiques,this._critiqueStore,(e=>{(0,m.l)(o)&&(e.start=e.start+o.element.offset)}),(e=>((e,t)=>!!(0,m.l)(t)&&e.nodeId!==t.id&&!(e.start>=t.element.offset+t.element.span||t.element.offset>=e.start+e.length))(e,o)),this._critiqueFilterer,a);return d.length>0&&this.logWebsiteProvedOnce(),d}onCommonCritiquesRemoved(e,t){return function(e,t,i,n){if(0===e.length)return[];const s=i.getAllCritiques().reduce(((e,t)=>{for(const i of t.critiques)e.set(i.annotationId,{critique:i,tileId:t.tileId,tileVersion:t.tileVersion});return e}),new Map),o=[];for(const i of e){const e=s.get(i);if(e){if("Augloop"===t&&(null==n?void 0:n.getHasAutoCorrectionBeenApplied(e.critique)))continue;o.push({critique:e.critique,critiqueDiffType:E.K.Delete})}}return o}(e,t,this._critiqueStore,this._autoCorrectionBroker)}};D=(0,n.__decorate)([(0,w._)(),(0,n.__param)(0,(0,x.W)(o.$)),(0,n.__param)(1,(0,x.W)(r.B)),(0,n.__param)(2,(0,x.W)(d.g)),(0,n.__param)(3,(0,x.W)(c.n)),(0,n.__param)(4,(0,x.W)(u.K)),(0,n.__param)(5,(0,x.W)(g.e)),(0,n.__param)(6,(0,x.W)(l.m)),(0,n.__param)(7,(0,x.W)(h.c)),(0,n.__param)(8,(0,x.W)(f.w)),(0,n.__param)(9,(0,x.W)(v.b)),(0,n.__param)(10,(0,L.l)()),(0,n.__param)(10,(0,x.W)(a.m))],D)},310475:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"वर्णरचना"}}')},318391:(e,t,i)=>{i.d(t,{v:()=>p});var n=i(252723),s=i(108520),o=i(163573),r=i(184226),a=i(615930),l=i(363983),d=i(98521),c=i(579990),u=i(950266),g=i(208520);const h=(0,n.F5)({languageScriptDirectionDetector:s.A.on(r.iw).optional(),hostSettings:s.A.on(o.n).optional(),targetWindow:s.A.on(a.sh).optional()}),p=g.forwardRef(((e,t)=>{var i,s,o,r;const{hostSettings:a,languageScriptDirectionDetector:p,targetWindow:m}=(0,n.SM)(h),f=g.useRef(null),v=(null===(i=e.popover)||void 0===i?void 0:i.positioning).target;return g.useImperativeHandle(t,(()=>({getElementRef:()=>f}))),g.useEffect((()=>{var t;return null===(t=null==a?void 0:a.onCalloutOpened)||void 0===t||t.call(a,null,v,void 0),e.moveFocusIntoModalizer&&setTimeout((()=>{var e,t,i,n;const s=(0,u.OT)(null!==(e=null==m?void 0:m.deref())&&void 0!==e?e:window),o=f.current?null===(n=null===(i=null===(t=null==s?void 0:s.core)||void 0===t?void 0:t.storageEntry)||void 0===i?void 0:i.call(t,f.current))||void 0===n?void 0:n.tabster:void 0;if(!s||!(null==o?void 0:o.modalizer))return;(0,u.Az)(s).setActive(o.modalizer)}),0),()=>{var e;null===(e=null==a?void 0:a.onCalloutClosed)||void 0===e||e.call(a,null,v,void 0)}}),[a,e.moveFocusIntoModalizer,v]),g.createElement(l.A,Object.assign({},e.popover),g.createElement(d.H,Object.assign({},e.surface,{ref:f,dir:null==p?void 0:p.dir(),role:null===(s=e.popover)||void 0===s?void 0:s.ariaRole,"aria-label":null===(o=e.popover)||void 0===o?void 0:o.ariaLabel,"aria-labelledby":null===(r=e.popover)||void 0===r?void 0:r.ariaLabelledBy}),void 0===p?e.children:g.createElement(c.K,{rtl:p.isRtl()},e.children)))}))},319968:(e,t,i)=>{i.d(t,{V:()=>c});var n=i(379490),s=i(590974),o=i(123739),r=i(229906),a=i(66008),l=i(83010),d=i(562093);let c=class{constructor(e,t){this._transports=e,this._activityTransport=t,this.logDiagnostics=(e,t,i,n)=>{this.baseLogger.logDiagnostics(e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.baseLogger.logActivity(e,t,i,n)},this.baseLogger=new d.q(e,t)}async initialize(e,t,i,n,s,o,r){await this.baseLogger.initialize(e,t,i,n,s,o,r)}config({transports:e,activityTransport:t}){return this.baseLogger.config({transports:e,activityTransport:t})}addCorrelationID(e){this.baseLogger.addCorrelationID(e)}log(e,t,i,n){this.baseLogger.log(e,t,i,n)}info(e,t,i){this.baseLogger.info(e,t,i)}warn(e,t,i){this.baseLogger.warn(e,t,i)}error(e,t,i){this.baseLogger.error(e,t,i)}debug(e,t,i){this.baseLogger.debug(e,t,i)}logServiceRequest(e,t,i,n,s){this.baseLogger.logServiceRequest(e,t,i,n,s)}logEvent(e,t,i,n,s,o,r){this.baseLogger.logEvent(e,t,i,n,s,o,r)}getNewActivity(e,t,i){return this.baseLogger.getNewActivity(e,t,i)}dispose(){this.baseLogger.dispose()}};c=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.t)(s.l)),(0,n.__param)(1,(0,l.W)(o.C))],c)},321889:(e,t,i)=>{i.d(t,{iO:()=>w,lJ:()=>N});var n=i(379490),s=i(551134),o=i(67573),r=i(823325),a=i(537969),l=i(756857),d=i(279e3),c=i(937126),u=i(826663),g=i(392632),h=i(331408),p=i(163573),m=i(877931),f=i(856697),v=i(576516),y=i(538045),_=i(955377),I=i(965285),C=i(229906),S=i(66008),b=i(83010),T=i(427603),E=i(710266);let N=class extends I.H{constructor(e,t,i,n,s,a,l,d,c){super(e,t,i,n,a,l,d,c),this._localizer=s,this.onFlagAnnotationUpdate=e=>{var t,i;const n=e.message.messageType,s=e.message.data;if(n===r.G.NewData&&s.results.length>0){const i=[];for(const e of s.results){if(!f.uH.typeGuard(e))continue;if(1!==e.results.length||e.results[0].entityType!==v.c.DateTime||!w(this._hostSettings))continue;const n=e.results[0].subType,r=e.results[0].text;let a,l;try{const e=JSON.parse(r);e.start&&e.end&&("DateRange"===n?(a=x(e.start).getTime(),l=x(e.end).getTime()):(a=Date.parse(e.start),l=Date.parse(e.end)))}catch(e){}a||l||!Date.parse(r)||(a="Date"===n?x(r).getTime():Date.parse(r),l=a);const d=[{entities:[{entityType:v.c.DateTime,text:this.getTextForEntity(n),icon:{iconName:L()},confidence:e.modelMetadata.score,startDateTime:null==a?void 0:a.toString(),endDateTime:null==l?void 0:l.toString(),subType:n}],entityType:v.c.DateTime,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle")}];let c;switch(n){case"Date":c=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTooltipTitle");break;case"Datetime":case"DateTime":c=this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeTooltipTitle");break;case"DateRange":c=this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeTooltipTitle");break;case"Time":c=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeTooltipTitle");break;case"TimeRange":c=this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeTooltipTitle")}const u=s.tileId+e.id;i.push({annotationId:u,traceId:u,languageId:this._hostSettings.defaultLocale,nodeId:s.tileId,nodeVersion:s.tileVersion,textInContext:null!==(t=e.context)&&void 0!==t?t:"",start:e.range.start,length:e.range.length,supportedActions:o.lb.Ignore,supportedEntityTypes:[v.c.DateTime],suggestionItems:d,additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:c,categoryTitle:this._localizer.getMessage("ebx_DateEntityRecognitionCategoryTitle")})}this.addFlags(e.address,i)}else if(n===r.G.RemoveData){const t=null===(i=this._annotationIdMap)||void 0===i?void 0:i.get(s.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,s.annotationId)}},this.getTextForEntity=e=>{switch(e){case"Date":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateLabel");case"Datetime":case"DateTime":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateTimeLabel");case"DateRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertDateRangeLabel");case"Time":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeLabel");case"TimeRange":return this._localizer.getMessage("ebx_EntityRecognitionInsertTimeRangeLabel");default:return""}},this.onApplyFlag=(e,t,i,n)=>{var s,o;if(!t.annotationId)return;this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(a.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return h.L9.CIQFlag_DateEntityRecognition}};function w(e){var t,i;return(0,g.i$)(null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,v.c.DateTime)}function x(e){const t=e.split(/\D+/).map((e=>parseInt(e,10)));return t[1]=t[1]-1,new Date(t[0],t[1],t[2])}function L(){const e="DateFlag";return(0,E.Z)(e,{regular:s.lHS,filled:s.ThD}),e}N=(0,n.__decorate)([(0,C._)(),(0,n.__param)(0,(0,S.t)(a.zJ)),(0,n.__param)(1,(0,b.W)(p.n)),(0,n.__param)(2,(0,b.W)(y.w)),(0,n.__param)(3,(0,b.W)(m.g)),(0,n.__param)(4,(0,b.W)(l.H)),(0,n.__param)(5,(0,b.W)(d.$)),(0,n.__param)(6,(0,b.W)(_.W)),(0,n.__param)(6,(0,T.l)()),(0,n.__param)(7,(0,b.W)(c.f)),(0,n.__param)(8,(0,T.l)()),(0,n.__param)(8,(0,b.W)(u.K))],N)},322483:(e,t,i)=>{i.d(t,{t:()=>o});var n=i(208520),s=i(760995);class o extends n.Component{constructor(e){super(e),this.retryTimer=0,this.labelErrorStyle={display:"none"},this.tryRecover=()=>{var e;this.props.maxRecoveryRetry>(this.state.retryNumber||0)&&(window.clearTimeout(this.retryTimer),this.retryTimer=window.setTimeout((()=>{var e;const t=(null!==(e=this.state.retryNumber)&&void 0!==e?e:0)+1;this.setState({hasError:!1,retryNumber:t})}),1e3*(null!==(e=this.state.retryNumber)&&void 0!==e?e:1)))},this.state={hasError:!1,retryNumber:0}}static getDerivedStateFromError(e){return{hasError:!0}}componentDidCatch(e,t){var i;const{logger:n,errorEventName:o,errorMessage:r}=this.props;s.R.logUnhandledError(n,{error:e,errorInfo:t,retryCount:null!==(i=this.state.retryNumber)&&void 0!==i?i:0},o,r)}componentWillUnmount(){window.clearTimeout(this.retryTimer)}componentDidUpdate(){this.state.hasError&&this.tryRecover()}render(){return this.state.hasError?n.createElement("div",{"aria-hidden":"true",style:this.labelErrorStyle,className:"ms-editor-rendering-error"},`${this.state.retryNumber}/${this.props.maxRecoveryRetry}`):this.props.children}}},323283:(e,t,i)=>{if(i.d(t,{J:()=>s}),0!=i.j)var n=i(829088);class s{constructor(e){this.listeners={},this.captureListeners={},this.element=(0,n.E)(e)?e:new n.O(e)}addListener(e,t,i){const n=this.element.deref();if(n){if(null==i?void 0:i.capture){if(e in this.captureListeners)throw new Error(`Event ${e} previously registered.`);this.captureListeners[e]=t}else{if(e in this.listeners)throw new Error(`Event ${e} previously registered.`);this.listeners[e]=t}n.addEventListener(e,t,i)}}removeListener(e,t){const i=this.element.deref();i&&((null==t?void 0:t.capture)?e in this.captureListeners&&(i.removeEventListener(e,this.captureListeners[e],t),delete this.captureListeners[e]):e in this.listeners&&(i.removeEventListener(e,this.listeners[e]),delete this.listeners[e]))}removeAllListeners(){for(const e of Object.keys(this.listeners))this.removeListener(e);this.listeners={};for(const e of Object.keys(this.captureListeners))this.removeListener(e,{capture:!0});this.captureListeners={}}}},324373:(e,t,i)=>{if(i.d(t,{b:()=>l}),0!=i.j)var n=i(246429);if(0!=i.j)var s=i(294890);if(0!=i.j)var o=i(177822);if(0!=i.j)var r=i(923277);if(0!=i.j)var a=i(251439);class l{constructor(){this.imports=[n.u,r.r,s.v,o.J]}get uniqueId(){return(0,a.z)(507918295)}configureRootServices(e){}}},326323:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(668952).f)("ITimer")},326647:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(189784),s=i(688557),o=i(627937),r=i(208520);const a=r.memo((e=>{var t,i;const{prediction:a,parentElement:l}=e,d=parseInt(window.getComputedStyle(l).fontSize,10),c=null!==(i=null===(t=a.entityResults.entities[0].FileExtension)||void 0===t?void 0:t.toLocaleLowerCase())&&void 0!==i?i:"",u=Object.prototype.hasOwnProperty.call(o.L,c)?o.L[c].iconType:"Cloud";return r.createElement(n.I,Object.assign({},e,{showDropdownChevron:a.entityResults.entities.length>1}),r.createElement(s.I,{type:u,style:{width:d,height:d},fontSize:d}))}))},329160:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"हिज्जे","IsImplemented":true}}')},329423:(e,t,i)=>{var n;i.d(t,{K:()=>n}),function(e){e[e.Add=0]="Add",e[e.Move=1]="Move",e[e.Update=2]="Update",e[e.Delete=4]="Delete"}(n||(n={}))},331408:(e,t,i)=>{var n,s,o;function r(e){return e?Object.values(s).find((t=>t===e)):void 0}i.d(t,{$w:()=>o,L9:()=>s,bx:()=>n,e3:()=>r}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(n||(n={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec",e.TopicSuggestion="9bf58f9f-4159-40a1-80b8-4fe1f87c010d",e.CIQFlag_Location="1d456e3c-f436-4b8f-a315-1cc430bc2ee1",e.CIQFlag_LocalBusiness="1ECDDA98-C954-9863-87BD-4B0F493558FB",e.CIQFlag_PersonEntityRecognition="ffa21afe-fab3-423c-b579-8de8-128429f1cc8e",e.CIQFlag_DateEntityRecognition="349483fb-b654-4b4c-aefe-9f22bf147cd7",e.CIQFlag_TaskRecognition="c45ba192-bfae-4965-a833-694b55b1bd1d",e.CIQFlag_Topic="21422617-6650-456a-97cd-a7cd3116c39c",e.HeadingDetection="37e3346c-be6a-462c-afd7-282da13f6328",e.CIQFlag_SatoriEntityRecognition="9d9ccfb3-598c-e24c-3cda-11d260ae57d3",e.CIQFlag_File="17f49c82-b9f8-42d0-ab4e-dc076355d77a",e.CIQFlag_Time="9bd06192-906b-4693-99d3-7d58a1cf1770",e.Synonyms="23bd41d4-28ac-4cbc-ba24-2bba684c07da",e.DoubleSpaceGrammar="6d1d8c3d-62d5-45d1-b850-d8a98a24964b"}(s||(s={})),function(e){e.IgnoreOnce="IgnoreOnce",e.IgnoreAll="IgnoreAll",e.ApplySuggestion="ApplySuggestion",e.DisableCritiqueType="DisableCritiqueType",e.ShowFeedback="ShowFeedback"}(o||(o={}))},331929:(e,t,i)=>{i.d(t,{f:()=>o});var n=i(379490),s=i(229906);let o=class{get tooltip(){return{tooltipMain:{background:"window",boxShadow:"none",border:"1px solid windowframe"},title:{color:"windowtext"},text:{color:"windowtext"}}}};o=(0,n.__decorate)([(0,s._)()],o)},332688:(e,t,i)=>{if(i.d(t,{FZ:()=>m,TQ:()=>p,ci:()=>c,cu:()=>v,j:()=>g,jt:()=>h,vb:()=>u,zo:()=>f}),0!=i.j)var n=i(863307);if(0!=i.j)var s=i(647879);if(0!=i.j)var o=i(590413);if(0!=i.j)var r=i(62049);var a=i(208520);if(0!=i.j)var l=i(296048);if(0!=i.j)var d=i(120733);const c=(e,t,i,r="",a=void 0)=>{const l=(0,n._v)(),d=(0,s.W)(["TabId",e],["ConversationId",t],["LogicalId",i],["ClientCorrelationId",r],["ScopedEntityType",(0,o.Hw)(a)]);l.logActivity("CiqSuggestionsCardTabChange",void 0,d)},u=(e,t,i,r="",a=void 0)=>{const l=(0,n._v)(),d=(0,s.W)(["Interaction",e],["ConversationId",t],["LogicalId",i],["ClientCorrelationId",r],["ScopedEntityType",(0,o.Hw)(a)]);l.logActivity("CiqSuggestionsCardAction",void 0,d)},g=(e,t,i,r,a="",l=void 0)=>{const d=(0,n._v)(),c=(0,s.W)(["SearchType",e],["SearchQueryLength",t],["ConversationId",i],["LogicalId",r],["ClientCorrelationId",a],["ScopedEntityType",(0,o.Hw)(l)]);d.logActivity("CiqSuggestionsCardSearch",void 0,c)},h=(e,t)=>{const{conversationId:i,additionalData:o,logicalId:r}=e,{clientCorrelationId:a=""}=o||{},l=(0,n._v)(),d=(0,s.W)(["ConversationId",i],["LogicalId",r],["ClientCorrelationId",a],["UploadSource",t]);l.logActivity("CiqUploadFileMenuButtonClicked",void 0,d)},p=({type:e,details:t},i,a,l,d="",c=void 0,u,g)=>{const h=(0,n._v)(),p=(0,r.gu)(t)?t.fileExtension:"",m=(0,s.W)(["EntityType",e],["ConversationId",i],["SelectedTab",l],["LogicalId",a],["ClientCorrelationId",d],["ScopedEntityType",(0,o.Hw)(c)],["FileExtension",(0,o.Hw)(p)],["TriggerKey",(0,o.Hw)(u)],["QueryLength",g]);h.logActivity("CiqSuggestionsCardSuggestionKept",void 0,m)},m=e=>{const t=(0,l.b)("suggestionEntityGroup"),i=(0,l.b)("state"),{triggerKey:r,conversationId:c,logicalId:u,additionalData:g}=(0,d.E)("requestEntitiesParams"),{clientCorrelationId:h,scopeInfo:p}=g||{};(0,a.useEffect)((()=>{((e,t,i,r,a,l,d="",c)=>{const u=JSON.stringify((e=>e.reduce(((e,{groupType:t,entities:i})=>("All"===t||"Recent"===t||(t in e||(e[t]=0),e[t]+=i.length),e)),{}))(e)),g=(0,n._v)(),h=(0,s.W)(["TotalEntitySuggestionsDisplayed",e.length],["CurrentState",t],["EntitySuggestionsPerTypeDisplayed",u],["TriggerKey",i],["ConversationId",r],["LogicalId",a],["QueryLength",l],["ClientCorrelationId",d],["ScopedEntityType",(0,o.Hw)(c)]);g.logActivity("CiqSuggestionsCardSeen",void 0,h)})(t,i,r,c,u,e,h,null==p?void 0:p.entityType)}),[t])},f=()=>{const e=(0,d.E)("activeTab"),{conversationId:t,logicalId:i,additionalData:r}=(0,d.E)("requestEntitiesParams"),{clientCorrelationId:l,scopeInfo:c}=r||{};(0,a.useEffect)((()=>{((e,t,i,r="",a)=>{const l=(0,n._v)(),d=(0,s.W)(["TabId",e],["ConversationId",t],["LogicalId",i],["ClientCorrelationId",r],["ScopedEntityType",(0,o.Hw)(a)]);l.logActivity("CiqSuggestionsCardInitialTab",void 0,d)})(e,t,i,l,null==c?void 0:c.entityType)}),[])},v=(e,t)=>{const{conversationId:i,logicalId:n,additionalData:s}=(0,d.E)("requestEntitiesParams"),{clientCorrelationId:o,scopeInfo:r}=s||{};(0,a.useEffect)((()=>{t&&g(e,t.length,i,n,o,null==r?void 0:r.entityType)}),[o,i,n,t,e,null==r?void 0:r.entityType])}},332796:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":""},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":false,"LocalizedName":""},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":false},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Črkovanje"},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},333539:(e,t,i)=>{i.d(t,{j:()=>v});var n=i(863307),s=i(93469),o=i(56745),r=i(960118);class a{constructor(){this.intentCache=Array.from({length:r.U},(()=>new Map))}getIntents(e){const t=(0,r.f)(e),i=t.split(" ").length,n=this.intentCache[i-1].get(t);return(0,o.kj)(t,n),n||[]}addToCache(e){const t=(0,r.f)(e.request.text),i=t.split(" ").length;this.intentCache[i-1].set(t,e.intents),(0,o.AJ)(e,t);(0,n._v)().debug(505246799,"Added to intent cache",{textStats:(0,s.ZX)(t),intentCount:e.intents.length,requestId:e.request.requestId})}}var l=i(168492);async function d({request:e,sources:t,onIntentDetected:i,rankIntents:s},o=!0){const r=new Map,a=[];for(const l of t)try{const t=Object.assign(Object.assign({},e),{detectedIntents:[...a]}),n=await l.detectIntent(t);a.push(...n.intents),r.set(l,n),!o&&n.intents.length>0&&i(s({request:e,sourceResponseMap:r}))}catch(e){(0,n._v)().warn(0,`Intent detection failed for source ${l}:`,e)}o&&i(s({request:e,sourceResponseMap:r}))}async function c({request:e,sources:t,onIntentDetected:i,rankIntents:s},o=!0){const r=t.map((t=>({source:t,promise:t.detectIntent(e)}))),a=new Map,d=(await(0,l.sG)(r.map((async t=>{const n=await t.promise;return a.set(t.source,n),!o&&n.intents.length>0&&i(s({request:e,sourceResponseMap:a})),n})))).filter((e=>"rejected"===e.status));for(const e of d)(0,n._v)().warn(0,"Intent detection failed",e.reason);o&&i(s({request:e,sourceResponseMap:a}))}function u(e,t){const i=h(e,t);return 0!==i?i:e[0].sourcePriority-t[0].sourcePriority}function g(e,t){return e[0].sourcePriority!==t[0].sourcePriority?e[0].sourcePriority-t[0].sourcePriority:h(e,t)}function h(e,t){var i,n,s,o;const r=null!==(n=null===(i=e[1].intents[0])||void 0===i?void 0:i.score)&&void 0!==n?n:0;return(null!==(o=null===(s=t[1].intents[0])||void 0===s?void 0:s.score)&&void 0!==o?o:0)-r}function p(e,t){const i=[...e.sourceResponseMap.entries()].sort(t);return{request:e.request,intents:i.reduce(((e,[t,i])=>e.concat(i.intents)),[])}}const m=new Map([["sequentialFirst",async function({request:e,sources:t,onIntentDetected:i,rankIntents:s}){for(const o of t)try{const t=await o.detectIntent(e);if(t.intents.length>0)return void i(s({request:e,sourceResponseMap:new Map([[o,t]])}))}catch(e){(0,n._v)().warn(0,`Intent detection failed for source ${o}:`,e)}i(s({request:e,sourceResponseMap:new Map(t.map((t=>[t,{request:e,intents:[]}])))}))}],["sequentialAll",async function(e){return d(e)}],["sequentialNotBatching",async function(e){return d(e,!1)}],["parallelFirst",async function({request:e,sources:t,onIntentDetected:i,rankIntents:s}){if(0!==t.length)return new Promise((o=>{let r=0,a=!1;t.forEach((l=>{l.detectIntent(e).then((t=>{if(0===t.intents.length)throw new Error("Source did not detect any intents");a||(a=!0,i(s({request:e,sourceResponseMap:new Map([[l,t]])})),o())})).catch((d=>{(0,n._v)().warn(0,`Intent detection failed for source ${l}:`,d),r++,r!==t.length||a||((0,n._v)().warn(0,"All intent detection sources failed"),i(s({request:e,sourceResponseMap:new Map})),o())}))}))}));i(s({request:e,sourceResponseMap:new Map}))}],["parallelAll",async function(e){return c(e)}],["parallelNotBatching",async function(e){return c(e,!1)}]]),f=new Map([["bestIntentScoreFirst",function(e){return p(e,u)}],["bestSourcePriorityFirst",function(e){return p(e,g)}]]);class v{constructor(e){this.sortedSources=[],this.sortedSources=e.intentDetectorSources.sort(((e,t)=>e.sourcePriority-t.sourcePriority)),this._invocationStrategy=e.invocationStrategy||v.defaultInvocationStrategy,this._rankStrategy=e.rankStrategy||v.defaultRankStrategy,this._intentCache=e.intentCache||new a}get intentCache(){return this._intentCache}get invocationStrategy(){if("function"==typeof this._invocationStrategy)return this._invocationStrategy;const e=m.get(this._invocationStrategy);if(!e)throw new Error(`Invalid invocation strategy: ${this._invocationStrategy}`);return e}get rankStrategy(){if("function"==typeof this._rankStrategy)return this._rankStrategy;const e=f.get(this._rankStrategy);if(!e)throw new Error(`Invalid rank strategy: ${this._rankStrategy}`);return e}set onIntentDetectedOverride(e){this._onIntentDetectedOverride=e}async invokeIntentDetectors(e){(0,o.vy)(e);const t=(0,n._v)();t.debug(505246863,"invokeIntentDetectors called",{requestId:e.requestId,textStats:(0,s.ZX)(e.text)});const i={request:{text:(0,r.f)(e.text),detectedIntents:e.detectedIntents,requestId:e.requestId},sources:this.sortedSources,rankIntents:this.rankStrategy.bind(this),onIntentDetected:this.onIntentDetected.bind(this)},a=await this.invocationStrategy(i);return(0,o.Jr)(e),t.debug(505246862,"invokeIntentDetectors completed",{requestId:e.requestId}),a}getIntents(e){return(0,n._v)().debug(505246793,"getIntents called",{textStats:(0,s.ZX)(e)}),this.intentCache.getIntents(e)}onIntentDetected(e){const t=(0,n._v)();if(t.debug(505246861,"onIntentDetected called",{requestId:e.request.requestId,intentCount:e.intents.length,textStats:(0,s.ZX)(e.request.text)}),this._onIntentDetectedOverride)return t.debug(505246860,"Calling onIntentDetectedOverride",{requestId:e.request.requestId}),this._onIntentDetectedOverride(e);this.intentCache.addToCache(e)}}v.defaultInvocationStrategy="sequentialFirst",v.defaultRankStrategy="bestIntentScoreFirst"},335009:(e,t,i)=>{i.d(t,{G:()=>n});const n=(0,i(668952).f)("INodePoller")},335290:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Емлені тексеру","IsImplemented":true}}')},340064:(e,t,i)=>{if(i.d(t,{q:()=>s}),0!=i.j)var n=i(955146);function s(e,t){var i;const s=t&&e.getContainingElement(t);if(s)return null!==(i=(0,n.m)(s))&&void 0!==i?i:s}},341524:(e,t,i)=>{if(i.d(t,{b:()=>l}),0!=i.j)var n=i(960469);var s=i(208520);const o="https://res.cdn.office.net/files/fabric-cdn-prod_20250328.001/assets/brand-icons/copilot/warning-light.svg",r="https://res.cdn.office.net/files/fabric-cdn-prod_20250328.001/assets/brand-icons/copilot/search-exclamation-mark-light.svg",a={warning:{light:o,dark:"https://res.cdn.office.net/files/fabric-cdn-prod_20250328.001/assets/brand-icons/copilot/warning-dark.svg",highContrast:o,custom:o},searchExclamation:{light:r,dark:"https://res.cdn.office.net/files/fabric-cdn-prod_20250328.001/assets/brand-icons/copilot/search-exclamation-mark-dark.svg",highContrast:r,custom:r}},l=e=>{const t=(0,n.V)();return(0,s.useMemo)((()=>a[e][t]),[t,e])}},341755:(e,t,i)=>{i.d(t,{i:()=>n});const n=(0,i(668952).f)("EditorCanvasInjectableComponent")},342782:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Bindiin","IsImplemented":true}}')},342892:(e,t,i)=>{i.d(t,{t:()=>n});const n=(0,i(668952).f)("IWordCount")},343154:(e,t,i)=>{i.d(t,{x:()=>o});var n=i(973171),s=i(564333);class o{static createEvaluator(e,t,i,n,s){return r=>o.isKey(r,e,t,i,n,s)}static isKey(e,t,i,s,r,a){if(void 0!==i&&e.altKey!==i||void 0!==s&&e.ctrlKey!==s||void 0!==r&&e.metaKey!==r||void 0!==a&&e.shiftKey!==a)return!1;if(Array.isArray(t))return t.some((t=>o.isKey(e,t,i,s,r,a)));if(e.key===t)return!0;if(t in n.c){const i=n.c[t];return e.which===i||e.keyCode===i}return!1}}o.isEnterKey=e=>{const t=s.m.enter;return o.isKey(e,t)},o.isEnterOrSpaceKey=e=>{const t=s.m.enter,i=s.m.space;return o.isKey(e,[t,i])},o.isEscapeKey=e=>{const t=s.m.escape;return o.isKey(e,t)},o.focusIfEscapeKey=e=>{o.isKey(e,s.m.escape)&&(e.currentTarget.focus(),e.stopPropagation())},o.isSpaceKey=e=>{const t=s.m.space;return o.isKey(e,t)}},344646:(e,t,i)=>{i.d(t,{X:()=>I});var n=i(379490),s=i(630501),o=i(829088),r=i(754270),a=i(647879),l=i(163573),d=i(877931),c=i(46692),u=i(243879),g=i(184226),h=i(493077),p=i(176043),m=i(12870),f=i(17384),v=i(229906),y=i(83010),_=i(427603);let I=class extends s.z{get fontsUrl(){var e;return null===(e=this.urlFormatter)||void 0===e?void 0:e.getUrl(this.presentationDomSettings.fabricFontsDefinitionPath)}get title(){var e;return null!==(e=this._title)&&void 0!==e?e:""}get text(){return this.squiggleTooltipMessageBuilder.getInteractionExplanationText(this.squiggleKind)}get ariaLabel(){return this.squiggleTooltipMessageBuilder.getInteractionExplanationAriaLabel(this.squiggleKind)}get isVisible(){return this._isVisible}get top(){return this._position?`${this._position.y}px`:"auto"}get left(){if(!this._position||this.scriptDirectionDetector.isRtl())return"auto";return`calc(min(100vw - ${this._position.x+300}px, 0px) + ${this._position.x}px)`}get right(){return this._position&&this.scriptDirectionDetector.isRtl()?`calc(100vw - max(${this._position.x}px, 300px))`:"auto"}get styles(){return this.styleDefinitions.tooltip}get isEccOpen(){var e;return!!(null===(e=this.inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo())}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new o.O(document)}constructor(e,t,i,n,s,o,r,a){super(),this.hostSettings=e,this.presentationDomSettings=t,this.logger=i,this.scriptDirectionDetector=n,this.styleDefinitions=s,this.squiggleTooltipMessageBuilder=o,this.urlFormatter=r,this.inlineSuggestionsRenderer=a,this._position=void 0,this._title=void 0,this._isVisible=!1,this._targetDocumentRef=void 0,this.resetTimeout=()=>{this.originStatusCheckTimer&&(window.clearTimeout(this.originStatusCheckTimer),this.originStatusCheckTimer=void 0)},this.checkOriginState=()=>{var e;null===(null===(e=this.origin)||void 0===e?void 0:e.parentElement)?this.emergencyDismiss("Tooltip dismissed on timeout: the origin is orphaned."):this.setOriginStateCheckTimeout()},this.setOriginStateCheckTimeout=()=>{this.originStatusCheckTimer=window.setTimeout(this.checkOriginState,3e3)}}async initialize(){}shutDown(){this.hide()}show(e,t,i,n,s){this.resetTimeout(),this.squiggleKind=e,this._title=this.squiggleTooltipMessageBuilder.getTooltipTitle(t.priority,e,t.typeId,t.tooltipTitle),this._position=i,this._isVisible=!!this.hostSettings.showSquiggleTooltip,this.origin=n;const l=null!=s?s:null==n?void 0:n.ownerDocument;this._targetDocumentRef=l&&new o.O(l),this.setOriginStateCheckTimeout();const d=this.logger.getNewActivity(r.n.SquiggleTooltipShown,c.o.SamplingPolicy.CriticalExperimentation);d&&(d.dataFields.push((0,a.n)("CritiqueTypeId",t.typeId)),d.success=!0,d.endNow()),this.publishEvent("tooltipStateUpdated",{visible:this._isVisible,position:this._position})}hide(){this.resetTimeout(),this.origin=void 0,this._targetDocumentRef=void 0,this._isVisible=!1,this._position=void 0,this.squiggleKind=void 0,this.publishEvent("tooltipStateUpdated",{visible:this._isVisible,position:void 0})}emergencyDismiss(e){this.logger.warn(545910989,e),this.hide()}};I=(0,n.__decorate)([(0,v._)(),(0,n.__param)(0,(0,y.W)(l.n)),(0,n.__param)(1,(0,y.W)(p.D)),(0,n.__param)(2,(0,y.W)(d.g)),(0,n.__param)(3,(0,y.W)(g.iw)),(0,n.__param)(4,(0,y.W)(f.$)),(0,n.__param)(5,(0,y.W)(m.U)),(0,n.__param)(6,(0,y.W)(h.n)),(0,n.__param)(6,(0,_.l)()),(0,n.__param)(7,(0,_.l)()),(0,n.__param)(7,(0,y.W)(u.V))],I)},344690:(e,t,i)=>{var n,s;i.d(t,{G:()=>n,i:()=>s}),function(e){e.Int="nleditor.osi.office-int.net",e.Staging="nleditor.osi.officeppe.net",e.Lab="nleditor.osi.officeppe.net",e.Prod="nleditor.osi.office.net",e.GCC="nleditor.gcc.osi.office365.us",e.GCCHigh="nleditor.osi.office365.us",e.USDoD="nleditor.osi.apps.mil",e.USNat="nleditor.osi.eaglex.ic.gov",e.USSec="nleditor.osi.microsoft.scloud"}(n||(n={})),function(e){e.Int="editor-thesaurus.northeurope.cloudapp.azure.com:9443",e.Staging="editor-edog-thesaurus.trafficmanager.net:9443",e.Lab="editor-edog-thesaurus.trafficmanager.net:9443",e.Prod="editor-prod-thesaurus.trafficmanager.net:9443",e.GCCModerate="editor-gccm-thesaurus.usgovtrafficmanager.net:9443",e.GCCHigh="editor-trailblazer-thesaurus.usgovtrafficmanager.net:9443",e.USDoD="editor-pathfinder-thesaurus.usgovtrafficmanager.net:9443",e.USNat="editor-usnat-thesaurus.trafficmanager.eaglex.ic.gov:9443",e.USSec="editor-ussec-thesaurus.trafficmanager.microsoft.scloud:9443"}(s||(s={}))},346709:(e,t,i)=>{if(i.d(t,{H:()=>r}),0!=i.j)var n=i(357314);if(0!=i.j)var s=i(689795);if(0!=i.j)var o=i(251439);class r{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918243)}configureRootServices(e){e.bind(n.W).to(s.M)}}},347601:(e,t,i)=>{i.d(t,{C:()=>h,L:()=>p});var n=i(379490),s=i(671303),o=i(163573),r=i(821003),a=i(636734),l=i(203390),d=i(299501),c=i(668952),u=i(229906),g=i(83010);const h=(0,c.f)("IOAResultStore");let p=class{constructor(e,t,i,n){this._oaLogger=e,this._hostSettings=t,this._queryDetection=i,this._oaMetric=n,this._results=[],this._resultsByNode=new Map,this._isLoading=!0,this._isTimeout=!1,this._resultReset=!1,this.setOnUpdate=e=>{this.onUpdate=e},this.updateResults=(e,t,i,n,s,o)=>{var r,a;if(null===(r=this._hostSettings.oaSettings)||void 0===r?void 0:r.mockNoAugloopResults)return;const l=(null==n?void 0:n.logicalId)&&n.logicalId!==this._queryDetection.getCurrentQueryLogicalId();this.logStoreUpdate(e,!!l,i,n),l?this._oaMetric.commitEntry(n.logicalId,"OAAnnotationResultsDropped"):(n&&this._oaMetric.addMeasure(n.logicalId,"OAResultsReceived"),this.cancelTimeout(),this._isLoading=!1,this._isTimeout=!1,this._resultSummary=o,this._resultStatus=i,this._resultReset=!1,this._results=this._results.concat(e),this._resultsByNode.set(t,e),this.update(i,e,null!==(a=null!=n?n:this._queryDetection.getCurrentQueryCorrelationKeys())&&void 0!==a?a:{conversationId:"",logicalId:""},t,s,o))},this.updateLoadingStatus=(e,t=!1)=>{this._isLoading=e,this._isTimeout=!1,this._resultSummary=void 0,this._resultStatus=void 0,this._resultReset=t,e&&(this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())),this.update()},this.startNewECCMenu=()=>{this.cancelTimeout(),this._timeoutID=setTimeout(this.timeoutFunc,this.getTimeoutThreshold())},this.clearResults=()=>{this._results=[],this._isTimeout=!1,this._isLoading=!0,this._resultReset=!1,this._resultsByNode.clear()},this.getResults=()=>this._results,this.getResultSummary=()=>this._resultSummary,this.getResultStatus=()=>this._resultStatus,this.getLoadingStatus=()=>this._isLoading,this.getTimeoutStatus=()=>this._isTimeout||this._resultStatus===d.i.UnexpectedError,this.timeoutFunc=()=>{var e;this._isTimeout=!0,this._isLoading=!1,this._resultSummary={Timeout:1},this._resultStatus=d.i.Timeout,this._resultReset=!1,this.update(d.i.Timeout,void 0,null!==(e=this._queryDetection.getCurrentQueryCorrelationKeys())&&void 0!==e?e:{conversationId:"",logicalId:""},void 0,this.getTimeoutThreshold(),this._resultSummary)},this.cancelTimeout=()=>{this._timeoutID&&clearTimeout(this._timeoutID)},this.update=(e=void 0,t=[],i=void 0,n,s,o=void 0)=>{this.onUpdate&&this.onUpdate({results:t,isLoading:this._isLoading,queryCorrelationKeys:i,resultSummary:o,resultStatus:e,resultReset:this._resultReset,nodeId:n,latency:s})}}logStoreUpdate(e,t,i,n){const s={};for(const t of e){s[t.entityType]=t.entities.length}this._oaLogger.logActivity(l.y,{actualLogicalId:null==n?void 0:n.logicalId,actualConversationId:null==n?void 0:n.conversationId,annotationCount:e.length,resultStatus:null!=i?i:-1,annotations:s,dropped:t})}getTimeoutThreshold(){var e;return(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.updateResultsTimeout)||3500}};p=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,g.W)(s.m)),(0,n.__param)(1,(0,g.W)(o.n)),(0,n.__param)(2,(0,g.W)(r.J)),(0,n.__param)(3,(0,g.W)(a.u))],p)},354339:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(668952).f)("IInlineSuggestionsCalloutPlacement")},355476:(e,t,i)=>{i.d(t,{h:()=>h});var n=i(379490),s=i(922630),o=i(442316),r=i(772830),a=i(985500),l=i(234979),d=i(797386),c=i(229906),u=i(83010),g=i(427603);let h=class{constructor(e,t,i,n,s){this._tileNodeReader=e,this._hostSettings=t,this._optimizedRehydrationEnabled=i,this._logger=n,this._textEventPublisher=s}pollNodes(e,t,i,n,s,o,r,a){var l,c,u,g;if(this._textEventPublisher&&!0===this._hostSettings.sdkV2Enabled){const n=[];for(const e of t)if(this._tileNodeReader.isTileNode(e))try{const t=(0,d.F)(e);n.push({text:e.pullText(),mutationChangeType:i,tileNodeId:e.id,rehydrateCritiques:s,forceTileDiffEmission:r,mutationWasTextReplacement:a,documentModel:null==t?void 0:t.documentModel,previousNodeId:this._tileNodeReader.getPreviousTileId(e),nextNodeId:this._tileNodeReader.getNextTileId(e),optimizedRehydrationEnabled:this._optimizedRehydrationEnabled.check(),brokerOptions:{critiques:null==o?void 0:o.get(e.id),forceReflow:!0}})}catch(e){null===(c=this._logger)||void 0===c||c.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(l=this._logger)||void 0===l||l.error(0,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack});this._textEventPublisher.publishTextChangeEvent(n,e)}else for(const e of t)if(this._tileNodeReader.isTileNode(e))try{this._tileNodeReader.reconcile(e,i,null==o?void 0:o.get(e.id),!0,s,r,a)}catch(e){null===(g=this._logger)||void 0===g||g.error(0,"SimplifiedNodePoller: Exception occurred.",e)}else null===(u=this._logger)||void 0===u||u.error(509727256,"SimplifiedNodePoller: Found children of unsupported type.",{nodeType:e.nodeType,stack:(new Error).stack})}removeQueuedTiles(e){}};h=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(a.j)),(0,n.__param)(1,(0,u.W)(s.n)),(0,n.__param)(2,(0,u.W)(l.W)),(0,n.__param)(3,(0,g.l)()),(0,n.__param)(3,(0,u.W)(o.g)),(0,n.__param)(4,(0,g.l)()),(0,n.__param)(4,(0,u.W)(r.n))],h)},355495:(e,t,i)=>{i.d(t,{z:()=>n});class n{static getDefaultLanguageCode(e){return e&&e.length>0?e[0]:""}constructor(e){this.equalsTo=e=>{if(!e||this._codesList.length!==e.length)return!1;for(let t=0;t<this._codesList.length;t+=1)if(this._codesList[t].toLocaleLowerCase()!==e[t].toLocaleLowerCase())return!1;return!0},this._codesList=e}get count(){return this._codesList.length}get defaultLanguageCode(){var e;return null!==(e=this._codesList[0])&&void 0!==e?e:""}get codesList(){return this._codesList||[]}}},357314:(e,t,i)=>{i.d(t,{W:()=>n});const n=(0,i(668952).f)("IReactComponentInitializer")},359310:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(668952).f)("ISafeWindow")},362172:(e,t,i)=>{i.d(t,{y:()=>u});var n=i(379490),s=i(947511),o=i(766535),r=i(380422),a=i(383714),l=i(46692),d=i(229906),c=i(83010);let u=class{constructor(e){this._logger=e,this._renderedCritiques=new Map}update(e,t){const i=this._renderedCritiques.get(t)||new Map;for(const t of e){const e=`${t.textInContext}#${t.typeId}`;i.set(e,t)}this._renderedCritiques.set(t,i)}logTelemetry(){const e=this._logger.getNewActivity(s.n.CritiquesShown,l.o.SamplingPolicy.CriticalExperimentation);if(!e)return;let t=[];Array.from(this._renderedCritiques.values()).forEach((e=>{t=t.concat(Array.from(e.values()))}));const i={};try{const e=Array.from(t.values()).reduce(((e,t)=>{if(t.typeId){let i=new Set;t.typeId===o.L9.TopicSuggestion&&(i=t.suggestions.reduce(((e,t)=>{const i=t.metadataJSON;if(i){const t=JSON.parse(i).id;t&&e.add(t)}return e}),new Set)),t.typeId in e?(e[t.typeId].count+=1,i.forEach(e[t.typeId].suggestions.add,e[t.typeId].suggestions)):e[t.typeId]={count:1,suggestions:i}}return e}),{});for(const t in e)i[t]={count:e[t].count,suggestions:[...e[t].suggestions]}}catch(e){this._logger.error(505295059,"Data preparation failed for CritiquesShown",e)}e.dataFields.push((0,r.n)("Critiques",JSON.stringify(i))),e.success=!0,e.endNow()}};u=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(a.g))],u)},363160:(e,t,i)=>{if(i.d(t,{s:()=>o}),0!=i.j)var n=i(829088);const s="__reactEvents";class o{constructor(e){this.element=new n.O(e),this.replacedElements=[],this.ownerDocument=new n.O(e.ownerDocument)}replaceListener(e){var t;if(!e)return;const i=new n.O(e),o=e.addEventListener,r=new n.O(o),a={},l=[];for(const t in e)t.startsWith(s)&&l.push(t);e.addEventListener=(e,t,n)=>{const s=r.deref(),o=i.deref();s&&o&&(e in a||(a[e]=[]),a[e].push({listener:t,options:n}),s.apply(o,[e,t,n]))};null===(t=this.replacedElements)||void 0===t||t.push({element:i,eventHandlers:a,restoreOriginalAddEventListener:()=>{e.addEventListener=o},existingReactEvents:l})}render(e){var t,i;const n=null===(t=this.element)||void 0===t?void 0:t.deref(),o=null===(i=this.ownerDocument)||void 0===i?void 0:i.deref();if(o&&n){this.replaceListener(n),this.replaceListener(n.firstElementChild),this.replaceListener(n.host),this.replaceListener(o),this.replaceListener(o.defaultView);try{return e()}finally{if(this.replacedElements)for(let e=this.replacedElements.length-1;e>=0;e--){const t=this.replacedElements[e],i=t.element.deref(),n=t.restoreOriginalAddEventListener;if(null==n||n(),t.restoreOriginalAddEventListener=void 0,i&&t.existingReactEvents){t.reactEventsToClear=[];for(const e in i)e.startsWith(s)&&!t.existingReactEvents.includes(e)&&t.reactEventsToClear.push(e)}t.existingReactEvents=void 0}}}}cleanup(){var e;if(!this.replacedElements||!this.ownerDocument)return;const t=this.ownerDocument.deref();for(const i of this.replacedElements){for(const n in i.eventHandlers){const s=i.element.deref();for(const o of i.eventHandlers[n])null==s||s.removeEventListener(n,o.listener,o.options),null===(e=null==t?void 0:t.defaultView)||void 0===e||e.removeEventListener(n,o.listener,o.options);if(s&&i.reactEventsToClear)for(const e of i.reactEventsToClear)s[e]=void 0}i.eventHandlers={}}this.replacedElements=void 0,this.ownerDocument=void 0,this.element=void 0}}},364680:(e,t,i)=>{i.d(t,{m:()=>r});var n=i(189784),s=i(55441),o=i(208520);const r=o.memo((e=>{const{prediction:t,parentElement:i}=e,r=parseInt(window.getComputedStyle(i).fontSize,10);return o.createElement(n.I,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1,showIconWithMultipleComponents:!0}),o.createElement(s.c,{coinSize:r,text:"",imageUrl:t.entityResults.entities[0].imageUrl,imageInitials:t.entityResults.entities[0].imageInitials}))}))},367409:(e,t,i)=>{if(i.d(t,{S:()=>o}),0!=i.j)var n=i(379490);if(0!=i.j)var s=i(814948);function o(e){const{text:t,action:i,languages:o,metadataJSON:r,description:a}=e,l=(0,n.__rest)(e,["text","action","languages","metadataJSON","description"]);return Object.assign({text:t,action:(0,s.fO)(i),languages:o,metadataJSON:r,description:a},l)}},367781:(e,t,i)=>{i.d(t,{T:()=>g});var n=i(252723),s=i(108520),o=i(627223);if(0!=i.j)var r=i(944163);var a=i(208520),l=i(794329),d=i(252843);const c=0!=i.j?"\n  @media print {\n    .ms-editor-shadow-container {\n      display:none !important;\n    }\n  }\n  .ms-editor-shadow-container {\n    all: initial;\n  }":null,u=(0,n.F5)({store:s.A.on(o.S)}),g=()=>{const{store:e}=(0,n.KN)(u),[t,i]=a.useState(e.stores);return a.useEffect((()=>{const t=e=>{i(e.stores)};return e.subscribe("stateUpdated",t),()=>{e.unsubscribe("stateUpdated",t)}}),[e]),a.createElement(a.Fragment,null,Array.from(t.values()).map((e=>{var t;return l.createPortal(a.createElement("editor-shadow",{style:{overflow:"auto"}},a.createElement(a.Fragment,null,a.createElement("style",null,c),a.createElement(d.Ay.div,{className:"ms-editor-shadow-container"},a.createElement(r.R,{store:e})))),null!==(t=e.anchor.parentElement)&&void 0!==t?t:window.document.body)})))}},368617:(e,t,i)=>{i.d(t,{u:()=>c});var n=i(208520);if(0!=i.j)var s=i(107613);var o=i(252723),r=i(108520),a=i(429712),l=i(494888);const d=(0,o.F5)({stateStore:r.A.on(a.QV),featureFlagsReader:r.A.on(l.c)}),c=()=>{const{featureFlagsReader:e,stateStore:t}=(0,o.KN)(d),[i,r]=n.useState(void 0);return n.useEffect((()=>(t.subscribe("stateUpdated",r),()=>{t.unsubscribe("stateUpdated",r)})),[t]),i?n.createElement(s.A,{enableAriaStatusInNonRootIFrames:e.flags.enableAriaStatusInNonRootIFrames,politeUpdates:i.politeUpdates,assertiveUpdates:i.assertiveUpdates,status:i.status,statusSeverity:i.statusSeverity}):null}},370137:(e,t,i)=>{if(i.d(t,{J:()=>o,Y:()=>r}),0!=i.j)var n=i(829088);if(0!=i.j)var s=i(786132);class o{constructor(){this._targetWindow=new n.O(window),this._visibleSquigglesRangeContainers=new Map,this._checkedElements=new Map,this._isAnchorElementVisible=!0,this.connect=e=>{var t;this._targetWindow=new n.O((0,s.e)(e.anchorElement)),(null===(t=this._targetWindow.deref())||void 0===t?void 0:t.IntersectionObserver)&&(this.initSquigglerObserver(e.trackSquiggler,e.anchorElement,e.onSquigglerVisibilityChange),this.initSquigglesObserver(e.trackSquiggles,e.onSquigglesVisibilityChange))},this.disconnect=()=>{this._squigglesVisibilityObserver&&this._squigglesVisibilityObserver.disconnect(),this._squigglerVisibilityObserver&&this._squigglerVisibilityObserver.disconnect(),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.disconnect()},this.trackSquiggle=e=>{var t;let i;if(!this._squigglesVisibilityObserver||!(i=this.getElementFromRange(e)))return;const n=null!==(t=this._visibleSquigglesRangeContainers.get(i))&&void 0!==t?t:{visible:void 0,handles:0};n.handles=n.handles+1,this._visibleSquigglesRangeContainers.set(i,n),this._squigglesVisibilityObserver.observe(i)},this.unTrackSquiggle=e=>{var t;let i;if(!this._squigglesVisibilityObserver||!(i=this.getElementFromRange(e)))return;const n=null!==(t=this._visibleSquigglesRangeContainers.get(i))&&void 0!==t?t:{visible:!1,handles:0};n.handles=n.handles-1,this._visibleSquigglesRangeContainers.set(i,n),n.handles<=0&&this.untrackElement(i)},this.isSquiggleVisible=e=>{const t=this.getElementFromRange(e);if(!t)return;if(!this._visibleSquigglesRangeContainers.has(t))return void this.trackSquiggle(e);const i=this._visibleSquigglesRangeContainers.get(t);return null==i?void 0:i.visible},this.checkImmediateVisibility=async e=>{const t=this.getElementFromRange(e);if(!t)return!1;const i=await this.asyncCheckVisibility(t);return this._checkedElements.delete(t),this._asyncVisibilityObserver&&this._asyncVisibilityObserver.unobserve(t),i},this.asyncCheckVisibility=async e=>new Promise((t=>this.checkVisibility(e,t))),this.asyncVisibilityCallback=e=>{for(const t of e){const e=this._checkedElements.get(t.target);e&&e(t.isIntersecting)}},this.checkVisibility=(e,t)=>{if(!this._asyncVisibilityObserver){const e=this._targetWindow.deref();if(!e)return;this._asyncVisibilityObserver=new e.IntersectionObserver(this.asyncVisibilityCallback,{rootMargin:"0px",threshold:[0,1]})}this._checkedElements.set(e,t),this._asyncVisibilityObserver.observe(e)},this.untrackElement=e=>{var t;null===(t=this._squigglesVisibilityObserver)||void 0===t||t.unobserve(e),this._visibleSquigglesRangeContainers.delete(e)},this.initSquigglerObserver=(e,t,i)=>{if(!e)return;const n=this._targetWindow.deref();n&&(this._squigglerVisibilityObserver=new n.IntersectionObserver((e=>{i(this.getSquigglerIsVisible(e))}),{rootMargin:"0px",threshold:[0,1]}),this._squigglerVisibilityObserver.observe(t))},this.initSquigglesObserver=(e,t)=>{if(!e)return;const i=this._targetWindow.deref();i&&(this._squigglesVisibilityObserver=new i.IntersectionObserver((e=>{t(this.getVisibleSquigglesRangeContainers(e))}),{rootMargin:"0px",threshold:[0,1]}))},this.getVisibleSquigglesRangeContainers=e=>{var t;let i=!1;for(const n of e.values())if(n.target.isConnected){const e=null!==(t=this._visibleSquigglesRangeContainers.get(n.target))&&void 0!==t?t:{visible:!1,handles:1};e.visible=n.isIntersecting,this._visibleSquigglesRangeContainers.set(n.target,e)}else i=!0;return i&&this.removeZombies(),e},this.removeZombies=()=>{for(const e of this._visibleSquigglesRangeContainers.keys())e.isConnected&&this.untrackElement(e)},this.getSquigglerIsVisible=e=>(this._isAnchorElementVisible=e[e.length-1].isIntersecting,this._isAnchorElementVisible),this.getElementFromRange=e=>1===e.nodeType?e:e.parentElement}}const r={connect:()=>null,disconnect:()=>null,isSquiggleVisible:()=>!0,trackSquiggle:()=>null,unTrackSquiggle:()=>null,checkImmediateVisibility:async()=>!0}},370666:(e,t,i)=>{i.d(t,{I:()=>S});var n=i(379490),s=i(602764),o=i(868038),r=i(279e3),a=i(997601),l=i(826663),d=i(104072),c=i(538045),u=i(955377),g=i(537969),h=i(781729),p=i(961641),m=i(745133),f=i(150099),v=i(877931),y=i(229906),_=i(66008),I=i(83010),C=i(427603);let S=class{constructor(e,t,i,n,o,r,a,l,d,c,u,g,h){this.applyCritiqueSuggestion=async(e,t,i,n,s,o,r,a)=>this._critiqueApplicationHandler.applyCritiqueSuggestion(e,t,i,n,s,o,r,a),this.applyFlagSuggestion=async(e,t,i,n,s,o)=>this._critiqueApplicationHandler.applyFlagSuggestion(e,t,i,n,s,o),this.ignoreCritiqueOnce=(e,t,i,n)=>{this._critiqueApplicationHandler.ignoreCritiqueOnce(e,t,i,n)},this.ignoreFlagOnce=(e,t,i,n)=>{this._critiqueApplicationHandler.ignoreFlagOnce(e,t,i,n)},this.ignoreAllOfFlag=(e,t,i)=>{this._critiqueApplicationHandler.ignoreAllOfFlag(e,t,i)},this.ignoreAllOfCritique=(e,t,i,n)=>{this._critiqueApplicationHandler.ignoreAllOfCritique(e,t,i,n)},this.disableCritiqueType=async(e,t,i,n)=>this._critiqueApplicationHandler.disableCritiqueType(e,t,i,n),this.disableFlagType=(e,t,i,n)=>{this._critiqueApplicationHandler.disableFlagType(e,t,i,n)},this._critiqueApplicationHandler=new s.n(e,t,i,n,o,r,a,l,d,c,u,g,h)}};S=(0,n.__decorate)([(0,y._)(),(0,n.__param)(0,(0,_.t)(g.zJ)),(0,n.__param)(1,(0,I.W)(d.d)),(0,n.__param)(2,(0,I.W)(o.s)),(0,n.__param)(2,(0,C.l)()),(0,n.__param)(3,(0,I.W)(c.w)),(0,n.__param)(4,(0,I.W)(f.j)),(0,n.__param)(5,(0,C.l)()),(0,n.__param)(5,(0,I.W)(u.W)),(0,n.__param)(6,(0,I.W)(v.g)),(0,n.__param)(6,(0,C.l)()),(0,n.__param)(7,(0,I.W)(r.$)),(0,n.__param)(7,(0,C.l)()),(0,n.__param)(8,(0,I.W)(a.a)),(0,n.__param)(8,(0,C.l)()),(0,n.__param)(9,(0,I.W)(l.K)),(0,n.__param)(9,(0,C.l)()),(0,n.__param)(10,(0,I.W)(h.s)),(0,n.__param)(10,(0,C.l)()),(0,n.__param)(11,(0,I.W)(p.rI)),(0,n.__param)(11,(0,C.l)()),(0,n.__param)(12,(0,C.l)()),(0,n.__param)(12,(0,I.W)(m.PF))],S)},370907:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"ਸ਼ਬਦਜੋੜ","IsImplemented":true}}')},374831:(e,t,i)=>{i.d(t,{c:()=>s});var n=i(182755);class s extends n.M{constructor(e){super(),this.handleTelemetryEvent=e}sendTelemetryEvent(e){this.handleTelemetryEvent(e)}}},377253:(e,t,i)=>{if(i.d(t,{r:()=>u}),0!=i.j)var n=i(576516);if(0!=i.j)var s=i(326647);if(0!=i.j)var o=i(38403);if(0!=i.j)var r=i(364680);if(0!=i.j)var a=i(693059);if(0!=i.j)var l=i(579990);if(0!=i.j)var d=i(791424);var c=i(208520);function u(e,t,i,u,g,h,p,m,f,v,y){return c.createElement(l.K,{rtl:i.isRtl()},function(e,t,i,l,u,g,h,p,m,f){var v,y,_,I,C,S,b;return i.entityType===n.c.File&&i.entityResults&&l?c.createElement(s.Z,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(v=i.shouldShowInsertionHelperText)||void 0===v||v,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:h,onDropdownOpened:g}):i.entityType===n.c.People&&i.entityResults&&l?c.createElement(r.m,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(y=i.shouldShowInsertionHelperText)||void 0===y||y,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:h,onDropdownOpened:g}):i.entityType===n.c.Loop&&i.entityResults&&l?c.createElement(o.N,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(_=i.shouldShowInsertionHelperText)||void 0===_||_,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:h,onDropdownOpened:g}):i.entityType===n.c.PIM&&l&&m&&(null!==(C=null===(I=i.entityResults)||void 0===I?void 0:I.entities.length)&&void 0!==C?C:0)>1?c.createElement(a.X,{predictionDisplayText:l,prediction:i,shouldShowInsertionHelperText:null===(S=i.shouldShowInsertionHelperText)||void 0===S||S,leftPadding:p,localizer:e,isMobile:t,parentElement:u,onTextMayOverlapLine:h,onDropdownOpened:g}):[n.c.Text,n.c.People,n.c.PIM,n.c.Topic].includes(i.entityType)&&l?c.createElement(d.Y,{predictionDisplayText:l,shouldShowInsertionHelperText:null===(b=i.shouldShowInsertionHelperText)||void 0===b||b,isPIMPrediction:i.entityType===n.c.PIM,leftPadding:p,localizer:e,isMobile:t,onTextMayOverlapLine:h,onDropdownOpened:g,isHelperText:i.isHelperText,appName:f}):c.createElement(c.Fragment,null)}(e,t,u,g,h,p,m,f,v,y))}},378071:(e,t,i)=>{function n(e){return e&&(e.formattedRanges||e.attributionRanges)}function s(e,t){const i=e.start<t.start?e:t,n=i===e?t:e;if(!(i.end<n.start))return{start:n.start,end:i.end<n.end?i.end:n.end}}function o(e,t,i){if(!e)return;const n=e.content.substring(t,i);let o;if(e.formattedRanges){o=[];for(const n of e.formattedRanges){const e=s({start:n.start,end:n.start+n.length},{start:t,end:i});e&&o.push(Object.assign(Object.assign({},n),{start:e.start,length:e.end-e.start}))}}return Object.assign(Object.assign({},e),{content:n,formattedRanges:o})}function r(e,t,i){const n=[];for(const s of e){const e=s.start+s.length,o=Math.max(t,s.start),r=Math.min(i,e);r<=o||n.push(Object.assign(Object.assign({},s),{start:o,length:r-o}))}return n}function a(e,t,i){return e.formattedRanges?r(e.formattedRanges,t,i):[]}function l(e,t,i){return{formattedRanges:e.formattedRanges?r(e.formattedRanges,t,i):[],attributionRanges:e.attributionRanges?r(e.attributionRanges,t,i):[]}}i.d(t,{Dt:()=>n,FD:()=>a,Gn:()=>o,V8:()=>g,Wi:()=>l,_E:()=>d,lX:()=>c});const d=0!=i.j?["queryRange","ipPosition","isColdIp","content","formattedRanges","attributionRanges","objectReferences"]:null;function c(e,t){if(!e!=!t)return!1;if(!e||!t)return!0;const i=u(e);return!!g(i,u(e))&&i.every((i=>e[i]===t[i]))}function u(e){return Object.keys(e).filter((e=>!d.includes(e)))}function g(e,t){return!e==!t&&(!e||!t||e.length===t.length&&e.every(((i,n)=>function(e,t){if("string"==typeof e&&"string"==typeof t)return e===t;const i=Object.keys(e),n=Object.keys(t);if(i.length!==n.length)return!1;for(const n of i)if(Array.isArray(e[n])&&Array.isArray(t[n])){if(!g(e[n],t[n]))return!1}else if(e[n]!==t[n])return!1;return!0}(e[n],t[n]))))}},378781:(e,t,i)=>{if(i.d(t,{V:()=>z}),0!=i.j)var n=i(939074);if(0!=i.j)var s=i(251439);if(0!=i.j)var o=i(386675);if(0!=i.j)var r=i(140649);if(0!=i.j)var a=i(709899);if(0!=i.j)var l=i(777555);if(0!=i.j)var d=i(517119);if(0!=i.j)var c=i(629139);if(0!=i.j)var u=i(495170);if(0!=i.j)var g=i(879190);if(0!=i.j)var h=i(695285);if(0!=i.j)var p=i(342892);if(0!=i.j)var m=i(659175);if(0!=i.j)var f=i(302246);if(0!=i.j)var v=i(63689);if(0!=i.j)var y=i(667288);if(0!=i.j)var _=i(229464);if(0!=i.j)var I=i(469718);if(0!=i.j)var C=i(122336);if(0!=i.j)var S=i(58215);if(0!=i.j)var b=i(799116);if(0!=i.j)var T=i(157698);if(0!=i.j)var E=i(18926);if(0!=i.j)var N=i(538045);if(0!=i.j)var w=i(623824);if(0!=i.j)var x=i(610904);if(0!=i.j)var L=i(985500);if(0!=i.j)var D=i(293447);if(0!=i.j)var A=i(547956);if(0!=i.j)var F=i(783881);if(0!=i.j)var q=i(10075);if(0!=i.j)var R=i(639397);if(0!=i.j)var P=i(60836);if(0!=i.j)var O=i(822765);if(0!=i.j)var k=i(622926);if(0!=i.j)var M=i(779140);class z{constructor(){this.imports=[n.A]}get uniqueId(){return(0,s.z)(507918410)}configureRootServices(e){e.bind(S.W).to(A.zR),(0,M.sb)(e),(0,M.Yx)(e),(0,M.gs)(e),(0,M.fQ)(e),(0,M.I6)(e),(0,M.cf)(e),e.bind(y.V).to(r.C),e.bind(L.j).to(O.o),e.bind(E.b).to(R.y),e.bind(x.o).to(x.v),e.bind(w.k).toTransient(w.h),e.bind(C.Y).to(C.B),e.bind(_.d).to(a.m),e.bind(b.b).to(F.S),e.bind(N.w).to(P.D),e.bind(o.S).toExisting(N.w),e.bind(o.S).to(k.j),e.bind(T.b).to(q.o),e.bind(I.n).to(D.C),e.bind(l.hN).to(d.F),e.bind(l.c0).to(c.a),e.bind(l.pT).to(u.R),e.bind(l.b0).to(u.R),e.bind(g.D).to(h._n),e.bind(p.t).to(m.a),e.bind(f.B).to(v.M)}}},380422:(e,t,i)=>{if(i.d(t,{W:()=>o,n:()=>s}),0!=i.j)var n=i(46692);function s(e,t,i,s){return{name:e,value:t,dataType:(null!=s?s:"boolean"==typeof t)?n.o.DataFieldType.Boolean.valueOf():"number"==typeof t?n.o.DataFieldType.Int64.valueOf():n.o.DataFieldType.String.valueOf(),classification:null!=i?i:n.o.DataClassification.EssentialServiceMetadata}}function o(...e){return e.map((([e,t,i,n])=>s(e,t,i,n)))}},380737:(e,t,i)=>{i.d(t,{a:()=>o});var n=i(208520);if(0!=i.j)var s=i(966727);const o=e=>{const{className:t,left:i,squiggleHeight:o,styleOverrides:r,width:a}=e,l=e.patternName,d=s.fQ[l],c=s.K3[l];return n.createElement("svg",{width:a,height:d,viewBox:`0 0 ${a} ${d}`,className:t,style:Object.assign({top:o?o-d+c:void 0,bottom:o?void 0:-1*(d+c),left:i,position:"absolute"},r)},n.createElement("rect",{fill:`url(#${l})`,width:a,height:d}))}},383490:(e,t,i)=>{i.d(t,{z:()=>d});var n=i(379490);const s=(0,i(668952).f)("IIconRegistrable");var o=i(229906),r=i(66008),a=i(427603),l=i(57980);let d=class{constructor(e){this.iconGroups=e}async initialize(){const e={};for(const t of this.iconGroups)for(const i of await t.getIcons())e[i.iconName]=i.icon;(0,l.K1)({icons:e})}shutDown(){}};d=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.t)(s)),(0,n.__param)(0,(0,a.l)())],d)},383714:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(668952).f)("ILogger")},383806:(e,t,i)=>{i.d(t,{l:()=>l});var n=i(379490),s=i(823325),o=i(279e3),r=i(229906),a=i(83010);let l=class{constructor(e){this._critiqueStore=e}onEvent(e){switch(e.eventType){case s.G.NewData:this._critiqueStore.updateNode([],e.tileId,e.tileVersion);break;case s.G.RemoveData:this._critiqueStore.clearNode(e.tileId)}}};l=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.$))],l)},386311:(e,t,i)=>{i.d(t,{r:()=>u});var n=i(807582),s=i(585170),o=i(576240),r=i(287704),a=i(355476),l=i(553164);class d{isTileNode(e){return e.nodeType===l.Z.TileNode}reconcile(e,t,i,n,s,o,r){}critiques(e){return[]}getPreviousTileId(e){return e.getPreviousTileId()}getNextTileId(e){return e.getNextTileId()}}var c=i(772830);class u extends n.z{constructor(e,t,i,n,s,o,r,a,l){super(),this.element=e,this.proofingDom=t,this.hostSettings=i,this.featureFlags=n,this.settings=s,this.safeWindow=o,this.logger=l,this._nodePoller=null,this._terminalNode=null,this._terminalNodeBuilder=null,this.isDisposed=!1,this.handleTextChangeEvent=e=>{this.publishEvent("textChange",e)},this.handleTextStyleChangeEvent=()=>{this.publishEvent("styleChange",{})};const d=Object.assign(Object.assign({},s),{useDirtyParagraphReconciliation:r});this._textEventPublisher=new c.i(d,a)}initialize(){const e=new r.Q,t=new o.Z(this.proofingDom,e,this.safeWindow),i=new d;this._nodePoller=new a.h(i,this.hostSettings,{check:()=>!!this.hostSettings.enableOrchestration&&this.featureFlags.enableParagraphUpdates&&this.featureFlags.enableParagraphDeltas&&this.featureFlags.enableOptimizedRehydration},this.logger,this._textEventPublisher),this._terminalNodeBuilder=new s.h(this.hostSettings,this.proofingDom,this.settings,t,i,this._nodePoller,this._textEventPublisher,this.logger),this._textEventPublisher.subscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.subscribe("styleChange",this.handleTextStyleChangeEvent),this._terminalNode=this._terminalNodeBuilder.createGraphNode({element:this.element}),this._terminalNode&&this.proofingDom.addNode(this._terminalNode)}async dispose(){this._terminalNode&&(this._terminalNode.retire(),this._terminalNode=null),this._nodePoller=null,this._terminalNodeBuilder=null,this._textEventPublisher.unsubscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.unsubscribe("styleChange",this.handleTextStyleChangeEvent),await this._textEventPublisher.dispose(),this.isDisposed=!0}get disposed(){return this.isDisposed}refreshNodes(){var e;this._terminalNode&&this._nodePoller&&(this._terminalNode.retire(),this.proofingDom.removeNode(this._terminalNode),this._terminalNode=null===(e=this._terminalNodeBuilder)||void 0===e?void 0:e.createGraphNode({element:this.element}),this._terminalNode&&this.proofingDom.addNode(this._terminalNode))}}},386675:(e,t,i)=>{i.d(t,{S:()=>n});const n=(0,i(668952).f)("IRegistrable")},387985:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(379490),s=i(630501),o=i(229906);let r=class extends s.z{constructor(){super(...arguments),this.footerProps=new Map}publishStateChange(){this.publishEvent("stateUpdated",{footerProps:this.footerProps})}setFooterDisplay(e,t){const i=this.footerProps.get(e);i&&(this.footerProps.set(e,Object.assign(Object.assign({},i),{display:t})),this.publishStateChange())}setFooterAnimated(e,t){const i=this.footerProps.get(e);i&&(this.footerProps.set(e,Object.assign(Object.assign({},i),{animated:t})),this.publishStateChange())}addFooterPage(e,t,i){var n;const s=null!==(n=this.footerProps.get(e))&&void 0!==n?n:{display:!0,pages:new Map,animated:!0};s.pages.set(t,i),s.display=!0,this.footerProps.set(e,s),this.publishStateChange()}removeFooterPage(e,t){const i=this.footerProps.get(e);i&&(i.pages.delete(t),0===i.pages.size&&(i.display=!1),this.footerProps.set(e,i),this.publishStateChange())}};r=(0,n.__decorate)([(0,o._)()],r)},389971:(e,t,i)=>{if(i.d(t,{HA:()=>m,HC:()=>g,I3:()=>u,Pj:()=>p,jv:()=>c,u6:()=>h}),0!=i.j)var n=i(551134);if(0!=i.j)var s=i(229270);if(0!=i.j)var o=i(824088);if(0!=i.j)var r=i(673989);if(0!=i.j)var a=i(283429);var l=i(208520);function d(e){return e.emailAddresses&&0!==e.emailAddresses.length?`https://microsoft.sharepoint-df.com/_layouts/15/UserPhoto.aspx?size=m&accountName=${e.emailAddresses[0]}&default=none`:""}function c(e){return l.createElement(r.e,{size:32,name:e.name,image:{src:d(e)},color:"colorful"})}function u(e){return l.createElement("img",{src:(0,a.V)({extension:e.fileExtension,size:24}),alt:""})}function g(){return l.createElement(n.GOF,null)}function h(e){return e.hasRecording?l.createElement(n.e2F,null):e.isSeries?l.createElement(n.Sn0,null):l.createElement(n.TeR,null)}function p(){return l.createElement(s.rpW,null)}function m(e){return e.isGetAgents?l.createElement(o.Y8t,null):l.createElement("img",{src:e.iconUrl,height:32,width:32,alt:""})}},392632:(e,t,i)=>{function n(e,t){var i;return!!e&&!0===(null===(i=e.find((e=>e.entityType===t)))||void 0===i?void 0:i.enabled)}function s(e,t){var i;if(e)return null===(i=e.find((e=>e.entityType===t)))||void 0===i?void 0:i.maxResults}function o(e,t,i,s){return!!(null!=e?e:[]).includes(s)||n(t,i)}i.d(t,{Z$:()=>s,f1:()=>o,i$:()=>n})},395109:(e,t,i)=>{i.d(t,{A:()=>n});const n=(0,i(668952).f)("ISquiggleTooltipStateStore")},395353:(e,t,i)=>{var n;i.d(t,{j:()=>n}),function(e){e.DefaultOutlineNodeObserver="DefaultOutlineNodeObserver",e.TerminalNodeObserver="TerminalNodeObserver",e.InputNodeObserver="InputNodeObserver",e.AttributeObserver="AttributeObserver"}(n||(n={}))},396200:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Drejtshkrimi"}}')},398746:(e,t,i)=>{i.d(t,{T:()=>r});var n=i(863307),s=i(590413),o=i(93469);class r{constructor(e,t){this.params=e,this.targetElement=t,this._initialized=!1,this._disposed=!1}get additionalActivationCharacters(){var e;return null!==(e=this.params.additionalActivationCharacters)&&void 0!==e?e:[]}get textInputActivationDelay(){return this.params.textInputActivationDelay||r.defaultIntentDetectionTypingDelay}get activateIntentDetectionCallback(){if(!this._activateIntentDetectionCallback)throw new Error("Intent detection callback is not initialized");return this._activateIntentDetectionCallback}get initialized(){return this._initialized}get disposed(){return this._disposed}init(e){this._activateIntentDetectionCallback=e,this._initialized=!0}dispose(){this.clearCallbacksAndTimeouts(),this._initialized=!1,this._disposed=!0}clearCallbacksAndTimeouts(){var e;this.activationTimeout&&(null===(e=(0,s.S9)(this.targetElement))||void 0===e||e.clearTimeout(this.activationTimeout),this.activationTimeout=void 0),this._activateIntentDetectionCallback=void 0}processText(e){var t,i;if(!this.initialized)throw new Error("Intent detection activator is not initialized");const r=(0,o.ZX)(e),a=(0,n._v)();a.debug(505246867,"processText called",r),this.activationTimeout&&(null===(t=(0,s.S9)(this.targetElement))||void 0===t||t.clearTimeout(this.activationTimeout)),e.length&&(0===e[e.length-1].trim().length||this.additionalActivationCharacters.includes(e[e.length-1]))?(a.debug(505246866,"Intent detection triggered by activation character",r),this.activateIntentDetectionCallback(e)):this.textInputActivationDelay>0&&(this.activationTimeout=null===(i=(0,s.S9)(this.targetElement))||void 0===i?void 0:i.setTimeout((()=>{a.debug(505246865,"Intent detection triggered by timeout",r),this.activateIntentDetectionCallback(e)}),this.textInputActivationDelay))}}r.defaultIntentDetectionTypingDelay=500},398898:(e,t,i)=>{if(i.d(t,{w:()=>r}),0!=i.j)var n=i(177822);if(0!=i.j)var s=i(772185);if(0!=i.j)var o=i(251439);class r{constructor(){this.imports=[s.N,n.J]}get uniqueId(){return(0,o.z)(50786e4)}configureRootServices(e){}}},399795:(e,t,i)=>{i.d(t,{Z:()=>a});var n=i(208520);if(0!=i.j)var s=i(576516);if(0!=i.j)var o=i(660458);if(0!=i.j)var r=i(786132);const a=(e,t,i)=>{const a=n.useRef(),l=n.useRef(),d=n.useRef(new o.c({enableClearingOfRequestedAnimationFrames:!0})),c=n.useCallback((()=>{a.current&&(a.current.remove(),a.current=void 0),l.current?(l.current.removeAttribute("aria-activedescendant"),l.current.removeAttribute("aria-controls"),l.current.removeAttribute("aria-owns"),l.current=void 0):(null==e||e.removeAttribute("aria-activedescendant"),null==e||e.removeAttribute("aria-controls"),null==e||e.removeAttribute("aria-owns"))}),[e]),u=n.useCallback(((e,t)=>{d.current.requestAnimationFrame((()=>{var n,s;const o=e.getRootNode(),l=e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`);if(!(null==l?void 0:l.ariaLabel)||!(0,r.C)(o,"ShadowRoot"))return;if(null==i?void 0:i.enableExpandedECCAccessibilityElement){if(a.current)a.current.removeAttribute("aria-label"),a.current.removeAttribute("role");else{a.current=e.ownerDocument.createElement("div"),a.current.setAttribute("role","listBox");const t=e.ownerDocument.querySelector("#inlineSuggestionsEnclosingDiv");a.current.setAttribute("aria-label",(null==t?void 0:t.getAttribute("aria-label"))||"")}a.current.style.cssText="width: 0; height: 0; overflow: hidden;"}a.current||(a.current=e.ownerDocument.createElement("div"),a.current.setAttribute("role","listbox"),a.current.style.cssText="width: 0; height: 0; overflow: hidden;");const d=e.ownerDocument.createElement("button");(null==i?void 0:i.enableExpandedECCAccessibilityElement)?(d.setAttribute("role",l.getAttribute("role")||"option"),d.setAttribute("type",l.getAttribute("type")||"button"),d.id=t.focusedItemHtmlId,d.innerText=l.ariaLabel,d.ariaLabel=l.ariaLabel,l.id.includes("header")||l.id.includes("overflow")?(a.current.setAttribute("aria-label","tablist"),d.ariaPosInSet=String(Number(l.id.substring(l.id.length-1,l.id.length))+1),d.ariaSetSize=String(null===(s=null===(n=l.parentElement)||void 0===n?void 0:n.parentElement)||void 0===s?void 0:s.children.length),d.ariaSelected=l.getAttribute("aria-selected")):(d.ariaPosInSet=l.ariaPosInSet,d.ariaSetSize=l.ariaSetSize,d.ariaSelected="true")):(d.setAttribute("role","option"),d.setAttribute("type","button"),d.id=t.focusedItemHtmlId,d.innerText=l.ariaLabel,d.ariaLabel=l.ariaLabel,d.ariaPosInSet=l.ariaPosInSet,d.ariaSetSize=l.ariaSetSize,d.ariaSelected="true"),a.current.children.length&&a.current.children[0].remove(),a.current.appendChild(d),o.appendChild(a.current)}))}),[null==i?void 0:i.enableExpandedECCAccessibilityElement]),g=n.useCallback((t=>{d.current.requestAnimationFrame((()=>{var i;const n=null==e?void 0:e.ownerDocument.querySelector(`#${t.focusedItemHtmlId}`),o=(null===(i=t.selection)||void 0===i?void 0:i.type)===s.c.Scope.toLowerCase();n&&o&&(t.selection&&"scope"in t.selection&&t.selection.scope.isSelected?n.ariaSelected="true":n.ariaSelected="false")}))}),[e]),h=n.useCallback((n=>{if(n.focusedItemHtmlId){if(!e)return;t&&g(n),(null==i?void 0:i.enableDetachedAccessibilityElementForEcc)&&u(e,n),e.setAttribute("aria-activedescendant",n.focusedItemHtmlId),e.setAttribute("aria-controls",n.focusedItemHtmlId),e.setAttribute("aria-owns",n.focusedItemHtmlId),l.current=e}else c()}),[i,t,u,g,e,c]);return n.useEffect((()=>()=>{c()}),[c]),h}},400377:(e,t,i)=>{if(i.d(t,{A:()=>s}),0!=i.j)var n=i(852853);const s=e=>{var t,i,s,o,r,a,l;return`\n  .ms-text-prediction {\n    color: ${null==e?void 0:e.text};\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-ghost-text {\n    color: ${null!==(t=null==e?void 0:e.text)&&void 0!==t?t:n.L.colorNeutralForeground4};\n    position: relative;\n    user-select: none;\n    background: ${null!==(i=null==e?void 0:e.highlightColor)&&void 0!==i?i:n.L.colorNeutralBackground5};\n  }\n\n  .ms-entity-prediction {\n    position: relative;\n    user-select: none;\n  }\n\n  .ms-entity-prediction-wrapper {\n    background: ${null!==(s=null==e?void 0:e.background.resting)&&void 0!==s?s:n.L.colorNeutralBackground3};\n    color: ${null!==(o=null==e?void 0:e.entityText.resting)&&void 0!==o?o:n.L.colorNeutralForeground4};\n    border-radius: 4px;\n    padding: 0px 4px;\n    gap: 4px;\n    user-select: none;\n    display: inline-flex;\n    pointer-events: all;\n    cursor: pointer;\n  }\n\n  .ms-entity-prediction-wrapper:hover {\n    background: ${null!==(r=null==e?void 0:e.background.hover)&&void 0!==r?r:n.L.colorNeutralBackground3Hover};\n    color: ${null==e?void 0:e.entityText.hover};\n  }\n\n  .ms-prediction-tab-hint {\n    align-content: center;\n    border-color: ${null!==(a=null==e?void 0:e.tabBorder)&&void 0!==a?a:null==e?void 0:e.text};\n    border-radius: 2px;\n    border-style: solid;\n    border-width: 1px;\n    box-sizing: border-box;\n    color: ${null!==(l=null==e?void 0:e.tabText)&&void 0!==l?l:n.L.colorNeutralForeground4};\n    display: inline-grid;\n    font-size: 0.630em;\n    height: 1.5em;\n    margin-left: 4px;\n    padding: 1px 4px;\n    position: relative;\n    vertical-align: 10%;\n    white-space: nowrap;\n    width: 2.5em;\n  }\n\n  .ms-entity-prediction-icon {\n    align-self: center\n  }\n\n  .ms-entity-prediction-dropdown {\n    align-self: center\n  }\n  `}},401322:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(668952).f)("IQueryDetection")},402817:(e,t,i)=>{if(i.d(t,{B:()=>l}),0!=i.j)var n=i(387985);if(0!=i.j)var s=i(522775);if(0!=i.j)var o=i(305507);if(0!=i.j)var r=i(268809);if(0!=i.j)var a=i(251439);class l{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918212)}configureRootServices(e){e.bind(s.D).to(n.o),e.bind(o.j).to(r.S)}}},404741:(e,t,i)=>{var n;i.d(t,{s:()=>n}),function(e){e.UnhandledContentError="RunTimeErrors.UnhandledContentError",e.UnhandledBackgroundError="RunTimeErrors.UnhandledBackgroundError",e.UnhandledOptionsPageError="RunTimeErrors.UnhandledOptionsPageError"}(n||(n={}))},404983:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(668952).f)("ISessionContextProvider")},405658:(e,t,i)=>{var n;i.d(t,{l:()=>n}),function(e){e.AppId="appId",e.EnableCopilotInsert="enableCopilotInsert",e.EnableCopilotRewrite="enableCopilotRewrite",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.EnableSynonymsToggle="enableSynonymsToggle",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.HashedUserDictionary="hashedUserDictionary",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.OverriddenInlineEditingSettings="overriddenInlineEditingSettings",e.PaneOverriddenCritiqueTypeOptions="paneOverriddenCritiqueTypeOptions",e.StealthOverriddenCritiqueTypeOptions="stealthOverriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.DefaultLoggingLevel="defaultLoggingLevel",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId",e.CritiqueValuePerLanguage="critiqueValuePerLanguage",e.EnableTextPrediction="enableTextPrediction",e.EnableCIQFlags="enableCIQFlags",e.EnableCIQMenu="enableCIQMenu",e.IsLanguageAutoDetectEnabled="isLanguageAutoDetectEnabled",e.TonalFREAccepted="tonalFREAccepted"}(n||(n={}))},408285:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"അക്ഷരവിന്യാസം","IsImplemented":true}}')},411180:(e,t,i)=>{i.d(t,{y:()=>n});const n="ms-squiggle-tooltip"},411995:(e,t,i)=>{if(i.d(t,{OE:()=>a,r3:()=>l}),0!=i.j)var n=i(379490);if(0!=i.j)var s=i(665014);if(0!=i.j)var o=i(766535);if(0!=i.j)var r=i(367409);function a(e){const{annotationId:t,typeId:i,traceId:a,sourceData:l,priority:d,supportedActions:c,suggestions:u,textInContext:g,start:h,length:p,metadata:m,nodeId:f,tileId:v,categoryTitle:y,isStealth:_,endNode:I,explanationTitle:C,explanationLabel:S,explanation:b,shouldShowMultilingualFre:T,languageId:E,shouldAttemptLanguageDetection:N}=e,w=(0,n.__rest)(e,["annotationId","typeId","traceId","sourceData","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign({annotationId:t,typeId:(0,o.e3)(i),typeIdRaw:i,traceId:a,sourceData:l,priority:d,supportedActions:(0,s.z)(c),suggestions:u.map(r.S),textInContext:g,start:h,length:p,metadata:m,nodeId:f,tileId:v,categoryTitle:y,isStealth:_,endNode:I,explanationTitle:C,explanationLabel:S,explanation:b,shouldShowMultilingualFre:T,languageId:E,shouldAttemptLanguageDetection:N},w)}function l(e){return"isFlagCritique"in e}},412694:(e,t,i)=>{function n(e,t){return!(!e||!t)&&(e.offset===t.offset+t.span||t.offset===e.offset+e.span)}function s(e,t){return!(!e||!t)&&!(e.offset>=t.offset+t.span||t.offset>=e.offset+e.span)}i.d(t,{D:()=>s,M:()=>n})},413612:(e,t,i)=>{if(i.d(t,{r:()=>h}),0!=i.j)var n=i(163573);if(0!=i.j)var s=i(331408);if(0!=i.j)var o=i(251439);if(0!=i.j)var r=i(278301);if(0!=i.j)var a=i(481347);if(0!=i.j)var l=i(321889);if(0!=i.j)var d=i(106623);if(0!=i.j)var c=i(665238);if(0!=i.j)var u=i(883984);if(0!=i.j)var g=i(493434);class h{get uniqueId(){return(0,o.z)(507781790)}configureRootServices(e){var t,i;const o=e.get(n.n);(null===(i=null===(t=o.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.enabled)&&((0,l.iO)(o)&&p(e,s.L9.CIQFlag_DateEntityRecognition,"ebx_DateEntityRecognitionCategoryTitle"),(0,d.U)(o)&&p(e,s.L9.CIQFlag_File,"ebx_CIQFlagFileTooltipTitle"),(0,c.p)(o)&&p(e,s.L9.CIQFlag_PersonEntityRecognition,"ebx_PersonEntityRecognitionCategoryTitle"),(0,u.f)(o)&&p(e,s.L9.CIQFlag_Time,"ebx_CIQFlagTimeCategoryTitle"),(0,g.f)(o)&&p(e,s.L9.CIQFlag_Topic,"ebx_CIQFlagTopicCategoryTitle"))}}function p(e,t,i){e.bind(r.U).toValue((e=>({id:t,name:(0,a.kd)(i,e)})))}},413835:(e,t,i)=>{function n(e,t){return t>=e.tileVersion}i.d(t,{d:()=>n})},415301:(e,t,i)=>{i.d(t,{K:()=>m});var n=i(379490),s=i(576516),o=i(537969),r=i(823325),a=i(756857),l=i(163573),d=i(877931),c=i(928452),u=i(753031),g=i(229906),h=i(66008),p=i(83010);let m=class{constructor(e,t,i,n,o){this._hostEmitters=e,this._hostSettings=t,this._logger=i,this._nudgeStore=n,this._localizer=o,this.onNudgeEvent=e=>{if(!e.message.data.tileId)return void this._logger.log(510248464,u.q.Error,"INudge message: Received undefined args.");const t=e.message.data;t.text=this.getNudgeMessage(t.entityType);const i=Object.assign(Object.assign({eventType:e.message.messageType},t),{nudge:t});this.onEvent(i)},this.messagePerEntityType={[s.c.File]:"nudgeTextForFile",[s.c.People]:"nudgeTextForPeople",[s.c.Event]:"nudgeTextForMeetings",[s.c.Message]:"nudgeTextForEmails"}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(o.pD.nudgeTriggered,this.onNudgeEvent)}shutDown(){}async onEvent(e){e.eventType===r.G.NewData?await this._nudgeStore.updateNudge(e.nudge):await this._nudgeStore.clearNudge()}getNudgeMessage(e){var t,i,n;const s=null!==(n=null===(i=null===(t=this._hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===i?void 0:i.insertionCharacter)&&void 0!==n?n:"@";return this._localizer.getMessage(this.messagePerEntityType[e],s)}};m=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,h.t)(o.zJ)),(0,n.__param)(1,(0,p.W)(l.n)),(0,n.__param)(2,(0,p.W)(d.g)),(0,n.__param)(3,(0,p.W)(c.Y)),(0,n.__param)(4,(0,p.W)(a.H))],m)},416697:(e,t,i)=>{if(i.d(t,{B:()=>u}),0!=i.j)var n=i(934116);if(0!=i.j)var s=i(642810);if(0!=i.j)var o=i(900045);if(0!=i.j)var r=i(857132);if(0!=i.j)var a=i(251439);if(0!=i.j)var l=i(386675);if(0!=i.j)var d=i(39952);if(0!=i.j)var c=i(668621);class u{constructor(){this.imports=[s.d,n.w]}get uniqueId(){return(0,a.z)(507918222)}configureRootServices(e){e.bind(o.Y).toSelf(),e.bind(l.S).toExisting(o.Y),e.bind(r.o).to(r.X),e.bind(d.q).to(c.L),e.bind(l.S).toExisting(d.q)}}},420821:(e,t,i)=>{var n,s,o;function r(e){return e?Object.values(s).find((t=>t===e)):void 0}function a(e){const t=new Set([s.CIQFlag_DateEntityRecognition,s.CIQFlag_PersonEntityRecognition,s.CIQFlag_Location,s.CIQFlag_LocalBusiness,s.CIQFlag_TaskRecognition,s.HeadingDetection,s.CIQFlag_Topic,s.CIQFlag_SatoriEntityRecognition,s.CIQFlag_File,s.CIQFlag_Time]);return!!e&&t.has(e)}i.d(t,{$w:()=>o,L9:()=>s,bx:()=>n,e3:()=>r,oe:()=>a}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(n||(n={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec",e.TopicSuggestion="9bf58f9f-4159-40a1-80b8-4fe1f87c010d",e.CIQFlag_Location="1d456e3c-f436-4b8f-a315-1cc430bc2ee1",e.CIQFlag_LocalBusiness="1ECDDA98-C954-9863-87BD-4B0F493558FB",e.CIQFlag_PersonEntityRecognition="ffa21afe-fab3-423c-b579-8de8-128429f1cc8e",e.CIQFlag_DateEntityRecognition="349483fb-b654-4b4c-aefe-9f22bf147cd7",e.CIQFlag_TaskRecognition="c45ba192-bfae-4965-a833-694b55b1bd1d",e.CIQFlag_Topic="21422617-6650-456a-97cd-a7cd3116c39c",e.HeadingDetection="37e3346c-be6a-462c-afd7-282da13f6328",e.CIQFlag_SatoriEntityRecognition="9d9ccfb3-598c-e24c-3cda-11d260ae57d3",e.CIQFlag_File="17f49c82-b9f8-42d0-ab4e-dc076355d77a",e.CIQFlag_Time="9bd06192-906b-4693-99d3-7d58a1cf1770",e.Synonyms="23bd41d4-28ac-4cbc-ba24-2bba684c07da",e.DoubleSpaceGrammar="6d1d8c3d-62d5-45d1-b850-d8a98a24964b"}(s||(s={})),function(e){e.IgnoreOnce="IgnoreOnce",e.IgnoreAll="IgnoreAll",e.ApplySuggestion="ApplySuggestion",e.DisableCritiqueType="DisableCritiqueType",e.ShowFeedback="ShowFeedback"}(o||(o={}))},424817:e=>{e.exports=JSON.parse('{"Simpler Language":{"LocalizedName":"Improves readability","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Sensitive Geopolitical References","IsImplemented":true},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions help make your writing more formal by reducing casual wording."},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Error Corrections"},"Resume":{"IsImplemented":true,"LocalizedName":"Resume"},"Fluency":{"LocalizedName":"Improves flow","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Spelling"},"Inspire Me":{"LocalizedName":"Different phrasing","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":"Different phrasing"},"Punctuation Conventions":{"LocalizedName":"Punctuation Conventions","IsImplemented":true},"Formality":{"IsImplemented":true,"LocalizedName":"Formality"},"Inclusiveness":{"LocalizedName":"Inclusiveness","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"These suggestions provide alternative ways of wording a phrase or sentence.","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":"The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording."},"Conciseness":{"LocalizedName":"Conciseness","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"More concise","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"Consistent Written Forms","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":"Typing Errors"},"RewriteFormality":{"LocalizedName":"More formal","IsImplemented":false},"ConcisenessFullExplanation":{"LocalizedName":"The goal of these suggestions is to express an idea clearly, without extra words.","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulary"},"Rewrite":{"LocalizedName":"Rewrite","IsImplemented":false},"Perspectives":{"LocalizedName":"Perspectives","IsImplemented":true},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling."},"Grammar":{"LocalizedName":"Grammar","IsImplemented":true},"Writing Conventions":{"LocalizedName":"Writing Conventions","IsImplemented":false},"Uncommon Words":{"LocalizedName":"Uncommon Words","IsImplemented":true},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronyms"},"Clarity":{"IsImplemented":true,"LocalizedName":"Clarity"}}')},425811:(e,t,i)=>{i.d(t,{C:()=>s});const n=new(i(87218).P);function s(e){if(!(e instanceof Function))return!1;return!!n.getConstructorMetadata(e).compilerGeneratedMetadata}},427405:(e,t,i)=>{if(i.d(t,{G:()=>s}),0!=i.j)var n=i(797214);class s{constructor(e,t,i,n){this.calloutStateStore=e,this.inlineSuggestionsRenderer=t,this.undoCalloutStateStore=i,this.logger=n}async showFlagCritique(e){var t,i,s,o,r,a;if(!(0,n.r3)(e.critique))return void(null===(t=this.logger)||void 0===t||t.error(0,"Got a critique that is not a flag critique, but expected a flag critique"));if(!e.onApplyFlag)return void(null===(i=this.logger)||void 0===i||i.error(508909201,"Got flag callout display, but no function for onApplyFlag was specified"));if(!this.inlineSuggestionsRenderer)return void(null===(s=this.logger)||void 0===s||s.error(508909200,"Got flag callout display, but no inlineSuggestionRenderer"));await this.inlineSuggestionsRenderer.showFlag(e.critique,e.onApplyFlag,((e,t)=>{var i,n,s;t?null===(i=this.calloutStateStore)||void 0===i||i.hide():null===(n=this.calloutStateStore)||void 0===n||n.clickNoActionHide(e),null===(s=this.undoCalloutStateStore)||void 0===s||s.hide()}),e.onFlagIgnoreOnce,e.onFlagIgnoreAll,e.onDisableFlag,e.onShowFeedback,null===(o=this.calloutStateStore)||void 0===o?void 0:o.navInfo,null===(r=this.calloutStateStore)||void 0===r?void 0:r.navigate),null===(a=this.calloutStateStore)||void 0===a||a.markAsShown(e.critique,e.onDismiss)}}},428799:(e,t,i)=>{if(i.d(t,{N:()=>a}),0!=i.j)var n=i(672933);if(0!=i.j)var s=i(429734);if(0!=i.j)var o=i(251439);if(0!=i.j)var r=i(922630);class a{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918409)}configureRootServices(e){e.bind(n.C).toDynamicValue((e=>{const t=e.get(r.n);return new s.t(t.defaultLocale)}))}}},429712:(e,t,i)=>{i.d(t,{$1:()=>h,Th:()=>g,QV:()=>u});var n=i(379490),s=i(323283),o=i(630501);class r extends o.z{constructor(e){super(),this.featureFlagsReader=e,this.purgeDelay=1e4,this.logPurgeTimeout={},this._politeUpdates=[],this._assertiveUpdates=[],this._status=void 0,this._statusSeverity="off",this.postMessageIfIframe=e=>window.self!==window.top&&(this.featureFlagsReader.flags.enableAriaStatusPostMessage?(window.parent.postMessage(e,"*"),!0):!this.featureFlagsReader.flags.enableAriaStatusInNonRootIFrames),this.reset=(e,t,i)=>{this.postMessageIfIframe({messageType:"msAriaResetMessage",resetStatus:e,resetAssertiveLogs:t,resetPoliteLogs:i})||(e&&(this._status=void 0,this._statusSeverity="off"),t&&(this._assertiveUpdates=[]),i&&(this._politeUpdates=[]),this.publishStateChange())},this.scheduleLogCleanup=e=>{this.cancelScheduledCleanup(e),this.logPurgeTimeout[e]=window.setTimeout((()=>{const t="assertive"===e,i="polite"===e;this.reset(!1,t,i)}),this.purgeDelay)},this.cancelScheduledCleanup=e=>{const t=this.logPurgeTimeout[e];t&&(window.clearTimeout(t),this.logPurgeTimeout[e]=void 0)},this.onMessage=e=>{var t;if(null===(t=e.data)||void 0===t?void 0:t.messageType)if("msAriaSetMessage"===e.data.messageType){const t=e.data;void 0===t.status||"assertive"!==t.severity&&"polite"!==t.severity&&"off"!==t.severity||(Array.isArray(t.status)?this.addPreservedStatuses(t.status,t.severity):this.setStatus(t.status,t.severity,!!t.preserve))}else if("msAriaResetMessage"===e.data.messageType){const t=e.data;void 0!==t.resetAssertiveLogs&&void 0!==t.resetPoliteLogs&&void 0!==t.resetStatus&&this.reset(t.resetStatus,t.resetAssertiveLogs,t.resetPoliteLogs)}}}async initialize(){this.featureFlagsReader.flags.enableAriaStatusPostMessage&&window.self===window.top&&(this.eventListener=new s.J(window),this.eventListener.addListener("message",this.onMessage,{passive:!0,capture:!0}))}shutDown(){var e;null===(e=this.eventListener)||void 0===e||e.removeAllListeners(),this.eventListener=void 0}setStatus(e,t,i=!1){if(!this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:i})){if(i){if("polite"===t||"assertive"===t){const i="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),i.push(e),this.scheduleLogCleanup(t)}}else this._statusSeverity=t,this._status=e;this.publishStateChange()}}addPreservedStatuses(e,t){if(this.postMessageIfIframe({messageType:"msAriaSetMessage",status:e,severity:t,preserve:!0}))return;if("off"===t)return;const i="polite"===t?this._politeUpdates:this._assertiveUpdates;this.cancelScheduledCleanup(t),i.push(...e),this.scheduleLogCleanup(t),this.publishStateChange()}resetAll(){this.reset(!0,!0,!0)}resetPreserved(){this.reset(!1,!0,!0)}resetStatus(){this.reset(!0,!1,!1)}publishStateChange(){this.publishEvent("stateUpdated",{status:this._status,statusSeverity:this._statusSeverity,politeUpdates:this._politeUpdates,assertiveUpdates:this._assertiveUpdates})}}var a=i(494888),l=i(668952),d=i(229906),c=i(83010);const u=(0,l.f)("IAriaStatusStateStore"),g=(0,l.f)("IAriaStatusStateStoreFactory");let h=class extends o.z{constructor(e){super(),this.onStatusUpdated=e=>{this.publishEvent("stateUpdated",e)},this.ariaStatusStateStore=new r(e)}async initialize(){await this.ariaStatusStateStore.initialize(),this.ariaStatusStateStore.subscribe("stateUpdated",this.onStatusUpdated)}shutDown(){this.ariaStatusStateStore.unsubscribe("stateUpdated",this.onStatusUpdated),this.ariaStatusStateStore.shutDown()}setStatus(e,t,i=!1){this.ariaStatusStateStore.setStatus(e,t,i)}addPreservedStatuses(e,t){this.ariaStatusStateStore.addPreservedStatuses(e,t)}resetAll(){this.ariaStatusStateStore.resetAll()}resetPreserved(){this.ariaStatusStateStore.resetPreserved()}resetStatus(){this.ariaStatusStateStore.resetStatus()}};h=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(a.c))],h)},429734:(e,t,i)=>{if(i.d(t,{t:()=>c}),0!=i.j)var n=i(146507);if(0!=i.j)var s=i(456204);if(0!=i.j)var o=i(753031);if(0!=i.j)var r=i(950781);if(0!=i.j)var a=i(652903);if(0!=i.j)var l=i(696767);if(0!=i.j)var d=i(485104);class c{constructor(e,t){this._displayLanguage=e,this._stringProvider=t,this._defaultUiLocale="en-us",this._categoryNameToLocalizedName=new Map,this._localizationTableFallbackMapping=(0,d.mO)(),this._localizedNameToCategoryName=new Map,this._nonEditorCategories=new Set([r.s.Perspectives,r.s.TonalRewrite]),this.uiLocale="",this.isCategorySupportedInCurrentUiLanguage=e=>!!this._categoriesForUILocale&&(e in this._categoriesForUILocale&&this._categoriesForUILocale[e].IsImplemented),this.setUiLocale(this._displayLanguage)}async setUiLocale(e){const t=e;this.uiLocale=t?t.toLowerCase():this._defaultUiLocale;const i=this._localizationTableFallbackMapping.get(this.uiLocale);if(i&&(this.uiLocale=i),this._categoriesForUILocale=await(0,a.oZ)(this.uiLocale),!this._categoriesForUILocale)throw Error(`Failed to load categories strings from localization file dynamically: ${this.uiLocale}`);this.cacheLocalizedCategories(this.uiLocale.toLowerCase(),this._categoriesForUILocale)}cacheLocalizedCategories(e,t){for(const i of Object.keys(t))this.cacheCategoryNames(i,t[i].LocalizedName,e)}get NonEditorCategories(){return this._nonEditorCategories}categoryNameToLocale(e,t){var i;const r=t.toLowerCase(),a=null===(i=this._categoryNameToLocalizedName.get(e))||void 0===i?void 0:i.get(r);if(a)return a;if(this._nonEditorCategories.has(e)){const t=this.localizeNonEditorCategoryNameToUiLocale(e);return this.cacheCategoryNames(e,t,r),t}return(0,n.C)().logEvent(505250199,"CategoryLocalizationNotFoundInLocalizationTable",s.h.Host,o.q.Error,{category:e,language:r}),e}toUiLocale(e){return this.categoryNameToLocale(e,this.uiLocale)}async localizedNameToStandardizedName(e,t){if(t===r.s.Spelling||t===r.s.Grammar||this.NonEditorCategories.has(t))return t;const i=this._localizedNameToCategoryName.get(t);if(i)return i;const n=await(0,a.oZ)(null!=e?e:this.uiLocale);if(n){const i=Object.keys(n).find((e=>{const i=n[e];return i&&i.LocalizedName===t}));if(i)return this.cacheCategoryNames(i,t,null!=e?e:this.uiLocale),i}const s=this.mapNonEditorCategoryNameToStandardizedName(t);return s?(this.cacheCategoryNames(s,t,this.uiLocale),s):t}cacheCategoryNames(e,t,i){const n=this._categoryNameToLocalizedName.get(e),s=null==n?void 0:n.get(i),o=this._localizedNameToCategoryName.get(t);if(!s)if(n)n.set(i,t);else{const n=new Map;n.set(i,t),this._categoryNameToLocalizedName.set(e,n)}o||this._localizedNameToCategoryName.set(t,e)}localizeNonEditorCategoryNameToUiLocale(e){var t;const i=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,n=i.getString.bind(i);switch(e){case r.s.Perspectives:return n("CritiqueCategoryStrings","Perspectives");case r.s.TonalRewrite:return n("CritiqueCategoryStrings","TonalRewrite");default:return e}}mapNonEditorCategoryNameToStandardizedName(e){var t;const i=null!==(t=(0,l.$)())&&void 0!==t?t:this._stringProvider,n=i.getString.bind(i);switch(e){case n("CritiqueCategoryStrings","Perspectives"):return r.s.Perspectives;case n("CritiqueCategoryStrings","TonalRewrite"):return r.s.TonalRewrite;default:return e}}}},432648:(e,t,i)=>{i.d(t,{x:()=>a});var n=i(379490),s=i(229906),o=i(445801),r=i(553164);let a=class extends o.W{constructor(e,t,i,n){super(r.Z.TerminalNode,e,void 0,t,i,n),this._observer=e,this.retiredCallbacks=[],this.visualizationRemovedCallbacks=[],this.element&&this._observer.observe(this.element)}retire(){for(const e of this.retiredCallbacks)e();this.retiredCallbacks=[],this.visualizationWasRemoved(),super.retire()}move(e,t){if(super.move(e,t),this.children)for(const t of this.children)t.move(e);return this.element&&this._observer.observe(this.element),this}resetState(){}registerRetireCallback(e){this.retiredCallbacks.push(e)}registerVisualizationRemovedCallback(e){this.visualizationRemovedCallbacks.push(e)}visualizationWasRemoved(){for(const e of this.visualizationRemovedCallbacks)e();this.visualizationRemovedCallbacks=[]}};a=(0,n.__decorate)([(0,s._)()],a)},433531:(e,t,i)=>{if(i.d(t,{g:()=>l}),0!=i.j)var n=i(7325);if(0!=i.j)var s=i(853148);if(0!=i.j)var o=i(251439);if(0!=i.j)var r=i(937126);if(0!=i.j)var a=i(435225);class l{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918406)}configureRootServices(e){e.bind(r.f).to(a.E),e.bind(s.o).to(n.v)}}},433858:(e,t,i)=>{function n(e,t){return!(!e||!t)&&(e.start===t.start&&e.length===t.length&&e.priority===t.priority&&e.textInContext===t.textInContext&&e.nodeId===t.nodeId)}function s(e,t){return!(e.start>=t.start+t.length||t.start>=e.start+e.length)}i.d(t,{PD:()=>o,gS:()=>n,tw:()=>s});function o(e){const t=new Map;for(const i of e){if(!i.tileId)continue;const e=t.get(i.tileId.nodeId);e?e.push(i):t.set(i.tileId.nodeId,[i])}return t}},434340:(e,t,i)=>{i.d(t,{H:()=>m});var n=i(379490),s=i(420821),o=i(105244),r=i(233653),a=i(111791),l=i(229906),d=i(83010),c=i(427603),u=i(78827),g=i(281795),h=i(855095),p=i(761799);let m=class{constructor(e,t,i,n,s,o){this._enabledCritiqueTypes=e,this._paneEnabledCritiqueTypes=t,this._paneOpenState=i,this._proofingPersistedStore=n,this._upsellStore=s,this._indicatorStore=o}filter(e){return this.addCritiqueToIndicatorMapIfNeeded(e),void 0!==e.typeId&&this.isCritiqueCategoryEnabled(e.priority)&&this.isCritiqueTypeEnabled(e.typeId,e.priority)||e.typeId===s.L9.TopicSuggestion}isCritiqueCategoryEnabled(e){var t;return e===s.bx.High&&!!this._proofingPersistedStore.getCachedEntry(o.l.EnableSpelling).storeEntryValue||e===s.bx.Medium&&!!this._proofingPersistedStore.getCachedEntry(o.l.EnableGrammar).storeEntryValue||e===s.bx.Low&&((null===(t=this._upsellStore)||void 0===t?void 0:t.previewPremiumSquiggles)||!!this._proofingPersistedStore.getCachedEntry(o.l.EnableRefinements).storeEntryValue)||e===s.bx.Informational}isCritiqueTypeEnabled(e,t){var i,n;const s=void 0!==this._paneOpenState,o=s&&(null===(i=this._paneOpenState)||void 0===i?void 0:i.isPaneOpen)&&(null===(n=this._paneEnabledCritiqueTypes)||void 0===n?void 0:n.isCritiqueTypeEnabled(e,t));return this._enabledCritiqueTypes.isCritiqueTypeEnabled(e,t)||o||!!this._upsellStore&&(!s||this._upsellStore.previewPremiumSquiggles)&&this._enabledCritiqueTypes.isCritiqueTypePremium(e)}addCritiqueToIndicatorMapIfNeeded(e){var t,i;if(!(e.typeId&&e.traceId&&this._paneEnabledCritiqueTypes&&this._indicatorStore))return;const n=e.priority===s.bx.Low,o=this.isCritiqueCategoryEnabled(e.priority)||(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser)&&n,r=this._paneEnabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority),a=this._enabledCritiqueTypes.isCritiqueTypeEnabled(e.typeId,e.priority);let l=!0;e.typeId!==s.L9.TopicSuggestion&&e.typeId!==s.L9.CIQFlag_Topic||(l=e.isVisible),o&&(r||a)&&l&&this._indicatorStore.addPaneCritique(e.traceId,n,e.categoryTitle,r&&!a&&!(null===(i=this._paneOpenState)||void 0===i?void 0:i.isPaneOpen))}};m=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.g)),(0,n.__param)(1,(0,c.l)()),(0,n.__param)(1,(0,d.W)(h.M)),(0,n.__param)(2,(0,c.l)()),(0,n.__param)(2,(0,d.W)(a.F)),(0,n.__param)(3,(0,d.W)(r.K)),(0,n.__param)(4,(0,c.l)()),(0,n.__param)(4,(0,d.W)(p.Ey)),(0,n.__param)(5,(0,c.l)()),(0,n.__param)(5,(0,d.W)(g.y))],m)},435143:(e,t,i)=>{i.d(t,{w:()=>a});var n=i(379490),s=i(229906),o=i(66008),r=i(386675);let a=class{constructor(e){this.registrables=e,this.initializeCalled=!1,this.shutDownCalled=!1}async initialize(){var e;if(!this.initializeCalled){this.initializeCalled=!0;for(const e of this.registrables)await e.initialize();for(const t of this.registrables)await(null===(e=t.servicesInitialized)||void 0===e?void 0:e.call(t));this.shutDownCalled=!1}}shutDown(){if(!this.shutDownCalled){this.shutDownCalled=!0;for(const e of this.registrables)e.shutDown()}}async addRegistrable(e){var t;await e.initialize(),await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e)),this.registrables.push(e)}async recheckRegistrables(e){var t;const i=e.getAll(r.S),n=[];for(const e of i)this.registrables.includes(e)||(await e.initialize(),this.registrables.push(e),n.push(e));for(const e of n)await(null===(t=e.servicesInitialized)||void 0===t?void 0:t.call(e))}};a=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.t)(r.S))],a)},435153:(e,t,i)=>{if(i.d(t,{M:()=>p}),0!=i.j)var n=i(174077);if(0!=i.j)var s=i(119427);if(0!=i.j)var o=i(853148);if(0!=i.j)var r=i(904196);if(0!=i.j)var a=i(383714);if(0!=i.j)var l=i(757439);if(0!=i.j)var d=i(108993);if(0!=i.j)var c=i(251439);if(0!=i.j)var u=i(852278);if(0!=i.j)var g=i(150231);const h=(0,i(668952).f)("IClientRuntime");class p{constructor(){this.imports=[l.E]}get uniqueId(){return(0,c.z)(507918289)}configureRootServices(e){var t;const i=e.get(r.n);(null===(t=i.orchestratorSettings)||void 0===t?void 0:t.enableAugLoop)&&i.orchestratorSettings.augLoopEndpoint&&(e.bind(h).toDynamicValue((()=>(0,u.xB)())),e.bind(n.a).toDynamicValue((e=>(t,i)=>{const n=e.get(r.n),l=e.get(o.o),c=e.get(d.qy),u=e.get(a.g),p=e.getOptional(s.v),m=e.get(h),f=(0,g.nv)(n,l,c,u,m,p),v=e.getAll(g.cl);return f.withHostCallbacksCustomizations(v),f.build(t,i)})))}}},435225:(e,t,i)=>{i.d(t,{E:()=>T});var n=i(379490),s=i(355495);const o="IsPaneOpen",r="IsPaneOpenedInSession";var a,l,d=i(537969),c=i(111791),u=i(496814),g=i(222145),h=i(766535),p=i(411995),m=i(380422),f=i(226331),v=i(383714),y=i(46692),_=i(700509),I=i(229906),C=i(83010),S=i(427603);!function(e){e.InstrumentationCall="InstrumentationCall"}(a||(a={})),function(e){e.TileIdParseException="RunTimeErrors.TileIdParseException",e.InvalidTileFormat="RunTimeErrors.InvalidTileFormat"}(l||(l={}));var b=i(853148);let T=class{constructor(e,t,i,n,s){this._hostEmitter=e,this._proofingStore=t,this._descriptorManager=i,this._logger=n,this._paneOpenState=s}async process(e){const t=await this.getRequest(e);return!!t&&(this.emitInstrumentationRequest(t,e),this.logActivity(t),!0)}async getRequest(e){if(e.critique.traceId&&e.critique.typeId&&e.critique.textInContext)return{appId:await this._proofingStore.read(u.l.AppId),descriptors:await this._descriptorManager.buildDescriptors(),languageId:s.z.getDefaultLanguageCode(await this._proofingStore.read(u.l.ProofingLanguages)),traceId:e.critique.traceId,critiquePriority:e.critique.priority,critiqueTypeId:e.critique.typeId,eventId:e.eventId,flaggedText:e.critique.textInContext,suggestions:e.critique.suggestions.map((e=>e.text)),suggestionText:this.getSuggestionText(e),metadata:this.getMetadata(e),substrateEventCustomFields:e.customProperties}}getSuggestionText(e){const t=e.critique.suggestions.map((e=>e.text));let i=t[e.eventId-4];return e.eventId!==_.xp.Autoreplace&&e.eventId!==_.xp.AutoreplaceUndo||(i=t[0]),e.eventId>=_.xp.ChangeAllSugg0&&e.eventId<=_.xp.ChangeAllSugg2&&(i=t[e.eventId-8]),i}getMetadata(e){var t,i;const n=null!==(i=null===(t=e.critique.metadata)||void 0===t?void 0:t.slice())&&void 0!==i?i:[];this._paneOpenState&&n.push({name:o,value:String(this._paneOpenState.isPaneOpen)},{name:r,value:String(this._paneOpenState.isPaneOpenedInSession)});const s=this._proofingStore.getCachedEntry(u.l.ProofingLanguages).storeEntryValue;return n.push({name:g.o.NumProofingLanguages,value:String(s.length)}),n}emitInstrumentationRequest(e,t){e.critiqueTypeId===h.L9.TopicSuggestion||(0,p.r3)(t.critique)||this._hostEmitter.emit(d.pD.instrumentationRequestV1,{address:void 0,message:e})}logActivity(e){const t=this._logger.getNewActivity(a.InstrumentationCall,y.o.SamplingPolicy.Measure),i=e.substrateEventCustomFields&&"true"===e.substrateEventCustomFields.isPersonalized||!1;t&&(t.dataFields.push(...(0,m.W)(["EventID",e.eventId],["CritiquePriority",e.critiquePriority],["CritiqueTypeId",e.critiqueTypeId],["IsPersonalizedEvent",i])),t.success=!0,t.endNow())}};T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.W)(d.M5)),(0,n.__param)(1,(0,C.W)(f.K)),(0,n.__param)(2,(0,C.W)(b.o)),(0,n.__param)(3,(0,C.W)(v.g)),(0,n.__param)(4,(0,S.l)()),(0,n.__param)(4,(0,C.W)(c.F))],T)},436672:(e,t,i)=>{i.d(t,{t:()=>o});var n=i(379490),s=i(229906);let o=class{constructor(e){this._userInfoStrategy=e}check(){return this._userInfoStrategy.execute(!1,(e=>(this.setUserInfo(e),e))),this.checkUserInfo()}setUserInfo(e){e&&(this.licenseType=e.licenseType,this.identityProvider=e.identityProvider,this.ageGroup=e.ageGroup,this.ctry=e.ctry),this.isLoggedIn=!!e}};o=(0,n.__decorate)([(0,s._)()],o)},438343:(e,t,i)=>{i.d(t,{m:()=>n});const n=(0,i(668952).f)("IAutoCorrectionBroker")},439550:(e,t,i)=>{i.d(t,{D:()=>o});var n,s=i(668952);!function(e){e.LocalStorageApi="LocalStorageApi"}(n||(n={}));const o=(0,s.f)("IBrowserStorageApi")},442316:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(668952).f)("ILogger")},444108:(e,t,i)=>{i.d(t,{F:()=>g});var n=i(656288),s=i(980703),o=i(782139),r=i(627282),a=i(93469);class l extends r.k{constructor(e,t){super(e,t),this.triggerKeyToEntitySourcePriority=new Map,this.buildEntitySourcePriorityMap()}createInitialState({logicalId:e,triggerKey:t}){const i=this.triggerKeyToEntitySourcePriority.get(t);if(!i)throw new Error(`Unable to get entity source priority map for triggerKey: ${t}`);const n=new Map;for(const[e,t]of i){const i=t.map((({source:e})=>({source:e,resolutionStatus:"Pending",entities:[]})));n.set(e,i)}return{currentDataSourceResponses:[],failedSources:[],pendingDataSourcesCount:0,entityTypeResolutionMatrix:n,lastPublishedStatus:"Error",lastPublishedSuggestions:[],logicalId:e}}onDataSourceResolved(e,t){const{sourceName:i}=t;this.markResolutionMatrixOnDataSourceResolve(t),this.queryResolutionMatrixForPublish(e,i)}onDataSourceRejected(e,t){this.markResolutionMatrixOnDataSourceReject(t),this.queryResolutionMatrixForPublish(e)}markResolutionMatrixOnDataSourceResolve({sourceName:e,suggestionGroups:t}){var i,n;const{entityTypeResolutionMatrix:s}=this.currentState;if(0===t.length)for(const[,t]of s){const i=t.find((t=>t.source===e));i&&(i.resolutionStatus="ResolvedEmptySuggestions")}else for(const[o,r]of s){const s=r.find((t=>t.source===e));if(!s)continue;const a=null!==(n=null===(i=t.find((e=>e.entityType===o)))||void 0===i?void 0:i.entities)&&void 0!==n?n:[];s.resolutionStatus=a.length>0?"Resolved":"ResolvedEmptySuggestions",s.entities=a}}markResolutionMatrixOnDataSourceReject(e){const{entityTypeResolutionMatrix:t}=this.currentState;for(const[,i]of t){const t=i.find((t=>t.source===e));t&&(t.resolutionStatus="Rejected")}}queryResolutionMatrixForPublish({logicalId:e},t=""){const i=this.currentState,{pendingDataSourcesCount:n,currentDataSourceResponses:s,failedSources:o,entityTypeResolutionMatrix:r}=this.currentState;if(0===n&&(0===s.length||s.every((e=>0===e.suggestionGroups.length))))return void this.publishRankingEvent(e,0===o.length?"Complete":"Error",t,[]);let a="Complete";const l=[];for(const[e,t]of r){const i=t.find((e=>"Resolved"===e.resolutionStatus));if(!i){n>0&&(a="PartiallyLoaded");continue}t.find((e=>t.indexOf(e)<t.indexOf(i)&&"Pending"===e.resolutionStatus))?a="PartiallyLoaded":l.push({entityType:e,entities:i.entities})}0===l.length&&n>0||i.lastPublishedStatus===a&&l.every((e=>i.lastPublishedSuggestions.some((t=>e.entityType===t.entityType))))&&l.length>0||(i.lastPublishedStatus=a,i.lastPublishedSuggestions=l,this.publishRankingEvent(e,a,t,l))}buildEntitySourcePriorityMap(){for(const e of this.hostAppCiqConfig.triggerConfigs){const t=new Map,i=this.rankerConfig.datasourcePriorities;for(const{entityType:n,sources:s}of e.entityTypes){const e=s.slice().sort(((e,t)=>{const n=i.indexOf(e),s=i.indexOf(t);return(-1===n?1/0:n)-(-1===s?1/0:s)})).map((e=>({source:e})));t.set(n,e)}this.triggerKeyToEntitySourcePriority.set((0,a.DH)(e.trigger),t)}}}var d=i(333539);const c={MergingRanker:(e,t)=>new o.D(e,t),DataSourcePriorityRanker:(e,t)=>new l(e,t)};function u({enabled:e,intentCache:t,intentDetectorSources:i,invocationStrategy:n,rankStrategy:s}){return e?new d.j({intentDetectorSources:i,intentCache:t,invocationStrategy:n,rankStrategy:s}):void 0}async function g({bootstrapConfig:e,dataSources:t}){const i=await async function(e,t=[]){const{hostAppCiqConfig:i,rankerSetup:s,intentDetectorSetup:o}=e,{rankerType:r,config:a}=s,l=a||{},d=new n.r(i,t),g=function(e,t,i){return c[e](t,i)}(r,i,l);return{settings:{hostAppCiqConfig:i},services:{dataAggregator:d,ranker:g,intentDetector:o?u(o):void 0}}}(e,t);return new s.V(i)}},445801:(e,t,i)=>{if(i.d(t,{W:()=>s}),0!=i.j)var n=i(556940);class s{get children(){return this._children}set children(e){this._children=e}constructor(e,t,i,s,o,r){this._observer=t,this.nodeType=e,this.id=null!=r?r:(0,n.h)(),this._children=i,this.element=s,this.parent=o}retire(){if(this._observer.disconnect(this.element),this.children)for(const e of this.children)e.retire();this.children=void 0}move(e,t){return this._observer.disconnect(this.element),this.id=(0,n.h)(),e&&(this.element=e),t&&(this.parent=t),this}resetState(){}}},446121:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"ہجے"}}')},449878:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"বানান","IsImplemented":true}}')},451816:(e,t,i)=>{if(i.d(t,{d:()=>o}),0!=i.j)var n=i(700509);if(0!=i.j)var s=i(418876);function o(e){switch(e){case n.fT.Word:return s.OD.Word;case n.fT.Sentence:return s.OD.Sentence;case n.fT.Paragraph:return s.OD.Paragraph;default:return s.OD.Sentence}}},452402:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Presisjon","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"Konsekvente skriftformer","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Inkluderende språk","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Skrivefeil"},"Clarity":{"IsImplemented":false,"LocalizedName":"Klarhet"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"Omskriving","IsImplemented":false},"Error Corrections":{"LocalizedName":"Feilretting","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Ordvalg"},"Grammar":{"LocalizedName":"Grammatikk","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"Formelt språk"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Tegnsetting"},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Skriftnormer"},"Spelling":{"IsImplemented":true,"LocalizedName":"Stavekontroll"},"Resume":{"IsImplemented":false,"LocalizedName":"CV"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Geopolitisk sensitive språkformer"}}')},455115:(e,t,i)=>{i.d(t,{Id:()=>f,lP:()=>v,sy:()=>y});var n=i(252723),s=i(108520);if(0!=i.j)var o=i(225918);var r=i(522775);if(0!=i.j)var a=i(897578);if(0!=i.j)var l=i(93659);if(0!=i.j)var d=i(318391);if(0!=i.j)var c=i(323283);if(0!=i.j)var u=i(496174);var g=i(77127);if(0!=i.j)var h=i(728178);var p=i(208520);const m=(0,n.F5)({footerFreStore:s.A.on(r.D)}),f="LanguageAutoDetection",v="lang-auto-detect-footer",y=()=>{const{footerFreStore:e}=(0,n.KN)(m),[t,i]=p.useState((()=>e.footerProps.get(r.Y.languageAutoDetection)));return p.useEffect((()=>{const t=e=>{const t=e.footerProps.get(r.Y.languageAutoDetection);i(t?Object.assign({},t):void 0)};return e.subscribe("stateUpdated",t),()=>{e.unsubscribe("stateUpdated",t)}}),[e]),(null==t?void 0:t.display)&&1===t.pages.size?p.createElement(_,null):null},_=()=>{var e,t;const i=p.useContext(g.O1),n=null!==(e=(0,h.ZY)())&&void 0!==e?e:document,s=null!==(t=n.defaultView)&&void 0!==t?t:window,[m,f]=p.useState(I(n)),[y,_]=p.useState(!0),C=p.useCallback((()=>{f(I(n))}),[n,f]);if(p.useEffect((()=>{const e=new c.J(s);return e.addListener("resize",C,{passive:!0,capture:!0}),()=>{e.removeAllListeners()}}),[C,s]),i){const e={popover:{id:v,withArrow:!1,open:y,onOpenChange:(e,t)=>{_(t.open)},positioning:{target:(0,l.ug)(m),align:"center",position:"above",offset:e=>({mainAxis:8})}},surface:{style:{padding:0,background:"transparent",borderRadius:8}}};return p.createElement(d.v,Object.assign({},e),p.createElement(u.b,{target:r.Y.languageAutoDetection}))}return p.createElement(a.U,{id:v,target:m,directionalHint:o.A.topCenter,isBeakVisible:!1,gapSpace:8,style:{borderRadius:8},styles:{root:{borderRadius:8},calloutMain:{background:"transparent"}}},p.createElement(u.b,{target:r.Y.languageAutoDetection}))};function I(e){return{x:e.body.clientWidth-240,y:e.body.clientHeight-13}}},456204:(e,t,i)=>{var n;i.d(t,{h:()=>n}),function(e){e.Undefined="Undefined",e.Host="Host",e.Authentication="Authentication",e.ExceptionHandling="ExceptionHandling",e.Navigation="Navigation",e.UiRendering="UiRendering",e.FeatureSuppression="FeatureSuppression",e.AtAGlance="AtAGlance",e.BxPromo="BxPromo",e.ContentCreation="ContentCreation",e.CritiqueUpsell="CritiqueUpsell",e.WritingAnalytics="WritingAnalytics",e.TableStyles="TableStyles",e.Similarity="Similarity",e.Goals="Goals",e.Feedback="Feedback",e.PremiumSquigglesPreview="PremiumSquigglesPreview",e.Proofing="Proofing",e.EditorScore="EditorScore",e.PremiumPreview="PremiumPreview",e.TonalRewriteFre="TonalRewriteFre",e.WritersUnblock="WritersUnblock",e.AIFeedback="AIFeedback"}(n||(n={}))},456595:(e,t,i)=>{if(i.d(t,{_:()=>u}),0!=i.j)var n=i(177822);if(0!=i.j)var s=i(341755);if(0!=i.j)var o=i(416697);if(0!=i.j)var r=i(811861);if(0!=i.j)var a=i(203907);if(0!=i.j)var l=i(189929);if(0!=i.j)var d=i(251439);if(0!=i.j)var c=i(386675);class u{constructor(){this.imports=[o.B,n.J]}get uniqueId(){return(0,d.z)(507918305)}configureRootServices(e){e.bind(r.Tc).to(a.O),e.bind(c.S).toExisting(r.Tc),e.bind(s.i).toValue(l.q)}}},458725:(e,t,i)=>{if(i.d(t,{f:()=>j}),0!=i.j)var n=i(525809);if(0!=i.j)var s=i(248401);if(0!=i.j)var o=i(649343);if(0!=i.j)var r=i(181731);if(0!=i.j)var a=i(613543);if(0!=i.j)var l=i(732162);if(0!=i.j)var d=i(575024);if(0!=i.j)var c=i(743442);if(0!=i.j)var u=i(589445);if(0!=i.j)var g=i(745133);if(0!=i.j)var h=i(12870);if(0!=i.j)var p=i(878183);if(0!=i.j)var m=i(279e3);if(0!=i.j)var f=i(997601);if(0!=i.j)var v=i(826663);if(0!=i.j)var y=i(438343);if(0!=i.j)var _=i(104072);if(0!=i.j)var I=i(538045);if(0!=i.j)var C=i(83605);if(0!=i.j)var S=i(761799);if(0!=i.j)var b=i(166137);if(0!=i.j)var T=i(955377);if(0!=i.j)var E=i(251439);if(0!=i.j)var N=i(234483);if(0!=i.j)var w=i(731816);if(0!=i.j)var x=i(937126);if(0!=i.j)var L=i(537969);if(0!=i.j)var D=i(781729);if(0!=i.j)var A=i(961641);if(0!=i.j)var F=i(150099);if(0!=i.j)var q=i(494888);if(0!=i.j)var R=i(163573);if(0!=i.j)var P=i(877931);if(0!=i.j)var O=i(769263);if(0!=i.j)var k=i(752956);var M=i(77127),z=i(208520);class j{constructor(){this.imports=[n.f]}get uniqueId(){return(0,E.z)(507847257)}configureRootServices(e){e.bind(s.u).toDynamicValue((e=>{const t=e.get(F.j),i=e.get(q.c),n=e.get(R.n),s=e.get(o.f),a=e.get(N.P);return(e,o)=>z.createElement(r.M,{key:`squiggler-${e}`,state:o,deps:{safeWindow:t,featureFlagsReader:i,hostSettings:n,squigglerUXFactory:s,highConstrastModeDetector:a}})})),e.bind(a.y).toDynamicValue((t=>{var i,n,s,o,r;const a=new l.FN({themeTypeOrSquiggleTheme:null!==(n=null===(i=e.getOptional(w.a))||void 0===i?void 0:i())&&void 0!==n?n:null===(s=e.getOptional(M.YQ))||void 0===s?void 0:s.currentTheme,isUsingCSSHighlightViaSettings:null===(o=e.getOptional(R.n))||void 0===o?void 0:o.enableCSSHighlightApiSquiggleRendering,forcedHighContrastColorModeEnabled:null===(r=e.getOptional(d.$))||void 0===r?void 0:r()});return new c.U(a.getSquiggleTheme())})),e.bind(s.f).toDynamicValue((t=>{const i=e.get(_.d),n=e.get(x.f),s=e.get(P.g),o=e.getAll(L.zJ),r=e.get(L.M5),l=e.get(R.n),c=e.get(I.w),E=e.get(a.y),N=e.getOptional(C.M),w=e.getOptional(S.Ey),F=e.getOptional(u.m),q=e.getOptional(O.z),M=e.getOptional(b.M),z=e.getOptional(T.W),j=e.getOptional(m.$),W=e.getOptional(f.a),B=e.getOptional(v.K),U=e.getOptional(D.s),H=e.getOptional(A.rI),V=e.getOptional(g.PF),G=e.getOptional(y.m),Q=e.getOptional(d.$),K=e.getOptional(h.U);return(t,a,d,u,g,h={})=>new p.i({proofedItem:t,anchorElement:a,anchorId:d,critiqueCalloutHandler:u,tooltipHandler:g,options:e.get(k.z)(h)},i,n,o,r,l,c,E,s,N,w,F,q,M,z,j,W,B,U,H,V,G,Q,K)}))}}},460855:(e,t,i)=>{if(i.d(t,{G:()=>c}),0!=i.j)var n=i(862220);if(0!=i.j)var s=i(46692);if(0!=i.j)var o=i(753031);if(0!=i.j)var r=i(857517);if(0!=i.j)var a=i(488731);if(0!=i.j)var l=i(920117);if(0!=i.j)var d=i(236845);class c{constructor(e,t,i){this._telemetrySink=e,this._loggerSettings=t,this._userInfoStrategy=i,this._appId="",this._clientId="",this._initialized=!1,this._initializing=!1,this._configurationId=""}async initialize(e,t,i,s,o,r){if(!this._initialized){if(!this._initializing){this._initializing=!0;try{this._hostSettings=o,this._sessionContext=t,e?(this._configurationId=await e.read(l.l.ConfigurationId),this._appId=await e.read(l.l.AppId),this._clientId=await e.read(l.l.ClientId)):r&&(this._appId=r.appId,this._clientId=r.clientId),this._internalLogger=new n.V(this._loggerSettings,this._telemetrySink)}finally{this._initializing=!1}}this._initialized=!0}}logEvent(e,t,i,n,s,o,r){if(this._initialized&&this._loggerSettings.defaultEventName){const a=t||this._loggerSettings.defaultEventName;this.sendLog(a,e,i,n,s,o,r)}}getNewActivity(e,t,i){var n,o,r,a;if(!this._initialized)return;const l=this._internalLogger.createActivity(e,void 0,{dataCategories:s.o.DataCategories.ProductServiceUsage,diagnosticLevel:s.o.DiagnosticLevel.RequiredServiceData});if(null===(n=this._userInfoStrategy)||void 0===n||n.execute(!1,(e=>(e&&l.dataFields.push(...(0,d.yT)([["User_Id",e.userId],["Tenant_Id",e.tenantId],["Identity_Provider",JSON.stringify(e.identityProvider)],["License_Type",e.licenseType]])),e))),l.dataFields.push(...this.getSessionContextDataFields()),l.dataFields.push(...(0,d.yT)([["App_Id",this._appId],["Client_Id",this._clientId],["CorrelationID",null!==(o=this._sessionCorrelationId)&&void 0!==o?o:""],["ConfigurationId",this._configurationId],["FlightsToTrack",null===(a=null===(r=this._hostSettings)||void 0===r?void 0:r.flightsToTrack)||void 0===a?void 0:a.join(";")]])),i){const t=c.createFunnelContract(e,i);l.dataFields.push(...t)}return l}getSessionContextDataFields(){var e,t;return this._sessionContext?(0,d.yT)([["Browser_Type",this._sessionContext.browserType],["Browser_Version",null!==(e=this._sessionContext.browserVersion)&&void 0!==e?e:""],["Store_Runtime_Id",null!==(t=this._sessionContext.extensionStoreId)&&void 0!==t?t:""],["Extension_Version",this._sessionContext.extensionVersion],["Extension_Version_Name",this._sessionContext.extensionVersionName]]):[]}addCorrelationID(e){this._sessionCorrelationId=e}sendLog(e,t,i,n,r,a,l){var u,g,h;if(!this._initialized||i===o.q.Debug)return;const p=[];this.serviceRequestId&&p.push((0,d.FO)("Service_Request_Id",this.serviceRequestId,s.o.DataFieldType.Guid.valueOf())),this._sessionContext&&p.push(...this.getSessionContextDataFields());let m="",f="",v="";if(null===(u=this._userInfoStrategy)||void 0===u||u.execute(!1,(e=>{var t;return e&&(m=e.userId,f=null!==(t=e.tenantId)&&void 0!==t?t:"",v=e.identityProvider.toString()),e})),p.push(...(0,d.yT)([["Tag",t.toString()],["Tag_Hex",t.toString(16)],["Level",o.q[i]],["App_Id",this._appId],["Client_Id",this._clientId],["User_Id",m],["Tenant_Id",f],["Identity_Provider",v],["Text_Message",n],["Correlation_Id",this._sessionCorrelationId],["Data",a instanceof Error?JSON.stringify((0,d.jh)(a)):a?JSON.stringify(a):void 0],["FlightsToTrack",null===(h=null===(g=this._hostSettings)||void 0===g?void 0:g.flightsToTrack)||void 0===h?void 0:h.join(";")]])),l){c.createFunnelContract(e,l).forEach((e=>p.push(e)))}this._internalLogger.logStandaloneMetric(e,r,s.o.DiagnosticLevel.RequiredServiceData,s.o.DataCategories.NotSet,p)}static createFunnelContract(e,t){const i=r.S[t];return a.A.Office.System.Funnel.getFields(e,{name:e,state:i})}}},461300:(e,t,i)=>{if(i.d(t,{_:()=>s}),0!=i.j)var n=i(213983);class s{constructor(e){this.targetWindow=e,this.timeoutIds=[]}throttle(e,t,i){return(0,n.ek)((e=>{var i;const n=null===(i=this.targetWindow.deref())||void 0===i?void 0:i.setTimeout(e,t);n&&this.timeoutIds.push(n)}),e,i)}throttleUntilNextAnimationFrameAndAdditionalTime(e,t,i,s){return(0,n.ek)((t=>e.requestAnimationFrame((()=>{var e;const n=null===(e=this.targetWindow.deref())||void 0===e?void 0:e.setTimeout(t,i);n&&this.timeoutIds.push(n)}),this.targetWindow)),t,s)}dispose(){const e=this.targetWindow.deref();if(void 0!==e)for(const t of this.timeoutIds)e.clearTimeout(t);this.timeoutIds=[]}}},463999:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Орфографія"}}')},465701:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(668952).f)("IsMobile")},466450:(e,t,i)=>{i.d(t,{F:()=>a});var n=i(208520);if(0!=i.j)var s=i(219515);if(0!=i.j)var o=i(502929);if(0!=i.j)var r=i(923256);class a{constructor(e){this.hostSettings=e}getSquiggles(e,t,i,a,l){const d=(0,r.g)(this.hostSettings,l);if(d)return n.createElement(s.u,{squigglerId:e,squigglesProps:t,theme:i,forcedHighContrast:a,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!1,anchorElement:l});{const r=d&&n.createElement(s.u,{squigglerId:e,squigglesProps:t,theme:i,forcedHighContrast:a,hostSettings:this.hostSettings,opacity:1,isAutoCorrection:!1,ariaStatusUpdatesOnly:!0,anchorElement:l});return n.createElement(n.Fragment,null,r,t.map((e=>n.createElement(o.ip,Object.assign({key:e.id},e,{isAutoCorrectionEnabled:this.hostSettings.enableAutoCorrect,squiggleKind:"critique",useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey})))))}}getFormInputSquiggle(e,t,i,s){return n.createElement(o.AX,Object.assign({key:e},t,{squiggleKind:"critique",useAltHotkey:!!this.hostSettings.useAlternativeSquiggleHotkey}))}}},468576:(e,t,i)=>{if(i.d(t,{I:()=>s,P:()=>o}),0!=i.j)var n=i(140969);function s(e,t){const i=e.stealth===t.stealth,s=e.isHighlighted===t.isHighlighted,o=e.isCaretOver===t.isCaretOver,r=e.isMouseOver===t.isMouseOver,a=e.isCalloutOpened===t.isCalloutOpened,l=(0,n.a)(e.data.clientRect,t.data.clientRect);return o&&r&&a&&l&&s&&i}function o(e,t){const i=e.isHighlighted===t.isHighlighted,n=e.isCaretOver===t.isCaretOver,s=e.isMouseOver===t.isMouseOver,o=e.isCalloutOpened===t.isCalloutOpened,r=e.data.start===t.data.start,a=e.data.end===t.data.end,l=e.data.text===t.data.text,d=e.data.overlayCss.height===t.data.overlayCss.height,c=e.data.overlayCss.width===t.data.overlayCss.width;return o&&n&&a&&d&&c&&s&&r&&l&&i}},469718:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(668952).f)("IParagraphFormattingExtractor")},474324:(e,t,i)=>{if(i.d(t,{e:()=>o}),0!=i.j)var n=i(331408);if(0!=i.j)var s=i(524812);function o(e){switch(e){case n.L9.CIQFlag_PersonEntityRecognition:return s.z4.Person;case n.L9.CIQFlag_File:return s.z4.File;case n.L9.CIQFlag_LocalBusiness:case n.L9.CIQFlag_Location:case n.L9.CIQFlag_Time:return s.z4.Location;case n.L9.CIQFlag_Topic:return s.z4.Topic;case n.L9.CIQFlag_TaskRecognition:case n.L9.CIQFlag_SatoriEntityRecognition:case n.L9.CIQFlag_DateEntityRecognition:case n.L9.HeadingDetection:return s.z4.Location;default:return}}},481347:(e,t,i)=>{if(i.d(t,{kd:()=>s}),0!=i.j)var n=i(696767);function s(e,t){if(t)return t.OnCanvasCalloutStrings[e];return(0,n.$)().getString("OnCanvasCalloutStrings",e)}},481593:(e,t,i)=>{i.d(t,{h:()=>n});const n=(0,i(668952).f)("IIndexReadjuster")},481631:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Ejaan"}}')},482489:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Pareizrakstība","IsImplemented":true}}')},485104:(e,t,i)=>{var n;i.d(t,{mO:()=>s}),function(e){e.CATALAN="ca",e.CATALANCATALAN="ca-es",e.CHINESE="zh",e.CHINESESIMPLIFIED="zh-hans",e.CHINESETRADITIONAL="zh-hant",e.ENGLISH="en",e.ENGLISH_AUSTRALIA="en-au",e.ENGLISH_CANADA="en-ca",e.ENGLISH_INDIA="en-in",e.ENGLISH_UNITEDKINGDOM="en-gb",e.ENGLISH_UNITEDSTATES="en-us",e.FRENCH="fr",e.FRENCH_CANADA="fr-ca",e.FRENCH_FRANCE="fr-fr",e.GERMAN="de",e.ITALIAN="it",e.JAPANESE="ja",e.PORTUGUESE="pt",e.SPANISH="es",e.SPANISH_MEXICO="es-mx",e.SPANISH_SPAIN="es-es",e.VALENCIAN="ca-es-valencia",e.RUSSIAN="ru",e.BRAZILIAN="br"}(n||(n={}));const s=()=>new Map([[n.ENGLISH_AUSTRALIA,n.ENGLISH_UNITEDSTATES],[n.ENGLISH_CANADA,n.ENGLISH_UNITEDSTATES],[n.ENGLISH_INDIA,n.ENGLISH_UNITEDSTATES],[n.ENGLISH_UNITEDKINGDOM,n.ENGLISH_UNITEDSTATES],[n.FRENCH_CANADA,n.FRENCH_FRANCE],[n.SPANISH_MEXICO,n.SPANISH_SPAIN]]);var o;!function(e){e.Goals="Goals"}(o||(o={}))},486138:(e,t,i)=>{i.d(t,{$:()=>l,I:()=>d});var n=i(379490),s=i(668952),o=i(229906),r=i(83010),a=i(210172);const l=(0,s.f)("IContentValidator");let d=class{constructor(e){this.presentationSettings=e}validate(e){if(!e)return"";let t=e;return t.includes("￼")&&(t=t.replace(/￼/g,"")),t.slice(0,this.presentationSettings.maxServiceContentLengthInChars)}};d=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(a.z))],d)},487368:(e,t,i)=>{if(i.d(t,{R:()=>d}),0!=i.j)var n=i(251439);if(0!=i.j)var s=i(39183);if(0!=i.j)var o=i(703906);if(0!=i.j)var r=i(961641);if(0!=i.j)var a=i(386675);if(0!=i.j)var l=i(521792);class d{constructor(){this.imports=[]}get uniqueId(){return(0,n.z)(507918307)}configureRootServices(e){e.bind(s.d).to(o.U),e.bind(r.e).to(l.N),e.bind(a.S).toExisting(r.e)}}},488776:(e,t,i)=>{i.d(t,{$:()=>N});var n=i(807582),s=i(609062),o=i(823325),r=i(418876),a=i(420821),l=i(909113),d=i(700509),c=i(556940);class u{constructor(e,t){this.id=(0,c.h)(),this.range=e,this.parent=t,t.registerChild(this)}retire(){var e;null===(e=this.parent)||void 0===e||e.unregisterChild(this),this.parent=void 0}move(e,t){return e&&(this.range=e),t&&(this.parent=t),this.id=(0,c.h)(),this}}var g=i(695285),h=i(629139),p=i(517119),m=i(495170);function f(e,t=!1){switch(e){case d.fT.Sentence:return new p.F({newLineSentenceSeparatorEnabled:t});case d.fT.Paragraph:return new h.a;default:return new m.R}}var v=i(63689),y=i(659175),_=i(451816),I=i(378071);class C extends n.z{constructor(e,t){super(),this._settings=e,this._logger=t}updateSettings(e){this._settings=e}updateParagraphNodes(e,t,i,n,s,o,r){if(!this._settings.enableOrchestration||!this._settings.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,i,n,s);const a={oldTextInfo:t,newTextInfo:i,tileNode:e,sequenceId:s,minDiffBounds:n,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(a),this._addNewChildren(a),this._buildGraphTransaction(a,o,r),a.graphTransaction}_updateExistingChildren(e){var t,i;if(!e.tileNode.children.length)return;const n=null!==(i=null===(t=e.oldTextInfo)||void 0===t?void 0:t.content)&&void 0!==i?i:"",s=e.newTextInfo.content,o=n!==s,r={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let a=e.tileNode.children.length-1;for(;a>=0;){const t=e.tileNode.children[a].range;if(n.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=s.length-n.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!o)){t.offset<e.minDiffBounds.firstDiffLeft&&(r.firstDiffLeft=Math.min(t.offset,r.firstDiffLeft));const i=n.length-t.offset-t.span;i<e.minDiffBounds.firstDiffRight&&(r.firstDiffRight=Math.min(i,r.firstDiffRight));const s=e.tileNode.children.splice(a,1);e.nodesToRetire.length&&r.firstDiffRight!==i?r.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...s):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...s):e.nodesToRetire.push(...s)}a-=1}e.unitRange={offset:r.firstDiffLeft,span:s.length-r.firstDiffRight-r.firstDiffLeft,enforcedCompleteTileTextUnit:!o&&this._settings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=(0,g.e)(e.newTextInfo.content,e.minDiffBounds,f(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),e.unitRange);for(const i of t){const t=new u(i,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.range.textUnit=(!1===e.range.validEndBoundary&&this._settings.enableOptimizedCallingPattern&&e.range.enforcedCompleteTileTextUnit,this._settings.completeTileTextUnit)}_buildTile(e,t,i,n){const s=t.range.offset,o=t.range.span;return{header:{nodeId:e.id,seqId:n.toString(),elementId:{id:t.id,offset:s,span:o},length:i.length},data:i.slice(s,s+o),proofingLanguages:this._settings.proofingLanguages,textUnit:t.range.textUnit}}_convertToUpdate(e,t,i,n,s,o){var r,a;if(!(null==e?void 0:e.range)||!(null==t?void 0:t.range))return;const l=null!==(a=null===(r=i.oldTextInfo)||void 0===r?void 0:r.content)&&void 0!==a?a:"",d=i.newTextInfo.content,c=l.length-e.range.offset-e.range.span,u=d.length-t.range.offset-t.range.span;if(!n&&e.range.offset!==t.range.offset||n&&c!==u)return;const g=this._emitParagraphDeltaUpdate(e,t,i,s,o);return e.range.offset=t.range.offset,e.range.span=t.range.span,e.range.validEndBoundary=t.range.validEndBoundary,e.range.enforcedCompleteTileTextUnit=t.range.enforcedCompleteTileTextUnit,e.range.textUnit=t.range.textUnit,t.retire(),i.nodesToAdd.splice(n?i.nodesToAdd.length-1:0,1),i.nodesToInsert.splice(n?i.nodesToInsert.length-1:0,1,e),i.nodesToRetire.splice(n?i.nodesToRetire.length-1:0,1),i.nodesToUpdate.push(e),i.graphTransaction.unreconciledContent.find((i=>{const n=i.header.elementId.id===t.id;return n&&(i.header.elementId.id=e.id),n})),g}_buildGraphTransaction(e,t,i){e.nodesToInsert=[...e.nodesToAdd];const n=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,i),s=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,i);S(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();n&&this.publishEvent("deltaEvent",n),s&&this.publishEvent("deltaEvent",s),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,i,n,s){var o;const r={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},a=this._updateExistingChildrenDeprecated(e,null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"",i.content,n,r);return this._addNewChildrenDeprecated(e,i,n,s,a,r)}_updateExistingChildrenDeprecated(e,t,i,n,s){if(e.children.length){const o=Object.assign({},n),r=t!==i;let a=e.children.length-1;for(;a>=0;){const l=e.children[a].range;if(l.offset<n.firstDiffLeft&&l.offset+l.span<n.firstDiffLeft||l.offset+l.span===n.firstDiffLeft&&l.validEndBoundary&&r);else if(t.length-l.offset<n.firstDiffRight)l.offset=i.length-t.length+l.offset,s.updatedNodes.push(e.children[a].id);else{l.offset<n.firstDiffLeft&&(o.firstDiffLeft=Math.min(l.offset,o.firstDiffLeft));const i=t.length-l.offset-l.span;i<n.firstDiffRight&&(o.firstDiffRight=Math.min(i,o.firstDiffRight));const r=e.children.splice(a,1);for(const e of r)s.removedNodes.push(e.id),e.retire()}a-=1}return{offset:o.firstDiffLeft,span:i.length-o.firstDiffRight-o.firstDiffLeft,enforcedCompleteTileTextUnit:!r&&this._settings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,i,n,s,o){const r=(0,g.e)(t.content,i,f(this._settings.completeTileTextUnit,this._settings.newLineSentenceSeparatorEnabled),s),a=[];for(const i of r){const s=new u(i,e);this._attachTextUnit(s),a.push(s),o.unreconciledContent.push(this._buildTile(e,s,t.content,n)),o.addedNodes.push(s.id)}return S(e,a),o}_emitParagraphDeltaUpdate(e,t,i,n,s){if(this._settings.paragraphDeltasEnabled){const o=(0,I.Gn)(i.oldTextInfo,e.range.offset,e.range.offset+e.range.span),r=(0,I.Gn)(i.newTextInfo,t.range.offset,t.range.offset+t.range.span);if(e.registered||this._emitParagraphAdd(i,e,n),void 0!==e.eventSeqId){e.eventSeqId+=1;const i=b(e,o,r,!!t.range.validEndBoundary,!!t.range.enforcedCompleteTileTextUnit,n,s,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,e.cachedWordCount);return e.cachedWordCount=i.wordCount,i}}}_emitParagraphDeltaAdd(e,t){if(this._settings.paragraphDeltasEnabled)if(e.nodesToAdd.length<=2||!this._settings.batchTileProcessingEnabled)for(const i of e.nodesToAdd)this._emitParagraphAdd(e,i,t);else this._emitParagraphBatchAdd(e,t)}_emitParagraphAdd(e,t,i){var n;if(t.registered)return void(this._settings.enableParagraphDeltasVerboseLogging&&(null===(n=this._logger)||void 0===n||n.info(539002012,"The node has been registered, skipping")));const o=this._settings.enableParagraphDeltasEmptyInitialTile&&i===s.Q0.Local,r=(0,I.Gn)(e.newTextInfo,t.range.offset,t.range.offset+t.range.span);t.eventSeqId=0;const a=o?Object.assign(Object.assign({},r),{content:""}):r,l=this._getNodeAddEventData(e.tileNode,t,a,i);if(this.publishEvent("nodeEvent",l),o){t.eventSeqId+=1;const e=this._getDeltaEventData(t,r,i);this.publishEvent("deltaEvent",e)}t.registered=!0}_emitParagraphBatchAdd(e,t){const i=[];for(const n of e.nodesToAdd){if(n.registered)continue;const s=(0,I.Gn)(e.newTextInfo,n.range.offset,n.range.offset+n.range.span);n.eventSeqId=0;const o=this._getNodeAddEventData(e.tileNode,n,s,t);i.push(o),n.registered=!0}this.publishEvent("nodeBatchEvent",i)}_getNodeAddEventData(e,t,i,n){var s;const r=e.findPreviousChildNode(t),a=e.findNextChildNode(t);return{tileNodeId:e.id,id:t.id,content:i,eventSeqId:null!==(s=t.eventSeqId)&&void 0!==s?s:0,mutationChangeType:n,messageType:o.G.NewData,documentModel:e.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(t),prevTileId:"#head#"===r?r:null==r?void 0:r.id,nextTileId:"#tail#"===a?a:null==a?void 0:a.id}}_getDeltaEventData(e,t,i){return b(e,void 0,t,!!e.range.validEndBoundary,!0,i,!1,this._settings.completeTileTextUnit,this._settings.completeTileTextUnit,this._settings,0)}_emitParagraphDeltaRetire(e,t){if(this._settings.paragraphDeltasEnabled&&0!==e.nodesToRetire.length)if(this._settings.batchTileProcessingEnabled&&e.nodesToRetire.length>1)this._emitParagraphBatchRetire(e,t);else for(const i of e.nodesToRetire)i.registered=!1,this.publishEvent("nodeEvent",this._getNodeRetireEventData(e,i,t))}_emitParagraphBatchRetire(e,t){const i=[];for(const n of e.nodesToRetire)n.registered=!1,i.push(this._getNodeRetireEventData(e,n,t));i.length>0&&this.publishEvent("nodeBatchEvent",i)}_getNodeRetireEventData(e,t,i){var n;return{tileNodeId:e.tileNode.id,id:t.id,content:{content:""},eventSeqId:null!==(n=t.eventSeqId)&&void 0!==n?n:0,mutationChangeType:i,messageType:o.G.RemoveData,documentModel:e.tileNode.documentModel,specifiedLocale:this.getSpecifiedLocaleForNode(t)}}getSpecifiedLocaleForNode(e){var t,i;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(i=e.parent)||void 0===i?void 0:i.specifiedLocale}}function S(e,t){if(t.length){const i=t[0].range.offset;if(e.children.length){let n=e.children.length-1,s=t;for(;n>=0;){if(i>e.children[n].range.offset){e.children.splice(n,0,...s),s=[];break}n-=1}s.length&&e.children.splice(0,0,...s)}else e.children=t}}function b(e,t,i,n,s,o,a,c,u,g,h){var p,m;const I=null!==(p=null==t?void 0:t.content)&&void 0!==p?p:"",C=i.content,S=l.CC(I,C);a&&(S.firstDiffLeft-=1);let b=!1;if(!n&&u!==d.fT.Phrase&&u!==c){const e=S.firstDiffLeft,t=C.length-S.firstDiffRight;b=-1!==f(u).findEndBoundary(C,e-1,t)}const T=new v.M(new y.a,g),E=null!=h?h:T.getWordCount(I),N=T.hasWordCountChanged(S,E,C,!0);let w,x=r.OD.Word;if(s?x=(0,_.d)(c):b?x=(0,_.d)(u):N.isWordCountChanged?n&&(x=(0,_.d)(c)):x=r.OD.Chars,c===d.fT.Paragraph&&u===d.fT.Sentence&&x!==r.OD.Paragraph){const e=S.firstDiffLeft,t=f(u),i=t.findBeginBoundary(C,e,0),n=t.findEndBoundary(C,e-1,C.length);w=[{position:i,length:(-1===n?C.length:n)-i,unit:r.OD.Sentence}]}return{textTileNode:e,oldTextInfo:t,newTextInfo:i,minDiffBounds:S,wordCount:N.wordCount,deltaUnit:x,mutationChangeType:o,invalidationRanges:w,wordBoundaries:null!==(m=N.wordBoundaries)&&void 0!==m?m:[]}}class T extends n.z{get eventSeqId(){return this._eventSeqId}get cachedText(){var e;return null!==(e=this._cachedTextInfo)&&void 0!==e?e:{content:""}}get disposed(){return this._disposed}get previousNodeId(){return void 0===this.previousNode||"#head#"===this.previousNode?this.previousNode:this.previousNode.id}get nextNodeId(){return void 0===this.nextNode||"#tail#"===this.nextNode?this.nextNode:this.nextNode.id}constructor(e,t,i){super(),this.id=e,this._settings=t,this._logger=i,this._cachedWordCount=0,this._cachedTiles=new Map,this._dirtyParagraphIds=new Set,this.seqId=0,this._eventSeqId=0,this.children=[],this.childrenIdMap=new Map,this._disposed=!1,this._publishDirtyParagraphsDiff=(e,t)=>{for(const i of this._dirtyParagraphIds){const n=this.childrenIdMap.get(i);if(!n)continue;const s=(0,I.Gn)(e,n.range.offset,n.range.offset+n.range.span);this.publishEvent("paragraphDiff",{paragraph:n,textInfo:s,mutationChangeType:t})}this._dirtyParagraphIds.clear()},this._publishLastParagraphDiff=(e,t)=>{if(0===this.children.length)return;let i=this.children[0];for(const e of this.children)e.range.offset>i.range.offset&&(i=e);const n=(0,I.Gn)(e,i.range.offset,i.range.offset+i.range.span);this.publishEvent("paragraphDiff",{paragraph:i,textInfo:n,mutationChangeType:t})},this.isForceRehydrationExpected=!1,this._republishTextTileDeltaEvent=e=>{this._detectDirtyTextTile(e),this.publishEvent("textTileDeltaEvent",e)},this._republishTextTileNodeEvent=e=>{this.publishEvent("textTileNodeEvent",e)},this._republishTextTileNodeBatchEvent=e=>{this.publishEvent("textTileNodeBatchEvent",e)},this._detectDirtyTextTile=e=>{e.deltaUnit===r.OD.Sentence||e.deltaUnit===r.OD.Paragraph?this._dirtyParagraphIds.delete(e.textTileNode.id):this._dirtyParagraphIds.add(e.textTileNode.id)},this._wordCount=new y.a,this._wordCountDetector=new v.M(this._wordCount,this._settings),this._textTileNodeManager=new C(this._settings,this._logger),this._textTileNodeManager.subscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.subscribe("nodeEvent",this._republishTextTileNodeEvent),this._textTileNodeManager.subscribe("nodeBatchEvent",this._republishTextTileNodeBatchEvent),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetInternal()}resetInternal(){this._cachedTextInfo=void 0,this._cachedWordCount=0,this.documentModel=void 0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();this.children=[],this.childrenIdMap.clear(),this._invalidationDiffBounds=void 0}updateSettings(e){this._settings=e,this._wordCountDetector=new v.M(this._wordCount,this._settings),this._textTileNodeManager.updateSettings(e)}resetState(){if(this.removeAllParagraphNodesFromAugloop(),this.resetInternal(),!this._settings.enableOrchestration){const e={firstDiffLeft:0,firstDiffRight:0};this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:"",newText:"",minDiffBounds:e,maxDiffBounds:e,seqId:this.seqId,forceReflow:!0})}this.publishEvent("stateReset",{tileNodeId:this.id})}async dispose(){this.resetInternal(),this._textTileNodeManager.unsubscribe("deltaEvent",this._republishTextTileDeltaEvent),this._textTileNodeManager.unsubscribe("nodeEvent",this._republishTextTileNodeEvent),this._textTileNodeManager.unsubscribe("nodeBatchEvent",this._republishTextTileNodeBatchEvent),this._disposed=!0}reconcile(e){var t,i,n,s,o,r,a,d,c;if(e.rehydrateCritiques&&e.idleReconcileTrigger&&!this.isForceRehydrationExpected)return;const u=null!==(i=null===(t=this._cachedTextInfo)||void 0===t?void 0:t.content)&&void 0!==i?i:"",g=e.text.content,h=l.CC(u,g);return this.documentModel=e.documentModel,e.mutationWasTextReplacement&&(h.firstDiffLeft-=1),g!==u&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},h)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,h.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,h.firstDiffRight)),this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:null===(n=e.brokerOptions)||void 0===n?void 0:n.critiques,oldText:u,newText:g,minDiffBounds:h,maxDiffBounds:null!==(s=this._invalidationDiffBounds)&&void 0!==s?s:{firstDiffLeft:u.length,firstDiffRight:0},seqId:this.seqId,forceReflow:null!==(r=null===(o=e.brokerOptions)||void 0===o?void 0:o.forceReflow)&&void 0!==r?r:void 0!==(null===(a=e.brokerOptions)||void 0===a?void 0:a.critiques)}),g===u&&this.children.length>0&&(!e.rehydrateCritiques||e.optimizedRehydrationEnabled)?(e.rehydrateCritiques&&(e.useDirtyParagraphReconciliation?this._publishDirtyParagraphsDiff(e.text,e.mutationChangeType):this._publishLastParagraphDiff(e.text,e.mutationChangeType)),this._settings.enableOrchestration&&(e.forceTileDiffEmission||e.rehydrateCritiques)&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,cachedTextInfo:this._cachedTextInfo,newTextInfo:e.text,minDiffBounds:h,hasWordChanges:!1,cachedWordCount:this._cachedWordCount,cachedTiles:Array.from(this._cachedTiles.values()),mutationChangeType:e.mutationChangeType,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e.text),void(this._cachedTextInfo=e.text)):this._reconcileState(e.text,h,null!==(d=e.rehydrateCritiques)&&void 0!==d&&d,e.mutationChangeType,null!==(c=e.mutationWasTextReplacement)&&void 0!==c&&c)}findPreviousChildNode(e){var t;const i=e.range.offset;for(const t of this.children)if(t!==e&&t.range.offset+t.range.span===i)return t;return"#head#"===this.previousNode?this.previousNode:null===(t=this.previousNode)||void 0===t?void 0:t.findLastChildNode()}findNextChildNode(e){var t;const i=e.range.offset+e.range.span;for(const t of this.children)if(t!==e&&t.range.offset===i)return t;return"#tail#"===this.nextNode?this.nextNode:null===(t=this.nextNode)||void 0===t?void 0:t.findFirstChildNode()}findLastChildNode(){let e;for(const t of this.children)(!e||t.range.offset>e.range.offset)&&(e=t);return e}findFirstChildNode(){let e;for(const t of this.children)(!e||t.range.offset<e.range.offset)&&(e=t);return e}_reconcileFormatting(e){var t,i;if(this._cachedTextInfo){if(this._settings.enableAttributionRangeExceptionInFormattedTextDeltas){const i=this._settings.enableAttributionRangeInAddDelta&&!(0,I.V8)(this._cachedTextInfo.attributionRanges,e.attributionRanges);if(!(0,I.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)||i){for(const t of this.children){const n=t.range.offset+t.range.span,o=(0,I.Wi)(this._cachedTextInfo,t.range.offset,n),r=(0,I.Wi)(e,t.range.offset,n);(0,I.V8)(o.formattedRanges,r.formattedRanges)&&!i||this.publishEvent("formattingDiff",{paragraph:t,sourceType:s.pf.ParagraphNode,data:{formattedRanges:r.formattedRanges,attributionRanges:i?r.attributionRanges:void 0}})}this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:s.pf.TileNode,data:null!==(t=e.formattedRanges)&&void 0!==t?t:[]})}}else if(!(0,I.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){const i=(0,I.Wi)(this._cachedTextInfo,t.range.offset,t.range.offset+t.range.span),n=(0,I.Wi)(e,t.range.offset,t.range.offset+t.range.span);(0,I.V8)(i.formattedRanges,n.formattedRanges)&&(0,I.V8)(i.attributionRanges,n.attributionRanges)||this.publishEvent("formattingDiff",{paragraph:t,sourceType:s.pf.ParagraphNode,data:n})}this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:s.pf.TileNode,data:null!==(i=e.formattedRanges)&&void 0!==i?i:[]})}if(!(0,I.V8)(this._cachedTextInfo.objectReferences,e.objectReferences)||!(0,I.lX)(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of I._E)"objectReferences"!==e&&delete t[e];for(const e of this.children)this.publishEvent("formattingDiff",{paragraph:e,sourceType:s.pf.ParagraphNode,data:t});this.publishEvent("formattingDiff",{tileNodeId:this.id,sourceType:s.pf.TileNode,data:t})}}}retire(){var e,t,i;this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this.publishEvent("brokerReconcile",{tileNodeId:this.id,critiques:void 0,oldText:null!==(t=null===(e=this._cachedTextInfo)||void 0===e?void 0:e.content)&&void 0!==t?t:"",newText:"",minDiffBounds:this._invalidationDiffBounds,maxDiffBounds:this._invalidationDiffBounds,seqId:this.seqId,forceReflow:!0}),this._settings.enableOrchestration&&(this.publishEvent("removeTileNode",{tileNodeId:this.id}),this.removeAllParagraphNodesFromAugloop()),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),null===(i=this._logger)||void 0===i||i.debug(562057756,"Retire node",this.id)}removeAllParagraphNodesFromAugloop(){if(!this._settings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._settings.paragraphDeltasEnabled)for(const t of e)this.publishEvent("textTileNodeEvent",{tileNodeId:this.id,id:t,eventSeqId:this.seqId,mutationChangeType:s.Q0.Code,messageType:o.G.RemoveData,specifiedLocale:this.specifiedLocale,documentModel:this.documentModel});else this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},mutationChangeType:s.Q0.Code})}move(e){const t=this.id;return this.id=(0,c.h)(),this.publishEvent("brokerNodeChange",{oldNodeId:t,newNodeId:this.id}),this.documentModel=e,this.id}_reconcileState(e,t,i,n,o){const r=this.seqId+1,a=e.content;let l;if(this._settings.paragraphDeltasEnabled)l=!1,this._cachedWordCount=0;else if(this._settings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,a);l=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else l=this._reconcileWordCount(t,a);const d=this._textTileNodeManager.updateParagraphNodes(this,this._cachedTextInfo,e,t,r,n,o);if(this._reconcileParagraphs(d,r),this._settings.enableOrchestration&&(this._eventSeqId+=1,this.publishEvent("tileDiff",{tileNodeId:this.id,newTextInfo:e,minDiffBounds:t,cachedWordCount:this._cachedWordCount,mutationChangeType:n,hasWordChanges:l,graphTransaction:d,cachedTextInfo:this._cachedTextInfo,specifiedLocale:this.specifiedLocale})),this._reconcileFormatting(e),this._cachedTextInfo=e,i||l||this._settings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._settings.enableOptimizedCallingPattern&&n!==s.Q0.Code&&this.setIsForceRehydrationExpected(),this._settings.enableOrchestration){for(const e of d.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);d.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._settings.paragraphDeltasEnabled?d.removedNodes.length>0&&this.publishEvent("handleRemovedNodes",{tileNodeId:this.id,nodesToRetire:d.removedNodes}):this.publishEvent("paragraphNodeChange",{tileNodeId:this.id,graphTransaction:d,mutationChangeType:n,newTextInfo:e})}return this._resetInvalidationStateAndReturnTiles(d.unreconciledContent,r)}this.setIsForceRehydrationExpected()}setIsForceRehydrationExpected(){this._invalidationDiffBounds&&(this.isForceRehydrationExpected=!0)}clearIsForceRehydrationExpected(){this.isForceRehydrationExpected=!1}critiqueAction(e,t){return!this._settings.enableOrchestration&&(this.publishEvent("brokerProcessCritiqueAction",{tileNodeId:this.id,actionType:e,offset:t}),e===a.$w.ApplySuggestion&&this.reconcile({text:this.cachedText,mutationChangeType:s.Q0.Local}),!0)}_reconcileWordCount(e,t){const i=this._wordCountDetector.getWordCount(t);let n=0;e.firstDiffLeft<=t.length&&(n=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const s=i>0&&(i!==this._cachedWordCount||n>1);return this._cachedWordCount=i,s}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,i]of this._cachedTiles){-1===this.children.findIndex((t=>t.id===e))?this._cachedTiles.delete(e):i.header.seqId=t.toString()}e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._settings.enableOptimizedCallingPattern||this.clearIsForceRehydrationExpected(),this._invalidationDiffBounds=void 0,this.seqId=t,e}registerChild(e){this.childrenIdMap.set(e.id,e),this.publishEvent("registerChildNode",{tileNodeId:this.id,childNodeId:e.id})}unregisterChild(e){this.childrenIdMap.delete(e.id),this.publishEvent("unregisterChildNode",{childNodeId:e.id})}getChildById(e){return this.childrenIdMap.get(e)}}var E=i(872317);class N extends n.z{get disposed(){return this._disposed}constructor(e,t,i){super(),this._settings=e,this._proofingLanguages=t,this._logger=i,this._textTileNodes=new Map,this._textTileNodeToRootNode=new Map,this._disposed=!1,this._brokerMoveEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerMove"},e))},this._brokerCritiqueActionEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerCritiqueAction"},e))},this._brokerReconcileEventHandler=e=>{this.publishEvent("tilingEvent",Object.assign({messageName:"brokerReconcile"},e))},this._removeTileNodeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const i={tileId:e.tileNodeId,tileVersion:t.eventSeqId,documentModel:t.documentModel,changeType:s.Q0.Code,isTextNode:!1,tile:void 0};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:i,messageType:o.G.RemoveData})},this._tileDiffEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const i=(0,E.qu)(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel,this._settings.enableAttributionRangeInAddDelta);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},i.message)),this._handleAttributionDelta(i.message,i.attributionData)},this._paragraphDiffEventHandler=e=>{var t,i,n;const o=(0,E.IJ)(e.paragraph.id,null!==(t=e.paragraph.eventSeqId)&&void 0!==t?t:0,null===(i=e.paragraph.parent)||void 0===i?void 0:i.documentModel,e.textInfo,e.textInfo,{firstDiffLeft:e.paragraph.range.span,firstDiffRight:0},null!==(n=e.paragraph.cachedWordCount)&&void 0!==n?n:0,r.OD.Sentence,s.pf.ParagraphNode,e.mutationChangeType,this._settings.enableAttributionRangeInAddDelta);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},o.message)),this._handleAttributionDelta(o.message,o.attributionData)},this._paragraphNodeChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);if(!t)return;const i=(0,E.$q)(e,t,this._proofingLanguages.defaultLanguageCode,t.documentModel,this._settings.enableParagraphUpdates);this.publishEvent("tilingEvent",{messageName:"hostModelParagraphTextTiles",data:i})},this._formattingDiffEventHandler=e=>{var t,i,n;let s,o,r=0;if(e.tileNodeId){const i=this.getTileRootNodeById(e.tileNodeId);s=null==i?void 0:i.id,r=null!==(t=null==i?void 0:i.eventSeqId)&&void 0!==t?t:0,o=null==i?void 0:i.documentModel}if(!s&&e.paragraph&&(s=e.paragraph.id,r=null!==(i=e.paragraph.eventSeqId)&&void 0!==i?i:0,o=null===(n=e.paragraph.parent)||void 0===n?void 0:n.documentModel),!s)return;const a=(0,E.Fd)(s,r,o,e.sourceType,e.data);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelFormattingDelta"},a))},this._textTileNodeEventHandler=e=>{const t=(0,E.XH)(e,this._proofingLanguages.defaultLanguageCode);this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:e.messageType})},this._textTileNodeBatchEventHandler=e=>{const t=e.map((e=>({messageType:e.messageType,data:(0,E.XH)(e,this._proofingLanguages.defaultLanguageCode)})));this.publishEvent("tilingEvent",{messageName:"hostModelBatchTextTile",data:t})},this._textTileDeltaEventHandler=e=>{var t,i;const n=(0,E.IJ)(e.textTileNode.id,null!==(t=e.textTileNode.eventSeqId)&&void 0!==t?t:0,null===(i=e.textTileNode.parent)||void 0===i?void 0:i.documentModel,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,s.pf.ParagraphNode,e.mutationChangeType,this._settings.enableAttributionRangeInAddDelta,e.invalidationRanges,e.wordBoundaries);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelDelta"},n.message)),this._handleAttributionDelta(n.message,n.attributionData)},this._handleAttributionDelta=(e,t)=>{(null==t?void 0:t.length)&&this._settings.enableAttributionRangeInAddDelta&&this.publishEvent("tilingEvent",{messageName:"hostModelAttributionDelta",tileId:e.tileId,tileVersion:e.tileVersion,documentModel:e.documentModel,sourceType:e.sourceType,delta:t})},this._stateChangeEventHandler=e=>{const t=this.getTileRootNodeById(e.tileNodeId);t&&this._sendNewTextTileEvent(t),this.publishEvent("stateReset",e)},this._handleRemovedNodesEventHandler=e=>{this.publishEvent("handleRemovedNodes",e)},this._registerChildNodeEventHandler=e=>{this._textTileNodeToRootNode.set(e.childNodeId,e.tileNodeId)},this._unregisterChildNodeEventHandler=e=>{this._textTileNodeToRootNode.delete(e.childNodeId)},this._sendNewTextTileEvent=e=>{const t={tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:s.Q0.Code,isTextNode:!1,tile:void 0,prevId:e.previousNodeId,nextId:e.nextNodeId};this.publishEvent("tilingEvent",{messageName:"hostModelTextTile",data:t,messageType:o.G.NewData})},this._findTextTileNodeById=e=>{var t;const i=this._textTileNodeToRootNode.get(e);if(i)return null===(t=this._textTileNodes.get(i))||void 0===t?void 0:t.getChildById(e)}}async dispose(){if(!this._disposed){for(const e of this._textTileNodes.values())e.unsubscribe("stateReset",this._stateChangeEventHandler),e.unsubscribe("removeTileNode",this._removeTileNodeEventHandler),e.unsubscribe("tileDiff",this._tileDiffEventHandler),e.unsubscribe("paragraphDiff",this._paragraphDiffEventHandler),e.unsubscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),e.unsubscribe("formattingDiff",this._formattingDiffEventHandler),e.unsubscribe("registerChildNode",this._registerChildNodeEventHandler),e.unsubscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),e.unsubscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),e.unsubscribe("textTileNodeEvent",this._textTileNodeEventHandler),e.unsubscribe("textTileNodeBatchEvent",this._textTileNodeBatchEventHandler),e.unsubscribe("textTileDeltaEvent",this._textTileDeltaEventHandler),e.unsubscribe("brokerNodeChange",this._brokerMoveEventHandler),e.unsubscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),e.unsubscribe("brokerReconcile",this._brokerReconcileEventHandler),await e.dispose();this._textTileNodes.clear(),this._disposed=!0}}resetState(){for(const e of this._textTileNodes.values())e.resetState()}setProofingLanguages(e){this._proofingLanguages=e;for(const e of this._textTileNodes.values())e.reconcile({text:e.cachedText,mutationChangeType:s.Q0.Code})}updateSettings(e){this._settings=e;for(const e of this._textTileNodes.values())e.updateSettings(this._getTileRootNodeSettings())}async pushText(e,t){const i=[];for(const t of e){const e=this._getTileRootNodeForExternalId(t.tileNodeId);e.previousNode=this.getPreviousTileRootNode(t.previousNodeId),e.nextNode=this.getNextTileRootNode(t.nextNodeId);const n=e.reconcile(t);n&&i.push(...n)}if(0===i.length)return;const n=this._buildTilesToSend(i,this._proofingLanguages),s={messageType:t,data:{tiles:n,uxLanguage:this._proofingLanguages.defaultLanguageCode}};t!==o.G.RemoveData?this.publishEvent("tilesAvailable",s):this.publishEvent("clearTiles",n)}retireTileNode(e){const t=this._textTileNodes.get(e);t&&(t.retire(),this._textTileNodes.delete(e))}moveTileNode(e,t,i){const n=this._textTileNodes.get(e);if(!n)return;const s=n.documentModel,o=null!=i?i:s,r=n.id,a=n.move(o);this._textTileNodes.delete(e),this._textTileNodes.set(t,n);const l=(0,E.BX)(r,a,n.eventSeqId,n.cachedText,this._proofingLanguages.defaultLanguageCode,n.previousNodeId,n.nextNodeId,s,o);this.publishEvent("tilingEvent",Object.assign({messageName:"hostModelMoveTextTile"},l))}_buildTilesToSend(e,t){const i=[];for(const n of e)for(const e of t.codesList)i.push(Object.assign(Object.assign({},n),{proofingLanguages:[e]}));return i}_getTileRootNodeForExternalId(e){let t=this._textTileNodes.get(e);return t||(t=this._textTileNodes.get(e)),t||(t=new T(e,this._getTileRootNodeSettings(),this._logger),this._textTileNodes.set(e,t),t.subscribe("stateReset",this._stateChangeEventHandler),t.subscribe("removeTileNode",this._removeTileNodeEventHandler),t.subscribe("tileDiff",this._tileDiffEventHandler),t.subscribe("paragraphDiff",this._paragraphDiffEventHandler),t.subscribe("paragraphNodeChange",this._paragraphNodeChangeEventHandler),t.subscribe("formattingDiff",this._formattingDiffEventHandler),t.subscribe("textTileNodeEvent",this._textTileNodeEventHandler),t.subscribe("textTileNodeBatchEvent",this._textTileNodeBatchEventHandler),t.subscribe("textTileDeltaEvent",this._textTileDeltaEventHandler),t.subscribe("registerChildNode",this._registerChildNodeEventHandler),t.subscribe("unregisterChildNode",this._unregisterChildNodeEventHandler),t.subscribe("handleRemovedNodes",this._handleRemovedNodesEventHandler),t.subscribe("brokerNodeChange",this._brokerMoveEventHandler),t.subscribe("brokerProcessCritiqueAction",this._brokerCritiqueActionEventHandler),t.subscribe("brokerReconcile",this._brokerReconcileEventHandler),this._sendNewTextTileEvent(t)),t}getTileRootNodeById(e){return this._textTileNodes.get(e)}_getTileRootNodeSettings(){return Object.assign(Object.assign({},this._settings),{proofingLanguages:this._proofingLanguages.codesList})}getParagraphFinder(){return{findParagraph:e=>this._findTextTileNodeById(e),getParagraphText:e=>{const t=e.parent;if(!t)return;return t.cachedText.content.slice(e.range.offset,e.range.offset+e.range.span)},getParagraphTextForCritique:(e,t)=>{const i=e.parent;if(!i)return;const n=t.endNode?this._findTextTileNodeById(t.endNode.nodeId):e;if(!n)return;const s=t.endNode?n.range.offset+t.endNode.end:t.start+t.length,o=i.cachedText.content;if(n.parent===i)return o.substring(t.start,s).replace(/\u00A0/g," ");let r,a=o.substring(t.start)+"\n",l=i;do{if(r=l.nextNode,!r||"#tail#"===r)return;l=r;const e=l===n.parent,t=e?s:void 0,i=e?"":"\n";a+=l.cachedText.content.substring(0,t)+i}while(l!==n.parent);return a},isCritiqueInNode:(e,t)=>t.nodeId!==e.id&&!(t.start>=e.range.offset+e.range.span||e.range.offset>=t.start+t.length),getTileRootNodeById:e=>this.getTileRootNodeById(e),getTileNodeParagraphs:e=>{var t;return null===(t=this._textTileNodes.get(e))||void 0===t?void 0:t.children}}}async processTileCritiques(e){const t=e.tileNodeId;for(const i of e.critiques)i.tileId&&(i.tileId.nodeId=t);this.publishEvent("critiquesAvailable",{tileNodeId:t,critiques:e.critiques,messageType:e.messageType})}getPreviousTileRootNode(e){return void 0===e||"#head#"===e?e:this._getTileRootNodeForExternalId(e)}getNextTileRootNode(e){return void 0===e||"#tail#"===e?e:this._getTileRootNodeForExternalId(e)}}},489009:(e,t,i)=>{var n,s;i.d(t,{f:()=>s}),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized",e.ActionDisableCritique="ActionDisableCritique",e.OverflowMenuClicked="OverflowMenuClicked",e.UndoCalloutShown="UndoCalloutShown",e.PersonalizedUndoCalloutShown="PersonalizedUndoCalloutShown",e.SquiggleTooltipShown="SquiggleTooltipShown",e.CritiquesShown="CritiquesShown"}(n||(n={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError"}(s||(s={}))},489282:(e,t,i)=>{i.d(t,{tx:()=>S});var n=i(379490),s=i(753031),o=i(46692),r=i(794300),a=i(383714),l=i(229906),d=i(83010),c=i(738550),u=i(818955),g=i(436672);let h=class extends g.t{constructor(e){super(e)}checkUserInfo(){return void 0===this.ageGroup||this.ageGroup===c.P2.Adult||this.ageGroup===c.P2.MinorNoParentalConsentRequired||this.ageGroup===c.P2.Unknown}};h=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.e))],h);let p=class extends g.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===c.P2.NotAdult}};p=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.e))],p);let m=class extends g.t{constructor(e){super(e)}checkUserInfo(){return this.ageGroup===c.P2.MinorWithoutParentalConsent||this.ageGroup===c.P2.MinorWithParentalConsent}};m=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(u.e))],m);var f=i(427603),v=i(838641),y=i(691474),_=i(838630),I=i(298070);const C={enableConflictDetectionAnnouncement:!1,enableUpsellFeature:!1,enableMultiLanguageAnnouncement:!1,enableNotifications:!1,enableOptimizedCallingPattern:!1,enableOptimizedRehydration:!1,enablePostUpsellAnnouncement:!1,enableInternalMailFeedback:!1,enableOrchestration:!1,enableV2RoamingDictionary:!1,enableSignInAnnouncement:!1,enableSignInAnnouncementAlternativeText:!1,enableRateExtensionPrompt:!1,enableRateExtensionPromptEdge:!1,enableRateExtensionPromptFpsSurvey:!1,enableEnhancedUpsell:!1,enablePremiumPreview:!1,enableUnsignedInEditor:!1,enableSuppressUnsignedInEditorForMultiLang:!1,enableCritiqueSettings:!1,enableOcvIntEndpoint:!1,enableOcvFeedbackUi:!1,enableE2eMetric:!1,enableKeptMetric:!1,enableAriaStatusElement:!1,enableCssHighlightApiAnnouncementsOnly:!1,enableLineNavAriaAnnouncement:!1,enableCSSHighlightApiSquiggleRendering:!1,enableVisibilityTracker:!1,enableSquigglesUpdateThrottling:!1,mutationObserverBasedRelativePosition:!1,visibilityTrackerShouldTrackSquiggles:!0,enableCursorIntersectionObserver:!1,isMsitUser:!1,enableDispatchCritiquesOnEmptyDiffs:!0,enableSignInAnnouncementReshownWeekly:!1,enableSignInAnnouncementReshownBiweekly:!1,enableSignInAnnouncementReshownMonthly:!1,enableTargetedUpsell:!1,inferenceCritiqueCloudIconEnabled:!1,enableAutoCorrect:!1,enablePersonalizedAutoCorrect:!1,enableParagraphUpdates:!1,enableForceClearCritiques:!0,enableConditionalSignInMessage:!1,disableCalcLengthForAddDeltasInPresentation:!0,enableAnnotationActivationConfig:!0,enableAutoCorrectInputCache:!1,enableBetaExperience:!1,enableRoamingService:!1,enableWacCrossPromo:!1,enableAriaStatusPostMessage:!1,enableAriaStatusInNonRootIFrames:!1,enablePhraseTextUnitClientSide:!1,enableAadc:!1,enableBetaExperienceTelemetry:!1,enableUserDictionaryAnnouncement:!1,enableParagraphDeltas:!1,enableOrchestratorOverriddenCritiqueTypeOptions:!1,enableOrchestratorCritiqueDeletion:!1,enableRequiredServiceDataOnly:!1,disableBxOptionalPrivacySetting:!1,enableParagraphDeltasVerboseLogging:!1,enableParagraphDeltasEmptyInitialTile:!1,enableGDocsAnnotatedCanvas:!1,disableTileNodeObserver:!1,enableQueryOnlyOnLocalChange:!1,enableSvgSquiggleUnderline:!1,enableEditorServiceRouting:!1,enableCopywriter:!1,disableCalloutOnDoubleClick:!1,disableAutoBrowserVirtualizationOfSquiggles:!1,enableGDocsSuppressNativeSquiggles:!1,enableUserInfoCountry:!1,enableNonProveableElements:!0,enableSynonyms:!1,enableAiInsert:!1,enableAiInsertForInputTexarea:!1,enableSquigglesOnlyOnWholeWords:!1,disableECCMenuRecreationOnALReconnection:!1,enableLoggingModulesAndBindings:!1,enableResignInPrompt:!1,enableMagicWindow:!1,enableAttributionRangeExceptionInFormattedTextDeltas:!1,enableAttributionRangeInAddDelta:!1};let S=class{constructor(e,t,i,n,s,o){this._emitter=e,this._storeEntryReader=t,this._logger=i,this._isAdult=n,this._isMinor=s,this._isChild=o,this._defaultAdultOnlyFeature={enableUpsellFeature:!0},this._defaultMinorAndAboveFeature={enableBxTelemetry:!0,enableRateExtensionPrompt:!0,enableRateExtensionPromptEdge:!0,enableRateExtensionPromptFpsSurvey:!0,enableOcvIntEndpoint:!0,enableOcvFeedbackUi:!0,enableUninstallSurvey:!0},this._defaultFeatureFlags=Object.assign(Object.assign(Object.assign({},this._defaultMinorAndAboveFeature),this._defaultAdultOnlyFeature),C),this._rolloutFeatureFlags=(0,I.Tm)(I.Hs.FeatureFlags,C),this._localFlags=Object.assign({},this._defaultFeatureFlags),this._flagOverrides={},this.updatedAdultOnlyFeatureFlags=e=>{var t;const i=!this.areAgeGroupPredicatesProvided()||!!(null===(t=this._isAdult)||void 0===t?void 0:t.check()),n=Object.assign({},this._defaultAdultOnlyFeature);for(const t in this._defaultAdultOnlyFeature)n[t]=i&&e[t];return n},this.updateMinorAndAboveFeatureFlags=e=>{var t,i;const n=!this.areAgeGroupPredicatesProvided()||(!!(null===(t=this._isMinor)||void 0===t?void 0:t.check())||!!(null===(i=this._isAdult)||void 0===i?void 0:i.check())),s=Object.assign({},this._defaultMinorAndAboveFeature);for(const t in this._defaultMinorAndAboveFeature)s[t]=n&&e[t];return s},this.areAgeGroupPredicatesProvided=()=>!!(this._isAdult&&this._isChild&&this._isMinor),this._eventPublisher=new r.z}get flags(){return this._localFlags}overrideFlags(e){this._flagOverrides=e,this.applyFlagOverrides()}applyFlagOverrides(){this._localFlags=Object.assign(Object.assign({},this._localFlags),this._flagOverrides)}async refreshFlags(){return await this.updateFlags(),this.flags}async initialize(){this._emitter.on(I.Hs.FeatureFlags,(()=>{this.updateFlags()})),await this.updateFlags()}shutDown(){}async updateFlags(){try{const e=await this._storeEntryReader.readOrInitialize(this._rolloutFeatureFlags);let t=Object.assign(Object.assign({},this._defaultFeatureFlags),...Object.entries(e).map((([e,t])=>{return{[e]:(i=t,"string"==typeof i?"true"===i.toLowerCase():!0===i)};var i})));if(t.enableAadc){const e=this.updateMinorAndAboveFeatureFlags(t),i=this.updatedAdultOnlyFeatureFlags(t);t=Object.assign(Object.assign(Object.assign({},t),e),i)}this._localFlags=t,this.applyFlagOverrides(),this.publishEvent("flagsChanged",this.flags)}catch(e){this._logger.logEvent(571318787,v.s.FeatureFlagParsingError,s.q.Error,void 0,o.o.SamplingPolicy.Diagnostics)}}subscribe(e,t){this._eventPublisher.subscribe(e,t)}unsubscribe(e,t){this._eventPublisher.unsubscribe(e,t)}publishEvent(e,t){this._eventPublisher.publishEvent(e,t)}};S=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(y.E)),(0,n.__param)(1,(0,d.W)(_.A)),(0,n.__param)(2,(0,d.W)(a.g)),(0,n.__param)(3,(0,f.l)()),(0,n.__param)(3,(0,d.W)(h)),(0,n.__param)(4,(0,f.l)()),(0,n.__param)(4,(0,d.W)(p)),(0,n.__param)(5,(0,f.l)()),(0,n.__param)(5,(0,d.W)(m))],S)},492768:(e,t,i)=>{if(i.d(t,{wn:()=>a}),0!=i.j)var n=i(57980);if(0!=i.j)var s=i(786132);const o='style[data-merge-styles="true"], style[data-load-themed-styles="true"], style#ms-prediction-style';function r(e,t,i){var n,s;for(const o of e){if(!(o.dataset.bindId?t.head.querySelector(`style[data-bind-id='${o.dataset.bindId}']`):null)&&(null===(n=o.sheet)||void 0===n?void 0:n.cssRules.length)){const e=t.createElement("style");Array.from(o.attributes).forEach((t=>{t.nodeValue&&e.setAttribute(t.nodeName,t.nodeValue)}));const n=o.dataset.bindId||i.generate();o.dataset.bindId=n,e.dataset.bindId=n,t.head.appendChild(e);for(let t=0;t<o.sheet.cssRules.length;t++){const i=o.sheet.cssRules.item(t);i&&(null===(s=e.sheet)||void 0===s||s.insertRule(i.cssText,t))}}}}function a(e,t,i=o,a=document){r(Array.from(a.querySelectorAll(i)),e,t);const l=new MutationObserver((n=>{const o=[],l=Array.from(a.querySelectorAll(i));for(const e of n){const t=Array.from(e.addedNodes).filter((e=>(0,s.C)(e,"HTMLStyleElement")));for(const e of t){const t=l.find((t=>t.isSameNode(e)));t&&o.push(t)}}o.length&&r(o,e,t)}));l.observe(a.head,{childList:!0,subtree:!0});const d=n.nr.getInstance().onInsertRule((()=>{!function(e,t){var i,n;if(e.length)for(const s of e){const e=t.head.querySelector(`style[data-bind-id="${s.dataset.bindId}"]`);if((null===(i=s.sheet)||void 0===i?void 0:i.cssRules.length)&&(null===(n=null==e?void 0:e.sheet)||void 0===n?void 0:n.cssRules.length))for(let t=e.sheet.cssRules.length;t<s.sheet.cssRules.length;t++){const i=s.sheet.cssRules.item(t);i&&e.sheet.insertRule(i.cssText,t)}}}(Array.from(a.querySelectorAll("style[data-bind-id]")),e)}));return()=>{l.disconnect(),d()}}},493077:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(668952).f)("IResourceUrlFormatter")},493434:(e,t,i)=>{i.d(t,{C:()=>T,f:()=>E});var n=i(379490),s=i(67573),o=i(823325),r=i(537969),a=i(756857),l=i(279e3),d=i(937126),c=i(826663),u=i(392632),g=i(331408),h=i(163573),p=i(877931),m=i(576516),f=i(538045),v=i(955377),y=i(157698),_=i(965285),I=i(229906),C=i(66008),S=i(83010),b=i(427603);let T=class extends _.H{constructor(e,t,i,n,r,a,l,d,c,u){super(e,t,i,n,a,l,d,u),this._localizer=r,this._paragraphTextExtractor=c,this.onFlagAnnotationUpdate=e=>{var t,i,n;const r=e.message.messageType,a=e.message.data;if(r===o.G.NewData&&a.results.length>0){const n=a.results.filter((e=>"GraphSearch"===e.ownerId));if(E(this._hostSettings)){const o=n.filter((e=>e.results[0].entityType===m.c.Topic)),r=[];for(const e of o){const n={entities:e.results.map((e=>Object.assign(Object.assign({},e),{icon:{iconName:"Hashtag"}}))),entityType:m.c.Topic,groupTitle:this._localizer.getMessage("ebx_CIQFlagTopicTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTopicSubtitle")},o=this._paragraphTextExtractor.getParagraphText(a.tileId),l=null!==(t=e.context)&&void 0!==t?t:null==o?void 0:o.substring(e.range.start,e.range.start+e.range.length);if(!l)continue;const d=a.annotationId+(null===(i=e.M_)||void 0===i?void 0:i.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(a.annotationId);e||(e=new Set),e.add(d)}r.push({annotationId:d,traceId:d,languageId:e.language,nodeId:a.tileId,nodeVersion:a.tileVersion,textInContext:l,start:e.range.start,length:e.range.length,supportedActions:s.lb.Ignore|s.lb.IgnoreAll,supportedEntityTypes:[m.c.Topic],suggestionItems:[n],additionalData:e,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTopicTooltipTitle")})}this.addFlags(e.address,r)}}else if(r===o.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(a.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,a.annotationId)}},this.onApplyFlag=(e,t,i,n)=>{var s,o;if(!t.annotationId)return;const r=this._annotationMap.get(t.annotationId);r&&(this._annotationMap.delete(t.annotationId),(null===(o=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.flagAnnotationSettings)||void 0===o?void 0:o.flagInsertionCallback)&&this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(r.additionalData,n,e.parent.element,i,t))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return g.L9.CIQFlag_Topic}};function E(e){var t,i;return(0,u.f1)(e.flightsToTrack,null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,m.c.Topic,"mc-editor-oa-topics-flags")}T=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.t)(r.zJ)),(0,n.__param)(1,(0,S.W)(h.n)),(0,n.__param)(2,(0,S.W)(f.w)),(0,n.__param)(3,(0,S.W)(p.g)),(0,n.__param)(4,(0,S.W)(a.H)),(0,n.__param)(5,(0,S.W)(l.$)),(0,n.__param)(6,(0,S.W)(v.W)),(0,n.__param)(6,(0,b.l)()),(0,n.__param)(7,(0,S.W)(d.f)),(0,n.__param)(8,(0,S.W)(y.b)),(0,n.__param)(9,(0,b.l)()),(0,n.__param)(9,(0,S.W)(c.K))],T)},494163:(e,t,i)=>{i.d(t,{z:()=>o});var n=i(623750),s=i.n(n);class o{constructor(){this.getIndex=e=>e.index>=0?e.index:e,this.getNewValue=(e,t)=>e.index>=0?(e.index=t,e):t,this._dmp=new(s()),this._dmp.Diff_Timeout=0}getReadjustedIndices(e,t,i,n){var s;const o=[],r=null!==(s=e.textContent)&&void 0!==s?s:"",a=n?this._dmp.diff_main(i,r):this._dmp.diff_main(r,i);if(1===a.length&&0===a[0][0])return t;let l=0,d=0,c=0,u=0,g=0,h=0;for(const e of a){const i=e[0],n=e[1].length;switch(i){case 0:g=n,h=n;break;case 1:g=0,h=n;break;case-1:c+=n;continue}d+=c,c=0;for(let e=l;e<t.length;e+=1){const n=this.getIndex(t[e]);if(n<u)throw new Error("Indices are not sorted!");if(!(n>=u&&n<u+h))break;o[e]=0===i?this.getNewValue(t[e],n+d-u):this.getNewValue(t[e],d),l+=1}if(l===t.length)break;d+=g,u+=h}for(let e=l;e<t.length;e+=1)o[e]=this.getNewValue(t[e],d);return o}}},494888:(e,t,i)=>{i.d(t,{c:()=>n});const n=(0,i(668952).f)("IFeatureFlagsReader")},495170:(e,t,i)=>{i.d(t,{R:()=>o});var n=i(379490),s=i(229906);let o=class{findBeginBoundary(e,t,i){return Math.min(t,i)}findEndBoundary(e,t,i){return e.length<i?-1:Math.max(t,i)}splitInUnits(e){return[e.length]}};o=(0,n.__decorate)([(0,s._)()],o)},495488:(e,t,i)=>{i.d(t,{S:()=>n});const n=({topicIds:e,topicNames:t,highlightedText:i,hostMetadata:n,requestId:s,source:o,traceId:r})=>{const a=`&body=${encodeURIComponent(`Tell us about your experience with this topic suggestion. Was the suggestion accurate or helpful?\n    \n\n\n\nEngineering notes:\n_______________________________\n\n    TopicIds: ${e}\n\n    TopicNames: ${t}\n\n    HighlightedText: ${i}\n\n    HostMetadata: ${n}\n\n    KMAPIRequestId: ${s}\n\n    Source: ${o}\n\n    TraceId: ${r}\n_______________________________\n`)}`;return"mailto:projecthedleyfeedback@service.microsoft.com?subject=Viva Topics Editor Suggestion Feedback"+encodeURIComponent(": "+i)+a}},495980:(e,t,i)=>{i.d(t,{$:()=>n});class n{constructor(){this.queries=[]}get allQueries(){return this.queries}get currentQuery(){return this._currentQuery}getQueryById(e){return this.queries.find((t=>t.additionalData.logicalId===e))}addQuery(e){this.queries.push(e),this._currentQuery=e}removeQuery(e){var t;this.queries=this.queries.filter((t=>t.additionalData.logicalId!==e)),(null===(t=this._currentQuery)||void 0===t?void 0:t.additionalData.logicalId)===e&&(this._currentQuery=void 0)}clear(){this.queries=[],this._currentQuery=void 0}clearCurrentQuery(){this._currentQuery=void 0}}},496174:(e,t,i)=>{i.d(t,{b:()=>m});var n=i(208520),s=i(252723),o=i(108520);if(0!=i.j)var r=i(119228);var a=i(522775),l=i(184226),d=i(77127);if(0!=i.j)var c=i(579990);if(0!=i.j)var u=i(696767);const g=e=>{switch(e){case a.Y.critique:return"footer_fre_in_critique_callout";case a.Y.inlineSuggestions:return"footer_fre_in_inline_suggestion_callout";default:return"footer_fre_generic"}},h=()=>{const e=(0,u.$)().getStringsFor("OnCanvasCalloutStrings"),t={nextPageTooltip:e("footerFRE_nextPageTooltip"),paginationTipsText:e("footerFRE_paginationTipsText"),previousPageTooltip:e("footerFRE_previousPageTooltip")};return{footer:e=>t[e]||""}},p=(0,s.F5)({themeStore:o.A.on(d.YQ).optional(),footerFreStore:o.A.on(a.D).optional(),languageScriptDirectionDetector:o.A.on(l.iw).optional()}),m=e=>{const{target:t,styles:i}=e,{footerFreStore:o,languageScriptDirectionDetector:a,themeStore:l}=(0,s.SM)(p),[u,m]=n.useState((()=>null==o?void 0:o.footerProps.get(t)));n.useEffect((()=>{if(!o)return;const e=e=>{const i=e.footerProps.get(t);m(i?Object.assign({},i):void 0)};return o.subscribe("stateUpdated",e),()=>{o.unsubscribe("stateUpdated",e)}}),[o,t]);const[f,v]=n.useState(null==l?void 0:l.getComponentActiveTheme(d.yF.footerFreComponentName,!0));if(n.useEffect((()=>{if(!l)return()=>{};const e=()=>{v(l.getComponentActiveTheme(d.yF.footerFreComponentName,!0))};return l.subscribe("currentThemeUpdated",e),l.subscribe("defaultThemeUpdated",e),l.subscribe("themesUpdated",e),()=>{l.unsubscribe("currentThemeUpdated",e),l.unsubscribe("defaultThemeUpdated",e),l.unsubscribe("themesUpdated",e)}}),[l]),!(null==u?void 0:u.display)||!u.pages.size)return null;const y=n.createElement(r.J,{automationId:g(t),pages:Array.from(u.pages.values()),animated:u.animated,styles:i,strings:h(),theme:f,onDismiss:()=>null==o?void 0:o.setFooterDisplay(t,!1),hideIcon:e.hideIcon});return a?n.createElement(c.K,{rtl:a.isRtl()},y):y}},496814:(e,t,i)=>{var n;i.d(t,{l:()=>n}),function(e){e.AppId="appId",e.EnableCopilotInsert="enableCopilotInsert",e.EnableCopilotRewrite="enableCopilotRewrite",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.EnableSynonymsToggle="enableSynonymsToggle",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.HashedUserDictionary="hashedUserDictionary",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.OverriddenInlineEditingSettings="overriddenInlineEditingSettings",e.PaneOverriddenCritiqueTypeOptions="paneOverriddenCritiqueTypeOptions",e.StealthOverriddenCritiqueTypeOptions="stealthOverriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.DefaultLoggingLevel="defaultLoggingLevel",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId",e.CritiqueValuePerLanguage="critiqueValuePerLanguage",e.EnableTextPrediction="enableTextPrediction",e.EnableCIQFlags="enableCIQFlags",e.EnableCIQMenu="enableCIQMenu",e.IsLanguageAutoDetectEnabled="isLanguageAutoDetectEnabled",e.TonalFREAccepted="tonalFREAccepted"}(n||(n={}))},498689:(e,t,i)=>{if(i.d(t,{D:()=>g}),0!=i.j)var n=i(722864);if(0!=i.j)var s=i(341755);if(0!=i.j)var o=i(251439);if(0!=i.j)var r=i(386675);if(0!=i.j)var a=i(12870);if(0!=i.j)var l=i(395109);if(0!=i.j)var d=i(499928);if(0!=i.j)var c=i(344646);if(0!=i.j)var u=i(525809);class g{constructor(){this.imports=[n.E,u.f]}get uniqueId(){return(0,o.z)(507918353)}configureRootServices(e){e.bind(l.A).to(c.X),e.bind(r.S).toExisting(l.A),e.bind(s.i).toValue(d.F),e.bind(a.U).to(a.n)}}},499278:(e,t,i)=>{if(i.d(t,{k:()=>o}),0!=i.j)var n=i(576516);const s=e=>!(void 0===e.isScopingEnabled&&void 0===e.showSeparator),o=e=>{if(e.length>0&&e.some(s))return e;const t=e.findIndex((e=>{var t;return(null===(t=e.suggestions[0])||void 0===t?void 0:t.type)===n.c.Scope}));return-1!==t?(e[t]=Object.assign(Object.assign({},e[t]),{isScopingEnabled:!1,showSeparator:!0}),e.concat(e.splice(t,1))):e}},499928:(e,t,i)=>{i.d(t,{F:()=>g});var n=i(208520),s=i(252723),o=i(108520),r=i(756857);if(0!=i.j)var a=i(411180);if(0!=i.j)var l=i(323283);var d=i(395109),c=i(252843);const u=(0,s.F5)({state:o.A.on(d.A),localizer:o.A.on(r.H)}),g=()=>{const{state:e,localizer:t}=(0,s.KN)(u),[i,o]=n.useState(e.isVisible);n.useEffect((()=>{const t=e=>{o(e.visible)};return e.subscribe("tooltipStateUpdated",t),()=>{e.unsubscribe("tooltipStateUpdated",t)}}),[e]);const{styles:r,fontsUrl:d,targetDocumentRef:g}=e,h=n.useCallback((()=>{e.hide()}),[e]),p=n.useCallback((()=>{e.emergencyDismiss("Tooltip dismissed on click.")}),[e]);return n.useEffect((()=>{var e,t;const i=new l.J(g),n=new l.J(null!==(t=null===(e=g.deref())||void 0===e?void 0:e.defaultView)&&void 0!==t?t:window);return i.addListener("scroll",h,{capture:!0}),n.addListener("resize",h,{capture:!0}),()=>{i.removeAllListeners(),n.removeAllListeners()}}),[h,g]),n.createElement("div",{style:r.container},d&&n.createElement("link",{rel:"stylesheet",href:d}),n.createElement(c.Ay.div,{style:r.shadowBoundary},(()=>{const{top:s,right:o,left:r,ariaLabel:l,title:d,text:c,styles:u,isEccOpen:g}=e;return!i||g?null:n.createElement("div",{role:"status","aria-live":"polite",id:a.y,style:u.shadowRoot},n.createElement("div",{onClick:p,style:Object.assign(Object.assign({},u.root),{top:s,left:r,right:o}),role:"tooltip","aria-label":t.getMessage("combineSentences",[d,l])},n.createElement("div",{"aria-hidden":!0,style:u.tooltipMain},n.createElement("div",{"aria-hidden":!0,style:u.title},d),n.createElement("div",{"aria-hidden":!0,style:u.text},c))))})()))}},501988:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"簡潔な表現","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"表記の揺れ","IsImplemented":true},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"非差別用語"},"Typing errors":{"LocalizedName":"入力ミス","IsImplemented":false},"Clarity":{"IsImplemented":true,"LocalizedName":"明瞭な表現"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"編集","IsImplemented":false},"Error Corrections":{"IsImplemented":true,"LocalizedName":"誤りのチェック"},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"語彙の考慮"},"Grammar":{"LocalizedName":"文法","IsImplemented":false},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"正式な用法","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"句読点","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"表記の基準","IsImplemented":true},"Spelling":{"IsImplemented":false,"LocalizedName":"スペル"},"Resume":{"LocalizedName":"履歴書","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"地政的に配慮すべき用語","IsImplemented":true}}')},502653:(e,t,i)=>{i.d(t,{JL:()=>a,Xr:()=>d,m1:()=>l,yy:()=>c});i(220029);if(0!=i.j)var n=i(344690);if(0!=i.j)var s=i(700509);if(0!=i.j)var o=i(947463);if(0!=i.j)var r=i(553164);function a(e){let t=!1,i={};for(const t of e)i[t[0]]=t[1];return{registerNode:e=>i[e.id]=e,unregisterNode:e=>delete i[e.id],findNode:e=>{var t;const n={nodeType:r.Z.TileNode,id:e,element:null!==(t=Object.values(i)[0])&&void 0!==t?t:null,children:[],retire:()=>{},move:()=>{var e;return null!==(e=Object.values(i)[0])&&void 0!==e?e:null},resetState:()=>{}};return i[e]?i[e]:n},findTileNode:e=>{var t;return null!==(t=i[e])&&void 0!==t?t:null},tileNodes:Object.values(i).filter((e=>e.nodeType!==r.Z.ParagraphNode)),findParagraphNode:e=>{var t;return null!==(t=i[e])&&void 0!==t?t:null},findTerminalNode:e=>{var t;return null!==(t=i[e])&&void 0!==t?t:null},getTileNodeV2Paragraphs:e=>{var t,n;return null!==(n=null===(t=i[e.id])||void 0===t?void 0:t.children)&&void 0!==n?n:null},addNode:()=>{},removeNode:()=>{},setTextProcessingParagraphFinder:e=>{},get disposed(){return t},async dispose(){t=!0,i={}}}}function l(e,t,i=!1){const s={appId:"Compatibility_Mode",brandingMode:4,showOptionsButton:!0,defaultLocale:"en-US",proofingLocales:["en-US"],controlIconSetName:"FabricMDL2Icons",synonymsEndPoint:n.i.Prod,editorEndPoint:n.G.Lab,userId:{puid:"testUserId",identityProvider:o.UW.AAD,userDisplayName:"Test User",tenantId:"12345",email:"none"},licenseType:o.G_.Subscription,sessionType:0,upsellLink:"https://upselllink",ignoreAllEnabled:!0,ignoreOnceEnabled:!0,enableOptimizedCallingPattern:!0,maxSuggestionItemsDisplayNumber:3,maxSuggestionDisplayPerLanguageNumber:2,enableOrchestration:!0,newLineSentenceSeparatorEnabled:!0,enableE2eMetric:!1,manageRtlInEditorUx:!1,manageRtlForProofingLanguage:!1,enableUpsellFeature:!1,enhancedUpsellEnabled:!1,premiumPreviewEnabled:!1,enableClearingOfRequestedAnimationFrames:!1,serviceSettings:e,enableCSSHighlightApiSquiggleRendering:t},r={editorEndPoint:n.G.Int,flightsToTrack:["TestingFlight"],wordCountDetectorEnabled:!0,enabledCorrectionCategories:[{id:"spelling",name:"Spelling"},{id:"grammar",name:"Grammar"}],enabledRefinementCategories:[{id:"clarity",name:"Clarity"},{id:"conciseness",name:"Conciseness"},{id:"formality",name:"Formality"},{id:"inclusiveness",name:"Inclusiveness"},{id:"puncConventions",name:"Punctuation Conventions"},{id:"sensitiveGpRef",name:"Sensitive Geopolitical References"},{id:"vocabulary",name:"Vocabulary"}],enabledEnhancementCategories:[{id:"headingDetection",name:"Heading Detection"},{id:"entityDetection",name:"People / Date Recognition"},{id:"taskRecognition",name:"Task Recognition"},{id:"vivaTopics",name:"Topics"},{id:"addressDetection",name:"Address Detection"},{id:"loopSuggestion",name:"Loop Suggestion"},{id:"satoriEntity",name:"Entity Suggestion"}],enableStopCheckingForThis:!0};return Object.assign(Object.assign(Object.assign({},s),r),{showSquiggleTooltip:!0,enableCaretPositionRestore:!0,enableAutoCorrect:i,enablePersonalizedAutoCorrect:!1,sdkV2Enabled:!0})}function d(){return{editorSpellcheckAttribute:"data-ms-editor",narrowOnChangeReconciliation:!1,schedulerDefaultWaitingTime:50,schedulerDefaultMaxTime:2e3,maxContentLengthInChars:2e4,schedulerDefaultWaitingTimeIncrement:400,completeTileTextUnit:s.fT.Sentence,partialTileTextUnit:s.fT.Sentence,styleSampleTime:10,enableTileNodeAutoReconciliation:!0,reconcileTileNodeTime:3e3,defaultUxLanguage:"en-US"}}function c(){return{enableOptimizedCallingPattern:!0,enableOptimizedRehydration:!0,enableOrchestration:!0,enableDispatchCritiquesOnEmptyDiffs:!0,enableParagraphDeltas:!0,enableParagraphUpdates:!0,enableForceClearCritiques:!0,enableParagraphDeltasEmptyInitialTile:!0,disableCalcLengthForAddDeltasInPresentation:!0,enableSquigglesOnlyOnWholeWords:!0,enablePhraseTextUnitClientSide:!1,enableAutoCorrect:!1,enableAutoCorrectInputCache:!1,enablePersonalizedAutoCorrect:!1,disableTileNodeObserver:!1,enableVisibilityTracker:!0,visibilityTrackerShouldTrackSquiggles:!0,enableSquigglesUpdateThrottling:!0,enableSvgSquiggleUnderline:!0,disableCalloutOnDoubleClick:!0,disableAutoBrowserVirtualizationOfSquiggles:!1,mutationObserverBasedRelativePosition:!1,enableCursorIntersectionObserver:!1,enableAriaStatusPostMessage:!1,enableAriaStatusInNonRootIFrames:!0,enableAriaStatusElement:!0,enableLineNavAriaAnnouncement:!0,enableCssHighlightApiAnnouncementsOnly:!1,enableCSSHighlightApiSquiggleRendering:!1,enableConflictDetectionAnnouncement:!1,enableUpsellFeature:!1,enableMultiLanguageAnnouncement:!1,enableNotifications:!1,enablePostUpsellAnnouncement:!1,enableInternalMailFeedback:!1,enableV2RoamingDictionary:!1,enableSignInAnnouncement:!1,enableSignInAnnouncementAlternativeText:!1,enableRateExtensionPrompt:!1,enableRateExtensionPromptEdge:!1,enableRateExtensionPromptFpsSurvey:!1,enableEnhancedUpsell:!1,enablePremiumPreview:!1,enableUnsignedInEditor:!1,enableSuppressUnsignedInEditorForMultiLang:!1,enableCritiqueSettings:!1,enableOcvIntEndpoint:!1,enableOcvFeedbackUi:!1,enableE2eMetric:!1,enableKeptMetric:!1,isMsitUser:!1,enableSignInAnnouncementReshownWeekly:!1,enableSignInAnnouncementReshownBiweekly:!1,enableSignInAnnouncementReshownMonthly:!1,enableTargetedUpsell:!1,inferenceCritiqueCloudIconEnabled:!1,enableConditionalSignInMessage:!1,enableAnnotationActivationConfig:!1,enableBetaExperience:!1,enableRoamingService:!1,enableWacCrossPromo:!1,enableAadc:!1,enableBetaExperienceTelemetry:!1,enableUserDictionaryAnnouncement:!1,enableOrchestratorOverriddenCritiqueTypeOptions:!1,enableOrchestratorCritiqueDeletion:!1,enableRequiredServiceDataOnly:!1,disableBxOptionalPrivacySetting:!1,enableParagraphDeltasVerboseLogging:!1,enableGDocsAnnotatedCanvas:!1,enableQueryOnlyOnLocalChange:!1,enableEditorServiceRouting:!1,enableCopywriter:!1,enableGDocsSuppressNativeSquiggles:!1,enableUserInfoCountry:!1,enableNonProveableElements:!1,enableSynonyms:!1,enableAiInsert:!1,enableAiInsertForInputTexarea:!1,disableECCMenuRecreationOnALReconnection:!1,enableLoggingModulesAndBindings:!1,enableResignInPrompt:!1,enableMagicWindow:!1,enableAttributionRangeExceptionInFormattedTextDeltas:!1,enableAttributionRangeInAddDelta:!1}}},502929:(e,t,i)=>{i.d(t,{AX:()=>y,hJ:()=>v,ip:()=>f});var n=i(208520),s=i(924083),o=i(966727),r=i(331408),a=i(753031),l=i(687267),d=i(906686),c=i(48644),u=i(468576),g=i(268402),h=i(731857),p=i(681156);const m=function(e){return t=>{var i;const{critique:l,squiggleKind:d,closeCallout:c,showTooltip:u,closeTooltip:m,submitTelemetryEvent:f,contextualCardTriggers:v}=t,{keyboard:y,mouse:_}=v,I=null!==(i=t.squiggleRef)&&void 0!==i?i:n.useRef(null),C=(0,p.H)(l,!!t.isAutoCorrectionEnabled,"critique"),S=n.useCallback((e=>{null==f||f({telemetryLog:Object.assign(Object.assign({},e),{logType:"Event",level:a.q.Info})})}),[f]),b=n.useCallback((()=>({critiquePriority:l.priority,critiqueTypeId:l.typeIdRaw,critiqueTraceId:l.traceId,critiqueSourceData:l.sourceData,squiggleKind:d})),[l,d]),T=n.useCallback(((e,i=s.c.MainButtonPressed)=>{var n;const r=t.useSvgUnderline?o.fQ[C]:0;t.onCallOut(I.current,l,null!==(n=l.textInContext)&&void 0!==n?n:"","keyboard"===e,(()=>{}),t.element,"critique",(0,h.e)(t.data),r),S("keyboard"===e?{eventName:"CritiqueCardShownViaKeyboardAction",data:b()}:(0,g.OW)(i,b()))}),[l,S,C,t,I,b]),E=n.useCallback((()=>c(l.traceId)),[c,l]),N=_.includes(s.v.SecondaryButtonPressed),w=N?()=>T("mouse",s.c.SecondaryButtonPressed):()=>S({eventName:"RightClickOnSquiggle",data:b()}),x=_.includes(s.v.MainButtonPressed)?()=>T("mouse",s.c.MainButtonPressed):()=>S({eventName:"LeftClickOnSquiggle",data:b()});n.useEffect((()=>{_.includes(s.v.Hover)&&(t.isMouseOver?T("mouse"):t.isCalloutOpened||c(l.traceId))}),[_,t.isMouseOver,t.isCalloutOpened,T,c,l.traceId,t.isCaretOver]);const L=l.typeId?"ms-squiggle-"+function(e,t){const i=Object.keys(e).filter((i=>e[i]===t));return i.length>0?i[0]:null}(r.L9,l.typeId):void 0,D=`ms-squiggle ms-squiggle-${l.priority} ${L} ${t.isCalloutOpened||t.isHighlighted?"hl":""} ${t.stealth?"stealth":""}`,A=t.isMouseOver?"mouse":t.isCaretOver?"keyboard":void 0,F=A&&!t.isCalloutOpened;return n.useEffect((()=>{F?u(d,I.current,l,A):m(l.traceId)}),[l,F,I,A,u,d,m]),n.useEffect((()=>()=>{m(l.traceId)}),[m,l]),e(Object.assign(Object.assign({},t),{patternName:C,className:D,squiggleRef:I,handleContextMenuEvent:N,openCalloutPredicate:e=>("ContextMenu"===e.key&&S({eventName:"ContextMenuKeyUpEventOnSquiggle",data:b()}),y.some((t=>t(e)))),onKeyboardEvent:()=>T("keyboard"),onClick:x,onContextMenuClick:()=>{m(l.traceId,!0)},closeCalloutOnNonLeftClick:E,onRightClickEvent:w,onEscapePress:()=>m(l.traceId)}))}};const f=n.memo(m(l.m),u.I),v=n.memo(m(d.z),u.I),y=n.memo(m(c.G),u.P)},507385:(e,t,i)=>{var n;i.d(t,{M:()=>n}),function(e){e.Diagnostics="Diagnostics"}(n||(n={}))},508030:(e,t,i)=>{if(i.d(t,{k:()=>a}),0!=i.j)var n=i(386675);if(0!=i.j)var s=i(326323);if(0!=i.j)var o=i(256002);if(0!=i.j)var r=i(251439);class a{get uniqueId(){return(0,r.z)(505680986)}configureRootServices(e){e.bind(s.J).to(o.k),e.bind(n.S).toExisting(s.J)}}},511189:(e,t,i)=>{i.d(t,{h:()=>c});var n=i(379490),s=i(46692),o=i(647879),r=i(821003),a=i(877931),l=i(229906),d=i(83010);let c=class{constructor(e,t){this._queryDetection=e,this._logger=t,this._diagosticEventName="OAPanelDiagnostics",this.logDiagnostics=(e,t,i,n)=>{this.logInternal(this._diagosticEventName,e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.logInternal(e,void 0,t,i,n)},this.logInternal=(e,t,i,n,r)=>{var a,l;const d=this._logger.getNewActivity(e,s.o.SamplingPolicy.CriticalExperimentation);null==d||d.dataFields.push(...(0,o.W)(["conversationId",null!==(a=null==r?void 0:r.conversationId)&&void 0!==a?a:this._queryDetection.getCurrentQueryConversationId()||""],["logicalId",null!==(l=null==r?void 0:r.logicalId)&&void 0!==l?l:this._queryDetection.getCurrentQueryLogicalId()||""])),t&&(null==d||d.dataFields.push((0,o.n)("message",t))),i&&(null==d||d.dataFields.push((0,o.n)("data",JSON.stringify(i)))),n&&(null==d||d.dataFields.push(...n)),d&&(d.success=!0,d.endNow())}}};c=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.W)(r.J)),(0,n.__param)(1,(0,d.W)(a.g))],c)},512578:(e,t,i)=>{if(i.d(t,{h:()=>d}),0!=i.j)var n=i(904196);if(0!=i.j)var s=i(251439);if(0!=i.j)var o=i(386675);if(0!=i.j)var r=i(260566);if(0!=i.j)var a=i(433531);if(0!=i.j)var l=i(800691);class d{constructor(){this.imports=[a.g]}get uniqueId(){return(0,s.z)(507918402)}configureRootServices(e){e.bind(r.R9).toDynamicValue((e=>{const t=e.get(n.n);return new r.R9({endpoint:`https://${t.editorEndPoint}/NLEditor`})})),e.bind(o.S).to(l.M)}}},515599:(e,t,i)=>{i.d(t,{p:()=>n});class n extends Error{constructor(e,t,i){super(e),this.dataSource=t.sourceName,this.authStatus=t.getAuthStatus(),this.connectionStatus=t.getConnectionStatus(),this.errResultStatus=i}}},517011:(e,t,i)=>{if(i.d(t,{O:()=>r}),0!=i.j)var n=i(481593);if(0!=i.j)var s=i(287704);if(0!=i.j)var o=i(251439);class r{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918221)}configureRootServices(e){e.bind(n.h).to(s.Q)}}},517119:(e,t,i)=>{i.d(t,{F:()=>D});var n=i(379490),s=i(163573),o=i(229906),r=i(83010);const a="[\0-\b\n--\u2028-\u2029  ]",l="[!-#%-*,-/:-;?-@_{}¡«¬·»¿;·՚-՟։-֊־׀׃׆׳-״؉-؊،-؍؛؞-؟٪-٭۔।-॥॰෴๏๚-๛༄-༒༺-༽྅࿐-࿔၊-၏჻፡-፨᙭-᙮។-៖៘-៚᠀-᠊‐-‧‰-⁃⁅-⁑⁓-⁞、-〃〈-】〔-〟〰〽゠・！-＃％-＊，-／：-；？-＠［-］＿｛｝｟-･]",d="[؀-؃۝᠎​-‍⁠-⁤⁪-⁯]",c="[?!.։۔܁܂।॥።᙮᠃᠉⳹⳾。꓿꘎꛳︒﹒．｡]",u="[。｡]",g="[   -   　\t]",h="[»’”›\"']",p="[)]}༻༽⁆〉》」』】〕〗〙〛〞〟）］｝｠｣]|[☹☺☻]|[​‌]",m="[\u2028\u2029\n\r]",f=`[.。﹒．｡]{2,6}|[.]([ ][.]){1,5}|([Ａ-Ｚａ-ｚ])[.﹒．]|${`${`(${g}|${a}|${l}|${d})`}((((L?X{1,3}|X[LC]|L)?(V?I{1,3}|I[VX]|V))|(L?X{1,3}|X[LC]|L)|((l?x{1,3}|x[lc]|l)?(v?i{1,3}|i[vx]|v))|(l?x{1,3}|x[lc]|l))[.]|((([Ｌ]?[Ｘ]{1,3}|[Ｘ][ＬＣ]|[Ｌ])?([Ｖ]?[Ｉ]{1,3}|[Ｉ][ＶＸ]|[Ｖ]))|([Ｌ]?[Ｘ]{1,3}|[Ｘ][ＬＣ]|[Ｌ])|(([ｌ]?[ｘ]{1,3}|[ｘ][ｌｃ]|[ｌ])?([ｖ]?[ｉ]{1,3}|[ｉ][ｖｘ]|[ｖ]))|([ｌ]?[ｘ]{1,3}|[ｘ][ｌｃ]|[ｌ]))[.﹒．]|([0-9]{1,4}[.]|[０-９]{1,4}[.﹒．])|([0-9]+(([aoªºᵃᵒ])|((er)[ao]?)|(([ᵉ][ʳ])[ᵃᵒ]?)|([mdtvn][ao])|([ᵐᵈᵗᵛⁿ][ᵃʳ]))[.]|[A-Za-zÀÄÈÉÔÖÜßàäèéôöü]+[.]((NR)|(Nr)|(nr))[.]|[A-Za-zÀÄÈÉÔÖÜßàäèéôöü]+((STR)|(str))[.]))`}|${`${`(${g}|${a}|${l}|[$+<=>^\`|~¢£¤¥-©¬®¯°±´¶¸×÷˂-˅˒-˟˥-˫˭˯-˿͵΄΅϶҂؆؇؈؋؎؏۞۩۽۾৲৳৺૱୰௳-௺౿൹฿༁༂༃༓༕༖༗༚-༟༴༶༸྾-࿅࿇-࿌࿎࿏႞႟᎐-᎙៛⁄⁒〄〒〓〠〶〷〾〿゛゜＄＋＜＝＞＾｀｜～￠-￦￨-￮]|${d}|[0-9٠-٩۰-۹०-९০-৯੦-੯૦-૯୦-୯௦-௯౦-౯೦-೯൦-൯๐-๙໐-໙༠-༩၀-၉႐-႙០-៩᠐-᠙０-９]|[²³¹¼½¾৴-৹௰௱௲౸-౾൰-൵༪-༳፩-፼៰-៹〇〡-〩〸〹〺])`}((([A-Za-zªµºÀ-ÐÑ-ÖØ-öø-ƺƼ-ƿǄ-ʓʕ-ͳͶͷͻͼͽΆΈΉΊΌΎ-ΡΣ-ϵϷ-ҁҊ-ԣԱ-Ֆա-ևႠ-Ⴥ]|[ƻǀ-ǃʔא-תװױײء-ؿف-يٮٯ-ۓٱەۮۯۺۻۼۿऄ-हऽॐक़-ॡॲॻ-ॿঅ-ঌএঐও-নপ-রলশ-হঽৎড়ঢ়য়ৠৡৰৱਅ-ਊਏਐਓ-ਙਚ-ਨਪ-ਰਲਲ਼ਵਸ਼ਸਹਖ਼-ੜਫ਼ੲ-ੴઅ-ઍએ-ઑઓ-નપ-રલળવ-હઽૐૠૡଅ-ଌଏଐଓ-ନପ-ରଲଳଵ-ହଽଡ଼ଢ଼ୟ-ୡୱஃஅ-ஊஎ-ஐஒ-கஙசஜஞடணதந-பம-ஹௐఅ-ఌఎ-ఐఒ-నప-ళవ-హఽౘౙౠౡಅ-ಌಎ-ಐಒ-ನಪ-ಳವ-ಹಽೞೠೡೱೲഅ-ഌഎ-ഐഒ-നപ-ഹഽൠൡൺ-ൿඅ-ඖක-නඳ-රලව-ෆກຂຄງຈຊຍດ-ທນ-ຟມ-ຣລວສຫອ-ະາຳຽເ-ໄໆໜໝༀཀ-ཇཉ-ཬྈ-ྋក-ឳៗៜက-ဪဿၐ-ၕၚ-ၝၡၥၦၮ-ၰၵ-ႁႎა-ჺᄀ-ᅙᅟᅠ-ᆢᆨ-ᇹሀ-ቈቊ-ቍቐ-ቖቘቚ-ቝበ-ኈኊ-ኍነ-ኰኲ-ኵኸ-ኾዀዂ-ዅወ-ዖዘ-ጐጒ-ጕጘ-ፚᎀ-ᎏᎠ-Ᏼᐁ-ᙬᙯ-ᙶᠠ-ᡷᢀ-ᢨᢪ〆〼가-힣ﾠ-ﾾￂ-ￇￊ-ￏￒ-ￗￚ-ￜ]|[ก-ะาำเ-ๅ])[.])+|(([ぁ-ゖゟァ-ヺヿ豈-鶴侮-頻並-龎ｦ-ﾝ])[.﹒．])+)`}`,v=new RegExp(`${c}|${u}`,"ig"),y=new RegExp(`${c}|${u}|${m}`,"ig"),_=new RegExp(f,"g");function I(e,t,i=0){const n=[];let s=t.exec(e);for(;null!==s;){if(s[i]){const e=s.index;n.push({begin:e,end:e+s[i].length})}s=t.exec(e)}return n}const C=`(${c}(${p}|${h}|${g})*${m})`,S=`(${c}(${p})*(${g})+)`,b=`(${u}(${p})*)`,T=`((${m})+)`,E=`(${c}(${p}|${h}|${g})*(${m})+)`,N=[new RegExp(C,"ig"),new RegExp(S,"ig"),new RegExp(b,"ig")],w=[new RegExp(S,"ig"),new RegExp(b,"ig"),new RegExp(T,"ig"),new RegExp(E,"ig")],x=new RegExp(`${C}|${S}|${b}`,"ig"),L=new RegExp(`${S}|${b}\n    |${T}|${E}`,"ig");let D=class{constructor(e){this._hostSettings=e}expandEndRange(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?w:N;for(const i of t){const t=I(e,i);if(t.length>0&&0===t[0].begin)return t[0].end-1}return this._hostSettings.newLineSentenceSeparatorEnabled?-1:0}isEndPuncSpecialCase(e){const t=I(e,_),i=this._hostSettings.newLineSentenceSeparatorEnabled?e.length-1:e.length;return t.some((e=>e.end===i))}findBeginBoundary(e,t,i){const n=this._hostSettings.newLineSentenceSeparatorEnabled?y:v,s=e.substring(i,t),o=I(s,n);for(let e=o.length-1;e>=0;e-=1){const t=s.substring(0,o[e].end);if(!this.isEndPuncSpecialCase(t)){const t=s.substring(o[e].begin,s.length),n=this.expandEndRange(t);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===n:!n)continue;return i+o[e].end+n}}return i}findEndBoundary(e,t,i){const n=e.substring(t,i),s=I(n,this._hostSettings.newLineSentenceSeparatorEnabled?y:v);for(const e of s){const i=n.substring(0,e.end);if(!this.isEndPuncSpecialCase(i)){const i=n.substring(e.begin,n.length),s=this.expandEndRange(i);if(this._hostSettings.newLineSentenceSeparatorEnabled?-1===s:!s)continue;return t+e.end+s}}return-1}splitInUnits(e){const t=this._hostSettings.newLineSentenceSeparatorEnabled?L:x;return I(e.replace(_,(e=>"#".repeat(e.length))),t).map((e=>e.end))}};D=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.n))],D)},518341:(e,t,i)=>{i.d(t,{CJ:()=>a,Rr:()=>r});const n="(-ms-high-contrast: active), (forced-colors: active)",s="(-ms-high-contrast: white-on-black), (forced-colors: active) and (prefers-color-scheme: dark)",o="(-ms-high-contrast: black-on-white), (forced-colors: active) and (prefers-color-scheme: light)",r="@media screen and "+n;class a{get isHighContrastActive(){return window.matchMedia(n).matches}get isHighContrastBlack(){return window.matchMedia(s).matches}get isHighContrastWhite(){return window.matchMedia(o).matches}}new a},519788:(e,t,i)=>{i.d(t,{N:()=>n});const n=(0,i(668952).f)("IOrchestratorSettings")},521792:(e,t,i)=>{i.d(t,{N:()=>m});var n=i(379490),s=i(920117),o=i(825948),r=i(877931),a=i(756857),l=i(39183),d=i(691474),c=i(859916),u=i(419728),g=i(229906),h=i(83010),p=i(637224);let m=class{get languageAddMode(){return this._languageAddMode}get actionStatus(){return this._actionStatus}get canAddLanguage(){return this.proofingLanguages.count<3}get canRemoveLanguage(){return this.proofingLanguages.count>1}get selectedKey(){return this._selectedKey}constructor(e,t,i,n,o){this._proofingStore=e,this._logger=t,this._settingsEmitter=i,this._localizer=n,this._languageInfo=o,this._languageAddMode=!1,this._actionStatus="",this._selectedKey=null,this.getLocalized=e=>this._localizer.getMessage(e),this.getLanguageName=e=>{var t;const i=this._languageInfo.getLanguageInfo(e);return null!==(t=null==i?void 0:i.languageName)&&void 0!==t?t:e},this.updateProofingLanguages=async()=>{const e=new c.I(await this._proofingStore.read(s.l.ProofingLanguages));(0,u.runInAction)((()=>{this.proofingLanguages=e}))},this.setActionStatus=(e,t)=>{const i=this.getLanguageName(t),n=t===i?t:`${t}. ${i}`,s=this._localizer.getMessage(e,n);this._actionStatus=s},this.proofingLanguages=new c.I(this._proofingStore.getDefaultValue(s.l.ProofingLanguages)),(0,p.Gn)(this)}addSelected(){const e=this._selectedKey;!e||this.proofingLanguages.count>=3||(this.proofingLanguages.add(e),this.setActionStatus("ebx_languageAdded",e),this.setLanguageAddMode(!1))}remove(e){this.proofingLanguages.count>1&&(this.proofingLanguages.remove(e),this.setActionStatus("ebx_languageRemoved",e))}moveUp(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveUp(e),this.setActionStatus("ebx_languageMovedUp",e))}moveDown(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveDown(e),this.setActionStatus("ebx_languageMovedDown",e))}moveToTop(e){this.proofingLanguages.count>1&&(this.proofingLanguages.moveToTop(e),this.setActionStatus("ebx_languageMovedToTop",e))}setLanguageAddMode(e){this._languageAddMode=e}async revertChanges(){const e=new c.I(await this._proofingStore.read(s.l.ProofingLanguages));(0,u.runInAction)((()=>{this.proofingLanguages=e}))}async save(){await this._proofingStore.write(s.l.ProofingLanguages,this.proofingLanguages.codesList),this._logger.debug(512242964,`[ProofingLanguageStateStore] Saved proofing languages setting: ${this.proofingLanguages.codesList}`),await this._proofingStore.read(s.l.ProofingLanguageListInitialized)||await this._proofingStore.write(s.l.ProofingLanguageListInitialized,!0)}async initialize(){this._settingsEmitter.on(s.l.ProofingLanguages,this.updateProofingLanguages),this._logger.debug(512242963,"[ProofingLanguageStateStore] Sending load languages request to background script"),this.proofingLanguages=new c.I(await this._proofingStore.read(s.l.ProofingLanguages))}shutDown(){}setSelectedKey(e){this._selectedKey=e}};(0,n.__decorate)([u.observable],m.prototype,"proofingLanguages",void 0),(0,n.__decorate)([u.observable],m.prototype,"_languageAddMode",void 0),(0,n.__decorate)([u.computed],m.prototype,"languageAddMode",null),(0,n.__decorate)([u.observable],m.prototype,"_actionStatus",void 0),(0,n.__decorate)([u.computed],m.prototype,"actionStatus",null),(0,n.__decorate)([u.computed],m.prototype,"canAddLanguage",null),(0,n.__decorate)([u.computed],m.prototype,"canRemoveLanguage",null),(0,n.__decorate)([u.observable],m.prototype,"_selectedKey",void 0),(0,n.__decorate)([u.computed],m.prototype,"selectedKey",null),(0,n.__decorate)([u.action],m.prototype,"addSelected",null),(0,n.__decorate)([u.action],m.prototype,"remove",null),(0,n.__decorate)([u.action],m.prototype,"moveUp",null),(0,n.__decorate)([u.action],m.prototype,"moveDown",null),(0,n.__decorate)([u.action],m.prototype,"moveToTop",null),(0,n.__decorate)([u.action],m.prototype,"setLanguageAddMode",null),(0,n.__decorate)([u.action],m.prototype,"setSelectedKey",null),(0,n.__decorate)([u.action],m.prototype,"setActionStatus",void 0),m=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,h.W)(o.K)),(0,n.__param)(1,(0,h.W)(r.g)),(0,n.__param)(2,(0,h.W)(d.E)),(0,n.__param)(3,(0,h.W)(a.H)),(0,n.__param)(4,(0,h.W)(l.d))],m)},522674:(e,t,i)=>{i.d(t,{ZL:()=>o,k_:()=>s,qy:()=>r});var n=i(668952);(0,n.f)("IOnCanvasKpiHelper");const s=(0,n.f)("ILoggerSettings"),o=(0,n.f)("IEditorSdkLogger"),r=((0,n.f)("IKpiTracker"),(0,n.f)("TelemetrySink"))},522775:(e,t,i)=>{i.d(t,{D:()=>o,Y:()=>n});var n,s=i(668952);!function(e){e.critique="critique",e.inlineSuggestions="inlineSuggestions",e.languageAutoDetection="languageAutoDetection"}(n||(n={}));const o=(0,s.f)("IFooterFreStore")},523769:(e,t,i)=>{if(i.d(t,{$:()=>b}),0!=i.j)var n=i(589171);if(0!=i.j)var s=i(575672);if(0!=i.j)var o=i(575024);if(0!=i.j)var r=i(176043);if(0!=i.j)var a=i(139052);if(0!=i.j)var l=i(251439);if(0!=i.j)var d=i(815870);if(0!=i.j)var c=i(386675);if(0!=i.j)var u=i(825948);if(0!=i.j)var g=i(818955);if(0!=i.j)var h=i(255517);if(0!=i.j)var p=i(28387);if(0!=i.j)var m=i(551268);if(0!=i.j)var f=i(586929);if(0!=i.j)var v=i(519788);if(0!=i.j)var y=i(210172);var _=i(77127);if(0!=i.j)var I=i(952153);if(0!=i.j)var C=i(23544);if(0!=i.j)var S=i(863082);class b{constructor(){this.imports=[a.u]}get uniqueId(){return(0,l.z)(507918284)}configureRootServices(e){e.bind(d.H).to(n.R),e.bind(_.UC).to(_.h1),e.bind(_.YQ).to(_.ZP),e.bind(o.$).toDynamicValue((e=>{const t=e.get(_.YQ);return()=>t.currentTheme===_.SV.highContrast})),e.bind(p.h).to(s.e),e.bind(m.k).toExisting(p.h),e.bind(y.z).toExisting(p.h),e.bind(r.D).toExisting(p.h),e.bind(v.N).toExisting(p.h),e.bind(S.C).toSelf(),e.bind(f.B).toExisting(S.C),e.bind(u.K).to(I.B),e.bind(c.S).toExisting(S.C),e.bind(c.S).toExisting(u.K),e.bind(g.e).to(C.E),e.bind(h.M).toExisting(g.e)}}},525429:(e,t,i)=>{if(i.d(t,{J:()=>o}),0!=i.j)var n=i(952071);const s=0!=i.j?'[\\.\\:\\;\\,\\s-_\\(\\)\\/\\"\\u2018\\u2019\\u201c\\u201d\\xab\\xbb\\!\\?\\#\\&\\+\\¤\\<\\>\\@\\+\\=\\xa1\\xbf\\xaa\\xba]':null;function o(e,t,i,s){if(t){const o=e.map((e=>(0,n.S)(e))),l=(0,n.S)(t);return 1===e.length&&""===e[0]?[]:function(e,t,i,n){let s;t=t.toUpperCase();const o={};for(const i of e){if(!i)continue;const e=n(i.toUpperCase());for(;s=e.exec(t);)a(i,s,o)}const r=function(e,t){const i=[];for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&i.push({offset:parseInt(n,10),word:e[n],propertyHit:t});return i.sort(((e,t)=>t.offset-e.offset))}(o,i);r.length&&function(e,t){let i=e[e.length-1].offset+e[e.length-1].word.length;for(let n=e.length-2;n>=0;n--){const s=e[n].offset+e[n].word.length-1;e[n].offset<i?s>i?e[n].offset<i&&(e[n].word=t.substring(i,e[n].offset+e[n].word.length),e[n].offset=i):e.splice(n,1):i=s}}(r,t);return r}(o,l,i,s||r)}return[]}function r(e){return new RegExp("(^|"+s+")"+e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"ig")}function a(e,t,i){var n;const s=(null===(n=t[1])||void 0===n?void 0:n.length)?t.index+t[1].length:t.index;(!i[s]||i[s].length<e.length)&&(i[s]=e)}},525809:(e,t,i)=>{if(i.d(t,{f:()=>d}),0!=i.j)var n=i(466450);if(0!=i.j)var s=i(196957);if(0!=i.j)var o=i(251439);if(0!=i.j)var r=i(438343);if(0!=i.j)var a=i(163573);if(0!=i.j)var l=i(649343);class d{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918356)}configureRootServices(e){e.bind(l.f).toDynamicValue((e=>{const t=e.get(a.n),i=e.getOptional(r.m);return e=>{switch(e){case"critique":return new n.F(t);case"autocorrection":case"personalized-autocorrection":return new s.Q(t,i);default:throw new Error("Unknown squiggle kind")}}}))}}},526174:(e,t,i)=>{if(i.d(t,{A:()=>d,w:()=>l}),0!=i.j)var n=i(40429);if(0!=i.j)var s=i(418876);if(0!=i.j)var o=i(728671);if(0!=i.j)var r=i(537969);if(0!=i.j)var a=i(797386);function l(e,t,i){const o=new n.s({deltaType:s.WI.Update,unit:s.OD.Chars,position:t.start,length:0,content:"",queryRange:t,additionalData:e.queryDetection.getCurrentQueryCorrelationKeys(),userInfo:{userType:s.HS.SessionUser}});c(e.hostEmitter,i,o)}function d(e,t,i,o,r,a,l){const d=e.queryDetection.setCurrentQueryRange(r.id,o,l,a,t);d&&(d.scopeInfo=a);const u=new n.s({deltaType:s.WI.Update,unit:s.OD.Chars,position:o.start,length:o.length,content:i,queryRange:o,additionalData:d,userInfo:{userType:s.HS.SessionUser}});c(e.hostEmitter,r,u)}function c(e,t,i){const n=(0,a.F)(t);e.emit(r.pD.hostModelDelta,{address:void 0,message:{tileId:t.id,tileVersion:t.eventSeqId||0,documentModel:null==n?void 0:n.documentModel,delta:i,sourceType:o.pf.ParagraphNode,changeType:o.Q0.Code,deletedOrReplacedCharacters:void 0}})}},533622:(e,t,i)=>{i.d(t,{K:()=>d});var n,s=i(379490);!function(e){e[e.NOT_LOADED=0]="NOT_LOADED",e[e.LOADING=1]="LOADING",e[e.LOADED=2]="LOADED",e[e.LOAD_ERROR=3]="LOAD_ERROR"}(n||(n={}));var o=i(229906),r=i(83010),a=i(851840),l=i(163573);let d=class extends a.W{constructor(e){super(),this.hostSettings=e,this.disablers=[],this.enablers=[!0]}check(){return!this.hostSettings.enableRoamingDictionary&&!this.hostSettings.enableV2RoamingDictionary}getRoamingDictionary(){return this._roamingDictionary}setRoamingDictionary(e){this._roamingDictionary=e}isReady(){return!this.check()&&void 0!==this._roamingDictionary&&this._roamingDictionary.getLoadState()===n.LOADED}processCallBackResult(e,t,i){return this._roamingDictionary=i.roamingDictionary,super.processCallBackResult(e,t,i)}};d=(0,s.__decorate)([(0,o._)(),(0,s.__param)(0,(0,r.W)(l.n))],d)},535912:(e,t,i)=>{if(i.d(t,{D:()=>s}),0!=i.j)var n=i(507628);const s=()=>(0,n.A)()},536906:(e,t,i)=>{i.d(t,{C:()=>n});const n=(0,i(668952).f)("IRoamingDictionaryBroker")},537205:(e,t,i)=>{i.d(t,{o:()=>I});var n=i(379490),s=i(728671),o=i(163573),r=i(877931),a=i(823325),l=i(537969),d=i(118673),c=i(753031),u=i(418876),g=i(229906),h=i(66008),p=i(83010),m=i(306555),f=i(303170),v=i(843785),y=i(383806),_=i(224557);let I=class{constructor(e,t,i,n,o,r,l,d,g){this._hostEmitters=e,this._proofingEmitter=t,this._critiquesEventHandler=i,this._filteringEventHandler=n,this._nodeEventHandler=o,this._spanEventHandler=r,this._formattingEventHandler=l,this._hostSettings=d,this._logger=g,this.shutDown=()=>{this._logger.log(556372812,c.q.Debug,"Shutting down EventHub.")},this.onFilterChangedEvent=e=>{this._filteringEventHandler.onEvent({eventType:e.messageType})},this.onHostModelCritiquesEvent=e=>{const t={added:e.data.critiquesAdded,removedIds:e.data.critiqueIdsRemoved,eventType:e.messageType,source:e.data.source,tileId:e.data.tileId,tileVersion:e.data.tileVersion};this._critiquesEventHandler.onEvent(t)},this.onHostModelDeltaEvent=e=>{const{delta:t,deletedOrReplacedCharacters:i,sourceType:n,tileId:o,tileVersion:r}=e.message;if(!0===this._hostSettings.sdkV2Enabled||n!==s.pf.TileNode)return;const l={position:t.position,length:t.length,content:t.content,eventType:t.deltaType===u.WI.Add?a.G.NewData:t.deltaType===u.WI.Delete?a.G.RemoveData:a.G.ChangeData,tileId:o,tileVersion:r,deletedOrReplacedCharacters:i};this._spanEventHandler.onEvent(l)},this.onHostModelFormattingDelta=e=>{const t=e.message.delta,i=e.message.tileId,n=e.message.tileVersion,s={formattedRanges:t.formattedRanges,eventType:t.deltaType===u.WI.Add?a.G.NewData:t.deltaType===u.WI.Delete?a.G.RemoveData:a.G.ChangeData,tileId:i,tileVersion:n};this._formattingEventHandler.onEvent(s)},this.onHostModelTextTileEvent=e=>{if(!0===this._hostSettings.sdkV2Enabled)return;const t=e.data.tileId,i=e.data.tileVersion,n={eventType:e.messageType,tileId:t,tileVersion:i};this._nodeEventHandler.onEvent(n)},this.onClearCritiquesForNode=e=>{const t={eventType:a.G.RemoveData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)},this.onRestoreNodeForCritiqueStore=e=>{const t={eventType:a.G.NewData,tileId:e.message.nodeId,tileVersion:Number.parseInt(e.message.seqId,10)};this._nodeEventHandler.onEvent(t)}}async initialize(){if(this._logger.log(556372811,c.q.Debug,"Initializing EventHub."),this._hostSettings.enableOrchestration){this._proofingEmitter.on("enabledCritiqueTypesChanged",(e=>this.filterMessageType("enabledCritiqueTypesChanged",e,this.onFilterChangedEvent,void 0,a.G.ChangeData)));for(const e of["eccStateChanged","wordDictionaryEvent"])this._proofingEmitter.on(e,(t=>this.filterMessageType(e,t,this.onFilterChangedEvent,a.G.ChangeData)));for(const e of this._hostEmitters)e.on(l.pD.hostModelCritiques,(e=>this.filterMessageType("hostModelCritiques",e.message,this.onHostModelCritiquesEvent,void 0,a.G.ChangeData))),e.on(l.pD.hostModelFlags,(e=>this.filterMessageType("hostModelFlags",e.message,this.onHostModelCritiquesEvent,void 0,a.G.ChangeData))),e.on(l.pD.hostModelTextTile,(e=>this.filterMessageType("hostModelTextTile",e.message,this.onHostModelTextTileEvent,a.G.ChangeData))),e.on(l.pD.hostModelDelta,this.onHostModelDeltaEvent),e.on(l.pD.clearCritiquesForNode,this.onClearCritiquesForNode),e.on(l.pD.restoreNodeForCritiqueStore,this.onRestoreNodeForCritiqueStore),e.on(l.pD.hostModelFormattingDelta,this.onHostModelFormattingDelta)}}filterMessageType(e,t,i,n,s){s&&t.messageType!==s||n&&t.messageType===n?this._logger.log(556372815,c.q.Warn,`${e} message: Unexpected MessageType.`):i(t)}};I=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,h.t)(l.zJ)),(0,n.__param)(1,(0,p.W)(d.o)),(0,n.__param)(2,(0,p.W)(m.S)),(0,n.__param)(3,(0,p.W)(f.F)),(0,n.__param)(4,(0,p.W)(y.l)),(0,n.__param)(5,(0,p.W)(_.b)),(0,n.__param)(6,(0,p.W)(v.o)),(0,n.__param)(7,(0,p.W)(o.n)),(0,n.__param)(8,(0,p.W)(r.g))],I)},537622:(e,t,i)=>{if(i.d(t,{G:()=>o}),0!=i.j)var n=i(276646);if(0!=i.j)var s=i(647879);function o(e,t){var i,o,r,a,l,d,c;const u=null!==(r=null!==(o=null===(i=t.queryDetection.getCurrentQuery())||void 0===i?void 0:i.queryRange.prefix)&&void 0!==o?o:e.triggerCharacter)&&void 0!==r?r:"@",g=t.queryDetection.getCurrentScope();return(0,s.W)(["scope",null!==(a=null==g?void 0:g.entityType)&&void 0!==a?a:""],["keyStrokes",e.keyStrokes],["isEmptyQuery",e.queryRange.length===u.length],["wasOpenedViaNudge",e.wasOpenedViaNudge],["triggerCharacter",u],["wasOpenedIsViaNudgeAndHasEntityResults",null!==(d=null===(l=e.wasOpenedViaNudgeInfo)||void 0===l?void 0:l.hasEntityResults)&&void 0!==d&&d],["wasOpenedViaAutomaticAtMention",e.wasOpenedViaAutomaticAtMention],["wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===e.menuType.menuType],["wasOpenedInBlankTile",e.wasOpenedInBlankTile],["parentTileType",null!==(c=e.parentTileType)&&void 0!==c?c:"unknown"],["menuType",e.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")],[n.JZ,!!t.hostSettings.enableKeptMetric])}},537969:(e,t,i)=>{i.d(t,{M5:()=>s,pD:()=>r,zJ:()=>o});var n=i(668952);const s=(0,n.f)("IHostEmitter"),o=(0,n.f)("IHostEmitterArray");var r;!function(e){e.tileCheckRequestV1="tileCheckRequestV1",e.configV2RequestEvent="configV2RequestEvent",e.hostModelTileStateReset="hostModelTileStateReset",e.hostModelVisualStateChange="hostModelTileVisualStateChange",e.hostModelDelta="hostModelDelta",e.hostModelFormattingDelta="hostModelFormattingDelta",e.hostModelAttributionDelta="hostModelAttributionDelta",e.hostModelTextTile="hostModelTextTile",e.hostModelParagraphTextTiles="hostModelParagraphTextTiles",e.hostModelMoveTextTile="hostModelMoveTextTile",e.hostModelRehydrateTiles="hostModelRehydrateTiles",e.hostModelRehydrateTilesFinished="hostModelRehydrateTilesFinished",e.hostModelAddedRootNode="hostModelAddedRootNode",e.hostModelRemovedRootNode="hostModelRemovedRootNode",e.hostModelCritiques="hostModelCritiques",e.hostModelCritiqueAction="hostModelCritiqueAction",e.hostModelFlags="hostModelFlags",e.hostModelTextTileEmittedToAugloop="hostModelTextTileEmittedToAugloop",e.oaRankedAnnotations="oaRankedAnnotations",e.oaAnnotationsTriggered="oaAnnotationsTriggered",e.oaFlagAnnotationsTriggered="oaFlagAnnotationsTriggered",e.oaMenuControlSignal="oaMenuControlSignal",e.predictionTriggered="predictionTriggered",e.nudgeTriggered="nudgeTriggered",e.nudgeAccepted="nudgeAccepted",e.headingDetectionRecognized="headingDetectionRecognized",e.instrumentationRequestV1="instrumentationRequestV1",e.tileCheckResponseV1="tileCheckResponseV1",e.configV2ResponseEvent="configV2ResponseEvent",e.clearTileCritiques="clearTileCritiques",e.clearCritiquesForNode="clearCritiquesForNode",e.restoreNodeForCritiqueStore="restoreNodeForCritiqueStore",e.telemetryEvent="telemetryEvent",e.newActivityTelemetryEvent="newActivityTelemetryEvent",e.activitySetSuccessTelemetryEvent="activitySetSuccessTelemetryEvent",e.activitySetResultTelemetryEvent="activitySetResultTelemetryEvent",e.activityAddDataFieldTelemetryEvent="activityAddDataFieldTelemetryEvent",e.activityEndNowTelemetryEvent="activityEndNowTelemetryEvent",e.saveCritiqueSettings="saveCritiqueSettings",e.critiqueSettingsChange="critiqueSettingsChange",e.ciqSettingsChange="ciqSettingsChange",e.critiqueValuePerLanguageChanged="critiqueValuePerLanguageChanged",e.saveInlineEditingSettings="saveInlineEditingSettings",e.autoCorrectLanguagesUpdated="autoCorrectLanguagesUpdated",e.addWordToDictionaryLocally="addWordToDictionaryLocally",e.setRoamingDictionaryState="setRoamingDictionaryState",e.enableRoamingDictionary="enableRoamingDictionary",e.updateCurrentSessionDictionary="updateCurrentSessionDictionary",e.setAugLoopState="setAugLoopState",e.getAugLoopState="getAugLoopState",e.squiggleClick="squiggleClick",e.taskRecognitionSignal="taskRecognitionSignal",e.toneDetection="toneDetection",e.autoCorrectionTriggered="autoCorrectionTriggered",e.writeProofingLanguage="writeProofingLanguage",e.readProofingLanguage="readProofingLanguage",e.readProofingUserDictionary="readProofingUserDictionary",e.readRoamingProofingOverriddenOptions="readRoamingProofingOverriddenOptions",e.copywriterRequestSuggestions="copywriterRequestSuggestions",e.copywriterSuggestionsReady="copywriterSuggestionsReady",e.seenEventTriggered="seenEventTriggered",e.addWordsToRoamingUserDictionary="addWordsToRoamingUserDictionary",e.requestSynonyms="requestSynonyms",e.receivedSynonyms="receivedSynonyms",e.writeProofingSettingsToRoaming="writeProofingSettingsToRoaming",e.readOASettings="readOASettings",e.writeOASettings="writeOASettings",e.conditionalOrchestratorSettingsChanged="conditionalOrchestratorSettingsChanged",e.aiInsertRequestSuggestions="aiInsertRequestSuggestions",e.aiInsertSuggestionsReady="aiInsertSuggestionsReady",e.logout="logout",e.textAugmentationCoreResponse="textAugmentationCoreResponse",e.textAugmentationCoreRemovalResponse="textAugmentationCoreRemovalResponse",e.textAugmentationCoreRequest="textAugmentationCoreRequest"}(r||(r={}))},538045:(e,t,i)=>{i.d(t,{w:()=>n});const n=(0,i(668952).f)("IProofingDom")},538588:(e,t,i)=>{i.d(t,{n:()=>w});i(220029);var n=i(794300),s=i(379490),o=i(668952);const r=(0,o.f)("ITransportLogger"),a=(0,o.f)("ITransportActivity");var l=i(229906),d=i(66008),c=i(83010),u=i(380422),g=i(496814),h=i(921976),p=i(46692),m=i(753031);class f{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1,this._diagosticEventName="GeneralDiagnostics",this.logDiagnostics=(e,t,i,n)=>{this.logActivityBase(this._diagosticEventName,e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.logActivityBase(e,void 0,t,i,n)},this.logActivityBase=(e,t,i,n,s)=>{const o=this.getNewActivity(e,p.o.SamplingPolicy.CriticalExperimentation);t&&(null==o||o.dataFields.push((0,u.n)("message",t))),s&&(null==o||o.dataFields.push((0,u.n)("correlationKeys",JSON.stringify(s)))),i&&(null==o||o.dataFields.push((0,u.n)("data",JSON.stringify(i)))),n&&(null==o||o.dataFields.push(...n)),o&&(o.success=!0,o.endNow())}}async initialize(e,t,i,n,s,o,r){var a;if(!this._initialized){if(!this._initializing)try{this._debugMode=null!==(a=await(null==i?void 0:i.read(g.l.DebugMode)))&&void 0!==a&&a,this._debugMode&&this._transports.push(new h.C);for(const e of this._transports)await e.initialize(i,s,o,n,r);this._activityTransport&&await this._activityTransport.initialize(i,s,o,n,r)}finally{this._initializing=!1}this._initialized=!0}}config({transports:e,activityTransport:t}){return this._transports=e,this._activityTransport=t,this}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,i,n){this.logEvent(e,null,t,i,p.o.SamplingPolicy.Measure,n)}info(e,t,i){this.logEvent(e,null,m.q.Info,t,p.o.SamplingPolicy.Measure,i)}warn(e,t,i){this.logEvent(e,null,m.q.Warn,t,p.o.SamplingPolicy.Measure,i)}error(e,t,i){this.logEvent(e,null,m.q.Error,t,p.o.SamplingPolicy.CriticalBusinessImpact,i)}debug(e,t,i){this.logEvent(e,null,m.q.Debug,t,p.o.SamplingPolicy.Diagnostics,i)}logServiceRequest(e,t,i,n,s){for(const o of this._transports)t&&(o.serviceRequestID=t),this.logEvent(e,null,i,n,p.o.SamplingPolicy.Measure,s)}logEvent(e,t,i,n,s,o,r){if(this._initialized&&(this._debugMode||i!==m.q.Debug))for(const a of this._transports)a.logEvent(e,t,i,n,s,o,r)}getNewActivity(e,t,i){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,i):void 0}dispose(){}}let v=class{constructor(e,t){this._transports=e,this._activityTransport=t,this.logDiagnostics=(e,t,i,n)=>{this.baseLogger.logDiagnostics(e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.baseLogger.logActivity(e,t,i,n)},this.baseLogger=new f(e,t)}async initialize(e,t,i,n,s,o,r){await this.baseLogger.initialize(e,t,i,n,s,o,r)}config({transports:e,activityTransport:t}){return this.baseLogger.config({transports:e,activityTransport:t})}addCorrelationID(e){this.baseLogger.addCorrelationID(e)}log(e,t,i,n){this.baseLogger.log(e,t,i,n)}info(e,t,i){this.baseLogger.info(e,t,i)}warn(e,t,i){this.baseLogger.warn(e,t,i)}error(e,t,i){this.baseLogger.error(e,t,i)}debug(e,t,i){this.baseLogger.debug(e,t,i)}logServiceRequest(e,t,i,n,s){this.baseLogger.logServiceRequest(e,t,i,n,s)}logEvent(e,t,i,n,s,o,r){this.baseLogger.logEvent(e,t,i,n,s,o,r)}getNewActivity(e,t,i){return this.baseLogger.getNewActivity(e,t,i)}dispose(){this.baseLogger.dispose()}};v=(0,s.__decorate)([(0,l._)(),(0,s.__param)(0,(0,d.t)(r)),(0,s.__param)(1,(0,c.W)(a))],v);var y=i(374831);class _ extends n.z{constructor(){super(),this.sendActivityTelemetryEvent=e=>{const t={eventName:e.eventName,data:void 0,logType:"Activity",eventFlags:e.eventFlags,dataFields:e.dataFields,eventContract:e.eventContract};this.publishEvent("telemetryLog",t)},this.activityEventGenerationHelper=new y.c(this.sendActivityTelemetryEvent)}async initialize(e,t,i,n,s){}logEvent(e,t,i,n,s,o,r){const a={eventName:t,data:o};this.publishEvent("telemetryLog",Object.assign(Object.assign({},a),{logType:"Event",tagID:e,level:i,message:n,eventFlags:{samplingPolicy:s}}))}getNewActivity(e,t,i){return this.activityEventGenerationHelper.createActivity({eventName:e,eventFlags:{dataCategories:p.o.DataCategories.ProductServiceUsage,samplingPolicy:t,diagnosticLevel:p.o.DiagnosticLevel.Required}})}addCorrelationID(e){this._sessionCorrelationId=e,this._sessionCorrelationId}}class I extends n.z{constructor(){super(),this.handleTelemetryLog=e=>{this.publishEvent("telemetryLog",e)},this.transportEventLogger=new _,this.logger=new v([this.transportEventLogger],this.transportEventLogger)}async initialize(){await this.logger.initialize(),this.transportEventLogger.subscribe("telemetryLog",this.handleTelemetryLog)}dispose(){this.transportEventLogger.unsubscribe("telemetryLog",this.handleTelemetryLog),this.logger.dispose()}get loggerInstance(){return this.logger}}var C=i(700509),S=i(823325),b=i(355495),T=i(488776),E=i(502653);function N(e,t=3){if(!e||0===e.length)throw new Error("The list of languages is empty.");const i=new Set;for(const n of e){const e=n.split("-");if(!(e.length<2||e[0].length<2||e[1].length<2)&&(!i.has(n)&&(i.add(n),i.size===t)))break}if(0===i.size)throw new Error('The list of languages does not contain any valid languages. Each language should include country code and be in the format "xx-XX"');return Array.from(i)}class w extends n.z{constructor(e){super(),this.params=e,this._disposed=!1,this._initialized=!1,this._textProcessorCoreInternal=null,this._internalLogger=null,this._reportedCritiques=new Set,this._handleTiles=e=>{this.publishEvent("tilingEvent",e)},this._handleCritiques=e=>{this.publishEvent("tileNodeCritiquesUpdated",{tileNodeId:e.tileNodeId,critiques:e.critiques}),this._reportOfferedCritiques(e)},this._reportOfferedCritiques=e=>{for(const t of e.critiques)t.traceId&&!this._reportedCritiques.has(t.traceId)&&(this._reportedCritiques.add(t.traceId),this.publishEvent("telemetryLog",{logType:"InstrumentationEcho",eventName:"EngagementCritiqueOffered",data:{critiquePriority:t.priority,critiqueTypeId:t.typeId,critiqueTraceId:t.traceId,critiqueSourceData:t.sourceData},timestamp:(new Date).toISOString()}))},this._handleTelemetryLog=e=>{this.publishEvent("telemetryLog",e)},this.getValidatedLocales=e=>{const t=function(e,t=3){try{return{languages:N(e,t)}}catch(e){return{error:{logType:"Event",eventName:"InvalidLocales",level:m.q.Error,data:{error:`Language List Validation Error: ${e}`}},languages:[]}}}(e);return t.error&&this.publishEvent("telemetryLog",t.error),t.languages}}get initialized(){return this._initialized}get disposed(){return this._disposed}async init(){var e,t;if(this._initialized)return;const i=this.getValidatedLocales(this.params.settings.locales);0!==i.length&&(this.params.settings.locales=i,this._initialized=!0,await this._initLegacyCore(),null===(e=this._textProcessorCoreInternal)||void 0===e||e.subscribe("tilingEvent",this._handleTiles),null===(t=this._textProcessorCoreInternal)||void 0===t||t.subscribe("critiquesAvailable",this._handleCritiques))}async dispose(){this._disposed||(this._disposed=!0,this._textProcessorCoreInternal&&(this._textProcessorCoreInternal.unsubscribe("tilingEvent",this._handleTiles),this._textProcessorCoreInternal.unsubscribe("critiquesAvailable",this._handleCritiques),this._textProcessorCoreInternal=null),this._internalLogger&&(this._internalLogger.unsubscribe("telemetryLog",this._handleTelemetryLog),this._internalLogger.dispose(),this._internalLogger=null),this._reportedCritiques.clear())}resetState(){var e;null===(e=this._textProcessorCoreInternal)||void 0===e||e.resetState()}pushText(e,t){var i;e.length&&(null===(i=this._textProcessorCoreInternal)||void 0===i||i.pushText(e,t))}processTileCritiques(e){var t;null===(t=this._textProcessorCoreInternal)||void 0===t||t.processTileCritiques({tileNodeId:e.tileId,critiques:e.critiques,messageType:S.G.ChangeData})}processTileQuery(e){}async setLocales(e){var t;const i=this.getValidatedLocales(e);0!==i.length&&(this.params.settings.locales=i,null===(t=this._textProcessorCoreInternal)||void 0===t||t.setProofingLanguages(new b.z(i)))}getParagraphFinder(){return this._textProcessorCoreInternal?this._textProcessorCoreInternal.getParagraphFinder():null}async _initLegacyCore(){const{locales:e}=this.params.settings,t=(0,E.yy)(),i=Object.assign(Object.assign(Object.assign({},t),(0,E.m1)()),{completeTileTextUnit:C.fT.Sentence,partialTileTextUnit:C.fT.Sentence,paragraphDeltasEnabled:t.enableParagraphUpdates&&t.enableParagraphDeltas,batchTileProcessingEnabled:!0}),n=new b.z(e);this._internalLogger=new I,await this._internalLogger.initialize(),this._internalLogger.subscribe("telemetryLog",this._handleTelemetryLog),this._textProcessorCoreInternal=new T.$(i,n,this._internalLogger.loggerInstance)}}},541409:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Concision","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"Cohérence","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Langage non-discriminant"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Fautes de frappe"},"Clarity":{"LocalizedName":"Clarté","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronymes"},"Rewrite":{"LocalizedName":"Reformulations","IsImplemented":false},"Error Corrections":{"LocalizedName":"Correction d\'erreurs","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulaire"},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammaire"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"Langage formel"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Ponctuation","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Conventions"},"Spelling":{"LocalizedName":"Orthographe","IsImplemented":true},"Resume":{"IsImplemented":true,"LocalizedName":"CV"},"Sensitive Geopolitical References":{"LocalizedName":"Références géopolitiques sensibles","IsImplemented":true}}')},541471:(e,t,i)=>{i.d(t,{Y:()=>f,bb:()=>_,c$:()=>y});var n=i(379490),s=i(920117),o=i(825948),r=i(234483),a=i(118673),l=i(240874),d=i(859916),c=i(419728),u=i(668952),g=i(229906),h=i(83010),p=i(427603),m=i(637224);const f=(0,u.f)("IDefaultStyleDefinitionsFactory"),v=(0,u.f)("IDefaultStyleOverrides"),y=(0,u.f)("IHighContrastStyleOverrides");let _=class{get critiqueCallout(){return this.getAdjustedStyle("critiqueCallout")}get undoCallout(){return this.getAdjustedStyle("undoCallout")}get tooltip(){return this.getAdjustedStyle("tooltip")}constructor(e,t,i,n,o,r,a){this.highContrastModeDetector=e,this.proofingStore=t,this.emitter=i,this.defaultStyleDefinitionsFactory=o,this.highContrastStyleOverrides=r,this.styleOverrides=a,this.onProofingLanguageChanged=e=>{this.styles=this.defineStyles()},this.defineStyles=()=>{const e=this.defaultStyleDefinitionsFactory(this.uxLanguage);return this.styleOverrides?{critiqueCallout:this.applyOverrides(e.critiqueCallout,this.styleOverrides.critiqueCallout),undoCallout:this.applyOverrides(e.undoCallout,this.styleOverrides.undoCallout),tooltip:this.applyOverrides(e.tooltip,this.styleOverrides.tooltip)}:e},this.getAdjustedStyle=e=>{let t=this.styles[e];return this.highContrastModeDetector.enabled&&this.highContrastStyleOverrides&&(t=this.applyOverrides(t,this.highContrastStyleOverrides[e])),t},this.applyOverrides=(e,t)=>{if(!t)return e;const i={};for(const n of Object.keys(e))i[n]=Object.assign(Object.assign({},e[n]),t[n]);return i},this.uxLanguage=n.getUILanguage(),this.styles=this.defineStyles(),this.proofingStore.read(s.l.ProofingLanguages).then((e=>{this.onProofingLanguageChanged(d.I.getDefaultLanguageCode(e))})).catch((()=>{})),this.emitter.on("proofingLanguageChanged",(async e=>{this.onProofingLanguageChanged(e.data.defaultLanguageCode)})),(0,m.Gn)(this)}};(0,n.__decorate)([c.observable],_.prototype,"styles",void 0),(0,n.__decorate)([c.computed],_.prototype,"critiqueCallout",null),(0,n.__decorate)([c.computed],_.prototype,"undoCallout",null),(0,n.__decorate)([c.computed],_.prototype,"tooltip",null),(0,n.__decorate)([c.action],_.prototype,"onProofingLanguageChanged",void 0),_=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,h.W)(r.P)),(0,n.__param)(1,(0,h.W)(o.K)),(0,n.__param)(2,(0,h.W)(a.o)),(0,n.__param)(3,(0,h.W)(l.v)),(0,n.__param)(4,(0,h.W)(f)),(0,n.__param)(5,(0,p.l)()),(0,n.__param)(5,(0,h.W)(y)),(0,n.__param)(6,(0,p.l)()),(0,n.__param)(6,(0,h.W)(v))],_)},541647:(e,t,i)=>{i.d(t,{C:()=>s,Q:()=>o});var n=i(668952);const s=(0,n.f)("ISquigglerCanvasRenderingState"),o=(0,n.f)("ISquigglerCanvasRenderingStateFactory")},542812:(e,t,i)=>{i.d(t,{r:()=>o});var n=i(379490),s=i(229906);let o=class{constructor(){this._applyHandlerMap=new Map,this._ignoreHandlerMap=new Map,this._ignoreAllHandlerMap=new Map,this._disableHandlerMap=new Map}handleApplyFlag(e,t){return this._applyHandlerMap.set(e,t),()=>this._applyHandlerMap.delete(e)}onApplyFlag(e,t,i,n){const s=this._applyHandlerMap.get(t.typeId);return!!s&&s(e,t,i,n)}handleIgnoreFlag(e,t){return this._ignoreHandlerMap.set(e,t),()=>this._ignoreHandlerMap.delete(e)}onIgnoreFlag(e,t){const i=this._ignoreHandlerMap.get(t.typeId);return!!i&&i(e,t)}handleIgnoreAllOfFlag(e,t){return this._ignoreAllHandlerMap.set(e,t),()=>this._ignoreAllHandlerMap.delete(e)}onIgnoreAllOfFlag(e,t){const i=this._ignoreAllHandlerMap.get(t.typeId);return!!i&&i(e,t)}handleDisableFlag(e,t){return this._disableHandlerMap.set(e,t),()=>this._disableHandlerMap.delete(e)}onDisableFlag(e,t){const i=this._disableHandlerMap.get(t.typeId);return!!i&&i(e,t)}};o=(0,n.__decorate)([(0,s._)()],o)},543943:(e,t,i)=>{if(i.d(t,{w:()=>r}),0!=i.j)var n=i(46692);if(0!=i.j)var s=i(647879);if(0!=i.j)var o=i(572233);class r{constructor(e,t,i,r){this._logger=e,this._hostSettings=r,this._dataEventName="Data",this._performanceApiGarbageCollectorIntervalInMs=12e4,this._logToTelemetry=(e,t,i,o)=>{var r,a,l,d,c,u;const g=this._logger.getNewActivity(o||this._eventName,n.o.SamplingPolicy.CriticalExperimentation);if(g){for(const t of e)g.dataFields.push((0,s.n)(t.name,t.duration,void 0,n.o.DataFieldType.Double.valueOf()));g.dataFields.push(...(0,s.W)(["conversationId",null!==(r=null==t?void 0:t.conversationId)&&void 0!==r?r:""],["logicalId",null!==(a=null==t?void 0:t.logicalId)&&void 0!==a?a:""],["triggeringChar",null!==(l=null==t?void 0:t.triggerCharacter)&&void 0!==l?l:"@"],["triggerKey",null!==(d=null==t?void 0:t.triggerKey)&&void 0!==d?d:""],[this._dataEventName,JSON.stringify(Object.assign({isEmptyQuery:null===(c=null==t?void 0:t.isEmptyQuery)||void 0===c||c,dataSource:void 0,isAL:!0,workflow:"oa",logicalId:null==t?void 0:t.logicalId},i))],["queryLength",null!==(u=null==t?void 0:t.queryLength)&&void 0!==u?u:0])),g.success=!0,g.endNow()}},this._eventName=i,this.metric=new o.J(e,t,i,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry),this.setOnTimeout(((e="",t)=>{t&&this.commitEntry(e,"Timeout")}))}log(e,t,i,n){this._logger.log(e,t,i,n)}info(e,t,i){this._logger.info(e,t,i)}warn(e,t,i){this._logger.warn(e,t,i)}error(e,t,i){this._logger.error(e,t,i)}debug(e,t,i){this._logger.debug(e,t,i)}logEvent(e,t,i,n,s,o,r){this._logger.logEvent(e,t,i,n,s,o,r)}getNewActivity(e,t,i){return this._logger.getNewActivity(e,t,i)}addCorrelationID(e){this._logger.addCorrelationID(e)}async initialize(e,t,i,n,s,o,r){return this._logger.initialize(e,t,i,n,s,o,r)}logDiagnostics(e,t,i,n){this._logger.logDiagnostics(e,t,i,n)}logActivity(e,t,i,n){this._logger.logActivity(e,t,i,n)}config({transports:e,activityTransport:t}){return this._logger.config({transports:e,activityTransport:t}),this._logger}startEntry(e,t,i){var n,s;(null===(s=null===(n=this._hostSettings)||void 0===n?void 0:n.oaSettings)||void 0===s?void 0:s.e2eMetric)&&this.metric.startEntry(e,t,i)}setOnTimeout(e){var t,i;(null===(i=null===(t=this._hostSettings)||void 0===t?void 0:t.oaSettings)||void 0===i?void 0:i.e2eMetric)&&this.metric.setOnTimeout(e)}addMeasure(e,t,i){var n,s;(null===(s=null===(n=this._hostSettings)||void 0===n?void 0:n.oaSettings)||void 0===s?void 0:s.e2eMetric)&&this.metric.addMeasure(e,t,i)}commitEntry(e,t,i){var n,s;(null===(s=null===(n=this._hostSettings)||void 0===n?void 0:n.oaSettings)||void 0===s?void 0:s.e2eMetric)&&this.metric.commitEntry(e,t,i)}}},544609:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Stafsetning","IsImplemented":true}}')},545208:(e,t,i)=>{i.d(t,{_:()=>d});var n=i(252723),s=i(108520),o=i(939178);if(0!=i.j)var r=i(645652);var a=i(208520);const l=(0,n.F5)({nudgeStateStore:s.A.on(o.V)}),d=()=>{const{nudgeStateStore:e}=(0,n.KN)(l),[t,i]=a.useState(e);a.useEffect((()=>(e.subscribe("stateUpdated",i),()=>{e.unsubscribe("stateUpdated",i)})),[e]);const{nudge:s,nudgeDisplayLocation:o,nudgeTargetDocumentRef:d}=t;return s&&o&&d?a.createElement(r.a,{nudge:s,inlineNudge:e.enableInlineNudge,insertionCharacter:e.insertionCharacter,nudgeTargetDocumentRef:d,nudgeDisplayLocation:o,onAcceptNudgeAction:(t,i)=>{e.onNudgeAccepted(t,i)},onHideNudge:(t,i)=>{e.onNudgeDismiss(t,i)}}):null}},547956:(e,t,i)=>{i.d(t,{zR:()=>N});var n=i(379490),s=i(823325),o=i(774592),r=i(105244),a=i(609062),l=i(233653),d=i(922630),c=i(18233),u=i(442316),g=i(551268),h=i(229464),p=i(83605),m=i(701121),f=i(799116),v=i(879190),y=i(553164),_=i(668952),I=i(229906),C=i(83010),S=i(427603),b=i(378071);const T=(0,_.f)("CompleteTileTextUnitToken"),E=(0,_.f)("PartialTileTextUnit");let N=class{constructor(e,t,i,n,s,o,r,a,l,d,c,u,g){this._proofingPersistedStore=e,this._graphNodeFactory=t,this._textUnitChunker=i,this.settings=n,this._hostSettings=s,this._featureFlagReader=o,this._hostTilingEmitter=r,this._paragraphNodesEventEmitter=a,this._paragraphDeltasEnabled=l,this._logger=d,this.nodeTraverser=c,this._completeTileTextUnit=null!=u?u:n.completeTileTextUnit,this._partialTileTextUnit=null!=g?g:n.partialTileTextUnit}updateParagraphNodes(e,t,i,n,s,o,r){if(!this._hostSettings.enableOrchestration||!this._featureFlagReader.flags.enableParagraphUpdates)return this._updateParagraphNodesDeprecated(e,t,i,n,s);const a={oldTextInfo:t,newTextInfo:i,tileNode:e,sequenceId:s,minDiffBounds:n,graphTransaction:{unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},nodesToAdd:[],nodesToInsert:[],nodesToUpdate:[],nodesToRetire:[],unitRange:void 0};return this._updateExistingChildren(a),this._addNewChildren(a),this._buildGraphTransaction(a,o,r),a.graphTransaction}_updateExistingChildren(e){var t,i,n;if(!(null===(t=e.tileNode.children)||void 0===t?void 0:t.length))return;const s=null!==(n=null===(i=e.oldTextInfo)||void 0===i?void 0:i.content)&&void 0!==n?n:"",o=e.newTextInfo.content,r=s!==o,a={firstDiffLeft:e.minDiffBounds.firstDiffLeft,firstDiffRight:e.minDiffBounds.firstDiffRight};let l=e.tileNode.children.length-1;for(;l>=0;){const t=e.tileNode.children[l].element;if(t){if(s.length-t.offset<e.minDiffBounds.firstDiffRight)t.offset=o.length-s.length+t.offset;else if(t.offset+t.span>=e.minDiffBounds.firstDiffLeft&&(t.offset+t.span!==e.minDiffBounds.firstDiffLeft||!t.validEndBoundary||!r)){t.offset<e.minDiffBounds.firstDiffLeft&&(a.firstDiffLeft=Math.min(t.offset,a.firstDiffLeft));const i=s.length-t.offset-t.span;i<e.minDiffBounds.firstDiffRight&&(a.firstDiffRight=Math.min(i,a.firstDiffRight));const n=e.tileNode.children.splice(l,1);e.nodesToRetire.length&&a.firstDiffRight!==i?a.firstDiffLeft===t.offset?e.nodesToRetire.splice(0,0,...n):e.nodesToRetire.splice(e.nodesToRetire.length-2,0,...n):e.nodesToRetire.push(...n)}l-=1}else l-=1}e.unitRange={offset:a.firstDiffLeft,span:o.length-a.firstDiffRight-a.firstDiffLeft,enforcedCompleteTileTextUnit:!r&&this._hostSettings.enableOptimizedCallingPattern}}_addNewChildren(e){const t=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(e.newTextInfo.content,e.minDiffBounds,this._completeTileTextUnit,e.unitRange);for(const i of t){const t=this._graphNodeFactory(i,e.tileNode);this._attachTextUnit(t),e.nodesToAdd.push(t),e.graphTransaction.unreconciledContent.push(this._buildTile(e.tileNode,t,e.newTextInfo.content,e.sequenceId))}}_attachTextUnit(e){e.element&&(e.element.textUnit=!1===e.element.validEndBoundary&&this._hostSettings.enableOptimizedCallingPattern&&!0!==e.element.enforcedCompleteTileTextUnit?this._partialTileTextUnit:this._completeTileTextUnit)}_buildTile(e,t,i,n){var s,o,a,l,d;const c=null!==(o=null===(s=t.element)||void 0===s?void 0:s.offset)&&void 0!==o?o:0,u=null!==(l=null===(a=t.element)||void 0===a?void 0:a.span)&&void 0!==l?l:i.length;return{header:{nodeId:e.id,seqId:n.toString(),elementId:{id:t.id,offset:c,span:u},length:i.length},data:i.slice(c,c+u),proofingLanguages:this._proofingPersistedStore.getCachedEntry(r.l.ProofingLanguages).storeEntryValue,textUnit:null===(d=t.element)||void 0===d?void 0:d.textUnit}}_convertToUpdate(e,t,i,n,s,o){var r,a;if(!(null==e?void 0:e.element)||!(null==t?void 0:t.element))return;const l=null!==(a=null===(r=i.oldTextInfo)||void 0===r?void 0:r.content)&&void 0!==a?a:"",d=i.newTextInfo.content,c=l.length-e.element.offset-e.element.span,u=d.length-t.element.offset-t.element.span;if(!n&&e.element.offset!==t.element.offset||n&&c!==u)return;const g=this._emitParagraphDeltaUpdate(e,t,i,s,o);return e.element.offset=t.element.offset,e.element.span=t.element.span,e.element.validEndBoundary=t.element.validEndBoundary,e.element.enforcedCompleteTileTextUnit=t.element.enforcedCompleteTileTextUnit,e.element.textUnit=t.element.textUnit,t.retire(),i.nodesToAdd.splice(n?i.nodesToAdd.length-1:0,1),i.nodesToInsert.splice(n?i.nodesToInsert.length-1:0,1,e),i.nodesToRetire.splice(n?i.nodesToRetire.length-1:0,1),i.nodesToUpdate.push(e),i.graphTransaction.unreconciledContent.find((i=>{const n=i.header.elementId.id===t.id;return n&&(i.header.elementId.id=e.id),n})),g}_buildGraphTransaction(e,t,i){e.nodesToInsert=[...e.nodesToAdd];const n=this._convertToUpdate(e.nodesToRetire[0],e.nodesToAdd[0],e,!1,t,i),s=this._convertToUpdate(e.nodesToRetire[e.nodesToRetire.length-1],e.nodesToAdd[e.nodesToAdd.length-1],e,!0,t,i);w(e.tileNode,e.nodesToInsert),this._emitParagraphDeltaAdd(e,t),this._emitParagraphDeltaRetire(e,t);for(const t of e.nodesToRetire)t.retire();n&&this._hostTilingEmitter.emitParagraphDiffEvent(n),s&&this._hostTilingEmitter.emitParagraphDiffEvent(s),e.graphTransaction.addedNodes=e.nodesToAdd.map((e=>e.id)),e.graphTransaction.removedNodes=e.nodesToRetire.map((e=>e.id)),e.graphTransaction.updatedNodes=e.nodesToUpdate.map((e=>e.id))}_updateParagraphNodesDeprecated(e,t,i,n,s){var o;const r={unreconciledContent:[],addedNodes:[],removedNodes:[],updatedNodes:[]},a=this._updateExistingChildrenDeprecated(e,null!==(o=null==t?void 0:t.content)&&void 0!==o?o:"",i.content,n,r);return this._addNewChildrenDeprecated(e,i,n,s,a,r)}_updateExistingChildrenDeprecated(e,t,i,n,s){var o;if(null===(o=e.children)||void 0===o?void 0:o.length){const o=Object.assign({},n),r=t!==i;let a=e.children.length-1;for(;a>=0;){const l=e.children[a].element;if(l)if(l.offset<n.firstDiffLeft&&l.offset+l.span<n.firstDiffLeft||l.offset+l.span===n.firstDiffLeft&&l.validEndBoundary&&r);else if(t.length-l.offset<n.firstDiffRight)l.offset=i.length-t.length+l.offset,s.updatedNodes.push(e.children[a].id);else{l.offset<n.firstDiffLeft&&(o.firstDiffLeft=Math.min(l.offset,o.firstDiffLeft));const i=t.length-l.offset-l.span;i<n.firstDiffRight&&(o.firstDiffRight=Math.min(i,o.firstDiffRight));const r=e.children.splice(a,1);for(const e of r)s.removedNodes.push(e.id),e.retire()}a-=1}return{offset:o.firstDiffLeft,span:i.length-o.firstDiffRight-o.firstDiffLeft,enforcedCompleteTileTextUnit:!r&&this._hostSettings.enableOptimizedCallingPattern}}}_addNewChildrenDeprecated(e,t,i,n,s,o){const r=this._textUnitChunker.splitInUnitsFromExtendedBoundaries(t.content,i,this._completeTileTextUnit,s),a=[];for(const i of r){const s=this._graphNodeFactory(i,e);this._attachTextUnit(s),a.push(s),o.unreconciledContent.push(this._buildTile(e,s,t.content,n)),o.addedNodes.push(s.id)}return w(e,a),o}_emitParagraphDeltaUpdate(e,t,i,n,s){if(this._paragraphDeltasEnabled.check()){if(!e.element||!t.element)return;const o=(0,b.Gn)(i.oldTextInfo,e.element.offset,e.element.offset+e.element.span),r=(0,b.Gn)(i.newTextInfo,t.element.offset,t.element.offset+t.element.span);if(e.registered||this._emitParagraphAdd(i,e,n),void 0!==e.eventSeqId){e.eventSeqId+=1;const i=this._paragraphNodesEventEmitter.generateDeltaEventInformation(e,o,r,!!t.element.validEndBoundary,!!t.element.enforcedCompleteTileTextUnit,n,s,e.cachedWordCount);return e.cachedWordCount=i.wordCount,i}}}_emitParagraphDeltaAdd(e,t){if(this._paragraphDeltasEnabled.check())for(const i of e.nodesToAdd)this._emitParagraphAdd(e,i,t)}_emitParagraphAdd(e,t,i){var n,o;if(t.registered)return void(this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.info(539002012,"The node has been registered, skipping"));const r=this._featureFlagReader.flags.enableParagraphDeltasEmptyInitialTile&&i===a.Q0.Local;if(t.element){const a=(0,b.Gn)(e.newTextInfo,t.element.offset,t.element.offset+t.element.span);t.eventSeqId=0;const l=null===(n=this.nodeTraverser)||void 0===n?void 0:n.findPreviousParagraphNode(t),d=null===(o=this.nodeTraverser)||void 0===o?void 0:o.findNextParagraphNode(t);this._hostTilingEmitter.emitTileEvent(e.tileNode,t.id,Object.assign(Object.assign({},a),{content:r?"":a.content,attributionRanges:r?[]:a.attributionRanges}),t.eventSeqId,s.G.NewData,i,y.Z.ParagraphNode,this.getSpecifiedLocaleForNode(t),"#head#"===l?l:null==l?void 0:l.id,"#tail#"===d?d:null==d?void 0:d.id),r&&(t.eventSeqId+=1,this._hostTilingEmitter.emitParagraphDiffEvent(this._paragraphNodesEventEmitter.generateDeltaEventInformation(t,void 0,a,!!t.element.validEndBoundary,!0,i,!1,0))),t.registered=!0}else this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(539002013,"Anchor element is undefined for the node to add")}_emitParagraphDeltaRetire(e,t){var i;if(this._paragraphDeltasEnabled.check())for(const n of e.nodesToRetire)n.registered=!1,this._hostTilingEmitter.emitTileEvent(e.tileNode,n.id,{content:""},null!==(i=n.eventSeqId)&&void 0!==i?i:0,s.G.RemoveData,t,y.Z.ParagraphNode,this.getSpecifiedLocaleForNode(n))}getSpecifiedLocaleForNode(e){var t,i;return null!==(t=e.specifiedLocale)&&void 0!==t?t:null===(i=e.parent)||void 0===i?void 0:i.specifiedLocale}};function w(e,t){if(t.length&&e.children&&t[0].element){const i=t[0].element.offset;if(e.children.length){let n=e.children.length-1,s=t;for(;n>=0;){const t=e.children[n].element;if(t&&i>t.offset){e.children.splice(n,0,...s),s=[];break}n-=1}s.length&&e.children.splice(0,0,...s)}else e.children=t}}N=(0,n.__decorate)([(0,I._)(),(0,n.__param)(0,(0,C.W)(l.K)),(0,n.__param)(1,(0,C.W)(m.Om)),(0,n.__param)(2,(0,C.W)(v.D)),(0,n.__param)(3,(0,C.W)(g.k)),(0,n.__param)(4,(0,C.W)(d.n)),(0,n.__param)(5,(0,C.W)(c.c)),(0,n.__param)(6,(0,C.W)(h.d)),(0,n.__param)(7,(0,C.W)(f.b)),(0,n.__param)(8,(0,C.W)(o.H)),(0,n.__param)(9,(0,C.W)(u.g)),(0,n.__param)(10,(0,C.W)(p.M)),(0,n.__param)(10,(0,S.l)()),(0,n.__param)(11,(0,S.l)()),(0,n.__param)(11,(0,C.W)(T)),(0,n.__param)(12,(0,S.l)()),(0,n.__param)(12,(0,C.W)(E))],N)},547961:(e,t,i)=>{if(i.d(t,{c:()=>u}),0!=i.j)var n=i(844517);if(0!=i.j)var s=i(272962);if(0!=i.j)var o=i(278913);if(0!=i.j)var r=i(869070);var a=i(576583);if(0!=i.j)var l=i(120733);var d=i(208520);const c=(0,a.n)({fileStyles:{"& .fui-Avatar__icon":{background:"unset"}}}),u=({items:e,listboxProps:t,ariaLabel:i,isPartiallyLoading:a})=>{const u=c(),g=(0,l.E)("locale"),h=(0,l.E)("userDisplayName"),p=(0,d.useMemo)((()=>e.map((e=>(0,r.o)({item:e,locale:g,currentUserDisplayName:h})))),[e,g,h]),m=({type:e,avatar:t})=>Object.assign({className:"File"===e?u.fileStyles:void 0},"object"==typeof t?t:{});return d.createElement(n.O,Object.assign({},t,{"aria-label":i}),p.map((e=>d.createElement(s.C,Object.assign({key:`menuitem-${e.value}`},e,{avatar:m(e)})))),a&&d.createElement(d.Fragment,null,d.createElement(o.B,null),d.createElement(o.B,null)))}},551268:(e,t,i)=>{i.d(t,{k:()=>n});const n=(0,i(668952).f)("IHostModelSettings")},551852:(e,t,i)=>{i.d(t,{e:()=>n});class n{constructor(){this.mutex=Promise.resolve()}lock(){let e=e=>{};return this.mutex=this.mutex.then((()=>new Promise(e))),new Promise((t=>{e=t}))}}},551967:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(668952).f)("ICalloutDismissalHandler")},552903:(e,t,i)=>{i.d(t,{J:()=>o});var n=i(208520);if(0!=i.j)var s=i(185113);const o=e=>{const{targetDocument:t}=(0,s.Y)();(0,n.useEffect)((()=>{if(t)return t.addEventListener("keydown",e),()=>{t.removeEventListener("keydown",e)}}),[t,e])}},553164:(e,t,i)=>{var n;i.d(t,{Z:()=>n}),function(e){e[e.OutlineNode=0]="OutlineNode",e[e.TerminalNode=1]="TerminalNode",e[e.TileNode=2]="TileNode",e[e.ParagraphNode=3]="ParagraphNode"}(n||(n={}))},556940:(e,t,i)=>{if(i.d(t,{h:()=>s}),0!=i.j)var n=i(507628);function s(){return(0,n.A)()}},557135:(e,t,i)=>{if(i.d(t,{F:()=>l}),0!=i.j)var n=i(341755);if(0!=i.j)var s=i(627223);if(0!=i.j)var o=i(164942);if(0!=i.j)var r=i(367781);if(0!=i.j)var a=i(251439);class l{get uniqueId(){return(0,a.z)(507918362)}configureRootServices(e){e.bind(s.S).to(o.F),e.bind(n.i).toValue(r.T)}}},557354:(e,t,i)=>{i.d(t,{h:()=>c});var n=i(609029),s=i(381277);if(0!=i.j)var o=i(818935);if(0!=i.j)var r=i(332688);if(0!=i.j)var a=i(120733);var l=i(208520);const d=(0,n.A)(s.ZoI,s.hhx),c=({onButtonClick:e})=>{const t=(0,a.E)("requestEntitiesParams");return l.createElement(o.$,{"data-automation-id":"upload-local-files","aria-label":"deviceUpload",icon:l.createElement(d,null),appearance:"subtle",onClick:()=>{(0,r.jt)(t,"local"),null==e||e()}})}},560883:(e,t,i)=>{i.d(t,{M:()=>n});class n{constructor(e){this.params=e,this._disposed=!1,this._elementMap=new Map}get disposed(){return this._disposed}get targetDocument(){var e;return null!==(e=this.params.targetDocument)&&void 0!==e?e:document}async dispose(){this._disposed||(this._disposed=!0,this._elementMap.clear())}addElement(e,t){this._elementMap.set(e,t)}getElementById(e){var t;return null!==(t=this._elementMap.get(e))&&void 0!==t?t:null}getIdFromElement(e){for(const[t,i]of this._elementMap.entries())if(i===e)return t;return null}removeElement(e){this._elementMap.delete(e)}}},562093:(e,t,i)=>{if(i.d(t,{q:()=>l}),0!=i.j)var n=i(647879);if(0!=i.j)var s=i(920117);if(0!=i.j)var o=i(730387);if(0!=i.j)var r=i(46692);if(0!=i.j)var a=i(753031);class l{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1,this._diagosticEventName="GeneralDiagnostics",this.logDiagnostics=(e,t,i,n)=>{this.logActivityBase(this._diagosticEventName,e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.logActivityBase(e,void 0,t,i,n)},this.logActivityBase=(e,t,i,s,o)=>{const a=this.getNewActivity(e,r.o.SamplingPolicy.CriticalExperimentation);t&&(null==a||a.dataFields.push((0,n.n)("message",t))),o&&(null==a||a.dataFields.push((0,n.n)("correlationKeys",JSON.stringify(o)))),i&&(null==a||a.dataFields.push((0,n.n)("data",JSON.stringify(i)))),s&&(null==a||a.dataFields.push(...s)),a&&(a.success=!0,a.endNow())}}async initialize(e,t,i,n,r,a,l){var d;if(!this._initialized){if(!this._initializing)try{this._debugMode=null!==(d=await(null==i?void 0:i.read(s.l.DebugMode)))&&void 0!==d&&d,this._debugMode&&this._transports.push(new o.C);for(const e of this._transports)await e.initialize(i,r,a,n,l);this._activityTransport&&await this._activityTransport.initialize(i,r,a,n,l)}finally{this._initializing=!1}this._initialized=!0}}config({transports:e,activityTransport:t}){return this._transports=e,this._activityTransport=t,this}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,i,n){this.logEvent(e,null,t,i,r.o.SamplingPolicy.Measure,n)}info(e,t,i){this.logEvent(e,null,a.q.Info,t,r.o.SamplingPolicy.Measure,i)}warn(e,t,i){this.logEvent(e,null,a.q.Warn,t,r.o.SamplingPolicy.Measure,i)}error(e,t,i){this.logEvent(e,null,a.q.Error,t,r.o.SamplingPolicy.CriticalBusinessImpact,i)}debug(e,t,i){this.logEvent(e,null,a.q.Debug,t,r.o.SamplingPolicy.Diagnostics,i)}logServiceRequest(e,t,i,n,s){for(const o of this._transports)t&&(o.serviceRequestID=t),this.logEvent(e,null,i,n,r.o.SamplingPolicy.Measure,s)}logEvent(e,t,i,n,s,o,r){if(this._initialized&&(this._debugMode||i!==a.q.Debug))for(const a of this._transports)a.logEvent(e,t,i,n,s,o,r)}getNewActivity(e,t,i){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,i):void 0}dispose(){}}},564333:(e,t,i)=>{var n;i.d(t,{m:()=>n}),function(e){e.arrowDown="ArrowDown",e.arrowLeft="ArrowLeft",e.arrowRight="ArrowRight",e.arrowUp="ArrowUp",e.backspace="Backspace",e.delete="Delete",e.control="Control",e.enter="Enter",e.escape="Escape",e.space=" ",e.tab="Tab",e.home="Home",e.end="End",e.j="j",e.r="r",e.t="t",e.J="J",e.R="R",e.T="T"}(n||(n={}))},568621:(e,t,i)=>{i.d(t,{j:()=>o});var n=i(208520);if(0!=i.j)var s=i(120733);const o=e=>{const t=(0,s.E)("autoFocusSearchOnOpen"),i=(0,s.E)("searchOpened");(0,n.useEffect)((()=>{t&&e.current&&i&&e.current.focus()}),[t,e,i])}},570046:(e,t,i)=>{if(i.d(t,{C:()=>c}),0!=i.j)var n=i(341755);if(0!=i.j)var s=i(251439);if(0!=i.j)var o=i(386675);if(0!=i.j)var r=i(525809);if(0!=i.j)var a=i(541647);if(0!=i.j)var l=i(955637);if(0!=i.j)var d=i(929240);class c{constructor(){this.imports=[r.f]}get uniqueId(){return(0,s.z)(507918273)}configureRootServices(e){e.bind(n.i).toValue(l.C),e.bind(a.C).to(d.D),e.bind(o.S).toExisting(a.C)}}},572233:(e,t,i)=>{if(i.d(t,{J:()=>a}),0!=i.j)var n=i(754270);if(0!=i.j)var s=i(753031);if(0!=i.j)var o=i(46692);if(0!=i.j)var r=i(747594);class a{constructor(e,t,i,a,l,d,c=window){this._logger=e,this._eventName=i,this._logToTelemetry=l,this._onTimeout=d,this._onCommitMeasure=e=>{this._logToTelemetry(e.measures,e.correlationKeys,e.customData,e.eventName)},this._onCoreTimeout=e=>{var t;if(this._onTimeout){const i=(null===(t=e.customData)||void 0===t?void 0:t.length)?e.customData[0]:void 0;this._onTimeout(e.id,e.storedCorrelationKeys,i)}},this._onErrorEntryNotFound=e=>{this._logger.logEvent(505436036,n.f.TelemetryError,s.q.Error,`Unable to find performance entry by name: ${e.entryName}`,o.o.SamplingPolicy.CriticalExperimentation)},this._onErrorAddingCheckpoint=e=>{this._logger.logEvent(505436035,n.f.TelemetryError,s.q.Error,`Error while adding a checkpoint measure to a telemetry entry, error: ${e.errorCaught}`,o.o.SamplingPolicy.CriticalExperimentation)},this._onErrorCommitMeasure=e=>{this._logger.logEvent(505436034,n.f.TelemetryError,s.q.Error,`Error while commiting a telemetry entry, error: ${e.errorCaught}`,o.o.SamplingPolicy.CriticalExperimentation)},this._metricCore=new r.c(c,t,i,a),this._metricCore.subscribe("errorEntryNotFound",this._onErrorEntryNotFound),this._metricCore.subscribe("errorAddingCheckpoint",this._onErrorAddingCheckpoint),this._metricCore.subscribe("errorCommitMeasure",this._onErrorCommitMeasure),this._metricCore.subscribe("commitMeasure",this._onCommitMeasure),this._metricCore.subscribe("timeout",this._onCoreTimeout)}dispose(){this._metricCore.unsubscribe("errorEntryNotFound",this._onErrorEntryNotFound),this._metricCore.unsubscribe("errorAddingCheckpoint",this._onErrorAddingCheckpoint),this._metricCore.unsubscribe("errorCommitMeasure",this._onErrorCommitMeasure),this._metricCore.unsubscribe("commitMeasure",this._onCommitMeasure),this._metricCore.unsubscribe("timeout",this._onCoreTimeout)}startEntry(e,t,i){this._metricCore.startEntry(e,t,i)}addMeasure(e,t,i){this._metricCore.addMeasure(e,t,i)}commitEntry(e,t=this._eventName,i){this._metricCore.commitEntry(e,t,i)}setOnTimeout(e){this._onTimeout=e}}},575024:(e,t,i)=>{i.d(t,{$:()=>n});const n=(0,i(668952).f)("GetIsHighContrastTheme")},575672:(e,t,i)=>{i.d(t,{e:()=>d});var n=i(379490),s=i(653196),o=i(163573),r=i(229906),a=i(83010),l=i(700509);let d=class extends s.a{constructor(e){super(),this.hostSettings=e,this.defaultUxLanguage="en-US",this.editorSpellcheckAttribute="data-ms-editor",this.completeTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?l.fT.Paragraph:l.fT.Sentence,this.partialTileTextUnit=this.hostSettings.useParagraphAsTileSeparator?l.fT.Sentence:l.fT.Phrase,this.emitRemoval=!0,this.styleObserverIntervalTime=1,this.styleSampleTime=10,this.reconcileTileNodeTime=3e3,this.enableTileNodeAutoReconciliation=!0,this.maxSuggestionItemsDisplayNumber=3,this.maxSuggestionDisplayPerLanguageNumber=2,this.maxProofingLanguages=3,this.fabricFontsDefinitionPath="fonts/fabric-icons.css",this.enableSplitSuggestionButton=!1,this.narrowOnChangeReconciliation=!1,this.schedulerDefaultWaitingTime=50,this.schedulerDefaultMaxTime=2e3,this.schedulerDefaultWaitingTimeIncrement=400,this.maxServiceContentLengthInChars=350,this.maxContentLengthInChars=2e4}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.n))],d)},576240:(e,t,i)=>{i.d(t,{Z:()=>E});var n=i(379490),s=i(296690),o=i(667018),r=i(964549),a=i(999358),l=i(901163),d=i(713792);class c extends d.e{constructor(){super(...arguments),this.doReplacement=(e,t,i,n,s)=>{e.setRangeText(t,i,n,s),this.dispatchInputEvent()},this.calculateBoundaries=(e,t,i)=>{const n=e.value.length,s=Math.min(t,n);return{start:s,end:Math.min(s+i,n)}}}async insert(e,t){if(!this.element)return;const i=this.calculateBoundaries(this.element,e,0);this.doReplacement(this.element,t,i.start,i.end,"end")}async replace(e,t,i){if(!this.element)return;const n=this.calculateBoundaries(this.element,e,t);this.doReplacement(this.element,i,n.start,n.end,"end")}async autoCorrect(e,t,i){if(!this.element)return;const n=this.calculateBoundaries(this.element,e,t),s=this.element.value.substring(n.start,n.end);return this.doReplacement(this.element,i,n.start,n.end,"preserve"),s}async remove(e,t,i,n,s,o){if(!this.element)return;const r=this.calculateBoundaries(this.element,o?e-1:e,o?t+1:t);this.doReplacement(this.element,"",r.start,r.end)}}class u extends d.e{constructor(e){super(),this.textRetrieverFactory=e}async insert(e,t){if(!this.element)return;const i=this.getReplacedText(e,e,t);this.element.innerText=i.text}async replace(e,t,i){if(!this.element)return;const n=this.getReplacedText(e,e+t,i);this.element.innerText=n.text}async autoCorrect(e,t,i){if(!this.element)return;const n=this.getReplacedText(e,e+t,i);return this.element.innerText=n.text,n.replacedPart}async remove(e,t,i,n,s,o=!1){if(!this.element)return;const r=this.getReplacedText(e,e+t,void 0,!o);this.element.innerText=r.text}getReplacedText(e,t,i,n){const s=this.getText(),o=s.length;let r=Math.min(e,o);const a=Math.min(t,o);n||i||" "!==s[r-1]||(r-=1);return{text:`${s.substring(0,r)}${null!=i?i:""}${s.substring(a)}`,replacedPart:s.substring(r,a)}}getText(){return this.element?this.textRetrieverFactory(this.element).retrieve().content:""}}var g=i(481593),h=i(359310),p=i(442316),m=i(538045),f=i(786132),v=i(615930);class y{constructor(e,t,i,n){this._proofingDom=e,this._tileContent=t,this._indexReadjuster=i,this.targetWindow=n,this.getTextSelection=()=>{var e,t;const i=(null!==(t=null===(e=this.targetWindow)||void 0===e?void 0:e.deref())&&void 0!==t?t:window).getSelection();if(i){const e=this.getParentTileElement(i.anchorNode),t=this.getParentTileElement(i.focusNode);if(e&&t)return this.attemptToFindSelectionRange(e,t,i)}return Promise.resolve(void 0)},this.attemptToFindOffsetsIntoParentElement=(e,t)=>{const i=[],n=e.element&&this._tileContent.getContainingElement(e.element);if(!n)return i;const s=document.createTreeWalker(n,NodeFilter.SHOW_ALL,{acceptNode:()=>NodeFilter.FILTER_ACCEPT});let o=0;for(;s.nextNode();){const e=s.currentNode,n=e.textContent&&e.nodeType===e.TEXT_NODE?e.textContent.length:0;for(let n=0;n<t.length;n++)e===t[n]&&(i[n]=o);if(o+=n,i.length===t.length)break}if(0===o)for(let e=0;e<t.length;e++)n===t[e]&&(i[e]=o);return i},this.attemptToFindSelectionRange=async(e,t,i)=>{var n,s,o,r,a,l,d,c,u,g,h,p,m,f;let v,y;if(e.id===t.id){const t=this.attemptToFindOffsetsIntoParentElement(e,[i.anchorNode,i.focusNode]);v=t[0],y=t[1]}else v=this.attemptToFindOffsetsIntoParentElement(e,[i.anchorNode])[0],y=this.attemptToFindOffsetsIntoParentElement(t,[i.focusNode])[0];if(void 0!==v&&void 0!==y&&e.element&&t.element){let _,I,C,S,b,T,E=0,N=0;if(v>y?(E=y+i.focusOffset,N=v+i.anchorOffset,b=t,T=e):(E=v+i.anchorOffset,N=y+i.focusOffset,b=e,T=t),e.id===t.id){const t=this._tileContent.getContainingElement(e.element);if(!t)return;b=T=e;const h=null!==(s=null===(n=this._tileContent.getText(e))||void 0===n?void 0:n.content)&&void 0!==s?s:"";if(this._indexReadjuster)if(E===N){const e=0!==E&&"\n"===h.charAt(E),i=await this._indexReadjuster.getReadjustedIndices(t,[e?E-1:E],h,!0);e?(E=i[0]+1,N=i[0]+1):(E=i[0],N=i[0])}else{const e=await this._indexReadjuster.getReadjustedIndices(t,[E,N],h,!0);E=e[0],N=e[1]}if(!e.children)return{startParentElement:b,endParentElement:T,isCollapsed:i.isCollapsed,selectedText:i.toString(),startPosition:E,endPosition:N,startParagraphNode:_,endParagraphNode:I,startPositionInParagraphNode:C,endPositionInParagraphNode:S};for(const t of e.children){const e=t.element;E===N&&0!==E?E-1>=e.offset&&E-1<e.offset+e.span&&(_=t,C=E-e.offset,I=t,S=E-e.offset):(E>=e.offset&&(E<e.offset+e.span||0===E&&e.offset+e.span===0)&&(_=t,C=E-e.offset),N>=e.offset&&(N<e.offset+e.span||0===N&&e.offset+e.span===0)&&(I=t,S=N-e.offset))}if(!I){let t;for(const i of e.children)(!t||(null!==(r=null===(o=i.element)||void 0===o?void 0:o.offset)&&void 0!==r?r:0)>(null!==(l=null===(a=t.element)||void 0===a?void 0:a.offset)&&void 0!==l?l:0))&&(t=i);if(null==t?void 0:t.element){N===t.element.offset+t.element.span&&(I=t,S=N-t.element.offset)}}if(E===N&&!_&&!I){let t;for(const i of e.children)(!t||(null!==(c=null===(d=i.element)||void 0===d?void 0:d.offset)&&void 0!==c?c:0)>(null!==(g=null===(u=t.element)||void 0===u?void 0:u.offset)&&void 0!==g?g:0))&&(t=i);if(null==t?void 0:t.element){E===t.element.offset+t.element.span+1&&(_=t,C=E-t.element.offset,I=t,S=E-t.element.offset)}}}else{if(E=y+i.focusOffset,N=v+i.anchorOffset,b=t,T=e,!b.element||!T.element)return;const n=this._tileContent.getContainingElement(b.element),s=this._tileContent.getContainingElement(T.element);if(this._indexReadjuster&&n&&s){const e=null!==(p=null===(h=this._tileContent.getText(b))||void 0===h?void 0:h.content)&&void 0!==p?p:"";E=(await this._indexReadjuster.getReadjustedIndices(n,[E],e,!0))[0];const t=null!==(f=null===(m=this._tileContent.getText(T))||void 0===m?void 0:m.content)&&void 0!==f?f:"";N=(await this._indexReadjuster.getReadjustedIndices(s,[N],t,!0))[0]}if(b.children)for(const e of b.children)E>=e.element.offset&&E<e.element.offset+e.element.span&&(_=e,C=E-e.element.offset);if(T.children)for(const e of T.children)N>=e.element.offset&&N<e.element.offset+e.element.span&&(I=e,S=N-e.element.offset)}return{startParentElement:b,endParentElement:T,isCollapsed:i.isCollapsed,selectedText:i.toString(),startPosition:E,endPosition:N,startParagraphNode:_,endParagraphNode:I,startPositionInParagraphNode:C,endPositionInParagraphNode:S}}},this.getParentTileElement=e=>{let t;for(const i of this._proofingDom.tileNodes){this._tileContent.getContainingElement(i)===e&&(t=i)}return t||((null==e?void 0:e.parentNode)?this.getParentTileElement(e.parentNode):void 0)}}}var _=i(229906),I=i(83010),C=i(427603),S=i(701121),b=i(1144),T=i(944749);let E=class{constructor(e,t,i,n,s){this._proofingDom=e,this.indexReadjuster=t,this.safeWindow=i,this.logger=n,this.targetWindowRef=s,this.attachedToParagraphLevelDivs=!1}getText(e){const t=this.getTextRetriever(e,void 0);if(t)return t.retrieve()}async dispose(){var e,t;null===(t=(e=this.indexReadjuster).shutDown)||void 0===t||t.call(e)}getTextSelection(){return new y(this._proofingDom,this,this.indexReadjuster,this.targetWindowRef).getTextSelection()}getContainingElement(e){return(0,f.C)(e,"HTMLElement")?e:(0,S.ZR)(e)&&(0,b.l)(e)?N(e.parent):N(e)}async insert(e,t,i,n,s,o,r,a){const l=this.getTextWriter(e,t);if(l)return l.insert(i,n,s,o,r,a)}async replace(e,t,i,n,s,o){const r=this.getTextWriter(e,t);if(r)return r.replace(i,n,s,o)}async remove(e,t,i,n,s,o,r,a){const l=this.getTextWriter(e,t);if(l)return l.remove(i,n,o,r,a,s)}async autoCorrect(e,t,i,n,s,o,r){const a=this.getTextWriter(e,t);if(a)return a.autoCorrect(i,n,s,o,r)}async getCritiqueRanges(e,t,i){const n=null!=t?t:N(e);if(!n)return i.map((e=>({critique:e,range:void 0})));const s=this.getTextNodeRangeBuilder(e,t);return s?s.getCritiqueRanges(n,i):i.map((e=>({critique:e,range:void 0})))}async getRangeOfNode(e,t,i,n){const s=null!=t?t:N(e);if(!s)return;const o=this.getTextNodeRangeBuilder(e,t);return o?o.getRangeOfNode(s,i,n,(0,T.$)(e)?e.plainText:void 0):void 0}async getNodeInsertionPosition(e,t,i){const n=N(e);if(!n)return;const s=this.getTextNodeRangeBuilder(e,void 0);return s?s.getNodeInsertionPosition(n,t,i):void 0}getTextNodeRangeBuilder(e,t){const i=this.getTextRetriever(e,t);if(i)return new s.g((()=>i),this.indexReadjuster)}getTextRetriever(e,t){const i=null!=t?t:N(e);if(!i)return;let n;return n=(0,f.C)(i,"HTMLInputElement")||(0,f.C)(i,"HTMLTextAreaElement")?new o.D(i):this.attachedToParagraphLevelDivs?new r._(i):new a.x(i),n}getTextWriter(e,t){var i;const n=null!==(i=N(e))&&void 0!==i?i:t,s=this.getTextNodeRangeBuilder(e,t),o=this.getTextRetriever(e,t);if(!n||!s||!o)return;let r;var a,d,g;return d="contenteditable",g="true",r=(a=n).hasAttribute(d)&&a.getAttribute(d)===g||null!==a.closest(`[${d}=${g}]`)?new l.M(s,this.safeWindow,this.logger):(0,f.C)(n,"HTMLInputElement")||(0,f.C)(n,"HTMLTextAreaElement")?new c:new u((()=>o)),r.setHtmlElement(n),r}};function N(e){return(0,b.l)(e)?e.parent.element:e.element}E=(0,n.__decorate)([(0,_._)(),(0,n.__param)(0,(0,I.W)(m.w)),(0,n.__param)(1,(0,I.W)(g.h)),(0,n.__param)(2,(0,I.W)(h.j)),(0,n.__param)(3,(0,I.W)(p.g)),(0,n.__param)(3,(0,C.l)()),(0,n.__param)(4,(0,I.W)(v.sh)),(0,n.__param)(4,(0,C.l)())],E)},577059:(e,t,i)=>{if(i.d(t,{S:()=>s}),0!=i.j)var n=i(514455);function s(e){if(e)return(0,n.L)(e)?e:"Cloud"}},584223:(e,t,i)=>{i.d(t,{n:()=>n});const n=(0,i(668952).f)("ICritiqueApplicationHandler")},585170:(e,t,i)=>{i.d(t,{h:()=>M});var n=i(379490);const s=(0,i(668952).f)("IChildElementFinderFactory");var o=i(937229),r=i(701121),a=i(786132),l=i(823325),d=i(537969),c=i(609062),u=i(922630),g=i(551268),h=i(980495),p=i(335009),m=i(83605),f=i(58215),v=i(538045),y=i(627223),_=i(772830),I=i(104072),C=i(985500),S=i(553164),b=i(395353),T=i(445801),E=i(556940),N=i(229906);let w=class extends T.W{get children(){var e,t;return(null===(e=this._hostSettings)||void 0===e?void 0:e.sdkV2Enabled)?null!==(t=this._proofingDom.getTileNodeV2Paragraphs(this))&&void 0!==t?t:[]:this._children}set children(e){this._children=e}constructor(e,t,i,n,s,o,r,a,l,d){super(i,n,void 0,s,o,r),this._proofingDom=e,this._tileContent=t,this.nodeType=i,this._observer=n,this.element=s,this.parent=o,this._logger=a,this._nodeTraverser=l,this._hostSettings=d,this._children=[],this.id=(0,E.h)(),this._proofingDom.registerNode(this)}retire(){var e;this.parent=void 0,null===(e=this._logger)||void 0===e||e.debug(0,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}move(e,t){return this._proofingDom.unregisterNode(this),super.move(e,t),this._proofingDom.registerNode(this),this}resetState(e){}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,i,n,s,o){}get plainText(){return this.pullText().content}getPreviousTileId(){var e;const t=null===(e=this._nodeTraverser)||void 0===e?void 0:e.findPreviousTileNode(this);return"#head#"===t?t:null==t?void 0:t.id}getNextTileId(){var e;const t=null===(e=this._nodeTraverser)||void 0===e?void 0:e.findNextTileNode(this);return"#tail#"===t?t:null==t?void 0:t.id}};w=(0,n.__decorate)([(0,N._)()],w);var x=i(432648);function L(e,t,i){if(e.spellcheck){const i=e.closest("[contenteditable=true]"),n=null==i?void 0:i.getAttribute("spellcheck"),s=e.getAttribute("spellcheck");return i?i.setAttribute("spellcheck","false"):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(i||e).setAttribute(t.editorSpellcheckAttribute,"true"),i=>{const o=i.closest("[contenteditable=true]");o?n?o.setAttribute("spellcheck",n):o.removeAttribute("spellcheck"):s?(e.setAttribute("spellcheck",s),e.spellcheck=!1):(e.setAttribute("spellcheck","false"),e.spellcheck=!1),(o||i).removeAttribute(t.editorSpellcheckAttribute)}}if(null==i?void 0:i.some((t=>t(e)))){return(e.closest("[contenteditable=true]")||e).setAttribute(t.editorSpellcheckAttribute,"true"),e=>{(e.closest("[contenteditable=true]")||e).removeAttribute(t.editorSpellcheckAttribute)}}return()=>{}}var D=i(83010),A=i(427603);let F=class{constructor(e,t,i,n,s,o,r,u,g,h,p,m,f,v,y){this._observerFactory=e,this._tileContent=t,this._proofingDom=i,this._nodePoller=n,this._tileNodeReader=s,this._settings=o,this._hostSettings=r,this._childElementsFinderFactory=u,this._hostEmitter=h,this._graphNodeFactory=p,this.shadowElementsStore=f,this.textEventPublisher=v,this.nodeTraverser=y,this.buildNode=(e,t,i,n)=>{var s,o;const r=this._observerFactory(this._graphNodeBuilderTerminalRule.observerType,this._graphNodeBuilderTerminalRule),u=new x.x(r,e,t,n),g=this._childElementsFinderFactory(this._graphNodeBuilderTerminalRule.elementsFinder),h=this._getNewTopology(u,g,u).map((e=>this.createTileNode(e,u)));u.children=h,u.documentModel=i;const p=L(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);return u.registerVisualizationRemovedCallback((()=>{const e=this._tileContent.getContainingElement(u);e&&p(e)})),((0,a.C)(e,"HTMLInputElement")||(0,a.C)(e,"HTMLTextAreaElement"))&&(null===(s=this.shadowElementsStore)||void 0===s||s.setCanvasElement(h[0].id,e)),r.onElementAdded=(e,t)=>{var i,n,s;if(!u.element||u.element.contains(e)){if(this._hostSettings.whitelistProofingSelectors||this._hostSettings.skipProofingSelectors){let t=!1;for(const s of null!==(i=u.children)&&void 0!==i?i:[])if(null===(n=s.element)||void 0===n?void 0:n.contains(e)){t=!0;break}if(!t){const t=g.find(e).map((e=>this.createTileNode(e,u)));u.children=u.children?u.children.concat(t):t}}this._nodePoller.pollNodes(l.G.NewData,null!==(s=u.children)&&void 0!==s?s:[],t,void 0,void 0,void 0,!this._hostSettings.enableOrchestration)}},r.onElementChanged=(e,t,i,n)=>{this._nodePoller.pollNodes(l.G.ChangeData,this._getChildrenToReconcile(u,e),t,void 0,void 0,void 0,void 0,n)},r.onElementRemoved=(e,t)=>{var i;this._nodePoller.pollNodes(l.G.ChangeData,null!==(i=u.children)&&void 0!==i?i:[],t)},r.onVisualStateChanged=(e,t)=>{var i,n,s,o,r;if("StyleChange"!==t){if("Created"===t){const e=this._tileContent.getContainingElement(u);if(e){const t=L(e,this._settings,this._graphNodeBuilderTerminalRule.spellcheckOverrides);u.registerRetireCallback((()=>{const e=this._tileContent.getContainingElement(u);e&&t(e)}))}}else u.visualizationWasRemoved();this._nodePoller.pollNodes(l.G.ChangeData,null!==(n=u.children)&&void 0!==n?n:[],c.Q0.Code,void 0,!0,void 0,void 0);for(const e of null!==(s=u.children)&&void 0!==s?s:[])null===(o=this._hostEmitter)||void 0===o||o.emit(d.pD.hostModelVisualStateChange,{address:void 0,message:{tileId:e.id,tileVersion:null!==(r=e.eventSeqId)&&void 0!==r?r:0,created:"Created"===t}})}else null===(i=this.textEventPublisher)||void 0===i||i.publishTextStyleEvent()},this._nodePoller.pollNodes(l.G.NewData,u.children,null!==(o=this._graphNodeBuilderTerminalRule.initialContentChangeType)&&void 0!==o?o:c.Q0.Code),u},this._getNewTopology=(e,t,i)=>e.element?t.find(e.element,this._graphNodeBuilderTerminalRule.filterSelector).filter((e=>this._graphNodeBuilderTerminalRule.filters.every((t=>t(e,i,this._graphNodeBuilderTerminalRule))))):[],this._graphNodeBuilderTerminalRule=g.nodeMetaType,this._paragraphNodesBuilder=null==m?void 0:m(this._graphNodeBuilderTerminalRule.completeTileTextUnit,this._graphNodeBuilderTerminalRule.partialTileTextUnit)}_getChildrenToReconcile(e,t){return[...(e.children||[]).filter((e=>{var i,n;return null!==(n=null===(i=e.element)||void 0===i?void 0:i.contains(t))&&void 0!==n?n:!this._settings.narrowOnChangeReconciliation&&this._tileNodeReader.critiques(e).length}))]}createTileNode(e,t){const i=this._observerFactory(b.j.AttributeObserver),n=this._paragraphNodesBuilder&&this._graphNodeFactory?this._graphNodeFactory(S.Z.TileNode,i,e,t,void 0,this._paragraphNodesBuilder):new w(this._proofingDom,this._tileContent,S.Z.TileNode,i,e,t,void 0,void 0,this.nodeTraverser,this._hostSettings);return this._hostSettings.disableTileNodeObserver||(i.onElementChanged=(e,t)=>{this._nodePoller.pollNodes(l.G.NewData,[n],t)},i.observe(document.body)),n}};F=(0,n.__decorate)([(0,N._)(),(0,n.__param)(0,(0,D.W)(h.C)),(0,n.__param)(1,(0,D.W)(I.d)),(0,n.__param)(2,(0,D.W)(v.w)),(0,n.__param)(3,(0,D.W)(p.G)),(0,n.__param)(4,(0,D.W)(C.j)),(0,n.__param)(5,(0,D.W)(g.k)),(0,n.__param)(6,(0,D.W)(u.n)),(0,n.__param)(7,(0,D.W)(s)),(0,n.__param)(8,(0,D.W)(o.RW)),(0,n.__param)(9,(0,A.l)()),(0,n.__param)(9,(0,D.W)(d.M5)),(0,n.__param)(10,(0,A.l)()),(0,n.__param)(10,(0,D.W)(r.WP)),(0,n.__param)(11,(0,A.l)()),(0,n.__param)(11,(0,D.W)(f.u)),(0,n.__param)(12,(0,A.l)()),(0,n.__param)(12,(0,D.W)(y.S)),(0,n.__param)(13,(0,A.l)()),(0,n.__param)(13,(0,D.W)(_.n)),(0,n.__param)(14,(0,A.l)()),(0,n.__param)(14,(0,D.W)(m.M))],F);var q=i(615930),R=i(442316),P=i(697827),O=i(730976),k=i(649055);let M=class{constructor(e,t,i,n,s,o,r,a,l,d,c,u,g){this.hostSettings=e,this.proofingDom=t,this._settings=i,this._tileContent=n,this._tileNodeReader=s,this._nodePoller=o,this._textEventPublisher=r,this.logger=a,this.targetDocumentFactory=l,this._hostEmitter=d,this._graphNodeFactory=c,this._paragraphNodesBuilderFactory=u,this.shadowElementsStore=g}createGraphNode(e){const{element:t,filterSelector:i,parent:n,initialContentChangeType:s,documentModel:o,terminalNodeId:r}=e;if(!this._validateElementWithProofingDom(t))return;return this.getGraphNodeBuilderFactory(t,i,s).buildNode(t,n,o,r)}getGraphNodeBuilderFactory(e,t,i){const n=this.getObserverTypeBasedOnElement(e),s={ruleName:"",nodeMetaType:{nodeType:S.Z.TerminalNode,observerType:n,filters:[],filterSelector:t,initialContentChangeType:i},childMetaType:null},o=this._buildChildElementFinderFactory();return new F(((e,t)=>function(e,t,i,n){const s=e=>new MutationObserver(e);switch(e){case b.j.InputNodeObserver:return new k.D(s,i);case b.j.TerminalNodeObserver:return new O.o(s,i);default:return new P.P(s,{ignoredMutationElementsSelectors:n},i)}}(e,0,this.logger,this.hostSettings.ignoredMutationElementsSelectors)),this._tileContent,this.proofingDom,this._nodePoller,this._tileNodeReader,this._settings,this.hostSettings,o,s,this._hostEmitter,this._graphNodeFactory,this._paragraphNodesBuilderFactory,this.shadowElementsStore,this._textEventPublisher)}_buildDefaultChildElementFinderFactory(){return()=>({find:e=>[e]})}_buildProofingChildElementFinderWithSkippedSelectorsFactory(e){const t={find:t=>{const i=[],n=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(null==n?void 0:n.closest(e))return[];if(n&&!n.querySelector(e))return[t];const s=t.ownerDocument.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:t=>{var n;if(t.closest(e))return NodeFilter.FILTER_REJECT;if(t.querySelector(e)){let e=!1;const i=t.childNodes;for(let t=0;t<i.length;t++)if(i[t].nodeType===Node.TEXT_NODE&&(null===(n=i[t].textContent)||void 0===n?void 0:n.trim())){e=!0;break}return e?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}for(const e of i)if(e.contains(t))return NodeFilter.FILTER_REJECT;return NodeFilter.FILTER_ACCEPT}});for(;s.nextNode();)i.push(s.currentNode);return i}};return()=>t}_buildWhitelistChildElementFinderFactory(e){const t={find:t=>{const i=t.nodeType===t.ELEMENT_NODE?t:t.parentElement;if(null==i?void 0:i.closest(e))return[t];const n=null==i?void 0:i.querySelectorAll(e);return n?Array.from(n):[]}};return()=>t}_buildChildElementFinderFactory(){return this.hostSettings.whitelistProofingSelectors?this._buildWhitelistChildElementFinderFactory(this.hostSettings.whitelistProofingSelectors):this.hostSettings.skipProofingSelectors?this._buildProofingChildElementFinderWithSkippedSelectorsFactory(this.hostSettings.skipProofingSelectors):this._buildDefaultChildElementFinderFactory()}getObserverTypeBasedOnElement(e){return(0,a.C)(e,"HTMLInputElement")||(0,a.C)(e,"HTMLTextAreaElement")?b.j.InputNodeObserver:b.j.TerminalNodeObserver}_validateElementWithProofingDom(e){var t,i,n,s;if(!(0,a.C)(e,"HTMLElement"))return!0;for(const i of this.proofingDom.tileNodes.values())if((0,a.C)(i.element,"HTMLElement")&&(i.element.contains(e)||e.contains(i.element)))return null===(t=this.logger)||void 0===t||t.error(508146704,"The element is already contained within another attached element."),!1;if(!this.hostSettings.doNotLimitToTargetDocument&&this.targetDocumentFactory){const t=null===(i=this.targetDocumentFactory())||void 0===i?void 0:i.deref();if(t&&e.ownerDocument!==t)return null===(n=this.logger)||void 0===n||n.error(508146703,"The element must be within the target document."),!1}return!!((0,a.C)(e,"HTMLInputElement")&&["text","search"].includes(e.type)||(0,a.C)(e,"HTMLTextAreaElement")||e.isContentEditable)||(null===(s=this.logger)||void 0===s||s.error(508146702,"Unsupported element - only input (of type search and text only), textarea, and content editable elements are supported."),!1)}};M=(0,n.__decorate)([(0,N._)(),(0,n.__param)(0,(0,D.W)(u.n)),(0,n.__param)(1,(0,D.W)(v.w)),(0,n.__param)(2,(0,D.W)(g.k)),(0,n.__param)(3,(0,D.W)(I.d)),(0,n.__param)(4,(0,D.W)(C.j)),(0,n.__param)(5,(0,D.W)(p.G)),(0,n.__param)(6,(0,A.l)()),(0,n.__param)(6,(0,D.W)(_.n)),(0,n.__param)(7,(0,A.l)()),(0,n.__param)(7,(0,D.W)(R.g)),(0,n.__param)(8,(0,A.l)()),(0,n.__param)(8,(0,D.W)(q.Ze)),(0,n.__param)(9,(0,A.l)()),(0,n.__param)(9,(0,D.W)(d.M5)),(0,n.__param)(10,(0,A.l)()),(0,n.__param)(10,(0,D.W)(r.WP)),(0,n.__param)(11,(0,A.l)()),(0,n.__param)(11,(0,D.W)(f.u)),(0,n.__param)(12,(0,A.l)()),(0,n.__param)(12,(0,D.W)(y.S))],M)},585272:(e,t,i)=>{i.d(t,{O:()=>I});class n{constructor(){this.listeners={}}subscribe(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n.push(t),this.listeners[e]=n}unsubscribe(e,t){var i;let n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n=n.filter((e=>e!==t)),this.listeners[e]=n}publishEvent(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];for(const e of n)try{e(t)}catch(e){}}}var s=i(379490),o=i(668952);const r=(0,o.f)("ITransportLogger"),a=(0,o.f)("ITransportActivity");var l=i(229906),d=i(66008),c=i(83010),u=i(809610),g=i(405658),h=i(289062),p=i(46692),m=i(753031);class f{constructor(e,t){this._transports=e,this._activityTransport=t,this._debugMode=!1,this._initialized=!1,this._initializing=!1,this._diagosticEventName="GeneralDiagnostics",this.logDiagnostics=(e,t,i,n)=>{this.logActivityBase(this._diagosticEventName,e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.logActivityBase(e,void 0,t,i,n)},this.logActivityBase=(e,t,i,n,s)=>{const o=this.getNewActivity(e,p.o.SamplingPolicy.CriticalExperimentation);t&&(null==o||o.dataFields.push((0,u.n)("message",t))),s&&(null==o||o.dataFields.push((0,u.n)("correlationKeys",JSON.stringify(s)))),i&&(null==o||o.dataFields.push((0,u.n)("data",JSON.stringify(i)))),n&&(null==o||o.dataFields.push(...n)),o&&(o.success=!0,o.endNow())}}async initialize(e,t,i,n,s,o,r){var a;if(!this._initialized){if(!this._initializing)try{this._debugMode=null!==(a=await(null==i?void 0:i.read(g.l.DebugMode)))&&void 0!==a&&a,this._debugMode&&this._transports.push(new h.C);for(const e of this._transports)await e.initialize(i,s,o,n,r);this._activityTransport&&await this._activityTransport.initialize(i,s,o,n,r)}finally{this._initializing=!1}this._initialized=!0}}config({transports:e,activityTransport:t}){return this._transports=e,this._activityTransport=t,this}addCorrelationID(e){for(const t of this._transports)t.addCorrelationID(e);this._activityTransport&&this._activityTransport.addCorrelationID(e)}log(e,t,i,n){this.logEvent(e,null,t,i,p.o.SamplingPolicy.Measure,n)}info(e,t,i){this.logEvent(e,null,m.q.Info,t,p.o.SamplingPolicy.Measure,i)}warn(e,t,i){this.logEvent(e,null,m.q.Warn,t,p.o.SamplingPolicy.Measure,i)}error(e,t,i){this.logEvent(e,null,m.q.Error,t,p.o.SamplingPolicy.CriticalBusinessImpact,i)}debug(e,t,i){this.logEvent(e,null,m.q.Debug,t,p.o.SamplingPolicy.Diagnostics,i)}logServiceRequest(e,t,i,n,s){for(const o of this._transports)t&&(o.serviceRequestID=t),this.logEvent(e,null,i,n,p.o.SamplingPolicy.Measure,s)}logEvent(e,t,i,n,s,o,r){if(this._initialized&&(this._debugMode||i!==m.q.Debug))for(const a of this._transports)a.logEvent(e,t,i,n,s,o,r)}getNewActivity(e,t,i){return this._initialized&&this._activityTransport?this._activityTransport.getNewActivity(e,t,i):void 0}dispose(){}}let v=class{constructor(e,t){this._transports=e,this._activityTransport=t,this.logDiagnostics=(e,t,i,n)=>{this.baseLogger.logDiagnostics(e,t,i,n)},this.logActivity=(e,t,i,n)=>{this.baseLogger.logActivity(e,t,i,n)},this.baseLogger=new f(e,t)}async initialize(e,t,i,n,s,o,r){await this.baseLogger.initialize(e,t,i,n,s,o,r)}config({transports:e,activityTransport:t}){return this.baseLogger.config({transports:e,activityTransport:t})}addCorrelationID(e){this.baseLogger.addCorrelationID(e)}log(e,t,i,n){this.baseLogger.log(e,t,i,n)}info(e,t,i){this.baseLogger.info(e,t,i)}warn(e,t,i){this.baseLogger.warn(e,t,i)}error(e,t,i){this.baseLogger.error(e,t,i)}debug(e,t,i){this.baseLogger.debug(e,t,i)}logServiceRequest(e,t,i,n,s){this.baseLogger.logServiceRequest(e,t,i,n,s)}logEvent(e,t,i,n,s,o,r){this.baseLogger.logEvent(e,t,i,n,s,o,r)}getNewActivity(e,t,i){return this.baseLogger.getNewActivity(e,t,i)}dispose(){this.baseLogger.dispose()}};v=(0,s.__decorate)([(0,l._)(),(0,s.__param)(0,(0,d.t)(r)),(0,s.__param)(1,(0,c.W)(a))],v);var y=i(374831);class _ extends n{constructor(){super(),this.sendActivityTelemetryEvent=e=>{const t={eventName:e.eventName,data:void 0,logType:"Activity",eventFlags:e.eventFlags,dataFields:e.dataFields,eventContract:e.eventContract};this.publishEvent("telemetryLog",t)},this.activityEventGenerationHelper=new y.c(this.sendActivityTelemetryEvent)}async initialize(e,t,i,n,s){}logEvent(e,t,i,n,s,o,r){const a={eventName:t,data:o};this.publishEvent("telemetryLog",Object.assign(Object.assign({},a),{logType:"Event",tagID:e,level:i,message:n,eventFlags:{samplingPolicy:s}}))}getNewActivity(e,t,i){return this.activityEventGenerationHelper.createActivity({eventName:e,eventFlags:{dataCategories:p.o.DataCategories.ProductServiceUsage,samplingPolicy:t,diagnosticLevel:p.o.DiagnosticLevel.Required}})}addCorrelationID(e){this._sessionCorrelationId=e,this._sessionCorrelationId}}class I extends n{constructor(){super(),this.handleTelemetryLog=e=>{this.publishEvent("telemetryLog",e)},this.transportEventLogger=new _,this.logger=new v([this.transportEventLogger],this.transportEventLogger)}async initialize(){await this.logger.initialize(),this.transportEventLogger.subscribe("telemetryLog",this.handleTelemetryLog)}dispose(){this.transportEventLogger.unsubscribe("telemetryLog",this.handleTelemetryLog),this.logger.dispose()}get loggerInstance(){return this.logger}}},586929:(e,t,i)=>{i.d(t,{B:()=>n});const n=(0,i(668952).f)("IHostModelPersistedStore")},589171:(e,t,i)=>{i.d(t,{R:()=>f});var n=i(379490),s=i(404741),o=i(825948),r=i(215926),a=i(877931),l=i(494888),d=i(163573),c=i(852748),u=i(771588),g=i(760995),h=i(229906),p=i(83010),m=i(427603);let f=class{constructor(e,t,i,n,s,o,r){this._guidGenerator=e,this._registrar=t,this._proofingPersistedStore=i,this._sessionContextProvider=n,this._logger=s,this._featureFlagsReader=o,this._hostSettings=r}async initializeComponent(){let e;await this._featureFlagsReader.refreshFlags();try{this._sessionContextProvider&&(e=await this._sessionContextProvider())}catch(e){}await this._logger.initialize(void 0,!1,this._proofingPersistedStore,this._featureFlagsReader,e,void 0,this._hostSettings),this._logger.debug(520984581,"Logger initialized"),g.R.addUnhandledExceptionsListeners(this._logger,s.s.UnhandledContentError,"Unhandled async content script error"),this._logger.debug(520984580,"Initializing telemetry");const t=this._guidGenerator.generate();this._logger.addCorrelationID(t),this._logger.debug(520984579,"Registering listeners"),await this._registrar.initialize()}};f=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,p.W)(c.G)),(0,n.__param)(1,(0,p.W)(u.V)),(0,n.__param)(2,(0,p.W)(o.K)),(0,n.__param)(3,(0,p.W)(r.a)),(0,n.__param)(3,(0,m.l)()),(0,n.__param)(4,(0,p.W)(a.g)),(0,n.__param)(5,(0,p.W)(l.c)),(0,n.__param)(6,(0,p.W)(d.n))],f)},589218:(e,t,i)=>{if(i.r(t),i.d(t,{GraphSearchLocalAnnotationListener:()=>n.N,HybridModule:()=>s.p,graphSearchLocalOverrideHostCallbacks:()=>r.g,hostConfigToGraphConfig:()=>o.uz}),0!=i.j)var n=i(719249);if(0!=i.j)var s=i(291688);if(0!=i.j)var o=i(731158);if(0!=i.j)var r=i(806988)},589445:(e,t,i)=>{i.d(t,{m:()=>n});const n=(0,i(668952).f)("IAriaStatusUniqueProxy")},590237:(e,t,i)=>{i.d(t,{s:()=>Z});var n=i(794329),s=i(647620),o=i(65314),r=i(670802),a=i(765062),l=i(229105),d=i(863307),c=i(35865),u=i(208520);const g="en-US";class h{constructor({eventSource:e,onItemSelected:t,locale:i,triggerKeyConfig:n,fileUploadSettings:s,dir:o,themeType:r,userInfo:d,getPeopleIconURL:u}){this.suggestionEntitiesStore=(0,a.V)(),this.menuStateStore=(0,l.W)(),this.eventSource=e,this.onItemSelected=t,this.locale=i,this.triggerKeyConfig=n,this.fileUploadSettings=s||{},this.dir=o,this.themeType=r,c.e.setFallbackLocale(g),c.e.loadLocale(g),c.e.loadLocale(this.locale);const{setLocale:h,setUserDisplayName:p,setGetPeopleIconURL:m,setOnMenuClose:f,setFileUploadSettings:v,setOnClickedOutsideMenu:y}=this.menuStateStore.getState();h(this.locale),p((null==d?void 0:d.userDisplayName)||""),u&&m(u),f(this.onMenuClose.bind(this)),y(this.onMenuClose.bind(this)),v(this.fileUploadSettings)}initTabs(e){this.menuStateStore.getState().preventNextDefaultActiveTab?this.resetPreventNextDefaultActiveTab():this.setDefaultActiveTabForTrigger(e)}setDefaultActiveTabForTrigger(e){const t=this.getAvailableTabs(e);this.menuStateStore.getState().setAvailableTabs(t),this.menuStateStore.getState().setActiveTab(t[0])}resetPreventNextDefaultActiveTab(){this.menuStateStore.getState().setPreventNextDefaultActiveTab(!1)}getAvailableTabs(e){const t=this.triggerKeyConfig.get(e);if(!(null==t?void 0:t.enabledTabs.length))throw new Error(`No tabs available for trigger character: ${e}`);return t.enabledTabs}getIsSearchFocused(e){var t;return(null===(t=this.triggerKeyConfig.get(e))||void 0===t?void 0:t.isSearchFocused)||!1}wrapInTheme(e){return this.themeType?u.createElement(s.q,{theme:this.getTheme(),dir:this.dir},e):e}getTheme(){return"dark"===this.themeType?o.C:r.o}entitiesPartiallyUpdated(e){(0,d._v)().debug(505280033,"Entities partially updated",e);const t=this.createEntityGroups(e.groups);this.suggestionEntitiesStore.getState().setSuggestionGroups(t,"PartiallyLoaded"),this.suggestionEntitiesStore.getState().setLastResolvedDataSourceName(e.lastResolvedDataSourceName)}entitiesUpdated(e){(0,d._v)().debug(505280032,"Entities updated");const t=this.createEntityGroups(e.groups);this.suggestionEntitiesStore.getState().setSuggestionGroups(t,"Complete"),this.suggestionEntitiesStore.getState().setLastResolvedDataSourceName(e.lastResolvedDataSourceName)}entitiesError(e){(0,d._v)().debug(505280031,"Entities error",e.error),this.suggestionEntitiesStore.getState().setSuggestionGroups([],"Error")}entityRequestDismissed(e){this.menuStateStore.getState().setIsMenuShown(!1),this.menuStateStore.getState().setAutoFocusSearchOnOpen(!1)}onEntitySelect(e){this.handleSelectedCiqEntity(e),this.entityRequestDismissed();(0,d._v)().debug(505280030,"Entity to be written in the text editor",e)}onMenuClose(){this.entityRequestDismissed();(0,d._v)().debug(505246791,"Menu closed")}subscribeToCommonEvents(){this.eventSource.subscribe("entitiesPartiallyUpdated",this.entitiesPartiallyUpdated.bind(this)),this.eventSource.subscribe("entitiesUpdated",this.entitiesUpdated.bind(this)),this.eventSource.subscribe("entitiesError",this.entitiesError.bind(this)),this.eventSource.subscribe("entitiesRequestDismissed",this.entityRequestDismissed.bind(this,!1)),this.eventSource.subscribe("entitiesRequested",this.entitiesRequested.bind(this))}unsubscribeFromCommonEvents(){this.eventSource.unsubscribe("entitiesPartiallyUpdated",this.entitiesPartiallyUpdated.bind(this)),this.eventSource.unsubscribe("entitiesUpdated",this.entitiesUpdated.bind(this)),this.eventSource.unsubscribe("entitiesError",this.entitiesError.bind(this)),this.eventSource.unsubscribe("entitiesRequestDismissed",this.entityRequestDismissed.bind(this,!1)),this.eventSource.unsubscribe("entitiesRequested",this.entitiesRequested.bind(this))}createEntityGroups(e){const t=[];for(const i of e)t.push(...i.entities);const i={groupType:"All",entities:t},n=e.map((({entityType:e,entities:t})=>({groupType:e,entities:t})));return n.push(i),n}dispose(){this.unsubscribeFromCommonEvents()}close(){this.onMenuClose()}getCIQState(){const e=this.menuStateStore.getState();return{isMenuShown:e.isMenuShown,activeTab:e.activeTab,searchOpened:e.searchOpened}}setClickOutIgnoredRefs(e){this.menuStateStore.getState().setClickOutIgnoredRefs(e)}}var p=i(494163),m=i(964549),f=i(296690),v=i(120733),y=i(296048),_=i(188418),I=i(891138);const C=({setRef:e})=>{const t=(0,v.E)("rect"),i=(0,v.E)("isMenuAtBottom"),n=t?{position:"absolute",left:t.left,top:i?t.top:t.bottom}:{};return u.createElement("div",{className:"ciq-suggestions-popover-anchor",style:n,ref:e})};var S=i(963804),b=i(780238),T=i(410565),E=i(804183),N=i(449183),w=i(557354),x=i(748340),L=i(188694),D=i(332688),A=i(258545),F=i(23603);const q=Object.values(A.U).concat(["moreButtonQuantityText"]),R=()=>{const e=(0,v.E)("activeTab"),t=(0,v.E)("setActiveTab"),i=(0,v.E)("availableTabs"),n=(0,v.E)("fileUploadSettings"),{conversationId:s,logicalId:o,additionalData:r}=(0,v.E)("requestEntitiesParams"),{clientCorrelationId:a,scopeInfo:l}=r||{},d=(0,F.B)("InlineSuggestionStrings",q);(0,D.zo)();const c={overflowButtonLabel:e=>L.$.format(d.moreButtonQuantityText,e)},g=u.useCallback(((e,{value:i})=>{const n=i;t(n),(0,D.ci)(n,s,o,a,null==l?void 0:l.entityType)}),[t,s,o,a,null==l?void 0:l.entityType]);return u.createElement(b.Y,null,u.createElement(T.T,{onTabSelect:g,selectedValue:e,overflowMenu:c},i.map((e=>u.createElement(E.T,{key:`ciq-tab-${e}`,"data-automation-id":`ciq-tab-${e}`,value:e},d[A.U[e]])))),u.createElement(N.T,null,u.createElement(x.q,null),n.onDeviceUploadRequested?u.createElement(w.h,{onButtonClick:()=>{var e;(0,D.vb)("localUploadButtonClicked",s,o,a,null==l?void 0:l.entityType),null===(e=n.onDeviceUploadRequested)||void 0===e||e.call(n)}}):void 0,n.onCloudUploadRequested?u.createElement(S.N,{onButtonClick:()=>{var e;(0,D.vb)("cloudUploadButtonClicked",s,o,a,null==l?void 0:l.entityType),null===(e=n.onCloudUploadRequested)||void 0===e||e.call(n)}}):void 0))};var P=i(547961),O=i(68852),k=i(260131),M=i(279009),z=i(262185);const j=({groundingMenuListboxProps:e})=>{const t=(0,v.E)("activeTab"),i=(0,y.b)("suggestionEntityGroup"),n=(0,y.b)("lastResolvedDataSourceName"),s=(0,y.b)("state"),{logicalId:o,query:r}=(0,v.E)("requestEntitiesParams");(0,D.FZ)(r.text.length);const a=(0,u.useMemo)((()=>{var e,n;return null!==(n=null===(e=i.find((({groupType:e})=>e===t)))||void 0===e?void 0:e.entities)&&void 0!==n?n:[]}),[i,t]);return(0,u.useEffect)((()=>{(0,z.rZ)(o,{lastDataSourceName:null!=n?n:"",state:s})}),[s,n,o]),"Loading"===s?u.createElement(M.a,{listBoxProps:e,ariaLabel:"Loading Content"}):"Error"===s?u.createElement(k.q,null):0===a.length?u.createElement(O.H,null):u.createElement(P.c,{items:a,listboxProps:e,ariaLabel:t,isPartiallyLoading:"PartiallyLoaded"===s})},W=(e,t,i)=>{if(!e)return Object.assign({target:i,align:"start",position:"below"},t?{offset:5}:{})};var B=i(280147),U=i(53192),H=i(185113);var V=i(552903);var G=i(89609),Q=i(590413);const K=(0,u.forwardRef)(((e,t)=>{const i=(0,v.E)("isMenuShown"),n=(0,v.E)("isFullWidth"),s=(0,v.E)("isMenuAtBottom"),o=(0,v.E)("onEntitySelect"),r=(0,v.E)("onMenuClose"),a=(0,v.E)("onClickedOutsideMenu"),l=(0,v.E)("activeTab"),d=(0,v.E)("clickOutIgnoredRefs"),c=(0,y.b)("suggestionEntityGroup"),{conversationId:g,logicalId:h,query:p,additionalData:m,triggerKey:f}=(0,v.E)("requestEntitiesParams"),{clientCorrelationId:S,scopeInfo:b}=m||{},{text:T}=p,[E,N]=u.useState(null),{positioningTargetRef:w,groundingMenuProps:x,groundingMenuListboxProps:L,controlSurfaceProps:A}=(0,_.F)({onOptionSelect:(e,t)=>{const i=((e,t)=>{for(const i of e){const e=i.entities.find((e=>e.id===t.optionValue));if(e)return e}})(c,t);if(!i)throw new Error(`Suggestion not found ${t}`);(0,D.TQ)(i,g,h,l,S,null==b?void 0:b.entityType,f,p.text.length),o(i)},positioning:W(n,s,E)});(0,u.useImperativeHandle)(t,(()=>({getControlSurfaceProps:()=>A}))),((e,t,i)=>{const{targetDocument:n}=(0,H.Y)();(0,B.W)({contains:U.s,element:n,refs:[e.ref,...t],callback:e=>{i(e)}})})(x,[w,...d],a),(e=>{const t=(0,u.useCallback)((t=>{if("Escape"===t.key)return e()}),[e]);(0,V.J)(t)})(r),(0,D.cu)("TypeAhead",T),((e,t)=>{const i=(0,v.E)("isMenuShown"),n=(0,v.E)("setIsMenuAtBottom"),s=(0,v.E)("rect");(0,u.useEffect)((()=>{const o=(0,Q.S9)(t);if(!o)return;const r=()=>{i&&e.current&&s&&o&&n(o.innerHeight-s.bottom<e.current.offsetHeight)};return o.addEventListener("resize",r),r(),()=>{o.removeEventListener("resize",r)}}),[i,s,e,n,t])})(x.ref,E);const F=(0,G.e$)({isFullWidth:n});return i?u.createElement(u.Fragment,null,u.createElement(C,{setRef:N}),u.createElement(I.n,Object.assign({},x,{style:F,"data-automation-id":"ciq-grounding-menu"}),u.createElement(R,null),u.createElement(j,{groundingMenuListboxProps:L}))):null}));var $=i(535912),J=i(786132);class Z extends h{constructor({targetCiqElement:e,targetEditorElement:t,editor:i,fullWidth:n,onItemSelected:s,getPeopleIconURL:o,locale:r,fileUploadSettings:a,triggerKeyConfig:l,dir:d,themeType:c,userInfo:u,anchorPadding:g={x:0,y:0}}){super({eventSource:i,onItemSelected:s,getPeopleIconURL:o,locale:r,fileUploadSettings:a,triggerKeyConfig:l,dir:d,themeType:c,userInfo:u}),this.CiqSearchSource="CiqSearch",this.getAnchorRect=e=>{const t=e.getBoundingClientRect();return t.x+=this.anchorPadding.x,t.y+=this.anchorPadding.y,t},this.editor=i;const{setIsFullWidth:h,isFullWidth:p,setOnSearchChange:m,setOnEntitySelect:f,setOnClickedOutsideMenu:v}=this.menuStateStore.getState();h(null!=n?n:p),m(this.onSearchChange.bind(this)),f(this.onEntitySelect.bind(this)),v(this.onClickedOutsideMenu.bind(this)),this.anchorPadding=g,this.targetCiqElement=e,this.targetEditorElement=t,this.root=this.createRoot(e),this.renderUi()}createRoot(e){const t=e.ownerDocument.createElement("div");return t.style.position="relative",t.setAttribute("data-automation-id","ciq-root"),e.prepend(t),t}init(){this.subscribeToCommonEvents()}renderUi(){n.render(u.createElement(v.Z,{store:this.menuStateStore},u.createElement(y.Q,{store:this.suggestionEntitiesStore},this.wrapInTheme(u.createElement(K,null)))),this.root)}onSearchChange(e){const t=this.menuStateStore.getState().requestEntitiesParams;this.editor.requestEntities({query:{start:t.query.start,text:e},conversationId:t.conversationId,logicalId:(0,$.D)(),targetId:t.targetId,triggerKey:t.triggerKey,additionalData:{source:this.CiqSearchSource}})}async entitiesRequested(e){var t;(0,d._v)().debug(505280029,"New entities requested");const{setRequestEntitiesParams:i}=this.menuStateStore.getState();i(e);const{setAvailableTabs:n}=this.menuStateStore.getState(),s=this.getAvailableTabs(e.triggerKey);n(s),(null===(t=e.additionalData)||void 0===t?void 0:t.source)!==this.CiqSearchSource?(await this.setupMenuShown(e,s),this.suggestionEntitiesStore.getState().setSuggestionGroups([],"Loading")):this.suggestionEntitiesStore.getState().setSuggestionGroups([],"Loading")}onClickedOutsideMenu(e){const{isMenuShown:t}=this.menuStateStore.getState();t&&!this.isClickOnQueryText(e)&&super.onMenuClose()}isClickOnQueryText(e){if(!this.menuRange)return!1;let t,i;if((0,J.C)(e,"MouseEvent"))t=e.clientX,i=e.clientY;else{if(!((0,J.C)(e,"TouchEvent")&&e.touches.length>0))return!1;t=e.touches[0].clientX,i=e.touches[0].clientY}const n=this.menuRange.getBoundingClientRect();return t>=n.x&&t<=n.x+n.width&&i>=n.y&&i<=n.y+n.height}async setupMenuShown(e,t){const{isMenuShown:i,setActiveTab:n,setIsMenuShown:s,setRect:o,setSearchOpened:r,setAutoFocusSearchOnOpen:a}=this.menuStateStore.getState();this.menuRange=await this.getRange(e);const l=this.getAnchorRect(this.menuRange),d=this.getIsSearchFocused(e.triggerKey);if(i){this.prevMenuAnchorRect&&(this.prevMenuAnchorRect.x!==l.x||this.prevMenuAnchorRect.y!==l.y)&&(s(!1),o(l),s(!0))}else this.menuStateStore.getState().preventNextDefaultActiveTab?this.resetPreventNextDefaultActiveTab():e.intent&&t.includes(e.intent.suggestionEntityType)?n(e.intent.suggestionEntityType):n(t[0]),o(l),r(!0),s(!0),d&&0===e.query.text.length&&a(!0);e.query.text&&r(!1),this.prevMenuAnchorRect=l}handleSelectedCiqEntity(e){this.onItemSelected(e,this.menuRange)}entityRequestDismissed(e=!0){super.entityRequestDismissed(),e&&this.editor.queryDismissed()}async getRange(e){if(!this.textNodeRangeBuilder){const e=new p.z,t=e=>new m._(e);this.textNodeRangeBuilder=new f.g(t,e)}const t=e.query.start,i=this.editor.getTileOffset(e.targetId||"TODO"),n=await this.textNodeRangeBuilder.getRangeOfNode(this.targetEditorElement,t+i,e.query.text.length+1);if(!n)throw new Error("Undefined range");return n}}},590294:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Precision"},"Consistent Written Forms":{"LocalizedName":"Konsekventa skriftformer","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Inkluderande språkbruk"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Skrivfel"},"Clarity":{"IsImplemented":true,"LocalizedName":"Klarhet"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"Omskrivning"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Felkorrigering"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"Ordval"},"Grammar":{"LocalizedName":"Grammatik","IsImplemented":true},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Formellt språk"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Interpunktion"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Skrivregler"},"Spelling":{"LocalizedName":"Stavning","IsImplemented":true},"Resume":{"LocalizedName":"Meritförteckning","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Känsliga geopolitiska referenser","IsImplemented":false}}')},590413:(e,t,i)=>{i.d(t,{Fy:()=>s,Hw:()=>n,S9:()=>o});const n=e=>{var t;return null!==(t=null==e?void 0:e.toString())&&void 0!==t?t:""},s=(e,t)=>e.length>0?e[0]:t,o=e=>null==e?void 0:e.ownerDocument.defaultView},590974:(e,t,i)=>{i.d(t,{l:()=>n});const n=(0,i(668952).f)("ITransportLogger")},592568:(e,t,i)=>{i.d(t,{FS:()=>s,U1:()=>n,Zp:()=>r});var n,s,o=i(668952);!function(e){e[e.ClientInitialized=0]="ClientInitialized"}(n||(n={})),function(e){e[e.WordDictionaryInit=0]="WordDictionaryInit"}(s||(s={}));const r=(0,o.f)("IRoamingDictionaryFeature")},592785:(e,t,i)=>{if(i.d(t,{R:()=>r}),0!=i.j)var n=i(941862);if(0!=i.j)var s=i(996054);const o=0!=i.j?["url","metadata","runtimeOptions"]:null;async function r({hostAppCiqConfig:e,session:t}){const i=new n.D;return o.every((e=>e in t))?await i.create(t):await i.attach(t),new s.z(i,e)}},596882:(e,t,i)=>{i.d(t,{d:()=>g,v:()=>u});var n=i(208520),s=i(966727),o=i(924083),r=i(687267),a=i(48644),l=i(468576),d=i(731857);const c=function(e){return t=>{var i,r;const{critique:a,data:l,element:c,squiggleKind:u,onCallOut:g,closeCallout:h,setInitializationProgress:p,showTooltip:m,closeTooltip:f,contextualCardTriggers:v}=t,{keyboard:y,mouse:_}=v,I=s.Bn.AutoCorrectSquiggle,C=t.squiggleRef||n.useRef(null),S=null!==(i=c.ownerDocument.defaultView)&&void 0!==i?i:window,b=n.useRef(0),[T,E]=n.useState(1-t.initializationProgress),N=n.useCallback((()=>t.isCaretOver||t.isMouseOver||t.isCalloutOpened),[t.isCaretOver,t.isMouseOver,t.isCalloutOpened]),w=n.useCallback((()=>N()||void 0!==T&&T>0?"ms-squiggle ms-squiggle-autocorrect-hl ":"ms-squiggle ms-squiggle-autocorrect"),[T,N]),[x,L]=n.useState(w());n.useEffect((()=>{L(w())}),[w]);const D=t.useSvgUnderline?s.fQ[I]:0,A=n.useCallback((e=>{var t;g(C.current,a,null!==(t=a.textInContext)&&void 0!==t?t:"","keyboard"===e,(()=>{}),c,u,(0,d.e)(l),D)}),[a,l,c,D,g,u,C]),F=n.useCallback((()=>{0!==b.current&&(E(void 0),L(w()),S.clearInterval(b.current),b.current=0)}),[w,S]),q=n.useCallback((()=>h(a.traceId)),[h,a.traceId]);n.useEffect((()=>{_.includes(o.v.Hover)?t.isMouseOver?A("mouse"):t.isCalloutOpened||h(a.traceId):(t.isMouseOver||t.isCaretOver)&&(F(),E(void 0),L(w()))}),[_,t.isMouseOver,t.isCalloutOpened,A,h,a.traceId,F,w,t.isCaretOver]);const R=t.isCaretOver&&!t.isCalloutOpened;n.useEffect((()=>{R?m(u,C.current,a,"keyboard"):f(a.traceId)}),[f,a,m,u,C,R]);const P=n.useCallback((()=>{E((e=>{let t;return!e||e<.01?(t=void 0,F()):t=e-.02,a.traceId&&p(a.traceId,1-(null!=t?t:0)),t}))}),[F,a.traceId,p]);if(n.useEffect((()=>(F(),b.current=S.setInterval(P,100),()=>{F(),h(a.traceId),f(a.traceId)})),[]),null===(r=t.autoCorrectionBroker)||void 0===r?void 0:r.getAutoCorrectionIsBeingApplied(t.critique))return null;const O=!_.includes(o.v.Hover)&&_.includes(o.v.MainButtonPressed)?()=>A("mouse"):void 0,k=_.includes(o.v.SecondaryButtonPressed)?()=>A("mouse"):()=>{};return e(Object.assign(Object.assign({},t),{patternName:I,className:x,squiggleRef:C,opacity:T,openCalloutPredicate:e=>y.some((t=>t(e))),onClick:O,onNonLeftClick:q,onKeyboardEvent:()=>A("keyboard"),onEscapePress:()=>t.closeTooltip(t.critique.traceId),onRightClickEvent:k}))}},u=n.memo(c(r.m),l.I),g=n.memo(c(a.G),l.P)},602764:(e,t,i)=>{if(i.d(t,{n:()=>g}),0!=i.j)var n=i(331408);if(0!=i.j)var s=i(797214);if(0!=i.j)var o=i(909113);if(0!=i.j)var r=i(329423);if(0!=i.j)var a=i(786132);if(0!=i.j)var l=i(537969);if(0!=i.j)var d=i(186438);if(0!=i.j)var c=i(1144);if(0!=i.j)var u=i(762815);class g{constructor(e,t,i,g,h,p,m,f,v,y,_,I,C){this._hostEmitters=e,this.tileContent=t,this.critiqueRangeBuilder=i,this.proofingDom=g,this.safeWindow=h,this._disableCritiqueHandler=p,this.logger=m,this.critiqueStore=f,this.applyCritiqueSuggestionHandler=v,this.applyFlagHandler=y,this.wordDictionary=_,this.editorSettingsManager=I,this._formElementAutoCorrectionCache=C,this.applyCritiqueSuggestion=async(e,t,i,s,r,a,l,c)=>{var u;await this.applySuggestion(e,t,{nodeId:i,offset:s.start,typeId:s.typeId,traceId:s.traceId,textInContext:s.textInContext},(async()=>{var i,l,c,u;(null===(i=s.textInContext)||void 0===i?void 0:i.includes("￼"))&&(s.start+=(s.textInContext.match(new RegExp("^￼+"))||[""])[0].length,s.length-=(s.textInContext.match(/￼/g)||[]).length,s.textInContext=s.textInContext.replace(/￼/g,""),r.text=r.text.replace(/￼/g,""));let g=!1;if(this.applyCritiqueSuggestionHandler&&this.critiqueRangeBuilder){const i=a||(null===(l=(await this.critiqueRangeBuilder.getCritiqueRanges([s],t))[0])||void 0===l?void 0:l.range);g=!!i&&!!this.applyCritiqueSuggestionHandler.onApplyCritiqueSuggestion(e,s,r,i)}const h=s.nodeId?this.proofingDom.findNode(s.nodeId):s.tileId?this.proofingDom.findNode(s.tileId.nodeId):null;if(h){if(!g){if(!(0,d.qB)(r)&&(0,d.ht)(s))this.tileContent.remove(h,t,s.start,s.length,!0,a);else{let{start:e,length:i}=s,l=r.text,d=a;if(s.textInContext&&s.typeId===n.L9.DoubleSpaceGrammar){const t=o.CC(s.textInContext,l),n=l.length-t.firstDiffRight;t.firstDiffLeft===n&&(e+=t.firstDiffLeft,i=1,l="",d=void 0)}this.tileContent.replace(h,t,e,i,l,d)}(0,d.MG)(s)&&(null===(u=this.wordDictionary)||void 0===u||u.addWordToIgnoreList(r.text))}}else null===(c=this.logger)||void 0===c||c.error(508146699,"Unable to find node while applying critique suggestion")})),!c||"autocorrection"!==l&&"personalized-autocorrection"!==l||null===(u=this._formElementAutoCorrectionCache)||void 0===u||u.removeForCritique(c,s.traceId||"")},this.applyFlagSuggestion=(e,t,i,n,s,o)=>this.applySuggestion(e,t,{nodeId:i,offset:n.start,typeId:n.typeId,traceId:n.traceId,textInContext:n.textInContext},(async()=>{var i,r,a;const l=o||!this.critiqueRangeBuilder?o:null===(i=(await this.critiqueRangeBuilder.getCritiqueRanges([n],t))[0])||void 0===i?void 0:i.range;l?this.applyFlagHandler?this.applyFlagHandler.onApplyFlag(e,n,s,l):null===(a=this.logger)||void 0===a||a.error(523633800,"Flag application failed due to no applyFlagHandler"):null===(r=this.logger)||void 0===r||r.error(523633799,"Unable to determine range for flag application")})),this.ignoreCritiqueOnce=(e,t,i,s)=>{var o;!!(null===(o=this.applyCritiqueSuggestionHandler)||void 0===o?void 0:o.onIgnoreCritiqueSuggestion(e,s))||this.callbackOnProofedElement({nodeId:i,offset:s.start,typeId:s.typeId,traceId:s.traceId,textInContext:s.textInContext},n.$w.IgnoreOnce)},this.ignoreFlagOnce=(e,t,i,s)=>{var o;!!(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onIgnoreFlag(e,s))||this.callbackOnProofedElement({nodeId:i,offset:s.start,typeId:s.typeId,traceId:s.traceId,textInContext:s.textInContext},n.$w.IgnoreOnce)},this.ignoreAllOfFlag=(e,t,i)=>{var s,o;const r=this.proofingDom.findParagraphNode(i.nodeId);if(!(0,c.l)(r))return void(null===(s=this.logger)||void 0===s||s.error(507574144,"Unable to find paragraph node while ignoring all flags"));!!(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onIgnoreAllOfFlag(e,i))||this.callbackOnProofedElement({nodeId:i.nodeId,offset:i.start,typeId:i.typeId,traceId:i.traceId,textInContext:i.textInContext},n.$w.IgnoreAll)},this.ignoreAllOfCritique=(e,t,i,n)=>{var o,a,l,u;if(!i)return;let g;g=(0,d.MG)(n)?n.suggestions[0].text:n.textInContext,g&&(null===(o=this.wordDictionary)||void 0===o||o.addWordToIgnoreList(g));const h=this.proofingDom.findParagraphNode(null!==(a=n.nodeId)&&void 0!==a?a:i);(0,c.l)(h)&&(null===(l=this.critiqueStore)||void 0===l||l.updateNode([{critique:(0,s._K)(n),critiqueDiffType:r.K.Delete}],h.parent.id,null!==(u=h.eventSeqId)&&void 0!==u?u:0))},this.disableCritiqueType=async(e,t,i,s)=>{var o,r;i&&(s.typeId&&await(null===(o=this.editorSettingsManager)||void 0===o?void 0:o.stopCheckingForCritiqueType(s.typeId)),this.callbackOnProofedElement({nodeId:i,offset:s.start,typeId:s.typeId,traceId:s.traceId,textInContext:s.textInContext},n.$w.DisableCritiqueType),await(null===(r=this._disableCritiqueHandler)||void 0===r?void 0:r.disableCritique(s)))},this.disableFlagType=(e,t,i,s)=>{var o;!!(null===(o=this.applyFlagHandler)||void 0===o?void 0:o.onDisableFlag(e,s))||this.callbackOnProofedElement({nodeId:i,offset:s.start,typeId:s.typeId,traceId:s.traceId,textInContext:s.textInContext},n.$w.DisableCritiqueType)},this.applySuggestion=async(e,t,i,s)=>{var o,r,l,d;const c=null!==(o=this.tileContent.getContainingElement(e))&&void 0!==o?o:t;if(!c)return void(null===(r=this.logger)||void 0===r||r.error(508146698,"Unable to find containing element"));const g=(0,u.m)(c),h=null!==(l=null==g?void 0:g.scrollTop)&&void 0!==l?l:0,p=null!==(d=null==g?void 0:g.scrollLeft)&&void 0!==d?d:0;await s(),this.callbackOnProofedElement(i,n.$w.ApplySuggestion);const m=(0,a.e)(c);this.safeWindow.requestAnimationFrame((()=>{g&&(g.scrollTop=h,g.scrollLeft=p)}),m)},this.callbackOnProofedElement=(e,t)=>{if(e.nodeId)for(const i of this._hostEmitters)i.emit(l.pD.hostModelCritiqueAction,{address:void 0,message:{critiqueInfo:e,actionType:t}})}}}},609062:(e,t,i)=>{if(i.d(t,{Bb:()=>r,Q0:()=>o,pf:()=>s}),0!=i.j)var n=i(418876);var s,o;function r(e){return e.deltaType===n.WI.AttributionUpdate&&void 0!==e.attributionData}!function(e){e.TileNode="TileNode",e.ParagraphNode="ParagraphNode"}(s||(s={})),function(e){e[e.Local=0]="Local",e[e.Code=1]="Code",e[e.Remote=2]="Remote"}(o||(o={}))},610904:(e,t,i)=>{i.d(t,{o:()=>r,v:()=>a});var n=i(379490),s=i(668952),o=i(229906);const r=(0,s.f)("ITileNodeDictionary");let a=class{};a=(0,n.__decorate)([(0,o._)()],a)},611103:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(668952).f)("ICritiqueFilters")},611256:(e,t,i)=>{if(i.d(t,{k:()=>s}),0!=i.j)var n=i(766535);function s(e){const t=[];return e.forEach((e=>{t.push({confidenceScore:o(e),critique:e})})),t.sort(((e,t)=>t.confidenceScore-e.confidenceScore)),t}function o(e){return e.typeId===n.L9.TopicSuggestion?function(e){let t=0;try{e.suggestions.forEach((e=>{const i=JSON.parse(e.metadataJSON||"{}");t=Math.max(i.annotationScore,t)}))}catch(e){}return t}(e):e.typeId===n.L9.CIQFlag_Topic?function(e){var t;let i=0;return null===(t=e.suggestionItems)||void 0===t||t.forEach((e=>{e.entities.forEach((e=>{i=Math.max(e.confidence,i)}))})),i}(e):0}},611441:(e,t,i)=>{i.d(t,{D:()=>h});var n=i(863307),s=i(46692),o=i(630501),r=i(56745),a=i(262185),l=i(535912),d=i(93469),c=i(168492),u=i(590413);function g(e,t,i){const n={query:(null==e?void 0:e.query)||{text:"",start:0},conversationId:(null==e?void 0:e.conversationId)||t||(0,l.D)(),logicalId:(null==e?void 0:e.logicalId)||(0,l.D)(),targetId:(null==e?void 0:e.targetId)||"",triggerKey:(null==e?void 0:e.triggerKey)||"",additionalData:(null==e?void 0:e.additionalData)||void 0,prefix:(null==e?void 0:e.prefix)||""};return i&&(n.intent=function(e,t){const i=(0,u.Fy)(t.getIntents(e.prefix));if(i&&i.score>=.9)return i;return}(n,i)),n}class h extends o.z{constructor(e){super(),this.params=e,this._disposed=!1,this._initialized=!1,this.dataAggregatorPromises=[],this._entitiesUpdatedHandlers={Complete:e=>this.publishEvent("entitiesUpdated",e),PartiallyLoaded:e=>this.publishEvent("entitiesPartiallyUpdated",e),Error:e=>this.publishEvent("entitiesError",{error:"Failed to get data"})}}get initialized(){return this._initialized}get disposed(){return this._disposed}get dataAggregator(){if(!this.params.services.dataAggregator)throw new Error("No DataAggregator provided");return this.params.services.dataAggregator}get ranker(){if(!this.params.services.ranker)throw new Error("No ranker provided");return this.params.services.ranker}get intentDetector(){return this.params.services.intentDetector}async init(){if(this._initialized)return;const e=(0,n._v)(),t=e.getNewActivity("CiqCoreInit",s.o.SamplingPolicy.Measure);try{this.dataAggregatorPromises=this.dataAggregator.init()}catch(t){throw e.error(505737362,"Data aggregator init error",t),new Error("Failed to initialize the data aggregator")}this.initEventListeners(),this._initialized=!0,t&&(t.success=!0,t.endNow())}async dispose(){if(!this._disposed){try{await this.dataAggregator.dispose()}catch(e){throw new Error("Failed to dispose the data aggregator")}this.disposeEventsListeners(),this._initialized=!1,this._disposed=!0}}triggerIntentDetection({intentText:e}){var t;const i=(0,l.D)();(0,n._v)().debug(505246864,"triggerIntentDetection called in CiqCore",{textStats:(0,d.ZX)(e),requestId:i}),null===(t=this.intentDetector)||void 0===t||t.invokeIntentDetectors({detectedIntents:[],text:e,requestId:i})}dismissEntitiesRequest(){this.currentQueryLogicalId=void 0,this.currentConversationId=void 0;(0,n._v)().debug(505737364,"dismissEntitiesRequest"),this.publishEvent("entitiesRequestDismissed")}async requestEntities(e){const t=g(e,this.currentConversationId,this.intentDetector);this.currentQueryLogicalId=t.logicalId,this.currentConversationId=t.conversationId;const i=(0,n._v)();i.debug(505737363,"Request entities",t),this.publishEvent("entitiesRequested",t),(0,r.td)(t);const o=i.getNewActivity("DataAggregatorPromisesResolving",s.o.SamplingPolicy.Measure),a=await(0,c.sG)(this.dataAggregatorPromises);if(o){o.success=!0,o.endNow();const e=a.filter((e=>"rejected"===e.status));for(const t of e)i.warn(505693786,"DataSource initialization failed",t.reason)}const l=this.dataAggregator.getSuggestionGroups(t);this.ranker.rankSuggestions(t,l)}initEventListeners(){this.ranker.subscribe("rankedSuggestions",this._onRankedSuggestions.bind(this))}disposeEventsListeners(){this.ranker.unsubscribe("rankedSuggestions",this._onRankedSuggestions.bind(this))}_onRankedSuggestions(e){const{queryId:t,status:i,suggestions:n,lastResolvedDataSourceName:s}=e;(0,a.Ep)(t,{lastDataSourceName:s,status:i}),t===this.currentQueryLogicalId&&this._entitiesUpdatedHandlers[i]({groups:n,lastResolvedDataSourceName:s})}}},613543:(e,t,i)=>{i.d(t,{y:()=>n});const n=(0,i(668952).f)("ISquiggleThemeStore")},615930:(e,t,i)=>{i.d(t,{Ze:()=>l,cg:()=>d,jh:()=>o,oA:()=>a,q4:()=>s,sh:()=>r});var n=i(668952);const s=(0,n.f)("TargetRenderElement"),o=(0,n.f)("TargetDocument"),r=(0,n.f)("TargetWindow"),a=(0,n.f)("TargetRenderElementFactory"),l=(0,n.f)("TargetDocumentFactory"),d=(0,n.f)("TargetWindowFactory")},619040:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"අක්ෂර වින්‍යාසය"}}')},622926:(e,t,i)=>{i.d(t,{j:()=>p});var n=i(379490),s=i(823325),o=i(537969),r=i(335009),a=i(538045),l=i(609062),d=i(401322),c=i(229906),u=i(66008),g=i(83010),h=i(427603);let p=class{constructor(e,t,i,n){this._hostEmitters=e,this._nodePoller=t,this._proofingDom=i,this._queryDetection=n,this.rehydrateTiles=e=>{const t=e.message;if(t.length>0)for(const e of t){const t=this._proofingDom.findTileNode(e);null==t||t.resetState()}else for(const e of this._proofingDom.tileNodes)e.resetState();this._nodePoller.pollNodes(s.G.NewData,this._proofingDom.tileNodes,l.Q0.Code,void 0,!0)}}async initialize(){for(const e of this._hostEmitters)e.on(o.pD.hostModelRehydrateTiles,this._handleRehydrate.bind(this))}shutDown(){}_handleRehydrate(e){this._queryDetection?this._queryDetection.handleAugloopReconnection((()=>{this.rehydrateTiles(e)})):this.rehydrateTiles(e)}};p=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.t)(o.zJ)),(0,n.__param)(1,(0,g.W)(r.G)),(0,n.__param)(2,(0,g.W)(a.w)),(0,n.__param)(3,(0,h.l)()),(0,n.__param)(3,(0,g.W)(d.J))],p)},623824:(e,t,i)=>{i.d(t,{h:()=>a,k:()=>r});var n=i(379490),s=i(668952),o=i(229906);const r=(0,s.f)("ITerminalNodeDictionary");let a=class{};a=(0,n.__decorate)([(0,o._)()],a)},625617:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":""},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":false,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Provjera pravopisa"},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},627223:(e,t,i)=>{i.d(t,{S:()=>n});const n=(0,i(668952).f)("IShadowElementsStore")},627282:(e,t,i)=>{i.d(t,{k:()=>g});var n=i(93469),s=i(515599),o=i(630501),r=i(863307),a=i(647879),l=i(112932);function d(e,t,i,n){var s;const o=Object.assign(Object.assign(Object.assign(Object.assign({},n),(e=>{const{suggestionGroups:t,sourceName:i,resultStatus:n}=e;return Object.assign(Object.assign({},(0,l.L)(t)),{sourceName:i,resultStatus:n})})(e)),(d=i)?{authStatus:d.authStatus,connectionStatus:d.connectionStatus}:{authStatus:"Authenticated",connectionStatus:"Connected"}),{errorMessage:null!==(s=null==i?void 0:i.message)&&void 0!==s?s:""});var d;(0,r._v)().logActivity("CiqResponseReceivedFromSource",void 0,(0,a.W)(...Object.entries(o),...Object.entries((0,l.L)(e.suggestionGroups))),{conversationId:t.conversationId,logicalId:t.logicalId,triggerKey:t.triggerKey,queryLength:t.query.text.length})}function c(e,t){if(e instanceof s.p){const i=e;d({suggestionGroups:[],sourceName:i.dataSource,resultStatus:i.errResultStatus},t,e)}}var u=i(262185);class g extends o.z{constructor(e,t){super(),this._currentState=void 0,this.enabledEntities=new Map,this.hostAppCiqConfig=e,this.rankerConfig=t;for(const e of this.hostAppCiqConfig.triggerConfigs){const t=new Map;for(const i of e.entityTypes)t.set(i.entityType,i.sources);this.enabledEntities.set((0,n.DH)(e.trigger),t)}}rankSuggestions(e,t){const{logicalId:i}=e,n=(0,r._v)();if(0!==t.length){this.disposeState(),this.setupState(e),this.currentState.pendingDataSourcesCount=t.length;for(const o of t)o.then((t=>{d(t,e),(0,u.MO)(i,{lastDataSourceName:t.sourceName,suggestions:t.suggestionGroups}),this.currentState.logicalId===i&&(this.currentState.currentDataSourceResponses.push(t),this.currentState.pendingDataSourcesCount--,this.onDataSourceResolved(e,t))})).catch((t=>{if(n.error(505559134,"Error while fetching suggestions",t),c(t,e),this.currentState.logicalId!==i)return;let o="";t instanceof s.p&&(o=t.dataSource,this.currentState.failedSources.push(o)),this.currentState.pendingDataSourcesCount--,this.onDataSourceRejected(e,o)}))}else n.logDiagnostics("No data sources provided for ranking suggestions, logicalId",{logicalId:i})}publishRankingEvent(e,t,i,n){const s={queryId:e,status:t,suggestions:n,lastResolvedDataSourceName:i};(0,r._v)().logDiagnostics("Publishing ranked suggestions",{queryId:e,status:s.status}),this.publishEvent("rankedSuggestions",s)}get currentState(){if(!this._currentState)throw new Error("Unable to get ranker state");return this._currentState}setupState(e){this._currentState=this.createInitialState(e)}disposeState(){this._currentState=void 0}}},627736:(e,t,i)=>{var n;i.d(t,{k:()=>n}),function(e){e[e.ContextualCard=0]="ContextualCard"}(n||(n={}))},629139:(e,t,i)=>{i.d(t,{a:()=>o});var n=i(379490),s=i(229906);let o=class{findBeginBoundary(e,t,i){const n=e.lastIndexOf("\n",t-1);return-1===n||n<=i?i:n+1}findEndBoundary(e,t,i){const n=e.indexOf("\n",t+1);return-1===n||n>i?-1:n+1}splitInUnits(e){const t=[];let i=-1;do{i=e.indexOf("\n",i+1),-1!==i&&t.push(i+1)}while(-1!==i);return t}};o=(0,n.__decorate)([(0,s._)()],o)},630469:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Rašyba","IsImplemented":true}}')},630501:(e,t,i)=>{i.d(t,{z:()=>n});class n{constructor(){this.listeners={}}subscribe(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n.push(t),this.listeners[e]=n}unsubscribe(e,t){var i;let n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n=n.filter((e=>e!==t)),this.listeners[e]=n}publishEvent(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];for(const e of n)try{e(t)}catch(e){}}}},632153:(e,t,i)=>{i.d(t,{t:()=>g});var n=i(379490),s=i(753031),o=i(46692),r=i(383714),a=i(229906),l=i(83010),d=i(838641),c=i(439550),u=i(245645);let g=class extends u.b{constructor(e,t){super(e),this._logger=t}async readOrInitialize(e){try{const t=await this.readStoredSetting(e);if(t){if(t.value){const i=JSON.parse(t.value);return t.manualOverride&&void 0!==i?i:(e.lastValueFromStorage=i,void 0!==i?i:e.defaultValue)}}else try{return e.shouldNotWriteDefaultValue||await this.writeSetting(e.name,e.defaultValue),e.defaultValue}catch(e){this._logger.logEvent(521479644,d.s.SettingInitializeError,s.q.Error,void 0,o.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}catch(e){this._logger.logEvent(521479643,d.s.SettingReadError,s.q.Error,void 0,o.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return void 0!==e.lastValueFromStorage?e.lastValueFromStorage:e.defaultValue}async readLastUpdatedTimestamp(e){try{const t=await this.readStoredSetting(e);if(t)return t.lastUpdated}catch(e){this._logger.logEvent(521479642,d.s.SettingReadError,s.q.Error,void 0,o.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async readStoredSetting(e){const t=await this._extensionStorage.get(e.name);if(t[e.name]){return JSON.parse(t[e.name])}}};g=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(c.D)),(0,n.__param)(1,(0,l.W)(r.g))],g)},632974:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"简明性","IsImplemented":true},"Consistent Written Forms":{"LocalizedName":"异体词统一","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"包容性语言","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"笔误"},"Clarity":{"IsImplemented":true,"LocalizedName":"明晰性"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"改写"},"Error Corrections":{"LocalizedName":"纠错","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"词汇选择"},"Grammar":{"IsImplemented":true,"LocalizedName":"语法"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"正式语体"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"标点规范","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"LocalizedName":"书写规范","IsImplemented":false},"Spelling":{"IsImplemented":false,"LocalizedName":"拼写检查"},"Resume":{"IsImplemented":false,"LocalizedName":"简历"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"敏感地缘政治参考"}}')},636234:(e,t,i)=>{i.d(t,{v:()=>l});var n=i(379490),s=i(420821),o=i(781729),r=i(229906),a=i(83010);let l=class{constructor(e){this._wordDictionary=e}filter(e){return!!e.textInContext&&(e.typeId===s.L9.CIQFlag_DateEntityRecognition||e.typeId===s.L9.CIQFlag_PersonEntityRecognition||e.typeId===s.L9.CIQFlag_Location||e.typeId===s.L9.CIQFlag_Time||e.typeId===s.L9.CIQFlag_LocalBusiness||e.typeId===s.L9.CIQFlag_TaskRecognition||e.typeId===s.L9.CIQFlag_Topic||e.typeId===s.L9.CIQFlag_SatoriEntityRecognition||e.typeId===s.L9.CIQFlag_File||!this._wordDictionary.isWordIgnored(e.textInContext)&&!e.wasAddedToDictionaryInCurrentSession)}};l=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.s))],l)},636734:(e,t,i)=>{i.d(t,{u:()=>n});const n=(0,i(668952).f)("IOaMetric")},637224:(e,t,i)=>{let n,s;async function o(){try{const e=await Promise.resolve().then(i.bind(i,419728));n=e.makeObservable,s=e.makeAutoObservable}catch(e){}}function r(e,t,i){return n?n(e,t,i):e}i.d(t,{Gn:()=>r,iJ:()=>o})},638590:(e,t,i)=>{if(i.d(t,{Q:()=>l}),0!=i.j)var n=i(341755);if(0!=i.j)var s=i(303043);if(0!=i.j)var o=i(772185);if(0!=i.j)var r=i(512578);if(0!=i.j)var a=i(251439);class l{constructor(){this.imports=[o.N,r.h]}get uniqueId(){return(0,a.z)(507918216)}configureRootServices(e){e.bind(n.i).toValue(s.b)}}},639007:(e,t,i)=>{i.d(t,{W:()=>He});var n=i(379490),s=i(524812),o=i(938496),r=i(627736),a=i(564333),l=i(343154),d=i(576516),c=i(299501),u=i(990886),g=i(537969),h=i(122107),p=i(823325),m=i(323283),f=i(461300),v=i(213983),y=i(392632),_=i(852748),I=i(756857),C=i(118673),S=i(184226),b=i(615930),T=i(937126),E=i(465701),N=i(728671),w=i(647879),x=i(829088),L=i(163573),D=i(671303),A=i(877931),F=i(821003),q=i(494888),R=i(150099),P=i(636734),O=i(1144),k=i(340064),M=i(797386),z=i(538045),j=i(157698),W=i(104072),B=i(281795),U=i(166137),H=i(347601),V=i(111791),G=i(700509),Q=i(418876),K=i(229906),$=i(83010),J=i(427603),Z=i(66008),Y=i(276646),X=i(429712),ee=i(551967),te=i(77127),ie=i(282597),ne=i(760963),se=i(195305),oe=i(175602),re=i(419728),ae=i(225918);class le{getPluginCalloutMaxHeight(e,t,i){var n;const s=null!==(n=e.y)&&void 0!==n?n:e.top;if(s)return Math.max(t.innerHeight-s,s)-20}getCalloutDirection(e,t,i,n){return e?ae.A.bottomRightEdge:ae.A.bottomLeftEdge}}var de=i(383291),ce=i(692551),ue=i(243879),ge=i(474324),he=i(526174),pe=i(537622);class me{constructor(e,t,i){this._services=e,this._calloutState=t,this.wrapInClearingSearch=i,this._searchBoxQueryUpdated=!1,this._localizer=e.localizer,this._oaLogger=e.oaLogger,this._hostEmitter=e.hostEmitter,this._proofingDom=e.proofingDom,this._oaResultStore=e.oaResultStore,this._queryDetection=e.queryDetection}buildExpandedEccSearchBarConfig(e){return{enableExpandedECCSearchBar:e,onSearchChange:(e="")=>{var t,i;const n=this._calloutState.menuCurrentlyOpen;if(!(null==n?void 0:n.expandedEccSearchBarConfig))return;const s=this._proofingDom.findParagraphNode(n.tileId);if(!(0,O.l)(s))return;const o=n.triggerCharacter,r=o+e,a=e.length+(null!==(t=null==o?void 0:o.length)&&void 0!==t?t:0);null!==(i=this.lastComposingBoxQuery)&&void 0!==i||(this.lastComposingBoxQuery=this._calloutState.queryString),this._calloutState.setSearchBoxQueryString(e),(0,he.A)(this._services,o,r,{start:0,length:a,prefix:o},s,this._queryDetection.getCurrentScope()),this._oaLogger.logActivity(Y.h8,void 0,this.getDefaultLogDataForMenu())},onSearchClear:()=>{this._calloutState.setSearchBoxQueryString(""),this.wrapInClearingSearch((()=>this.removeComposingBoxQuery(!0)))}}}initShowMoreEntitiesParagraph(e,t,i){const n=this._calloutState.menuCurrentlyOpen;if(!n)return;const s=this.createSearchBoxTextTile(n);return t&&(this._previouslySpecifiedItemsToDisplay=n.specifiedItemsToDisplay,n.specifiedItemsToDisplay=void 0),this._oaResultStore.updateLoadingStatus(!0,!0),(0,he.A)(this._services,n.triggerCharacter,i,{start:0,length:i.length,prefix:""},s,e?{entityType:e}:void 0),s}buildShowMoreEntitiesConfig(e,t,i,n){var o,r;if(null===(o=this._services.hostSettings.oaSettings)||void 0===o?void 0:o.disableFlagShowMoreEntities)return;const a=(0,ge.e)(e.typeId);if(a===s.z4.File||a===s.z4.Person){const e=a===s.z4.File?d.c.File:d.c.People,o=a===s.z4.File?this._localizer.getMessage("ebx_ECCSearchFileButtonLabel"):this._localizer.getMessage("ebx_ECCSearchPeopleButtonLabel");return Object.assign(Object.assign({},null===(r=this._services.hostSettings.serviceSettings)||void 0===r?void 0:r.showMoreEntitiesSettings),{isShowMoreEntitiesEnabled:!0,showMoreEntitiesButtonLabel:o,searchBoxPlaceHolder:o,onSearchChange:(t="")=>{this.onSearchBoxQueryChange(t,e)},onClickShowMoreEntities:()=>{const t=this._calloutState.searchBoxQueryString;this.initShowMoreEntitiesParagraph(e,!0,t)?this._oaLogger.logActivity(Y.tb,void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(Y.iI,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},onCloseShowMoreEntities:()=>{const e=this._calloutState.menuCurrentlyOpen;e&&(this._previouslySpecifiedItemsToDisplay?(e.specifiedItemsToDisplay=this._previouslySpecifiedItemsToDisplay,this._oaResultStore.updateResults(e.specifiedItemsToDisplay,n.id,0===e.specifiedItemsToDisplay.length?c.i.NoResults:c.i.Success,void 0,void 0,0===e.specifiedItemsToDisplay.length?{NoResults:1}:{Success:1})):(e.specifiedItemsToDisplay=void 0,this._oaResultStore.updateLoadingStatus(!0,!0),(0,he.A)(this._services,e.triggerCharacter,t,i,n,void 0)),this.removeSearchBoxTextTile(e)),this._oaLogger.logActivity(Y.mj,void 0,this.getDefaultLogDataForMenu())},onSearchClear:()=>{this.initShowMoreEntitiesParagraph(e,!1,"")?this._oaLogger.logActivity(Y.N2,void 0,this.getDefaultLogDataForMenu()):this._oaLogger.logActivity(Y.iI,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu())},entityType:e})}}getIsSearchBarAvailable(){const e=this._calloutState.menuCurrentlyOpen;return(null==e?void 0:e.enableExpandedECCSearchBar)&&this._calloutState.searchBoxQueryString.length>0||this._searchBoxQueryUpdated}onSearchBoxQueryChange(e,t){var i;this._searchBoxQueryUpdated=!0,this._calloutState.setSearchBoxQueryString(e),null!==(i=this.lastComposingBoxQuery)&&void 0!==i||(this.lastComposingBoxQuery=this._calloutState.queryString);const n=this._calloutState.menuCurrentlyOpen;if(!(null==n?void 0:n.searchBoxGeneratedParagraphId)&&!this.initShowMoreEntitiesParagraph(t,!0,e))return void this._oaLogger.logActivity(Y.iI,{error:"Could not create paragraph node for search bar"},this.getDefaultLogDataForMenu());const s=(null==n?void 0:n.searchBoxGeneratedParagraphId)?this._proofingDom.findParagraphNode(n.searchBoxGeneratedParagraphId):void 0;s?(this._oaResultStore.updateLoadingStatus(!0,!0),(0,he.A)(this._services,null==n?void 0:n.triggerCharacter,e,{start:0,length:e.length,prefix:""},s,t?{entityType:t}:void 0,!0),this._oaLogger.logActivity(Y.xe,void 0,this.getDefaultLogDataForMenu())):this._oaLogger.logActivity(Y.iI,{error:"Could not find paragraph node for search bar"},this.getDefaultLogDataForMenu())}menuDismissed(e){this.removeSearchBoxTextTile(e),this._searchBoxQueryUpdated=!1,this.lastComposingBoxQuery=void 0}removeSearchBoxTextTile(e){this._previouslySpecifiedItemsToDisplay=void 0,e.searchBoxGeneratedParagraphId&&(this._hostEmitter.emit(g.pD.hostModelTextTile,{address:void 0,message:{messageType:p.G.RemoveData,data:{tileId:e.searchBoxGeneratedParagraphId,tileVersion:0,changeType:N.Q0.Code,isTextNode:!0,tile:new de.Cg({content:""})}}}),e.searchBoxGeneratedParagraphId=void 0)}async removeComposingBoxQuery(e){var t,i,n;try{const s=this._calloutState.menuCurrentlyOpen;if(!s)return;const o=this._proofingDom.findParagraphNode(s.tileId);if(!(0,O.l)(o))return;const r=this._calloutState.triggerMethod!==ue.P.AttachFile&&this._calloutState.triggerMethod!==ue.P.Fre,a=r?1:null!==(i=null===(t=s.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==i?i:1;if(s.queryRange.length===a&&this._calloutState.triggerMethod!==ue.P.AttachFile)return;const l=o.element.offset+s.initialQueryStartPosition;let d=s.queryRange.length;if(r&&(d=(null!==(n=this.lastComposingBoxQuery)&&void 0!==n?n:this._calloutState.queryString).length+1),r&&d-a===0)return;this._calloutState.triggerMethod===ue.P.AttachFile?(this._queryDetection.setCurrentQueryRange(s.tileId,{start:s.queryRange.start,length:1,prefix:""},!0,this._queryDetection.getCurrentScope()),await this._services.tileContent.replace(o.parent,void 0,l,d," ").then((()=>{var e,t,i,n,s,o,r,a;const l=null===(n=null===(i=null===(t=(e=this._services).targetDocumentFactory)||void 0===t?void 0:t.call(e))||void 0===i?void 0:i.deref())||void 0===n?void 0:n.querySelectorAll(".ms-ecc-callout input[type=search]")[0];l&&(l.setAttribute("placeholder",this._localizer.getMessage("expandedInlineSuggestionsSearchBarPlaceholder")),null===(a=null===(r=null===(o=(s=this._services).targetWindowFactory)||void 0===o?void 0:o.call(s))||void 0===r?void 0:r.deref())||void 0===a||a.requestAnimationFrame((()=>{l.focus()})))}))):await this._services.tileContent.remove(o.parent,void 0,l+a,d-a).then((()=>{var t,i,n,s,o,r,a,l;if(!e)return;this.lastComposingBoxQuery=void 0,this._calloutState.clearQueryString(!0);const d=null===(s=null===(n=null===(i=(t=this._services).targetDocumentFactory)||void 0===i?void 0:i.call(t))||void 0===n?void 0:n.deref())||void 0===s?void 0:s.querySelectorAll(".ms-ecc-callout input[type=search]")[0];d&&(d.setAttribute("placeholder",this._localizer.getMessage("expandedInlineSuggestionsSearchBarPlaceholder")),null===(l=null===(a=null===(r=(o=this._services).targetWindowFactory)||void 0===r?void 0:r.call(o))||void 0===a?void 0:a.deref())||void 0===l||l.requestAnimationFrame((()=>{d.focus()})))})).finally((()=>{var t;if(!e)return;const i=s.triggerCharacter,n=s.tileId;if(!n)return;const o=this._proofingDom.findParagraphNode(n);o&&(0,he.A)(this._services,i,i+"",{start:0,length:null!==(t=null==i?void 0:i.length)&&void 0!==t?t:0,prefix:i},o,this._queryDetection.getCurrentScope())}))}finally{this.lastComposingBoxQuery=void 0}}getDefaultLogDataForMenu(e){const t=null!=e?e:this._calloutState.menuCurrentlyOpen;return t?(0,pe.G)(t,this._services):[]}createSearchBoxTextTile(e){this.removeSearchBoxTextTile(e);const t=this.generateNewParagraphNode();return e.searchBoxGeneratedParagraphId=t.id,t}generateNewParagraphNode(){const e=new O.f(new ce.L,this._proofingDom,{offset:0,span:0});return this._hostEmitter.emit(g.pD.hostModelTextTile,{address:void 0,message:{messageType:p.G.NewData,data:{tileId:e.id,tileVersion:e.eventSeqId,changeType:N.Q0.Local,isTextNode:!0,tile:new de.Cg({content:""})}}}),e}}const fe=(0,i(668952).f)("IDefaultInlineSuggestionItems");var ve=i(354339),ye=i(648336),_e=i(657338),Ie=i(630501),Ce=i(687458),Se=i(2111),be=i(696767),Te=i(93659);function Ee(e,t,i){const n=null==t?void 0:t.getComponentActiveTheme(i?te.yF.expandedInlineSuggestionComponentName:te.yF.inlineSuggestionComponentName);let s;return e&&(s=JSON.parse(JSON.stringify(e))),s=Ne(s,n),s}function Ne(e,t){if(!e)return t;if(t)for(const i in t){const n=i;"object"==typeof t[n]?e[n]?Ne(e[n],t[n]):e[n]=t[n]:e[n]||(e[n]=t[n])}return e}class we extends Ie.z{constructor(e,t,i,n){super(),this._inlineSuggestionsCalloutPlacement=t,this._inlineSuggestionsCalloutSizeAndDirectionUtils=i,this.callbackMethods=n,this.keyboardHandlerTarget=new Ce.E,this.queryString="",this.searchBoxQueryString="",this.isError=!1,this.isLoading=!0,this.resultReset=!1,this.hasTargetLocationBeenCalculated=!1,this.fluentV9Theme=void 0,this._suggestions=void 0,this._preloadedSuggestions=void 0,this._triggeringMethod=void 0,this.overrideTargetLocation=void 0,this.menuParentElement=void 0,this.setPreloadedSuggestions=e=>{this._preloadedSuggestions=e,this.isLoading=0===e.length,this.publishUpdateEvent()},this.clearPreloadedSuggestions=()=>{var e;(null===(e=this._preloadedSuggestions)||void 0===e?void 0:e.length)&&(this._preloadedSuggestions=[],this.publishUpdateEvent())},this.setSearchBoxQueryString=e=>{this.searchBoxQueryString=e,this.publishUpdateEvent()},this.inlineSuggestionsStrings=(0,be.$)().getStringsFor("InlineSuggestionStrings"),this.calloutStrings=(0,be.$)().getStringsFor("OnCanvasCalloutStrings"),this.getLocale=()=>this._hostSettings.defaultLocale,this.isFlightEnabled=this.callbackMethods.isFlightEnabled,this.onFeedbackButtonClicked=this.callbackMethods.onFeedbackButtonClicked,this.onFirstRender=this.callbackMethods.onFirstRender,this.onProcessedResults=this.callbackMethods.onProcessedResults,this.onRenderResults=this.callbackMethods.onRenderResults,this.onAction=this.callbackMethods.onAction,this.onFooterAction=this.callbackMethods.onFooterAction,this.onDismissed=this.callbackMethods.onDismissed,this.onPreventDismissOnEvent=this.callbackMethods.onPreventDismissOnEvent,this.onRestoreFocus=this.callbackMethods.onRestoreFocus,this.onSearchBoxQueryChange=this.callbackMethods.onSearchBoxQueryChange,this.onUserInteraction=this.callbackMethods.onUserInteraction,this.onGroupSelected=this.callbackMethods.onGroupSelected,this.onItemSelected=this.callbackMethods.onItemSelected,this.removeComposingBoxQuery=this.callbackMethods.removeComposingBoxQuery,this.handleKeyDown=this.callbackMethods.handleKeyDown,this.getQueryRangeBoundingClientRect=this.callbackMethods.getQueryRangeBoundingClientRect,this.handleEccUploadMenuEvent=this.callbackMethods.handleEccUploadMenuEvent,this.directionalHintCallback=(e,t,i,n)=>this._inlineSuggestionsCalloutSizeAndDirectionUtils.getCalloutDirection(n,e,t,i),this.maxHeightCallback=(e,t,i,n)=>{let s=this._inlineSuggestionsCalloutSizeAndDirectionUtils.getPluginCalloutMaxHeight(e,t,i);return(null==n?void 0:n.maxHeight)&&(s=Math.min(n.maxHeight,null!=s?s:Number.MAX_SAFE_INTEGER)),s},this._queryDetection=e.queryDetection,this._hostSettings=e.hostSettings,this._languageScriptDirectionDetector=e.languageScriptDirectionDetector,this._themeStore=e.themeStore,this._targetWindowFactory=e.targetWindowFactory,this._proofingDom=e.proofingDom,this._oaLogger=e.oaLogger}getCalloutState(){var e,t,i;if(this.menuCurrentlyOpen)return{calloutProps:this,targetLocation:this.hasTargetLocationBeenCalculated?this.menuCurrentlyOpen.targetLocation:void 0,targetWindow:null!==(t=null===(e=this._targetWindowFactory)||void 0===e?void 0:e.call(this))&&void 0!==t?t:new x.O(window),currentThemeType:null===(i=this._themeStore)||void 0===i?void 0:i.currentTheme,fluentV9Theme:this.fluentV9Theme,directionalHintCallback:(e,t,i)=>this.directionalHintCallback(e,t,i,this.isRtl),maxHeightCallback:(e,t)=>{var i;return this.maxHeightCallback(e,t,this.queryChar,(0,re.toJS)(null===(i=this.styles)||void 0===i?void 0:i.containerStyles))}}}updateCurrentMenu(e,t,i){const n=this.menuCurrentlyOpen,s=!n&&e,o=n&&!e;this.menuCurrentlyOpen=e,this.overrideTargetLocation=t,this.fluentV9Theme=null==e?void 0:e.fluentV9Theme,this.isLoading=!0,this.isError=!1,this.resultReset=!0,this._suggestions=[],this.queryString=null!=i?i:"",this.searchBoxQueryString="",this.menuParentElement=o?void 0:this.callbackMethods.menuParentElement,s?(this.hasTargetLocationBeenCalculated=!1,this.publishEvent("menuUpdated",{messageType:p.G.NewData,data:{tileId:e.tileId,queryRange:e.queryRange}})):o?(this.hasTargetLocationBeenCalculated=!1,this._triggeringMethod=void 0,this._queryDetection.removeDetectedQuery(),this.publishEvent("menuUpdated",{messageType:p.G.RemoveData,data:{tileId:n.tileId,queryRange:n.queryRange}})):this.publishUpdateEvent()}publishUpdateEvent(){this.menuCurrentlyOpen&&this.publishEvent("menuUpdated",{messageType:p.G.ChangeData,data:{tileId:this.menuCurrentlyOpen.tileId,queryRange:this.menuCurrentlyOpen.queryRange}})}async calculateTargetLocationAndShow(){if(!this.menuCurrentlyOpen)return;this.menuParentElement=this.callbackMethods.menuParentElement;const e=this._queryDetection.getCurrentQueryLogicalId();let t=this.overrideTargetLocation;if(!t){const i=this._proofingDom.findParagraphNode(this.menuCurrentlyOpen.tileId);if(!(0,O.l)(i))return void this._oaLogger.logDiagnostics("Attempted to render ECC, but no valid parent HTML element could be found");const n=await this._inlineSuggestionsCalloutPlacement.getTargetLocationOfECC(i,this);if(!n)return;if(this._queryDetection.getCurrentQueryLogicalId()!==e)return;t=n}"x"in t&&"InlineSuggestionsResultsFlagMenuType"===this.menuCurrentlyOpen.menuType.menuType&&(t.x=t.x-11);const i=!this.hasTargetLocationBeenCalculated||!function(e,t){if((0,Te.Pe)(e)&&(0,Te.Pe)(t))return e.x===t.x&&e.y===t.y;if((0,Te.K2)(e)&&(0,Te.K2)(t))return e.left===t.left&&e.top===t.top&&e.width===t.width&&e.height===t.height;return!1}(this.menuCurrentlyOpen.targetLocation,t);this.menuCurrentlyOpen.targetLocation=t,this.hasTargetLocationBeenCalculated=!0,i&&this.publishUpdateEvent()}setIsLoading(){this.isLoading=!0,this._suggestions=[],this.publishUpdateEvent()}setHadUnexpectedError(){this.isLoading=!1,this.isError=!0,this._suggestions=[],this.publishUpdateEvent()}setHasSuggestions(e,t,i){this.isLoading=!1,this.isError=!1,this.resultReset=t,this._suggestions=e,this.queryString=i,this.publishUpdateEvent()}setQueryString(e){this.queryString!==e&&(this.queryString=e,this.publishUpdateEvent())}setExplicitLoadingState(e,t){var i;const n=this.isLoading!==e||this.resultReset!==t||this.isError||(null===(i=this._suggestions)||void 0===i?void 0:i.length);this.isLoading=e,this.isError=!1,this.resultReset=t,this._suggestions=[],n&&this.publishUpdateEvent()}clearQueryString(e){let t=""!==this.queryString;this.queryString="",e&&(t=t||""!==this.searchBoxQueryString,this.searchBoxQueryString=""),t&&this.publishUpdateEvent()}setTriggerMethod(e){this._triggeringMethod=e}get preloadedSuggestions(){var e;return null!==(e=this._preloadedSuggestions)&&void 0!==e?e:[]}get currentScope(){return this._queryDetection.getCurrentScope()}get menuType(){var e,t;return null!==(t=null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.menuType)&&void 0!==t?t:{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",actions:[]}}get theme(){var e,t,i;return Ee(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.theme,this._themeStore,null!==(i=null===(t=this.menuCurrentlyOpen)||void 0===t?void 0:t.enableExpandedECC)&&void 0!==i&&i)}get style(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.style}get styles(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.styles}get oaSettings(){return this._hostSettings.oaSettings}get accessibilitySettings(){return this._hostSettings}get enableScopedHeader(){var e,t,i,n;return(void 0===(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.enableScopedHeader)||this.menuCurrentlyOpen.enableScopedHeader)&&"InlineSuggestionsResultsUserInitiatedMenuType"===(null===(t=this.menuCurrentlyOpen)||void 0===t?void 0:t.menuType.menuType)&&!0===(null===(n=null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.scopesConfig)||void 0===n?void 0:n.enabled)}get unsupportedEntities(){return this._queryDetection.getUnsupportedEntities()}get queryChar(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.triggerCharacter}get showMoreEntitiesConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.showMoreEntitiesConfig}get browseThisComputerConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.browseThisComputerConfig}get appGptConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.appGptConfig}get isFeedbackEnabled(){return!0===this._hostSettings.isFeedbackEnabledForEcc}get isFeedbackButtonEnabled(){var e,t;return!0===(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.isFeedbackButtonEnabled)}get enableExpandedECC(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.enableExpandedECC}get isDividerShown(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.isDividerShown}get isRtl(){var e,t;return null!==(t=null===(e=this._languageScriptDirectionDetector())||void 0===e?void 0:e.isRtl())&&void 0!==t&&t}get expandedEccSearchBarConfig(){var e;return null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.expandedEccSearchBarConfig}get fluentTheme(){var e;return null===(e=this._themeStore)||void 0===e?void 0:e.getExpandedEccFluentTheme()}get triggerMethod(){return this._triggeringMethod}get suggestions(){var e,t,i;if(!this.resultReset&&(null===(e=this._preloadedSuggestions)||void 0===e?void 0:e.length)&&(void 0===this.currentScope||this._preloadedSuggestions.some((e=>{var t;return e.entityType===(null===(t=this.currentScope)||void 0===t?void 0:t.entityType)})))){const e=this._preloadedSuggestions;return[...e,...(null!==(t=this._suggestions)&&void 0!==t?t:[]).filter((t=>!e.some((e=>e.entityType===t.entityType))))]}return null!==(i=this._suggestions)&&void 0!==i?i:[]}get noSuggestionsHeaderInfo(){var e;if(!this.isLoading&&0===this.suggestions.length){if(this.currentScope)return{title:(0,Se.X)(this.currentScope.entityType),isScoped:!0,isScopingEnabled:!0,suggestions:[]};if(null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.noSuggestionsHeaderInfo)return Object.assign({},this.menuCurrentlyOpen.noSuggestionsHeaderInfo)}}get expandedECCHeader(){var e;const t=(0,be.$)().getStringsFor("InlineSuggestionStrings"),i=null===(e=this.menuCurrentlyOpen)||void 0===e?void 0:e.supportedEntityTypes;if(!this.enableExpandedECC||!i)return[{type:d.c.Scope,title:t("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}];const n=i.map((e=>({type:d.c.Scope,title:(0,Se.X)(e),iconName:e,scopeInfo:{entityType:e},isSelected:1===i.length,id:e})));return i.length>1&&n.unshift({type:d.c.Scope,title:t("allEntityTypeLabel"),iconName:"File",scopeInfo:{entityType:""},id:"allItems"}),n}}var xe=i(712551),Le=i(331408);function De(e,t,i){var n,s;const o=(null===(s=null===(n=e.hostSettings.serviceSettings)||void 0===n?void 0:n.browseThisComputerSettings)||void 0===s?void 0:s.enableBrowseThisComputerOnFileFlags)&&(!i||i.typeId===Le.L9.CIQFlag_File);if(!o)return;const{browseThisComputerSettings:r}=e.hostSettings.serviceSettings||{},a=null==r?void 0:r.fluentMenuConfig,l=null==a?void 0:a.menuItems.map((i=>Object.assign(Object.assign({},i),{onClickHandler:()=>{const n=t(),s=n?(0,pe.G)(n,e):[];e.oaLogger.logActivity(Y.pp,void 0,[...s,(0,w.n)("eventType",i.menuItemId||"Unknown")]),i.onClickHandler()}})));return{isBrowseThisComputerEnabled:o,isUploadFileButtonEnabled:!i&&(null==r?void 0:r.isUploadFileButtonEnabled),onClickBrowseThisComputer:()=>{var i;const n=t(),s=n?(0,pe.G)(n,e):[];e.oaLogger.logActivity(Y.pp,void 0,[...s,(0,w.n)("eventType","CIQUploadButtonClicked")]),null===(i=null==r?void 0:r.onBrowseThisComputerCallback)||void 0===i||i.call(r)},browseThisComputerButtonLabel:e.localizer.getMessage("ebx_browseThisComputerLabel"),enableCloudPicker:null==r?void 0:r.enableCloudPicker,fluentMenuConfig:a&&Object.assign(Object.assign({},a),{menuItems:l||[]}),eventTarget:null==r?void 0:r.eventTarget}}var Ae=i(749946);const Fe=(e,t,i,n,s,o)=>({ConversationId:t,ImpressionType:n,LocalTime:(new Date).toISOString(),ProviderName:s,Results:o,LogicalId:e,TraceId:i,Version:2});function qe(e,t){const i="TopHits",n={};n[i]=[],e.forEach((e=>{e.entities.forEach((e=>{if(e.isBestMatch)n[i].push(e);else{const t=e.entityType;n[t]?n[t].push(e):n[t]=[e]}}))})),0===n[i].length&&delete n[i];const s=[];let o=1;for(const e in n){const r=n[e];let a=1;s.push(Object.assign({Type:"Group",Name:e===i?i:r[0].entityType,LayoutType:"Vertical",Position:o,ResultsView:n[e].map((e=>({Type:"Entity",EntityType:`${e.entityType}Suggestion`,ReferenceId:e.ReferenceId,Position:a++,PlacementType:"Visible"})))},t&&{MetaData:t})),o++}return s}var Re=i(221489),Pe=i(614313),Oe=i(894904),ke=i(152746),Me=i(147090),ze=i(784262);function je(e,t,i,n,s,o,r,a,l){return function(e){return e.entityType===d.c.People}(e)?We(e,t):function(e){return e.entityType===d.c.File}(e)?function(e,t,i,n){var s;if(!(e.AccessUrl&&e.FileName&&e.FileExtension&&e.FileSourceType))return;const{FileExtension:o,FileName:r,FileSourceType:a,AccessUrl:l}=e,c=(0,ze.u)(r),u=(0,Oe.m)(e,t,n,i);return Object.assign(Object.assign({},e),{type:d.c.File,sourceType:Be(a),fileName:r,hitFileName:c,fileExtension:o,url:l,lastAccessDateTime:e.DateAccessed,lastModifiedDateTime:e.DateModified,createdDateTime:e.DateCreated,itemId:e.Id,fileSize:null!==(s=e.FileSize)&&void 0!==s?s:0,subject:u,titleHitHighlightProperty:"hitFileName",subtitleHitHighlightProperty:"subject"})}(e,i,n,a):function(e){return e.entityType===d.c.Topic}(e)?function(e){return Object.assign(Object.assign({},e),{type:e.entityType,id:e.TopicId,title:e.DisplayName,subtitle:e.Description,iconName:"Hashtag",tooltip:e.Description})}(e):function(e){return e.entityType===d.c.MessageExtensionApp}(e)?function(e,t){const i=!!t&&t.get(e.AppId);if(!i||(n=i.State,!n||n===Re.jf.NotInstalled))return;var n;return Object.assign(Object.assign({},e),{type:e.entityType,id:e.AppId,title:e.DisplayName,subtitle:i.Description,imageUrl:i.IconUrl,tooltip:i.Description})}(e,r):function(e){return e.entityType===d.c.External}(e)?function(e,t,i){var n,s;const o=function(e,t){let i="";e.SecondaryText?i=e.SecondaryText:e.ContentDomainName?i=e.ContentDomainName:e.Authors.length>0?i=1===e.Authors.length?`${t.getMessage("authorLabel")}: ${e.Authors[0]}`:`${t.getMessage("authorsLabel")}: ${e.Authors.join(", ")}`:e.LastModifiedDateTimeUtc&&(i=`${t.getMessage("lastModifiedDateLabel")} ${(0,ke.Z)(new Date(e.LastModifiedDateTimeUtc),new Date)}`);return i}(e,t);return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:i&&null!==(n=e.GroupDisplayName)&&void 0!==n?n:e.entityType,id:e.ItemId,title:e.text,subtitle:o,tooltip:e.text}),!e.IconUrl&&{iconName:null===(s=e.icon)||void 0===s?void 0:s.iconName}),e.IconUrl&&{imageUrl:e.IconUrl}),{subtitleHitHighlightProperty:"ContentDomainName"})}(e,s,l):function(e){return e.entityType===d.c.Event}(e)?function(e){return Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,eventId:e.OriginalId||e.entityId||e.text,eventName:e.text,eventStartDateTime:e.Start,eventEndDateTime:e.End,isAllDay:e.IsAllDay,isSeries:!!e.SeriesMasterId,hasRecording:e.HasRecording})}(e):function(e){return e.entityType===d.c.Message}(e)?function(e){var t,i,n,s,o,r;return Object.assign(Object.assign({},e),{type:d.c.Message,id:e.text,subject:e.Subject,sender:null!==(r=null!==(n=null===(i=null===(t=e.From)||void 0===t?void 0:t.EmailAddress)||void 0===i?void 0:i.Name)&&void 0!==n?n:null===(o=null===(s=e.From)||void 0===s?void 0:s.EmailAddress)||void 0===o?void 0:o.Address)&&void 0!==r?r:"",emailId:e.ItemId.Id})}(e):function(e){return e.entityType===d.c.Chat}(e)?function(e){var t,i,n,s,o,r,a,l,d,c;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{id:e.text}),!e.IconUrl&&{iconName:null!==(i=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"OfficeChat"}),{type:e.entityType,title:e.Name,name:e.Name,threadId:e.ThreadId,threadType:null!==(s=null===(n=e.ThreadType)||void 0===n?void 0:n.toString())&&void 0!==s?s:"",teamName:e.Name,groupId:e.GroupId,matchingMembers:null!==(r=null===(o=e.MatchingMembers)||void 0===o?void 0:o.map((e=>We(e,void 0))))&&void 0!==r?r:[],chatMembers:null!==(l=null===(a=e.ChatMembers)||void 0===a?void 0:a.map((e=>We(e,void 0))))&&void 0!==l?l:[],totalChatMembersCount:null!==(d=e.TotalChatMembersCount)&&void 0!==d?d:0,lastMessageTime:null!==(c=e.LastMessageTime)&&void 0!==c?c:"",imageUrl:e.IconUrl})}(e):function(e){return e.entityType===d.c.Channel}(e)?function(e,t){var i,n;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,subtitle:t.getMessage("channelOfTeamLabel",e.TeamName),tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(n=null===(i=e.icon)||void 0===i?void 0:i.iconName)&&void 0!==n?n:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})}(e,s):function(e){return e.entityType===d.c.Team}(e)?function(e){var t,i;return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:e.entityType,id:e.text,title:e.Name,tooltip:e.Name}),!e.IconUrl&&{iconName:null!==(i=null===(t=e.icon)||void 0===t?void 0:t.iconName)&&void 0!==i?i:"OfficeChat"}),e.IconUrl&&{imageUrl:e.IconUrl})}(e):function(e){return e.entityType===d.c.App}(e)?function(e){return Object.assign(Object.assign({},e),{id:e.CollectorId,type:d.c.App,title:e.Title,imageUrl:e.IconAnonymousUrl})}(e):function(e){return e.entityType===d.c.PIM}(e)?function(e){const t=function(e){let t="PhoneNumber";e===Pe.Nm.Address?t="Location":e===Pe.Nm.Membership&&(t="Member");return t}(e.IntentId),i=function(e){var t;let i="";e.entityType===d.c.PIM?i=null!==(t=e.SecondaryText)&&void 0!==t?t:"":"Phones"in e&&e.Phones&&e.Phones.length>0&&e.Phones[0].Type&&(i=e.Phones[0].Type);return i}(e);return Object.assign(Object.assign({},e),{type:d.c.PIM,id:e.text,title:e.text,tooltip:e.text,subtitle:i,iconName:t})}(e):function(e){return e.entityType===d.c.Scope}(e)?function(e,t){var i,n;const s=e.entityType,o=e.ScopeDisplayName||"";let r;r="Meetings"===e.ScopeDisplayName?"Event":e.ScopeDisplayName;let a=!1;const l=new Date;if(t)for(const n of t){const t=new Date(n[1]);n[0]===(null===(i=e.scopeInfo)||void 0===i?void 0:i.entityType)&&l<=new Date(t.setDate(t.getDate()+14))&&(a=!0)}return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:s,id:null!==(n=e.id)&&void 0!==n?n:e.text,title:o}),!e.IconUrl&&{iconName:r}),e.IconUrl&&{imageUrl:e.IconUrl}),{isNew:a})}(e,o):function(e){var t,i,n;const s=e.entityType,o=e.subtitle,r=null!==(t=e.tooltip)&&void 0!==t?t:"",a=(s===d.c.Scope?e.ScopeDisplayName:e.text)||"";return Object.assign(Object.assign(Object.assign(Object.assign({},e),{type:s,id:null!==(i=e.id)&&void 0!==i?i:e.text,title:a,subtitle:o,tooltip:r}),!e.IconUrl&&{iconName:null===(n=e.icon)||void 0===n?void 0:n.iconName}),e.IconUrl&&{imageUrl:e.IconUrl})}(e)}function We(e,t){var i;const n=(0,Me.u)(e);let s=e.imageUrl;s||(s=null==t?void 0:t.fetchCachedProfilePicture(n));const o=e.subtitlePropertyOverride;return Object.assign(Object.assign({},e),{ReferenceId:e.ReferenceId||e.entityId,type:d.c.People,displayName:e.text,primaryEmailAddress:n,subtitleOverride:o?e[o]:void 0,imageUrl:s,titleHitHighlightProperty:"displayName",subtitleHitHighlightProperty:null!==(i=o)&&void 0!==i?i:"primaryEmailAddress"})}function Be(e){switch(e){case"ClassicAttachment":return s.xh.ClassicAttachment;case"OneDriveForBusiness":return s.xh.OneDriveForBusiness;case"SharepointOnline":return s.xh.SharepointOnline;default:return s.xh.Undefined}}function Ue(e,t){const{browseThisComputerConfig:i,getQueryRangeBoundingClientRect:n,handleEccUploadMenuEvent:s,handleKeyDown:o,menuParentElement:r,onDismissed:a,onPreventDismissOnEvent:l}=e.calloutProps,d=async e=>{const i=await async function(e,t){const i=await(null==t?void 0:t());if(!i)return!1;return e.clientX>=i.x&&e.clientX<=i.x+i.width&&e.clientY>=i.y&&e.clientY<=i.y+i.height}(e,n);i||(0,oe.mU)(e.target)||(t?(0,oe.UM)(e.target)||!1===e.target.isConnected&&(0,oe.UM)(e.target):(0,oe.Yn)(e.target))||a(!1)},c=async e=>{l&&!l(e)&&a(!1)},u=[];if(r){const e=new m.J(r),n=new m.J(r.ownerDocument);let a;e.addListener("keydown",o),n.addListener("mouseup",d,{capture:!0}),t&&n.addListener("scroll",c),u.push(e),u.push(n),(null==i?void 0:i.eventTarget)&&s&&(a=new m.J(i.eventTarget),a.addListener("AttachCloudFilesSelected",s),a.addListener("UploadLocalFilesSelected",s)),a&&u.push(a)}return()=>{for(const e of u)e.removeAllListeners()}}let He=class{get _menuCurrentlyOpen(){return this._calloutState.menuCurrentlyOpen}constructor(e,t,i,n,u,v,y,_,I,C,S,b,T,E,L,D,A,F,q,R,P,M,z,j,W,B,U,H,V,K,$,J){var Z;this._hostSettings=e,this._oaLogger=t,this._logger=i,this._guidGenerator=n,this._oaMetric=u,this._hostEmitter=v,this._proofingDom=y,this._paragraphTextExtractor=_,this._tileContent=I,this._oaResultStore=C,this._queryDetection=S,this._localizer=b,this._featureFlagsReader=T,this._proofingEmitter=E,this._safeWindow=L,this.languageScriptDirectionDetector=D,this._targetWindowFactory=F,this._targetDocumentFactory=q,this._paneOpenState=R,this._ariaStatusStateStoreFactory=P,this._indicatorStore=M,this._calloutDismissalHandler=z,this._externalSettingsFeature=j,this._instrumentationProcessor=W,this.feedbackStoreFactory=B,this._messageExtensionAppDataProvider=U,this.defaultInlineSuggestionItems=H,this.themeStore=V,this.userProfilePictureCache=K,this._isMobile=J,this._menus=new Map,this.resultStatus=void 0,this._isClearingSearch=!1,this._isCIQMentionsEnabled=!0,this._isFirstMenuUpdate=!1,this._fileCount=0,this._queryCorrelationKeys=void 0,this.initialize=async()=>{var e;this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled)&&(this._hostEmitter.on(g.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(g.pD.hostModelTextTile,this._handleTextTile),this._hostEmitter.on(g.pD.nudgeAccepted,this.handleNudgeAccepted),this._hostEmitter.on(g.pD.ciqSettingsChange,this.ciqSettingsChange),this._hostEmitter.on(g.pD.hostModelRehydrateTilesFinished,this.hostModelRehydrateTilesFinished),this._hostEmitter.on(g.pD.hostModelVisualStateChange,this.hostModelVisualStateChange),this._calloutState.subscribe("menuUpdated",this.onMenuChanged))},this.shutDown=()=>{var e;null===(e=this._menuEventListenersDisposal)||void 0===e||e.call(this),this._menus.clear(),this._calloutState.updateCurrentMenu(void 0,void 0,void 0),this._scrollThrottle=void 0,this._resizeThrottle=void 0,this._calloutState.unsubscribe("menuUpdated",this.onMenuChanged)},this.onMenuChanged=e=>{this._proofingEmitter.emit("eccStateChanged",e)},this.hostModelVisualStateChange=e=>{var t,i;if(this._menuCurrentlyOpen&&e.message.tileId===this._menuCurrentlyOpen.parentTileId)if(e.message.created){this.renderECC(!1),null===(t=this._menuEventListenersDisposal)||void 0===t||t.call(this);const e=this._calloutState.getCalloutState();e&&(this._menuEventListenersDisposal=Ue(e,null!==(i=this._hostSettings.useFluentV9)&&void 0!==i&&i))}else this._isMobile||this.dismissECC(!1)},this.renderMenuWithItems=async(e,t,i,n,s,o,r,a,l)=>{const d=this.isFlightEnabled("mc-editor-enable-searchbar");return this.showMenu(e,0,0,void 0,!0,{supportedEntityTypes:void 0,onItemSelected:s,theme:o,style:r,styles:a,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:n,getLocalItems:l,expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(d),browseThisComputerConfig:De(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig(),enableExpandedECCSearchBar:d},i,!1,t)},this.showExistingMenu=async(e,t,i,n,s,o,r,a,l,d,c)=>{const u=this._menus.get(n);return!!u&&this.showMenu(e,t,i,n,s,Object.assign(Object.assign({},u),{shouldRemoveTextOnItemSelection:o,specifiedItemsToDisplay:l,expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(u.enableExpandedECCSearchBar),browseThisComputerConfig:De(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig(),onItemSelected:null!=a?a:u.onItemSelected,supportedEntityTypes:r||l?r:u.supportedEntityTypes,onSuggestionsUpdated:l?void 0:u.onSuggestionsUpdated}),d,c)},this.showMenu=async(e,t,i,n,s,o,r,a,l)=>{var d,c;if(this._menuCurrentlyOpen)return!1;const u=this._proofingDom.findParagraphNode(e);if((0,O.l)(u)){const e=this._paragraphTextExtractor.getParagraphText(u);if(void 0!==e){const g=e.substring(t,t+i),h=g.charAt(0)===n,p={start:t,length:i,prefix:void 0!==n&&h?n:""};return this.setMenuCurrentlyOpen(n,o,u,p,void 0,null!=r?r:{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},s,o.shouldRemoveTextOnItemSelection,a,null===(d=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===d?void 0:d.source,l,g),(null===(c=this._calloutState.menuCurrentlyOpen)||void 0===c?void 0:c.specifiedItemsToDisplay)||(0,he.A)(this.getServices(),n,g,p,u,void 0),this.prepareAndRenderECC(u,g)}}return!1},this.showEntityPrediction=async(e,t,i,n,s,o)=>{var r,a;const l=null!==(a=null!==(r=this._menus.get(void 0))&&void 0!==r?r:this._menus.get(this._hostSettings.ciqTriggeringChar||"/"))&&void 0!==a?a:this.getDefaultMenuInformation();return this.showMenu(e,t,0,void 0,!0,Object.assign(Object.assign({},l),{supportedEntityTypes:void 0,shouldRemoveTextOnItemSelection:!1,specifiedItemsToDisplay:i,onItemSelected:(e,t)=>{n(e,t)},onOpen:void 0,onClose:()=>{null==s||s()}}),{menuType:"InlineSuggestionsEntityPredictionMenuType"},!1,o)},this.onSearchBoxQueryChange=(e,t)=>{this._searchBox.onSearchBoxQueryChange(e,t)},this.buildAppGptConfig=()=>{var e;const{appGptConfig:t}=null!==(e=this._hostSettings.serviceSettings)&&void 0!==e?e:{};if(null==t?void 0:t.enableAppGpt)return t},this.showFlag=async(e,t,i,n,o,a,l,d,c)=>{var u,g,p,m,f,v,y;if(!e.nodeId)return!1;this._oaResultStore.clearResults(),this._queryDetection.removeDetectedQuery();const _=null!==(g=null!==(u=this._menus.get(void 0))&&void 0!==u?u:this._menus.get(this._hostSettings.ciqTriggeringChar||"/"))&&void 0!==g?g:this.getDefaultMenuInformation(),I=(0,ge.e)(e.typeId);if(void 0===I)return this._oaLogger.logDiagnostics("Unable to determine type of flag for critique type: "+e.typeId),!1;const C=this._proofingDom.findParagraphNode(e.nodeId);if((0,O.l)(C)){const u={start:e.start-C.element.offset,length:e.length,prefix:""},g=null!==(p=this._paragraphTextExtractor.getQueryString(C,u))&&void 0!==p?p:"";if(g){let p=!1;return this.setMenuCurrentlyOpen(void 0,Object.assign(Object.assign({},_),{supportedEntityTypes:e.supportedEntityTypes,specifiedItemsToDisplay:null!==(m=e.suggestionItems)&&void 0!==m?m:_.specifiedItemsToDisplay,shouldRemoveTextOnItemSelection:!1,onOpen:void 0,onClose:t=>{var n;t||null===(n=this._instrumentationProcessor)||void 0===n||n.process({critique:(0,re.toJS)(e),eventId:G.xp.ClickNoAction}),i(void 0,p)},critiqueRange:u,onItemSelected:(n,s)=>{var o;null===(o=this._instrumentationProcessor)||void 0===o||o.process({critique:(0,re.toJS)(e),eventId:G.xp.ChangeSuggOther}),t(e,n,s),i(!1,!1)},onFooterAction:async t=>{var d,u,g,m;let f;switch(t){case s._R.IgnoreOnce:f=G.xp.Ignore,null==n||n(e);break;case s._R.IgnoreAll:f=G.xp.IgnoreAll,null==o||o(e);break;case s._R.IgnoreRule:f=G.xp.DoNotCheckThisIssue,null==a||a(e);break;case s._R.OpenEditorPane:null===(u=null===(d=this._indicatorStore)||void 0===d?void 0:d.onOpenEditorPane)||void 0===u||u.call(d,r.k.ContextualCard),i(void 0,!1);break;case s._R.Options:null===(g=this._externalSettingsFeature)||void 0===g||g.openSettings(h.kY.dropdown);break;case s._R.Feedback:null==l||l(e);break;case s._R.Next:return p=!0,this.dismissECC(!1),void this.navigateWithDelay(c,1);case s._R.Previous:return p=!0,this.dismissECC(!1),void this.navigateWithDelay(c,-1)}f&&(null===(m=this._instrumentationProcessor)||void 0===m||m.process({critique:(0,re.toJS)(e),eventId:f})),this.dismissECC(!1)},onSuggestionsUpdated:async(t,i,n,s,o,r,a,l,d,c,u,g,h)=>{let p=t;if(!e.suggestionItems&&_.onSuggestionsUpdated){if(p=await _.onSuggestionsUpdated(t,i,n,s,o,r,a,l,d,c,u,this.logWithMenuData,h),!p)return;e.supportedEntityTypes&&(p=p.filter((t=>{var i;return null===(i=e.supportedEntityTypes)||void 0===i?void 0:i.includes(t.entityType)})))}for(const t of p){e.groupTitle&&(t.groupTitle=e.groupTitle),e.groupSubtitle&&(t.groupSubtitle=e.groupSubtitle);for(const e of t.entities)e.isBestMatch=!1}return p},showMoreEntitiesConfig:this._searchBox.buildShowMoreEntitiesConfig(e,g,u,C),browseThisComputerConfig:De(this.getServices(),(()=>this._menuCurrentlyOpen),e),appGptConfig:this.buildAppGptConfig(),expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(_.enableExpandedECCSearchBar)}),C,u,{x:0,y:3},{menuType:"InlineSuggestionsResultsFlagMenuType",flag:I,brandingMode:this._hostSettings.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("flag",!1,I!==s.z4.Topic,void 0!==c),critiqueSetSize:d?(0,se.v)(d).length:void 0,critiquePosition:null==d?void 0:d.currentIndex},I!==s.z4.File,!0,!1,null===(f=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===f?void 0:f.source,void 0,g),(null===(v=this._menuCurrentlyOpen)||void 0===v?void 0:v.specifiedItemsToDisplay)||(0,he.A)(this.getServices(),null===(y=this._menuCurrentlyOpen)||void 0===y?void 0:y.triggerCharacter,g,u,C,void 0),this.prepareAndRenderECC(C,g)}}return!1},this.onFooterAction=e=>{var t;(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.onFooterAction)?this._menuCurrentlyOpen.onFooterAction(e):this.runDefaultFooterActionIfAvailable(e)},this.onSuggestionsUpdated=async(e,t,i,n,s,o,r,a,l,d,c,u,g)=>{var h,p,m;if(this._menuCurrentlyOpen)return this._menuCurrentlyOpen.specifiedItemsToDisplay&&(e=await i(this._menuCurrentlyOpen.specifiedItemsToDisplay)),null!==(m=null===(p=(h=this._menuCurrentlyOpen).onSuggestionsUpdated)||void 0===p?void 0:p.call(h,e,t,i,n,s,o,r,a,l,d,c,this.logWithMenuData,g))&&void 0!==m?m:e;this._oaLogger.logDiagnostics("Received suggestions update with no menu open")},this.logWithMenuData=(e,t,i)=>{const n=this.getDefaultLogDataForMenu();n.push(...null!=i?i:[]),this._oaLogger.logActivity(e,t,n)},this.handleNudgeAccepted=e=>{const t=e.message.data.nudge,i={hasEntityResults:void 0!==t.entityResults,entityType:t.entityType};!e.message.data.fromUserAction&&this._menuCurrentlyOpen?(this._menuCurrentlyOpen.wasOpenedViaNudge=!0,this._menuCurrentlyOpen.wasOpenedViaNudgeInfo=i):this._nextMenuOpenIsViaNudge=i},this._handleTextTile=e=>{if(e.message.messageType===p.G.RemoveData){const t=e.message.data.tileId;if(this._menuCurrentlyOpen){const e=t===this._menuCurrentlyOpen.tileId,i=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);(e||!i&&!this._isClearingSearch)&&this.dismissECC(!1)}}},this.ciqSettingsChange=e=>{this._isCIQMentionsEnabled=e.message.isCIQMenuEnabled},this.hostModelRehydrateTilesFinished=()=>{var e;if(!(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.parentTileId)||void 0===this._menuCurrentlyOpen.parentTileOffset)return;if(this._featureFlagsReader.flags.disableECCMenuRecreationOnALReconnection)return;const t=this._proofingDom.findTileNode(this._menuCurrentlyOpen.parentTileId);if(!t)return;const i=this._menuCurrentlyOpen.parentTileOffset+this._menuCurrentlyOpen.queryRange.start;let n;if(t.children)for(const e of t.children)if(e.element&&e.element.offset<=i&&e.element.offset+e.element.span>=i){n=e;break}if(!n)return;this._menuCurrentlyOpen.tileId=n.id;const s=this._paragraphTextExtractor.getQueryString(n,this._menuCurrentlyOpen.queryRange,!0);void 0!==s&&(this._oaResultStore.updateLoadingStatus(!0),(0,he.A)(this.getServices(),this._menuCurrentlyOpen.triggerCharacter,s,this._menuCurrentlyOpen.queryRange,n,this._queryDetection.getCurrentScope()))},this.notifyMenuTriggeringMethod=e=>{this._calloutState.setTriggerMethod(e)},this._handleDelta=async e=>{var t,i,n,s,o,r,a,l,c,u,g,h,p,m,f,v,y,_,I,C,S;const b=e.message;if(b.sourceType===N.pf.TileNode)return;const{changeType:T,delta:E,tileId:w}=b,x="InlineSuggestionsResultsUserInitiatedMenuType"!==(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.menuType.menuType);if((E.unit===Q.OD.Sentence||E.unit===Q.OD.Paragraph)&&(E.deltaType===Q.WI.Add||E.deltaType===Q.WI.Update)&&((null!==(n=null===(i=E.content)||void 0===i?void 0:i.length)&&void 0!==n?n:0)>1||0===(null===(s=E.content)||void 0===s?void 0:s.length))&&void 0===E.queryRange===(void 0===this._menuCurrentlyOpen||x))return;const L=!this._isClearingSearch;if(T!==N.Q0.Local){if(this._menuCurrentlyOpen){const e=null===(o=this._queryDetection.getCurrentQuery())||void 0===o?void 0:o.queryRange;if(e)this._menuCurrentlyOpen.queryRange=e,this._menuCurrentlyOpen.searchBoxGeneratedParagraphId||(null===(r=E.additionalData)||void 0===r?void 0:r.scopeInfo)||this.tryToUpdatePreloadedItems(E,w,!0);else{if(!L)return void(this._isClearingSearch=!1);this.dismissECC(!1)}}return}(null===(a=this._menuCurrentlyOpen)||void 0===a?void 0:a.shouldDismissOnTyping)&&this.dismissECC(!1);const D=this._proofingDom.findParagraphNode(w),A=null===(l=E.queryRange)||void 0===l?void 0:l.prefix;if(E.queryRange){if(!this._isCIQMentionsEnabled&&!1!==this._hostSettings.isHidingCIQMenuSupported){if((null!==(c=E.queryRange.prefix)&&void 0!==c?c:"@")===(null!==(u=this._hostSettings.ciqTriggeringChar)&&void 0!==u?u:"/"))return}const e=!this._menuCurrentlyOpen,t=!D&&(null===(g=this._menuCurrentlyOpen)||void 0===g?void 0:g.searchBoxGeneratedParagraphId)?E.content:this._paragraphTextExtractor.getQueryString(D,E.queryRange);if(this._menuCurrentlyOpen){if(void 0===t)return void this.dismissECC(!1);this._menuCurrentlyOpen.queryRange=E.queryRange,this._menuCurrentlyOpen.keyStrokes=this._menuCurrentlyOpen.keyStrokes+1,this.updateSpecifiedItemsToDisplay(w,t,!1),null===(p=(h=this._menuCurrentlyOpen).onQueryUpdated)||void 0===p||p.call(h,t),this._oaLogger.logActivity(Y.WT,void 0,[...this.getDefaultLogDataForMenu()])}else if((0,O.l)(D)&&void 0!==t){const e=this._menus.get(A),i=this._hostSettings.eccTargetOffset;if(e){if((e.enableExpandedECC||(null===(f=null===(m=this._hostSettings.oaSettings)||void 0===m?void 0:m.scopesConfig)||void 0===f?void 0:f.enabled))&&E.additionalData){let t;(null===(v=this._nextMenuOpenIsViaNudge)||void 0===v?void 0:v.entityType)===d.c.File&&!this._nextMenuOpenIsViaNudge.hasEntityResults&&(null===(_=null===(y=this._hostSettings.serviceSettings)||void 0===y?void 0:y.nudge)||void 0===_?void 0:_.automaticallyScope)&&(t=d.c.File),e.enableExpandedECC&&(null===(I=this._hostSettings.oaSettings)||void 0===I?void 0:I.scopeToPeopleTabInExpandedECC)&&"@"===A&&(t=d.c.People),!e.enableExpandedECC&&(null===(C=this._hostSettings.oaSettings)||void 0===C?void 0:C.scopeToAppGptInlineSuggestion)&&"@"===A&&(t=d.c.App),t&&(this._queryDetection.setCurrentScope({entityType:t},!1),E.additionalData.scopeInfo={entityType:t})}this.setMenuCurrentlyOpen(A,Object.assign(Object.assign({},e),{expandedEccSearchBarConfig:this._searchBox.buildExpandedEccSearchBarConfig(e.enableExpandedECCSearchBar),browseThisComputerConfig:De(this.getServices(),(()=>this._menuCurrentlyOpen)),appGptConfig:this.buildAppGptConfig()}),D,E.queryRange,i,{menuType:"InlineSuggestionsResultsUserInitiatedMenuType",brandingMode:e.brandingMode,actions:this.buildInlineSuggestionsResultsMenuActions("userInitiated")},!1,!0,!1,null===(S=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===S?void 0:S.source,void 0,t),1!==E.queryRange.length&&this._calloutState.menuCurrentlyOpen&&(this._calloutState.menuCurrentlyOpen.keyStrokes=this._calloutState.menuCurrentlyOpen.keyStrokes+1),this.prepareAndRenderECC(D,t),this._oaLogger.logActivity(Y.WT,void 0,[...this.getDefaultLogDataForMenu()])}}this.tryToUpdatePreloadedItems(E,w,e)}else L&&this.dismissECC(!1)},this.updatePreloadedItemsDebounced=(0,ne.debounce)(this.updatePreloadedItems,200),this.handleEccUploadMenuEvent=e=>{this._menuCurrentlyOpen&&function(e,t,i){try{const n=i.detail,s=(0,pe.G)(t,e);e.oaLogger.logActivity(Y.pp,n,[...s,(0,w.n)("eventType",i.type)])}catch(t){e.logger.error(506557473,`Failed to log uploadMenuEvent ${i.type}`,t)}}(this.getServices(),this._menuCurrentlyOpen,e)},this.handleKeyDown=e=>{(async e=>{var t,i,n,s;if(this._menuCurrentlyOpen){for(const t of[a.m.arrowDown,a.m.arrowUp,a.m.arrowLeft,a.m.arrowRight,a.m.enter,a.m.tab,a.m.end,a.m.home])if((l.x.isKey(e,t)||l.x.isKey(e,t,!1,!1,!1,!0))&&this.handleExternalKeyboardEvents(t,e.altKey,e.shiftKey))return e.stopPropagation(),void e.preventDefault();if(!l.x.isKey(e,a.m.arrowLeft)&&!l.x.isKey(e,a.m.arrowRight)||await this.isKeyCursorOverParagraph(e)||(0,oe.mU)(e.target)){if(l.x.isKey(e,a.m.space)&&(null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.queryRange.length)===(null===(n=null===(i=this._queryDetection.getCurrentQuery())||void 0===i?void 0:i.queryRange.prefix)||void 0===n?void 0:n.length)&&this._oaLogger.logActivity(Y.hf,void 0,[...this.getDefaultLogDataForMenu(),(0,w.n)("interaction",Y.RK)]),l.x.isKey(e,a.m.delete)){const e=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,t=await this._tileContent.getTextSelection();(null==t?void 0:t.startPositionInParagraphNode)===e&&this.dismissECC(!1)}l.x.isKey(e,a.m.escape)&&((null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.enableCurrentQueryDismissalOnEscape)&&this._queryDetection.dismissCurrentQuery(!0,Y.iL,Y.hf,this.getDefaultLogDataForMenu()),this.dismissECC(!1),e.stopPropagation(),e.preventDefault())}else this.dismissECC(!1)}})(e).catch((e=>{this._logger.error(506803665,"handleKeyDown threw an exception",e)}))},this.getQueryRangeBoundingClientRect=async()=>{if(!this._menuCurrentlyOpen)return;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!(0,O.l)(e))return;const t=await this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+this._menuCurrentlyOpen.queryRange.start,this._menuCurrentlyOpen.queryRange.length);return null==t?void 0:t.getBoundingClientRect()},this.dismissMenu=async()=>{this.dismissECC(!1)},this.onDismissed=async e=>{this.dismissECC(e)},this.dismissECC=e=>{var t,i;if(!this._menuCurrentlyOpen)return;this._queryDetection.resetNextDeltaProgramaticallyInserted(),!e&&this._searchBox.getIsSearchBarAvailable()&&this.removeComposingBoxQuery(),null===(t=this._menuEventListenersDisposal)||void 0===t||t.call(this);const n=this._menuCurrentlyOpen;this._calloutState.updateCurrentMenu(void 0,void 0,void 0);const s=this._queryDetection.getPreviousQueryCorrelationKeys();this._oaLogger.logActivity(Y.fL,void 0,[...(0,w.W)(["keyStrokeToSuccess",n.keyStrokes],["persistTime",n.openTime?Date.now()-n.openTime:0],["accepted",e]),...this.getDefaultLogDataForMenu(n)],s),this._searchBox.menuDismissed(n),null===(i=n.onClose)||void 0===i||i.call(n,e,n.openTime?Date.now()-n.openTime:0),this._queryDetection.removeDetectedQuery();const o=this.isAtTriggeringChar(n);e?this.setAriaStatus(o?"ebx_AtCIQMentionsClosedViaInsertionAriaLabel":"ebx_SlashCIQMentionsClosedViaInsertionAriaLabel"):this.setAriaStatus(o?"ebx_AtCIQMentionsClosedAriaLabel":"ebx_SlashCIQMentionsClosedAriaLabel")},this.renderECC=(e=!1)=>{if(!this._menuCurrentlyOpen)return;const t=()=>{var e;(null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.onOpen)&&this._menuCurrentlyOpen.onOpen(this._menuCurrentlyOpen),this._menuCurrentlyOpen&&(this._menuCurrentlyOpen.wasOpenedViaNudge?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByNudgeAriaLabel":"ebx_SlashCIQMentionsOpenedByNudgeAriaLabel"):"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType?this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByUserTypingAriaLabel":"ebx_SlashCIQMentionsOpenedByUserTypingAriaLabel",this._menuCurrentlyOpen.queryRange.prefix):"InlineSuggestionsResultsFlagMenuType"===this._menuCurrentlyOpen.menuType.menuType&&this.setAriaStatus(this.isAtTriggeringChar(this._menuCurrentlyOpen)?"ebx_AtCIQMentionsOpenedByFlagAriaLabel":"ebx_SlashCIQMentionsOpenedByFlagAriaLabel"));const t=this._queryDetection.getCurrentQueryLogicalId();t&&this._oaMetric.addMeasure(t,"InlineSuggestionsCalloutDisplay")};this._calloutState.calculateTargetLocationAndShow().then((()=>{e&&t()})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to display callout: ${e}`)}))},this.onAction=e=>{var t,i,n,s,r,a,l;if(this._menuCurrentlyOpen){if(e===o.L.Retry)this.retryQuery();else{this._oaResultStore.clearResults(),(null===(t=this._calloutState.currentScope)||void 0===t?void 0:t.entityType)&&this.resetStateAndUpdateScope(void 0);const o=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!o)return void this._oaLogger.logDiagnostics("No parent found for clearing search");this._oaLogger.logActivity(Y.rN,void 0,this.getDefaultLogDataForMenu());const a=null!==(n=null===(i=this._menuCurrentlyOpen.queryRange.prefix)||void 0===i?void 0:i.length)&&void 0!==n?n:1,l=this._menuCurrentlyOpen.menuType.menuType,d=this._menuCurrentlyOpen.queryRange.length;if("InlineSuggestionsResultsFlagMenuType"===l){if(d===a)return this._oaLogger.logDiagnostics("ECC query cleared with no query"),this.retryQuery(),void(null===(r=(s=this._menuCurrentlyOpen).onAction)||void 0===r||r.call(s,e));this.wrapInClearingSearch((()=>{var e,t;this._searchBox.initShowMoreEntitiesParagraph(null===(t=null===(e=this._menuCurrentlyOpen)||void 0===e?void 0:e.showMoreEntitiesConfig)||void 0===t?void 0:t.entityType,!1,""),this._oaLogger.logActivity(Y.N2,void 0,this.getDefaultLogDataForMenu())}))}else if(d!==a){const e=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,this._menuCurrentlyOpen.queryRange.start),t=this._menuCurrentlyOpen.queryRange.length-a;this.wrapInClearingSearch((()=>this._tileContent.remove(o,void 0,e+a,t)))}}null===(l=(a=this._menuCurrentlyOpen).onAction)||void 0===l||l.call(a,e)}this._hostEmitter.emit(g.pD.oaAnnotationsTriggered,{address:void 0,message:void 0})},this.onPreventDismissOnEvent=e=>{var t,i,n,s,o;if(!this._menuCurrentlyOpen)return!1;if(this._isClearingSearch)return!0;if("InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType){if(["click","mouseup"].includes(e.type))return!0;if("resize"===e.type&&(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.enableResizeDismissal))return!1;if("resize"===e.type)return this.getResizeThrottle()(),!0;if("scroll"===e.type||"wheel"===e.type)return this._hostSettings.useFluentV9?!!(null===(n=(i=e.target).closest)||void 0===n?void 0:n.call(i,".ms-ecc-callout")):(this.getScrollThrottle()(),!0)}return!!(null===(o=(s=this._menuCurrentlyOpen).onPreventDismissCalloutOnEvent)||void 0===o?void 0:o.call(s,e,this._menuCurrentlyOpen))||("focus"===e.type&&"InlineSuggestionsResultsUserInitiatedMenuType"===this._menuCurrentlyOpen.menuType.menuType||!(!this._calloutDismissalHandler||this._calloutDismissalHandler.shouldDismissCallout(e,"ECC",this._menuCurrentlyOpen)))},this.onRestoreFocus=(e,t)=>{var i;(null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.onRestoreFocus)?this._menuCurrentlyOpen.onRestoreFocus(e,t):t()},this.telemetryKeptCallback=(e,t)=>{const i=this._oaLogger;e&&setTimeout((()=>{e()&&this._hostSettings.enableKeptMetric&&i.logActivity(Y.qS,void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(t)])}),3e4)},this.onItemSelected=e=>{var t,i,n,o,r,a,l;if(!this._menuCurrentlyOpen)return;const c=e;if((null===(i=null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===i?void 0:i.enabled)&&c.scopeInfo&&c.entityType===d.c.Scope)this.resetStateAndUpdateScope(c.scopeInfo);else if("feedback"!==c.key)if(c.entityType&&c.key){const e=c.entityType;this.resetStateAndUpdateScope(e?{entityType:e}:void 0)}else if(c.type!==d.c.Scope)try{c.wasOpenedViaNudge=this._menuCurrentlyOpen.wasOpenedViaNudge,c.wasOpenedViaNudgeAndHasEntityResults=null===(o=this._menuCurrentlyOpen.wasOpenedViaNudgeInfo)||void 0===o?void 0:o.hasEntityResults,this._oaLogger.logActivity(Y.OE,void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(c)]);const e=this._searchBox.getIsSearchBarAvailable(),t=null!==(r=this._menuCurrentlyOpen.critiqueRange)&&void 0!==r?r:this._menuCurrentlyOpen.queryRange,i=this.getCurrentPositionInDocument(this._menuCurrentlyOpen.tileId,e?this._menuCurrentlyOpen.initialQueryStartPosition:t.start);e&&this._calloutState.searchBoxQueryString.length>0&&this._oaLogger.logActivity(Y.Uj,void 0,[...this.getDefaultLogDataForMenu(),...this.getLogDataForSuggestion(c)]);const n=this._menuCurrentlyOpen.onItemSelected,s=e=>this.telemetryKeptCallback(e,c);if(this._menuCurrentlyOpen.shouldRemoveTextOnItemSelection){const o=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!o)return void this._oaLogger.logDiagnostics("No parent found for selecting ECC item.");let r;r=!e||void 0===this._searchBox.lastComposingBoxQuery&&this._calloutState.triggerMethod!==ue.P.AttachFile&&this._calloutState.triggerMethod!==ue.P.Fre?t.length:(null!==(l=null===(a=this._searchBox.lastComposingBoxQuery)||void 0===a?void 0:a.length)&&void 0!==l?l:0)+(t.prefix?t.prefix.length:1),this._tileContent.remove(o,void 0,i,r).then((e=>{n(c,e,o.element,s)})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to remove text range for ECC application: ${e}`)}))}else if(this._menuCurrentlyOpen.shouldCalculateRemovalRange){const e=this.getTileNode(this._menuCurrentlyOpen.tileId);if(!e)return void this._oaLogger.logDiagnostics("No tile found for selecting ECC item.");this._tileContent.getRangeOfNode(e,void 0,i,t.length).then((t=>{t?n(c,t,e.element,s):this._oaLogger.logDiagnostics("Could not determine Range for the search query after selected ECC item.")})).catch((e=>{this._oaLogger.logDiagnostics(`Unable to determine range for ECC application: ${e}`)}))}else n(c,void 0,void 0,s)}finally{this.dismissECC(!0)}else{const t=null===(n=e.scopeInfo)||void 0===n?void 0:n.entityType;this.resetStateAndUpdateScope(t?{entityType:t}:void 0)}else this.onFooterAction(s._R.Feedback)},this.removeComposingBoxQuery=e=>{this.wrapInClearingSearch((()=>this._searchBox.removeComposingBoxQuery(e)))},this.wrapInClearingSearch=e=>(this._isClearingSearch=!0,Promise.resolve(e()).then((()=>{this._isClearingSearch=!1}))),this.onFeedbackButtonClicked=()=>{var e,t,i,n,s,o;if(!(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.ECCFeedbackSettings)||void 0===t?void 0:t.onFeedbackButtonClicked))return;const r=[];this._calloutState.suggestions.map((e=>{e.entities.map((e=>{r.push(e)}))}));const a={conversationId:null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.conversationId,logicalId:null===(n=this._queryCorrelationKeys)||void 0===n?void 0:n.logicalId,sessionId:null===(s=this._hostSettings.hostMetadata)||void 0===s?void 0:s.sessionId,query:this._calloutState.queryString,tab:null===(o=this._calloutState.currentScope)||void 0===o?void 0:o.entityType,entities:r};this._hostSettings.serviceSettings.ECCFeedbackSettings.onFeedbackButtonClicked(a)},this.isFlightEnabled=e=>(this._hostSettings.flightsToTrack||[]).includes(e),this.setPreloadedSuggestions=(e,t)=>{this._calloutState.setPreloadedSuggestions(this.convertNewSuggestions(e,void 0,t,void 0,!0,!0)),this.resultStatus=c.i.Success},this.handleExternalKeyboardEvents=(e,t,i)=>{if(!this._menuCurrentlyOpen)return!1;if(t)return!1;if(i&&!this._menuCurrentlyOpen.enableExpandedECC)return!1;const n=new Map([[a.m.arrowDown,ie.h.ArrowDown],[a.m.arrowUp,ie.h.ArrowUp],[a.m.arrowLeft,ie.h.ArrowLeft],[a.m.arrowRight,ie.h.ArrowRight],[a.m.home,ie.h.Home],[a.m.end,ie.h.End],[a.m.tab,ie.h.Tab],[a.m.enter,ie.h.Enter]]).get(e);return void 0!==n?(this.onUserInteraction(e),this._calloutState.keyboardHandlerTarget.onKeyPressed(n,t,i)):(this._oaLogger.logDiagnostics("[InlineSuggestionStore] unexpected keyboard event",{key:e}),!1)},this.onGroupSelected=e=>{var t,i,n,s;if(!(null===(i=null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.scopesConfig)||void 0===i?void 0:i.enabled))return;const o=e.suggestions[0],r=null==o?void 0:o.entityType,a=e.isScoped;null===(s=null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.onGroupSelected)||void 0===s||s.call(n,e);const l=!a&&r?{entityType:r,contentSources:o.GroupContentSources}:void 0;if(this.resetStateAndUpdateScope(l),!this._hostSettings.oaSettings.mockResults){const e={results:[],isLoading:!0,resultStatus:void 0,queryCorrelationKeys:this._queryCorrelationKeys?Object.assign(Object.assign({},this._queryCorrelationKeys),{scopeInfo:l}):void 0,nodeId:void 0,resultReset:!0};this._calloutState.clearQueryString(!0),this.updateState(e)}},this.onUserInteraction=e=>{const t=new Map([[a.m.arrowDown,Y.rE],[a.m.arrowUp,Y.cc],[a.m.enter,Y.hk],[a.m.tab,Y.g7],[void 0,Y.l1]]).get(e);t&&this._oaLogger.logActivity(Y.dm,void 0,[(0,w.n)("interaction",t)],this._queryCorrelationKeys)},this.getCurrentQueryString=()=>{var e;const t=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange,i=this._queryDetection.getCurrentQueryTileId(),n=t&&i&&this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(i),t)||"";return this._calloutState.searchBoxQueryString||n},this.onFirstRender=()=>{var e,t,i,n,s,o;this._oaLogger.logActivity(Y.s1,void 0,(0,w.W)(["numOfSonoraSuggestionsDisplayed",this._calloutState.suggestions.length],["numOfSonoraFileSuggestionsDisplayed",this._fileCount],["triggerCharacter",null!==(t=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange.prefix)&&void 0!==t?t:"@"],["isUserInsertion",null===(n=null===(i=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===i?void 0:i.isUserInsertion)||void 0===n||n],["source",null!==(o=null===(s=this._queryDetection.getCurrentQueryCorrelationKeys())||void 0===s?void 0:s.source)&&void 0!==o?o:""],[Y.JZ,!!this._hostSettings.enableKeptMetric],["wasOpenedViaFlag","InlineSuggestionsResultsFlagMenuType"===this._calloutState.menuType.menuType],["menuType",this._calloutState.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")])),this.handleOAMetric("InlineSuggestionRendered","add")},this.onProcessedResults=()=>{this.handleOAMetric("InlineSuggestionProcessedResults","add")},this.onRenderResults=()=>{this.handleOAMetric("InlineSuggestionResultsRendered","commit")},this.updateState=e=>{var t,i;e.results.length<1&&!(null===(t=this._menuCurrentlyOpen)||void 0===t?void 0:t.specifiedItemsToDisplay)&&!(null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.onSuggestionsUpdated)?this.updateInternalState(e,[]):(this._messageExtensionAppDataProvider?this._messageExtensionAppDataProvider.getAppDefinitionIdMap():Promise.resolve(void 0)).then((t=>{var i;const n=this.getCurrentQueryString(),s=this.convertNewSuggestions(e.results,e.queryCorrelationKeys,e.nodeId,t,e.isLocalSuggestion);this.onSuggestionsUpdated(s,n,(i=>Promise.resolve(this.convertNewSuggestions(i,e.queryCorrelationKeys,e.nodeId,t,!0))),e.resultStatus,e.isLoading,this._queryDetection.getCurrentScope(),e.resultReset,e.latency,this._calloutState.menuType,null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.supportedEntityTypes,void 0,this.logWithMenuData,e.resultSummary).then((t=>{var i;t?((null===(i=this._queryCorrelationKeys)||void 0===i?void 0:i.logicalId)&&this._oaMetric.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionUpdated"),this.updateInternalState(Object.assign(Object.assign({},e),{isLoading:!(e.isLoading&&t.length>0)&&e.isLoading,resultStatus:t.length>0?c.i.Success:e.results.length>0&&0===t.length?c.i.NoResults:e.resultStatus}),t,n)):this._calloutState.setQueryString(n)})).catch((e=>this._oaLogger.logDiagnostics(`Failed to convert suggestions: ${e}`)))})).catch((e=>this._oaLogger.logDiagnostics(`Failed to get ME app definitions: ${e}`)))},this.resetStateAndUpdateScope=e=>{var t;this.reset({scope:null==e?void 0:e.entityType,isLoading:!0,resultReset:!0,dueToScope:!0}),this._queryDetection.setCurrentScope(e);const i=this._proofingDom.findParagraphNode(this._queryDetection.getCurrentQueryTileId()||""),n=null===(t=this._queryDetection.getCurrentQuery())||void 0===t?void 0:t.queryRange;if(!i||!n)return;this._hostSettings.oaSettings&&!this._hostSettings.oaSettings.mockResults&&this._oaResultStore.updateLoadingStatus(!0),(0,he.w)(this.getServices(),n,i);const s=(0,k.q)(this._tileContent,i);if(!(null==s?void 0:s.ownerDocument.defaultView))return;const o=new m.J(s.ownerDocument.defaultView);o.addListener("focus",(e=>{e.stopPropagation(),o.removeAllListeners()}),{capture:!0,once:!0}),s.focus()},this.convertNewSuggestions=(e,t,i,n,s,o)=>{var r,a,l,c,u,g,h,p;if(e.length<1)return[];const m=[];for(const p of e){const e=[];for(const m of p.entities){const p=(this._hostSettings.flightsToTrack||[]).includes("mc-editor-enable-files-new-tidbits"),v=je(m,this.userProfilePictureCache,null===(r=this._hostSettings.userId)||void 0===r?void 0:r.userDisplayName,0===this._calloutState.queryString.length,this._localizer,null===(a=this._menuCurrentlyOpen)||void 0===a?void 0:a.newEntityTypes,n,p,null!==(c=null===(l=this._hostSettings.oaSettings)||void 0===l?void 0:l.enableConnectorGroupHeadings)&&void 0!==c&&c);if(!v)continue;v.logicalId=null==t?void 0:t.logicalId,v.nodeId=i;const y=v.type;if(!o&&(f=y,Object.values(d.c).includes(f))&&(null===(u=this._menuCurrentlyOpen)||void 0===u?void 0:u.supportedEntityTypes)&&!this._menuCurrentlyOpen.supportedEntityTypes.includes(y))continue;const _=new Date,I=v.id?null===(h=null===(g=this._menuCurrentlyOpen)||void 0===g?void 0:g.newItemsById)||void 0===h?void 0:h.get(v.id):void 0;I&&_<I&&(v.isNew=!0),(s||e.length<this.getMaxEntityCount(y,this._queryDetection.getCurrentScope()))&&e.push(v)}m.push(Object.assign(Object.assign({},p),{entities:e}))}var f;return(null===(p=this._queryCorrelationKeys)||void 0===p?void 0:p.logicalId)&&this._oaMetric.addMeasure(this._queryCorrelationKeys.logicalId,"InlineSuggestionConvertedSuggestions"),m},this._calloutState=new we(this.getServices(),A,null!=$?$:new le,this),this._searchBox=new me(this.getServices(),this._calloutState,this.wrapInClearingSearch),this._oaResultStore.setOnUpdate(this.updateState),this.reset(),this._throttleManager=new f._(null!==(Z=this._targetWindowFactory())&&void 0!==Z?Z:new x.O(window))}getResizeThrottle(){return this._resizeThrottle||(this._resizeThrottle=this._throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this._safeWindow,this.renderECC,25,"After")),this._resizeThrottle}getScrollThrottle(){var e;return this._scrollThrottle||(this._scrollThrottle=(0,v.hQ)(this._safeWindow,null!==(e=this._targetWindowFactory())&&void 0!==e?e:window,this.renderECC,"After")),this._scrollThrottle}getServices(){return{hostSettings:this._hostSettings,localizer:this._localizer,logger:this._logger,oaLogger:this._oaLogger,hostEmitter:this._hostEmitter,proofingDom:this._proofingDom,oaResultStore:this._oaResultStore,queryDetection:this._queryDetection,tileContent:this._tileContent,languageScriptDirectionDetector:this.languageScriptDirectionDetector,themeStore:this.themeStore,targetWindowFactory:this._targetWindowFactory,targetDocumentFactory:this._targetDocumentFactory}}getCurrentMenuInfo(){return this._menuCurrentlyOpen}getCalloutStateStore(){return this._calloutState}enableMenu(e){var t,i,n;const s=e.queryChar;if(this._menus.get(s))throw Error("This character is already being used for menu creation.");this._menus.set(s,Object.assign(Object.assign({},e),{shouldRemoveTextOnItemSelection:null===(t=e.shouldRemoveTextOnItemSelection)||void 0===t||t,browseThisComputerConfig:null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.browseThisComputerSettings,appGptConfig:null===(n=this._hostSettings.serviceSettings)||void 0===n?void 0:n.appGptConfig,enableExpandedECCSearchBar:e.enableExpandedECC&&void 0!==e.enableExpandedMenuSearchBar?e.enableExpandedMenuSearchBar:this.isFlightEnabled("mc-editor-enable-searchbar")})),this._queryDetection.registerQueryDetectionStartCharacter(s)}disableInlineSuggestionsMenu(e){if(!e)throw Error("You must specify a query character.");if(!this._menus.get(e))throw Error("This character is not being used for menu creation.");this._menus.delete(e),this._queryDetection.unregisterQueryDetectionStartCharacter(e),this._menuCurrentlyOpen&&this._menuCurrentlyOpen.queryRange.prefix===e&&this.dismissECC(!1)}getMenuInfo(e){return this._menus.get(e)}prepareAndRenderECC(e,t){var i,n;this._isFirstMenuUpdate=!0;const s=this._queryDetection.getCurrentQueryLogicalId();s&&this._oaMetric.addMeasure(s,"InlineSuggestionsRenderer"),this._calloutState.setQueryString(t),null===(i=this._menuEventListenersDisposal)||void 0===i||i.call(this);const o=this._calloutState.getCalloutState();return o&&(this._menuEventListenersDisposal=Ue(o,null!==(n=this._hostSettings.useFluentV9)&&void 0!==n&&n)),this.updateSpecifiedItemsToDisplay(e.id,t,!0),this.renderECC(!0),!0}navigateWithDelay(e,t){setTimeout((()=>{e(t)}),50)}getDefaultMenuInformation(){return{supportedEntityTypes:void 0,onItemSelected:()=>{},shouldRemoveTextOnItemSelection:!0,enableExpandedECCSearchBar:this.isFlightEnabled("mc-editor-enable-searchbar")}}async tryToUpdatePreloadedItems(e,t,i=!1){var n;if(!(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.getLocalItems))return void this._calloutState.clearPreloadedSuggestions();const s=this._proofingDom.findParagraphNode(t),o=e.queryRange&&this._paragraphTextExtractor.getQueryString(s,e.queryRange);if(void 0!==o){const n=await this._menuCurrentlyOpen.getLocalItems(o);i?await this.updatePreloadedItems(n,e,t):await this.updatePreloadedItemsDebounced(n,e,t)}}async updatePreloadedItems(e,t,i){var n;const s=null===(n=t.additionalData)||void 0===n?void 0:n.scopeInfo,o=new Set,r=new Set,a=new Set;for(const e of this._calloutState.preloadedSuggestions)for(const t of e.entities)t.entityId&&o.add(t.entityId),t.nodeId&&a.add(t.nodeId);for(const t of e)for(const e of t.entities)e.entityId&&r.add(e.entityId);const l=o.size===r.size&&[...o].every((e=>r.has(e))),d=a.has(i),c=0===e.length&&0!==this._calloutState.preloadedSuggestions.length;l&&d&&!c||s&&!e.some((e=>e.entityType===s.entityType))||this.setPreloadedSuggestions(e,i)}updateSpecifiedItemsToDisplay(e,t,i){var n;if(this._menuCurrentlyOpen){if(i){const e=this._menuCurrentlyOpen.getLocalItems?{isLoading:!1,resultReset:!1}:void 0;this.reset(e)}if(this._menuCurrentlyOpen.specifiedItemsToDisplay){const i=[];for(const e of this._menuCurrentlyOpen.specifiedItemsToDisplay){const n=e.entities.filter((e=>e.text.toLowerCase().includes(t.toLowerCase())));n.length>0&&i.push(Object.assign(Object.assign({},e),{entities:n}))}this._oaResultStore.updateResults(i,e,0===i.length?c.i.NoResults:c.i.Success,void 0,void 0,0===i.length?{NoResults:1}:{Success:1})}else(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.mockResults)||(i?this._oaResultStore.startNewECCMenu():this._oaResultStore.updateLoadingStatus(!0))}}getCurrentPositionInDocument(e,t){var i,n;const s=this._proofingDom.findParagraphNode(e);let o=null!==(n=null===(i=null==s?void 0:s.element)||void 0===i?void 0:i.offset)&&void 0!==n?n:0;return o+=t,o}get menuParentElement(){return this._menuCurrentlyOpen?(0,k.q)(this._tileContent,this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId)):void 0}async isKeyCursorOverParagraph(e){var t;if(!this._menuCurrentlyOpen)return!1;const i=this._menuCurrentlyOpen.queryRange.start,n=this._menuCurrentlyOpen.queryRange.start+this._menuCurrentlyOpen.queryRange.length,s=await this._tileContent.getTextSelection();return void 0!==(null==s?void 0:s.startPositionInParagraphNode)&&(null===(t=s.startParagraphNode)||void 0===t?void 0:t.id)===this._menuCurrentlyOpen.tileId&&i!==n&&(s.startPositionInParagraphNode>i&&s.startPositionInParagraphNode<n||(!(s.startPositionInParagraphNode!==i||i===n||!l.x.isKey(e,a.m.arrowRight))||!(s.startPositionInParagraphNode!==n||i===n||!l.x.isKey(e,a.m.arrowLeft))))}isAtTriggeringChar(e){return"@"===e.queryRange.prefix}getTileNode(e){const t=this._proofingDom.findParagraphNode(e);return null==t?void 0:t.parent}clearPreloadedSuggestions(){this._calloutState.clearPreloadedSuggestions()}retryQuery(){if(!this._menuCurrentlyOpen)return;const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);if(!e)return;const t=(0,M.F)(e);this._oaLogger.logActivity(Y.hG,void 0,this.getDefaultLogDataForMenu()),this._hostEmitter.emit(g.pD.oaMenuControlSignal,{address:void 0,message:{mode:u.O.UserInitiated,retry:!0,documentModel:null==t?void 0:t.documentModel}})}getDefaultLogDataForMenu(e){const t=null!=e?e:this._menuCurrentlyOpen;return t?(0,pe.G)(t,this.getServices()):[]}setAriaStatus(e,t){var i,n;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(n=null===(i=this._ariaStatusStateStoreFactory)||void 0===i?void 0:i.call(this))||void 0===n||n.setStatus(this._localizer.getMessage(e,t),"assertive",!1))}getLogDataForSuggestion(e){var t,i;return e.entityType===d.c.File?(0,w.W)(["selectedType",e.entityType],["fileType",null!==(t=e.FileExtension)&&void 0!==t?t:"Unknown"],["fileSource",e.FileSourceType]):e.entityType===d.c.Loop?(0,w.W)(["selectedType",e.entityType],["loopType",null!==(i=e.id)&&void 0!==i?i:"Unknown"]):[(0,w.n)("selectedType",e.entityType)]}setMenuCurrentlyOpen(e,t,i,n,s,o,r=!1,a=!0,l=!1,d,c,u){var g;const h=Object.assign(Object.assign({triggerCharacter:e},t),{onFooterAction:e=>{var i;this.runDefaultFooterActionIfAvailable(e)||null===(i=t.onFooterAction)||void 0===i||i.call(t,e),this.dismissECC(!1)},targetLocation:{x:0,y:0},targetOffset:s,tileId:i.id,parentTileId:i.parent.id,parentTileOffset:i.element.offset,wasOpenedInBlankTile:i.parent.plainText.length<=(null!=e?e:"@").length,parentTileType:null===(g=i.parent.textFormattingInfo)||void 0===g?void 0:g.tileType,shouldDismissOnTyping:r,shouldCalculateRemovalRange:a,menuType:o,openTime:Date.now(),queryRange:n,initialQueryStartPosition:n.start,close:()=>{this.dismissECC(!1)},getQuery:()=>{if(this._menuCurrentlyOpen){const e=this._proofingDom.findParagraphNode(this._menuCurrentlyOpen.tileId);return this._paragraphTextExtractor.getQueryString(e,this._menuCurrentlyOpen.queryRange)}},onQueryUpdated:void 0,wasOpenedViaNudge:!!this._nextMenuOpenIsViaNudge,wasOpenedViaNudgeInfo:this._nextMenuOpenIsViaNudge,keyStrokes:0,wasOpenedViaAutomaticAtMention:l,invocationSource:d});this._nextMenuOpenIsViaNudge=void 0,this._calloutState.updateCurrentMenu(h,c,u)}runDefaultFooterActionIfAvailable(e){var t,i,n,o,a,l,d;if(e===s._R.OpenEditorPane)null===(i=null===(t=this._indicatorStore)||void 0===t?void 0:t.onOpenEditorPane)||void 0===i||i.call(t,r.k.ContextualCard);else if(e===s._R.Options)null===(n=this._externalSettingsFeature)||void 0===n||n.openSettings(h.kY.dropdown);else{if(e!==s._R.Feedback)return!1;null===(a=null===(o=this.feedbackStoreFactory)||void 0===o?void 0:o.call(this))||void 0===a||a.feedbackIconClicked("",null!==(d=null===(l=this._menuCurrentlyOpen)||void 0===l?void 0:l.triggerCharacter)&&void 0!==d?d:"Unknown menu type")}return!0}buildInlineSuggestionsResultsMenuActions(e,t,i,n){var o;const r=[];switch(this._hostSettings.isFeedbackEnabledForEcc&&r.push(s._R.Feedback),this._hostSettings.showOptionsButton&&r.push(s._R.Options),e){case"flag":t&&r.push(s._R.ReadAloud),i&&r.push(s._R.IgnoreRule),this._hostSettings.ignoreAllEnabled&&r.push(s._R.IgnoreAll),this._hostSettings.ignoreOnceEnabled&&r.push(s._R.IgnoreOnce),this._paneOpenState&&(this._paneOpenState.isPaneOpen?n&&(r.push(s._R.Previous),r.push(s._R.Next)):r.push(s._R.OpenEditorPane));break;case"userInitiated":(null===(o=this._paneOpenState)||void 0===o?void 0:o.isPaneOpen)||r.push(s._R.OpenEditorPane)}return r}reset(e){var t,i,n,s;if(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.mockResults)this.resetData(),this.mockAnnotations(null==e?void 0:e.scope);else if((null===(i=this._menuCurrentlyOpen)||void 0===i?void 0:i.specifiedItemsToDisplay)||(null===(n=this._menuCurrentlyOpen)||void 0===n?void 0:n.onSuggestionsUpdated)){this.resetData(e);const t=this.getNewCorrelationKeys(),i={results:[],isLoading:void 0!==(null==e?void 0:e.isLoading)?e.isLoading:this._calloutState.isLoading,resultStatus:this.resultStatus,queryCorrelationKeys:null!==(s=this._queryCorrelationKeys)&&void 0!==s?s:t,nodeId:void 0,resultReset:void 0===(null==e?void 0:e.resultReset)||e.resultReset};this._calloutState.clearQueryString(!(null==e?void 0:e.dueToScope)),this.updateState(i)}else this.resetData(e)}resetData(e){this._fileCount=0,this.resultStatus=void 0,this._calloutState.setExplicitLoadingState(void 0===(null==e?void 0:e.isLoading)||e.isLoading,void 0===(null==e?void 0:e.resultReset)||e.resultReset),this._queryCorrelationKeys=void 0}mockAnnotations(e){var t;switch(null===(t=this._hostSettings.oaSettings)||void 0===t?void 0:t.mockResultState){case"Loading":this._calloutState.setIsLoading();break;case"NoResult":this._calloutState.setHasSuggestions([],!0,"");break;case"Error":this._calloutState.setHadUnexpectedError(),this.resultStatus=c.i.UnexpectedError;break;default:i.e("editor","high").then(i.bind(i,19061)).then((t=>{this._calloutState.setHasSuggestions(this.convertNewSuggestions(t.mockInlineSuggestions.filter((t=>!e||t.entityType===e)),void 0,void 0,void 0,!0),!0,this.getCurrentQueryString())}))}}handleOAMetric(e,t){const i=this._queryDetection.getCurrentQueryLogicalId();i&&this._queryCorrelationKeys&&("commit"===t?this._oaMetric.commitEntry:this._oaMetric.addMeasure).bind(this._oaMetric)(i,e)}getNewCorrelationKeys(){var e,t,i,n,s;const o=null===(e=this._queryDetection.getCurrentQuery())||void 0===e?void 0:e.queryRange,r=this._queryDetection.getCurrentQueryCorrelationKeys();return o&&r?Object.assign(Object.assign({},r),{isEmptyQuery:o.length===(null!==(i=null===(t=o.prefix)||void 0===t?void 0:t.length)&&void 0!==i?i:1),isTimeout:!1,queryLength:o.length-(null!==(s=null===(n=o.prefix)||void 0===n?void 0:n.length)&&void 0!==s?s:1)}):{logicalId:"",conversationId:"",isEmptyQuery:!0,queryLength:0}}_logResultStatus(e,t,i,n){const s=null!=i?i:this._guidGenerator.generate(),o=new Map([["QueryLength",this._calloutState.queryString.length.toString()]]),r=((e,t,i,n,s)=>Object.assign(Object.assign(Object.assign({Version:2,TraceId:e,LocalTime:(new Date).toISOString(),Status:t},n&&{ProviderName:n}),i&&{Latency:i}),s&&{RequestParams:s}))(s,c.i[e],t,n,o);this._oaLogger.logDiagnostics(Y.vb,r)}updateInternalState(e,t,i){var s,o,r,a,l,u,g,h,p,m,f,v,y,_,I,C,S,b,T,E,N,x,L,D,A,F,q,R,P,O,k,M,z,j,W,B,U,H,V,G,Q,K,$,J,Z,X,ee,te,ie,ne,se,oe;if(!this._menuCurrentlyOpen)return;let re,ae=t;if(this._isFirstMenuUpdate&&(null===(o=null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.scopesConfig)||void 0===o?void 0:o.enabled)&&this._hostSettings.oaSettings.scopesConfig.enableAutomaticScoping){const i=t.filter((e=>e.intent&&e.intent>0)).sort(((e,t)=>{var i,n;return(null!==(i=t.intent)&&void 0!==i?i:0)-(null!==(n=e.intent)&&void 0!==n?n:0)}))[0];i&&(void 0===i.isScopingEnabled||i.isScopingEnabled)&&(null!==(r=i.intent)&&void 0!==r?r:0)>(null!==(a=this._hostSettings.oaSettings.scopesConfig.automaticScopingIntentCutoff)&&void 0!==a?a:.9)&&(this._queryDetection.setCurrentScope({entityType:i.entityType},!1),this._oaLogger.logDiagnostics(Y.v3,{entity:i.entityType,intent:i.intent,logicalId:null===(l=e.queryCorrelationKeys)||void 0===l?void 0:l.logicalId,conversationId:null===(u=e.queryCorrelationKeys)||void 0===u?void 0:u.conversationId}),ae=t.filter((e=>e.entityType===i.entityType)))}if(this._isFirstMenuUpdate=!1,void 0!==i)re=i;else{const e=null===(g=this._queryDetection.getCurrentQuery())||void 0===g?void 0:g.queryRange,t=this._queryDetection.getCurrentQueryTileId();if(e&&t)if(this._searchBox.getIsSearchBarAvailable()&&void 0!==this._searchBox.lastComposingBoxQuery){const i=Object.assign(Object.assign({},e),{prefix:this._menuCurrentlyOpen.triggerCharacter,start:this._menuCurrentlyOpen.initialQueryStartPosition+(null!==(p=null===(h=this._menuCurrentlyOpen.triggerCharacter)||void 0===h?void 0:h.length)&&void 0!==p?p:1),length:this._searchBox.lastComposingBoxQuery.length});re=null!==(m=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),i))&&void 0!==m?m:""}else re=null!==(f=this._paragraphTextExtractor.getQueryString(this._proofingDom.findParagraphNode(t),e))&&void 0!==f?f:"";else re=""}if(e.resultStatus===c.i.NoResults||e.resultStatus===c.i.Timeout||e.resultStatus===c.i.UnexpectedError)this._logResultStatus(e.resultStatus,e.latency);else if(e.resultStatus===c.i.Success){const t=this._guidGenerator.generate(),i=ae.reduce(((e,t)=>e.concat(t.entities)),[]).filter((e=>e.providerName)).reduce(((e,t)=>{var i;const n=t.providerName;return e[n]||(e[n]=[]),e[n].push({Type:t.entityType,ReferenceId:null!==(i=t.entityId)&&void 0!==i?i:""}),e}),{});for(const[n,s]of Object.entries(i))if(this._logResultStatus(e.resultStatus,e.latency,t,n),n!==Y.CL){const i=Fe((null===(v=e.queryCorrelationKeys)||void 0===v?void 0:v.logicalId)||"",(null===(y=e.queryCorrelationKeys)||void 0===y?void 0:y.conversationId)||"",t,Y.R7,n,s);this._oaLogger.logDiagnostics(Y.AK,Object.assign({logicalId:(null===(_=e.queryCorrelationKeys)||void 0===_?void 0:_.logicalId)||""},i))}}const le=null===(I=this._queryDetection.getCurrentQuery())||void 0===I?void 0:I.queryRange;if(this._queryCorrelationKeys=Object.assign(Object.assign({},e.queryCorrelationKeys),{logicalId:null!==(S=null===(C=e.queryCorrelationKeys)||void 0===C?void 0:C.logicalId)&&void 0!==S?S:"",conversationId:null!==(T=null===(b=e.queryCorrelationKeys)||void 0===b?void 0:b.conversationId)&&void 0!==T?T:"",triggerCharacter:null!==(E=null==le?void 0:le.prefix)&&void 0!==E?E:"@",isEmptyQuery:!le||le.length===(null!==(x=null===(N=le.prefix)||void 0===N?void 0:N.length)&&void 0!==x?x:1),queryLength:le?le.length-(null!==(D=null===(L=le.prefix)||void 0===L?void 0:L.length)&&void 0!==D?D:1):0}),(null===(A=e.queryCorrelationKeys)||void 0===A?void 0:A.logicalId)&&this._oaMetric.addMeasure(e.queryCorrelationKeys.logicalId,"InlineSuggestionInternalStateUpdated"),this.resultStatus=e.resultStatus,!e.isLoading&&e.resultStatus!==c.i.UnexpectedError&&e.resultStatus!==c.i.Cancelled&&this.defaultInlineSuggestionItems)for(const e of this.defaultInlineSuggestionItems)for(const t of e(re,this._calloutState.menuType,this._menuCurrentlyOpen.triggerCharacter,this._menuCurrentlyOpen.supportedEntityTypes,this._queryCorrelationKeys.scopeInfo))ae.push(t),this.resultStatus=c.i.Success;if(this._fileCount=ae.filter((e=>e.entityType===d.c.File)).length||0,0!==ae.length||!e.isLoading){const t=ae.reduce(((e,t)=>(e[t.entityType]=t.entities.length,e.total+=e[t.entityType],e)),{total:0}),{total:i}=t,s=(0,n.__rest)(t,["total"]);this._oaLogger.logActivity(Y.OY,void 0,(0,w.W)(["numOfSonoraSuggestionsDisplayed",i],["numOfSuggestionsDisplayed",JSON.stringify(s)],["status",null!==(F=e.resultStatus)&&void 0!==F?F:-1],["responseCancelled",null!==(R=null===(q=e.resultSummary)||void 0===q?void 0:q.Cancelled)&&void 0!==R?R:0],["responseEarlyExit",null!==(O=null===(P=e.resultSummary)||void 0===P?void 0:P.EarlyExit)&&void 0!==O?O:0],["responseNoResults",null!==(M=null===(k=e.resultSummary)||void 0===k?void 0:k.NoResults)&&void 0!==M?M:0],["responseSuccess",null!==(j=null===(z=e.resultSummary)||void 0===z?void 0:z.Success)&&void 0!==j?j:0],["responseTimeout",null!==(B=null===(W=e.resultSummary)||void 0===W?void 0:W.Timeout)&&void 0!==B?B:0],["responseUnexpectedError",null!==(H=null===(U=e.resultSummary)||void 0===U?void 0:U.UnexpectedError)&&void 0!==H?H:0],["isError",this._calloutState.isError],["latency",null!==(V=e.latency)&&void 0!==V?V:-1],["triggeringChar",null!==(G=this._queryCorrelationKeys.triggerCharacter)&&void 0!==G?G:"@"],["queryLength",this._calloutState.queryString.length],["scopeType",null!==(K=null===(Q=this._queryCorrelationKeys.scopeInfo)||void 0===Q?void 0:Q.entityType)&&void 0!==K?K:""],["menuType",this._calloutState.menuType.menuType.replace("InlineSuggestions","").replace("MenuType","").replace("Results","")],["hybrid",null!==(Z=null===(J=null===($=this._hostSettings.serviceSettings)||void 0===$?void 0:$.hybridAugloop)||void 0===J?void 0:J.enabled)&&void 0!==Z&&Z]),this._queryCorrelationKeys);const o=(null===(ee=null===(X=this._hostSettings.oaSettings)||void 0===X?void 0:X.scopesConfig)||void 0===ee?void 0:ee.enabled)?{HasClickableScopeHeader:!0}:void 0;this._oaLogger.logDiagnostics(Y.Ss,((e,t,i)=>({LogicalId:e,Version:2,LocalTime:(0,Ae.k)(new Date),LayoutType:"Vertical",ResultsView:qe(t,i),PageNumber:0}))(null!==(ie=null===(te=e.queryCorrelationKeys)||void 0===te?void 0:te.logicalId)&&void 0!==ie?ie:"",this._calloutState.suggestions,o)),(null===(ne=e.queryCorrelationKeys)||void 0===ne?void 0:ne.logicalId)&&this._oaMetric.addMeasure(e.queryCorrelationKeys.logicalId,"InlineSuggestionAppendedConvertedSuggestions")}e.resultStatus===c.i.UnexpectedError||e.resultStatus===c.i.Cancelled?this._calloutState.setHadUnexpectedError():e.isLoading?this._calloutState.setExplicitLoadingState(!0,null!==(se=e.resultReset)&&void 0!==se&&se):(this._calloutState.setHasSuggestions(ae,null!==(oe=e.resultReset)&&void 0!==oe&&oe,re),this.fetchAndUpdateProfilePictureAndUpdateSuggestionsList(ae))}getMaxEntityCount(e,t){var i,n,s;const o=!!(null==t?void 0:t.entityType),r=o?null===(n=null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.scopesConfig)||void 0===n?void 0:n.maxResults:(0,y.Z$)(null===(s=this._hostSettings.oaSettings)||void 0===s?void 0:s.entitiesEnabled,e);return null!=r?r:o?5:3}async fetchAndUpdateProfilePictureAndUpdateSuggestionsList(e){const t=[];for(const i of e)t.push(...i.entities.filter((e=>e.entityType===d.c.People)));await Promise.all(t.map((async e=>{var t,i,n,s;(null===(t=this._queryCorrelationKeys)||void 0===t?void 0:t.logicalId)&&this._oaMetric.startEntry(this._queryCorrelationKeys.logicalId+e.Id,this._queryCorrelationKeys);const o=(0,Me.u)(e),r=await(null===(i=this.userProfilePictureCache)||void 0===i?void 0:i.fetchProfilePicture(o));e.imageUrl=r,r?(null===(s=this._queryCorrelationKeys)||void 0===s?void 0:s.logicalId)&&this._oaMetric.commitEntry(this._queryCorrelationKeys.logicalId+e.Id,"Success","ProfilePictureLoadingTime"):(null===(n=this._queryCorrelationKeys)||void 0===n?void 0:n.logicalId)&&this._oaMetric.commitEntry(this._queryCorrelationKeys.logicalId+e.Id,"Error","ProfilePictureLoadingTime")}))),this._calloutState.setHasSuggestions(this._calloutState.suggestions,!1,this._calloutState.queryString)}};He=(0,n.__decorate)([(0,K._)(),(0,n.__param)(0,(0,$.W)(L.n)),(0,n.__param)(1,(0,$.W)(D.m)),(0,n.__param)(2,(0,$.W)(A.g)),(0,n.__param)(3,(0,$.W)(_.G)),(0,n.__param)(4,(0,$.W)(P.u)),(0,n.__param)(5,(0,$.W)(g.M5)),(0,n.__param)(6,(0,$.W)(z.w)),(0,n.__param)(7,(0,$.W)(j.b)),(0,n.__param)(8,(0,$.W)(W.d)),(0,n.__param)(9,(0,$.W)(H.C)),(0,n.__param)(10,(0,$.W)(F.J)),(0,n.__param)(11,(0,$.W)(I.H)),(0,n.__param)(12,(0,$.W)(q.c)),(0,n.__param)(13,(0,$.W)(C.o)),(0,n.__param)(14,(0,$.W)(R.j)),(0,n.__param)(15,(0,$.W)(S.aP)),(0,n.__param)(16,(0,$.W)(ve.j)),(0,n.__param)(17,(0,$.W)(b.cg)),(0,n.__param)(18,(0,$.W)(b.Ze)),(0,n.__param)(19,(0,J.l)()),(0,n.__param)(19,(0,$.W)(V.F)),(0,n.__param)(20,(0,J.l)()),(0,n.__param)(20,(0,$.W)(X.Th)),(0,n.__param)(21,(0,J.l)()),(0,n.__param)(21,(0,$.W)(B.y)),(0,n.__param)(22,(0,J.l)()),(0,n.__param)(22,(0,$.W)(ee.J)),(0,n.__param)(23,(0,J.l)()),(0,n.__param)(23,(0,$.W)(h.In)),(0,n.__param)(24,(0,J.l)()),(0,n.__param)(24,(0,$.W)(T.f)),(0,n.__param)(25,(0,J.l)()),(0,n.__param)(25,(0,$.W)(U.g)),(0,n.__param)(26,(0,J.l)()),(0,n.__param)(26,(0,$.W)(xe.Z)),(0,n.__param)(27,(0,J.l)()),(0,n.__param)(27,(0,Z.t)(fe)),(0,n.__param)(28,(0,J.l)()),(0,n.__param)(28,(0,$.W)(te.YQ)),(0,n.__param)(29,(0,J.l)()),(0,n.__param)(29,(0,$.W)(_e.A)),(0,n.__param)(30,(0,J.l)()),(0,n.__param)(30,(0,$.W)(ye.e)),(0,n.__param)(31,(0,J.l)()),(0,n.__param)(31,(0,$.W)(E.n))],He)},639397:(e,t,i)=>{i.d(t,{y:()=>o});var n=i(379490),s=i(229906);let o=class{constructor(){this._rootNodes=[]}rootAtNodes(e){this._rootNodes=e}*getIterator(){var e;if(this._rootNodes.length){const t=[];for(t.push(...this._rootNodes);t.length;){const i=t.pop();yield i,(null===(e=null==i?void 0:i.children)||void 0===e?void 0:e.length)&&t.push(...i.children)}}yield}};o=(0,n.__decorate)([(0,s._)()],o)},642810:(e,t,i)=>{if(i.d(t,{d:()=>l}),0!=i.j)var n=i(671303);if(0!=i.j)var s=i(636734);if(0!=i.j)var o=i(511189);if(0!=i.j)var r=i(244826);if(0!=i.j)var a=i(251439);class l{get uniqueId(){return(0,a.z)(507918355)}configureRootServices(e){e.bind(n.m).to(o.h),e.bind(s.u).to(r.z)}}},643513:(e,t,i)=>{i.d(t,{r:()=>v,m:()=>f});var n=i(379490),s=i(920117),o=i(647879);const r="NumProofingLanguages";var a=i(877931),l=i(163573),d=i(825948),c=i(150099),u=i(46692),g=i(572233),h=i(668952),p=i(229906),m=i(83010);const f=(0,h.f)("IE2eMetric");let v=class{constructor(e,t,i,n){var a;this._logger=e,this._hostSettings=t,this._proofingStore=i,this._eventName="End2EndTelemetry",this._alEventName="IsAL",this._performanceApiGarbageCollectorIntervalInMs=1e4,this._logToTelemetry=e=>{const t=this._logger.getNewActivity(this._eventName,u.o.SamplingPolicy.CriticalExperimentation);if(!t)return;const i=this._proofingStore.getCachedEntry(s.l.ProofingLanguages).storeEntryValue;t.dataFields.push(...e.map((e=>(0,o.n)(e.name,e.duration,void 0,u.o.DataFieldType.Double.valueOf())))),t.dataFields.push(...(0,o.W)([this._alEventName,this._isAlEnabled],[r,i.length])),t.success=!0,t.endNow()},this._isAlEnabled=!0===this._hostSettings.enableOrchestration&&!0===(null===(a=this._hostSettings.orchestratorSettings)||void 0===a?void 0:a.enableAugLoop),this.metric=new g.J(e,n,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry)}startEntry(e){this._hostSettings.enableE2eMetric&&this.metric.startEntry(e)}addMeasure(e,t,i){this._hostSettings.enableE2eMetric&&this.metric.addMeasure(e,t,i)}commitEntry(e,t=this._eventName){this._hostSettings.enableE2eMetric&&this.metric.commitEntry(e,t)}setOnTimeout(e){this.metric.setOnTimeout(e)}};v=(0,n.__decorate)([(0,p._)(),(0,n.__param)(0,(0,m.W)(a.g)),(0,n.__param)(1,(0,m.W)(l.n)),(0,n.__param)(2,(0,m.W)(d.K)),(0,n.__param)(3,(0,m.W)(c.j))],v)},645652:(e,t,i)=>{i.d(t,{a:()=>_});var n=i(208520),s=i(252723),o=i(108520);if(0!=i.j)var r=i(225918);if(0!=i.j)var a=i(577059);if(0!=i.j)var l=i(897578);if(0!=i.j)var d=i(93659);if(0!=i.j)var c=i(318391);if(0!=i.j)var u=i(323283);var g=i(77127);if(0!=i.j)var h=i(688557);if(0!=i.j)var p=i(343154);if(0!=i.j)var m=i(564333);if(0!=i.j)var f=i(852853);const v=5e3,y=(0,s.F5)({styleStore:o.A.on(g.UC).optional(),themeStore:o.A.on(g.YQ).optional()}),_=e=>{var t,i,o,_,I,C,S,b,T,E,N;const w=n.useContext(g.O1),{styleStore:x,themeStore:L}=(0,s.KN)(y),{nudge:D,nudgeDisplayLocation:A,nudgeTargetDocumentRef:F,onAcceptNudgeAction:q,onHideNudge:R,inlineNudge:P,insertionCharacter:O}=e,k=null!==(i=null===(t=F.deref())||void 0===t?void 0:t.defaultView)&&void 0!==i?i:window,[M,z]=n.useState(null==L?void 0:L.getComponentActiveTheme(P?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName));n.useEffect((()=>{if(!L)return()=>{};const e=()=>{z(L.getComponentActiveTheme(P?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName))};return L.subscribe("currentThemeUpdated",e),L.subscribe("defaultThemeUpdated",e),L.subscribe("themesUpdated",e),()=>{L.unsubscribe("currentThemeUpdated",e),L.unsubscribe("defaultThemeUpdated",e),L.unsubscribe("themesUpdated",e)}}),[P,L]);const[j,W]=n.useState(!1),[B,U]=n.useState(!0),H=n.useRef(void 0),V=n.useCallback((e=>{k.clearTimeout(H.current),H.current=e}),[k]),G=n.useCallback(((e,t)=>{k.clearTimeout(H.current),R(e,t)}),[R,k]),Q=n.useCallback((()=>{k.clearTimeout(H.current),W(!0)}),[W,k]),K=n.useCallback((()=>{V(k.setTimeout((()=>{G("timeout 5000")}),v)),W(!1)}),[G,V,k]),$=n.useCallback((()=>q("click",!0)),[q]);n.useEffect((()=>(V(k.setTimeout((()=>{G("timeout 5000")}),v)),()=>{k.clearTimeout(H.current)})),[]);const J=n.useCallback((e=>{p.x.isKey(e,m.m.escape)?(e.stopPropagation(),e.preventDefault(),G(e.key)):p.x.isKey(e,m.m.enter)||p.x.isKey(e,m.m.backspace)?G(e.key):p.x.isKey(e,"v",void 0,!0)?G("user pasted text",!0):(p.x.isKey(e,m.m.tab)||e.key===O)&&(e.stopPropagation(),e.preventDefault(),q(e.key,!0))}),[G,O,q]),Z=n.useCallback((()=>{G("MouseDown")}),[G]),Y=n.useCallback((()=>{G("Scroll")}),[G]),X=n.useCallback((()=>{G("Resize")}),[G]);n.useEffect((()=>{const e=new u.J(F),t=new u.J(k);return e.addListener("keydown",J,{capture:!0}),e.addListener("mouseup",Z),t.addListener("resize",X),t.addListener("scroll",Y,{capture:!0}),()=>{e.removeAllListeners(),t.removeAllListeners()}}),[J,Z,Y,X,F,k]);const ee=null==x?void 0:x.getComponentStyle(P?g.yF.inlineNudgeBubbleComponentName:g.yF.nudgeBubbleComponentName),te=w?function(e){return e?{background:{resting:f.L.colorNeutralBackground5,hover:f.L.colorNeutralBackground5Hover},text:{resting:f.L.colorNeutralForeground3}}:{background:{resting:f.L.colorNeutralBackground1,hover:f.L.colorNeutralBackground1Hover},text:{resting:f.L.colorNeutralForeground1},highlight:{text:{resting:f.L.colorNeutralForeground1},background:{resting:f.L.colorNeutralBackground3,hover:f.L.colorNeutralBackground3Hover}}}}(P):M,ie=D.entityResults?(0,a.S)(null!==(_=null===(o=D.entityResults.entities[0].icon)||void 0===o?void 0:o.iconName)&&void 0!==_?_:""):void 0,ne=null!==(I=null==ee?void 0:ee.borderRadius)&&void 0!==I?I:P?4:15,se=null!==(C=null==ee?void 0:ee.fontSize)&&void 0!==C?C:"10pt",oe=null==ee?void 0:ee.fontWeight,re=null!==(S=null==ee?void 0:ee.paddingTop)&&void 0!==S?S:2,ae=null!==(b=null==ee?void 0:ee.paddingBottom)&&void 0!==b?b:2,le=null!==(T=null==ee?void 0:ee.paddingLeftRight)&&void 0!==T?T:8,de=null==ee?void 0:ee.lineHeight,ce=P?r.A.rightTopEdge:r.A.bottomCenter,ue=P?"none":null==ee?void 0:ee.boxShadow,ge=D.text.split(/(@|\/)/g),he=P?{align:"center",position:"after",offset:e=>({mainAxis:1})}:{align:"center",position:"below",offset:e=>({mainAxis:8})},pe=n.createElement("div",{style:{borderRadius:ne,display:"flex",cursor:"pointer"}},ie?n.createElement("span",{style:{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:8}},n.createElement(h.I,{type:ie,style:{width:void 0,height:void 0},primaryColor:j&&null!==(E=null==te?void 0:te.text.hover)&&void 0!==E?E:null==te?void 0:te.text.resting,fontSize:void 0})):void 0,n.createElement("span",{className:"ms-nudge-text",style:{color:j&&null!==(N=null==te?void 0:te.text.hover)&&void 0!==N?N:null==te?void 0:te.text.resting,fontSize:se,fontWeight:oe,paddingTop:re,paddingBottom:ae,paddingLeft:le,paddingRight:le,textDecoration:"none",userSelect:"none",lineHeight:de}},ge.map((e=>{var t,i,s,o;return"@"===e||"/"===e?n.createElement("span",{key:e,style:Object.assign({backgroundColor:(null==te?void 0:te.highlight)?j?te.highlight.background.hover:te.highlight.background.resting:j&&null!==(t=null==te?void 0:te.background.hover)&&void 0!==t?t:null==te?void 0:te.background.resting,color:(null==te?void 0:te.highlight)?j?te.highlight.text.hover:te.highlight.text.resting:j&&null!==(i=null==te?void 0:te.text.hover)&&void 0!==i?i:null==te?void 0:te.text.resting,paddingLeft:null===(s=null==ee?void 0:ee.highlightStyle)||void 0===s?void 0:s.paddingLeftRight,paddingRight:null===(o=null==ee?void 0:ee.highlightStyle)||void 0===o?void 0:o.paddingLeftRight},null==ee?void 0:ee.highlightStyle)},e):n.createElement("span",{key:e},e)}))));if(w||P){const e={popover:{trapFocus:!0,withArrow:!1,open:B,onOpenChange:(e,t)=>{U(t.open)},positioning:Object.assign({target:(0,d.ug)(A)},he)},surface:{className:"ms-ecc-callout",style:{padding:0,overflowY:"hidden",borderRadius:ne,backgroundColor:j?null==te?void 0:te.background.hover:null==te?void 0:te.background.resting,boxShadow:ue,cursor:"pointer"}}};return n.createElement("div",{role:"button",tabIndex:-1,onMouseOver:Q,onMouseLeave:K,onMouseUp:$,onFocus:Q,onBlur:K},n.createElement(c.v,Object.assign({},e),pe))}return n.createElement(l.U,{target:A,directionalHint:ce,isBeakVisible:!1,gapSpace:8,onMouseOver:Q,onMouseLeave:K,onMouseUp:$,style:{overflowY:"hidden"},styles:{root:{borderRadius:ne,boxShadow:ue,cursor:"pointer"},calloutMain:{borderRadius:ne,backgroundColor:j?null==te?void 0:te.background.hover:null==te?void 0:te.background.resting}}},pe)}},647879:(e,t,i)=>{if(i.d(t,{W:()=>o,n:()=>s}),0!=i.j)var n=i(46692);function s(e,t,i,s){return{name:e,value:t,dataType:(null!=s?s:"boolean"==typeof t)?n.o.DataFieldType.Boolean.valueOf():"number"==typeof t?n.o.DataFieldType.Int64.valueOf():n.o.DataFieldType.String.valueOf(),classification:null!=i?i:n.o.DataClassification.EssentialServiceMetadata}}function o(...e){return e.map((([e,t,i,n])=>s(e,t,i,n)))}},648336:(e,t,i)=>{i.d(t,{e:()=>n});const n=(0,i(668952).f)("IInlineSuggestionsCalloutSizeAndDirectionUtils")},649055:(e,t,i)=>{i.d(t,{D:()=>h});var n=i(379490),s=i(272385),o=i(786132),r=i(323283),a=i(609062),l=i(442316),d=i(980495),c=i(229906),u=i(83010),g=i(427603);let h=class extends s.${constructor(e,t){super(e,void 0,t),this.mutationObserverFactory=e,this.logger=t,this._onElementChangedEvent=e=>{const t=this.onElementChanged;t&&this._element&&t(this._element,a.Q0.Local,void 0)}}observe(e){var t;((0,o.C)(e,"HTMLInputElement")||(0,o.C)(e,"HTMLTextAreaElement")||(0,o.C)(e,"HTMLDivElement"))&&(this._element=e,null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=new r.J(e),this.eventListener.addListener("input",this._onElementChangedEvent,{passive:!0}),this.eventListener.addListener("BX-ForceReflow",this._onElementChangedEvent,{passive:!0}),this.connectMutationObserver(this._element,{attributes:!1,characterData:!1,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1}))}disconnect(e){var t;null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,super.disconnect(e),this._element=void 0}};h=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(d.V)),(0,n.__param)(1,(0,g.l)()),(0,n.__param)(1,(0,u.W)(l.g))],h)},649343:(e,t,i)=>{i.d(t,{f:()=>n});const n=(0,i(668952).f)("ISquigglerUXFactory")},652903:(e,t,i)=>{if(i.d(t,{oZ:()=>l}),0!=i.j)var n=i(146507);if(0!=i.j)var s=i(456204);if(0!=i.j)var o=i(753031);if(0!=i.j)var r=i(752061);const a=new Map([["es-419","es-MX"]]);async function l(e,t=!1){var d;const c=null!==(d=a.get(e))&&void 0!==d?d:e,u=(0,n.C)();try{return await i(946391)(`./${c.toLowerCase()}.json`)}catch(i){try{if(!t){const t=e.split("-")[0];if(t in r.Y){const e=r.Y[t];return l(Array.isArray(e)?e[0]:e,!0)}}u.logEvent(0,"Diagnostics",s.h.Undefined,o.q.Error,`Failed to load categories strings for locale ${e} from localization file dynamically: ${i}`,void 0,void 0,void 0,"Text_Message")}catch(t){u.logEvent(0,"Diagnostics",s.h.Undefined,o.q.Error,`Failed to load neutral categories strings for locale ${e} from localization file dynamically: ${i}`,void 0,void 0,void 0,"Text_Message")}return}}},653196:(e,t,i)=>{if(i.d(t,{a:()=>s}),0!=i.j)var n=i(507385);class s{constructor(){this.logGroupName="EditorBx",this.tenant={tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},this.defaultEventName=n.M.Diagnostics,this.logToConsole=!1,this.logToKusto=!0}}},656288:(e,t,i)=>{if(i.d(t,{r:()=>d}),0!=i.j)var n=i(222139);if(0!=i.j)var s=i(168492);if(0!=i.j)var o=i(515599);if(0!=i.j)var r=i(93469);if(0!=i.j)var a=i(262185);if(0!=i.j)var l=i(863307);class d{constructor(e,t=[]){this.hostAppCiqConfig=e,this.dataSources=t,this.dataSourcesPerName=this.dataSources.reduce(((e,t)=>(e[t.sourceName]=t,e)),{})}init(){return this.dataSources.map((e=>e.init()))}getSuggestionGroups(e){const t=(0,l._v)();t.debug(505484567,"getSuggestionGroups",e);const i=this.getDataSources(e);return t.logDiagnostics(`Getting suggestions from ${i.length} data sources`,i.map((e=>e.sourceName))),i.map((t=>{var i,r,l,d,c;const u=null===(l=null===(r=null===(i=this.hostAppCiqConfig.dataSourcesConfig)||void 0===i?void 0:i.dataSourcesSettings)||void 0===r?void 0:r[t.sourceName])||void 0===l?void 0:l.timeoutMs,g=null===(d=this.hostAppCiqConfig.dataSourcesConfig)||void 0===d?void 0:d.globalDataSourceTimeoutMs,h=null!==(c=null!=u?u:g)&&void 0!==c?c:n.z;return(0,a.CT)(e.logicalId,{lastDataSourceName:t.sourceName}),(0,s.Lu)(t.getEntities(e),h,new o.p(`Timeout after ${h}ms`,t,"DataSourcePromiseClientTimeout"),new o.p("Promise failed to resolve",t,"DataSourcePromiseRejected"))}))}async dispose(){const e=this.dataSources.map((e=>e.dispose()));await Promise.all(e)}getDataSources(e){if(!e.triggerKey)return this.dataSources;const t=this.hostAppCiqConfig.triggerConfigs.find((({trigger:t})=>(0,r.DH)(t)===e.triggerKey));if(!t)return this.dataSources;const{entityTypes:i}=t;return Array.from(i.reduce(((e,{sources:t})=>{for(const i of t){const t=this.dataSourcesPerName[i];t&&e.add(t)}return e}),new Set))}}},657338:(e,t,i)=>{i.d(t,{A:()=>n});const n=(0,i(668952).f)("IUserProfilePictureCache")},658821:(e,t,i)=>{if(i.r(t),i.d(t,{CritiqueCallout:()=>n.r,CritiqueCalloutStateStore:()=>s.b,FOOTER_FRE_PAGE_ID:()=>l.Id,FocusZoneId:()=>o.u,FooterFre:()=>u.b,FooterFreModule:()=>f.B,FooterFreStore:()=>c.o,IPredictionStateStore:()=>C.Tc,InlineSuggestions:()=>h.V,InlineSuggestionsCalloutPortal:()=>p.b,InlineSuggestionsWebUXModule:()=>v.Q,InlineSuggestionsWithCallout:()=>m.$,InsertionPredictionStateStore:()=>S.l,LanguageAutoDetectionFRE:()=>d.a,LanguageAutoDetectionFRECallout:()=>l.sy,LayeredPrediction:()=>b.q,LayeredPredictionStateStore:()=>T.O,MultilingualFre:()=>_.R,MultilingualFreStore:()=>I.S,NudgeCallout:()=>E._,PredictionCoreModule:()=>y.B,PredictionDismissalReason:()=>C.R8,UndoCallout:()=>r.$,UndoCalloutStateStore:()=>a.f,UndoQuerySelectorClass:()=>a.g,critiqueCalloutDeps:()=>n.h,getEccUxReplacement:()=>g.Nt,getEccUxReplacementUX:()=>g.cu,langAutoDetectFooterId:()=>l.lP,undoCalloutDeps:()=>r.v}),0!=i.j)var n=i(715618);if(0!=i.j)var s=i(893533);if(0!=i.j)var o=i(242739);if(0!=i.j)var r=i(157165);if(0!=i.j)var a=i(218679);if(0!=i.j)var l=i(455115);if(0!=i.j)var d=i(290719);if(0!=i.j)var c=i(387985);if(0!=i.j)var u=i(496174);if(0!=i.j)var g=i(992271);if(0!=i.j)var h=i(896761);if(0!=i.j)var p=i(303043);if(0!=i.j)var m=i(11653);if(0!=i.j)var f=i(402817);if(0!=i.j)var v=i(638590);if(0!=i.j)var y=i(416697);if(0!=i.j)var _=i(246886);if(0!=i.j)var I=i(268809);if(0!=i.j)var C=i(811861);if(0!=i.j)var S=i(760279);if(0!=i.j)var b=i(189929);if(0!=i.j)var T=i(203907);if(0!=i.j)var E=i(545208)},659175:(e,t,i)=>{i.d(t,{B:()=>h,a:()=>a});var n=i(379490),s=i(229906),o=i(909113);const r=new Set(["¡","¦","§","©","«","¬","®","°","±","»","¿","×","÷","ǃ",";"," ","‰","‹","›","‼","‽","⁈","⁉","⁠","℃","℅","℆","℉","№","™","∑","−","√","∞","∫","≈","≠","≤","≥","□","▪","▫","◊","●","◦","❢","。","\ufeff","！","．","；","？","｡"]);let a=class{constructor(){this.supportsBrowserWordBreaking=!1}getForwardBreakByWord(e,t){let i=this.getForwardBreak(e,t);return"WhiteSpace"===(null==i?void 0:i.wordBreakType)&&(i=this.getForwardBreak(e,i.cp)),i?i.cp:e.length}getBackwardBreakByWord(e,t){let i=this.getBackwardBreak(e,t);return"WhiteSpace"===(null==i?void 0:i.wordBreakType)&&(i=this.getBackwardBreak(e,i.cp)),i?i.cp:0}getForwardBreak(e,t){return this.getForwardBreakInternal(e,t,e.length)}getBackwardBreak(e,t){if(t<=1)return;let i=t;for(;i>0;){const t=d(e,i-1);switch(t){case"Undetermined":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(i<=1)return;const n=i-1,s=d(e,n-1);if(t!==s&&l(t,s)&&("Undetermined"!==s||!this.supportsBrowserWordBreaking))return{cp:n,wordBreakType:t};break}}i-=1}}getTextStartWordBreak(e){return this.getTextWordBreak(e,0)}getTextWordBreak(e,t){return{cp:t,wordBreakType:d(e,t)}}getBreaks(e){const t=this.getBreaksForRange(e,0,e.length);return e.length&&t.splice(0,0,this.getTextStartWordBreak(e)),t}getBreaksForRange(e,t,i){const n=[];if(!e)return n;let s,o=t;do{s&&(n.push(s),o=s.cp),s=this.getForwardBreakInternal(e,o,i)}while(s);return n}getWordCount(e,t){return this.getWordCountFromWordBreaks(e,t).wordCount}getWordCountInRange(e,t,i){return this.getWordCountAndBreaksInRange(e,t,i).wordCount}getWordCountAndBreaksInRange(e,t,i){const n=this.getBreaksForRange(e,t,i);return n.splice(0,0,this.getTextWordBreak(e,t)),{wordCount:this.getWordCount(n,e),wordBreaks:n}}getWordCountWithBoundariesAndBreaksInRange(e,t,i){const n=this.getBreaksForRange(e,t,i);n.splice(0,0,this.getTextWordBreak(e,t));const s=this.getWordCountFromWordBreaks(n,e);return{wordCount:s.wordCount,wordBoundaries:s.wordBoundaries,wordBreaks:n}}getWordCountFromWordBreaks(e,t){const i={browserWordBreakCount:0,wordCount:0,wordBoundaries:[]};let n;for(let s=0;s<e.length;s+=1){const o=e[s];"AlphaNumeric"===o.wordBreakType||"Undetermined"===o.wordBreakType?("Undetermined"===o.wordBreakType&&(i.browserWordBreakCount+=1),c(s,e,t)&&(i.wordCount+=1,n=o.cp)):(void 0!==n&&(i.wordBoundaries.push({start:n,end:o.cp-1}),n=void 0),"Punctuation"!==o.wordBreakType&&"PuncuationWithoutBreak"!==o.wordBreakType||!u(s,e,t)||(i.wordCount+=1))}return void 0!==n&&i.wordBoundaries.push({start:n,end:t.length-1}),i}getForwardBreakInternal(e,t,i){if(t>=i-1)return;let n=t;for(;n<i;){const t=d(e,n);switch(t){case"Undetermined":case"Ignore":break;case"AlphaNumeric":case"Punctuation":case"WhiteSpace":case"PuncuationWithoutBreak":case"FootnoteEndnotePunctuation":{if(n>=i-1)return;let s=n+1,o=d(e,s);for(;"Ignore"===o;){if(s+=1,s>=i)return;o=d(e,s)}if(t!==o&&l(t,o)&&("Undetermined"!==o||!this.supportsBrowserWordBreaking))return{cp:s,wordBreakType:o};break}}n+=1}}};function l(e,t){return"PuncuationWithoutBreak"===e&&"AlphaNumeric"!==t||"AlphaNumeric"===e&&"PuncuationWithoutBreak"!==t||("Punctuation"===e||"FootnoteEndnotePunctuation"===e)||"WhiteSpace"===e}function d(e,t){const i=e.charAt(t).toString();return o.Fc(i)?"AlphaNumeric":function(e){const t=e.charCodeAt(0);return t>=0&&t<=31||32===t||t>=127&&t<=159||160===t||t>=8192&&t<=8202||8239===t||8287===t||9248===t||t>=9250&&t<=9252||12288===t||65282===t}(i)?"WhiteSpace":h(i)?"Punctuation":function(e){return"'"===e||"‘"===e||"’"===e}(i)?"PuncuationWithoutBreak":function(e){return""===e}(i)?"FootnoteEndnotePunctuation":function(e){return"​"===e||"‌"===e}(i)?"Ignore":"Undetermined"}function c(e,t,i){if(!e)return!0;const n=t[e];if(!n.cp)return!0;const s=t[e-1];let o=!0;if("Punctuation"===s.wordBreakType){let e=!1;for(let t=s.cp;t<n.cp;t+=1){const n=i.charAt(t);if("-"===n){if(e)return!0;e=!0}else e=!1;if(o=g(n),o)return!0}}else if("Undetermined"===s.wordBreakType)return!1;return("Undetermined"!==n.wordBreakType||"WhiteSpace"===s.wordBreakType)&&o}function u(e,t,i){const n=t[e];if(g(i.charAt(n.cp)))return!1;if(!e)return!0;if(!n.cp)return!1;const s=t[e-1];return"WhiteSpace"===s.wordBreakType||"FootnoteEndnotePunctuation"===s.wordBreakType}function g(e){return"–"===e||"—"===e}function h(e){return!!r.has(e)||(e>="!"&&e<="$"||e>="("&&e<="/"||e>=":"&&e<="@"||e>="["&&e<="`"||e>="{"&&e<="~"||e>="‒"&&e<="―"||e>="‚"&&e<="•"||e>="․"&&e<="…"||e>="☹ "&&e<="☻"||e>="〝 "&&e<="〟")}a=(0,n.__decorate)([(0,s._)()],a)},659506:(e,t,i)=>{if(i.d(t,{G:()=>r,N:()=>a}),0!=i.j)var n=i(208171);if(0!=i.j)var s=i(227710);var o=i(208520);function r(){const e=a();if(!e)throw new Error("No Injector context available");return e}function a(){const e=(0,o.useContext)(n.r),t=(0,o.useContext)(s.S),i=null!=e?e:t;return null==i?void 0:i.container}},660458:(e,t,i)=>{i.d(t,{c:()=>l});var n=i(379490),s=i(163573),o=i(229906),r=i(83010),a=i(70303);let l=class{constructor(e){this.baseSafeWindow=new a.z(e)}async initialize(){await this.baseSafeWindow.initialize()}shutDown(){this.baseSafeWindow.shutDown()}requestAnimationFrame(e,t=window){return this.baseSafeWindow.requestAnimationFrame(e,t)}cancelAnimationFrame(e,t=window){this.baseSafeWindow.cancelAnimationFrame(e,t)}requestIdleCallback(e,t,i=window){return this.baseSafeWindow.requestIdleCallback(e,t,i)}cancelIdleCallback(e,t=window){this.baseSafeWindow.cancelIdleCallback(e,t)}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.n))],l)},665014:(e,t,i)=>{if(i.d(t,{z:()=>s}),0!=i.j)var n=i(67573);function s(e){return 0===e?o:{notificationOnly:!1,delete:0!==(e&n.lb.Delete),ignore:0!==(e&n.lb.Ignore),ignoreAll:0!==(e&n.lb.IgnoreAll),ignoreCritiqueType:0!==(e&n.lb.IgnoreCritiqueType),addToDictionary:0!==(e&n.lb.AddToDictionary),showDetails:0!==(e&n.lb.ShowDetails)}}const o={notificationOnly:!0,delete:!1,ignore:!1,ignoreAll:!1,ignoreCritiqueType:!1,addToDictionary:!1,showDetails:!1}},665238:(e,t,i)=>{i.d(t,{C:()=>N,p:()=>w});var n=i(379490),s=i(67573),o=i(647879),r=i(331408),a=i(163573),l=i(877931),d=i(576516),c=i(823325),u=i(537969),g=i(756857),h=i(279e3),p=i(937126),m=i(826663),f=i(392632),v=i(538045),y=i(955377),_=i(157698),I=i(104072),C=i(965285),S=i(229906),b=i(66008),T=i(83010),E=i(427603);let N=class extends C.H{constructor(e,t,i,n,r,a,l,u,g,h,p){super(e,t,i,n,a,l,u,p),this._localizer=r,this._paragraphTextExtractor=g,this._tileContent=h,this.onFlagAnnotationUpdate=e=>{var t,i,n;const o=e.message.messageType,r=e.message.data;if(w(this._hostSettings))if(o===c.G.NewData&&r.results.length>0){const n=r.results.filter((e=>e.results.length>0&&e.results[0].entityType===d.c.People)),o=[];for(const e of n){const n=[];for(const t of e.results){if(!t.DisplayName)continue;const e=["JobTitle","Company","Department","OfficeLocation"],i=t;i.PropertyHits&&e.includes(i.PropertyHits[0])?n.push(Object.assign(Object.assign({},t),{subtitlePropertyOverride:i.PropertyHits[0]})):n.push(t)}const a={entities:n,entityType:d.c.People,groupTitle:this._localizer.getMessage("peopleEntityLabel")},l=this._paragraphTextExtractor.getParagraphText(r.tileId),c=null!==(t=e.context)&&void 0!==t?t:null==l?void 0:l.substring(e.range.start,e.range.start+e.range.length),u=r.annotationId+(null===(i=e.M_)||void 0===i?void 0:i.seq);if(this._annotationIdMap){let e=this._annotationIdMap.get(r.annotationId);e||(e=new Set),e.add(u)}c&&o.push({annotationId:u,traceId:u,languageId:e.language,nodeId:r.tileId,nodeVersion:r.tileVersion,textInContext:c,start:e.range.start,length:e.range.length,supportedActions:s.lb.Ignore,supportedEntityTypes:[d.c.People],suggestionItems:0===n.length?void 0:[a],additionalData:e,groupTitle:this._localizer.getMessage("ebx_CIQFlagInsertTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagInsertSubtitle"),tooltipTitle:this._localizer.getMessage("ebx_CIQFlagPeopleTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_PersonEntityRecognitionCategoryTitle")})}this.addFlags(e.address,o)}else if(o===c.G.RemoveData){const t=null===(n=this._annotationIdMap)||void 0===n?void 0:n.get(r.annotationId);if(t){const i=[...t];for(const t of i)this.removeFlag(e.address,t)}else this.removeFlag(e.address,r.annotationId)}},this.onApplyFlag=(e,t,i,n)=>{var s,r;if(!t.annotationId)return;const a=this._annotationMap.get(t.annotationId);if(a&&(this._annotationMap.delete(t.annotationId),null===(r=null===(s=this._hostSettings.serviceSettings)||void 0===s?void 0:s.flagAnnotationSettings)||void 0===r?void 0:r.flagInsertionCallback)){const s=a.additionalData.replacementRange;if(s){const n=s.start-a.additionalData.range.start,r=t.start+n;this._tileContent.getRangeOfNode(e.parent,void 0,e.element.offset+r,s.length).then((n=>{if(!n)return void this._logger.logDiagnostics("Unable to find replacement flag range",void 0,(0,o.W)(["FlagTypeId",a.critique.typeId],["Start",a.additionalData.range.start],["Length",a.additionalData.range.length],["ReplacementStart",s.start],["ReplacementLength",s.length],["InTextReplacementStart",r]));const l=Object.assign(Object.assign({},t),{start:r,length:s.length});this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,l)})).catch((e=>{this._logger.logDiagnostics("Unable to find replacement flag range",void 0,(0,o.W)(["Exception",e],["FlagTypeID",a.critique.typeId],["Start",a.additionalData.range.start],["Length",a.additionalData.range.length],["ReplacementStart",s.start],["ReplacementLength",s.length],["InTextReplacementStart",r]))}))}else this._hostSettings.serviceSettings.flagAnnotationSettings.flagInsertionCallback(i,n,e.parent.element,i,t)}},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{},this._annotationIdMap=new Map}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(u.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return r.L9.CIQFlag_PersonEntityRecognition}};function w(e){var t,i;return(0,f.i$)(null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,d.c.People)}N=(0,n.__decorate)([(0,S._)(),(0,n.__param)(0,(0,b.t)(u.zJ)),(0,n.__param)(1,(0,T.W)(a.n)),(0,n.__param)(2,(0,T.W)(v.w)),(0,n.__param)(3,(0,T.W)(l.g)),(0,n.__param)(4,(0,T.W)(g.H)),(0,n.__param)(5,(0,T.W)(h.$)),(0,n.__param)(6,(0,T.W)(y.W)),(0,n.__param)(6,(0,E.l)()),(0,n.__param)(7,(0,T.W)(p.f)),(0,n.__param)(8,(0,T.W)(_.b)),(0,n.__param)(9,(0,T.W)(I.d)),(0,n.__param)(10,(0,E.l)()),(0,n.__param)(10,(0,T.W)(m.K))],N)},665850:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"જોડણી"}}')},667018:(e,t,i)=>{i.d(t,{D:()=>n});class n{constructor(e){this.element=e}retrieve(){return{content:this.element.value}}}},667288:(e,t,i)=>{i.d(t,{V:()=>n});const n=(0,i(668952).f)("IElementsRetriever")},667603:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Orfoqrafiya","IsImplemented":true}}')},668621:(e,t,i)=>{i.d(t,{L:()=>d});var n=i(379490),s=i(323283),o=i(615930),r=i(229906),a=i(83010),l=i(427603);let d=class{constructor(e){this.targetWindowFactory=e,this.isComposing=!1,this._isInitalized=!1}async initialize(){var e,t;this._isInitalized||(this._windowEventListener=new s.J(null!==(t=null===(e=this.targetWindowFactory)||void 0===e?void 0:e.call(this))&&void 0!==t?t:window),this._windowEventListener.addListener("compositionstart",this.onCompositionStart),this._windowEventListener.addListener("compositionend",this.onCompositionEnd),this._isInitalized=!0)}shutDown(){var e;null===(e=this._windowEventListener)||void 0===e||e.removeAllListeners(),this._windowEventListener=void 0,this._isInitalized=!1}onCompositionStart(){this.isComposing=!0}onCompositionEnd(){this.isComposing=!1}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(o.cg)),(0,n.__param)(0,(0,l.l)())],d)},668952:(e,t,i)=>{function n(e){return Symbol.for(e)}i.d(t,{f:()=>n})},669332:(e,t,i)=>{function n(e){return"autocorrection"===e||"personalized-autocorrection"===e}i.d(t,{k:()=>n})},671303:(e,t,i)=>{i.d(t,{m:()=>n});const n=(0,i(668952).f)("IOaLogger")},672933:(e,t,i)=>{i.d(t,{C:()=>s});var n=i(668952);(0,n.f)("ICategoryLocalization");const s=(0,n.f)("ICategoryLocalizationSlim")},674541:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concisão","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Escritura coerente"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Linguagem inclusiva","IsImplemented":true},"Typing errors":{"LocalizedName":"Erros de digitação","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":"Clareza"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Reescrita"},"Error Corrections":{"LocalizedName":"Correção de erros","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"Escolha vocabular"},"Grammar":{"IsImplemented":true,"LocalizedName":"Gramática"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"Linguagem formal"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Pontuação"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Normas de escrita"},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Currículo"},"Sensitive Geopolitical References":{"LocalizedName":"Referências geopolíticas delicadas","IsImplemented":false}}')},676804:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Sillafu"}}')},676959:(e,t,i)=>{if(i.d(t,{S:()=>o}),0!=i.j)var n=i(379490);if(0!=i.j)var s=i(877310);function o(e){const{text:t,action:i,languages:o,metadataJSON:r,description:a}=e,l=(0,n.__rest)(e,["text","action","languages","metadataJSON","description"]);return Object.assign({text:t,action:(0,s.fO)(i),languages:o,metadataJSON:r,description:a},l)}},681156:(e,t,i)=>{if(i.d(t,{H:()=>o}),0!=i.j)var n=i(331408);if(0!=i.j)var s=i(186438);function o(e,t,i){switch(e.priority){case n.bx.High:return(0,s.MG)(e)&&t&&"critique"!==i?"AutoCorrectSquiggle":"SpellingSquiggle";case n.bx.Medium:return"GrammarSquiggle";case n.bx.Low:return"AdvancedSquiggle";case n.bx.Informational:return e.typeId===n.L9.HeadingDetection?"HeadingDetectionSquiggle":"CIQFlagSquiggle";default:return"UnknownSquiggle"}}},687267:(e,t,i)=>{i.d(t,{m:()=>r});var n=i(208520);if(0!=i.j)var s=i(906686);if(0!=i.j)var o=i(380737);const r=e=>{const{top:t,left:i,width:r,height:a}=e.data.clientRect,l=e.isVisible?void 0:"none";return n.createElement(n.Fragment,null,n.createElement(s.z,{anchor:e.anchor,disableCalloutOnDoubleClick:e.disableCalloutOnDoubleClick,element:e.element,isCaretOver:e.isCaretOver,isMouseOver:e.isMouseOver,handleContextMenuEvent:e.handleContextMenuEvent,isCalloutOpened:e.isCalloutOpened,openCalloutPredicate:e.openCalloutPredicate,onKeyboardEvent:e.onKeyboardEvent,onClick:e.onClick,onContextMenuClick:e.onContextMenuClick,closeCalloutOnNonLeftClick:e.closeCalloutOnNonLeftClick,onRightClickEvent:e.onRightClickEvent,onEscapePress:e.onEscapePress}),n.createElement("span",{role:e.role,"aria-live":e.ariaLive,"aria-label":e.ariaLabel,"aria-describedby":e.describedBy,ref:e.squiggleRef,className:e.className,style:{top:t,left:i,width:r,height:a,zIndex:e.data.zIndex,display:l,opacity:e.opacity}}),e.useSvgUnderline&&n.createElement(o.a,{width:r,left:i,squiggleHeight:t+a,patternName:e.patternName,className:e.className,styleOverrides:{display:l,opacity:e.opacity}}))}},689282:(e,t,i)=>{if(i.d(t,{w:()=>u}),0!=i.j)var n=i(287704);if(0!=i.j)var s=i(296690);if(0!=i.j)var o=i(901163);if(0!=i.j)var r=i(667018);if(0!=i.j)var a=i(999358);if(0!=i.j)var l=i(660458);if(0!=i.j)var d=i(786132);if(0!=i.j)var c=i(502653);class u{constructor(e){this.params=e,this._disposed=!1;const t=new n.Q,i=new s.g(this.getTextRetriever,t);this._safeWindow=new l.c((0,c.m1)()),this._textWriterInternal=new o.M(i,this._safeWindow)}get disposed(){return this._disposed}async dispose(){this._disposed||(await this._textWriterInternal.dispose(),this._safeWindow.shutDown(),this._disposed=!0)}async insert(e){var t,i,n,s;this.setElement(e)&&await this._textWriterInternal.insert(e.start,e.text,null!==(i=null===(t=this.params.settings)||void 0===t?void 0:t.preferPriorPositionForInsert)&&void 0!==i&&i,e.range,null===(n=this.params.settings)||void 0===n?void 0:n.keepSelectionPosition,null===(s=this.params.settings)||void 0===s?void 0:s.waitForAnimationFrame)}async replace(e){this.setElement(e)&&await this._textWriterInternal.replace(e.start,e.length,e.text,e.range)}async autoCorrect(e){if(this.setElement(e))return this._textWriterInternal.autoCorrect(e.start,e.length,e.text,e.range,!0)}async remove(e){var t,i,n;if(this.setElement(e))return this._textWriterInternal.remove(e.start,e.length,e.range,null===(t=this.params.settings)||void 0===t?void 0:t.keepSelectionPosition,null===(i=this.params.settings)||void 0===i?void 0:i.waitForAnimationFrame,null===(n=this.params.settings)||void 0===n?void 0:n.includePrecedingSpaceOnRemoval)}getTextRetriever(e){return(0,d.C)(e,"HTMLInputElement")||(0,d.C)(e,"HTMLTextAreaElement")?new r.D(e):new a.x(e)}setElement(e){const{elementManager:t}=this.params,i=t.getElementById(e.elementId);return!!i&&(this._textWriterInternal.setHtmlElement(i),!0)}}},689795:(e,t,i)=>{i.d(t,{M:()=>L});var n=i(379490),s=(i(220029),i(208520)),o=i(794329),r=i(897253),a=i(322483),l=i(404741),d=i(615930),c=i(184226),u=i(852748),g=i(323283),h=i(938351),p=i(877931),m=i(163573),f=i(829088),v=i(363160),y=i(78737),_=i(492768),I=i(842137),C=i(817596);class S{constructor(e){var t,i,n;this.injector=e,this.render=()=>{var e,t;const i=this.injector.container.get(p.g),n=s.createElement(a.t,{errorEventName:l.s.UnhandledContentError,logger:i,maxRecoveryRetry:10,errorMessage:"Unhandled render content script error"},s.createElement(y.U,{injector:this.injector},s.createElement(r.q,null))),o=null!==(t=null===(e=this.editorCardShadowRoot)||void 0===e?void 0:e.firstElementChild)&&void 0!==t?t:this.editorCard;(0,C.d)(o,n)},this.onWindowUnload=()=>{try{this.shutDown()}catch(e){}};const o=this.injector.container.get(m.n);this.targetDocument=null!==(t=this.injector.container.getOptional(d.jh))&&void 0!==t?t:new f.O(document);const u=this.injector.container.getOptional(c.iw),g=this.targetDocument.deref();g&&(this.editorCard=g.createElement("editor-card"),this.editorCard.setAttribute("style",`position:absolute;top:0px;left:0px;z-index:${null!==(i=o.editorCardZIndex)&&void 0!==i?i:"auto"};display: block !important`),u&&this.editorCard.setAttribute("dir",u.dir()),g.body.appendChild(this.editorCard),this.editorCardShadowRoot=o.renderWithinShadowDOM&&g!==document?this.editorCard.attachShadow({mode:"open"}):void 0,this.editorCardShadowRoot&&(this.editorCardShadowRoot.appendChild(document.createElement("div")),(null===(n=o.disposalSettings)||void 0===n?void 0:n.enableReactEventCleanup)&&(this.reactEventCleanup=new v.s(this.editorCardShadowRoot))))}async initialize(){var e;if(!this.targetDocument||!this.editorCard)return;const t=this.targetDocument.deref();if(!t)return;const i=this.injector.container.get(p.g);i.debug(520984577,"[ReactApp] Render main app view");const n=this.injector.container.get(m.n);if(this.editorCardShadowRoot||!n.disableStyleCopying&&t!==document){const i=this.injector.container.get(u.G);this.disposal=n.enablePersistentStyleCopying?(0,_.wn)(t,i):(0,I.WH)(null!==(e=this.editorCardShadowRoot)&&void 0!==e?e:t.head)}window.frameElement&&(this.windowEventListener=new g.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnload,{once:!0})),this.injector.container.bind(d.q4).toValue(new h.l(this.editorCard,i,"Target render element ref is unavailable")),this.reactEventCleanup?this.reactEventCleanup.render(this.render):this.render()}shutDown(){var e,t,i,n,s,r;try{null===(e=this.disposal)||void 0===e||e.call(this)}catch(e){}if(this.editorCard)try{o.unmountComponentAtNode(null!==(i=null===(t=this.editorCardShadowRoot)||void 0===t?void 0:t.firstElementChild)&&void 0!==i?i:this.editorCard)}catch(e){}null===(n=this.reactEventCleanup)||void 0===n||n.cleanup(),this.reactEventCleanup=void 0,null===(s=this.windowEventListener)||void 0===s||s.removeAllListeners(),this.windowEventListener=void 0,this.disposal=void 0,null===(r=this.editorCard)||void 0===r||r.remove(),this.editorCard=void 0,this.editorCardShadowRoot=void 0,this.targetDocument=void 0}}var b=i(771588),T=i(105815),E=i(229906),N=i(83010),w=i(227710);let x=class{constructor(e){this._injector=e,this._initialized=!1,this._shutDown=!1}async initializeComponent(){if(this._initialized)return;this._initialized=!0;const e=this._injector.container.getOptional(T.K);if(e){const t=e.map((e=>e())),i=await Promise.all(t);for(const e of i)if(Array.isArray(e))for(const t of e)this._injector.addModule(t);else this._injector.addModule(e);await this._injector.container.get(b.V).recheckRegistrables(this._injector.container)}this._shutDown||(this.reactApp=await this.loadReactApp(),this._shutDown?this.reactApp.shutDown():await this.reactApp.initialize())}shutDown(){var e;this._shutDown=!0,null===(e=this.reactApp)||void 0===e||e.shutDown(),this.reactApp=void 0}};x=(0,n.__decorate)([(0,E._)(),(0,n.__param)(0,(0,N.W)(w.J))],x);let L=class extends x{async loadReactApp(){return new S(this._injector)}};L=(0,n.__decorate)([(0,E._)()],L)},689878:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(668952).f)("IStoreEntryWriter")},691474:(e,t,i)=>{i.d(t,{E:()=>n});const n=(0,i(668952).f)("ISettingsEmitterBase")},692551:(e,t,i)=>{i.d(t,{L:()=>r});var n=i(379490),s=i(229906),o=i(507628);let r=class{generate(){return(0,o.A)()}};r=(0,n.__decorate)([(0,s._)()],r)},693059:(e,t,i)=>{i.d(t,{X:()=>o});var n=i(189784),s=i(208520);const o=s.memo((e=>{const{prediction:t}=e;return s.createElement(n.I,Object.assign({},e,{showDropdownChevron:t.entityResults.entities.length>1}))}))},694069:(e,t,i)=>{i.d(t,{r:()=>g});var n=i(379490),s=i(753031),o=i(46692),r=i(383714),a=i(229906),l=i(83010),d=i(838641),c=i(439550),u=i(245645);let g=class extends u.b{constructor(e,t){super(e),this._logger=t}async write(e,t){try{let i=!1;const n=await this._extensionStorage.get(e.name);if(n[e.name]){i=JSON.parse(n[e.name]).manualOverride}i?this._logger.logEvent(521479641,d.s.SettingManualOverrideWarning,s.q.Warn,`manual override for store entry ${e.name} - writing skipped`,o.o.SamplingPolicy.Measure):await this.writeSetting(e.name,t)}catch(e){this._logger.logEvent(521479640,d.s.SettingWriteError,s.q.Error,void 0,o.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async remove(e){await this._extensionStorage.remove(e)}};g=(0,n.__decorate)([(0,a._)(),(0,n.__param)(0,(0,l.W)(c.D)),(0,n.__param)(1,(0,l.W)(r.g))],g)},695071:(e,t,i)=>{if(i.d(t,{y:()=>v}),0!=i.j)var n=i(850282);if(0!=i.j)var s=i(61971);if(0!=i.j)var o=i(17384);if(0!=i.j)var r=i(715618);if(0!=i.j)var a=i(893533);if(0!=i.j)var l=i(828833);if(0!=i.j)var d=i(341755);if(0!=i.j)var c=i(331929);if(0!=i.j)var u=i(541471);if(0!=i.j)var g=i(163573);if(0!=i.j)var h=i(251439);if(0!=i.j)var p=i(386675);var m=i(77127);if(0!=i.j)var f=i(512578);class v{constructor(){this.imports=[n.E,f.h]}get uniqueId(){return(0,h.z)(507918293)}configureRootServices(e){e.bind(d.i).toValue(r.r),e.bind(s.v).to(a.b),e.bind(p.S).toExisting(s.v),e.bind(o.$).to(u.bb),e.bind(u.c$).to(c.f),e.bind(u.Y).toDynamicValue((e=>{const t=e.getOptional(m.YQ),i=e.get(g.n);return e=>new l.U(e,t,!!i.useFluentV9)}))}}},695257:(e,t,i)=>{if(i.d(t,{l:()=>d}),0!=i.j)var n=i(886569);if(0!=i.j)var s=i(78827);if(0!=i.j)var o=i(151468);if(0!=i.j)var r=i(116102);if(0!=i.j)var a=i(251439);if(0!=i.j)var l=i(386675);class d{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507360220)}configureRootServices(e){e.bind(s.g).to(n.p),e.bind(l.S).toExisting(s.g),e.bind(o.D).toExisting(s.g),e.bind(r.p).toExisting(s.g)}}},695285:(e,t,i)=>{i.d(t,{_n:()=>l,e:()=>d});var n=i(379490),s=i(229906),o=i(83010),r=i(777555),a=i(700509);let l=class{constructor(e,t,i){this._sentenceSeparator=e,this._paragraphSeparator=t,this._unitySeparator=i}splitInUnitsFromExtendedBoundaries(e,t,i,n){return d(e,t,this.getUnitSeparator(i),n)}extendBoundariesFromDiffBounds(e,t,i){return c(e,t,this.getUnitSeparator(i))}getUnitSeparator(e){switch(e){case a.fT.Sentence:return this._sentenceSeparator;case a.fT.Paragraph:return this._paragraphSeparator;default:return this._unitySeparator}}};function d(e,t,i,n){const s=function(e,t,i,n){if(!i.firstDiffLeft&&!i.firstDiffRight&&!n.offset&&n.span===t.length)return function(e,t){const i=[],n=e.splitInUnits(t);let s=0;for(const e of n)i.push({offset:s,span:e-s,validEndBoundary:-1!==e}),s=e;(!n.length||n.length&&n[n.length-1]!==t.length)&&i.push({offset:s,span:t.length-s,validEndBoundary:!1});return i}(e,t);const s=2,o=t.slice(n.offset,n.offset+n.span),r=i.firstDiffLeft-n.offset,a=i.firstDiffRight-(t.length-n.offset-n.span);let l=0,d=0;const c=[],u=Math.min(o.length,o.length-a+s);do{const t=l;l=e.findEndBoundary(o,Math.max(l,r-s),u),d=-1!==l&&l<u?l:o.length,d-t&&c.push({offset:t+n.offset,span:d-t,validEndBoundary:-1!==l,enforcedCompleteTileTextUnit:n.enforcedCompleteTileTextUnit})}while(d<o.length);return c}(i,e,t,n||c(e,t,i));return!s.length||s[s.length-1].validEndBoundary&&!1!==s[s.length-1].validEndBoundary||(s[s.length-1]=function(e,t,i){if(!1===t.validEndBoundary&&t.span>=2){let n,s=t.span;do{n=e.slice(t.offset+s-2,t.offset+s),s-=1}while(!/\S/.test(n)&&s>=2);t.validEndBoundary=-1!==i.findEndBoundary(n,0,n.length)}return t}(e,s[s.length-1],i)),s}function c(e,t,i){let n,s=0,o=e.length,r=t.firstDiffLeft+1;if(e.length)do{if(r-=1,s=i.findBeginBoundary(e,r,0),o=i.findEndBoundary(e,e.length-t.firstDiffRight,e.length),n=-1!==o,o=-1!==o?o:e.length,r<e.length){if(s===i.findBeginBoundary(e,r+1,0))continue}let a=s,l=0;for(;a&&r===a+l;){l+=1;const t=a;if(a=i.findBeginBoundary(e,a-1,0),a<t-1){s=a;break}}}while(!(o-s));return{offset:s,span:o-s,validEndBoundary:n}}l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.hN)),(0,n.__param)(1,(0,o.W)(r.c0)),(0,n.__param)(2,(0,o.W)(r.b0))],l)},696767:(e,t,i)=>{i.d(t,{$:()=>o,Y:()=>s});const n=(()=>{const e=(()=>{if("undefined"==typeof globalThis){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window}return globalThis})();return void 0===e.Office&&(e.Office={}),void 0===e.Office.Editor&&(e.Office.Editor={}),e})().Office.Editor;function s(e){n.stringProvider=e}function o(){return n.stringProvider}},697827:(e,t,i)=>{i.d(t,{P:()=>u});var n=i(379490),s=i(922630),o=i(442316),r=i(229906),a=i(83010),l=i(427603),d=i(980495),c=i(272385);let u=class extends c.${constructor(e,t,i){super(e,void 0,i),this.mutationObserverFactory=e,this.hostSettings=t,this.logger=i}observe(e){this.connectMutationObserver(e,{attributes:!0,attributeFilter:["style"],characterData:!1,childList:!1,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1,ignoredMutationElementsSelectors:this.hostSettings.ignoredMutationElementsSelectors})}};u=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(d.V)),(0,n.__param)(1,(0,a.W)(s.n)),(0,n.__param)(2,(0,l.l)()),(0,n.__param)(2,(0,a.W)(o.g))],u)},699835:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Ορθογραφία"}}')},700509:(e,t,i)=>{var n,s,o,r,a,l,d,c,u,g,h;i.d(t,{ED:()=>n,fT:()=>s,xp:()=>g}),function(e){e[e.Success=0]="Success",e[e.PartialSuccess=1]="PartialSuccess",e[e.Error=2]="Error",e[e.Disabled=3]="Disabled"}(n||(n={})),function(e){e[e.Default=0]="Default",e[e.Word=1]="Word",e[e.Phrase=2]="Phrase",e[e.Sentence=4]="Sentence",e[e.Paragraph=8]="Paragraph",e[e.Page=16]="Page",e[e.Section=32]="Section",e[e.Chapter=64]="Chapter",e[e.Document=256]="Document",e[e.RawChars=16384]="RawChars"}(s||(s={})),function(e){e[e.Unknown=0]="Unknown",e[e.Paragraph=1]="Paragraph",e[e.Group=2]="Group",e[e.Page=3]="Page",e[e.Document=4]="Document"}(o||(o={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low"}(r||(r={})),function(e){e[e.None=0]="None",e[e.OfficeOrthospeller=1]="OfficeOrthospeller",e[e.BingOneSpeller=2]="BingOneSpeller",e[e.ContextSpeller=3]="ContextSpeller",e[e.Grammar=4]="Grammar"}(a||(a={})),function(e){e[e.None=0]="None",e[e.Active=1]="Active",e[e.Provisional=2]="Provisional"}(l||(l={})),function(e){e[e.None=0]="None",e[e.Consistency=1]="Consistency"}(d||(d={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(c||(c={})),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(u||(u={})),function(e){e[e.Ignore=0]="Ignore",e[e.IgnoreAll=1]="IgnoreAll",e[e.AddToDictionary=2]="AddToDictionary",e[e.Delete=3]="Delete",e[e.ChangeSugg0=4]="ChangeSugg0",e[e.ChangeSugg1=5]="ChangeSugg1",e[e.ChangeSugg2=6]="ChangeSugg2",e[e.ChangeSuggOther=7]="ChangeSuggOther",e[e.ChangeAllSugg0=8]="ChangeAllSugg0",e[e.ChangeAllSugg1=9]="ChangeAllSugg1",e[e.ChangeAllSugg2=10]="ChangeAllSugg2",e[e.ChangeAllSuggOther=11]="ChangeAllSuggOther",e[e.ClickNoAction=12]="ClickNoAction",e[e.DoNotCheckThisIssue=13]="DoNotCheckThisIssue",e[e.ManualEdit=14]="ManualEdit",e[e.Autoreplace=15]="Autoreplace",e[e.AutoreplaceUndo=16]="AutoreplaceUndo",e[e.IgnoreUndo=17]="IgnoreUndo",e[e.IgnoreAllUndo=18]="IgnoreAllUndo",e[e.ChangeSugg0Undo=19]="ChangeSugg0Undo",e[e.ChangeSugg1Undo=20]="ChangeSugg1Undo",e[e.ChangeSugg2Undo=21]="ChangeSugg2Undo"}(g||(g={})),function(e){e[e.Zero=0]="Zero",e[e.One=1]="One"}(h||(h={}))},701121:(e,t,i)=>{i.d(t,{Om:()=>o,WP:()=>s,ZR:()=>r});var n=i(668952);const s=(0,n.f)("IGraphNodeFactory"),o=(0,n.f)("IParagraphNodeFactory");function r(e){return!!e&&"id"in e&&"nodeType"in e}},703906:(e,t,i)=>{i.d(t,{U:()=>c});var n=i(379490),s=i(210934),o=i(752061);const r=(e,t=!1,i)=>{let n;const r=e.toLocaleLowerCase(),a=s.p[r];if(a&&(n=Array.isArray(a)?{languageId:e,languageName:a[0],isRtl:a[1]}:{languageId:e,languageName:a,isRtl:!1}),!n&&t){const e=o.Y[r];if(e){const t=Array.isArray(e)?e[0]:e,i=Array.isArray(e)?e[1]:void 0,o=s.p[t.toLocaleLowerCase()],r=!!Array.isArray(o)&&o[1],a=Array.isArray(o)?o[0]:o;n={languageId:t,languageName:null!=i?i:a,isRtl:r}}}if(n&&i){const e=n.languageId.toLocaleLowerCase();i.find((t=>t.toLocaleLowerCase()===e))||(n=void 0)}return n},a=e=>{const t=new Map;for(const i of e){if(!i.languageId)continue;const e=r(i.languageId);e&&!t.has(i.languageId)&&t.set(i.languageId,e)}return Array.from(t.values())};var l=i(229906);const d=["af-ZA","ar-AE","ar-BH","ar-DZ","ar-EG","ar-IQ","ar-JO","ar-KW","ar-LB","ar-LY","ar-MA","ar-OM","ar-QA","ar-SA","ar-SY","ar-TN","ar-YE","as-IN","az-Latn-AZ","bg-BG","bn-BD","bn-IN","bs-Latn-BA","ca-ES","ca-ES-valencia","cs-CZ","cy-GB","da-DK","de-AT","de-CH","de-DE","de-LI","de-LU","el-GR","en-029","en-AU","en-BZ","en-CA","en-CB","en-GB","en-HK","en-ID","en-IE","en-IN","en-JM","en-MY","en-NZ","en-PH","en-SG","en-TT","en-US","en-ZA","en-ZW","es-419","es-AR","es-BO","es-CL","es-CO","es-CR","es-DO","es-EC","es-ES","es-ES_tradnl","es-GT","es-HN","es-MX","es-NI","es-PA","es-PE","es-PR","es-PY","es-SV","es-US","es-UY","es-VE","et-EE","eu-ES","fa-IR","fi-FI","fr-BE","fr-CA","fr-CD","fr-CH","fr-CI","fr-CM","fr-FR","fr-HT","fr-LU","fr-MA","fr-MC","fr-ML","fr-RE","fr-SN","ga-IE","gd-GB","gl-ES","gu-IN","ha-Latn-NG","he-IL","hi-IN","hr-BA","hr-HR","hu-HU","hy-AM","id-ID","ig-NG","is-IS","it-CH","it-IT","ja-JP","ka-GE","kk-KZ","kn-IN","kok-IN","ko-KR","ky-KG","lb-LU","lt-LT","lv-LV","mi-NZ","mk-MK","ml-IN","mr-IN","ms-BN","ms-MY","mt-MT","nb-NO","ne-IN","ne-NP","nl-BE","nl-NL","nn-NO","nso-ZA","or-IN","pa-IN","pl-PL","ps-AF","pt-BR","pt-PT","rm-CH","ro-MD","ro-RO","ru-MD","ru-RU","rw-RW","si-LK","sk-SK","sl-SI","sq-AL","sr-Cyrl-BA","sr-Cyrl-CS","sr-Cyrl-ME","sr-Cyrl-RS","sr-Latn-BA","sr-Latn-CS","sr-Latn-ME","sr-Latn-RS","sv-FI","sv-SE","sw-KE","ta-IN","te-IN","th-TH","tn-BW","tn-ZA","tr-TR","tt-RU","uk-UA","ur-IN","ur-PK","uz-Latn-UZ","vi-VN","wo-SN","xh-ZA","yo-NG","zu-ZA"];let c=class{constructor(){this.bxSupportedLanguages=d.map((e=>({languageId:e})))}getLanguageInfo(e){return r(e,!0,d)}mapToLanguageInfo(e){return a(e)}bxDefaultSupportedLanguages(){return a(this.bxSupportedLanguages)}};c=(0,n.__decorate)([(0,l._)()],c)},705735:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Жазылышты текшерүү"}}')},709899:(e,t,i)=>{i.d(t,{m:()=>L});var n=i(379490),s=i(609062),o=i(105244),r=i(233653),a=i(18233),l=i(442316),d=i(401322),c=i(383291),u=i(418876),g=i(40429),h=i(823325),p=i(537969),m=i(355495),f=i(875160),v=i(83605),y=i(538045),_=i(700509),I=i(553164),C=i(451816),S=i(872317),b=i(797386),T=i(229906),E=i(66008),N=i(83010),w=i(427603),x=i(378071);let L=class{constructor(e,t,i,n,s,o,r){this._hostEmitters=e,this._proofingStore=t,this._featureFlagReader=i,this._logger=n,this._proofingDom=s,this._queryDetection=o,this._nodeTraverser=r,this.tileTracked=new Set}emitTileEvent(e,t,i,n,s,o,r,a,l,d){var u,g;s===h.G.NewData?this.tileTracked.add(t):s===h.G.RemoveData&&(this.tileTracked.delete(t),null===(u=this._queryDetection)||void 0===u||u.handleTileRemoved(t));const m=(0,b.F)(e);for(const e of this._hostEmitters)e.emit(p.pD.hostModelTextTile,{address:void 0,message:{messageType:s,data:{tileId:t,tileVersion:n,documentModel:null==m?void 0:m.documentModel,changeType:o,isTextNode:r===I.Z.ParagraphNode,tile:i?new c.Cg(Object.assign(Object.assign({},i),{formattedRanges:[...null!==(g=i.formattedRanges)&&void 0!==g?g:[],{start:0,length:i.content.length,languageId:null!=a?a:this.getProofingLanguage()}]})):void 0,prevId:l,nextId:d}}})}emitParagraphDiffEvent(e){this.tileTracked.has(e.paragraphNode.id)||this._featureFlagReader.flags.enableParagraphDeltasVerboseLogging&&this._logger.error(540915291,"Delta event sent when no parent tile node was created."),this.emitDiffEvent(e.paragraphNode,e.oldTextInfo,e.newTextInfo,e.minDiffBounds,e.wordCount,e.deltaUnit,s.pf.ParagraphNode,e.mutationChangeType,e.invalidationRanges)}emitTileDiffEvent(e,t,i,n,o,r,a,l,d){const c=a.unreconciledContent.some((e=>e.textUnit===_.fT.Paragraph))?u.OD.Paragraph:a.unreconciledContent.some((e=>e.textUnit===_.fT.Sentence))?u.OD.Sentence:o?u.OD.Word:u.OD.Chars,g=this.getProofingLanguage(),h=a.unreconciledContent.map((e=>({position:e.header.elementId.offset,length:e.header.elementId.span,unit:(0,C.d)(e.textUnit),languageId:null!=d?d:g})));this.emitDiffEvent(e,t,i,n,r,c,s.pf.TileNode,l,h)}emitMoveTileEvent(e,t,i,n,s,o,r,a,l){var d;for(const u of this._hostEmitters)u.emit(p.pD.hostModelMoveTextTile,{address:void 0,message:{oldTileId:e,newTileId:t,tileVersion:n,oldDocumentModel:a,newDocumentModel:l,tile:new c.Cg(Object.assign(Object.assign({},i),{formattedRanges:[...null!==(d=i.formattedRanges)&&void 0!==d?d:[],{start:0,length:i.content.length,languageId:null!=s?s:this.getProofingLanguage()}]})),prevId:o,nextId:r}})}emitParagraphNodeTileEvents(e,t,i,n){const s=(0,b.F)(e),o=t.removedNodes.map((t=>{var n;return{messageType:h.G.RemoveData,data:{tileId:t,tileVersion:null!==(n=e.eventSeqId)&&void 0!==n?n:0,documentModel:null==s?void 0:s.documentModel,changeType:i,isTextNode:!0,tile:void 0}}}));o.push(...t.unreconciledContent.map((o=>{var r,a,l;const d=this._proofingDom.findParagraphNode(o.header.elementId.id),u=d?null===(r=this._nodeTraverser)||void 0===r?void 0:r.findPreviousParagraphNode(d):void 0,g=d?null===(a=this._nodeTraverser)||void 0===a?void 0:a.findNextParagraphNode(d):void 0;return{messageType:this._featureFlagReader.flags.enableParagraphUpdates&&!t.addedNodes.includes(o.header.elementId.id)?h.G.ChangeData:h.G.NewData,data:{tileId:o.header.elementId.id,tileVersion:null!==(l=e.eventSeqId)&&void 0!==l?l:0,documentModel:null==s?void 0:s.documentModel,changeType:i,isTextNode:!0,tile:new c.Cg(Object.assign(Object.assign({},n),{content:o.data,formattedRanges:[{start:0,length:o.data.length,languageId:this.getProofingLanguage(o.proofingLanguages)}]})),prevId:"#head#"===u?u:null==u?void 0:u.id,nextId:"#tail#"===g?g:null==g?void 0:g.id}}})));for(const e of this._hostEmitters)e.emit(p.pD.hostModelParagraphTextTiles,{address:void 0,message:o})}getProofingLanguage(e){return m.z.getDefaultLanguageCode(null!=e?e:this._proofingStore.getCachedEntry(o.l.ProofingLanguages).storeEntryValue)}findAttributionRangesForDelta(e,t,i){if(!this._featureFlagReader.flags.enableAttributionRangeInAddDelta||void 0===t)return;if(void 0===e)return t;if(t.length<e.length||t.length-e.length>2)return t;let n;for(n=0;n<e.length;n++){const i=e[n],s=t[n];if(i.start!==s.start||i.length<s.length||!(0,f.G)(i.attribution,s.attribution))break}return t[n]?t[n].start!==i?t:t.slice(n):[]}createAttributionDelta(e,t){const i={deltaType:u.WI.AttributionUpdate,attributionData:{ranges:e,isFullUpdate:t}},n=new g.s(i);return(0,s.Bb)(n)?n:(this._logger.error(506204486,"Delta is not a formatted text tile delta with attribution ranges even though it should be"),i)}emitDiffEvent(e,t,i,n,o,r,a,l,d){var c,h,m,f;const v=null!==(c=null==t?void 0:t.content)&&void 0!==c?c:"",y=i.content,_=n.firstDiffLeft,I=v.length-n.firstDiffRight,C=y.length-n.firstDiffRight,S=v.length===y.length?u.WI.Update:I===_?u.WI.Add:C===_?u.WI.Delete:u.WI.Update;let T,E,N,w;const x=()=>this.findAttributionRangesForDelta(null==t?void 0:t.attributionRanges,i.attributionRanges,_);switch(S){case u.WI.Update:T=I-_,E=y.substring(_,C),w=x(),N=v.substring(_,I);break;case u.WI.Add:T=0,E=y.substring(_,C),w=x();break;case u.WI.Delete:T=I-_,N=v.substring(_,I),w=x()}let L=new g.s({deltaType:S,unit:r,position:_,length:T,content:E,wordCount:o,invalidationRanges:d,userInfo:{userType:l===s.Q0.Local?u.HS.SessionUser:l===s.Q0.Remote?u.HS.Collaborator:u.HS.Programmatic}});const D=a===s.pf.ParagraphNode?null===(h=this._queryDetection)||void 0===h?void 0:h.handleTileDelta(e.id,L,y,l,N):void 0;L=Object.assign(Object.assign({},L),D);const A=(0,b.F)(e);for(const t of this._hostEmitters)t.emit(p.pD.hostModelDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(m=e.eventSeqId)&&void 0!==m?m:0,documentModel:null==A?void 0:A.documentModel,delta:L,sourceType:a,changeType:l,deletedOrReplacedCharacters:N}}),this._featureFlagReader.flags.enableAttributionRangeInAddDelta&&w&&w.length>0&&e.id&&void 0!==e.eventSeqId&&t.emit(p.pD.hostModelAttributionDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(f=e.eventSeqId)&&void 0!==f?f:0,documentModel:null==A?void 0:A.documentModel,sourceType:a,delta:this.createAttributionDelta(w,w===i.attributionRanges)}})}emitFormattingDiffEventDeprecated(e,t,i){var n;const s=(0,b.F)(e),o=Array.isArray(i)?new g.s({deltaType:u.WI.FormattingUpdate,formattedRanges:i}):new g.s({deltaType:u.WI.OtherNonContentUpdate,otherNonContentData:i});for(const i of this._hostEmitters)i.emit(p.pD.hostModelFormattingDelta,{address:void 0,message:{tileId:e.id,tileVersion:null!==(n=e.eventSeqId)&&void 0!==n?n:0,documentModel:null==s?void 0:s.documentModel,delta:o,sourceType:t}})}emitFormattingDiffEvent(e,t,i){var n;if(!this._featureFlagReader.flags.enableAttributionRangeExceptionInFormattedTextDeltas)return(0,x.Dt)(i)?void this._logger.error(506331489,"Unexpected formatted text range props in deprecated formatted text deltas"):this.emitFormattingDiffEventDeprecated(e,t,i);const s=(0,b.F)(e);for(const o of this._hostEmitters)o.emit(p.pD.hostModelFormattingDelta,{address:void 0,message:(0,S.Fd)(e.id,null!==(n=e.eventSeqId)&&void 0!==n?n:0,null==s?void 0:s.documentModel,t,i)})}};L=(0,n.__decorate)([(0,T._)(),(0,n.__param)(0,(0,E.t)(p.zJ)),(0,n.__param)(1,(0,N.W)(r.K)),(0,n.__param)(2,(0,N.W)(a.c)),(0,n.__param)(3,(0,N.W)(l.g)),(0,n.__param)(4,(0,N.W)(y.w)),(0,n.__param)(5,(0,w.l)()),(0,n.__param)(5,(0,N.W)(d.J)),(0,n.__param)(6,(0,w.l)()),(0,n.__param)(6,(0,N.W)(v.M))],L)},711481:(e,t,i)=>{const n=new(i(623750).diff_match_patch);n.Diff_Timeout=0;const s=(e,t)=>e.index>=0?(e.index=t,e):t,o=e=>{"get-url"!==e.data[0]?"shut-down"!==e.data[0]?r(e):null!==e.ports[0].onmessage?e.ports[0].removeEventListener("message",o,!1):removeEventListener("message",o,!1):e.ports[0].postMessage({url:self.location.href})},r=e=>{try{const i=[],o=e.data[0],r=e.data[1],a=e.data[2],l=n.diff_main(o,r);1===l.length&&0===l[0][0]&&e.ports[0].postMessage({result:a});let d=0,c=0,u=0,g=0,h=0,p=0;for(const e of l){const n=e[0],o=e[1].length;switch(n){case 0:h=o,p=o;break;case 1:h=0,p=o;break;case-1:u+=o;continue}c+=u,u=0;for(let e=d;e<a.length;e+=1){const o=(t=a[e]).index>=0?t.index:t;if(o<g)throw new Error("Indices are not sorted!");if(!(o>=g&&o<g+p))break;i[e]=s(a[e],0===n?o+c-g:c),d+=1}if(d===a.length)break;c+=h,g+=p}for(let e=d;e<a.length;e+=1)i[e]=s(a[e],c);e.ports[0].postMessage({result:i})}catch(t){e.ports[0].postMessage({error:t})}var t};addEventListener("message",o,!1)},712551:(e,t,i)=>{i.d(t,{Z:()=>d});var n=i(379490),s=i(163573),o=i(671303),r=i(229906),a=i(83010);function l(e){return null==e}let d=class{constructor(e,t){this._hostSettings=e,this._oaLogger=t,this._appDefinitionIdMapCacheTTLInMilliseconds=6e4,this._appDefinitionIdMapCacheDisabled=!1,this.getAppDefinitionIdMap=async()=>{var e;if(null===(e=this._messageExtensionAppSuggestionSetting)||void 0===e?void 0:e.enabled)return!this._appDefinitionIdMapCacheDisabled&&this._appDefinitionIdMapLastNetwrokCallTime&&this._appDefinitionIdMapLastNetwrokCallTime+this._appDefinitionIdMapCacheTTLInMilliseconds>(new Date).getTime()?this._appDefinitionIdMap:(this.clearTimeout(),Promise.race([this.getAndAddAppDefinitionIdMapToCache(),this.getTimeoutPromise()]))},this.getAndAddAppDefinitionIdMapToCache=()=>new Promise((e=>this._getAppDefinitionIdMapCallback?this._getAppDefinitionIdMapCallback().then((t=>(this.clearTimeout(),this._appDefinitionIdMapCacheDisabled||(this._appDefinitionIdMap=t,this._appDefinitionIdMapLastNetwrokCallTime=(new Date).getTime()),e(t)))).catch((()=>(this.clearTimeout(),this._oaLogger.logDiagnostics("Failed to get appDefinitionIdMap from Host"),e(void 0)))):e(void 0))),this.getTimeoutPromise=(e=3e3)=>new Promise((t=>{this._timeoutId=setTimeout((()=>(this._oaLogger.logDiagnostics("getAppDefinitionIdMap:: request timeout"),t(void 0))),e)})),this.clearTimeout=()=>{this._timeoutId&&clearTimeout(this._timeoutId)},this.initialize()}initialize(){var e,t;this._messageExtensionAppSuggestionSetting=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.messageExtensionAppSuggestion,(null===(t=this._messageExtensionAppSuggestionSetting)||void 0===t?void 0:t.enabled)&&(this._getAppDefinitionIdMapCallback=this._messageExtensionAppSuggestionSetting.getAppDefinitionIdMapCallback,this._appDefinitionIdMapCacheDisabled=!l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)&&0===this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds,this._appDefinitionIdMapCacheTTLInMilliseconds=l(this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)?this._appDefinitionIdMapCacheTTLInMilliseconds:this._messageExtensionAppSuggestionSetting.appDefinitionIdMapCacheTTLInMilliSeconds)}};d=(0,n.__decorate)([(0,r._)(),(0,n.__param)(0,(0,a.W)(s.n)),(0,n.__param)(1,(0,a.W)(o.m))],d)},713792:(e,t,i)=>{i.d(t,{e:()=>n});class n{setHtmlElement(e){this.element!==e&&(this.element=e,this.ownerDocument=e.ownerDocument||void 0)}dispatchInputEvent(){if(this.element){const e=new Event("input",{bubbles:!0});this.element.dispatchEvent(e)}}}},715604:(e,t,i)=>{i.d(t,{N:()=>r});var n=i(379490),s=i(145402),o=i(229906);let r=class extends s.bk{constructor(){super(...arguments),this.eventNamesUsed=new Set}async initialize(){}shutDown(){for(const e of this.eventNamesUsed)try{this.off(e)}catch(e){}}on(e,t){super.on(e,t),this.eventNamesUsed.add(e)}off(e,t){try{super.off(e,t)}catch(e){}}};r=(0,n.__decorate)([(0,o._)()],r)},715618:(e,t,i)=>{i.d(t,{r:()=>P,h:()=>q});var n=i(208520),s=i(252723),o=i(108520);var r=i(61971),a=i(522775),l=i(551967),d=i(897578),c=i(195305),u=i(288296),g=i(93659),h=i(318391),p=i(756857),m=i(323283),f=i(786132),v=i(163573),y=i(592765),_=i(57980),I=i(66790),C=i(250957),S=i(496174),b=i(564333),T=i(518341),E=i(77127),N=i(959972),w=i(919068),x=i(808010),L=i(675211);let D;var A=i(851244);const F="editor-critique-card-id",q=(0,s.F5)({store:o.A.on(r.v),footerFREStore:o.A.on(a.D).optional(),themeStore:o.A.on(E.YQ).optional(),localizer:o.A.on(p.H),calloutDismissalHandler:o.A.on(l.J).optional(),styleStore:o.A.on(E.UC).optional(),hostSettings:o.A.on(v.n)});class R extends n.Component{constructor(e){super(e),this.hasPositioned=!1,this.critiqueCalloutRef=n.createRef(),this.handleKeyDown=e=>{var t;this.store.isVisible&&(e.key===b.m.arrowDown||e.key===b.m.arrowUp?(e.stopPropagation(),e.preventDefault(),null===(t=this.critiqueCalloutRef.current)||void 0===t||t.focus()):"Escape"===e.key&&this.dismiss())},this.renderCallout=()=>n.createElement("div",null,n.createElement(y.N,Object.assign({},null!=D?D:D={settings:{theme:(0,x.I)((0,L.a)())},scopedSettings:{}}),this.renderSharedCallout())),this.emitClick=e=>{const t=new MouseEvent("click",{clientX:e.clientX,clientY:e.clientY});window.document.documentElement.dispatchEvent(t)},this.onAfterRender=()=>{var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),null===(t=this.documentEventListener)||void 0===t||t.addListener("contextmenu",this.emitClick,{capture:!0}),this.parentElement||(this.parentElement=this.store.getParentElement()),this.parentElement&&!this.parentElementEventListener&&(this.parentElementEventListener=new m.J(this.parentElement),this.parentElementEventListener.addListener("keydown",this.handleKeyDown)),this.store.afterRender()},this.dismiss=()=>{var e;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.store.clickNoActionHide()},this.renderTonalFreCard=()=>{const{themeStore:e,localizer:t}=this.props.deps,{onTonalFreAction:i}=this.store,s=null==e?void 0:e.getComponentActiveTheme(E.yF.tonalFreComponentName);if(s){let t;const i=null==e?void 0:e.getComponentThemes(E.yF.tonalFreComponentName),n=new T.CJ;i&&(n.isHighContrastWhite?t=i.get(E.SV.light):n.isHighContrastBlack&&(t=i.get(E.SV.dark)),t&&(s.iconPrimaryColor=t.highContrast.iconPrimaryColor,s.iconSecondaryColor=t.highContrast.iconSecondaryColor))}return n.createElement(w.Q,{automationId:"tonal_fre_card",onClickAction:i,strings:{cardTitle:t.getMessage("ebx_tonalFreTitle"),textDescription:t.getMessage("ebx_tonalFreDescription"),acceptButtonText:t.getMessage("ebx_tonalFreAcceptButton"),ignoreButtonText:t.getMessage("ebx_tonalFreIgnoreButton"),rejectLinkText:t.getMessage("ebx_tonalFreRejectButton"),rejectionMessage:t.getMessage("ebx_tonalFreRejectMessage"),editorSettingsText:t.getMessage("ebx_tonalFreOpenEditorSettings"),dissmissButtonAccessibilityLabel:t.getMessage("ebx_tonalFreDismissButtonAccessibilityLabel")},theme:s})},this.renderSharedCard=()=>{var e,t;const{deps:i}=this.props,{footerFREStore:s,themeStore:o,styleStore:r,hostSettings:l}=i,{addOnFooterData:u,critiqueSource:g,critiqueType:h,calloutCategory:p,calloutTitle:m,suggestionsToRender:f,showSynonyms:v,dropDownActions:y,navInfo:_,brandingMode:I,explanation:C,explanationTitle:b,onCalloutAction:T,settings:w,isUpsell:x}=this.store,L=null==o?void 0:o.getComponentActiveTheme(E.iN.critiqueCalloutComponentName),D=null==r?void 0:r.getComponentStyle(E.iN.critiqueCalloutComponentName),A=null==r?void 0:r.getComponentStyle(E.iN.footerFreComponentName),F=null===(t=null===(e=l.serviceSettings)||void 0===e?void 0:e.multilingual)||void 0===t?void 0:t.hideFooterFreIcon;L&&x&&(L.addOnFooterBackground=L.upsellFooterColor);const q=null==s?void 0:s.footerProps.get(a.Y.critique);return n.createElement(d.d.Consumer,null,(e=>{var t,i,s,o;return n.createElement(n.Fragment,null,n.createElement(N.n,{ref:this.critiqueCalloutRef,addOnFooterData:(null==q?void 0:q.display)?void 0:u,automationId:"browser_extension",critiqueSource:g,definition:{definitionType:"CritiqueDefinition",critiqueType:h,header:p,subheader:m,contextText:void 0,contextDecorations:void 0,suggestions:f,maximumSuggestions:f.length,showContext:!1,showDescription:v,actions:y,critiqueSetSize:_?(0,c.v)(_).length:void 0,critiquePosition:null==_?void 0:_.currentIndex,brandingMode:I,explanation:C,explanationTitle:b},onAction:T,onAfterUpdate:this.onAfterRender,settings:w,strings:this.getLocalizedSharedStrings(),style:Object.assign(Object.assign({},D),{minWidth:null!==(t=null==D?void 0:D.minWidth)&&void 0!==t?t:300,maxWidth:null!==(i=null==D?void 0:D.maxWidth)&&void 0!==i?i:420,hasBottomAttachment:(null==q?void 0:q.display)&&!q.pages.size}),theme:L,layerHostId:e}),n.createElement(S.b,{target:a.Y.critique,styles:{container:Object.assign({borderRadius:{topStart:0,topEnd:0,bottomStart:2,bottomEnd:2},minWidth:null!==(s=null==D?void 0:D.minWidth)&&void 0!==s?s:300,maxWidth:null!==(o=null==D?void 0:D.maxWidth)&&void 0!==o?o:420},null==A?void 0:A.container),dismissContainerStyle:null==A?void 0:A.dismissContainerStyle,textContainerStyle:null==A?void 0:A.textContainerStyle},hideIcon:F}))}))},this.renderSharedCallout=()=>{var e,t,i;const{localizer:s,themeStore:o}=this.props.deps,{target:r,setInitialFocus:a,shouldShowTonalFre:l,gapSpace:c,styles:p}=this.store,m=null==o?void 0:o.getComponentActiveTheme(E.yF.critiqueCalloutComponentName);if(!0!==this.context){const i=(0,_.Zq)(null===(e=p.calloutMain)||void 0===e?void 0:e.root,{marginLeft:this.state.marginLeft,marginRight:this.state.marginRight,border:(null===(t=null==m?void 0:m.callout)||void 0===t?void 0:t.borderColor)?`1px solid ${m.callout.borderColor}`:void 0});return n.createElement(d.U,{id:F,className:"ms-critique-callout","aria-label":s.getMessage("ebx_brandText"),calloutMaxWidth:450,doNotLayer:!1,gapSpace:c,isBeakVisible:!1,onDismiss:this.dismiss,onPositioned:e=>{e&&!this.hasPositioned&&(this.hasPositioned=!0,e.alignmentEdge===I.x.left?e.elementPosition.left?this.setState({marginLeft:-15,marginRight:0}):this.setState({marginLeft:0,marginRight:15}):e.alignmentEdge===I.x.right?e.elementPosition.left?this.setState({marginLeft:15,marginRight:0}):this.setState({marginLeft:0,marginRight:-15}):this.setState({marginLeft:0,marginRight:0}))},role:"dialog",target:(0,u.K)(r),preventDismissOnLostFocus:!1,preventDismissOnEvent:this.onPreventDismissCalloutOnEvent,styles:Object.assign(Object.assign({},p.calloutMain),{root:i})},n.createElement(C.Y,{disableFirstFocus:!a,isClickableOutsideFocusTrap:!0},l?this.renderTonalFreCard():this.renderSharedCard()))}{const e=e=>void 0!==(null==e?void 0:e.key),t={moveFocusIntoModalizer:!0,popover:{unstable_disableAutoFocus:!0,trapFocus:!0,withArrow:!1,open:this.store.isVisible,onOpenChange:(t,i)=>{if((i.open||!this.onPreventDismissCalloutOnEvent(t))&&!i.open){const i=t.nativeEvent;e(i)&&"Escape"===i.key&&this.store.restoreCaretToPreviousPosition(),this.dismiss()}},positioning:{target:(0,g.ug)(r),align:"start",position:"below",offset:e=>({mainAxis:c,crossAxis:"start"===e.alignment?-15:0})},ariaLabel:this.store.ariaLabelToReadWhenCardIsOpened},surface:{className:"ms-critique-callout",style:Object.assign({padding:0,maxWidth:450,border:(null===(i=null==m?void 0:m.callout)||void 0===i?void 0:i.borderColor)?`1px solid ${m.callout.borderColor}`:void 0},p.calloutV9)}};return n.createElement(n.Fragment,null,n.createElement("div",{id:F,"aria-live":"polite","aria-label":this.store.ariaLabelToReadWhenCardIsOpened}),n.createElement(h.v,Object.assign({},t),l?this.renderTonalFreCard():this.renderSharedCard()))}},this.onPreventDismissCalloutOnEvent=e=>{const{deps:t}=this.props,{calloutDismissalHandler:i}=t;if(i&&!i.shouldDismissCallout(e,"CritiqueCallout",void 0))return!0;if("click"===e.type){const t=this.store.target;if((0,f.C)(t,"HTMLElement")){const i=t.getBoundingClientRect();if(n=i,s=e.pageX,o=e.pageY,n.x<=s&&s<=n.x+n.width&&n.y<=o&&o<=n.y+n.height)return!0}}var n,s,o;return!1},this.store=e.deps.store,this.state={marginLeft:-15,marginRight:-15},this.documentEventListener=new m.J(this.store.targetDocumentRef)}componentDidUpdate(e,t,i){var n,s,o,r,a,l,d;this.parentElement||(this.parentElement=this.store.getParentElement()),this.store.isVisible?(null===(n=this.parentElement)||void 0===n||n.setAttribute("aria-activedescendant",F),null===(s=this.parentElement)||void 0===s||s.setAttribute("aria-controls",F),null===(o=this.parentElement)||void 0===o||o.setAttribute("aria-owns",F),this.store.setInitialFocus&&(null===(r=this.critiqueCalloutRef.current)||void 0===r||r.focus())):(null===(a=this.parentElement)||void 0===a||a.removeAttribute("aria-activedescendant"),null===(l=this.parentElement)||void 0===l||l.removeAttribute("aria-controls"),null===(d=this.parentElement)||void 0===d||d.removeAttribute("aria-owns"))}componentWillUnmount(){var e,t;null===(e=this.documentEventListener)||void 0===e||e.removeAllListeners(),this.documentEventListener=void 0,this.parentElement=void 0,null===(t=this.parentElementEventListener)||void 0===t||t.removeAllListeners(),this.parentElementEventListener=void 0}render(){const{styles:e,target:t}=this.store;let i=this.store.isVisible;return(!t||"x"in t&&"y"in t&&0===t.x&&0===t.y||(0,f.C)(t,"HTMLElement")&&!t.isConnected)&&(i=!1),n.createElement("div",{style:e.shadowHost},i?this.renderCallout():null)}getCommonStringsMap(){return{suggestionsGroupNoSuggestionsText:this.store.noSuggestionLabel}}getTextFormattingStringsMap(){const{localizer:e}=this.props.deps,{text:t,textInContext:i}=this.store;return{contextAccessibilityLabelForSpelling:e.getMessage("contextAccessibilityLabelForSpelling",[t,i]),contextAccessibilityLabelForRepeatedWord:e.getMessage("contextAccessibilityLabelForRepeatedWord",[t,i]),contextAccessibilityLabelForGrammar:e.getMessage("contextAccessibilityLabelForGrammar",[t,i]),contextAccessibilityLabelForRefinement:e.getMessage("contextAccessibilityLabelForRefinement",[t,i]),contextAccessibilityLabelForCorrection:e.getMessage("contextAccessibilityLabelForCorrection",[t,i])}}getCritiqueExplanationStringsMap(){const{localizer:e}=this.props.deps;return{explanationTableBefore:e.getMessage("explanationTableBefore"),explanationTableAfter:e.getMessage("explanationTableAfter"),explanationTableSeparator:e.getMessage("explanationTableSeparator"),explanationTableAccessibilityLabel:e.getMessage("explanationTableAccessibilityLabel")}}getCritiqueStringsMap(){var e;const{localizer:t}=this.props.deps,{calloutCategory:i,calloutTitle:n,navInfo:s}=this.store,o=t.getMessage("ebx_asInSynonyms"),r=`{0} ${o} {1}`,a=`{0}, {1} ${o} {2}`,l=s?(0,c.v)(s).length:0,d=null!==(e=null==s?void 0:s.currentIndex)&&void 0!==e?e:0,u=l-d-1;return{previewHeaderLabel:t.getMessage("ebx_previewLabel"),spellingCardHeader:i,repeatedWordCardSubheader:n,grammarCardHeader:i,tonalRewriteCardHeader:t.getMessage("ebx_toneLabel"),deleteRepeatedWord:t.getMessage("ebx_deleteRepeatedWord"),spellingSuggestionDescriptionAccessibilityLabel:r,suggestionWithTagAccessibilityLabel:"{0}, {1}",spellingSuggestionTagAndDescriptionAccessibilityLabel:a,ignoreAll:t.getMessage("ebx_ignoreAllButtonLabel"),ignoreOnce:t.getMessage("ebx_ignoreOnceButtonLabel"),addToDictionary:t.getMessage("ebx_addToDictionaryButtonLabel"),microsoftEditorBranding:t.getMessage("ebx_brandText"),microsoftEditorBrandingAccessibilityLabel:t.getMessage("ebx_brandTextArialLabel"),editorButtonTooltipContent:t.getMessage("ebx_settingsButtonTooltip"),footerSeeMoreActionsAccessibilityLabel:t.getMessage("ebx_moreButtonArialLabel"),changeAll:t.getMessage("ebx_changeAllCommandLabel"),giveFeedbackButtonText:t.getMessage("ebx_giveFeedback"),hideSynonyms:t.getMessage("ebx_hideSynonyms"),showSynonyms:t.getMessage("ebx_showSynonyms"),ignoreRule:t.getMessage("ebx_disableCritiqueButton"),options:t.getMessage("ebx_changeSettingsCommandLabel"),manageLanguages:t.getMessage("ebx_manageLanguages"),nextIssue:t.getMessage("ebx_nextIssueWithCount",u.toString()),nextIssueWithCount:t.getMessage("ebx_nextIssueWithCount",u.toString()),previousIssue:t.getMessage("ebx_previousIssueWithCount",d.toString()),previousIssueWithCount:t.getMessage("ebx_previousIssueWithCount",d.toString()),readAloudOriginalSentenceAccessibilityLabel:t.getMessage("readAloudOriginalSentenceAccessibilityLabel"),explanationFlyoutAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),footerExplanationButtonAccessibilityLabel:t.getMessage("explanationFlyoutAccessibilityLabel"),editorButtonText:t.getMessage("editorButtonText")}}getLocalizedSharedStrings(){const e=this.getCritiqueStringsMap(),t=this.getCommonStringsMap(),i=this.getCritiqueExplanationStringsMap(),n=this.getTextFormattingStringsMap();return{critique:t=>e[t]||"",common:e=>t[e]||"",critiqueExplanation:e=>i[e]||"",textFormatting:e=>n[e]||""}}}R.contextType=E.O1;const P=function(e,t){var i;const o=i=>{const o=(0,s.KN)(t);return i.deps?n.createElement(e,Object.assign({},i)):n.createElement(e,Object.assign({},i,{deps:o}))},r=null!==(i=e.displayName)&&void 0!==i?i:e.name;return o.displayName=`${r}DepsResolver`,o}((0,A.PA)(R),q)},716588:(e,t,i)=>{function n(e,t){const i=Math.max(0,Math.min(1,t));if(7===e.length){return e+Math.floor(255*i).toString(16).padStart(2,"0")}{const t=parseInt(e.slice(-2),16)/255,n=Math.floor(i*t*255).toString(16).padStart(2,"0");return e.slice(0,-2)+n}}function s(e){switch(e){case"SpellingSquiggle":return"spelling-error";case"GrammarSquiggle":case"AdvancedSquiggle":return"grammar-error";default:return"highlight"}}function o(e,t,i,n){return e+(void 0!==n?`-${n}`:"")+"-"+t+(i?"-hl":"")}i.d(t,{$v:()=>n,Mf:()=>o,pE:()=>s})},718385:(e,t,i)=>{function n(e,t,i,n){var s;const o=[];let r=0;const a=new Set;for(const{critique:l}of e){let e=!1;const d=(null===(s=l.textInContext)||void 0===s?void 0:s.toLowerCase())||"";i&&(e=a.has(d)),r<t&&!e?l.isVisible&&(n&&l.isStealth&&(l.isStealth=!1,o.push(l)),a.add(d),r++):e&&l.isVisible?(l.isVisible=!1,o.push(l)):l.isVisible&&(n&&!l.isStealth?(l.isStealth=!0,o.push(l)):n||(l.isVisible=!1,o.push(l)),a.add(d))}return o}i.d(t,{Y:()=>n})},718771:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Imlo"}}')},719249:(e,t,i)=>{if(i.d(t,{N:()=>v}),0!=i.j)var n=i(477543);if(0!=i.j)var s=i(819797);if(0!=i.j)var o=i(131190);if(0!=i.j)var r=i(4989);if(0!=i.j)var a=i(710856);if(0!=i.j)var l=i(354641);if(0!=i.j)var d=i(119005);if(0!=i.j)var c=i(551488);if(0!=i.j)var u=i(731158);if(0!=i.j)var g=i(172292);if(0!=i.j)var h=i(566297);const p={requiredFlights:["mc-editor-oa","mc-editor-oa-client-ecc"],isFeatureEnabled:(e,t)=>!0===(null==t?void 0:t.some((t=>t===e)))},m={};class f{constructor(e,t,i,n){this.refreshCadence=e,this.augloopSession=t,this.timer=i,this._logger=n}start(){this.timer.setIntervalWithDelay("refreshGraphSearchData",(()=>this.tryRefresh()),this.refreshCadence,this.refreshCadence)}stop(){this.timer.clearTimer("refreshGraphSearchData")}async tryRefresh(){if(this.augloopSession.isClosed)return;const e={parentPath:["session","doc"],items:[{id:"0",body:new s.$9({forceRefresh:!1})}]};this.augloopSession.submitOperation(new n.Xr(e))}onRefreshDone(){this._logger.info(507349215,"Graph search data refresh done")}}class v{constructor(e,t,i){var n,s,o,r,a,l,d,c,u,g;this.timer=i,this.defaultRefreshInterval=3e5,this.annotationListenerType="",this.config=e,this._logger=t,this.requiredSetting(null===(n=this.config.oaSettings)||void 0===n?void 0:n.enableOaClient,"oaSettings.enableOaClient"),this.requiredSetting(null===(o=null===(s=this.config.serviceSettings)||void 0===s?void 0:s.hybridAugloop)||void 0===o?void 0:o.enabled,"serviceSettings.hybridAugloop.enabled"),this.requiredSetting(null===(a=null===(r=this.config.serviceSettings)||void 0===r?void 0:r.hybridAugloop)||void 0===a?void 0:a.enableGraphSearchLocal,"serviceSettings.hybridAugloop.enableGraphSearchLocal"),this.requiredSetting(null===(l=this.config.orchestratorSettings)||void 0===l?void 0:l.enableAugLoop,"orchestratorSettings.enableAugLoop"),this.requiredSetting(!!(null===(d=this.config.orchestratorSettings)||void 0===d?void 0:d.substrateAuthTokenCallback),"orchestratorSettings.substrateAuthTokenCallback"),this.checkRequiredFlights(this.config.flightsToTrack),this.cacheGetter=(null===(g=null===(u=null===(c=this.config.serviceSettings)||void 0===c?void 0:c.hybridAugloop)||void 0===u?void 0:u.wasmConfig)||void 0===g?void 0:g.disableModuleCache)?()=>m:void 0,this.config.orchestratorSettings?(this.config.orchestratorSettings.preRuntimeInit=this.config.orchestratorSettings.preRuntimeInit||[],this.config.orchestratorSettings.preRuntimeInit.push(((e,t)=>this.preRuntimeInit(e,t)))):this._logger.error(507349214,"OrchestratorSettings missing. Required for Hybrid ECC"),this.eccEnabled=(e=>{var t;return!!(null===(t=e.oaSettings)||void 0===t?void 0:t.enableOaClient)})(e),this.eccEnabled||this._logger.warn(507349213,"Hybrid ECC workflows are not enabled.  Consider excluding Hybrid plugin support to reduce overall package size.")}get wasmScriptPath(){var e,t,i;return(0,u.Gm)(null===(i=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.wasmConfig)||void 0===i?void 0:i.scriptPath)}preRuntimeInit(e,t){return t.inferenceServiceFactory=l._.createFactory(this.wasmScriptPath,(0,u.$A)(this.config),this.cacheGetter),t.modelDownloader=new a.$(e.appName,"fs.microsoft.com/fs/augmentationLoop","res.cdn.office.net/polymer/models"),Promise.resolve()}requiredSetting(e,t){e||this._logger.error(507349212,`Required setting ${t} for hybrid wasn't set.`,t)}checkRequiredFlights(e){const t=p.requiredFlights.filter((t=>!p.isFeatureEnabled(t,e)));0!==t.length&&this._logger.error(507349211,`Hybrid requires these flights be enabled: ${t}`,t)}async activateAnnotations(e){if(!e||!this.eccEnabled)return;e.registerLocalWorkflow(g.A);const t=this.wasmScriptPath||"",i=(0,u.uz)(this.config),n={wasmRoot:t,locateFile:e=>(0,u.$A)(this.config,e),cacheModule:!0,wasmModuleCache:this.cacheGetter};e.registerLocalWorkflow((0,d.X8)(i,n)),e.registerLocalWorkflow((0,c.L4)(i,n)),e.activateAnnotation(o.NG.getTypeName()),e.registerLocalWorkflow(h.TE),e.activateAnnotation(r.os.getTypeName()),this.isUpdateSchedulerEnabled()?this.setupGraphSearchDataRefreshScheduler(e):e.activateAnnotation(s.$9.getTypeName())}isUpdateSchedulerEnabled(){var e,t,i;return null!==(i=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.enablePeriodicUpdates)&&void 0!==i&&i}getUpdateInterval(){var e,t,i;return null!==(i=null===(t=null===(e=this.config.serviceSettings)||void 0===e?void 0:e.hybridAugloop)||void 0===t?void 0:t.periodicUpdateInterval)&&void 0!==i?i:this.defaultRefreshInterval}setupGraphSearchDataRefreshScheduler(e){this.graphSearchDataRefreshScheduler&&this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=new f(this.getUpdateInterval(),e,this.timer,this._logger),this.graphSearchDataRefreshScheduler.start(),e.activateAnnotation(s.$9.getTypeName(),{callback:this.graphSearchDataRefreshScheduler.onRefreshDone.bind(this.graphSearchDataRefreshScheduler)})}async deactivateAnnotations(e){return!(!e||!this.eccEnabled)&&(this.graphSearchDataRefreshScheduler&&(this.graphSearchDataRefreshScheduler.stop(),this.graphSearchDataRefreshScheduler=void 0),e.releaseAnnotation(o.NG.getTypeName()),e.releaseAnnotation(r.os.getTypeName()),e.releaseAnnotation(s.$9.getTypeName()),!0)}async updateAnnotationActivationConfig(){}}},722390:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"LocalizedName":"","IsImplemented":false},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"","IsImplemented":false},"Grammar":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"","IsImplemented":false},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Stavekontroll"},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""}}')},722864:(e,t,i)=>{if(i.d(t,{E:()=>c}),0!=i.j)var n=i(368617);if(0!=i.j)var s=i(429712);if(0!=i.j)var o=i(254831);if(0!=i.j)var r=i(341755);if(0!=i.j)var a=i(251439);if(0!=i.j)var l=i(386675);if(0!=i.j)var d=i(589445);class c{constructor(){this.imports=[]}get uniqueId(){return(0,a.z)(507918365)}configureRootServices(e){e.bind(r.i).toValue(n.u),e.bind(s.QV).to(s.$1),e.bind(l.S).toExisting(s.QV),e.bind(d.m).to(o.e)}}},725758:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Mopeleto"}}')},728474:(e,t,i)=>{i.d(t,{t:()=>o});var n=i(379490),s=i(229906);let o=class{setOnFeedbackIconClicked(e){this._onFeedbackIconClicked=e}feedbackIconClicked(e,t){this._onFeedbackIconClicked&&this._onFeedbackIconClicked(e,t)}};o=(0,n.__decorate)([(0,s._)()],o)},728671:(e,t,i)=>{var n,s;i.d(t,{Q0:()=>s,pf:()=>n}),function(e){e.TileNode="TileNode",e.ParagraphNode="ParagraphNode"}(n||(n={})),function(e){e[e.Local=0]="Local",e[e.Code=1]="Code",e[e.Remote=2]="Remote"}(s||(s={}))},730387:(e,t,i)=>{if(i.d(t,{C:()=>r}),0!=i.j)var n=i(753031);var s=i(758651);const o=(e,t,i,n)=>{const s={eventName:e,tagID:`0x${`00000000${t.toString(16)}`.slice(-8)}`,message:i,data:n};return JSON.stringify(s)};class r{async initialize(){}addCorrelationID(e){s.log(`CorrelationID is: ${e}`)}log(e,t,i,n){this.dispatchLog(null,e,t,i,n)}debug(e,t,i){this.dispatchLog(null,e,n.q.Debug,t,i)}error(e,t,i){this.dispatchLog(null,e,n.q.Error,t,i)}warn(e,t,i){this.dispatchLog(null,e,n.q.Warn,t,i)}info(e,t,i){this.dispatchLog(null,e,n.q.Info,t,i)}logEvent(e,t,i,n,s,o){this.dispatchLog(t,e,i,n,o)}dispatchLog(e,t,i,r,a){switch(i){case n.q.Debug:s.log(o(e,t,r,a));break;case n.q.Error:s.error(o(e,t,r,a));break;case n.q.Info:s.info(o(e,t,r,a));break;case n.q.Warn:s.warn(o(e,t,r,a));break;default:throw new Error("Invalid logging level")}}getNewActivity(e,t,i){s.log(e)}}},730976:(e,t,i)=>{i.d(t,{o:()=>f});var n=i(379490),s=i(787924),o=i(272385),r=i(609062),a=i(442316),l=i(753031),d=i(46692),c=i(323283),u=i(937229),g=i(980495),h=i(229906),p=i(83010),m=i(427603);let f=class extends o.${constructor(e,t,i){super(e,null==i?void 0:i.elementTransformers,t),this.mutationObserverFactory=e,this._logger=t,this._lastCharacterModificationReplacedCharacters=!1,this.connectMutationObserver=(e,t,i)=>{this._mutationObserver=this._mutationObserverFactory((e=>{var t;let n=!1,o=!1;for(let a=0;a<e.length;a++){const c=e[a],u=e;try{const e=this.onElementRemoved,t=this.onElementAdded,s=this.onElementChanged;switch(c.type){case"childList":if(e){const t=Array.from(c.removedNodes);t.length&&!o&&(e(t.pop(),r.Q0.Local,void 0),o=!0)}if(t){const e=Array.from(c.addedNodes);e.length&&!n&&(t(e.pop(),r.Q0.Local,null==i?void 0:i(c,a,u)),n=!0)}break;case"characterData":s&&s(c.target,r.Q0.Local,void 0,this._lastCharacterModificationReplacedCharacters);break;case"attributes":this.handleAttributeChange(c,r.Q0.Local,t,s,e)}}catch(e){null===(t=this._logger)||void 0===t||t.logEvent(508146694,s.s.MutationError,l.q.Error,"Error while processing a mutation.",d.o.SamplingPolicy.CriticalBusinessImpact,e)}finally{this._lastCharacterModificationReplacedCharacters=!1}}})),this._mutationObserver.observe(e,t),this.eventListener=new c.J(e),this.eventListener.addListener("keypress",this.onKeyPress,{passive:!0,capture:!0})},this.onKeyPress=e=>{const t=e.currentTarget.ownerDocument.getSelection();(null==t?void 0:t.toString().startsWith(e.key))?this._lastCharacterModificationReplacedCharacters=!0:this._lastCharacterModificationReplacedCharacters=!1},this._mutationContextBuilder=null==i?void 0:i.mutationContextBuilder,this.elementTransformers=null==i?void 0:i.elementTransformers}observe(e){const t={attributes:!1,characterData:!0,childList:!0,subtree:!0,attributeOldValue:!1,characterDataOldValue:!1};if(this.elementTransformers){const e=new Set;for(const t of this.elementTransformers)for(const i of t.attributeList)e.add(i);e.size&&(t.attributes=!0,t.attributeFilter=Array.from(e.values()))}this.connectMutationObserver(e,t,this._mutationContextBuilder),this._styleChangeObserver=this.mutationObserverFactory((e=>{this.onVisualStateChanged&&e.length>0&&this.onVisualStateChanged(e[0].target,"StyleChange")})),this._styleChangeObserver.observe(e,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["style"]})}disconnect(e){var t,i,n;super.disconnect(e),null===(t=this.eventListener)||void 0===t||t.removeAllListeners(),this.eventListener=void 0,null===(i=this._styleChangeObserver)||void 0===i||i.takeRecords(),null===(n=this._styleChangeObserver)||void 0===n||n.disconnect()}};f=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,p.W)(g.V)),(0,n.__param)(1,(0,m.l)()),(0,n.__param)(1,(0,p.W)(a.g)),(0,n.__param)(2,(0,m.l)()),(0,n.__param)(2,(0,p.W)(u.Bc))],f)},731158:(e,t,i)=>{i.d(t,{$A:()=>r,Gm:()=>o,uz:()=>a});var n=i(354035);if(0!=i.j)var s=i(95749);const o=e=>{if(e){try{return new URL(e),"/"===e[e.length-1]?e.substring(0,e.length-1):e}catch(e){}const t=e.split("/").filter((e=>0!==e.length));if(0!==t.length)return["/",t.join("/")].join("")}return e},r=(e,t)=>{var i,n,s,r,a,l;return((e,t)=>["/"===e?"":o(e),t].join("/"))((null===(s=null===(n=null===(i=e.serviceSettings)||void 0===i?void 0:i.hybridAugloop)||void 0===n?void 0:n.wasmConfig)||void 0===s?void 0:s.binaryPath)||(null===(l=null===(a=null===(r=e.serviceSettings)||void 0===r?void 0:r.hybridAugloop)||void 0===a?void 0:a.wasmConfig)||void 0===l?void 0:l.scriptPath),t)},a=e=>{var t,i,o,r,a;const d=(0,s.e)(e);return{emailId:e.userId.email,puid:e.userId.puid,scenarios:[n.Nz.BIZ_CHAT,"PowerPoint"===(null===(t=e.hostMetadata)||void 0===t?void 0:t.appName)?n.Nz.COPILOT_POWERPOINT:n.Nz.WORKPLACE_SEARCH],tenantId:e.userId.tenantId,substrateAuthTokenType:l[e.userId.identityProvider],entityTypes:[],clientConfig:{getConfig:()=>d},prefetchOnly:!1,market:e.defaultLocale,useLocalFileRanker:null===(o=null===(i=e.serviceSettings)||void 0===i?void 0:i.hybridAugloop)||void 0===o?void 0:o.useLocalFileRanker,includeLoopFiles:null===(a=null===(r=e.serviceSettings)||void 0===r?void 0:r.hybridAugloop)||void 0===a?void 0:a.includeLoopFiles}},l=[n.Xe.SUBSTRATE_MSA,n.Xe.SUBSTRATE_AAD]},731268:e=>{e.exports=JSON.parse('{"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Referencias geopolíticas sensibles","IsImplemented":true},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Corrección de errores"},"Resume":{"LocalizedName":"CV","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Ortografía","IsImplemented":true},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Puntuación"},"Formality":{"IsImplemented":true,"LocalizedName":"Lenguaje formal"},"Inclusiveness":{"LocalizedName":"Lenguaje no discriminatorio","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concisión","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"Coherencia","IsImplemented":false},"Typing errors":{"LocalizedName":"Erratas","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulario"},"Rewrite":{"IsImplemented":false,"LocalizedName":"Reformulaciones"},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"IsImplemented":true,"LocalizedName":"Gramática"},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Convenciones de escritura"},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acrónimos"},"Clarity":{"LocalizedName":"Claridad","IsImplemented":true}}')},731808:(e,t,i)=>{if(i.d(t,{z:()=>s}),0!=i.j)var n=i(30126);function s(e,t=""){const i=null===t?e:(0,n.W)(e,t);window.open(i,"_blank","noopener,noreferrer")}},731816:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(668952).f)("ISquiggleThemeFactory")},731857:(e,t,i)=>{function n(e){return function(e){return void 0!==e.range}(e)?e.range:void 0}i.d(t,{e:()=>n})},732162:(e,t,i)=>{i.d(t,{FN:()=>o,FQ:()=>l});var n=i(77127);if(0!=i.j)var s=i(923256);class o{constructor(e){this.DefaultUnderlineThickness="auto",this.initSquiggleTheme(e)}initSquiggleTheme(e){const{themeTypeOrSquiggleTheme:t,isUsingCSSHighlightViaSettings:i,forcedHighContrastColorModeEnabled:n,attachedElement:o}=e,r=(0,s.g)({enableCSSHighlightApiSquiggleRendering:i},o);void 0===t||this.isThemeType(t)?this._squiggleTheme=this.getDefaultSquiggleThemeFromEditorThemeType(t,r):this.isISquiggleTheme(t)?this._squiggleTheme=t:this._squiggleTheme=this.calculateCustomizedSquiggleTheme(r,t),n&&(this._squiggleTheme=this.modifyThemeForHighContrast(this._squiggleTheme)),this.setDefaultSquiggleUnderlineThickness(this._squiggleTheme)}setDefaultSquiggleUnderlineThickness(e){var t,i,n,s,o;const{highPriorityColors:r,lowPriorityColors:a,autoCorrectColors:l,ciqFlagColors:d,headingDetectionColors:c}=e;r.underlineThickness=null!==(t=r.underlineThickness)&&void 0!==t?t:this.DefaultUnderlineThickness,a.underlineThickness=null!==(i=a.underlineThickness)&&void 0!==i?i:this.DefaultUnderlineThickness,d.underlineThickness=null!==(n=d.underlineThickness)&&void 0!==n?n:this.DefaultUnderlineThickness,c.underlineThickness=null!==(s=c.underlineThickness)&&void 0!==s?s:this.DefaultUnderlineThickness,l.underlineThickness=null!==(o=l.underlineThickness)&&void 0!==o?o:this.DefaultUnderlineThickness}calculateCustomizedSquiggleTheme(e,t){const i=e?r:l;return Object.assign(Object.assign({},i),{highPriorityColors:Object.assign(Object.assign({},i.highPriorityColors),t.spelling),mediumPriorityColors:Object.assign(Object.assign({},i.mediumPriorityColors),t.grammar),lowPriorityColors:Object.assign(Object.assign({},i.lowPriorityColors),t.insight),autoCorrectColors:Object.assign(Object.assign({},i.autoCorrectColors),t.autoCorrectColors),ciqFlagColors:Object.assign(Object.assign({},i.ciqFlagColors),t.ciqFlagColors),headingDetectionColors:Object.assign(Object.assign({},i.headingDetectionColors),t.headingDetectionColors)})}getSquiggleTheme(){var e;return null!==(e=this._squiggleTheme)&&void 0!==e?e:r}isISquiggleTheme(e){return e&&void 0!==e.highPriorityColors&&void 0!==e.mediumPriorityColors&&void 0!==e.lowPriorityColors&&void 0!==e.autoCorrectColors&&void 0!==e.ciqFlagColors&&void 0!==e.headingDetectionColors}isThemeType(e){return Object.values(n.SV).includes(e)}getDefaultSquiggleThemeFromEditorThemeType(e,t){switch(e){case n.SV.light:return t?r:l;case n.SV.dark:return t?a:d;case n.SV.highContrast:return c;default:return t?r:l}}modifyThemeForHighContrast(e){return Object.assign(Object.assign({},e),{highPriorityColors:Object.assign(Object.assign({},e.highPriorityColors),{tile:"highlight"}),mediumPriorityColors:Object.assign(Object.assign({},e.mediumPriorityColors),{tile:"highlight"}),lowPriorityColors:Object.assign(Object.assign({},e.lowPriorityColors),{tile:"highlight"}),autoCorrectColors:Object.assign(Object.assign({},e.autoCorrectColors),{tile:"highlight"}),ciqFlagColors:Object.assign(Object.assign({},e.ciqFlagColors),{tile:"highlight"}),headingDetectionColors:Object.assign(Object.assign({},e.headingDetectionColors),{tile:"highlight"})})}}const r={highPriorityColors:{tile:"#EB0000",highlight:"#FDE5E5"},mediumPriorityColors:{tile:"#3355FF",highlight:"#EAEEFF"},lowPriorityColors:{tile:"#5A4EBC",highlight:"#E3DFFA"},autoCorrectColors:{tile:"#1A7D1A",highlight:"#D4EDD4"},ciqFlagColors:{tile:"#0F6CBD",highlight:"#0F6CBD1A"},headingDetectionColors:{tile:"#D27A36",highlight:"#D27A3627"}},a={highPriorityColors:{tile:"#D6454A",highlight:"#3F1011"},mediumPriorityColors:{tile:"#99AAF5",highlight:"#172047"},lowPriorityColors:{tile:"#7160E8",highlight:"#221D46"},autoCorrectColors:{tile:"#55B155",highlight:"#064006"},ciqFlagColors:{tile:"#5CA9E5",highlight:"#0E336A"},headingDetectionColors:{tile:"#D27A36",highlight:"#D27A3627"}},l={highPriorityColors:{tile:r.highPriorityColors.tile,highlight:"#FF30001A"},mediumPriorityColors:{tile:r.mediumPriorityColors.tile,highlight:"#0055CC1A"},lowPriorityColors:{tile:r.lowPriorityColors.tile,highlight:"#7160E833"},autoCorrectColors:{tile:r.autoCorrectColors.tile,highlight:"#5BC55240"},ciqFlagColors:{tile:r.ciqFlagColors.tile,highlight:"#0F6CBD1A"},headingDetectionColors:{tile:r.headingDetectionColors.tile,highlight:"#D27A3627"}},d={highPriorityColors:{tile:a.highPriorityColors.tile,highlight:"#FF30001A"},mediumPriorityColors:{tile:a.mediumPriorityColors.tile,highlight:"#0055CC1A"},lowPriorityColors:{tile:a.lowPriorityColors.tile,highlight:"#7160E833"},autoCorrectColors:{tile:a.autoCorrectColors.tile,highlight:"#5BC55240"},ciqFlagColors:{tile:a.ciqFlagColors.tile,highlight:"#0F6CBD1A"},headingDetectionColors:{tile:a.headingDetectionColors.tile,highlight:"#D27A3627"}},c={highPriorityColors:{tile:"highlight",highlight:""},mediumPriorityColors:{tile:"highlight",highlight:""},lowPriorityColors:{tile:"highlight",highlight:""},autoCorrectColors:{tile:"highlight",highlight:""},ciqFlagColors:{tile:"highlight",highlight:""},headingDetectionColors:{tile:"highlight",highlight:""}}},736416:(e,t,i)=>{if(i.d(t,{o:()=>s}),0!=i.j)var n=i(425811);class s{constructor(e,t,i){this.injectionIdentifier=e,this.isOptional=t,this.isArray=i}resolveFrom(e){if(!this.shouldSkipResolving(e))return this.isArray?this.resolveArray(e):this.resolveSingular(e)}resolveSingular(e){return this.isOptional?e.getOptional(this.injectionIdentifier):e.get(this.injectionIdentifier)}resolveArray(e){if(!this.isOptional&&!e.isBound(this.injectionIdentifier))throw new Error("No matching bindings found for serviceIdentifier: "+this.injectionIdentifier.toString());return e.getAll(this.injectionIdentifier)}isBoundTo(e){return!!e.isBound(this.injectionIdentifier)}setupBinding(e,t){if(this.isArray&&Array.isArray(t))for(const i of t)this.setupSingleBinding(e,i);else this.setupSingleBinding(e,t)}setupSingleBinding(e,t){const i=e.bind(this.injectionIdentifier);(0,n.C)(t)?i.to(t):i.toValue(t)}toString(){const e={};return e.identifier=this.injectionIdentifier instanceof Function?this.injectionIdentifier.name:this.injectionIdentifier.toString(),this.isOptional&&(e.isOptional=this.isOptional),this.isArray&&(e.isArray=this.isArray),`ConfiguredDep(${JSON.stringify(e)})`}shouldSkipResolving(e){return!!this.isOptional&&!this.isBoundTo(e)}}},738459:(e,t,i)=>{i.d(t,{c:()=>s});var n=i(794300);class s extends n.z{constructor(e,t,i,n){super(),this._targetWindow=e,this._safeWindow=t,this._eventName=i,this._performanceApiGarbageCollectorIntervalInMs=n,this._performanceMarksInGarbageCollection=[],this._measuresNames=new Map,this._performanceMarksInGCCorrelationKeysHistory=new Map}startEntry(e,t,i){const[n]=this._getPerformanceEntryNames(e);let s=this._targetWindow.performance.mark(n);if(void 0===s){const e=this._targetWindow.performance.getEntriesByName(n);if(1!==e.length)return void this.publishEvent("errorEntryNotFound",{entryName:n});s=e[0]}this._performanceMarksInGarbageCollection.push(s),t&&this._performanceMarksInGCCorrelationKeysHistory.set(s.name,{correlationKeys:t,customData:i?[i]:[]}),this._scheduleGarbageCollection(!1)}_getPerformanceEntryNames(e,t=this._eventName){const i=`${t}-${e}`;return[e,`${i}--${s.END_SUFFIX}`,i]}addMeasure(e,t,i){const[n,s,o]=this._getPerformanceEntryNames(e,t);if(0!==this._targetWindow.performance.getEntriesByName(n).length)try{if(this._targetWindow.performance.mark(s),this._targetWindow.performance.measure(o,n,s),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:this._targetWindow.performance.getEntriesByName(o)[0].duration}]),this._targetWindow.performance.clearMarks(s),this._targetWindow.performance.clearMeasures(o),i){const e=this._performanceMarksInGCCorrelationKeysHistory.get(n);if(null==e?void 0:e.correlationKeys){const t=e.correlationKeys,s=[...e.customData||[],i];this._performanceMarksInGCCorrelationKeysHistory.set(n,{correlationKeys:t,customData:s})}}}catch(e){this.publishEvent("errorAddingCheckpoint",{measureName:t,errorCaught:e})}}commitEntry(e,t=this._eventName,i){const[n,s,o]=this._getPerformanceEntryNames(e,t),r=this._targetWindow.performance.getEntriesByName(n);if(0!==r.length)try{this._targetWindow.performance.mark(s),this._targetWindow.performance.measure(o,n,s),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:this._targetWindow.performance.getEntriesByName(o)[0].duration}]);const a=this._performanceMarksInGCCorrelationKeysHistory.get(n);this.publishEvent("commitMeasure",{measures:this._measuresNames.get(e)||[],correlationKeys:null==a?void 0:a.correlationKeys,customData:null==a?void 0:a.customData,eventName:i}),this._targetWindow.performance.clearMarks(n),this._targetWindow.performance.clearMarks(s),this._targetWindow.performance.clearMeasures(o),this._measuresNames.delete(e),this._removeGCTracedPerformanceMark(r[0])}catch(e){this.publishEvent("errorCommitMeasure",{measureName:t,errorCaught:e})}}_clearAndReschedule(e){const t=Date.now(),i=[],n=this._performanceMarksInGarbageCollection.filter((n=>{const s=this._targetWindow.performance.timeOrigin+n.startTime;if(e&&!e.didTimeout&&0===e.timeRemaining()||t-s<this._performanceApiGarbageCollectorIntervalInMs)return!0;const o=this._performanceMarksInGCCorrelationKeysHistory.get(n.name);return o&&(o.correlationKeys.isTimeout=!0,this.publishEvent("timeout",{id:o.correlationKeys.logicalId,storedCorrelationKeys:o.correlationKeys,customData:o.customData})),i.push(n),this._targetWindow.performance.clearMarks(n.name),this._targetWindow.performance.clearMeasures(n.name),this._measuresNames.delete(n.name),!1}));for(const e of i)this._removeGCTracedPerformanceMark(e);this._garbageCollectionScheduler=void 0,n.length>0&&this._scheduleGarbageCollection(!0)}_removeGCTracedPerformanceMark(e){const t=this._performanceMarksInGarbageCollection.indexOf(e);t>=0&&this._performanceMarksInGarbageCollection.splice(t,1),this._performanceMarksInGCCorrelationKeysHistory.has(e.name)&&this._performanceMarksInGCCorrelationKeysHistory.delete(e.name)}_scheduleGarbageCollection(e){this._garbageCollectionScheduler||e||(this._garbageCollectionScheduler=this._safeWindow.requestIdleCallback((e=>this._clearAndReschedule(e)),this._performanceApiGarbageCollectorIntervalInMs))}}s.END_SUFFIX="end"},738550:(e,t,i)=>{var n,s,o,r,a,l;i.d(t,{G_:()=>a,P2:()=>l,UW:()=>s,Y6:()=>o}),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(n||(n={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(s||(s={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(o||(o={})),function(e){e.GCC="GCC",e.Worldwide="WW"}(r||(r={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(l||(l={}))},742035:(e,t,i)=>{i.d(t,{c:()=>n});const n=(0,i(668952).f)("IFeatureFlagsReader")},742397:(e,t,i)=>{i.d(t,{q:()=>n});const n=(0,i(668952).f)("IShadowGraphFactory")},743442:(e,t,i)=>{i.d(t,{U:()=>c});var n=i(379490),s=i(732162),o=i(419728),r=i(637224);const a=e=>`url("data:image/svg+xml,${encodeURIComponent(e.trim())}")`;class l{get theme(){return this._theme}get grammarTile(){return this._grammarTile||this.setGrammarTiles(this._theme),this._grammarTile}get grammarTileBorder(){return this._grammarTileBorder||this.setGrammarTiles(this._theme),this._grammarTileBorder}get insightTile(){return this._insightTile||this.setInsightTiles(this._theme),this._insightTile}get insightTileBorder(){return this._insightTileBorder||this.setInsightTiles(this._theme),this._insightTileBorder}get spellingTile(){return this._spellingTile||this.setSpellingTiles(this._theme),this._spellingTile}get spellingTileBorder(){return this._spellingTileBorder||this.setSpellingTiles(this._theme),this._spellingTileBorder}get autoCorrectTile(){return this._autoCorrectTile||this.setAutoCorrectTiles(this._theme),this._autoCorrectTile}get autoCorrectTileBorder(){return this._autoCorrectBorder||this.setAutoCorrectTiles(this._theme),this._autoCorrectBorder}get ciqFlagTile(){return this._ciqFlagTile||this.setCiqFlagTiles(this._theme),this._ciqFlagTile}get ciqFlagTileBorder(){return this._ciqFlagBorder||this.setCiqFlagTiles(this._theme),this._ciqFlagBorder}get headingDetectionTile(){return this._headingDetectionTile||this.setHeadingDetectionTiles(this._theme),this._headingDetectionTile}get headingDetectionTileBorder(){return this._headingDetectionBorder||this.setHeadingDetectionTiles(this._theme),this._headingDetectionBorder}constructor(e){this._grammarTile="",this._grammarTileBorder="",this._insightTile="",this._insightTileBorder="",this._spellingTile="",this._spellingTileBorder="",this._autoCorrectTile="",this._autoCorrectBorder="",this._ciqFlagTile="",this._ciqFlagBorder="",this._headingDetectionTile="",this._headingDetectionBorder="",this.setSquiggleTheme=e=>{this._theme={highPriorityColors:e.highPriorityColors||this._theme.highPriorityColors,mediumPriorityColors:e.mediumPriorityColors||this._theme.mediumPriorityColors,lowPriorityColors:e.lowPriorityColors||this._theme.lowPriorityColors,autoCorrectColors:e.autoCorrectColors||this._theme.autoCorrectColors,ciqFlagColors:e.ciqFlagColors||this._theme.ciqFlagColors,headingDetectionColors:e.headingDetectionColors||this._theme.headingDetectionColors},this.setGrammarTiles(this._theme),this.setInsightTiles(this._theme),this.setSpellingTiles(this._theme),this.setAutoCorrectTiles(this._theme),this.setCiqFlagTiles(this._theme),this.setHeadingDetectionTiles(this._theme)},this.setGrammarTiles=e=>{this._grammarTile=a(`\n      <svg width="5px" height="3px" viewBox="0 0 5 3" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>grammar_double_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="grammar_double_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n            <path d="M0,2.5 L5,2.5" id="Line-2-Copy-11"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._grammarTileBorder=a(`\n    <svg width="15px" height="9px" viewBox="0 0 15 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n      \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n      <title>grammar_double_line</title>\n      <desc>Created with Sketch.</desc>\n      <g id="grammar_double_line" stroke="none" stroke-width="3" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n        <g id="Grammar-Tile-Copy" stroke="${e.mediumPriorityColors.tile}">\n          <path d="M0,1.5 L15,1.5" id="Line-2-Copy-10"></path>\n          <path d="M0,7.5 L15,7.5" id="Line-2-Copy-11"></path>\n        </g>\n      </g>\n    </svg>\n  `)},this.setInsightTiles=e=>{this._insightTile=a(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._insightTileBorder=a(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>insight_texture</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.lowPriorityColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this.setSpellingTiles=e=>{this._spellingTile=a(`\n      <svg width="5px" height="4px" viewBox="0 0 5 4" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M0,3 C1.25,3 1.25,1 2.5,1 C3.75,1 3.75,3 5,3" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="1"></path>\n              <rect id="Rectangle" x="0" y="0" width="5" height="4"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `),this._spellingTileBorder=a(`\n      <svg width="17px" height="9px" viewBox="0 0 17 9" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 56.2 (81672) - https://sketch.com --\x3e\n        <title>spelling_squiggle</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Flags" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n          <g transform="translate(-1010.000000, -296.000000)" id="spelling_squiggle">\n            <g transform="translate(1010.000000, 296.000000)">\n              <path d="M 0,7.5 H 1 C 4.75,7.5 4.75,1.5 8.5,1.5 12.25,1.5 12.25,7.5 16,7.5 H 17" id="Path" stroke="${e.highPriorityColors.tile}" stroke-width="3"></path>\n              <rect id="Rectangle" x="0" y="0" width="17" height="9"></rect>\n            </g>\n          </g>\n        </g>\n      </svg>\n    `)},this.setAutoCorrectTiles=e=>{this._autoCorrectTile=a(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `),this._autoCorrectBorder=a(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.autoCorrectColors.tile}">\n            <path d="M0,0.5 L5,0.5" id="Line-2-Copy-10"></path>\n          </g>\n        </g>\n      </svg>\n    `)},this.setCiqFlagTiles=e=>{this._ciqFlagTile=a(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="round">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n          <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `),this._ciqFlagBorder=a(`\n      <svg width="5px" height="1px" viewBox="0 0 5 1" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <title>autocorrect_line</title>\n        <g id="autocorrect_line" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd" stroke-linecap="butt">\n          <g id="Grammar-Tile-Copy" stroke="${e.ciqFlagColors.tile}">\n            <path d="M1,1 L1,1" strokeWidth="2" strokeLinecap="round" />\n          </g>\n        </g>\n      </svg>\n    `)},this.setHeadingDetectionTiles=e=>{this._headingDetectionTile=a(`\n      <svg width="10px" height="2px" viewBox="0 0 10 2" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M1,1 L5,1" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="3" stroke-linecap="round" stroke-dasharray="6,4"></path>\n        </g>\n      </svg>\n    `),this._headingDetectionBorder=a(`\n      <svg width="30px" height="6px" viewBox="0 0 30 6" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        \x3c!-- Generator: Sketch 55.2 (78181) - https://sketchapp.com --\x3e\n        <title>headingDetection_line</title>\n        <desc>Created with Sketch.</desc>\n        <g id="Group-2-Copy">\n          <path d="M3,3 L18,3" id="Line-4" stroke="${e.headingDetectionColors.tile}" stroke-width="6" stroke-linecap="round" stroke-dasharray="18,12"></path>\n        </g>\n      </svg>\n    `)},this._theme=null!=e?e:s.FQ,(0,r.Gn)(this)}}(0,n.__decorate)([o.observable],l.prototype,"_theme",void 0),(0,n.__decorate)([o.observable],l.prototype,"_grammarTile",void 0),(0,n.__decorate)([o.observable],l.prototype,"_grammarTileBorder",void 0),(0,n.__decorate)([o.observable],l.prototype,"_insightTile",void 0),(0,n.__decorate)([o.observable],l.prototype,"_insightTileBorder",void 0),(0,n.__decorate)([o.observable],l.prototype,"_spellingTile",void 0),(0,n.__decorate)([o.observable],l.prototype,"_spellingTileBorder",void 0),(0,n.__decorate)([o.observable],l.prototype,"_autoCorrectTile",void 0),(0,n.__decorate)([o.observable],l.prototype,"_autoCorrectBorder",void 0),(0,n.__decorate)([o.observable],l.prototype,"_ciqFlagTile",void 0),(0,n.__decorate)([o.observable],l.prototype,"_ciqFlagBorder",void 0),(0,n.__decorate)([o.observable],l.prototype,"_headingDetectionTile",void 0),(0,n.__decorate)([o.observable],l.prototype,"_headingDetectionBorder",void 0),(0,n.__decorate)([o.computed],l.prototype,"theme",null),(0,n.__decorate)([o.computed],l.prototype,"grammarTile",null),(0,n.__decorate)([o.computed],l.prototype,"grammarTileBorder",null),(0,n.__decorate)([o.computed],l.prototype,"insightTile",null),(0,n.__decorate)([o.computed],l.prototype,"insightTileBorder",null),(0,n.__decorate)([o.computed],l.prototype,"spellingTile",null),(0,n.__decorate)([o.computed],l.prototype,"spellingTileBorder",null),(0,n.__decorate)([o.computed],l.prototype,"autoCorrectTile",null),(0,n.__decorate)([o.computed],l.prototype,"autoCorrectTileBorder",null),(0,n.__decorate)([o.computed],l.prototype,"ciqFlagTile",null),(0,n.__decorate)([o.computed],l.prototype,"ciqFlagTileBorder",null),(0,n.__decorate)([o.computed],l.prototype,"headingDetectionTile",null),(0,n.__decorate)([o.computed],l.prototype,"headingDetectionTileBorder",null),(0,n.__decorate)([o.action],l.prototype,"setSquiggleTheme",void 0);var d=i(229906);let c=class{get theme(){return this.squiggleThemeStoreCore.theme}get grammarTile(){return this.squiggleThemeStoreCore.grammarTile}get grammarTileBorder(){return this.squiggleThemeStoreCore.grammarTileBorder}get insightTile(){return this.squiggleThemeStoreCore.insightTile}get insightTileBorder(){return this.squiggleThemeStoreCore.insightTileBorder}get spellingTile(){return this.squiggleThemeStoreCore.spellingTile}get spellingTileBorder(){return this.squiggleThemeStoreCore.spellingTileBorder}get autoCorrectTile(){return this.squiggleThemeStoreCore.autoCorrectTile}get autoCorrectTileBorder(){return this.squiggleThemeStoreCore.autoCorrectTileBorder}get ciqFlagTile(){return this.squiggleThemeStoreCore.ciqFlagTile}get ciqFlagTileBorder(){return this.squiggleThemeStoreCore.ciqFlagTileBorder}get headingDetectionTile(){return this.squiggleThemeStoreCore.headingDetectionTile}get headingDetectionTileBorder(){return this.squiggleThemeStoreCore.headingDetectionTileBorder}constructor(e){this.setSquiggleTheme=e=>{this.squiggleThemeStoreCore.setSquiggleTheme(e)},this.squiggleThemeStoreCore=new l(e),(0,r.Gn)(this)}};(0,n.__decorate)([o.computed],c.prototype,"theme",null),(0,n.__decorate)([o.computed],c.prototype,"grammarTile",null),(0,n.__decorate)([o.computed],c.prototype,"grammarTileBorder",null),(0,n.__decorate)([o.computed],c.prototype,"insightTile",null),(0,n.__decorate)([o.computed],c.prototype,"insightTileBorder",null),(0,n.__decorate)([o.computed],c.prototype,"spellingTile",null),(0,n.__decorate)([o.computed],c.prototype,"spellingTileBorder",null),(0,n.__decorate)([o.computed],c.prototype,"autoCorrectTile",null),(0,n.__decorate)([o.computed],c.prototype,"autoCorrectTileBorder",null),(0,n.__decorate)([o.computed],c.prototype,"ciqFlagTile",null),(0,n.__decorate)([o.computed],c.prototype,"ciqFlagTileBorder",null),(0,n.__decorate)([o.computed],c.prototype,"headingDetectionTile",null),(0,n.__decorate)([o.computed],c.prototype,"headingDetectionTileBorder",null),(0,n.__decorate)([o.action],c.prototype,"setSquiggleTheme",void 0),c=(0,n.__decorate)([(0,d._)()],c)},743514:(e,t,i)=>{i.d(t,{q:()=>n,x:()=>s});const n=(0,i(668952).f)("IConditionalAttributeFilterFactory");class s{constructor(e){this.filters=e,this.attributeList=Array.from(e.keys())}shouldProofElement(e){let t=!1;return this.filters.forEach((i=>{t=t||i(e)})),!t}}},744709:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":""},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"LocalizedName":"","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":""},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":false,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"การสะกด","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"LocalizedName":"","IsImplemented":false}}')},745107:(e,t,i)=>{function n(){return/Macintosh|Mac OS X/i.test(navigator.userAgent)}i.d(t,{i:()=>n})},745133:(e,t,i)=>{i.d(t,{PF:()=>d});var n=i(379490),s=i(483432),o=i(229906),r=i(668952),a=i(262255);(0,s.Yi)((0,o._)(),a.Q);let l=class extends a.Q{};l=(0,n.__decorate)([(0,o._)()],l);(0,r.f)("IContentEditableAutoCorrectionCache");const d=(0,r.f)("IFormElementAutoCorrectionCache")},746180:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Дөрес язылыш"}}')},747152:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"الدقة","IsImplemented":false},"Consistent Written Forms":{"LocalizedName":"تناسق الكتابة","IsImplemented":false},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"الشمولية"},"Typing errors":{"LocalizedName":"أخطاء إملائية","IsImplemented":false},"Clarity":{"LocalizedName":"الوضوح","IsImplemented":false},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"إعادة الكتابة","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":"تصحيح أخطاء"},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"المفردات","IsImplemented":false},"Grammar":{"IsImplemented":true,"LocalizedName":"نحو"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"لغة رسمية"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"الترقيم"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"أساليب الكتابة"},"Spelling":{"LocalizedName":"التدقيق الإملائي","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"السيرة الذاتية"},"Sensitive Geopolitical References":{"LocalizedName":"عبارات جيوسياسية حساسة","IsImplemented":false}}')},747594:(e,t,i)=>{i.d(t,{c:()=>s});var n=i(630501);class s extends n.z{constructor(e,t,i,n){super(),this._targetWindow=e,this._safeWindow=t,this._eventName=i,this._performanceApiGarbageCollectorIntervalInMs=n,this._performanceMarksInGarbageCollection=[],this._measuresNames=new Map,this._performanceMarksInGCCorrelationKeysHistory=new Map}startEntry(e,t,i){const[n]=this._getPerformanceEntryNames(e);let s=this._targetWindow.performance.mark(n);if(void 0===s){const e=this._targetWindow.performance.getEntriesByName(n);if(1!==e.length)return void this.publishEvent("errorEntryNotFound",{entryName:n});s=e[0]}this._performanceMarksInGarbageCollection.push(s),t&&this._performanceMarksInGCCorrelationKeysHistory.set(s.name,{correlationKeys:t,customData:i?[i]:[]}),this._scheduleGarbageCollection(!1)}_getPerformanceEntryNames(e,t=this._eventName){const i=`${t}-${e}`;return[e,`${i}--${s.END_SUFFIX}`,i]}addMeasure(e,t,i){const[n,s,o]=this._getPerformanceEntryNames(e,t);if(0!==this._targetWindow.performance.getEntriesByName(n).length)try{if(this._targetWindow.performance.mark(s),this._targetWindow.performance.measure(o,n,s),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:this._targetWindow.performance.getEntriesByName(o)[0].duration}]),this._targetWindow.performance.clearMarks(s),this._targetWindow.performance.clearMeasures(o),i){const e=this._performanceMarksInGCCorrelationKeysHistory.get(n);if(null==e?void 0:e.correlationKeys){const t=e.correlationKeys,s=[...e.customData||[],i];this._performanceMarksInGCCorrelationKeysHistory.set(n,{correlationKeys:t,customData:s})}}}catch(e){this.publishEvent("errorAddingCheckpoint",{measureName:t,errorCaught:e})}}commitEntry(e,t=this._eventName,i){const[n,s,o]=this._getPerformanceEntryNames(e,t),r=this._targetWindow.performance.getEntriesByName(n);if(0!==r.length)try{this._targetWindow.performance.mark(s),this._targetWindow.performance.measure(o,n,s),this._measuresNames.set(e,[...this._measuresNames.get(e)||[],{name:t,duration:this._targetWindow.performance.getEntriesByName(o)[0].duration}]);const a=this._performanceMarksInGCCorrelationKeysHistory.get(n);this.publishEvent("commitMeasure",{measures:this._measuresNames.get(e)||[],correlationKeys:null==a?void 0:a.correlationKeys,customData:null==a?void 0:a.customData,eventName:i}),this._targetWindow.performance.clearMarks(n),this._targetWindow.performance.clearMarks(s),this._targetWindow.performance.clearMeasures(o),this._measuresNames.delete(e),this._removeGCTracedPerformanceMark(r[0])}catch(e){this.publishEvent("errorCommitMeasure",{measureName:t,errorCaught:e})}}_clearAndReschedule(e){const t=Date.now(),i=[],n=this._performanceMarksInGarbageCollection.filter((n=>{const s=this._targetWindow.performance.timeOrigin+n.startTime;if(e&&!e.didTimeout&&0===e.timeRemaining()||t-s<this._performanceApiGarbageCollectorIntervalInMs)return!0;const o=this._performanceMarksInGCCorrelationKeysHistory.get(n.name);return o&&(o.correlationKeys.isTimeout=!0,this.publishEvent("timeout",{id:o.correlationKeys.logicalId,storedCorrelationKeys:o.correlationKeys,customData:o.customData})),i.push(n),this._targetWindow.performance.clearMarks(n.name),this._targetWindow.performance.clearMeasures(n.name),this._measuresNames.delete(n.name),!1}));for(const e of i)this._removeGCTracedPerformanceMark(e);this._garbageCollectionScheduler=void 0,n.length>0&&this._scheduleGarbageCollection(!0)}_removeGCTracedPerformanceMark(e){const t=this._performanceMarksInGarbageCollection.indexOf(e);t>=0&&this._performanceMarksInGarbageCollection.splice(t,1),this._performanceMarksInGCCorrelationKeysHistory.has(e.name)&&this._performanceMarksInGCCorrelationKeysHistory.delete(e.name)}_scheduleGarbageCollection(e){this._garbageCollectionScheduler||e||(this._garbageCollectionScheduler=this._safeWindow.requestIdleCallback((e=>this._clearAndReschedule(e)),this._performanceApiGarbageCollectorIntervalInMs))}}s.END_SUFFIX="end"},748340:(e,t,i)=>{if(i.d(t,{q:()=>l}),0!=i.j)var n=i(92083);if(0!=i.j)var s=i(332688);if(0!=i.j)var o=i(568621);if(0!=i.j)var r=i(120733);var a=i(208520);const l=()=>{const e=a.useRef(null),t=a.useRef(null),i=(0,r.E)("onSearchChange"),l=(0,r.E)("autoFocusSearchOnOpen"),d=(0,r.E)("searchOpened"),c=(0,r.E)("setSearchOpened"),{conversationId:u,logicalId:g,additionalData:h,query:p}=(0,r.E)("requestEntitiesParams"),m=p.text,{clientCorrelationId:f,scopeInfo:v}=h||{};(0,o.j)(t);const y=a.useCallback(((e,{value:t})=>{null==i||i(t),t&&(0,s.j)("SearchBar",t.length,u,g,f,null==v?void 0:v.entityType)}),[f,u,g,i,null==v?void 0:v.entityType]),_=a.useCallback((()=>{var e;""!==m&&(null==i||i("")),null===(e=t.current)||void 0===e||e.focus()}),[i,m]),I=a.useCallback((e=>{c(!0)}),[c]),C=a.useCallback((e=>{var i;"Escape"===e.key&&(e.stopPropagation(),null===(i=t.current)||void 0===i||i.blur(),c(!1))}),[c]),S=a.useCallback((i=>{var n,s;(null===(n=e.current)||void 0===n?void 0:n.contains(null==i?void 0:i.relatedTarget))||(l?d&&(null===(s=t.current)||void 0===s||s.focus()):c(!1))}),[c,d,l]),b=a.useMemo((()=>0===m.length?null:{onClick:_,tabIndex:0}),[m.length,_]);return i?a.createElement(n.M,{ref:e,focusSearchBoxOnExpand:!0,"data-automation-id":"ciq-search-box",searchBox:{onChange:y,value:m,onKeyDown:C,dismiss:b,ref:t,onBlur:S},expanded:d,expandButton:{onClick:I},onClick:()=>{(0,s.vb)("searchButtonClicked",u,g,f,null==v?void 0:v.entityType)}}):null}},748903:(e,t,i)=>{i.d(t,{r:()=>B});var n=i(379490),s=i(477543),o=i(959994),r=i(537969);class a{constructor(e,t,i,n,o,a,l,d){this._sessionId=e,this._logger=t,this._annotationListeners=i,this._session=n,this._aggregateLogger=o,this._augloopDocumentSerializer=a,this._hostEmitter=l,this._clientSubscribers=d,this.sessionWasDisconnected=!1,this.initialize=async()=>{try{this._session.setConnectCallback(this.onSessionConnected),this._session.setDisconnectCallback(this.onSessionDisconnected)}catch(e){this._logger.error(561534362,"Failed to initialize AugLoop session callbacks",e)}try{await this.activateAnnotations(this._annotationListeners.map((e=>e.annotationListenerType)))}catch(e){this._logger.error(508614281,"Failed to initialize AugLoop session annotations",e)}},this.close=()=>{this._session.close()},this.submitDelta=(e,t,i)=>{var n;const o=new s.xU({parentPath:e,items:[{id:e[e.length-1],revId:`${i}`,body:t,sourceTimestamp:Date.now()}]});this._session.submitOperation(o),null===(n=this._aggregateLogger)||void 0===n||n.incrementEventCount(512337430,`submitDelta. unit: ${t.unit}`)},this.getSessionId=()=>this._sessionId,this.getSession=()=>this._session,this.updateAnnotationActivationConfig=async()=>{await Promise.all(this._annotationListeners.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325704,`updateAnnotationActivationConfig called for ${e.annotationListenerType}`),e.updateAnnotationActivationConfig()})))},this.activateAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325703,`activateAnnotations called for ${e.annotationListenerType}`),e.activateAnnotations(this._session,this._sessionId)})))},this.releaseAnnotations=async e=>{const t=this._annotationListeners.filter((t=>null==e?void 0:e.some((e=>e===t.annotationListenerType))));return(await Promise.all(t.map((e=>{var t;return null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325702,`deactivateAnnotations called for ${e.annotationListenerType}`),e.deactivateAnnotations(this._session)})))).every(Boolean)},this.submitSignal=(e,t,i)=>{var n,o,r;const a=new s.g0({parentPath:this._augloopDocumentSerializer.getParentPath(this,i),items:[{id:t,body:e}]});this._session.submitOperation(a),null===(n=this._aggregateLogger)||void 0===n||n.incrementEventCount(512325701,`submitted a signal of type: ${null!==(r=null===(o=e.H_)||void 0===o?void 0:o.T_)&&void 0!==r?r:"unknown"}`)},this.onDocumentCreated=e=>{for(const t of this._clientSubscribers)t.onDocumentCreated(this,e)},this.onSessionDisconnected=()=>{this.sessionWasDisconnected=!0,this._logger.warn(507773218,"Augloop session has disconnected")},this.onSessionConnected=async e=>{if(!e)return;const t=this.sessionWasDisconnected;if(this.sessionWasDisconnected=!1,t){this._logger.warn(508631257,"Augloop session has reconnected"),this._augloopDocumentSerializer.sessionReconnected(this._session),this._augloopDocumentSerializer.submitSeedOperations(this._session);for(const e of this._clientSubscribers)e.onSessionReconnected(this);this._hostEmitter.emit(r.pD.hostModelRehydrateTiles,{address:this._sessionId,message:[]}),this._hostEmitter.emit(r.pD.hostModelRehydrateTilesFinished,{address:this._sessionId,message:[]})}else this._logger.warn(508421253,"Augloop session has initially connected"),this._augloopDocumentSerializer.submitSeedOperations(this._session)}}submitOperation(e){var t,i;this._session.submitOperation(e);const n=o.h.getTypeNameFor(e);null===(t=this._aggregateLogger)||void 0===t||t.incrementEventCount(512325706,`_submitItemsOperation called with ${n}`),null===(i=this._aggregateLogger)||void 0===i||i.incrementEventCount(512325705,`items submitted through ${n}`,e.items.length)}}var l=i(174077),d=i(834426),c=i(276961),u=i(229906),g=i(66008),h=i(427603);let p=class{constructor(e){this._clientSubscribers=e,this.hasCreatedDocument=!1}sessionReconnected(e){this.hasCreatedDocument=!1}submitSeedOperations(e){const t={id:"doc",body:new d.yo({isReadonly:!1})},i=new s.Xr({parentPath:["session"],items:[t]});try{e.submitSeedOperations([i])}catch(e){}}getParentPath(e,t){if(!this.hasCreatedDocument){this.hasCreatedDocument=!0;for(const i of this._clientSubscribers)i.onDocumentCreated(e,t)}return["session","doc"]}};var m,f;p=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,g.t)(c.T)),(0,n.__param)(0,(0,h.l)())],p),function(e){e.TileNode="TileNode",e.ParagraphNode="ParagraphNode"}(m||(m={})),function(e){e[e.Local=0]="Local",e[e.Code=1]="Code",e[e.Remote=2]="Remote"}(f||(f={}));var v=i(904196),y=i(383714),_=i(797452),I=i(119427),C=i(668952);const S=(0,C.f)("IAugloopDocumentSerializer");var b=i(496814),T=i(380422),E=i(222145),N=i(226331);const w=(0,C.f)("ISafeWindow");var x=i(46692),L=i(947511),D=i(753031),A=i(738459);class F{constructor(e,t,i,n,s,o,r=window){this._logger=e,this._eventName=i,this._logToTelemetry=s,this._onTimeout=o,this._onCommitMeasure=e=>{this._logToTelemetry(e.measures,e.correlationKeys,e.customData,e.eventName)},this._onCoreTimeout=e=>{var t;if(this._onTimeout){const i=(null===(t=e.customData)||void 0===t?void 0:t.length)?e.customData[0]:void 0;this._onTimeout(e.id,e.storedCorrelationKeys,i)}},this._onErrorEntryNotFound=e=>{this._logger.logEvent(505436036,L.f.TelemetryError,D.q.Error,`Unable to find performance entry by name: ${e.entryName}`,x.o.SamplingPolicy.CriticalExperimentation)},this._onErrorAddingCheckpoint=e=>{this._logger.logEvent(505436035,L.f.TelemetryError,D.q.Error,`Error while adding a checkpoint measure to a telemetry entry, error: ${e.errorCaught}`,x.o.SamplingPolicy.CriticalExperimentation)},this._onErrorCommitMeasure=e=>{this._logger.logEvent(505436034,L.f.TelemetryError,D.q.Error,`Error while commiting a telemetry entry, error: ${e.errorCaught}`,x.o.SamplingPolicy.CriticalExperimentation)},this._metricCore=new A.c(r,t,i,n),this._metricCore.subscribe("errorEntryNotFound",this._onErrorEntryNotFound),this._metricCore.subscribe("errorAddingCheckpoint",this._onErrorAddingCheckpoint),this._metricCore.subscribe("errorCommitMeasure",this._onErrorCommitMeasure),this._metricCore.subscribe("commitMeasure",this._onCommitMeasure),this._metricCore.subscribe("timeout",this._onCoreTimeout)}dispose(){this._metricCore.unsubscribe("errorEntryNotFound",this._onErrorEntryNotFound),this._metricCore.unsubscribe("errorAddingCheckpoint",this._onErrorAddingCheckpoint),this._metricCore.unsubscribe("errorCommitMeasure",this._onErrorCommitMeasure),this._metricCore.unsubscribe("commitMeasure",this._onCommitMeasure),this._metricCore.unsubscribe("timeout",this._onCoreTimeout)}startEntry(e,t,i){this._metricCore.startEntry(e,t,i)}addMeasure(e,t,i){this._metricCore.addMeasure(e,t,i)}commitEntry(e,t=this._eventName,i){this._metricCore.commitEntry(e,t,i)}setOnTimeout(e){this._onTimeout=e}}var q=i(83010);const R=(0,C.f)("IE2eMetric");let P=class{constructor(e,t,i,n){var s;this._logger=e,this._hostSettings=t,this._proofingStore=i,this._eventName="End2EndTelemetry",this._alEventName="IsAL",this._performanceApiGarbageCollectorIntervalInMs=1e4,this._logToTelemetry=e=>{const t=this._logger.getNewActivity(this._eventName,x.o.SamplingPolicy.CriticalExperimentation);if(!t)return;const i=this._proofingStore.getCachedEntry(b.l.ProofingLanguages).storeEntryValue;t.dataFields.push(...e.map((e=>(0,T.n)(e.name,e.duration,void 0,x.o.DataFieldType.Double.valueOf())))),t.dataFields.push(...(0,T.W)([this._alEventName,this._isAlEnabled],[E.o.NumProofingLanguages,i.length])),t.success=!0,t.endNow()},this._isAlEnabled=!0===this._hostSettings.enableOrchestration&&!0===(null===(s=this._hostSettings.orchestratorSettings)||void 0===s?void 0:s.enableAugLoop),this.metric=new F(e,n,this._eventName,this._performanceApiGarbageCollectorIntervalInMs,this._logToTelemetry)}startEntry(e){this._hostSettings.enableE2eMetric&&this.metric.startEntry(e)}addMeasure(e,t,i){this._hostSettings.enableE2eMetric&&this.metric.addMeasure(e,t,i)}commitEntry(e,t=this._eventName){this._hostSettings.enableE2eMetric&&this.metric.commitEntry(e,t)}setOnTimeout(e){this.metric.setOnTimeout(e)}};P=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,q.W)(y.g)),(0,n.__param)(1,(0,q.W)(v.n)),(0,n.__param)(2,(0,q.W)(N.K)),(0,n.__param)(3,(0,q.W)(w))],P);var O=i(551852),k=i(823325),M=i(774592),z=i(615930),j=i(875160);class W{getKeyFromParentPath(e){return e.join()}shouldAttemptMergeDeltas(e,t){return e.modelDelta.tileId===t.modelDelta.tileId&&e.modelDelta.delta.deltaType===t.modelDelta.delta.deltaType}clearPendingTimeout(){this.pendingTimeoutId&&(this.targetWindow.clearTimeout(this.pendingTimeoutId),this.pendingTimeoutId=void 0)}getIndexForRangeMerge(e,t){if(0===t.length||t[t.length-1].start<e.start)return t.length;const i=t.findIndex((t=>t.start>e.start));return-1===i?t.length-1:i}addOrMerge(e,t){if(e.start<0||e.length<0)return void this.logger.error(506033676,"Range to merge has a negative start or length value",{start:e.start,length:e.length});0===t.length&&t.push(e);const i=this.getIndexForRangeMerge(e,t);if(t[i]&&t[i].start===e.start)return void(t[i].length!==e.length&&(t[i].length=e.length,t.splice(i+1)));const n=t[i-1];let s=i,o=0;n&&n.start+n.length>=e.start&&((0,j.G)(n.attribution,e.attribution)?(e.length=e.start-n.start+e.length,e.start=n.start,s=i-1,o=1):(n.length=e.start-n.start,s=n.length<=0?i-1:i)),t[s+1]&&t[s+1].start<e.start+e.length&&(o=Math.max(t.length-s,0)),t.splice(s,o,e)}constructor(e,t){this.logger=e,this.getOrCreateSession=t,this.pendingDeltas=new Map,this.pendingDeltaMutex=new O.e,this.targetWindow=window,this.sendAttributionRangesIfNecessary=async()=>{this.hasPendingDeltas()&&await this.submitPendingDeltas(this.getOrCreateSession)}}shutdown(){this.clearPendingTimeout()}setTargetDocument(e){const t=(null==e?void 0:e.deref())||document;t.defaultView&&(this.targetWindow=t.defaultView)}hasPendingDeltas(){return this.pendingDeltas.size>0}async add(e){var t;const i=e.modelDelta.delta.attributionData;if(0===i.ranges.length&&!i.isFullUpdate)return;const n=await this.pendingDeltaMutex.lock();let s=this.pendingDeltas.get(e.address);s||(s=new Map,this.pendingDeltas.set(e.address,s));const o=this.getKeyFromParentPath(e.parentPath);s.has(o)||s.set(o,[]);const r=null!==(t=s.get(o))&&void 0!==t?t:[];if(i.isFullUpdate)s.set(o,[e]);else{const t=r.findIndex((t=>this.shouldAttemptMergeDeltas(t,e)));if(-1!==t){const e=r[t].modelDelta.delta.attributionData.ranges,n=i.ranges;for(const t of n)this.addOrMerge(t,e)}else r.push(e)}this.pendingTimeoutId||(this.pendingTimeoutId=this.targetWindow.setTimeout(this.sendAttributionRangesIfNecessary,1e3)),n()}async submitPendingDeltas(e){const t=await this.pendingDeltaMutex.lock(),i=new Map(this.pendingDeltas);this.pendingDeltas.clear(),this.clearPendingTimeout(),t();for(const[t,n]of i){const i=await e(t);if(i)for(const e of n.values())for(const t of e)i.submitDelta(t.parentPath,t.modelDelta.delta,t.modelDelta.tileVersion)}}}let B=class{constructor(e,t,i,n,o,l,d,c,u,g,h){this._hostEmitter=e,this._hostSettings=t,this._logger=i,this._e2eMetric=n,this._paragraphDeltasEnabled=o,this._clientSubscribers=l,this._sessionOrPromise=d,this._aggregateLogger=c,this._augloopSessionFactory=u,this._targetDocumentFactory=h,this._sessions=new Map,this._runtimeInstances=new Set,this._listenersInitialized=!1,this._fetchALSessionMutex=new O.e,this._pendingAttributionRangeManager=new W(this._logger,(async e=>this.getOrCreateSession(e))),this.initialize=async()=>{var e,t;this._sessionOrPromise||this._augloopSessionFactory||this._logger.error(509694866,"Failed to initialize AugLoop, there is no runtime available"),this._hostSettings.enableOrchestration&&(this._logger.log(570782413,D.q.Info,"Initializing Orchestrator."),this._hostEmitter.on(r.pD.hostModelParagraphTextTiles,this._handleTiles),this._hostEmitter.on(r.pD.hostModelDelta,this._handleDelta),this._hostEmitter.on(r.pD.hostModelAttributionDelta,this._handleAttributionDelta),this._hostEmitter.on(r.pD.hostModelFormattingDelta,this._handleDelta),this._hostEmitter.on(r.pD.hostModelTextTile,this._handleTile),this._hostEmitter.on(r.pD.hostModelMoveTextTile,this._handleMove));for(const e of this._clientSubscribers)e.register(this,this._augloopDocumentSerializer);this._listenersInitialized=!0,null===(e=this._pendingAttributionRangeManager)||void 0===e||e.setTargetDocument(null===(t=this._targetDocumentFactory)||void 0===t?void 0:t.call(this))},this.shutDown=()=>{this.dispose()},this.deactivateAnnotations=async e=>{const t=(await Promise.all([...this._sessions.keys()].map((t=>{var i;return null===(i=this._sessions.get(t))||void 0===i?void 0:i.releaseAnnotations(e)})))).every(Boolean);return t||this._logger.error(526209822,"Some annotations failed to be deactivated."),t},this.activateAnnotations=async e=>{for(const t of this._sessions.values())await t.activateAnnotations(e)},this.getOrCreateSession=async e=>{var t;const i=await this._fetchALSessionMutex.lock(),n=null!==(t=this._sessions.get(e))&&void 0!==t?t:await this._createSession(e);return i(),n},this.getSessions=async e=>{if(!e)return this._sessions;const t=new Map;for(const i of e)t.set(i,await this.getOrCreateSession(i));return t},this._createSession=async e=>{const t=[];for(const e of this._clientSubscribers)t.push(e.createAnnotationListener());let i="function"==typeof this._sessionOrPromise?await this._sessionOrPromise():this._sessionOrPromise;if(i)this._sessionFromHost=i;else{if(!this._augloopSessionFactory)return;{const{session:t,runtime:n}=await this._augloopSessionFactory(this._augloopDocumentSerializer,e);i=t,n&&this._runtimeInstances.add(n)}}if(!i)return;const n=new a(e,this._logger,t,i,this._aggregateLogger,this._augloopDocumentSerializer,this._hostEmitter,this._clientSubscribers);await n.initialize();for(const e of this._clientSubscribers)e.onInitialize(n);return this._sessions.set(e,n),n},this._handleDelta=async e=>{const t=e.message;if(t.sourceType===m.TileNode)return;const i=await this.getOrCreateSession(e.address);i&&(this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),i.submitDelta([...this._augloopDocumentSerializer.getParentPath(i,t.documentModel),t.tileId],t.delta,t.tileVersion))},this._handleAttributionDelta=async e=>{var t;const i=e.message;if(i.sourceType===m.TileNode)return;const n=await this.getOrCreateSession(e.address);n&&await(null===(t=this._pendingAttributionRangeManager)||void 0===t?void 0:t.add({address:e.address,parentPath:[...this._augloopDocumentSerializer.getParentPath(n,i.documentModel),i.tileId],modelDelta:i}))},this._handleTiles=async e=>{this._paragraphDeltasEnabled.check()||await this._handleTileMessages(e.address,e.message)},this._handleTile=async e=>{this._paragraphDeltasEnabled.check()&&e.message.data.isTextNode&&await this._handleTileMessages(e.address,[e.message])},this._handleTileMessages=async(e,t)=>{const i=await this.getOrCreateSession(e);if(i)for(const n of t){const t=n.data;let o;switch(n.messageType){case k.G.NewData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),o=new s.Xr({parentPath:this._augloopDocumentSerializer.getParentPath(i,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}],prevId:n.data.prevId,nextId:n.data.nextId});break;case k.G.RemoveData:o=new s.n4({parentPath:this._augloopDocumentSerializer.getParentPath(i,t.documentModel),items:[{id:t.tileId,sourceTimestamp:Date.now()}]});break;case k.G.ChangeData:this._e2eMetric.startEntry(`${t.tileId}--${t.tileVersion}`),o=new s.fZ({parentPath:this._augloopDocumentSerializer.getParentPath(i,t.documentModel),items:[{id:t.tileId,body:t.tile,revId:`${t.tileVersion}`,sourceTimestamp:Date.now()}]})}i.submitOperation(o),this._hostEmitter.emit(r.pD.hostModelTextTileEmittedToAugloop,{address:e,message:n})}},this._handleMove=async e=>{const t=e.message;await this._handleTileMessages(e.address,[{messageType:k.G.RemoveData,data:{tileId:t.oldTileId,tileVersion:t.tileVersion,documentModel:t.oldDocumentModel,tile:void 0,changeType:f.Code,isTextNode:!1}},{messageType:k.G.NewData,data:{tileId:t.newTileId,tileVersion:t.tileVersion,documentModel:t.newDocumentModel,tile:t.tile,changeType:f.Code,isTextNode:!1,prevId:t.prevId,nextId:t.nextId}}])},this._augloopDocumentSerializer=null!=g?g:new p(l)}dispose(){var e;this._logger.log(570782414,D.q.Debug,"Shutting down Orchestrator."),this._listenersInitialized||this._logger.log(570782415,D.q.Error,"Trying to delete event listeners in Orchestrator when they have already been deleted.");for(const e of this._clientSubscribers)e.unregister();for(const e of this._sessions.values())e.getSession()!==this._sessionFromHost&&e.close();for(const e of this._runtimeInstances)e.uninitialize();this._sessions.clear(),this._runtimeInstances.clear(),this._listenersInitialized=!1,this._sessionOrPromise=void 0,this._sessionFromHost=void 0,null===(e=this._pendingAttributionRangeManager)||void 0===e||e.shutdown(),this._pendingAttributionRangeManager=void 0}};B=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,q.W)(r.M5)),(0,n.__param)(1,(0,q.W)(v.n)),(0,n.__param)(2,(0,q.W)(y.g)),(0,n.__param)(3,(0,q.W)(R)),(0,n.__param)(4,(0,q.W)(M.H)),(0,n.__param)(5,(0,g.t)(c.T)),(0,n.__param)(5,(0,h.l)()),(0,n.__param)(6,(0,q.W)(_.P)),(0,n.__param)(6,(0,h.l)()),(0,n.__param)(7,(0,h.l)()),(0,n.__param)(7,(0,q.W)(I.v)),(0,n.__param)(8,(0,h.l)()),(0,n.__param)(8,(0,q.W)(l.a)),(0,n.__param)(9,(0,h.l)()),(0,n.__param)(9,(0,q.W)(S)),(0,n.__param)(10,(0,h.l)()),(0,n.__param)(10,(0,q.W)(z.Ze))],B)},749946:(e,t,i)=>{function n(e){return function(e,t){const i=-e.getTimezoneOffset(),n=i>=0?"+":"-";return e.getFullYear()+"-"+s(e.getMonth()+1)+"-"+s(e.getDate())+"T"+s(e.getHours())+":"+s(e.getMinutes())+":"+s(e.getSeconds())+(t?"."+s(e.getMilliseconds()):"")+n+s(i/60)+":"+s(i%60)}(e,!0)}function s(e){const t=Math.floor(Math.abs(e));return(t<10?"0":"")+t}i.d(t,{k:()=>n})},752061:(e,t,i)=>{i.d(t,{Y:()=>n});const n={aa:["aa-ET","Qafar"],af:"af-ZA",agq:["agq-CM","Aghem"],ak:["ak-GH","Akan"],am:"am-ET",ar:"ar-SA",arn:"arn-CL",as:"as-IN",asa:["asa-TZ","Kipare"],ast:["ast-ES","asturianu"],az:["az-Latn-AZ","azərbaycan"],"az-cyrl":["az-Cyrl-AZ","Азәрбајҹан дили (Кирил)"],"az-latn":["az-Latn-AZ","Azərbaycan­ılı (Latın)"],ba:"ba-RU",bas:["bas-CM","Ɓàsàa"],be:"be-BY",bem:["bem-ZM","Ichibemba"],bez:["bez-TZ","Hibena"],bg:"bg-BG",bin:"bin-NG",bm:["bm-Latn-ML","bamanakan"],"bm-latn":["bm-Latn-ML","bamanakan (Latin)"],bn:"bn-BD",bo:"bo-CN",br:"br-FR",brx:["brx-IN","बड़ो"],bs:["bs-Latn-BA","bosanski"],"bs-cyrl":["bs-Cyrl-BA","босански (Ћирилица)"],"bs-latn":["bs-Latn-BA","bosanski (Latinica)"],byn:["byn-ER","ብሊን"],ca:"ca-ES",ccp:["ccp-Cakm-BD","𑄌𑄋𑄴𑄟𑄳𑄦"],"ccp-cakm":["ccp-Cakm-BD","𑄌𑄋𑄴𑄟𑄳𑄦 (𑄌𑄇𑄴𑄟)"],ce:["ce-RU","нохчийн"],ceb:["ceb-Latn-PH","Cebuano"],"ceb-latn":["ceb-Latn-PH","Cebuano (Latin)"],cgg:["cgg-UG","Rukiga"],chr:"chr-Cher-US","chr-cher":"chr-Cher-US",co:"co-FR",cs:"cs-CZ",cu:["cu-RU","церковнослове́нскїй"],cy:"cy-GB",da:"da-DK",dav:["dav-KE","Kitaita"],de:"de-DE",dje:["dje-NE","Zarmaciine"],dsb:"dsb-DE",dua:["dua-CM","duálá"],dv:"dv-MV",dyo:["dyo-SN","joola"],dz:["dz-BT","རྫོང་ཁ"],ebu:["ebu-KE","Kĩembu"],ee:["ee-GH","Eʋegbe"],el:"el-GR",en:"en-US",eo:["eo-001","esperanto"],es:"es-ES",et:"et-EE",eu:"eu-ES",ewo:["ewo-CM","ewondo"],fa:"fa-IR",ff:"ff-Latn-SN","ff-latn":"ff-Latn-SN",fi:"fi-FI",fil:"fil-PH",fo:"fo-FO",fr:"fr-FR",fur:["fur-IT","furlan"],fy:"fy-NL",ga:"ga-IE",gd:"gd-GB",gl:"gl-ES",gn:"gn-PY",gsw:"gsw-CH",gu:"gu-IN",guz:["guz-KE","Ekegusii"],gv:["gv-IM","Gaelg"],ha:["ha-Latn-NG","Hausa"],"ha-latn":["ha-Latn-NG","Hausa (Latin)"],haw:"haw-US",he:"he-IL",hi:"hi-IN",hr:"hr-HR",hsb:"hsb-DE",hu:"hu-HU",hy:"hy-AM",ia:["ia-001","interlingua"],ibb:"ibb-NG",id:"id-ID",ig:"ig-NG",ii:"ii-CN",is:"is-IS",it:"it-IT",iu:["iu-Latn-CA","Inuktitut"],"iu-cans":["iu-Cans-CA","ᐃᓄᒃᑎᑐᑦ (ᖃᓂᐅᔮᖅᐸᐃᑦ)"],"iu-latn":["iu-Latn-CA","Inuktitut (Qaliujaaqpait)"],ja:"ja-JP",jgo:["jgo-CM","Ndaꞌa"],jmc:["jmc-TZ","Kimachame"],jv:"jv-Latn-ID","jv-java":"jv-Java-ID","jv-latn":"jv-Latn-ID",ka:"ka-GE",kab:["kab-DZ","Taqbaylit"],kam:["kam-KE","Kikamba"],kde:["kde-TZ","Chimakonde"],kea:["kea-CV","kabuverdianu"],khq:["khq-ML","Koyra ciini"],ki:["ki-KE","Gikuyu"],kk:"kk-KZ",kkj:["kkj-CM","kakɔ"],kl:"kl-GL",kln:["kln-KE","Kalenjin"],km:"km-KH",kn:"kn-IN",ko:"ko-KR",kok:"kok-IN",kr:"kr-Latn-NG","kr-latn":"kr-Latn-NG",ks:["ks-Arab-IN","کٲشُر"],"ks-arab":["ks-Arab-IN","کٲشُر (اَربی)"],"ks-deva":"ks-Deva-IN",ksb:["ksb-TZ","Kishambaa"],ksf:["ksf-CM","rikpa"],ksh:["ksh-DE","Kölsch"],ku:"ku-Arab-IQ","ku-arab":"ku-Arab-IQ",kw:["kw-GB","kernewek"],ky:"ky-KG",la:"la-001",lag:["lag-TZ","Kɨlaangi"],lb:"lb-LU",lg:["lg-UG","Luganda"],lkt:["lkt-US","Lakȟólʼiyapi"],ln:["ln-CD","lingála"],lo:"lo-LA",lrc:["lrc-IR","لۊری شومالی"],lt:"lt-LT",lu:["lu-CD","Tshiluba"],luo:["luo-KE","Dholuo"],luy:["luy-KE","Luluhia"],lv:"lv-LV",mas:["mas-KE","Maa"],mer:["mer-KE","Kĩmĩrũ"],mfe:["mfe-MU","kreol morisien"],mg:["mg-MG","Malagasy"],mgh:["mgh-MZ","Makua"],mgo:["mgo-CM","metaʼ"],mi:"mi-NZ",mk:"mk-MK",ml:["ml-IN","മലയാളം"],mn:["mn-MN","Монгол хэл"],"mn-cyrl":["mn-MN","Монгол хэл (Кирилл үсэг)"],"mn-mong":["mn-Mong-CN","ᠮᠣᠩᠭᠣᠤᠯ ᠬᠡᠯᠡ (ᠮᠣᠩᠭᠣᠤᠯ ᠬᠡᠯᠡ)"],mni:"mni-IN",moh:"moh-CA",mr:"mr-IN",ms:"ms-MY",mt:"mt-MT",mua:["mua-CM","MUNDAŊ"],my:["my-MM","ဗမာ"],mzn:["mzn-IR","مازرونی"],naq:["naq-NA","Khoekhoegowab"],nb:"nb-NO",nd:["nd-ZW","isiNdebele"],nds:["nds-DE","Neddersass’sch"],ne:"ne-NP",nl:"nl-NL",nmg:["nmg-CM","Kwasio"],nn:"nn-NO",nnh:["nnh-CM","Shwóŋò ngiembɔɔn"],no:["nb-NO","norsk"],nqo:"nqo-GN",nr:["nr-ZA","isiNdebele"],nso:"nso-ZA",nus:["nus-SS","Thok Nath"],nyn:["nyn-UG","Runyankore"],oc:"oc-FR",om:["om-ET","Oromoo"],or:"or-IN",os:["os-GE","ирон"],pa:"pa-IN","pa-arab":"pa-Arab-PK","pa-guru":"pa-IN",pap:"pap-029",pl:"pl-PL",prg:["prg-001","prūsiskan"],prs:"prs-AF",ps:"ps-AF",pt:"pt-BR",quc:"quc-Latn-GT","quc-latn":"quc-Latn-GT",quz:"quz-BO",rm:"rm-CH",rn:["rn-BI","Ikirundi"],ro:"ro-RO",rof:["rof-TZ","Kihorombo"],ru:"ru-RU",rw:"rw-RW",rwk:["rwk-TZ","Kiruwa"],sa:"sa-IN",sah:"sah-RU",saq:["saq-KE","Kisampur"],sbp:["sbp-TZ","Ishisangu"],sd:"sd-Arab-PK","sd-arab":"sd-Arab-PK","sd-deva":"sd-Deva-IN",se:"se-NO",seh:["seh-MZ","sena"],ses:["ses-ML","Koyraboro senni"],sg:["sg-CF","Sängö"],shi:["shi-Tfng-MA","ⵜⴰⵛⵍⵃⵉⵜ"],"shi-latn":["shi-Latn-MA","Tashelḥiyt (Latin)"],"shi-tfng":["shi-Tfng-MA","ⵜⴰⵛⵍⵃⵉⵜ (Tifinagh)"],si:"si-LK",sk:"sk-SK",sl:"sl-SI",sma:"sma-SE",smj:"smj-SE",smn:"smn-FI",sms:"sms-FI",sn:["sn-Latn-ZW","chiShona"],"sn-latn":["sn-Latn-ZW","chiShona (Latin)"],so:["so-SO","Soomaali"],sq:"sq-AL",sr:["sr-Latn-RS","srpski"],"sr-cyrl":["sr-Cyrl-RS","српски (Ћирилица)"],"sr-latn":["sr-Latn-RS","srpski (latinica)"],ss:["ss-ZA","Siswati"],ssy:["ssy-ER","Saho"],st:"st-ZA",sv:"sv-SE",sw:"sw-KE",syr:"syr-SY",ta:"ta-IN",te:"te-IN",teo:["teo-UG","Kiteso"],tg:["tg-Cyrl-TJ","Тоҷикӣ"],"tg-cyrl":["tg-Cyrl-TJ","Тоҷикӣ (Кирилликӣ)"],th:"th-TH",ti:"ti-ER",tig:["tig-ER","ትግረ"],tk:"tk-TM",tn:"tn-ZA",to:["to-TO","lea fakatonga"],tr:"tr-TR",ts:["ts-ZA","Xitsonga"],tt:"tt-RU",twq:["twq-NE","Tasawaq senni"],tzm:["tzm-Latn-DZ","Tamaziɣt n laṭlaṣ"],"tzm-arab":"tzm-Arab-MA","tzm-latn":["tzm-Latn-DZ","Tamaziɣt n laṭlaṣ (Latin)"],"tzm-tfng":["tzm-Tfng-MA","Tamazight (Tifinagh)"],ug:"ug-CN",uk:"uk-UA",ur:"ur-PK",uz:"uz-Latn-UZ","uz-arab":["uz-Arab-AF","اوزبیک (عربی)"],"uz-cyrl":["uz-Cyrl-UZ","Ўзбек (Кирил)"],"uz-latn":"uz-Latn-UZ",vai:["vai-Vaii-LR","ꕙꔤ"],"vai-latn":["vai-Latn-LR","Vai (Latin)"],"vai-vaii":["vai-Vaii-LR","ꕙꔤ (Vai)"],ve:["ve-ZA","Tshivenḓa"],vi:"vi-VN",vo:["vo-001","Volapük"],vun:["vun-TZ","Kyivunjo"],wae:["wae-CH","Walser"],wal:["wal-ET","ወላይታቱ"],wo:"wo-SN",xh:"xh-ZA",xog:["xog-UG","Olusoga"],yav:["yav-CM","nuasue"],yi:["yi-001","ייִדיש"],yo:"yo-NG",zgh:["zgh-Tfng-MA","ⵜⴰⵎⴰⵣⵉⵖⵜ"],"zgh-tfng":["zgh-Tfng-MA","ⵜⴰⵎⴰⵣⵉⵖⵜ (Tifinagh)"],zh:["zh-CN","中文"],"zh-hans":"zh-CN","zh-hant":["zh-HK","中文(繁體)"],zu:"zu-ZA"}},752956:(e,t,i)=>{if(i.d(t,{S:()=>u,z:()=>c}),0!=i.j)var n=i(494888);if(0!=i.j)var s=i(163573);if(0!=i.j)var o=i(251439);if(0!=i.j)var r=i(90393);if(0!=i.j)var a=i(961147);if(0!=i.j)var l=i(370137);if(0!=i.j)var d=i(895463);const c=(0,i(668952).f)("ISquigglerOptionsFactory");class u{constructor(){this.imports=[]}get uniqueId(){return(0,o.z)(507918274)}configureRootServices(e){e.bind(c).toDynamicValue((e=>{const t=e.get(n.c),i=e.get(s.n),o=e.getOptional(a.p);return(e={})=>{const n=t.flags.enableSvgSquiggleUnderline?r.N.SVG:i.sessionType===s.d.OWA_New_Email||i.sessionType===s.d.OWA_Draft_Email?r.N.OFFICE:r.N.GENERIC;e.edgeCases=null==o?void 0:o.getEdgeCases(),e.visibilityTracker=t.flags.enableVisibilityTracker?new l.J:l.Y,e.throttleUpdates=t.flags.enableSquigglesUpdateThrottling,e.visibilityTrackerShouldTrackSquiggles=t.flags.visibilityTrackerShouldTrackSquiggles,e.mutationObserverBasedRelativePosition=t.flags.mutationObserverBasedRelativePosition,e.enableCursorIntersectionObserver=t.flags.enableCursorIntersectionObserver,e.disableAutoBrowserVirtualizationOfSquiggles=t.flags.disableAutoBrowserVirtualizationOfSquiggles;let a=d.j.none;t.flags.enableAriaStatusElement&&(t.flags.enableCssHighlightApiAnnouncementsOnly?a|=d.j.cssHighlightsAPIAnnouncement:a|=d.j.appearance|d.j.highlight,t.flags.enableLineNavAriaAnnouncement&&(a|=d.j.lineNavigation));const c=e;return c.restoreCaretPosition=!!i.enableCaretPositionRestore,c.ariaFeatures=a,c.tooltipEnabled=!!i.showSquiggleTooltip,c.disableSquiggleTooltipOnTextSelection=!!i.disableSquiggleTooltipOnTextSelection,c.squiggleStyleType=n,c.autoCorrectionEnabled=i.enableAutoCorrect,c.personalizedAutoCorrectionEnabled=i.enablePersonalizedAutoCorrect,c.autoCorrectionInputCacheEnabled=i.enableAutoCorrect&&t.flags.enableAutoCorrectInputCache,c.trackProofingElementsPositionEnabled=i.dynamicProofingElementsEnabled,c.disableRangeWhenApplyingCritiqueSuggestions=i.disableRangeWhenApplyingCritiqueSuggestions,c.disableOpenAutoCorrectCalloutOnHover=i.disableOpenAutoCorrectCalloutOnHover,c}}))}}},753031:(e,t,i)=>{var n;i.d(t,{q:()=>n}),function(e){e[e.Info=0]="Info",e[e.Warn=1]="Warn",e[e.Error=2]="Error",e[e.Debug=3]="Debug"}(n||(n={}))},754270:(e,t,i)=>{var n,s;i.d(t,{f:()=>s,n:()=>n}),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized",e.ActionDisableCritique="ActionDisableCritique",e.OverflowMenuClicked="OverflowMenuClicked",e.UndoCalloutShown="UndoCalloutShown",e.PersonalizedUndoCalloutShown="PersonalizedUndoCalloutShown",e.SquiggleTooltipShown="SquiggleTooltipShown",e.CritiquesShown="CritiquesShown"}(n||(n={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError"}(s||(s={}))},756601:e=>{e.exports=JSON.parse('{"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Références géopolitiques sensibles","IsImplemented":true},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Error Corrections":{"LocalizedName":"Correction d\'erreurs","IsImplemented":false},"Resume":{"LocalizedName":"CV","IsImplemented":true},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Orthographe"},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Ponctuation"},"Formality":{"LocalizedName":"Langage formel","IsImplemented":true},"Inclusiveness":{"LocalizedName":"Langage non-discriminant","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concision","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Cohérence"},"Typing errors":{"LocalizedName":"Fautes de frappe","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulaire"},"Rewrite":{"LocalizedName":"Reformulations","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Grammar":{"LocalizedName":"Grammaire","IsImplemented":true},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Conventions"},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronymes"},"Clarity":{"IsImplemented":false,"LocalizedName":"Clarté"}}')},756857:(e,t,i)=>{i.d(t,{H:()=>n});const n=(0,i(668952).f)("ILocalizer")},757439:(e,t,i)=>{if(i.d(t,{E:()=>d}),0!=i.j)var n=i(335009);if(0!=i.j)var s=i(355476);if(0!=i.j)var o=i(174077);if(0!=i.j)var r=i(433531);if(0!=i.j)var a=i(748903);if(0!=i.j)var l=i(251439);class d{constructor(){this.imports=[r.g]}get uniqueId(){return(0,l.z)(507918371)}configureRootServices(e){e.bind(o.J).to(a.r),e.bind(n.G).to(s.h)}}},760279:(e,t,i)=>{i.d(t,{l:()=>U});var n=i(379490),s=i(756857),o=i(537969),r=i(184226),a=i(118673),l=i(39952),d=i(465701),c=i(753031),u=i(728671),g=i(163573),h=i(877931),p=i(671303),m=i(494888),f=i(229906),v=i(83010),y=i(427603),_=i(817596),I=i(576516),C=i(657338),S=i(243879),b=i(429712),T=i(857132),E=i(928452),N=i(538045),w=i(157698),x=i(104072),L=i(77127),D=i(323283),A=i(343154),F=i(564333),q=i(811861),R=i(287587),P=i(175602),O=i(377253),k=i(208520);const M=k.memo((e=>{var t,i,n,s,o,r,a;const{hostSettings:l,isMobile:d,languageScriptDirectionDetector:c,predictionStateStore:u,themeStore:g}=e,h=u.predictionContentEditableParentElement,p=k.createRef(),[m,f]=k.useState(u.prediction),[v,y]=k.useState(u.predictionDisplayText),_=k.useCallback((()=>{u.prediction&&u.predictionDisplayText&&(f(u.prediction),y(u.predictionDisplayText))}),[u.prediction,u.predictionDisplayText]);k.useEffect((()=>(u.setOnUpdate(_),()=>{u.setOnUpdate(void 0)})),[u,_]);const C=k.useCallback((e=>{u.onEntityDropdownOpened(m,e)}),[u,m]),S=k.useCallback((async e=>{var t,i,n;A.x.isKey(e,F.m.tab)?(e.stopPropagation(),e.preventDefault(),(null===(t=u.prediction)||void 0===t?void 0:t.entityResults)&&u.prediction.entityResults.entities.length>1&&(u.prediction.entityType!==I.c.PIM||(null===(n=null===(i=l.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===n?void 0:n.enablePimMultiPredict))?p.current&&C(p.current):await u.applyCurrentPrediction(e.keyCode)):A.x.isKey(e,[F.m.arrowLeft,F.m.arrowRight,F.m.escape])?await u.clearCurrentPrediction(m,"invalid key press",q.R8.ExplicitRejection):A.x.isKey(e,[F.m.arrowUp,F.m.arrowDown,F.m.enter])&&(u.multiPredictionMenuOpen||await u.clearCurrentPrediction(m,"invalid key press",q.R8.ExplicitRejection))}),[null===(i=null===(t=l.serviceSettings)||void 0===t?void 0:t.predictions)||void 0===i?void 0:i.enablePimMultiPredict,C,m,u,p]),b=k.useCallback((async e=>{e.preventDefault(),e.stopPropagation(),d&&await u.applyCurrentPrediction(q.XG)}),[d,u]),T=k.useCallback((async e=>{if(!p.current)return;let t=Array.from(p.current.getClientRects());t=t.map((e=>{return t=e,new DOMRect(t.x-z,t.y-j,t.width+z+z,t.height+j+j);var t})),t.find((t=>{return i=t,n=e.pageX,s=e.pageY,i.x<=n&&n<=i.x+i.width&&i.y<=s&&s<=i.y+i.height;var i,n,s}))&&(e.preventDefault(),e.stopPropagation(),await u.applyCurrentPrediction(q.XG))}),[p,u]),E=k.useCallback((async e=>{m.isHelperText&&((0,P.mU)(e.target)||(0,P.mU)(e.relatedTarget))||u.multiPredictionMenuOpen||await u.clearCurrentPrediction(m,"lost focus",q.R8.ImplicitRejection)}),[m,u]),N=k.useCallback((async()=>{await u.isInputPointerAtPrediction()||await u.clearCurrentPrediction(m,"input pointer not at prediction",q.R8.ImplicitRejection)}),[m,u]);k.useEffect((()=>{const e={passive:!0,capture:!0},t=h&&new D.J(h),i=new D.J(document);return null==t||t.addListener("keydown",S),null==t||t.addListener("focusout",E,e),i.addListener("selectionchange",N,e),()=>{null==t||t.removeAllListeners(),i.removeAllListeners()}}),[h,S,E,N]),k.useEffect((()=>{if(!p.current)return;const e=new D.J(p.current),t=new D.J(document);return e.addListener("pointerdown",b,{capture:!0}),d&&t.addListener("pointerdown",T,{capture:!0}),()=>{e.removeAllListeners(),t.removeAllListeners()}}),[T,b,d,p]),k.useEffect((()=>{var e,t,i;null===(i=null===(t=null===(e=l.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onPredictionUpdate)||void 0===i||i.call(t)}),[null===(n=l.serviceSettings)||void 0===n?void 0:n.predictions,v]);const w=k.useCallback((e=>Promise.resolve()),[]);return h?k.createElement("span",{className:"suggestedCompletion",ref:p},k.createElement(R.J,{hostSettings:l,themeStore:g}),(0,O.r)(u.localizer,d,c,m,v,u.predictionParentElement,C,w,m.isHelperText&&"BizChat"===(null===(s=l.hostMetadata)||void 0===s?void 0:s.appName)?4:void 0,null===(r=null===(o=l.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===r?void 0:r.enablePimMultiPredict,null===(a=l.hostMetadata)||void 0===a?void 0:a.appName)):null}));const z=20,j=20;var W=i(225443),B=i(794329);let U=class extends W.p{constructor(e,t,i,n,s,o,r,a,l,d,c,u,g,h,p,m,f,v,y){super(e,t,i,n,s,o,r,a,l,d,c,f,m),this._ariaStatusStateStoreFactory=u,this._featureFlagsReader=g,this._themeStore=h,this.languageScriptDirectionDetector=p,this.compositionEventHandler=v,this._isMobile=y,this.shutDown=()=>{this._predictionHTMLElement=void 0,super.shutDown()},this.isInputPointerAtPrediction=async()=>{var e;if(this._prediction&&this._multiPredictionMenuOpen)return!0;const t=await this._tileContent.getTextSelection();return!!t&&(!!this._prediction&&(t.startPosition===t.endPosition&&(null===(e=t.startParagraphNode)||void 0===e?void 0:e.id)===this._prediction.tileId&&t.endPositionInParagraphNode===this._prediction.currentEndIndex))},this.predictionMayOverlapNextLine=e=>Promise.resolve()}allowMiddleOfSentencePredictions(){var e,t,i;return null!==(i=null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.allowMiddleOfSentencePredictions)&&void 0!==i&&i}async applyCurrentPrediction(e,t){var i,n,s;if(!this._prediction)return;const o=this._prediction;if(o.isHelperText)return;const r=this.determineIfPredictionTextIsValid(o);if("result"in r)return void await this.clearCurrentPrediction(o,"invalid application",q.R8.ImplicitRejection);const{paragraphNode:a,paragraphNodeOffset:l,insertableTextStart:d,predictionText:c}=r,u=c.substring(d);let g;if(g=this.isEntityPrediction(o.entityType)&&o.entityResults&&d!==o.startIndex?await this._tileContent.getRangeOfNode(a.parent,void 0,l+o.startIndex,d-o.startIndex):await this._tileContent.getNodeInsertionPosition(a.parent,l+d,!0),await this._predictionStore.clearPrediction(),this.isEntityPrediction(o.entityType)&&o.entityResults){const e=null!=t?t:this.getPredictionFirstItem(o);e&&g&&(null===(n=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.predictions)||void 0===n?void 0:n.onInsertEntityPrediction)&&this._hostSettings.serviceSettings.predictions.onInsertEntityPrediction(o,e,g,a.parent.element)}else await this._tileContent.insert(a.parent,void 0,l+d,u,!0,g,!1,!1),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(s=this._ariaStatusStateStoreFactory())||void 0===s||s.setStatus(this._localizer.getMessage("ebx_PredictionAppliedMessage",u),"assertive",!1));this.logAcceptedTelemetry(o,d-o.startIndex,!0,e,!!o.entityResults)}async onPredictionUpdated(){var e,t;const i=this._predictionUpdate+1;this._predictionUpdate=i;const n=this._predictionStore.getCurrentPrediction();if(n)await this.determineIfPredictionIsValidAndApply(n,i);else{const i=this._predictionHTMLElement,n=this._predictionParentElement;if(this._prediction=void 0,this._predictionParentElement=void 0,this._predictionContentEditableParentElement=void 0,this._predictionDisplayText=void 0,this._predictionFirstDisplayedTime=void 0,this._predictionHTMLElement=void 0,i)if(B.unmountComponentAtNode(i),null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.predictions)||void 0===t?void 0:t.onDomRemoval)this._hostSettings.serviceSettings.predictions.onDomRemoval(i,n);else{const e=i.parentElement;i.remove(),e&&"div"===e.nodeName.toLowerCase()&&!e.textContent&&0===e.childElementCount&&e.appendChild(e.ownerDocument.createElement("br"))}this._onUpdate&&this._onUpdate()}}isSearchBoxClearButtonInEccCalloutActive(){var e;if(null===(e=document.activeElement)||void 0===e?void 0:e.className.includes("fui-SearchBox__dismiss")){let e=document.activeElement;for(;e;){if(e.className.includes("ms-ecc-callout"))return!0;const t=e.parentElement;if(!t)break;e=t}}return!1}async determineIfPredictionIsValidAndApply(e,t,i,n,s,o,r){var a,l,d,g,h,p;if(!this.supportsPredictionType(e.entityType))return void await this.clearCurrentPrediction(e,"unsupported entity type: "+e.entityType,q.R8.NotSeen);if(void 0!==s&&s!==u.Q0.Local&&o&&n&&i)return void await this.handleRemotePredictionUpdate(e,i,n,o);if(n&&n!==e.tileId)return void await this.clearCurrentPrediction(e,"update outside of tile",q.R8.ExplicitRejection);const m=this.determineIfPredictionTextIsValid(e,o,r);if("result"in m){if(m.dueToMissingContainingHTMLElement)return;return void(m.dueToEntirePredictionTyped?await this._predictionStore.clearPrediction():await this.clearCurrentPrediction(e,"invalid delta",q.R8.TypeNotMatchingCharacter))}const{insertableTextStart:f,htmlParentElement:v,contentEditableHtmlParentElement:y,predictionText:I}=m;if(this._prediction=e,this._predictionParentElement=v,this._predictionContentEditableParentElement=y,I.substring(f)!==this._predictionDisplayText){if(this._predictionDisplayText=I.substring(f),!this._predictionHTMLElement){if(null===(a=this.compositionEventHandler)||void 0===a?void 0:a.isComposing)return void(this._predictionHTMLElement=void 0);if(this._predictionHTMLElement=v.ownerDocument.createElement("span"),this._predictionHTMLElement.contentEditable="false",this._predictionHTMLElement.classList.add("ms-prediction"),null===(l=this.compositionEventHandler)||void 0===l?void 0:l.isComposing)return void(this._predictionHTMLElement=void 0);if(t<this._predictionUpdate)return;if(this.isSearchBoxClearButtonInEccCalloutActive())return;const i=this._predictionHTMLElement.ownerDocument.getSelection(),n=1===(null==i?void 0:i.rangeCount)?i.getRangeAt(0):void 0;if(!n)return this._logger.log(524882904,c.q.Warn,"Unable to find range of prediction text insertion point in PredictionStateStore."),void await this.clearCurrentPrediction(e,"unable to determine range for prediction",q.R8.NotSeen);{const t=k.createElement(M,{predictionStateStore:this,themeStore:this._themeStore,isMobile:null!==(d=this._isMobile)&&void 0!==d&&d,hostSettings:this._hostSettings,languageScriptDirectionDetector:this.languageScriptDirectionDetector});if((0,_.d)(this._predictionHTMLElement,t),null===(h=null===(g=this._hostSettings.serviceSettings)||void 0===g?void 0:g.predictions)||void 0===h?void 0:h.onDomInsertion){if(!this._hostSettings.serviceSettings.predictions.onDomInsertion(n,this._predictionHTMLElement,v))return void await this.clearCurrentPrediction(e,"host unable to insert prediction",q.R8.NotSeen)}else n.insertNode(this._predictionHTMLElement),i&&i.setBaseAndExtent(n.startContainer,n.startOffset,n.startContainer,n.startOffset)}this._predictionFirstDisplayedTime=new Date,this.logDisplayedTelemetry(e),this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(p=this._ariaStatusStateStoreFactory())||void 0===p||p.setStatus(this._localizer.getMessage(this._isMobile?"ebx_MobilePredictionAvailableMessage":"ebx_PredictionAvailableMessage",e.text),"assertive",!1))}this._onUpdate&&this._onUpdate()}}checkForECCHintTextPrediction(){var e,t,i,n,s,o,r;const a=null===(e=this._inlineSuggestionsRenderer)||void 0===e?void 0:e.getCurrentMenuInfo();if(!a||a.searchBoxGeneratedParagraphId||"InlineSuggestionsResultsUserInitiatedMenuType"!==a.menuType.menuType||a.queryRange.length!==(null!==(i=null===(t=a.queryRange.prefix)||void 0===t?void 0:t.length)&&void 0!==i?i:1)||!(null===(n=this._hostSettings.oaSettings)||void 0===n?void 0:n.enableZeroQueryHintText)&&(!a.enableExpandedECC||!a.enableExpandedECCSearchBar))return!1;const l=this._paragraphTextExtractor.getParagraphText(a.tileId),d=a.queryRange.start+(null!==(o=null===(s=a.queryRange.prefix)||void 0===s?void 0:s.length)&&void 0!==o?o:1),c="BizChat"===(null===(r=this._hostSettings.hostMetadata)||void 0===r?void 0:r.appName)?this.localizer.getMessage("ebx_ECCZeroQueryBizChatHintText")+" ":this.localizer.getMessage("ebx_ECCZeroQueryHintText")+" ";return this._predictionStore.updatePrediction({text:c,context:null==l?void 0:l.substring(0,d),annotationId:"1",tileId:a.tileId,tileVersion:0,entityType:I.c.Text,startIndex:d,length:c.length,shouldDismissOnTextChange:!0,shouldShowInsertionHelperText:!1,isHelperText:!0}),!0}};U=(0,n.__decorate)([(0,f._)(),(0,n.__param)(0,(0,v.W)(s.H)),(0,n.__param)(1,(0,v.W)(g.n)),(0,n.__param)(2,(0,v.W)(h.g)),(0,n.__param)(3,(0,v.W)(p.m)),(0,n.__param)(4,(0,v.W)(T.o)),(0,n.__param)(5,(0,v.W)(N.w)),(0,n.__param)(6,(0,v.W)(w.b)),(0,n.__param)(7,(0,v.W)(x.d)),(0,n.__param)(8,(0,v.W)(o.M5)),(0,n.__param)(9,(0,y.l)()),(0,n.__param)(9,(0,v.W)(C.A)),(0,n.__param)(10,(0,y.l)()),(0,n.__param)(10,(0,v.W)(S.V)),(0,n.__param)(11,(0,v.W)(b.Th)),(0,n.__param)(12,(0,v.W)(m.c)),(0,n.__param)(13,(0,v.W)(L.YQ)),(0,n.__param)(14,(0,v.W)(r.iw)),(0,n.__param)(15,(0,v.W)(a.o)),(0,n.__param)(16,(0,y.l)()),(0,n.__param)(16,(0,v.W)(E.Y)),(0,n.__param)(17,(0,y.l)()),(0,n.__param)(17,(0,v.W)(l.q)),(0,n.__param)(18,(0,y.l)()),(0,n.__param)(18,(0,v.W)(d.n))],U)},760995:(e,t,i)=>{if(i.d(t,{R:()=>o}),0!=i.j)var n=i(753031);if(0!=i.j)var s=i(46692);class o{static logUnhandledError(e,t,i,o){e.logEvent(508055843,i,n.q.Error,o,s.o.SamplingPolicy.CriticalExperimentation,t)}static addUnhandledExceptionsListeners(e,t,i){}}},761799:(e,t,i)=>{i.d(t,{Ey:()=>r,mq:()=>n,nz:()=>s});var n,s,o=i(668952);!function(e){e[e.Days=0]="Days",e[e.Suggestions=1]="Suggestions"}(n||(n={})),function(e){e[e.Visible=0]="Visible",e[e.Hidden=1]="Hidden"}(s||(s={}));const r=(0,o.f)("IUpsellStore")},762413:(e,t,i)=>{if(i.d(t,{N:()=>s,z:()=>o}),0!=i.j)var n=i(67573);function s(e){let t=0;return e.delete&&(t|=n.lb.Delete),e.ignore&&(t|=n.lb.Ignore),e.ignoreAll&&(t|=n.lb.IgnoreAll),e.ignoreCritiqueType&&(t|=n.lb.IgnoreCritiqueType),e.addToDictionary&&(t|=n.lb.AddToDictionary),e.showDetails&&(t|=n.lb.ShowDetails),t}function o(e){return 0===e?r:{notificationOnly:!1,delete:0!==(e&n.lb.Delete),ignore:0!==(e&n.lb.Ignore),ignoreAll:0!==(e&n.lb.IgnoreAll),ignoreCritiqueType:0!==(e&n.lb.IgnoreCritiqueType),addToDictionary:0!==(e&n.lb.AddToDictionary),showDetails:0!==(e&n.lb.ShowDetails)}}const r={notificationOnly:!0,delete:!1,ignore:!1,ignoreAll:!1,ignoreCritiqueType:!1,addToDictionary:!1,showDetails:!1}},762815:(e,t,i)=>{function n(e){return null===e?null:e.scrollHeight>e.clientHeight?e:n(e.parentNode)}i.d(t,{m:()=>n})},763855:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Litriú"}}')},765062:(e,t,i)=>{if(i.d(t,{V:()=>s}),0!=i.j)var n=i(71357);const s=()=>(0,n.y)((e=>({state:"Loading",setState:t=>e({state:t}),suggestionEntityGroup:[],lastResolvedDataSourceName:void 0,setLastResolvedDataSourceName:t=>e({lastResolvedDataSourceName:t}),setSuggestionGroups:(t,i)=>e((()=>({suggestionEntityGroup:t,state:i})))})))},766535:(e,t,i)=>{var n,s,o;function r(e){return e?Object.values(s).find((t=>t===e)):void 0}function a(e){const t=new Set([s.CIQFlag_DateEntityRecognition,s.CIQFlag_PersonEntityRecognition,s.CIQFlag_Location,s.CIQFlag_LocalBusiness,s.CIQFlag_TaskRecognition,s.HeadingDetection,s.CIQFlag_Topic,s.CIQFlag_SatoriEntityRecognition,s.CIQFlag_File,s.CIQFlag_Time]);return!!e&&t.has(e)}i.d(t,{L9:()=>s,bx:()=>n,e3:()=>r,oe:()=>a}),function(e){e[e.High=0]="High",e[e.Medium=1]="Medium",e[e.Low=2]="Low",e[e.Informational=3]="Informational"}(n||(n={})),function(e){e.ContextualSpelling="818bcdbe-64ce-46e8-a3d7-75a1ea8365a8",e.WrongSpelling="363d7011-83dd-4cc0-bdec-ea4af4df4dbb",e.TonalRewrite="965c8b90-32a3-4451-8c09-eba2c163dcec",e.TopicSuggestion="9bf58f9f-4159-40a1-80b8-4fe1f87c010d",e.CIQFlag_Location="1d456e3c-f436-4b8f-a315-1cc430bc2ee1",e.CIQFlag_LocalBusiness="1ECDDA98-C954-9863-87BD-4B0F493558FB",e.CIQFlag_PersonEntityRecognition="ffa21afe-fab3-423c-b579-8de8-128429f1cc8e",e.CIQFlag_DateEntityRecognition="349483fb-b654-4b4c-aefe-9f22bf147cd7",e.CIQFlag_TaskRecognition="c45ba192-bfae-4965-a833-694b55b1bd1d",e.CIQFlag_Topic="21422617-6650-456a-97cd-a7cd3116c39c",e.HeadingDetection="37e3346c-be6a-462c-afd7-282da13f6328",e.CIQFlag_SatoriEntityRecognition="9d9ccfb3-598c-e24c-3cda-11d260ae57d3",e.CIQFlag_File="17f49c82-b9f8-42d0-ab4e-dc076355d77a",e.CIQFlag_Time="9bd06192-906b-4693-99d3-7d58a1cf1770",e.Synonyms="23bd41d4-28ac-4cbc-ba24-2bba684c07da",e.DoubleSpaceGrammar="6d1d8c3d-62d5-45d1-b850-d8a98a24964b"}(s||(s={})),function(e){e.IgnoreOnce="IgnoreOnce",e.IgnoreAll="IgnoreAll",e.ApplySuggestion="ApplySuggestion",e.DisableCritiqueType="DisableCritiqueType",e.ShowFeedback="ShowFeedback"}(o||(o={}))},769263:(e,t,i)=>{i.d(t,{z:()=>n});const n=(0,i(668952).f)("IEditorSettingsState")},770235:(e,t,i)=>{var n,s,o,r,a,l;i.d(t,{G_:()=>a}),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(n||(n={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(s||(s={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(o||(o={})),function(e){e.GCC="GCC",e.Worldwide="WW"}(r||(r={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(l||(l={}))},771588:(e,t,i)=>{i.d(t,{V:()=>n});const n=(0,i(668952).f)("IRegistrar")},772185:(e,t,i)=>{if(i.d(t,{N:()=>S}),0!=i.j)var n=i(934116);if(0!=i.j)var s=i(642810);if(0!=i.j)var o=i(961223);if(0!=i.j)var r=i(347601);if(0!=i.j)var a=i(997041);if(0!=i.j)var l=i(262281);if(0!=i.j)var d=i(611103);if(0!=i.j)var c=i(163573);if(0!=i.j)var u=i(354339);if(0!=i.j)var g=i(648336);if(0!=i.j)var h=i(243879);if(0!=i.j)var p=i(251439);if(0!=i.j)var m=i(386675);if(0!=i.j)var f=i(657338);if(0!=i.j)var v=i(639007);if(0!=i.j)var y=i(712551);if(0!=i.j)var _=i(225916);if(0!=i.j)var I=i(27335);if(0!=i.j)var C=i(239835);class S{constructor(){this.imports=[s.d,n.w]}get uniqueId(){return(0,p.z)(507918360)}configureRootServices(e){var t,i;e.bind(m.S).to(o.v),e.bind(r.C).to(r.L),e.bind(f.A).to(C.Z),e.bind(h.V).to(v.W),e.bind(m.S).toExisting(h.V),e.bind(y.Z).toSelf();(null===(i=null===(t=e.get(c.n).oaSettings)||void 0===t?void 0:t.enableECCForMobileDevice)||void 0===i?void 0:i.enabled)?(e.bind(u.j).to(_.g),e.bind(g.e).to(I.d)):e.bind(u.j).to(l.X),e.bind(d.D).to(a.z)}}},772830:(e,t,i)=>{i.d(t,{i:()=>p,n:()=>h});var n=i(379490),s=i(807582),o=i(609062),r=i(551268),a=i(256002),l=i(326323),d=i(668952),c=i(229906),u=i(83010),g=i(427603);const h=(0,d.f)("ITextEventPublisher");let p=class extends s.z{constructor(e,t){super(),this._settings=e,this._timer=null!=t?t:new a.k}dispose(){return this._timer.shutDown(),Promise.resolve()}publishTextChangeEvent(e,t){this.publishEvent("textChange",{data:e,messageType:t}),this.scheduleSendIdleTextEvent(e,t)}publishTextStyleEvent(){this.publishEvent("styleChange",{})}scheduleSendIdleTextEvent(e,t){if(this._settings.enableTileNodeAutoReconciliation&&0!==e.length)for(const i of e)i.mutationChangeType!==o.Q0.Code&&(this._timer.clearTimer(i.tileNodeId),this._timer.setTimeout(i.tileNodeId,(()=>{this.publishEvent("textChange",{data:[{tileNodeId:i.tileNodeId,text:i.text,mutationChangeType:o.Q0.Code,rehydrateCritiques:!0,idleReconcileTrigger:!0,optimizedRehydrationEnabled:i.optimizedRehydrationEnabled,useDirtyParagraphReconciliation:this._settings.useDirtyParagraphReconciliation}],messageType:t}),this._timer.clearTimer(i.tileNodeId)}),this._settings.reconcileTileNodeTime))}};p=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.W)(r.k)),(0,n.__param)(1,(0,g.l)()),(0,n.__param)(1,(0,u.W)(l.J))],p)},773557:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Ortografia"}}')},773895:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concisione","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Coerenza formale"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Linguaggio inclusivo","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Errori di digitazione"},"Clarity":{"IsImplemented":false,"LocalizedName":"Chiarezza"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Rewrite":{"IsImplemented":false,"LocalizedName":"Riscrittura"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Correzione degli errori"},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Scelte lessicali","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammatica"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"Registro formale","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Punteggiatura"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Convenzioni di scrittura"},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Curriculum Vitae"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Riferimenti geopolitici problematici"}}')},774592:(e,t,i)=>{i.d(t,{H:()=>l});var n=i(379490),s=i(229906),o=i(83010),r=i(163573),a=i(494888);let l=class{constructor(e,t){this._hostSettings=e,this._featureFlagsReader=t}check(){return!!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableParagraphUpdates&&this._featureFlagsReader.flags.enableParagraphDeltas}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.n)),(0,n.__param)(1,(0,o.W)(a.c))],l)},777555:(e,t,i)=>{i.d(t,{b0:()=>r,c0:()=>o,hN:()=>s,pT:()=>a});var n=i(668952);const s=(0,n.f)("ISentenceTextUnitSeparator"),o=(0,n.f)("IParagraphTextUnitSeparator"),r=(0,n.f)("IDefaultTextUnitSeparator"),a=(0,n.f)("IDocumentTextUnitSeparator")},778661:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"მართლწერა","IsImplemented":true}}')},779140:(e,t,i)=>{if(i.d(t,{I6:()=>W,Yx:()=>M,cf:()=>B,fQ:()=>j,gs:()=>z,sb:()=>k}),0!=i.j)var n=i(852748);if(0!=i.j)var s=i(774592);if(0!=i.j)var o=i(234979);if(0!=i.j)var r=i(537969);if(0!=i.j)var a=i(355495);if(0!=i.j)var l=i(442316);if(0!=i.j)var d=i(922630);if(0!=i.j)var c=i(401322);if(0!=i.j)var u=i(18233);if(0!=i.j)var g=i(233653);if(0!=i.j)var h=i(105244);if(0!=i.j)var p=i(743514);if(0!=i.j)var m=i(701121);if(0!=i.j)var f=i(551268);if(0!=i.j)var v=i(229464);if(0!=i.j)var y=i(335009);if(0!=i.j)var _=i(83605);if(0!=i.j)var I=i(58215);if(0!=i.j)var C=i(799116);if(0!=i.j)var S=i(538045);if(0!=i.j)var b=i(742397);if(0!=i.j)var T=i(972113);if(0!=i.j)var E=i(342892);if(0!=i.j)var N=i(302246);if(0!=i.j)var w=i(879190);if(0!=i.j)var x=i(104072);if(0!=i.j)var L=i(553164);if(0!=i.j)var D=i(68800);if(0!=i.j)var A=i(1144);if(0!=i.j)var F=i(547956);if(0!=i.j)var q=i(878790);if(0!=i.j)var R=i(432648);if(0!=i.j)var P=i(488776);if(0!=i.j)var O=i(808320);const k=e=>{e.bind(b.q).toDynamicValue((()=>()=>new q.j))},M=e=>{e.bind(m.WP).toDynamicValue((e=>{const t=e.get(n.G),i=e.get(l.g),a=e.get(E.t),g=e.get(N.B),h=e.get(f.k),p=e.get(y.G),m=e.get(S.w),C=e.get(x.d),b=e.get(d.n),T=e.get(s.H),w=e.get(o.W),A=e.get(v.d),F=e.get(I.W),q=e.getAll(r.zJ),P=e.getOptional(c.J),k=e.getOptional(_.M),M=e.get(u.c);return(e,n,s,o,r,l,d)=>{switch(e){case L.Z.OutlineNode:return new D.T(n,r,s,o,d);case L.Z.TerminalNode:return new R.x(n,s,o,d);case L.Z.TileNode:return new O.b(t,i,a,g,h,p,m,C,b,M,T,w,A,e,n,null!=l?l:F,s,q,k,o,d,P);default:throw Error(`This factory cannot build ${L.Z[e]}.`)}}}))},z=e=>{e.bind(m.Om).toDynamicValue((e=>{const t=e.get(n.G),i=e.get(S.w);return(e,n)=>new A.f(t,i,e,n)}))},j=e=>{e.bind(I.u).toDynamicValue((e=>{const t=e.get(g.K),i=e.get(m.Om),n=e.get(w.D),o=e.get(f.k),r=e.get(d.n),a=e.get(u.c),c=e.get(v.d),h=e.get(C.b),p=e.get(s.H),y=e.get(l.g),I=e.getOptional(_.M);return(e,s)=>new F.zR(t,i,n,o,r,a,c,h,p,y,I,e,s)}))},W=e=>{e.bind(p.q).toDynamicValue((()=>e=>new p.x(e)))},B=e=>{e.bind(T.kK).toDynamicValue((()=>()=>{const t=e.get(d.n),i=e.get(f.k),n=e.get(u.c),o=e.get(s.H),r=e.get(g.K),c=e.get(l.g),p=new a.z(r.getCachedEntry(h.l.ProofingLanguages).storeEntryValue),m=Object.assign(Object.assign(Object.assign(Object.assign({},n.flags),i),t),{paragraphDeltasEnabled:o.check()});return new P.$(m,p,c)}))}},781729:(e,t,i)=>{i.d(t,{s:()=>n});const n=(0,i(668952).f)("IWordDictionary")},782139:(e,t,i)=>{i.d(t,{D:()=>s});var n=i(627282);class s extends n.k{constructor(e,t){super(e,null!=t?t:{})}createInitialState({logicalId:e}){return{currentDataSourceResponses:[],failedSources:[],pendingDataSourcesCount:0,logicalId:e}}onDataSourceResolved(e,t){const{logicalId:i}=e,{pendingDataSourcesCount:n,currentDataSourceResponses:s,failedSources:o}=this.currentState;if(t.suggestionGroups.length>0){const s=0===n?"Complete":"PartiallyLoaded";return void this.publishRankingEvent(i,s,t.sourceName,this.mergeSuggestions(e))}if(n>0)return;s.every((e=>0===e.suggestionGroups.length))&&o.length>0?this.publishRankingEvent(i,"Error",t.sourceName,[]):this.publishRankingEvent(i,"Complete",t.sourceName,this.mergeSuggestions(e))}onDataSourceRejected(e,t){const{logicalId:i}=e,{pendingDataSourcesCount:n,currentDataSourceResponses:s}=this.currentState;if(0!==n)return;0===s.length||s.every((e=>0===e.suggestionGroups.length))?this.publishRankingEvent(i,"Error","",[]):this.publishRankingEvent(i,"Complete","",this.mergeSuggestions(e))}mergeSuggestions({triggerKey:e}){var t,i;const{currentDataSourceResponses:n}=this.currentState,s=this.rankerConfig.datasourceOrder;let o=n;if(Array.isArray(s)&&s.length>0){const e=new Map(s.map(((e,t)=>[e,t]))),t=s.length;o=[...n].sort(((i,n)=>{var s,o;return(null!==(s=e.get(i.sourceName))&&void 0!==s?s:t)-(null!==(o=e.get(n.sourceName))&&void 0!==o?o:t)}))}const r=null!==(t=this.enabledEntities.get(e))&&void 0!==t?t:new Map,a=new Map;for(const{sourceName:e,suggestionGroups:t}of o)for(const{entityType:n,entities:s}of t){const t=r.get(n);if(!t)continue;const o=null!==(i=a.get(n))&&void 0!==i?i:[];0===o.length&&a.set(n,o),t.includes(e)&&o.push(...s)}return Array.from(a.entries()).map((([e,t])=>({entityType:e,entities:t})))}}},783881:(e,t,i)=>{i.d(t,{S:()=>h});var n=i(379490),s=i(551268),o=i(302246),r=i(879190),a=i(700509),l=i(909113),d=i(418876),c=i(451816),u=i(229906),g=i(83010);let h=class{constructor(e,t,i){this._wordCountDetector=e,this._hostModelSettings=t,this._textUnitChunker=i}generateDeltaEventInformation(e,t,i,n,s,o,r,u){var g;const h=null!==(g=null==t?void 0:t.content)&&void 0!==g?g:"",p=i.content,m=l.CC(h,p);r&&(m.firstDiffLeft-=1);let f=!1;if(!n&&this._hostModelSettings.partialTileTextUnit!==a.fT.Phrase&&this._hostModelSettings.partialTileTextUnit!==this._hostModelSettings.completeTileTextUnit){const e=m.firstDiffLeft,t=p.length-m.firstDiffRight;f=-1!==this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit).findEndBoundary(p,e-1,t)}const v=null!=u?u:this._wordCountDetector.getWordCount(h),y=this._wordCountDetector.hasWordCountChanged(m,v,p),_=s?(0,c.d)(this._hostModelSettings.completeTileTextUnit):f?(0,c.d)(this._hostModelSettings.partialTileTextUnit):y.isWordCountChanged?n?(0,c.d)(this._hostModelSettings.completeTileTextUnit):d.OD.Word:d.OD.Chars;let I;if(this._hostModelSettings.completeTileTextUnit===a.fT.Paragraph&&this._hostModelSettings.partialTileTextUnit===a.fT.Sentence&&_!==d.OD.Paragraph){const e=m.firstDiffLeft,t=this._textUnitChunker.getUnitSeparator(this._hostModelSettings.partialTileTextUnit),i=t.findBeginBoundary(p,e,0),n=t.findEndBoundary(p,e-1,p.length);I=[{position:i,length:(-1===n?p.length:n)-i,unit:d.OD.Sentence}]}return{paragraphNode:e,oldTextInfo:t,newTextInfo:i,minDiffBounds:m,wordCount:y.wordCount,deltaUnit:_,mutationChangeType:o,invalidationRanges:I}}};h=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,g.W)(o.B)),(0,n.__param)(1,(0,g.W)(s.k)),(0,n.__param)(2,(0,g.W)(r.D))],h)},784262:(e,t,i)=>{function n(e){if(!e)return"";const t=e.lastIndexOf(".");return t>-1?e.substring(0,t):e}i.d(t,{u:()=>n})},786132:(e,t,i)=>{function n(e){var t;const i=e&&(e.commonAncestorContainer||e),n=i&&(i.ownerDocument||("[object HTMLDocument]"===Object.prototype.toString.apply(i)?i:null));return n&&(null!==(t=n.defaultView)&&void 0!==t?t:window)}function s(e,t){const i=n(e),s=i&&i[t],o=window,r=o&&o[t];return r&&e instanceof r||s&&e instanceof s}i.d(t,{C:()=>s,e:()=>n})},787924:(e,t,i)=>{var n,s;i.d(t,{M:()=>n,s:()=>s}),function(e){e.WebSiteProvedOnce="WebSiteProvedOnce",e.ActionCritiqueSettingsChange="ActionCritiqueSettingsChange",e.TonalFRE="TonalFRE",e.ActionInlineSettingChange="ActionInlineSettingChange"}(n||(n={})),function(e){e.MutationError="MutationError",e.UpdateCritiqueException="RunTimeErrors.UpdateCritiqueException"}(s||(s={}))},791424:(e,t,i)=>{i.d(t,{Y:()=>o});var n=i(208520);const s="textPrediction",o=n.memo((e=>{const{predictionDisplayText:t,shouldShowInsertionHelperText:i,isPIMPrediction:o,isMobile:r,localizer:a,onTextMayOverlapLine:l,leftPadding:d,onDropdownOpened:c,isHelperText:u,appName:g}=e,h=t.split(" "),p=n.useRef({}),m=n.useCallback((()=>{o&&p.current[0]&&c(p.current[0])}),[c]);if(n.useEffect((()=>{if(!p.current[0]||!p.current[h.length-1])return;let e=0,t=0;for(let i=0;i<h.length;i++){if(!p.current[i])continue;const n=0===i,s=i===h.length-1,o=p.current[i].getBoundingClientRect();if(n?e=o.top:o.top!==e&&(t++,e=o.top),s){const e=p.current[i].getClientRects();1!==e.length&&(t+=e.length-1)}}l(t)})),!h)return n.createElement(n.Fragment,null);const f=["BingAtWork","BizChat"].some((e=>null==g?void 0:g.includes(e)))&&u;return n.createElement(n.Fragment,null,h.map(((e,t,o)=>{const l=0===t,c=t+1===o.length,u=e+(c?"":" ");return n.createElement("span",{key:`${s}-${t}`,id:`${s}-${t}`,className:f?"ms-ghost-text":"ms-text-prediction",style:{paddingLeft:l&&d?d+"px":void 0,whiteSpace:c&&i?"nowrap":void 0,borderRadius:l&&f?"4px 0 0 4px":t===o.length-2?"0 4px 4px 0":void 0},contentEditable:!1,ref:e=>{p.current[t]=e},onMouseOver:m,onFocus:m},"​‌",u,"​‌",c&&i?n.createElement("span",{id:"textPredictionTabHint",className:"ms-prediction-tab-hint"},"​‌",a.getMessage(r?"ebx_TextPredictionTapLabel":"ebx_TextPredictionTabLabel"),"​‌"):n.createElement(n.Fragment,null))})))}))},793786:e=>{e.exports=JSON.parse('{"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"敏感地緣政治參照"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"IsImplemented":false,"LocalizedName":"糾錯"},"Resume":{"LocalizedName":"履歷","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"拼字檢查","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"標點符號規則","IsImplemented":false},"Formality":{"IsImplemented":true,"LocalizedName":"正式語言"},"Inclusiveness":{"LocalizedName":"包容性語言","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"簡明性"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"異體詞統一用法","IsImplemented":false},"Typing errors":{"LocalizedName":"筆誤","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":false,"LocalizedName":"詞彙選擇"},"Rewrite":{"IsImplemented":false,"LocalizedName":"改寫"},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"IsImplemented":true,"LocalizedName":"語法"},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"書寫規則"},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Clarity":{"IsImplemented":true,"LocalizedName":"清晰性"}}')},794300:(e,t,i)=>{i.d(t,{z:()=>n});class n{constructor(){this.listeners={}}subscribe(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n.push(t),this.listeners[e]=n}unsubscribe(e,t){var i;let n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n=n.filter((e=>e!==t)),this.listeners[e]=n}publishEvent(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];for(const e of n)try{e(t)}catch(e){}}}},797214:(e,t,i)=>{if(i.d(t,{OE:()=>a,_K:()=>l,r3:()=>d}),0!=i.j)var n=i(379490);if(0!=i.j)var s=i(762413);if(0!=i.j)var o=i(331408);if(0!=i.j)var r=i(274606);function a(e){const{annotationId:t,typeId:i,traceId:a,sourceData:l,priority:d,supportedActions:c,suggestions:u,textInContext:g,start:h,length:p,metadata:m,nodeId:f,tileId:v,categoryTitle:y,isStealth:_,endNode:I,explanationTitle:C,explanationLabel:S,explanation:b,shouldShowMultilingualFre:T,languageId:E,shouldAttemptLanguageDetection:N}=e,w=(0,n.__rest)(e,["annotationId","typeId","traceId","sourceData","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign({annotationId:t,typeId:(0,o.e3)(i),typeIdRaw:i,traceId:a,sourceData:l,priority:d,supportedActions:(0,s.z)(c),suggestions:u.map(r.S),textInContext:g,start:h,length:p,metadata:m,nodeId:f,tileId:v,categoryTitle:y,isStealth:_,endNode:I,explanationTitle:C,explanationLabel:S,explanation:b,shouldShowMultilingualFre:T,languageId:E,shouldAttemptLanguageDetection:N},w)}function l(e){const{annotationId:t,typeIdRaw:i,traceId:o,sourceData:a,priority:l,supportedActions:d,suggestions:c,textInContext:u,start:g,length:h,metadata:p,nodeId:m,tileId:f,categoryTitle:v,isStealth:y,endNode:_,explanationTitle:I,explanationLabel:C,explanation:S,shouldShowMultilingualFre:b,languageId:T,shouldAttemptLanguageDetection:E}=e,N=(0,n.__rest)(e,["annotationId","typeIdRaw","traceId","sourceData","priority","supportedActions","suggestions","textInContext","start","length","metadata","nodeId","tileId","categoryTitle","isStealth","endNode","explanationTitle","explanationLabel","explanation","shouldShowMultilingualFre","languageId","shouldAttemptLanguageDetection"]);return Object.assign({annotationId:t,typeId:i,traceId:o,sourceData:a,priority:l,supportedActions:(0,s.N)(d),suggestions:c.map(r.I),textInContext:u,start:g,length:h,metadata:p,nodeId:m,tileId:f,categoryTitle:v,isStealth:y,endNode:_,explanationTitle:I,explanationLabel:C,explanation:S,shouldShowMultilingualFre:b,languageId:T,shouldAttemptLanguageDetection:E},N)}function d(e){return"isFlagCritique"in e}},797386:(e,t,i)=>{function n(e){let t=e.parent;for(;null==t?void 0:t.parent;)t=t.parent;return t}i.d(t,{F:()=>n})},797452:(e,t,i)=>{i.d(t,{P:()=>s});var n=i(668952);const s=(0,n.f)("IALSessionFromHost");(0,n.f)("ProofingSettingsRequestTypes")},797757:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"املا"}}')},799116:(e,t,i)=>{i.d(t,{b:()=>n});const n=(0,i(668952).f)("IParagraphNodesEventEmitter")},799873:(e,t,i)=>{function n(e,t){e.isApplying||e.suggestions[0].text&&(null==t||t.addWordToIgnoreList(e.suggestions[0].text,!0))}i.d(t,{yf:()=>n})},800691:(e,t,i)=>{i.d(t,{M:()=>h});var n=i(379490),s=i(537969),o=i(304274),r=i(904196),a=i(383714),l=i(404983),d=i(260566),c=i(770235);var u=i(229906),g=i(83010);let h=class{constructor(e,t,i,n,s,o){this._userInfoStrategy=e,this._hostEmitter=t,this._editorService=i,this._hostSettings=n,this._logger=s,this._sessionContextProvider=o}async initialize(){this._hostEmitter.on(s.pD.instrumentationRequestV1,(async e=>this.handleRequest(e)))}shutDown(){}async handleRequest(e){try{const t=await this._userInfoStrategy.executeAsync(!1);t&&(this._editorService.serverToServerId=JSON.stringify({puid:t.userId,identityProvider:t.identityProvider,tenantId:t.tenantId}));const i=await this._sessionContextProvider();return i.sessionId&&(this._editorService.xUserSessionId=i.sessionId),i.composeSessionId&&(this._editorService.xUserComposeSessionId=i.composeSessionId),function(e,t,i){if(e)for(const t of e)if("LicenseType"===t.name)return t.value;let n=c.G_.NoLicense;t?n=c.G_.Subscription:i&&(n=i),null==e||e.push({name:"LicenseType",value:n})}(e.message.descriptors,this._hostSettings.enhancedUpsellEnabled,null==t?void 0:t.licenseType),await this._editorService.instrumentation(e.message),!0}catch(e){this._logger.error(560219268,"Error in sending instrumentation request",e)}return!1}};h=(0,n.__decorate)([(0,u._)(),(0,n.__param)(0,(0,g.W)(o.e)),(0,n.__param)(1,(0,g.W)(s.M5)),(0,n.__param)(2,(0,g.W)(d.R9)),(0,n.__param)(3,(0,g.W)(r.n)),(0,n.__param)(4,(0,g.W)(a.g)),(0,n.__param)(5,(0,g.W)(l.a))],h)},800737:(e,t,i)=>{function n(e){var t,i,n;return null===(n=null===(i=(null!==(t=null==e?void 0:e.ownerDocument)&&void 0!==t?t:document).defaultView)||void 0===i?void 0:i.CSS)||void 0===n?void 0:n.highlights}i.d(t,{b:()=>n})},800756:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Õigekirjakontroll"}}')},803620:(e,t,i)=>{if(i.d(t,{Q:()=>d}),0!=i.j)var n=i(585170);if(0!=i.j)var s=i(576240);if(0!=i.j)var o=i(175954);if(0!=i.j)var r=i(104072);if(0!=i.j)var a=i(279215);if(0!=i.j)var l=i(251439);class d{get uniqueId(){return(0,l.z)(507918412)}constructor(e){this.attachedToParagraphLevelDivs=e,this.imports=[]}configureRootServices(e){e.bind(r.d).to(this.attachedToParagraphLevelDivs?a.c:s.Z),e.bind(o.l).to(n.h)}}},806025:(e,t,i)=>{i.d(t,{E:()=>s});var n=i(46692);class s{constructor(){this.logGroupName="EditorSdk",this.tenant={tenantName:"NaturalLanguage",ariaTenantToken:"71cc1046851042108843d90e5d3ef6c1-61e5de5c-238c-4de5-95de-3b40d20ea6e5-6899",nexusTenantToken:1733},this.defaultEventName="Diagnostics",this.logToConsole=!1,this.logToKusto=!0}}class o{}o.DefaultSamplingPolicy=n.o.SamplingPolicy.Measure,o.DefaultDiagnosticLevel=n.o.DiagnosticLevel.RequiredServiceData,o.DefaultDataCategories=n.o.DataCategories.ProductServiceUsage,o.DefaultCostPriority=n.o.CostPriority.Normal,o.DefaultPersistencePriority=n.o.PersistencePriority.Normal},806988:(e,t,i)=>{if(i.d(t,{g:()=>o}),0!=i.j)var n=i(496439);function s(e,t){return async i=>i.TokenType===n.OY.Substrate&&t?{Token:await t(i)}:e(i)}function o(e,t){return{isFeatureEnabled:(i=e.isFeatureEnabled,async(e,t)=>{switch(e){case"Microsoft.Office.AugLoop.AnnotationsOrderingEnabled":case"Microsoft.Office.AugLoop.EarlyJoinCompletionEnabled":return!1;case"Microsoft.Office.AugLoop.DeltaOperationsEnabled":return!0}return i(e,t)}),requestAuthToken:s(e.requestAuthToken,t)};var i}},807582:(e,t,i)=>{i.d(t,{z:()=>n});class n{constructor(){this.listeners={}}subscribe(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n.push(t),this.listeners[e]=n}unsubscribe(e,t){var i;let n=null!==(i=this.listeners[e])&&void 0!==i?i:[];n=n.filter((e=>e!==t)),this.listeners[e]=n}publishEvent(e,t){var i;const n=null!==(i=this.listeners[e])&&void 0!==i?i:[];for(const e of n)try{e(t)}catch(e){}}}},808320:(e,t,i)=>{i.d(t,{b:()=>p});var n=i(379490),s=i(445801),o=i(609062),r=i(823325),a=i(537969),l=i(909113),d=i(553164),c=i(418876),u=i(378071),g=i(797386),h=i(229906);let p=class extends s.W{get children(){var e;return this._hostSettings.sdkV2Enabled?null!==(e=this._proofingDom.getTileNodeV2Paragraphs(this))&&void 0!==e?e:[]:this._children}set children(e){this._children=e}constructor(e,t,i,n,s,a,l,c,u,g,h,p,m,f,v,y,_,I,C,S,b,T){super(f,v,void 0,_,S,b),this._guidGenerator=e,this._logger=t,this._wordCount=i,this._wordCountDetector=n,this._settings=s,this._nodePoller=a,this._proofingDom=l,this._tileContent=c,this._hostSettings=u,this.featureFlagsReader=g,this._paragraphDeltasEnabled=h,this._optimizedRehydrationEnabled=p,this._hostTilingEmitter=m,this.nodeType=f,this._observer=v,this._paragraphNodesBuilder=y,this.element=_,this._hostEmitters=I,this.nodeTraverser=C,this.parent=S,this.queryDetection=T,this._children=[],this._cachedWordCount=0,this._cachedTiles=new Map,this._seqId=0,this._eventSeqId=0,this.id=this._guidGenerator.generate(),this._cachedChildNodeOps={nodesToDelete:new Set,activeNodes:new Set},this.resetState(!0),this._proofingDom.registerNode(this),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,r.G.NewData,o.Q0.Code,d.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}getPreviousTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findPreviousTileNode(this);return"#head#"===t?t:null==t?void 0:t.id}getNextTileId(){var e;const t=null===(e=this.nodeTraverser)||void 0===e?void 0:e.findNextTileNode(this);return"#tail#"===t?t:null==t?void 0:t.id}retire(){this._nodePoller.removeQueuedTiles(this.id),this._clearReconcileTimer(),this._invalidationDiffBounds={firstDiffLeft:0,firstDiffRight:0},this._hostSettings.enableOrchestration&&(this._hostTilingEmitter.emitTileEvent(this,this.id,void 0,this._eventSeqId,r.G.RemoveData,o.Q0.Code,d.Z.TileNode,this.specifiedLocale),this.removeAllParagraphNodesFromAugloop()),this.parent=void 0,this._cachedTextInfo=void 0,this._currentText=void 0,this._cachedWordCount=0,this._cachedChildNodeOps.activeNodes.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._logger.debug(562057756,"Retire node",this.id),this._proofingDom.unregisterNode(this),super.retire()}removeAllParagraphNodesFromAugloop(){if(!this._hostSettings.enableOrchestration)return;const e=[...Array.from(this._cachedChildNodeOps.nodesToDelete),...Array.from(this._cachedChildNodeOps.activeNodes)];if(this._paragraphDeltasEnabled.check())for(const t of e)this._hostTilingEmitter.emitTileEvent(this,t,void 0,this._eventSeqId,r.G.RemoveData,o.Q0.Code,d.Z.ParagraphNode,this.specifiedLocale);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,{addedNodes:[],unreconciledContent:[],removedNodes:e,updatedNodes:[]},o.Q0.Code,void 0)}move(e,t){var i;const n=(0,g.F)(this),s=(0,g.F)(null!=t?t:this);this._nodePoller.removeQueuedTiles(this.id),this._proofingDom.unregisterNode(this);const o=this.id;return super.move(e,t),this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitMoveTileEvent(o,this.id,null!==(i=this._cachedTextInfo)&&void 0!==i?i:{content:""},this._eventSeqId,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId(),null==n?void 0:n.documentModel,null==s?void 0:s.documentModel),this._proofingDom.registerNode(this),this}resetState(e){e||this.removeAllParagraphNodesFromAugloop(),this._cachedTextInfo=void 0,this._cachedWordCount=0,this._cachedTiles.clear(),this._cachedChildNodeOps.nodesToDelete.clear(),this._cachedChildNodeOps.activeNodes.clear();for(const e of this.children)e.retire();if(this.children=[],this._invalidationDiffBounds=void 0,!e){for(const e of this._hostEmitters)e.emit(a.pD.hostModelTileStateReset,{address:void 0,message:this.id});this._hostSettings.enableOrchestration&&this._hostTilingEmitter.emitTileEvent(this,this.id,this._cachedTextInfo,this._eventSeqId,r.G.NewData,o.Q0.Code,d.Z.TileNode,this.specifiedLocale,this.getPreviousTileId(),this.getNextTileId())}}pullText(){var e;return null!==(e=this._tileContent.getText(this))&&void 0!==e?e:{content:""}}reconcile(e,t,i,n,s,o){var r,a,d,g,h,p;if(this.parent){const t=null!==(r=this._tileContent.getText(this))&&void 0!==r?r:{content:""},i=null!==(d=null===(a=this._cachedTextInfo)||void 0===a?void 0:a.content)&&void 0!==d?d:"",m=t.content;this._currentText=t;const f=l.CC(i,m);if(o&&(f.firstDiffLeft-=1),m!==i&&(this._invalidationDiffBounds||(this._invalidationDiffBounds=Object.assign({},f)),this._invalidationDiffBounds.firstDiffLeft=Math.min(this._invalidationDiffBounds.firstDiffLeft,f.firstDiffLeft),this._invalidationDiffBounds.firstDiffRight=Math.min(this._invalidationDiffBounds.firstDiffRight,f.firstDiffRight)),m===i&&this.children.length>0&&(!n||this._optimizedRehydrationEnabled.check())){if(n){let i=this.children[0];for(const e of this.children)e.element&&e.element.offset>(null!==(h=null===(g=i.element)||void 0===g?void 0:g.offset)&&void 0!==h?h:0)&&(i=e);if(i.element){const n=(0,u.Gn)(t,i.element.offset,i.element.offset+i.element.span);this._hostTilingEmitter.emitParagraphDiffEvent({paragraphNode:i,oldTextInfo:n,newTextInfo:n,minDiffBounds:{firstDiffLeft:i.element.span,firstDiffRight:0},wordCount:null!==(p=i.cachedWordCount)&&void 0!==p?p:0,deltaUnit:c.OD.Sentence,mutationChangeType:e,invalidationRanges:void 0})}}return this._hostSettings.enableOrchestration&&(s||n)&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,t,f,!1,this._cachedWordCount,{addedNodes:[],removedNodes:[],updatedNodes:[],unreconciledContent:Array.from(this._cachedTiles.values())},e,this.specifiedLocale)),this._reconcileFormatting(t,!this.featureFlagsReader.flags.enableAttributionRangeInAddDelta),void(this._cachedTextInfo=t)}return this._reconcileState(t,f,null!=n&&n,e,null!=o&&o)}return this._resetInvalidationStateAndReturnTiles(Array.from(this._cachedTiles.values()),this._seqId)}get critiques(){return[]}get textFormattingInfo(){return this._currentText}_reconcileState(e,t,i,n,s){var r;const a=this._seqId+1,l=e.content;let d;if(this._paragraphDeltasEnabled.check())d=!1,this._cachedWordCount=0;else if(this._hostSettings.wordCountDetectorEnabled){const e=this._wordCountDetector.hasWordCountChanged(t,this._cachedWordCount,l);d=e.isWordCountChanged,this._cachedWordCount=e.wordCount}else d=this._reconcileWordCount(t,l);const c=this._paragraphNodesBuilder.updateParagraphNodes(this,this._cachedTextInfo,e,t,a,n,s);if(this._reconcileParagraphs(c,a),this._hostSettings.enableOrchestration&&(this._eventSeqId+=1,this._hostTilingEmitter.emitTileDiffEvent(this,this._cachedTextInfo,e,t,d,this._cachedWordCount,c,n,this.specifiedLocale)),this._reconcileFormatting(e,!this.featureFlagsReader.flags.enableAttributionRangeInAddDelta),this._cachedTextInfo=e,i||d||this._hostSettings.enableOrchestration&&0===this._cachedChildNodeOps.activeNodes.size){if(this._cachedTiles.clear(),this.children.length>0&&this._hostSettings.enableOptimizedCallingPattern&&n!==o.Q0.Code&&this._tryScheduleReconcileTimer(),this._hostSettings.enableOrchestration){for(const e of c.addedNodes)this._cachedChildNodeOps.activeNodes.add(e);if(c.removedNodes=Array.from(this._cachedChildNodeOps.nodesToDelete),this._cachedChildNodeOps.nodesToDelete.clear(),this._paragraphDeltasEnabled.check())for(const e of c.removedNodes)null===(r=this.queryDetection)||void 0===r||r.handleTileRemoved(e);else this._hostTilingEmitter.emitParagraphNodeTileEvents(this,c,n,e)}return this._resetInvalidationStateAndReturnTiles(c.unreconciledContent,a)}this._tryScheduleReconcileTimer()}_reconcileFormatting(e,t){var i,n;if(this._cachedTextInfo){if(this.featureFlagsReader.flags.enableAttributionRangeExceptionInFormattedTextDeltas){const n=t&&!(0,u.V8)(this._cachedTextInfo.attributionRanges,e.attributionRanges);if(!(0,u.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)||n){for(const t of this.children){if(!t.element)continue;const i=t.element.offset+t.element.span,s=(0,u.Wi)(this._cachedTextInfo,t.element.offset,i),r=(0,u.Wi)(e,t.element.offset,i);(0,u.V8)(s.formattedRanges,r.formattedRanges)&&!n||(n?this._hostTilingEmitter.emitFormattingDiffEvent(t,o.pf.ParagraphNode,{formattedRanges:r.formattedRanges,attributionRanges:r.attributionRanges}):this._hostTilingEmitter.emitFormattingDiffEvent(t,o.pf.ParagraphNode,{formattedRanges:r.formattedRanges}))}this._hostTilingEmitter.emitFormattingDiffEvent(this,o.pf.TileNode,null!==(i=e.formattedRanges)&&void 0!==i?i:[])}}else if(!(0,u.V8)(this._cachedTextInfo.formattedRanges,e.formattedRanges)){for(const t of this.children){if(!t.element)continue;const i=(0,u.FD)(this._cachedTextInfo,t.element.offset,t.element.offset+t.element.span),n=(0,u.FD)(e,t.element.offset,t.element.offset+t.element.span);(0,u.V8)(i,n)||this._hostTilingEmitter.emitFormattingDiffEvent(t,o.pf.ParagraphNode,n)}this._hostTilingEmitter.emitFormattingDiffEvent(this,o.pf.TileNode,null!==(n=e.formattedRanges)&&void 0!==n?n:[])}if(!(0,u.V8)(this._cachedTextInfo.objectReferences,e.objectReferences)||!(0,u.lX)(this._cachedTextInfo,e)){const t=Object.assign({},e);for(const e of u._E)"objectReferences"!==e&&delete t[e];for(const e of this.children)e.element&&this._hostTilingEmitter.emitFormattingDiffEvent(e,o.pf.ParagraphNode,t);this._hostTilingEmitter.emitFormattingDiffEvent(this,o.pf.TileNode,t)}}}_reconcileWordCount(e,t){const i=this._wordCountDetector.getWordCount(t);let n=0;e.firstDiffLeft<=t.length&&(n=this._wordCount.getWordCountInRange(t,e.firstDiffLeft,t.length-e.firstDiffRight));const s=i>0&&(i!==this._cachedWordCount||n>1);return this._cachedWordCount=i,s}_reconcileParagraphs(e,t){for(const t of e.unreconciledContent)this._cachedTiles.set(t.header.elementId.id,t);for(const[e,i]of this._cachedTiles){this._proofingDom.findParagraphNode(e)?i.header.seqId=t.toString():this._cachedTiles.delete(e)}e.unreconciledContent=Array.from(this._cachedTiles.values());for(const t of e.removedNodes)this._cachedChildNodeOps.activeNodes.delete(t)&&this._cachedChildNodeOps.nodesToDelete.add(t)}_resetInvalidationStateAndReturnTiles(e,t){return this._hostSettings.enableOptimizedCallingPattern||this._clearReconcileTimer(),this._invalidationDiffBounds=void 0,this._seqId=t,e}_tryScheduleReconcileTimer(){return!(!this._settings.enableTileNodeAutoReconciliation||!this._invalidationDiffBounds)&&(this._clearReconcileTimer(),this._reconcileCritiqueTimer=window.setTimeout((()=>{this._logger.debug(562057757,"Dirty range timer has fired."),this._nodePoller.pollNodes(r.G.NewData,[this],o.Q0.Code,void 0,!0),this._clearReconcileTimer()}),this._settings.reconcileTileNodeTime),!0)}_clearReconcileTimer(){this._reconcileCritiqueTimer&&(clearTimeout(this._reconcileCritiqueTimer),this._reconcileCritiqueTimer=void 0,this._logger.debug(562057758,"Dirty range timer has been cleared."))}get eventSeqId(){return this._eventSeqId}get plainText(){var e,t;return null!==(t=null===(e=this._currentText)||void 0===e?void 0:e.content)&&void 0!==t?t:""}};p=(0,n.__decorate)([(0,h._)()],p)},809610:(e,t,i)=>{if(i.d(t,{n:()=>s}),0!=i.j)var n=i(46692);function s(e,t,i,s){return{name:e,value:t,dataType:(null!=s?s:"boolean"==typeof t)?n.o.DataFieldType.Boolean.valueOf():"number"==typeof t?n.o.DataFieldType.Int64.valueOf():n.o.DataFieldType.String.valueOf(),classification:null!=i?i:n.o.DataClassification.EssentialServiceMetadata}}},811861:(e,t,i)=>{i.d(t,{R8:()=>a,Tc:()=>n,Vn:()=>o,XG:()=>r,r7:()=>s});const n=(0,i(668952).f)("IPredictionStateStore"),s=0,o=0!=i.j?-1:null,r=0!=i.j?-2:null;var a;!function(e){e[e.NotSeen=0]="NotSeen",e[e.TypeNotMatchingCharacter=1]="TypeNotMatchingCharacter",e[e.ExplicitRejection=2]="ExplicitRejection",e[e.ImplicitRejection=3]="ImplicitRejection"}(a||(a={}))},814948:(e,t,i)=>{if(i.d(t,{fO:()=>s}),0!=i.j)var n=i(67573);function s(e){return{changeOnce:(e&n.xv.ChangeOnce)===n.xv.ChangeOnce,changeAll:(e&n.xv.ChangeAll)===n.xv.ChangeAll,autoCorrect:(e&n.xv.AutoCorrect)===n.xv.AutoCorrect,readAloud:(e&n.xv.ReadAloud)===n.xv.ReadAloud,personalizedAutoCorrect:(e&n.xv.PersonalizedAutoCorrect)===n.xv.PersonalizedAutoCorrect}}},815870:(e,t,i)=>{i.d(t,{H:()=>o});var n,s=i(668952);!function(e){e[e.Undefined=0]="Undefined",e[e.Enabled=1]="Enabled",e[e.Disabled=2]="Disabled"}(n||(n={}));const o=(0,s.f)("IComponentInitializer")},817596:(e,t,i)=>{i.d(t,{d:()=>s});var n=i(794329);const s=(e,t)=>{n.render(t,e)}},818248:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Orthographie","IsImplemented":true}}')},818256:(e,t,i)=>{if(i.d(t,{$X:()=>c,MQ:()=>a,Sy:()=>d,Tv:()=>l,VC:()=>r}),0!=i.j)var n=i(246608);if(0!=i.j)var s=i(35865);const o={SentByUser:"SentByUser",EmailSenderName:"EmailSenderName",LastModifiedByUser:"LastModifiedByUser",LastModifiedByContact:"LastModifiedByContact",LastAccessedByUser:"LastAccessedByUser",AuthorName:"AuthorName",FallbackValue:"FallbackValue"};function r(e,t){var i,r,a,l;const d=s.e.getStringsFor("FileTidbitStrings"),c=(e,...t)=>{let i=d(e),n=0;for(const e of t.filter(Boolean))i=i.replace(`{${n}}`,e),n++;return i},u=function(e,t){var i;const{author:n,from:s,dateAccessed:r,dateCreated:a,dateModified:l,sharedDateTime:d}=e,c=(n||(null===(i=null==s?void 0:s.EmailAddress)||void 0===i?void 0:i.Name)||"").trim(),u=c===t;return(null==s?void 0:s.EmailAddress)&&d?u?o.SentByUser:o.EmailSenderName:l&&c?u?o.LastModifiedByUser:o.LastModifiedByContact:u&&r?o.LastAccessedByUser:c&&a?o.AuthorName:o.FallbackValue}(e,t),g=e.author||(null===(r=null===(i=e.from)||void 0===i?void 0:i.EmailAddress)||void 0===r?void 0:r.Name)||"",h=(null===(l=null===(a=e.from)||void 0===a?void 0:a.EmailAddress)||void 0===l?void 0:l.Name)||"";switch(u){case o.AuthorName:return c("userCreatedOnDate",g,(0,n.PG)(e.dateCreated));case o.LastAccessedByUser:return c("youOpenedOnDate",(0,n.PG)(e.dateAccessed));case o.LastModifiedByUser:return c("youModifiedOnDate",(0,n.PG)(e.dateModified));case o.LastModifiedByContact:return c("userModifiedOnDate",g,(0,n.PG)(e.dateModified));case o.EmailSenderName:return c("userSentOnDate",h,(0,n.PG)(e.sharedDateTime));case o.SentByUser:return c("youSentOnDate",(0,n.PG)(e.sharedDateTime));case o.FallbackValue:return void 0!==e.secondaryText?e.secondaryText:c("weFoundThisFile")}return"placeholder"}function a(e){var t,i;return null!==(i=null===(t=e.emailAddresses)||void 0===t?void 0:t[0])&&void 0!==i?i:""}function l(e){var t,i,n,o,r,a;return s.e.getStringsFor("InlineSuggestionStrings")("emailSentBy").replace("{0}",null!==(a=null!==(n=null===(i=null===(t=e.from)||void 0===t?void 0:t.EmailAddress)||void 0===i?void 0:i.Name)&&void 0!==n?n:null===(r=null===(o=e.from)||void 0===o?void 0:o.EmailAddress)||void 0===r?void 0:r.Address)&&void 0!==a?a:"")}function d(e){var t;return null!==(t=e.description)&&void 0!==t?t:""}function c(e,t){const i=(0,n.B5)(e.start,e.end,e.isAllDay,t),o=s.e.getStringsFor("InlineSuggestionStrings")("recordText")||"";return e.hasRecording?i+" | "+o:i}},818691:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"वर्णविन्यास","IsImplemented":true}}')},818955:(e,t,i)=>{i.d(t,{e:()=>o});var n,s=i(668952);!function(e){e.StorageUserInfoV2Strategy="StorageUserInfoV2Strategy",e.None="None"}(n||(n={}));const o=(0,s.f)("IUserInfoStrategy")},821003:(e,t,i)=>{i.d(t,{J:()=>n});const n=(0,i(668952).f)("IQueryDetection")},821819:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":false,"LocalizedName":""},"Consistent Written Forms":{"LocalizedName":"","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"","IsImplemented":false},"Typing errors":{"IsImplemented":false,"LocalizedName":""},"Clarity":{"IsImplemented":false,"LocalizedName":""},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":""},"Error Corrections":{"LocalizedName":"","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":false,"LocalizedName":""},"Grammar":{"LocalizedName":"","IsImplemented":false},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":false,"LocalizedName":""},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":""},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"वर्तनी"},"Resume":{"LocalizedName":"","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":""}}')},822765:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(379490),s=i(553164),o=i(229906);let r=class{isTileNode(e){return e.nodeType===s.Z.TileNode}reconcile(e,t,i,n,s,o,r){return e.reconcile(t,i,!!n,!!s,!!o,!!r)}critiques(e){return e.critiques}getPreviousTileId(e){return e.getPreviousTileId()}getNextTileId(e){return e.getNextTileId()}};r=(0,n.__decorate)([(0,o._)()],r)},822935:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":"Imyandikire"}}')},823325:(e,t,i)=>{var n;i.d(t,{G:()=>n}),function(e){e.NewData="NewData",e.RemoveData="RemoveData",e.ChangeData="ChangeData"}(n||(n={}))},825948:(e,t,i)=>{i.d(t,{K:()=>n});const n=(0,i(668952).f)("IProofingPersistedStore")},826361:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Pravopis"}}')},826663:(e,t,i)=>{i.d(t,{K:()=>n});const n=(0,i(668952).f)("IApplyFlagHandler")},826834:(e,t,i)=>{if(i.d(t,{T:()=>o,v:()=>r}),0!=i.j)var n=i(656288);if(0!=i.j)var s=i(782139);const o=e=>new n.r(e),r=e=>new s.D(e)},828833:(e,t,i)=>{i.d(t,{U:()=>c});var n=i(379490),s=i(462425),o=i(57980),r=i(77127);const a=e=>{let t="'Segoe UI'";if(e)switch(e.toLowerCase()){case"ar":t="'Segoe UI Web (Arabic)'";break;case"bg-bg":case"ru-ru":case"uk-ua":t="'Segoe UI Web (Cyrillic)'";break;case"cs-cz":case"et-ee":case"hr-hr":case"hu-hu":case"lt-lt":case"lv-lv":case"pl-pl":case"lt-sr-sp":case"tr-tr":case"sk-sk":case"kk-kz":t="'Segoe UI Web (East European)'";break;case"el-gr":t="'Segoe UI Web (Greek)'";break;case"he-il":t="'Segoe UI Web (Hebrew)'";break;case"vi-vn":t="'Segoe UI Web (Vietnamese)'";break;case"ja-jp":t="YuGothic, 'Meiryo UI', Meiryo, 'MS Pgothic', Osaka";break;case"ko-kr":t="'Malgun Gothic', Gulim";break;case"ch-zhs":t="'Microsoft Yahei', Verdana, Simsun";break;case"ch-zht":t="'Microsoft Jhenghei', Pmingliu";break;case"hi-in":t="'Nirmala UI'";break;case"th-th":t="'Leelawadee UI Regular', 'Kmer UI'";break;default:t="'Segoe UI Web (West European)'"}return`${t}, 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', 'Helvetica Neue', sans-serif`};var l=i(229906),d=i(852853);let c=class{constructor(e,t,i){this.uxLanguageCode=e,this.themeStore=t,this.useFluentV9=i,this._calloutZIndex=Number.MAX_SAFE_INTEGER-1}get critiqueCallout(){return{shadowHost:{all:"initial",position:"absolute",zIndex:this._calloutZIndex},calloutMain:{root:{fontFamily:a(this.uxLanguageCode),borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:[{borderRadius:8,MsHighContrastAdjust:"auto",fontFamily:a(this.uxLanguageCode)}]},calloutV9:{fontFamily:a(this.uxLanguageCode),borderRadius:8}}}get undoCallout(){return{buttonIcon:{borderRadius:"2px"},logoButtonBase:{cursor:"default",pointerEvents:"all",lineHeight:"24px",fontSize:o.s.size12,fontWeight:o.BO.semibold,WebkitUserSelect:"none",msUserSelect:"none",userSelect:"none",padding:0,margin:"0 8px",flexGrow:0,whiteSpace:"nowrap",overflow:"visible",color:s.m.palette.blue,alignSelf:"center"},calloutContainer:{height:"40px",borderRadius:"4px",padding:"4px"},calloutMain:{root:{borderRadius:8},container:{MsHighContrastAdjust:"none"},calloutMain:{borderRadius:8,MsHighContrastAdjust:"auto",background:d.L.colorNeutralBackground1}},calloutV9:{fontFamily:a(this.uxLanguageCode),borderRadius:8}}}get tooltip(){var e,t,i,n,o;const l=this.useFluentV9||null===(e=this.themeStore)||void 0===e?void 0:e.getComponentActiveTheme(r.yF.squiggleTooltipComponentName);return{container:{all:"initial",position:"absolute",zIndex:Number.MAX_SAFE_INTEGER},shadowBoundary:{all:"initial"},shadowRoot:{width:"0px !important",height:"0px !important",overflowX:"hidden"},root:{position:"fixed",maxWidth:300,background:this.useFluentV9?d.L.colorNeutralBackground1:"transparent",border:"none",cursor:"default"},tooltipMain:{msHighContrastAdjust:"none",forcedColorAdjust:"none",fontFamily:a(this.uxLanguageCode),fontSize:"12px",fontWeight:600,background:this.useFluentV9?void 0:null!==(t=null==l?void 0:l.background)&&void 0!==t?t:s.m.palette.white,padding:"6px 12px",display:"inline-block",boxShadow:this.useFluentV9?`0 6.4px 14.4px 0 ${d.L.colorNeutralShadowKey}, 0 1.2px 3.6px 0 ${d.L.colorNeutralShadowAmbient}`:null!==(i=null==l?void 0:l.shadow)&&void 0!==i?i:"0 6.4px 14.4px 0 rgba(0, 0, 0, 0.132), 0 1.2px 3.6px 0 rgba(0, 0, 0, 0.108)",border:"none",borderRadius:4},title:{marginBottom:"4px",color:this.useFluentV9?d.L.colorNeutralForeground2:null!==(n=null==l?void 0:l.text)&&void 0!==n?n:s.m.palette.neutralSecondary},text:{color:this.useFluentV9?d.L.colorNeutralForeground3:null!==(o=null==l?void 0:l.altText)&&void 0!==o?o:s.m.palette.black}}}};c=(0,n.__decorate)([(0,l._)()],c)},829088:(e,t,i)=>{var n,s;i.d(t,{E:()=>a,O:()=>r});class o{constructor(e){this[n]="WeakRef",this.weakMap=new WeakMap,this.weakMap.set(this,e)}deref(){return this.weakMap.get(this)}}n=Symbol.toStringTag;class r{constructor(e){this[s]="WeakRef","object"==typeof i.g&&i.g&&void 0===i.g.WeakRef?this.weakRef=new o(e):this.weakRef=new i.g.WeakRef(e)}deref(){return this.weakRef.deref()}}function a(e){return"WeakRef"===e[Symbol.toStringTag]}s=Symbol.toStringTag},831219:(e,t,i)=>{i.d(t,{Qk:()=>p});var n,s=i(379490),o=i(668952);!function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email",e[e.EditorLandingPage=3]="EditorLandingPage"}(n||(n={}));const r=(0,o.f)("IHostSettings");class a{constructor(e,t){this._hostSettings=e,this.instantiateWorker=t,this._getWorkerUrl=()=>new Promise((e=>{var t;const i=new MessageChannel;i.port1.onmessage=({data:t})=>{var n;i.port1.close(),e(null!==(n=null==t?void 0:t.url)&&void 0!==n?n:null)},null===(t=this._dmp)||void 0===t||t.postMessage(["get-url"],[i.port2])})),this._callworker=(e,t,i)=>new Promise(((n,s)=>{var o;const r=new MessageChannel;r.port1.onmessage=({data:e})=>{r.port1.close(),e.error?s(e.error):n(e.result)},null===(o=this._dmp)||void 0===o||o.postMessage([e,t,i],[r.port2])})),this._shutDownWorker=()=>new Promise((e=>{var t;const i=new MessageChannel;i.port1.onmessage=({data:t})=>{var n;i.port1.close(),e(null!==(n=null==t?void 0:t.url)&&void 0!==n?n:null)},null===(t=this._dmp)||void 0===t||t.postMessage(["shut-down"],[i.port2])}))}async initialize(){var e;if(null===(e=this._dmp)||void 0===e||e.terminate(),this._dmp=this.instantiateWorker(),this._hostSettings.validateWorkerUrl){const e=await this._getWorkerUrl();await this._hostSettings.validateWorkerUrl(e)||this.shutDown()}}shutDown(){this._shutDownWorker().catch((()=>{throw new Error("Failed to shut down worker")})),"terminate"in this._dmp&&this._dmp.terminate(),this._dmp=void 0}async getReadjustedIndices(e,t,i,n){var s;const o=null!==(s=e.textContent)&&void 0!==s?s:"",r=n?i:o,a=n?o:i;return await this._callworker(r,a,t)}}var l=i(229906),d=i(83010);let c=class extends a{constructor(e){super(e,(()=>new Worker(new URL(i.p+i.u(0),i.b))))}shutDown(){var e;null===(e=this._dmp)||void 0===e||e.terminate(),this._dmp=void 0}};c=(0,s.__decorate)([(0,l._)(),(0,s.__param)(0,(0,d.W)(r))],c);var u=i(481593),g=i(251439),h=i(386675);class p{constructor(){this.imports=[]}get uniqueId(){return(0,g.z)(504370244)}configureRootServices(e){e.bind(u.h).to(c),e.bind(h.S).toExisting(u.h)}}},833801:(e,t,i)=>{i.d(t,{u:()=>o});var n=i(379490),s=i(229906);let o=class{constructor(e,t){this._storeEntryReader=e,this._storeEntryWriter=t,this._storeEntryMap=this.populateStoreEntryMap()}_fetchStoreEntry(e){const t=this._storeEntryMap.get(e);if(!t)throw Error("Cannot find the entry key.");return t}async read(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readOrInitialize(t)}async write(e,t){await this._storeEntryWriter.write(this._fetchStoreEntry(e).storeEntry,t)}async getLastUpdatedTimestamp(e){const t=this._fetchStoreEntry(e).storeEntry;return this._storeEntryReader.readLastUpdatedTimestamp(t)}getCachedEntry(e){const t=this._fetchStoreEntry(e),i=t.storeEntry;return{storeEntryValue:void 0===i.lastValueFromStorage?i.defaultValue:i.lastValueFromStorage,isSynced:!!t.isSynced}}getDefaultValue(e){return this._fetchStoreEntry(e).storeEntry.defaultValue}async removePersistentKeys(){}};o=(0,n.__decorate)([(0,s._)()],o)},835113:(e,t,i)=>{i.d(t,{H:()=>f});var n,s=i(379490),o=i(823325);!function(e){e.IgnoreListUpdate="IgnoreListUpdate",e.CustomDictionaryUpdate="CustomDictionaryUpdate"}(n||(n={}));var r=i(592568),a=i(118673),l=i(536906),d=i(609062),c=i(922630),u=i(335009),g=i(538045),h=i(229906),p=i(83010),m=i(427603);let f=class{constructor(e,t,i,s,r,a){this._proofingDom=e,this._proofingEmitter=t,this.hostSettings=s,this._roamingDictionaryFeature=r,this._roamingDictionaryBroker=a,this._ignoredWords=new Set,this.isWordIgnored=e=>{var t;const i=e.trim();if(this._ignoredWords.has(i))return!0;return!!(null===(t=this._roamingDictionaryFeature.getRoamingDictionary())||void 0===t?void 0:t.testWord(i,!0))},this.clearIgnoredWords=()=>{var e;this._ignoredWords.clear(),null===(e=this._nodePoller)||void 0===e||e.pollNodes(o.G.ChangeData,this._proofingDom.tileNodes,d.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:o.G.RemoveData,data:n.IgnoreListUpdate})},this.addWordToIgnoreList=(e,t=!1)=>{this.addWordsToIgnoreList([e],t)},this.addWordsToIgnoreList=(e,t=!1)=>{var i;let s=!1;for(let t=0;t<e.length;t++){const i=e[t];if(i){const e=i.trim();if(this._ignoredWords.has(e))continue;this._ignoredWords.add(e),s=!0}}s&&!t&&(null===(i=this._nodePoller)||void 0===i||i.pollNodes(o.G.ChangeData,this._proofingDom.tileNodes,d.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:o.G.NewData,data:n.IgnoreListUpdate}))},this.addWordToCustomDictionary=e=>{var t,i;if(e){if(this.hostSettings.enableV2RoamingDictionary&&(null===(t=this._roamingDictionaryBroker)||void 0===t?void 0:t.isRoamingDictionaryReady))return this._roamingDictionaryBroker.addWordToRoamingDictionary(e),!0;{const t=e.trim();if(this.roamingDictionary&&this._roamingDictionaryFeature.isReady()){return!!this.roamingDictionary.addWord(t)&&(null===(i=this._nodePoller)||void 0===i||i.pollNodes(o.G.ChangeData,this._proofingDom.tileNodes,d.Q0.Code),this._proofingEmitter.emit("wordDictionaryEvent",{messageType:o.G.NewData,data:n.CustomDictionaryUpdate}),!0)}}}return!1},this._nodePoller=s.enableOrchestration?void 0:i}get roamingDictionary(){if(this.hostSettings.enableRoamingDictionary)return this._roamingDictionaryFeature.getRoamingDictionary()}async initialize(){this.hostSettings.enableRoamingDictionary&&this._roamingDictionaryFeature.emitAndEvaluate({eventId:r.U1.ClientInitialized,sender:r.FS.WordDictionaryInit})}shutDown(){}get roamingDictionaryEnabled(){var e;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!this._roamingDictionaryFeature.isReady()}};f=(0,s.__decorate)([(0,h._)(),(0,s.__param)(0,(0,p.W)(g.w)),(0,s.__param)(1,(0,p.W)(a.o)),(0,s.__param)(2,(0,p.W)(u.G)),(0,s.__param)(3,(0,p.W)(c.n)),(0,s.__param)(4,(0,p.W)(r.Zp)),(0,s.__param)(5,(0,m.l)()),(0,s.__param)(5,(0,p.W)(l.C))],f)},836037:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"IsImplemented":true,"LocalizedName":""}}')},836609:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"LocalizedName":"Yalınlık","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Tutarlı yazım biçimleri"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Ayrımcı dil"},"Typing errors":{"LocalizedName":"Yazım hataları","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":"Açıklık"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Yeniden yazım"},"Error Corrections":{"LocalizedName":"Hata düzeltmeleri","IsImplemented":false},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Sözcükler","IsImplemented":true},"Grammar":{"LocalizedName":"Gramer","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"IsImplemented":false,"LocalizedName":"Resmî dil"},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Noktalama işaretleri kuralları"},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Yazım kuralları"},"Spelling":{"LocalizedName":"Yazım Denetimi","IsImplemented":true},"Resume":{"IsImplemented":false,"LocalizedName":"Öz geçmiş"},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Hassas jeopolitik ifadeler"}}')},838145:(e,t,i)=>{function n(e){let t=e;if("true"!==t.contentEditable&&t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(t=e)}return t}i.d(t,{a:()=>n})},838630:(e,t,i)=>{i.d(t,{A:()=>n});const n=(0,i(668952).f)("IStoreEntryReader")},838641:(e,t,i)=>{var n,s;i.d(t,{M:()=>n,s:()=>s}),function(e){e.RemoteSettingSync="RemoteSettingSync"}(n||(n={})),function(e){e.SettingsSyncWriteError="RunTimeErrors.SettingSyncWriteError",e.SettingsSyncEditorRequestBuildError="RunTimeErrors.SettingsSyncEditorRequestBuildError",e.SettingsSyncEditorServiceError="RunTimeErrors.SettingSyncEditorServiceError",e.SettingsSyncReadOverrideError="RunTimeErrors.SettingSyncReadOverrideError",e.SettingReadError="RunTimeErrors.SettingReadError",e.SettingInitializeError="RunTimeErrors.SettingInitializeError",e.SettingManualOverrideWarning="RunTimeErrors.SettingManualOverrideWarning",e.SettingWriteError="RunTimeErrors.SettingWriteError",e.FeatureFlagParsingError="RunTimeErrors.FeatureFlagParsingError",e.DynamicSettingsParsingError="RunTimeErrors.DynamicSettingsParsingError"}(s||(s={}))},842137:(e,t,i)=>{if(i.d(t,{WH:()=>r}),0!=i.j)var n=i(57980);const s='style[data-merge-styles="true"], style[data-make-styles-bucket], style[data-load-themed-styles="true"], style#ms-prediction-style';function o(e,t,i,n){var s,o,r,a;const l=null!=n?n:Array.from(e.querySelectorAll(t)),d=Array.from(i.querySelectorAll(t));for(const e of d)(null===(s=e.originalElement)||void 0===s?void 0:s.isConnected)||(e.originalElement=void 0,e.remove());for(const e of l)if(null===(o=e.sheet)||void 0===o?void 0:o.cssRules.length){const t=d.find((t=>t.originalElement===e));if(null===(r=null==t?void 0:t.sheet)||void 0===r?void 0:r.cssRules.length)for(let i=t.sheet.cssRules.length;i<e.sheet.cssRules.length;i++){const n=e.sheet.cssRules.item(i);n&&t.sheet.insertRule(n.cssText,i)}else{t&&(t.originalElement=void 0,t.remove());const n=i.ownerDocument.createElement("style");n.originalElement=e;for(const t of Array.from(e.attributes))t.nodeValue&&n.setAttribute(t.nodeName,t.nodeValue);i.appendChild(n);for(let t=0;t<e.sheet.cssRules.length;t++){const i=e.sheet.cssRules.item(t);i&&(null===(a=n.sheet)||void 0===a||a.insertRule(i.cssText,t))}}}}function r(e,t=s,i=document){o(i,t,e);const r=new MutationObserver((n=>{const s=[];for(const e of n)s.push(...Array.from(e.addedNodes).concat(Array.from(e.removedNodes)).concat(Array.from([e.target])).map((e=>{var t;return"STYLE"===e.nodeName?e:"STYLE"===(null===(t=e.parentElement)||void 0===t?void 0:t.nodeName)?e.parentElement:void 0})).filter((e=>!!e)));s.length&&o(i,t,e,s)})),a=n.nr.getInstance().onInsertRule((()=>{o(i,t,e)}));return r.observe(i.head,{childList:!0,subtree:!0,attributes:!0}),()=>{a(),r.disconnect();const i=Array.from(e.querySelectorAll(t));for(const e of i)e.originalElement&&(e.originalElement=void 0,e.remove());for(const t of Array.from(e.childNodes))t.originalElement&&(t.originalElement=void 0,t.remove())}}},842859:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Sifellin","IsImplemented":true}}')},843785:(e,t,i)=>{i.d(t,{o:()=>l});var n=i(379490),s=i(279e3),o=i(229906),r=i(83010),a=i(413835);let l=class{constructor(e){this._critiqueStore=e}onEvent(e){const t=this._critiqueStore.getCritiques(e.tileId);t&&(0,a.d)(t,e.tileVersion)&&this._critiqueStore.updateNode([],e.tileId,e.tileVersion,!0)}};l=(0,n.__decorate)([(0,o._)(),(0,n.__param)(0,(0,r.W)(s.$))],l)},846016:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Upelo"}}')},847471:(e,t,i)=>{i.d(t,{l:()=>te});i(220029);var n=i(728671),s=i(920117),o=i(825948),r=i(877931),a=i(671303),l=i(821003),d=i(907142),c=i(823325),u=i(279e3),g=i(997601),h=i(335009),p=i(151468),m=i(855095),f=i(78827),v=i(761799),y=i(955377),_=i(166137);const I=(0,i(668952).f)("ICritiqueValueStore");var C=i(281795),S=i(104072),b=i(1144),T=i(77127),E=i(710266),N=i(592568),w=i(122107),x=i(537969),L=i(323283),D=i(118673),A=i(355495),F=i(781729),q=i(615930),R=i(771588),P=i(815870),O=i(255517),k=i(494888),M=i(818955),z=i(829088),j=i(647879),W=i(257620),B=i(538045),U=i(174077),H=i(245145),V=i(290053),G=i(46437),Q=i(419728),K=i(357314),$=i(227710),J=i(136939),Z=i(696767);class Y{constructor(e,t,i,n=void 0,s,a,l=new Date){this.hostSettings=e,this.isEditorClientShutdown=!1,this.isInitialized=!1,this.isUXInitialized=!1,this._proofingDisabled=!1,this.onWindowUnloaded=()=>{this.shutDown()},this.rootInjector=(0,J.p)(this,e,n,s,t,i,a),this.diContainer=this.rootInjector.container,this.roamingDictionaryFeatureObj=this.diContainer.get(N.Zp),this.externalSettingsFeatureObj=this.diContainer.get(w.In),this.userInfoUpdater=this.diContainer.get(O.M),this.hostEmitter=this.diContainer.get(x.M5),this.logger=this.diContainer.get(r.g),this.proofingDom=this.diContainer.get(B.w),this.proofingPersistedStore=this.diContainer.get(o.K),this.featureFlagReader=this.diContainer.get(k.c),e.enableOrchestration&&(this.orchestrator=this.diContainer.get(U.J)),window.frameElement&&(this.windowEventListener=new L.J(window),this.windowEventListener.addListener("pagehide",this.onWindowUnloaded)),this._editorInitializationStartTime=l}registerTextTileEventListener(e){try{return this.hostEmitter.on(x.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983245,"Failed to register hostModelTextTile listener",e),!1}}registerDeltaEventListener(e){try{return this.hostEmitter.on(x.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983244,"Failed to register hostModelDelta listener",e),!1}}registerTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.on(x.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257550,"Failed to register hostModelTextTileEmittedToAugloop listener",e),!1}}unregisterTextTileEventListener(e){try{return this.hostEmitter.off(x.pD.hostModelTextTile,e),!0}catch(e){return this.logger.error(520983243,"Unable to unregister hostModelTextTile listener - no listener registered",e),!1}}unregisterDeltaEventListener(e){try{return this.hostEmitter.off(x.pD.hostModelDelta,e),!0}catch(e){return this.logger.error(520983242,"Unable to unregister hostModelDelta listener - no listener registered",e),!1}}unregisterTextTileEmittedToAugloopEventListener(e){try{return this.hostEmitter.off(x.pD.hostModelTextTileEmittedToAugloop,e),!0}catch(e){return this.logger.error(507257549,"Unable to unregister hostModelTextTileEmittedToAugloop listener - no listener registered",e),!1}}async setLocale(e){let t="string"==typeof e?[e]:e;0===t.length&&(t=[this.hostSettings.defaultLocale]);const i=await this.proofingPersistedStore.read(s.l.ProofingLanguages),n=t.toString()!==i.toString();await this.proofingPersistedStore.write(s.l.ProofingLanguages,t);const o=this.diContainer.getOptional(D.o);return null==o||o.emit("proofingLanguageChanged",{data:new A.z(t),messageType:c.G.ChangeData,proofingLanguagesChanged:n}),!!o}async setMultiLingualProofingLocales(e){await this.setLocale(e)}async enableSpelling(){await this._enableDisableSpelling(!0)}async disableSpelling(){await this._enableDisableSpelling(!1)}async enableGrammar(){await this._enableDisableGrammar(!0)}async enableRefinements(){await this._enableDisableRefinements(!0)}async setOverriddenCritiqueTypeOptions(e){await this.proofingPersistedStore.write(s.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(p.D).setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}async disableGrammar(){await this._enableDisableGrammar(!1)}async disableRefinements(){await this._enableDisableRefinements(!1)}async isSpellingEnabled(){return this.proofingPersistedStore.read(s.l.EnableSpelling)}async isGrammarEnabled(){return this.proofingPersistedStore.read(s.l.EnableGrammar)}async areRefinementsEnabled(){return this.proofingPersistedStore.read(s.l.EnableRefinements)}async _enableDisableSpelling(e){await this.proofingPersistedStore.read(s.l.EnableSpelling)!==e&&(await this.proofingPersistedStore.write(s.l.EnableSpelling,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableGrammar(e){await this.proofingPersistedStore.read(s.l.EnableGrammar)!==e&&(await this.proofingPersistedStore.write(s.l.EnableGrammar,e),this._emitEnabledCritiqueTypesChanged())}async _enableDisableRefinements(e){await this.proofingPersistedStore.read(s.l.EnableRefinements)!==e&&(await this.proofingPersistedStore.write(s.l.EnableRefinements,e),this._emitEnabledCritiqueTypesChanged())}_refreshTileNodes(){this.diContainer.get(h.G).pollNodes(c.G.ChangeData,this.proofingDom.tileNodes,n.Q0.Code,void 0,!0)}clearResources(){const e=this.diContainer.getOptional(F.s);null==e||e.clearIgnoredWords()}shutDown(){var e,t,i,n;if(!this.isEditorClientShutdown)try{this.isEditorClientShutdown=!0,null===(e=this.diContainer.getOptional(G.H))||void 0===e||e.logTelemetry(),this.diContainer.unbind(q.jh),this.diContainer.unbind(q.sh),this.diContainer.unbind(q.q4),this.diContainer.unbind(q.Ze),this.diContainer.unbind(q.cg),this.diContainer.unbind(q.oA),this.clearResources(),this.diContainer.get(K.W).shutDown(),null===(t=this.windowEventListener)||void 0===t||t.removeAllListeners(),this.windowEventListener=void 0,null===(i=this.orchestrator)||void 0===i||i.shutDown(),this.diContainer.get(R.V).shutDown(),this.diContainer.get($.J).clear()}catch(e){this.logger.error(520983241,"error while shutting down the editor client.",e),null===(n=this.onError)||void 0===n||n.call(this,"Error while shutting down the editor client.",e)}}logout(){this.hostEmitter.emit(x.pD.logout,{address:void 0,message:void 0})}get roamingDictionaryFeature(){return this.roamingDictionaryFeatureObj}get externalSettingsFeature(){return this.externalSettingsFeatureObj}updateUserInfo(e){this.userInfoUpdater.update(e)}async initialize(e){this.isEditorClientShutdown||(await this.initializeSDK(),await this.initializeUX(e))}async initializeSDK(){var e;if(this.isEditorClientShutdown)return;if(this.isInitialized)return;this.isInitialized=!0,(0,Q.configure)({enforceActions:"observed"});const t=(0,Z.$)();if(await(null==t?void 0:t.loadLocale(this.hostSettings.defaultLocale)),await(null===(e=this.orchestrator)||void 0===e?void 0:e.initialize()),!this.isEditorClientShutdown){await this.diContainer.get(P.H).initializeComponent();try{await this.diContainer.get(M.e).executeAsync(!0)}catch(e){}}}async initializeUX(e){var t,i,n;if(!this.isEditorClientShutdown&&!this.isUXInitialized){this.isUXInitialized=!0;try{this.diContainer.bind(q.jh).toValue(new z.O(null!=e?e:document)),this.diContainer.bind(q.sh).toValue(new z.O(null!==(t=(null!=e?e:document).defaultView)&&void 0!==t?t:window)),await this.diContainer.get(K.W).initializeComponent()}catch(e){this.logger.error(509634378,"Failed to initialize ux",e),null===(i=this.onError)||void 0===i||i.call(this,"Failed to initialize ux.",e)}null===(n=this.diContainer.getOptional(V.$))||void 0===n||n.schedule(1e3,3e5),await this.initLocale(this.hostSettings.defaultLocale),this.languageDetectionSubscriber=this.diContainer.getOptional(H.X),this.logEditorInitializationComplete()}}logEditorInitializationComplete(){const e=new Date,t=(0,j.W)(["initializationEndTime",e.toISOString()],["initializationStartTime",this._editorInitializationStartTime.toISOString()],["initializationTime",e.getTime()-this._editorInitializationStartTime.getTime()],["isCIQEnabled",(this.hostSettings.flightsToTrack||[]).includes("mc-editor-oa")]);if(this.featureFlagReader.flags.enableLoggingModulesAndBindings){const e=this.diContainer.getBindings().map((e=>`${"function"!=typeof e.token?e.token.toString():e.token.name}: [${e.boundServices.map((e=>{var t;return null===(t=e.cache)||void 0===t?void 0:t.constructor.name}))}]`)).toString();t.push(...(0,j.W)(["addedModuleClassNamesSize",this.rootInjector.addedModuleClassNames.size],["addedModuleClassNames",[...this.rootInjector.addedModuleClassNames].join(", ")],["modulesSharingSameModuleKeyButDifferentClassname",[...this.rootInjector.modulesSharingSameModuleKeyButDifferentClassname].join(", ")],["bindings",e]))}this.logger.logActivity("EditorInitializationComplete",void 0,t)}async initLocale(e){await this.setLocale(e)}setAvailableCritiqueTypes(e,t){const i=this.diContainer.getOptional(p.D);i&&(i.setAvailableCritiqueTypes(e,t),this._emitEnabledCritiqueTypesChanged())}async setPaneOnlyOverriddenCritiqueTypeOptions(e){const t=this.diContainer.getOptional(m.M);t&&(await this.proofingPersistedStore.write(s.l.PaneOverriddenCritiqueTypeOptions,e),t.setOverriddenCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}setAvailablePaneOnlyCritiqueTypes(e){const t=this.diContainer.getOptional(m.M);t&&(t.setAvailableCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged())}_emitEnabledCritiqueTypesChanged(){this.diContainer.get(D.o).emit("enabledCritiqueTypesChanged",{messageType:c.G.ChangeData})}async disableProofing(){var e;if(this._proofingDisabled)return!0;if(!this.orchestrator)return!1;const t=await this.orchestrator.deactivateAnnotations([W.nL.getTypeName()]);for(const t of this.proofingDom.tileNodes)this.hostEmitter.emit(x.pD.clearCritiquesForNode,{message:{nodeId:t.id,seqId:(null!==(e=t.eventSeqId)&&void 0!==e?e:0).toString()},address:void 0});return this._proofingDisabled=!0,t}async enableProofing(){var e,t;if(!this._proofingDisabled)return;if(null===(e=this.orchestrator)||void 0===e?void 0:e.activateAnnotations([W.nL.getTypeName()])){for(const e of this.proofingDom.tileNodes)this.hostEmitter.emit(x.pD.restoreNodeForCritiqueStore,{message:{nodeId:e.id,seqId:(null!==(t=e.eventSeqId)&&void 0!==t?t:0).toString()},address:void 0});this._refreshTileNodes(),this._emitEnabledCritiqueTypesChanged(),this._proofingDisabled=!1}}addWordsToIgnoreList(e){const t=this.diContainer.getOptional(F.s);null==t||t.addWordsToIgnoreList(e)}setLanguageDetectedCallback(e){var t;null===(t=this.languageDetectionSubscriber)||void 0===t||t.setLanguageDetectedOnSignalCallback(e)}}var X=i(672933),ee=i(243879);class te extends Y{constructor(e,t,i,n=void 0,s,o,r=new Date){super(e,t,i,n,s,o,r),this.critiqueSuggestionClearanceCallbacks=[],this.updateDarkMode=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDarkMode(e)},this.getComponentsSupportedForTheming=()=>{var e,t;return null!==(t=null===(e=this.themeStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.updateDefaultTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateDefaultTheme(e)},this.updateCurrentTheme=e=>{var t;null===(t=this.themeStore)||void 0===t||t.updateCurrentTheme(e)},this.getComponentsSupportedForStyling=()=>{var e,t;return null!==(t=null===(e=this.styleStore)||void 0===e?void 0:e.components)&&void 0!==t?t:[]},this.isPremiumUser=this.diContainer.get(d.r),this.themeStore=this.diContainer.getOptional(T.YQ),this.styleStore=this.diContainer.getOptional(T.UC),this.themeStore&&T.Cx.forEach(((e,t)=>{var i;null===(i=this.themeStore)||void 0===i||i.updateComponentThemes(t,e)})),this.styleStore&&T.w.forEach(((e,t)=>{var i;null===(i=this.styleStore)||void 0===i||i.updateComponentStyle(t,e)}))}async initLocale(e){var t,i;const n=null!==(i=this.hostSettings.isMultilingualProofingEnabled&&(null===(t=this.hostSettings.proofingLocales)||void 0===t?void 0:t.length)?this.hostSettings.proofingLocales:void 0)&&void 0!==i?i:[e];await this.setLocale(n),await this.setUiLocale(e)}async setLocale(e){const t="string"==typeof e?[e]:e;return super.setLocale(t)}async setUiLocale(e){var t;const i=(0,Z.$)().loadLocale(e);await i;const n=this.diContainer.getOptional(X.C);if(n)try{await n.setUiLocale(e)}catch(i){this.logger.error(507885057,"Failed to initialize categories locale for: "+e,i),null===(t=this.onError)||void 0===t||t.call(this,"Failed to initialize categories locale for: "+e,i)}}setLocaleForTile(e,t){const i=this.proofingDom.findTileNode(e);if(!i)return!1;i.specifiedLocale=t,i.resetState();this.diContainer.get(u.$).resetNode(i.id);return this.diContainer.get(h.G).pollNodes(c.G.NewData,[i],n.Q0.Code,void 0,!0),!0}registerCustomIconSet(e){for(const t of Object.keys(e))(0,E.Z)(t,e[t])}async setBothOverrideAndPaneOnlyOverriddenCritiqueTypeOptions(e,t){await this.proofingPersistedStore.write(s.l.OverriddenCritiqueTypeOptions,e),this.diContainer.get(p.D).setOverriddenCritiqueTypes(e);const i=this.diContainer.getOptional(m.M);i&&(await this.diContainer.get(o.K).write(s.l.PaneOverriddenCritiqueTypeOptions,t),i.setOverriddenCritiqueTypes(t)),this._emitEnabledCritiqueTypesChanged(),this._refreshTileNodes()}enablePremiumUntil(e){this.isPremiumUser.setGracePeriodUntil(e)}setPremiumCritiqueTypes(e){this.diContainer.get(f.g).setPremiumCritiqueTypes(e),this._emitEnabledCritiqueTypesChanged()}setPreviewCritiquesCount(e,t){const i=this.diContainer.get(v.Ey);i.setPreviewModeActive(!0),i.setPreviewCount(e,!0),i.setPreviewUnit(t)}setPremiumPreviewActive(e){this.diContainer.get(v.Ey).setPreviewModeActive(e)}setLightUpPremiumSquiggles(e){this.diContainer.get(v.Ey).setLightUpPremiumSquiggles(e)}onPremiumCountChange(e){this.diContainer.get(v.Ey).setOnPremiumCountChange(e)}onPreviewCritiquesCountChange(e){this.diContainer.get(v.Ey).setOnPreviewCritiquesCountChange(e)}onDisableCritique(e){this.diContainer.get(y.W).setOnDisableCritique(e)}onFeedbackIconClicked(e){this.diContainer.get(_.M).setOnFeedbackIconClicked(e)}async setLanguageValueFromConfigResponses(e,t,i){const n=this.diContainer.get(I);await n.setLanguageValueFromConfigResponses(e,t,i)}onApplyCritiqueSuggestion(e,t){const i=this.diContainer.get(g.a).handleApplyCritiqueSuggestion(e,t);this.critiqueSuggestionClearanceCallbacks.push(i)}exp_getActivityLogger(){return this.diContainer.get(r.g)}exp_getOaLogger(){return this.diContainer.get(a.m)}exp_getQueryDetection(){return this.diContainer.get(l.J)}onTryPremiumPreview(e){this.diContainer.get(v.Ey).setOnTryPremiumPreview(e)}onPremiumPreviewExpired(e){this.diContainer.get(v.Ey).setOnPremiumPreviewExpired(e)}getComponentThemes(e){var t;return null===(t=this.themeStore)||void 0===t?void 0:t.getComponentThemes(e)}getDefaultTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.defaultTheme}getCurrentTheme(){var e;return null===(e=this.themeStore)||void 0===e?void 0:e.currentTheme}updateComponentThemes(e,t){var i;null===(i=this.themeStore)||void 0===i||i.updateComponentThemes(e,t)}getComponentStyle(e){var t;return null===(t=this.styleStore)||void 0===t?void 0:t.getComponentStyle(e)}updateComponentStyle(e,t){var i;null===(i=this.styleStore)||void 0===i||i.updateComponentStyle(e,t)}updateFluentThemes(e){var t;null===(t=this.themeStore)||void 0===t||t.updateFluentThemes(e)}setOnCritiqueAdded(e){this.diContainer.get(C.y).setOnCritiqueAdded(e)}enableInlineSuggestionsMenu(e,t,i,n,s,o,r,a,l,d,c,u,g,h,p,m,f,v,y,_,I,C,S,b,T){if(!t)throw Error("You must specify a query character.");this.enableMenu(Object.assign(Object.assign({queryChar:t,onItemSelected:i,styles:r,onOpen:a,onClose:l,onAction:d,shouldRemoveTextOnItemSelection:c,specifiedItemsToDisplay:n,onSuggestionsUpdated:u,onRestoreFocus:g,onPreventDismissCalloutOnEvent:h,onGroupSelected:p,brandingMode:m,getLocalItems:v,isDividerShown:y,noSuggestionsHeaderInfo:_,newEntityTypes:I,newItemsById:S},C?{enableExpandedECC:!0,enableExpandedMenuSearchBar:b,supportedEntityTypes:null!=e?e:[]}:{enableExpandedECC:!1,supportedEntityTypes:e,enableScopedHeader:f}),{fluentV9Theme:T}))}enableMenu(e){var t;if(!(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled))return;this.diContainer.get(ee.V).enableMenu(e),this.logger.logActivity("ECCMenuEnabled")}disableInlineSuggestionsMenu(e){var t;if(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled){this.diContainer.get(ee.V).disableInlineSuggestionsMenu(e)}}showInlineSuggestionsMenuWithItems(e,t,i,n,s,o,r,a){var l;if(null===(l=this.hostSettings.oaSettings)||void 0===l?void 0:l.isContextualCardEnabled){return this.diContainer.get(ee.V).renderMenuWithItems(e,t,i,n,s,o,r,a)}return Promise.resolve(!1)}async showExistingMenu(e,t,i,n,s,o,r,a,l,d){var c;if(null===(c=this.hostSettings.oaSettings)||void 0===c?void 0:c.isContextualCardEnabled){const c=this.diContainer.get(ee.V);await c.showExistingMenu(e,t,i,n,s,o,r,a,l,d)}}async showExistingMenuAtCursor(e,t,i){var n;if(!(null===(n=this.hostSettings.oaSettings)||void 0===n?void 0:n.isContextualCardEnabled))return;const s=this.diContainer.get(S.d),o=await s.getTextSelection();(null==o?void 0:o.endParagraphNode)&&void 0!==o.endPositionInParagraphNode&&await this.showExistingMenu(o.endParagraphNode.id,o.endPositionInParagraphNode-e,e,t,!1,i)}async insertAndDisplayInlineSuggestionsMenu(e,t,i){var n;if(!e)return!1;if(null===(n=this.hostSettings.oaSettings)||void 0===n?void 0:n.isContextualCardEnabled){const n=this.diContainer.get(S.d);let s,o;if(t&&i){const e=this.proofingDom.findParagraphNode(t);if(!(0,b.l)(e))return!1;s=e.parent,o=await n.getNodeInsertionPosition(s,e.element.offset+i,!0)}else{const e=await n.getTextSelection();if(!e||e.startParentElement.id!==e.endParentElement.id)return!1;s=e.startParentElement,o=e.startPosition===e.endPosition?await n.getNodeInsertionPosition(s,e.startPosition,!0):await n.getRangeOfNode(s,void 0,e.startPosition,e.endPosition-e.startPosition)}return!!o&&(await n.insert(s,void 0,0,e,!0,o,!0),!0)}return!1}shutDown(){try{super.shutDown();for(const e of this.critiqueSuggestionClearanceCallbacks)e();this.critiqueSuggestionClearanceCallbacks=[]}catch(e){this.logger.error(509690076,"error while shutting down the editor client.",e)}}notifyMenuTriggeringMethod(e){this.diContainer.get(ee.V).notifyMenuTriggeringMethod(e)}}},848587:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"IsImplemented":true,"LocalizedName":"Isipelingi"}}')},850282:(e,t,i)=>{if(i.d(t,{E:()=>c}),0!=i.j)var n=i(722864);if(0!=i.j)var s=i(486138);if(0!=i.j)var o=i(60759);if(0!=i.j)var r=i(923277);if(0!=i.j)var a=i(166137);if(0!=i.j)var l=i(728474);if(0!=i.j)var d=i(234483);class c{constructor(){this.imports=[r.r,n.E]}configureRootServices(e){e.bind(a.M).to(l.t),e.bind(s.$).to(s.I),e.bind(d.P).to(o.Q)}}},851459:(e,t,i)=>{if(i.d(t,{Q:()=>d}),0!=i.j)var n=i(177822);if(0!=i.j)var s=i(416697);if(0!=i.j)var o=i(811861);if(0!=i.j)var r=i(760279);if(0!=i.j)var a=i(251439);if(0!=i.j)var l=i(386675);class d{constructor(){this.imports=[s.B,n.J]}get uniqueId(){return(0,a.z)(507918296)}configureRootServices(e){e.bind(o.Tc).to(r.l),e.bind(l.S).toExisting(o.Tc)}}},851600:(e,t,i)=>{i.d(t,{I:()=>f});var n=i(379490),s=i(418876),o=i(909113),r=i(692551),a=i(647879),l=i(728671),d=i(494888),c=i(163573),u=i(877931),g=i(636734),h=i(229906),p=i(83010),m=i(427603);let f=class{constructor(e,t,i,n){var d,c;this._featureFlagReader=e,this.hostSettings=t,this._logger=i,this._oaMetric=n,this._isNextDeltaProgrammaticallyInserted=!1,this._augloopReconnectionOccurring=!1,this._unsupportedEntities=[],this.registeredQueryDetectionStartChars=[],this.FORBIDDEN_CHARS=['"',"<",">","/","\\","|"],this.PUNCTUATION_CHARS=[",",".",":","!","?","'",";","&"],this.ALLOWED_PREVIOUS_CHARS=["(","/","+","מ"],this.registerQueryDetectionStartCharacter=e=>{this.registeredQueryDetectionStartChars.includes(e)||this.registeredQueryDetectionStartChars.push(e)},this.getRegisteredTriggers=()=>this.registeredQueryDetectionStartChars,this.unregisterQueryDetectionStartCharacter=e=>{const t=this.registeredQueryDetectionStartChars.indexOf(e);t>-1&&this.registeredQueryDetectionStartChars.splice(t,1)},this.handleAugloopReconnection=e=>{this._augloopReconnectionOccurring=!0;try{e()}finally{this._augloopReconnectionOccurring=!1}},this.handleTileRemoved=e=>{var t,i;return(null===(t=this._currentQuery)||void 0===t?void 0:t.tileId)===e&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),null===(i=this._currentQuery)||void 0===i?void 0:i.queryRange},this.getCurrentQuery=()=>this._currentQuery,this.getIsSameWordQueriesDismissed=()=>{var e;return null!==(e=this._isCurrentQueryDismissed)&&void 0!==e&&e},this.updateCurrentQuery=e=>{var t,i,n,s,o,r,a;if(this._currentQuery=e,this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1),!(null===(t=this.hostSettings.oaSettings)||void 0===t?void 0:t.e2eMetric))return;const l=this._currentQuery.queryRange.length===(null!==(n=null===(i=this._currentQuery.queryRange.prefix)||void 0===i?void 0:i.length)&&void 0!==n?n:1),d={logicalId:this._currentQuery.additionalData.logicalId||"",conversationId:this._currentQuery.additionalData.conversationId||"",clientCorrelationId:this._clientCorrelationId||"",triggerCharacter:null!==(s=this._currentQuery.queryRange.prefix)&&void 0!==s?s:"@",isEmptyQuery:l,queryLength:this._currentQuery.queryRange.length-(null!==(r=null===(o=this._currentQuery.queryRange.prefix)||void 0===o?void 0:o.length)&&void 0!==r?r:1)};null===(a=this._oaMetric)||void 0===a||a.startEntry(this._currentQuery.additionalData.logicalId,d)},this.getCurrentQueryTileId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.tileId},this.getCurrentQueryLogicalId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.logicalId},this.getCurrentQueryConversationId=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData.conversationId},this.getCurrentQueryCorrelationKeys=()=>{var e;return null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData},this.getPreviousQueryCorrelationKeys=()=>this._previousData,this.removeDetectedQuery=()=>{var e;this._previousData=null===(e=this._currentQuery)||void 0===e?void 0:e.additionalData,this._currentQuery=void 0,this._currentScope=void 0,this._unsupportedEntities=[]},this.setCurrentQueryRange=(e,t,i,n,s)=>{var o,a;return this.updateCurrentQuery({tileId:e,queryRange:t,additionalData:{triggerCharacter:s,scopeInfo:n,logicalId:this.registerNewLogicalId(),conversationId:i?(null===(o=this._currentQuery)||void 0===o?void 0:o.additionalData.conversationId)||"":(new r.L).generate(),clientCorrelationId:this._clientCorrelationId||""}}),null===(a=this._currentQuery)||void 0===a?void 0:a.additionalData},this.getCurrentScope=()=>this._currentScope,this.setCurrentScope=(e,t=!0)=>{this._currentScope=e,this._currentQuery&&t&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope})}))},this.getUnsupportedEntities=()=>this._unsupportedEntities,this.setUnsupportedEntities=e=>{this._unsupportedEntities=e,this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{unsupportedEntities:this._unsupportedEntities})}))},this.setClientCorrelationId=e=>{this._clientCorrelationId=e},this.setNextDeltaProgramaticallyInserted=e=>{this._isNextDeltaProgrammaticallyInserted=!0,this._programmaticallyInsertedSource=e},this.resetNextDeltaProgramaticallyInserted=()=>{this._isNextDeltaProgrammaticallyInserted=!1,this._programmaticallyInsertedSource=void 0},this.dismissCurrentQuery=(e,t,i,n)=>{var s,o,r;this._currentQuery&&(e&&(null===(s=this._logger)||void 0===s||s.logActivity(null!=i?i:"OACurrentQueryDismiss",void 0,[...null!=n?n:[],...(0,a.W)(["interaction",null!=t?t:"escape"],["conversationId",null!==(o=this.getCurrentQueryConversationId())&&void 0!==o?o:""],["logicalId",null!==(r=this.getCurrentQueryLogicalId())&&void 0!==r?r:""])])),this._isCurrentQueryDismissed=!0)},this.handleTileDelta=(e,t,i,n,r)=>{var a,l,d,c,u,g,h,p,m,f,v;const{deltaType:y,unit:_,length:I,content:C,position:S}=t;return y!==s.WI.Update||0!==I||C?void 0===I||void 0===S?this.getIfLocal(n)?{queryRange:null===(d=this._currentQuery)||void 0===d?void 0:d.queryRange,additionalData:null===(c=this._currentQuery)||void 0===c?void 0:c.additionalData}:{queryRange:void 0,additionalData:void 0}:_!==s.OD.Sentence&&_!==s.OD.Paragraph||y!==s.WI.Add&&y!==s.WI.Update||!((null!==(g=null===(u=null==C?void 0:C.trim())||void 0===u?void 0:u.length)&&void 0!==g?g:0)>1||0===(null===(h=null==C?void 0:C.trim())||void 0===h?void 0:h.length))||1===(null==C?void 0:C.length)&&o.xC(C.charCodeAt(0))?this.getIfLocal(n)?(this.handleLocalTileDelta(e,S,I,y,C,i,r),{queryRange:null===(f=this._currentQuery)||void 0===f?void 0:f.queryRange,additionalData:null===(v=this._currentQuery)||void 0===v?void 0:v.additionalData}):(this.handleRemoteTileDelta(e,S,I,y,C),{queryRange:void 0,additionalData:void 0}):(this._currentQuery&&this._currentQuery.tileId===e&&y===s.WI.Update&&C&&r&&C.length!==r.length&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0),this.getIfLocal(n)?{queryRange:null===(p=this._currentQuery)||void 0===p?void 0:p.queryRange,additionalData:null===(m=this._currentQuery)||void 0===m?void 0:m.additionalData}:{queryRange:void 0,additionalData:void 0}):this.getIfLocal(n)?{queryRange:null===(a=this._currentQuery)||void 0===a?void 0:a.queryRange,additionalData:null===(l=this._currentQuery)||void 0===l?void 0:l.additionalData}:{queryRange:void 0,additionalData:void 0}},this.getIfLocal=e=>this._featureFlagReader.flags.enableQueryOnlyOnLocalChange?e===l.Q0.Local:e===l.Q0.Local||e===l.Q0.Code,this.logQueryDetected=()=>{var e,t,i;null===(e=this._logger)||void 0===e||e.logActivity("OAQueryDetected",void 0,(0,a.W)(["conversationId",null!==(t=this.getCurrentQueryConversationId())&&void 0!==t?t:""],["logicalId",null!==(i=this.getCurrentQueryLogicalId())&&void 0!==i?i:""]))},this.handleLocalTileDelta=(e,t,i,n,a,l,d)=>{var c,u,g;const h=this._isNextDeltaProgrammaticallyInserted,p=this._programmaticallyInsertedSource;if(!this._augloopReconnectionOccurring)if(this._currentQuery){if(this._currentQuery.tileId!==e)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const{isWithinSearchQuery:o,updatedEditedPosition:r}=this.isWithinSearchQuery(n,t,i,a,null!==(c=null==a?void 0:a.length)&&void 0!==c?c:0,l,d);if(!o)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(a&&void 0!==this.FORBIDDEN_CHARS.find((e=>a.includes(e))))return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);if(t=r,n===s.WI.Add&&void 0!==a){const e=l.substring(this._currentQuery.queryRange.start,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length);if(1===a.length&&this.isWhitespace(a.charCodeAt(0))&&this._currentQuery.queryRange.prefix){let t=!0;for(let i=0;i<e.length;i++)if(e.charAt(i)!==this._currentQuery.queryRange.prefix){t=!1;break}if(t)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}this._currentQuery.queryRange.length+=a.length}else if(n===s.WI.Update&&void 0!==a&&i){const e=t-this._currentQuery.queryRange.start,n=this._currentQuery.queryRange.length-e,s=Math.min(i,n);if(this._currentQuery.queryRange.length+=a.length,this._currentQuery.queryRange.length-=s,0===this._currentQuery.queryRange.length)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0)}else if(n===s.WI.Delete){const e=t-this._currentQuery.queryRange.start,n=Math.min(this._currentQuery.queryRange.length-e,i);this._currentQuery.queryRange.length-=n}if(this._currentQuery.queryRange.length<(null!==(g=null===(u=this._currentQuery.queryRange.prefix)||void 0===u?void 0:u.length)&&void 0!==g?g:1))this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0;else{l.substring(this._currentQuery.queryRange.start+1,this._currentQuery.queryRange.start+this._currentQuery.queryRange.length).trim().split(" ").length>4&&(this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,this._currentScope=void 0)}if(this._currentQuery&&this._currentQuery.queryRange.length>this.maxQueryLength)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);this._currentQuery&&this.updateCurrentQuery(Object.assign(Object.assign({},this._currentQuery),{additionalData:Object.assign(Object.assign({},this._currentQuery.additionalData),{logicalId:this.registerNewLogicalId(),scopeInfo:this._currentScope,clientCorrelationId:this._clientCorrelationId||"",isUserInsertion:!h,source:p})}))}else if((n===s.WI.Add||n===s.WI.Update)&&a){const i=a,n=a.trim();if(this.registeredQueryDetectionStartChars.includes(n)){const s=i.indexOf(n),o=l[t+s-1];if(o&&!(this.isWhitespace(o.charCodeAt(0),!1)||this.ALLOWED_PREVIOUS_CHARS.includes(o)&&!this.registeredQueryDetectionStartChars.includes(o)))return;this.updateCurrentQuery({tileId:e,queryRange:{start:t+s,length:1,prefix:n},additionalData:{triggerCharacter:n,logicalId:this.registerNewLogicalId(),conversationId:(new r.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!h,source:p}}),this.logQueryDetected()}else if(a.length>0){for(let e=0;e<a.length;e++)o.Yv(a.charCodeAt(e))&&this._isCurrentQueryDismissed&&(this._isCurrentQueryDismissed=!1);for(let e=0;e<a.length;e++)if(o.Yv(a.charCodeAt(e))||this.FORBIDDEN_CHARS.includes(a.charAt(e)))return;if(this.PUNCTUATION_CHARS.includes(a))return;const i=this.getWordBeforeChange(l,t+a.length-1);if(this.registeredQueryDetectionStartChars.includes(i[0])){if(i.indexOf(i[0],1)>0)return;if(this._isCurrentQueryDismissed)return;if(i.length>this.maxQueryLength)return;this.updateCurrentQuery({tileId:e,queryRange:{start:t-i.length+a.length,length:i.length,prefix:i[0]},additionalData:{triggerCharacter:i[0],logicalId:this.registerNewLogicalId(),conversationId:(new r.L).generate(),clientCorrelationId:this._clientCorrelationId||"",scopeInfo:this._currentScope,isUserInsertion:!h,source:p}}),this.logQueryDetected()}}}},this.handleRemoteTileDelta=(e,t,i,n,o)=>{var r,a;if(!this._currentQuery)return;if(e!==this._currentQuery.tileId)return;if(t>=this._currentQuery.queryRange.start+this._currentQuery.queryRange.length)return;if(t>this._currentQuery.queryRange.start)return this._previousData=this._currentQuery.additionalData,this._currentQuery=void 0,void(this._currentScope=void 0);const l=n===s.WI.Add?null!==(r=null==o?void 0:o.length)&&void 0!==r?r:0:n===s.WI.Delete?-1*i:n===s.WI.Update?(null!==(a=null==o?void 0:o.length)&&void 0!==a?a:0)-i:0;this._currentQuery.queryRange.start+=l},this.isWithinSearchQuery=(e,t,i,n,o,r,a)=>{let l=t;if(!this._currentQuery)return{isWithinSearchQuery:!1,updatedEditedPosition:l};if(""===this._currentQuery.queryRange.prefix)return{isWithinSearchQuery:!0,updatedEditedPosition:l};if(l<this._currentQuery.queryRange.start)return{isWithinSearchQuery:!1,updatedEditedPosition:l};if(l===this._currentQuery.queryRange.start&&(e!==s.WI.Update||n!==this._currentQuery.queryRange.prefix))return{isWithinSearchQuery:!1,updatedEditedPosition:l};if(e===s.WI.Add&&void 0!==n&&1===o&&l>0){const e=r.charAt(l-1);(e===n||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(n.charCodeAt(0)))&&(l-=1)}if(e===s.WI.Delete&&1===i&&a){const e=r.charAt(l-1),t=a;(e===t||this.isWhitespace(e.charCodeAt(0))&&this.isWhitespace(t.charCodeAt(0)))&&(l-=1)}return l>this._currentQuery.queryRange.start+this._currentQuery.queryRange.length+(e!==s.WI.Delete?0:-1)?{isWithinSearchQuery:!1,updatedEditedPosition:l}:{isWithinSearchQuery:!0,updatedEditedPosition:l}},this.isWhitespace=(e,t)=>8203===e||o.Yv(e,t),this.getWordBeforeChange=(e,t)=>{let i;for(i=t;i>=0&&!this.isWhitespace(e.charCodeAt(i));i--);return e.substring(i+1,t+1)},this.registerNewLogicalId=()=>(new r.L).generate(),this.maxQueryLength=null!==(c=null===(d=this.hostSettings.oaSettings)||void 0===d?void 0:d.maxQueryLength)&&void 0!==c?c:300}};f=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,p.W)(d.c)),(0,n.__param)(1,(0,p.W)(c.n)),(0,n.__param)(2,(0,p.W)(u.g)),(0,n.__param)(2,(0,m.l)()),(0,n.__param)(3,(0,p.W)(g.u)),(0,n.__param)(3,(0,m.l)())],f)},851840:(e,t,i)=>{i.d(t,{W:()=>r});var n,s=i(379490),o=i(229906);!function(e){e[e.NoReaction=0]="NoReaction",e[e.EnableFeature=1]="EnableFeature",e[e.DisableFeature=2]="DisableFeature"}(n||(n={}));let r=class{constructor(){this._listenerId=0,this._callbacks=new Map,this.ignoreDisablers=!1,this.disablers=[],this.enablers=[]}triggerListeners(e){const t=this._callbacks.get(e.eventId);if(!t||0===t.length)return;let i=!0;return t.forEach((t=>{const[n,s]=t.callback(e);i=this.processCallBackResult(i,n,s)})),i}processCallBackResult(e,t,i){return t!==n.NoReaction?e&&t===n.EnableFeature:e}nextListenerId(){return this._listenerId+=1,this._listenerId}addListener(e,t){const i={callback:t,id:this.nextListenerId()};let n=this._callbacks.get(e);return n||(n=[],this._callbacks.set(e,n)),n.push(i),i.id}removeListener(e){e&&this._callbacks.forEach(((t,i,n)=>{if(t){if(-1!==t.findIndex((t=>t.id===e)))return void n.set(i,t.filter((t=>t.id!==e)))}}))}emitAndEvaluate(e){const t=this.triggerListeners(e);if(!this.ignoreDisablers)for(const e of this.disablers){if(!0===e)return!1;if(!1!==e&&e.check())return!1}let i=!1;for(const e of this.enablers)if(!0===e||!1!==e&&e.check()){i=!0;break}return void 0===t?i:i&&t}};r=(0,s.__decorate)([(0,o._)()],r)},852748:(e,t,i)=>{i.d(t,{G:()=>n});const n=(0,i(668952).f)("IGuidGenerator")},853148:(e,t,i)=>{i.d(t,{o:()=>n});const n=(0,i(668952).f)("IDescriptorManager")},855095:(e,t,i)=>{i.d(t,{M:()=>n});const n=(0,i(668952).f)("IPaneOnlyEnabledCritiqueTypes")},855304:(e,t,i)=>{if(i.d(t,{z:()=>s}),0!=i.j)var n=i(67573);function s(e){return 0===e?o:{notificationOnly:!1,delete:0!==(e&n.lb.Delete),ignore:0!==(e&n.lb.Ignore),ignoreAll:0!==(e&n.lb.IgnoreAll),ignoreCritiqueType:0!==(e&n.lb.IgnoreCritiqueType),addToDictionary:0!==(e&n.lb.AddToDictionary),showDetails:0!==(e&n.lb.ShowDetails)}}const o={notificationOnly:!0,delete:!1,ignore:!1,ignoreAll:!1,ignoreCritiqueType:!1,addToDictionary:!1,showDetails:!1}},855897:(e,t,i)=>{i.d(t,{I:()=>o});var n=i(576583),s=i(852853);const o=(0,n.n)({icon:{color:s.L.colorNeutralForeground1}})},857132:(e,t,i)=>{i.d(t,{X:()=>a,o:()=>r});var n=i(379490),s=i(668952),o=i(229906);const r=(0,s.f)("IPredictionStore");let a=class{constructor(){this.updatePrediction=async e=>{this._currentPrediction=e,this._onUpdate&&await this._onUpdate()},this.clearPrediction=async()=>{this._currentPrediction=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentPrediction=()=>this._currentPrediction,this.setOnUpdatedPrediction=e=>{this._onUpdate=e}}};a=(0,n.__decorate)([(0,o._)()],a)},857517:(e,t,i)=>{var n;i.d(t,{S:()=>n}),function(e){e.Offered="Offered",e.Seen="Seen",e.Tried="Tried",e.Kept="Kept",e.Rejected="Rejected"}(n||(n={}))},859916:(e,t,i)=>{i.d(t,{I:()=>r});var n=i(379490),s=i(419728),o=i(637224);class r{get count(){var e;return null!==(e=this._codesList.length)&&void 0!==e?e:0}get defaultLanguageCode(){return r.getDefaultLanguageCode(this._codesList)}static getDefaultLanguageCode(e){return e&&e.length>0?e[0]:""}get codesList(){return this._codesList||[]}constructor(e){this.equalsTo=e=>{if(!e||this._codesList.length!==e.length)return!1;for(let t=0;t<this._codesList.length;t+=1)if(this._codesList[t].toLocaleLowerCase()!==e[t].toLocaleLowerCase())return!1;return!0},this.add=e=>!this._codesList.includes(e)&&(this._codesList.push(e),!0),this.remove=e=>{const t=this._codesList.indexOf(e);return!(t<0)&&(this._codesList.splice(t,1),!0)},this.moveUp=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const i=this._codesList[t-1];return this._codesList[t-1]=this._codesList[t],this._codesList[t]=i,!0},this.moveDown=e=>{const t=this._codesList.indexOf(e);if(t<0||t===this._codesList.length-1)return!1;const i=this._codesList[t+1];return this._codesList[t+1]=this._codesList[t],this._codesList[t]=i,!0},this.moveToTop=e=>{const t=this._codesList.indexOf(e);if(t<=0)return!1;const i=this._codesList[t];for(let e=t;e>0;e-=1)this._codesList[e]=this._codesList[e-1];return this._codesList[0]=i,!0},this._codesList=e,(0,o.Gn)(this)}}(0,n.__decorate)([s.observable],r.prototype,"_codesList",void 0),(0,n.__decorate)([s.computed],r.prototype,"count",null),(0,n.__decorate)([s.computed],r.prototype,"defaultLanguageCode",null),(0,n.__decorate)([s.computed],r.prototype,"codesList",null)},862220:(e,t,i)=>{i.d(t,{V:()=>c});var n=i(182755),s=i(12163),o=i(46692),r=i(488731),a=i(456204),l=i(753031),d=i(137464);class c{constructor(e,t,i=!1,s=new n.M){this.kpisEnabled=i,this._oTelTelemetryLogger=s;const{logGroupName:o,tenant:r}=e,{tenantName:a,ariaTenantToken:l,nexusTenantToken:d}=r;this._logGroupName=o,this._oTelTelemetryLogger.addSink(t),this._oTelTelemetryLogger.setTenantToken(`Office.${a}`,l,d),this._namespace=`Office.${a}.${o}`}logEvent(e,t,i,n,r,u,g,h,p){const m=i===a.h.Undefined?t:`${i}.${t}`;if(n===l.q.Debug)return;const f=[(0,s.Ug)("Tag",e),(0,s.Ug)("Level",n)];r&&f.push((0,s.m9)(null!=p?p:"Data",(0,d.v)(r))),f.forEach((e=>e.classification=o.o.DataClassification.SystemMetadata)),this.uploadEvent(m,f,null!=u?u:c.DEFAULT_SAMPLING_POLICY,null!=g?g:c.DEFAULT_DIAGNOSTIC_LEVEL,null!=h?h:c.DEFAULT_DATA_CATEGORIES)}logKpi(e,t,i,n,a){if(!this.kpisEnabled)return;const l=`KPIs.${e}`,d=[(0,s.m9)("Entity_Id",t),(0,s.LK)("IsPremium",n)];a&&d.push((0,s.m9)("Data",JSON.stringify(a))),d.forEach((e=>e.classification=o.o.DataClassification.SystemMetadata));const c=r.A.Office.System.Funnel.getFields("Funnel",{name:this._logGroupName,state:i});d.push(...c),this.uploadEvent(l,d,o.o.SamplingPolicy.CriticalUsage,o.o.DiagnosticLevel.RequiredServiceData,o.o.DataCategories.ProductServiceUsage)}logStandaloneMetric(e,t,i,n,s=[]){const o=null!=t?t:c.DEFAULT_SAMPLING_POLICY,r=null!=i?i:c.DEFAULT_DIAGNOSTIC_LEVEL,a=null!=n?n:c.DEFAULT_DATA_CATEGORIES;this.uploadEvent(e,s,o,r,a)}createActivity(e,t,i){const n=t?`${t}.${e}`:e;return this._oTelTelemetryLogger.createActivity({eventName:this.getFullEventName(n),eventFlags:null!=i?i:{dataCategories:o.o.DataCategories.ProductServiceUsage}})}uploadEvent(e,t,i,n,s){const r=this.getFullEventName(e);this._oTelTelemetryLogger.sendTelemetryEvent({eventName:r,dataFields:t,eventFlags:{dataCategories:s,diagnosticLevel:n,costPriority:o.o.CostPriority.Normal,persistencePriority:o.o.PersistencePriority.Normal,samplingPolicy:i}})}getFullEventName(e){return this.capitalize(`${this._namespace}.${e}`)}capitalize(e){return e.split(".").map(this.capitalizeWord).join(".")}capitalizeWord(e){return e.charAt(0).toUpperCase()+e.slice(1)}}c.DEFAULT_SAMPLING_POLICY=o.o.SamplingPolicy.Measure,c.DEFAULT_DIAGNOSTIC_LEVEL=o.o.DiagnosticLevel.RequiredServiceData,c.DEFAULT_DATA_CATEGORIES=o.o.DataCategories.ProductServiceUsage},862732:(e,t,i)=>{i.d(t,{y:()=>o});var n=i(379490),s=i(229906);let o=class{getUrl(e){return e}};o=(0,n.__decorate)([(0,s._)()],o)},863082:(e,t,i)=>{i.d(t,{C:()=>h});var n,s=i(379490),o=i(833801),r=i(298070),a=i(838630),l=i(689878),d=i(691474);!function(e){e.CourtesyAttributes="CourtesyAttributes",e.RootContentMaxLengthInChars="RootContentMaxLengthInChars"}(n||(n={}));var c=i(229906),u=i(83010);const g=new Map([[n.CourtesyAttributes,["data-gramm"]],[n.RootContentMaxLengthInChars,500]]);let h=class extends o.u{populateStoreEntryMap(){const e=new Map;return g.forEach(((t,i)=>{e.set(i,{storeEntry:(0,r.Tm)(i,t),isSynced:!1})})),e}constructor(e,t,i){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=i}async initialize(){for(const e of g.keys())await this.read(e),this._emitter.on(e,(async()=>{await this.read(e)}))}shutDown(){}async removePersistentKeys(){const e=Array.from(g.keys());e.length&&await this.storeEntryWriter.remove(e)}};h=(0,s.__decorate)([(0,c._)(),(0,s.__param)(0,(0,u.W)(a.A)),(0,s.__param)(1,(0,u.W)(l.a)),(0,s.__param)(2,(0,u.W)(d.E))],h)},863307:(e,t,i)=>{i.d(t,{B8:()=>p,I6:()=>m,_v:()=>f});var n=i(730387);if(0!=i.j)var s=i(301062);if(0!=i.j)var o=i(562093);if(0!=i.j)var r=i(806025);if(0!=i.j)var a=i(460855);if(0!=i.j)var l=i(70303);if(0!=i.j)var d=i(645461);if(0!=i.j)var c=i(651961);if(0!=i.j)var u=i(543943);if(0!=i.j)var g=i(962015);let h=null;const p=new n.C;async function m(e){var t,i;if(h)return;const n=e.clientMetadata;n.ciqPackageVersion=g.r;const p=(0,s.Hz)(n),m=null!==(t=e.telemetrySink)&&void 0!==t?t:function(e){const t=new d.r(e,{endpointUrl:c.d.PUBLIC});return t.setFullEventsEnabled(!1),t}(p),f=null!==(i=e.transportActivityLogger)&&void 0!==i?i:function(e){const t=new r.E;return new a.G(e,t,void 0)}(m),v=new o.q([f],f),y=new l.z({enableClearingOfRequestedAnimationFrames:!0});h=new u.w(v,y,"CiqLatencyMeasure",{oaSettings:{e2eMetric:!0}}),await h.initialize(n,!1)}function f(){if(!h)throw new Error("ciqLogger has not been initialized. Call initializeCiqLogger first.");return h}},866689:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"LocalizedName":"Concisão","IsImplemented":true},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Escritura coerente"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Linguagem inclusiva","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Erros de digitação"},"Clarity":{"LocalizedName":"Clareza","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"Reescrita","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Correção de erros"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"LocalizedName":"Escolha vocabular","IsImplemented":true},"Grammar":{"IsImplemented":true,"LocalizedName":"Gramática"},"SimplerFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"LocalizedName":"Linguagem formal","IsImplemented":true},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"LocalizedName":"Pontuação","IsImplemented":false},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Normas de escrita"},"Spelling":{"LocalizedName":"Ortografia","IsImplemented":true},"Resume":{"LocalizedName":"Currículo","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":true,"LocalizedName":"Referências geopolíticas delicadas"}}')},868038:(e,t,i)=>{i.d(t,{$:()=>f,s:()=>m});var n=i(379490),s=i(1144),o=i(10075),r=i(553164),a=i(944749),l=i(104072),d=i(538045),c=i(83605),u=i(668952),g=i(229906),h=i(83010),p=i(427603);const m=(0,u.f)("ICritiqueRangeBuilder");let f=class{constructor(e,t,i){this._tileContent=e,this._proofingDom=t,this._tileNodeTraverser=i,this.getCritiqueRangeAcrossTileNodes=e=>{const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!t)return Promise.resolve(void 0);let i;return i=e.endNode?this.getParagraphNodeAndOffset(e.endNode.nodeId,e.endNode.end):this.getParagraphNodeAndOffset(e.nodeId,e.length),i?this.getRangeAcrossTileNodes(t.paragraphNode,i.paragraphNode,t.offset,i.offset):Promise.resolve(void 0)},this.getParagraphNodeAndOffset=(e,t)=>{const i=this._proofingDom.findParagraphNode(e);if(i)return{paragraphNode:i,offset:t};const n=this._proofingDom.findTileNode(e);if(!(null==n?void 0:n.children))return;let o;for(const e of n.children)(0,s.l)(e)&&t>=e.element.offset&&t<e.element.offset+e.element.span&&(o=e);return o?{paragraphNode:o,offset:t-o.element.offset}:void 0},this.getRangeAcrossTileNodes=async(e,t,i=0,n=-1)=>{let o=null;o="string"==typeof e?this._proofingDom.findParagraphNode(e):e;let r=null;if(r="string"==typeof t?this._proofingDom.findParagraphNode(t):t,(0,s.l)(o)&&(0,s.l)(r)){const e=await this._tileContent.getNodeInsertionPosition(o.parent,o.element.offset+i,!0),t=await this._tileContent.getNodeInsertionPosition(r.parent,r.element.offset+(-1===n?r.element.span:n),!1);if(!(null==e?void 0:e.startContainer.ownerDocument)||!(null==t?void 0:t.endContainer.ownerDocument)||e.startContainer.ownerDocument!==t.endContainer.ownerDocument)return;const s=e.startContainer.ownerDocument.createRange();return s.setStart(e.startContainer,e.startOffset),s.setEnd(t.endContainer,t.endOffset),s}},this.ensureNoLeadingOrTrailingWhitespace=e=>{if(e.endNode)return e;const t=e.nodeId?this.getParagraphNodeAndOffset(e.nodeId,e.start):void 0;if(!(null==t?void 0:t.paragraphNode.element)||!e.nodeId)return e;const i=t.offset-t.paragraphNode.element.offset,n=this._paragraphTextExtractor.getTextBetween(e.nodeId,e.nodeId,i,i+e.length);if(!n)return e;let s=e.start,o=e.length;const r=n.trimStart(),a=n.trimEnd();return n.length!==r.length&&(s+=n.length-r.length,o-=n.length-r.length),n.length!==a.length&&(o-=n.length-a.length),Object.assign(Object.assign({},e),{start:s,length:o})},this._paragraphTextExtractor=new o.o(this._proofingDom,this._tileNodeTraverser)}async getCritiqueRanges(e,t){var i,n,s;const o=new Map;for(const t of e){const e=t.nodeId?this._proofingDom.findNode(t.nodeId):t.tileId?this._proofingDom.findNode(t.tileId.nodeId):null,s=(null==e?void 0:e.nodeType)===r.Z.ParagraphNode?e.parent:(null==e?void 0:e.nodeType)===r.Z.TileNode?e:void 0;if((0,a.$)(s)){const e=null!==(n=null===(i=o.get(s.id))||void 0===i?void 0:i[0])&&void 0!==n?n:[];e.push(t),o.set(s.id,[e,s])}}const l=new Map;for(const[e,i]of o.values()){const n=[],o=[];for(const t of e)if(t.endNode){const e=this._proofingDom.findParagraphNode(t.endNode.nodeId);(null===(s=null==e?void 0:e.parent)||void 0===s?void 0:s.id)!==i.id?o.push(t):n.push(t)}else n.push(t);if(n.length>0){const e=await this._tileContent.getCritiqueRanges(i,t,n.map(this.ensureNoLeadingOrTrailingWhitespace));for(const t of e)l.set(n.find((e=>e.traceId===t.critique.traceId)),t.range)}if(o.length>0)for(const e of o)l.set(e,await this.getCritiqueRangeAcrossTileNodes(this.ensureNoLeadingOrTrailingWhitespace(e)))}return e.map((e=>({critique:e,range:l.get(e)})))}};f=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,h.W)(l.d)),(0,n.__param)(1,(0,h.W)(d.w)),(0,n.__param)(2,(0,h.W)(c.M)),(0,n.__param)(2,(0,p.l)())],f)},869070:(e,t,i)=>{if(i.d(t,{o:()=>l}),0!=i.j)var n=i(662459);if(0!=i.j)var s=i(818256);if(0!=i.j)var o=i(389971);if(0!=i.j)var r=i(62049);var a=i(208520);const l=e=>{const{description:t,icon:i}=(({item:e,locale:t,currentUserDisplayName:i})=>{const l=e.details;return(0,r.gu)(l)?{description:(0,s.VC)(l,i),icon:(0,o.I3)(l)}:(0,r.XU)(l)?{description:(0,s.MQ)(l),icon:(0,o.jv)(l)}:(0,r.kS)(l)?{description:(0,s.$X)(l,t),icon:(0,o.u6)(l)}:(0,r.w2)(l)?{description:(0,s.Tv)(l),icon:(0,o.HC)()}:(0,r.hV)(l)?{description:l.description,icon:(0,o.Pj)()}:(0,r.$N)(l)?{description:(0,s.Sy)(l),icon:(0,o.HA)(l)}:{description:"",icon:a.createElement(n.OL4,null)}})(e);return{avatar:{"aria-label":e.item.type,icon:i},value:e.item.id,primaryText:e.item.name,secondaryText:t,type:e.item.type}}},872317:(e,t,i)=>{if(i.d(t,{$q:()=>p,BX:()=>v,Fd:()=>m,IJ:()=>h,XH:()=>f,qu:()=>g}),0!=i.j)var n=i(418876);if(0!=i.j)var s=i(40429);if(0!=i.j)var o=i(383291);if(0!=i.j)var r=i(823325);if(0!=i.j)var a=i(875160);if(0!=i.j)var l=i(609062);if(0!=i.j)var d=i(700509);if(0!=i.j)var c=i(451816);if(0!=i.j)var u=i(378071);function g(e,t,i,s,o){var r,a;const u=null!==(r=e.graphTransaction)&&void 0!==r?r:{addedNodes:[],unreconciledContent:null!==(a=e.cachedTiles)&&void 0!==a?a:[],removedNodes:[],updatedNodes:[]};let g=n.OD.Chars;u.unreconciledContent.some((e=>e.textUnit===d.fT.Paragraph))?g=n.OD.Paragraph:u.unreconciledContent.some((e=>e.textUnit===d.fT.Sentence))?g=n.OD.Sentence:e.hasWordChanges&&(g=n.OD.Word);const p=u.unreconciledContent.map((e=>{var n;return{position:e.header.elementId.offset,length:e.header.elementId.span,unit:(0,c.d)(e.textUnit),languageId:null!==(n=t.specifiedLocale)&&void 0!==n?n:i}}));return h(e.tileNodeId,t.eventSeqId,s,e.cachedTextInfo,e.newTextInfo,e.minDiffBounds,e.cachedWordCount,g,l.pf.TileNode,e.mutationChangeType,o,p)}function h(e,t,i,o,r,l,d,c,u,g,h,p,m){var f;let v,I,C=0;const S=null!==(f=null==o?void 0:o.content)&&void 0!==f?f:"",b=r.content,T=l.firstDiffLeft,E=S.length-l.firstDiffRight,N=b.length-l.firstDiffRight,w=function(e,t,i,s,o){if(e===t)return n.WI.Update;if(i===o)return n.WI.Add;if(s===o)return n.WI.Delete;return n.WI.Update}(S.length,b.length,E,N,T);let x;const L=()=>function(e,t,i,n){if(!n||void 0===t)return;if(void 0===e)return t;if(t.length<e.length||t.length-e.length>2)return t;let s;for(s=0;s<e.length;s++){const i=e[s],n=t[s];if(i.start!==n.start||i.length<n.length||!(0,a.G)(i.attribution,n.attribution))break}if(!t[s])return[];if(t[s].start!==i)return t;return t.slice(s)}(null==o?void 0:o.attributionRanges,r.attributionRanges,T,h);switch(w){case n.WI.Update:C=E-T,v=b.substring(T,N),x=L(),I=S.substring(T,E);break;case n.WI.Add:C=0,v=b.substring(T,N),x=L();break;case n.WI.Delete:C=E-T,I=S.substring(T,E),x=L()}return{message:{tileId:e,tileVersion:t,documentModel:i,delta:new s.s({deltaType:w,unit:c,position:T,length:C,content:v,wordCount:d,invalidationRanges:p,userInfo:{userType:y(g)},attributionRanges:x}),sourceType:u,changeType:g,deletedOrReplacedCharacters:I,tileText:b,wordBoundaries:m},attributionData:h?_(x,x===r.attributionRanges):void 0}}function p(e,t,i,n,s){var a,d,c;const u=null!==(a=e.graphTransaction)&&void 0!==a?a:{addedNodes:[],unreconciledContent:[],removedNodes:null!==(d=e.nodesToRetire)&&void 0!==d?d:[],updatedNodes:[]},g=null!==(c=e.mutationChangeType)&&void 0!==c?c:l.Q0.Code,h=u.removedNodes.map((e=>({messageType:r.G.RemoveData,data:{tileId:e,tileVersion:t.eventSeqId,documentModel:n,changeType:g,isTextNode:!0,tile:void 0}})));return h.push(...u.unreconciledContent.map((a=>{const{prev:l,next:d}=function(e,t){const i=e.getChildById(t);if(!i)return{prev:void 0,next:void 0};const n=e.findPreviousChildNode(i),s=e.findNextChildNode(i);return{prev:"#head#"===n?n:null==n?void 0:n.id,next:"#tail#"===s?s:null==s?void 0:s.id}}(t,a.header.elementId.id);return{messageType:s&&!u.addedNodes.includes(a.header.elementId.id)?r.G.ChangeData:r.G.NewData,data:{tileId:a.header.elementId.id,tileVersion:t.eventSeqId,documentModel:n,changeType:g,isTextNode:!0,tile:new o.Cg(Object.assign(Object.assign({},e.newTextInfo),{content:a.data,formattedRanges:[{start:0,length:a.data.length,languageId:i}]})),prevId:l,nextId:d}}}))),h}function m(e,t,i,o,r){return{tileId:e,tileVersion:t,documentModel:i,delta:(0,u.Dt)(r)?new s.s({deltaType:n.WI.FormattingUpdate,formattedRanges:r.formattedRanges,attributionRanges:r.attributionRanges}):Array.isArray(r)?new s.s({deltaType:n.WI.FormattingUpdate,formattedRanges:r}):new s.s({deltaType:n.WI.OtherNonContentUpdate,otherNonContentData:r}),sourceType:o}}function f(e,t){var i;return{tileId:e.id,tileVersion:e.eventSeqId,documentModel:e.documentModel,changeType:e.mutationChangeType,isTextNode:!0,tile:e.content?new o.Cg(Object.assign(Object.assign({},e.content),{formattedRanges:[...null!==(i=e.content.formattedRanges)&&void 0!==i?i:[],{start:0,length:e.content.content.length,languageId:t}]})):void 0,prevId:e.prevTileId,nextId:e.nextTileId}}function v(e,t,i,n,s,r,a,l,d){var c;return{oldTileId:e,newTileId:t,tileVersion:i,oldDocumentModel:l,newDocumentModel:d,tile:new o.Cg(Object.assign(Object.assign({},n),{formattedRanges:[...null!==(c=n.formattedRanges)&&void 0!==c?c:[],{start:0,length:n.content.length,languageId:s}]})),prevId:r,nextId:a}}function y(e){switch(e){case l.Q0.Local:return n.HS.SessionUser;case l.Q0.Remote:return n.HS.Collaborator;default:return n.HS.Programmatic}}function _(e,t){if(!e||0===e.length)return;const i={deltaType:n.WI.AttributionUpdate,attributionData:{ranges:e,isFullUpdate:t}},o=new s.s(i);return(0,l.Bb)(o)?o:i}},875160:(e,t,i)=>{function n(e,t){return e.dataSource===t.dataSource&&e.userId===t.userId&&e.timestamp===t.timestamp}i.d(t,{G:()=>n})},877310:(e,t,i)=>{if(i.d(t,{fO:()=>s}),0!=i.j)var n=i(67573);function s(e){return{changeOnce:(e&n.xv.ChangeOnce)===n.xv.ChangeOnce,changeAll:(e&n.xv.ChangeAll)===n.xv.ChangeAll,autoCorrect:(e&n.xv.AutoCorrect)===n.xv.AutoCorrect,readAloud:(e&n.xv.ReadAloud)===n.xv.ReadAloud,personalizedAutoCorrect:(e&n.xv.PersonalizedAutoCorrect)===n.xv.PersonalizedAutoCorrect}}},877646:(e,t,i)=>{i.d(t,{J:()=>n});const n={KeepOriginal:"KeepOriginal",AutoCorrectAppearance:"AutoCorrectAppearance",AutoCorrectHover:"AutoCorrectHover",SingleIssueOnLine:"SingleIssueOnLine",IssuesOnLine:"IssuesOnLine"}},877931:(e,t,i)=>{i.d(t,{g:()=>n});const n=(0,i(668952).f)("ILogger")},878183:(e,t,i)=>{i.d(t,{i:()=>xe});var n=i(379490),s=i(602764),o=i(208520),r=i(262255),a=i(419728),l=i(637224);class d{constructor(e,t,i){this.range=e,this.zIndex=i,this.originalStartContainerOfRange=e.startContainer,this.clientRect=t}isRangeInValidState(){return this.range.startContainer===this.originalStartContainerOfRange&&!this.range.collapsed}updateRange(e){e&&(this.range=e)}}class c{constructor(e,t,i,n,s,o,r,a){this.id=e,this.element=t,this.squiggleKind=i,this.critique=n,this.isVisible=s,this.stealth=o,this.data=r,this.squiggleRef=a,(0,l.Gn)(this)}updateFromRect(e,t){var i;this.isVisible!==e.visible&&(this.isVisible=e.visible),e.visible&&(this.data=new d(t,e,this.data.zIndex));const n=null!==(i=this.critique.isStealth)&&void 0!==i&&i;n!==this.stealth&&(this.stealth=n)}}(0,n.__decorate)([a.observable],c.prototype,"isVisible",void 0),(0,n.__decorate)([a.observable],c.prototype,"stealth",void 0),(0,n.__decorate)([a.observable],c.prototype,"data",void 0),(0,n.__decorate)([a.action],c.prototype,"updateFromRect",null);var u=i(630501),g=i(331408),h=i(829088),p=i(966727),m=i(716588),f=i(681156);class v{constructor(e,t,i,n){this.highlightRegistry=e,this.targetWindow=t,this.autoCorrectionEnabled=i,this.autoCorrectionCache=n,this.highlightsCache=new Map,this.autoCorrectionHighlightsToUpdate=new Map,this.autoCorrectionTimeout=void 0,this.updateAutoCorrectionSquiggles=e=>{if(!this.autoCorrectionEnabled||0===this.autoCorrectionHighlightsToUpdate.size)return;const t=new Set,i=new Map,n=p.Bn.AutoCorrectSquiggle;for(const[s,o]of this.autoCorrectionHighlightsToUpdate){const r=this.autoCorrectionCache.getSquiggleInitializationProgress(s)+.1;if(this.autoCorrectionCache.setInitializationProgress(s,r),r>=1){t.add(s);continue}const a=10*Math.ceil(10*(1-r));for(const t of o)this.addHighlight(n,e,!1,i,t.data.range,a)}for(const e of t)this.autoCorrectionHighlightsToUpdate.delete(e);this.clearAutoCorrectionSquiggles(e);for(const[e,t]of i)this.highlightRegistry.set(e,t);this.startAutoCorrectionTimeoutIfNeeded(e)},this.startAutoCorrectionTimeoutIfNeeded=e=>{var t;this.autoCorrectionEnabled&&!this.autoCorrectionTimeout&&0!==this.autoCorrectionHighlightsToUpdate.size&&(this.autoCorrectionTimeout=null===(t=this.targetWindow.deref())||void 0===t?void 0:t.setTimeout((()=>{this.autoCorrectionTimeout=void 0,this.updateAutoCorrectionSquiggles(e)}),500))}}dispose(){var e;this.autoCorrectionTimeout&&(null===(e=this.targetWindow.deref())||void 0===e||e.clearTimeout(this.autoCorrectionTimeout),this.autoCorrectionTimeout=void 0)}updateHighlight(e,t,i){for(const t in p.Bn){const i=p.Bn[t];this.highlightRegistry.delete((0,m.Mf)(i,e,!0))}if(0===t.length)this.highlightsCache.delete(i);else{const n=(0,f.H)(t[0].critique,this.autoCorrectionEnabled,t[0].squiggleKind),s=t.map((e=>e.data.range));this.highlightsCache.set(i,{squigglerId:e,patternName:n,ranges:s})}const n=new Map;for(const e of this.highlightsCache.values())for(const t of e.ranges)this.addHighlight(e.patternName,e.squigglerId,!0,n,t);for(const[e,t]of n)this.highlightRegistry.set(e,t)}update(e,t,i){this.autoCorrectionHighlightsToUpdate.clear();const n=new Map;for(const s of t.values())for(const t of s.values()){if(0===t.length||!t[0].critique.traceId)continue;const s=(0,f.H)(t[0].critique,this.autoCorrectionEnabled,t[0].squiggleKind),o=this.processAutoCorrection(s,t[0].critique.traceId,t);this.highlightsCache.clear();for(const r of t)this.addHighlight(s,e,!1,n,r.data.range,o),r.critique.traceId&&i.has(r.critique.traceId)&&(this.addHighlight(s,e,!0,n,r.data.range),this.highlightsCache.set(i.get(r.critique.traceId),{squigglerId:e,patternName:s,ranges:[r.data.range]}))}this.clear(e);for(const[e,t]of n)this.highlightRegistry.set(e,t);this.startAutoCorrectionTimeoutIfNeeded(e)}clear(e){for(const t in p.Bn){const i=p.Bn[t];this.highlightRegistry.delete((0,m.Mf)(i,e,!0)),i===p.Bn.AutoCorrectSquiggle?this.clearAutoCorrectionSquiggles(e):this.highlightRegistry.delete((0,m.Mf)(i,e,!1))}}clearAutoCorrectionSquiggles(e){if(this.autoCorrectionEnabled)for(let t=10;t<=100;t+=10)this.highlightRegistry.delete((0,m.Mf)(p.Bn.AutoCorrectSquiggle,e,!1,t))}processAutoCorrection(e,t,i){if(!this.autoCorrectionEnabled)return;let n;if(e===p.Bn.AutoCorrectSquiggle){const e=this.autoCorrectionCache.getSquiggleInitializationProgress(t);n=10*Math.ceil(10*(1-e)),this.autoCorrectionHighlightsToUpdate.set(t,i)}return n}addHighlight(e,t,i,n,s,o){const r=(0,m.Mf)(e,t,i,o),a=this.addHighlightRange(r,e,n,s);return n.set(r,a),r}addHighlightRange(e,t,i,n){let s=i.get(e);return s?(s.add(n),s):(s=new Highlight(n),s.type=(0,m.pE)(t),s)}}var y;function _(e,t,i,n){return e&&i>=e.top&&i<=e.bottom?t>=e.left&&t<=e.right?y.direct:n&&t>=e.right-n&&t<=e.left?y.indirect:y.line:y.none}function I(e,t){if("Caret"!==t.type||!t.focusNode)return y.none;if(e.isPointInRange(t.focusNode,t.focusOffset))return y.direct;const i=e.getBoundingClientRect(),n=t.getRangeAt(0).getBoundingClientRect();return i.top<=n.top&&i.bottom>=n.bottom?y.line:y.none}function C(e,t){return!("Caret"!==t.type||!t.focusNode)&&e.isPointInRange(t.focusNode,t.focusOffset)}!function(e){e.none="none",e.direct="direct",e.line="line",e.indirect="indirect"}(y||(y={}));var S=i(895463),b=i(433858),T=i(786132),E=i(140969),N=i(90393),w=i(411180),x=i(660458),L=i(461300),D=i(370137),A=i(323283),F=i(213983),q=i(838145);class R{createEventManager(e,t,i){return new O(e,t,i)}}const P={passive:!1};class O{constructor(e,t,i){var n;this.targetWindowRef=e,this.state=t,this.safeWindow=i,this.isMouseWithinElement=!1,this.disconnectAdditionalHandlers=()=>null,this.connectedEventListeners=[],this.connectSquiggler=()=>{for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[];const e=this.targetWindowRef.deref();if(!e)return;const t=new A.J(e),i=new A.J(e.document);if(this.connectedEventListeners.push(t),this.connectedEventListeners.push(i),t.addListener("resize",this.reRenderDeferred,P),i.addListener("mouseup",this.onDocumentMouseUp,P),i.addListener("pointerup",this.onDocumentMouseUp,P),i.addListener("selectionchange",this.checkHighlight,P),this.state.anchorElement&&this.state.hostElement){const e=new A.J(this.state.anchorElement);if(this.connectedEventListeners.push(e),e.addListener("mouseenter",this.onMouseEnter,P),e.addListener("mouseleave",this.onMouseLeave,P),this.resizeObserver){this.resizeObserver.observe(this.state.anchorElement);for(const e of this.state.hostElement.shouldObserveSize(this.state.anchorElement))e&&this.resizeObserver.observe(e)}const t=(0,q.a)(this.state.anchorElement),i=new A.J(t);this.connectedEventListeners.push(i),i.addListener("input",this.onInputHandler,P),i.addListener("keyup",this.throttleKeyUp,P),this.isScrollable&&(i.addListener("scroll",this.throttleScroll,P),i.addListener("mousewheel",this.throttleScroll,P),i.addListener("touchmove",this.throttleScroll,P)),i.addListener("focusin",this.checkHighlight,P),i.addListener("focusout",this.throttleFocusOut,P),this.disconnectAdditionalHandlers=this.state.hostElement.addHandlers(this.state.anchorElement,this,this.state.proofedElements.map((e=>e.id)))}},this.disconnectSquiggler=()=>{var e;for(const e of this.connectedEventListeners)e.removeAllListeners();this.connectedEventListeners=[],this.lastMouseMoveEvent=void 0,null===(e=this.resizeObserver)||void 0===e||e.disconnect(),this.resizeObserver=void 0,this.disconnectAdditionalHandlers(),this.disconnectAdditionalHandlers=()=>{}},this.dispose=()=>{this.disconnectSquiggler(),this.throttledCheckCursorHighlight=void 0,this.throttledCheckCaretHighlight=void 0},this.reRender=()=>{this.state.updateRanges()},this.updatePositionIfRelative=()=>{this.safeWindow.requestAnimationFrame((()=>this.reRenderIfPositionRelative()),this.targetWindowRef)},this.reRenderIfPositionRelative=()=>{this.requiresUpdateForRelativePosition()&&this.reRender()},this.checkHighlight=()=>{var e,t,i;const n=this.targetWindowRef.deref();n&&this.state.anchorElement&&(n.document.activeElement===this.state.anchorElement||this.state.anchorElement.contains(n.document.activeElement)||(null===(e=n.document.activeElement)||void 0===e?void 0:e.contains(this.state.anchorElement)))&&(this.onMouseEnter(),null===(t=this.throttledCheckCaretHighlight)||void 0===t||t.call(this),null===(i=this.throttledCheckCursorHighlight)||void 0===i||i.call(this))},this.onMouseEnter=()=>{var e;this.isMouseWithinElement=!0,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.anchorElement&&(this.mouseWithinElementEventListener=new A.J(this.state.anchorElement),this.connectedEventListeners.push(this.mouseWithinElementEventListener),this.mouseWithinElementEventListener.addListener("mousemove",this.onMouseMove,P))},this.onMouseLeave=()=>{var e;this.isMouseWithinElement=!1,null===(e=this.mouseWithinElementEventListener)||void 0===e||e.removeAllListeners(),this.mouseWithinElementEventListener=void 0,this.state.setLastMousePosition(void 0),this.state.trivializeAllSquiggles("cursor")},this.onFocusOut=()=>{this.state.trivializeAllSquiggles("caret"),this.state.closeTooltip()},this.onInputHandler=()=>{this.onInput()},this.onInput=()=>{(this.getShouldReactToInput()||this.state.isAutoCorrectionOnly||this.requiresUpdateForRelativePosition())&&this.reRender()},this.onKeyup=e=>{["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(e.key)?this.checkCaretPosition():("Delete"===e.key||"Backspace"===e.key||this.isTabPressed(e)||this.state.isAutoCorrectionOnly)&&this.onInput()},this.isTabPressed=e=>"Tab"===e.key&&!e.ctrlKey&&!e.altKey&&!e.metaKey,this.checkCaretPosition=()=>{var e;const t=((null===(e=this.state.anchorElement)||void 0===e?void 0:e.ownerDocument)||document).getSelection();t&&t.rangeCount>0&&this.state.updateSelectionHighlightState(t)},this.onMouseMove=e=>{var t;this.state.anchorElement&&this.isMouseWithinElement?(this.lastMouseMoveEvent=e,null===(t=this.throttledCheckCursorHighlight)||void 0===t||t.call(this)):this.lastMouseMoveEvent=void 0},this.checkCursorHighlight=()=>{if(this.lastMouseMoveEvent&&this.state.anchorElement){const e={x:this.lastMouseMoveEvent.clientX,y:this.lastMouseMoveEvent.clientY};this.state.setLastMousePosition(e)}this.state.updateCursorHighlightState(),this.lastMouseMoveEvent=void 0},this.onDocumentMouseUp=e=>{this.onMouseClick(e),this.reRenderDeferred()},this.onMouseClick=e=>{const{anchorElement:t,updateCursorHighlightState:i,setLastMousePosition:n}=this.state;if(!t)return;n({x:e.clientX,y:e.clientY}),this.checkCaretPosition(),i()},this.throttleScroll=()=>{this.reRenderDeferred()},this.reRenderDeferred=()=>{this.safeWindow.requestAnimationFrame((()=>this.reRender()),this.targetWindowRef)},this.throttleKeyUp=e=>{this.safeWindow.requestAnimationFrame((()=>this.onKeyup(e)),this.targetWindowRef)},this.throttleFocusOut=()=>{this.safeWindow.requestAnimationFrame((()=>this.onFocusOut()),this.targetWindowRef)},this.throttleUpdateOnResize=()=>{this.safeWindow.requestAnimationFrame((()=>{this.state.updatePosition(this.state.isRelativePositionEnabled),this.reRender()}),this.targetWindowRef)},this.requiresUpdateForRelativePosition=()=>{const{isRelativePositionEnabled:e}=this.state;return e&&this.state.updatePosition(e)},this.determineIfScrollable=e=>{switch(e){case"scroll":return!0;case"hidden":case"visible":return!1;default:return null}};const s=e.deref();if(s&&(this.throttledCheckCursorHighlight=(0,F.hQ)(this.safeWindow,s,this.checkCursorHighlight,"After"),this.throttledCheckCaretHighlight=(0,F.hQ)(this.safeWindow,s,this.checkCaretPosition,"After"),this.state.anchorElement)){if(this.isScrollable=null===(n=this.state.hostElement)||void 0===n?void 0:n.isScrollable(this.state.anchorElement),void 0===this.isScrollable){const e=this.getAnchorElementComputedStyle();this.isScrollable=e&&!(!1===this.determineIfScrollable(e.overflowX)&&!1===this.determineIfScrollable(e.overflowY))}s.ResizeObserver&&(this.resizeObserver=new s.ResizeObserver((()=>this.throttleUpdateOnResize())))}}getAnchorElementComputedStyle(){var e;return this.anchorElementComputedStyle||(this.anchorElementComputedStyle=this.state.anchorElement&&(null===(e=this.targetWindowRef.deref())||void 0===e?void 0:e.getComputedStyle(this.state.anchorElement))),this.anchorElementComputedStyle}getShouldReactToInput(){if(void 0!==this.reactToOnInput)return this.reactToOnInput;const e=this.getAnchorElementComputedStyle();return this.reactToOnInput=["center","right"].includes((null==e?void 0:e.textAlign)||"")||"rtl"===(null==e?void 0:e.direction),this.reactToOnInput}}function k(e){if(!e)return 0;const t=parseFloat(e);return isNaN(t)?0:t}function M(e){if(!e||"auto"===e)return 0;const t=parseInt(e,10);return isNaN(t)?0:t+1}var z=i(556940),j=i(186438),W=i(1144),B=i(800737);var U=i(955146);const H=()=>!0,V=(e,t,i,n,s=!0)=>{var o,r,a,l,d,c,u,g,h,p,m,f;const v=i.find((t=>t.match(e))),y=null!==(o=null==v?void 0:v.shouldRender)&&void 0!==o?o:H,_=null!==(r=null==v?void 0:v.shouldRenderSquiggle)&&void 0!==r?r:H,I=null!==(a=null==v?void 0:v.shouldObserveSize)&&void 0!==a?a:()=>[],C=null!==(l=null==v?void 0:v.addHandlers)&&void 0!==l?l:()=>()=>null,S=null!==(d=null==v?void 0:v.squigglerInlineStyles)&&void 0!==d?d:()=>{},b=null!==(c=null==v?void 0:v.transformSquiggleRects)&&void 0!==c?c:e=>e,T=null!==(u=null==v?void 0:v.getForbiddenRects)&&void 0!==u?u:()=>[],E=null!==(g=null==v?void 0:v.isScrollable)&&void 0!==g?g:()=>{},N=null!==(h=null==v?void 0:v.squigglerUpdated)&&void 0!==h?h:()=>{},w=e.tagName.toLowerCase(),x="editor-shadow-element"===w?window.document.body:e.parentElement,L=null!==(p=null==v?void 0:v.getSquigglerTopOffset)&&void 0!==p?p:e=>e.getBoundingClientRect().height,D={element:null!==(m=e.parentElement)&&void 0!==m?m:window.document.body,zIndex:null!==(f=null==v?void 0:v.zIndex)&&void 0!==f?f:"auto",shouldRender:y,shouldRenderSquiggle:_,shouldObserveSize:I,addHandlers:C,squigglerInlineStyles:S,transformSquiggleRects:b,getForbiddenRects:T,isScrollable:E,squigglerUpdated:N,getTopOffset:L,disableCalloutOnDoubleClick:null==v?void 0:v.disableCalloutOnDoubleClick};if("body"===w||!x)return D;if(null==v?void 0:v.selector){const t="string"==typeof v.selector?e.closest(v.selector):v.selector(e,null==n?void 0:n.element);if(t)return D.element=t,D}return D.element=s?((e,t)=>{if(!e.parentElement||e===document.body)return document.body;if("absolute"!==t)return e.parentElement;let i=e.parentElement,n=window.getComputedStyle(i);for(;i&&"relative"!==n.position&&i!==document.body;)i=i.parentElement,n=window.getComputedStyle(i);return i})(e,t()):x,D};var G=i(669332);function Q(e,t,i,n=1){const s=i,o=t(function(e){if(e.startContainer===e.endContainer)return Array.from(e.getClientRects());const t=e.startContainer.ownerDocument||document,i=t.createNodeIterator(e.commonAncestorContainer,NodeFilter.SHOW_ALL),n=[];for(;i.nextNode()&&(0===n.length&&i.referenceNode!==e.startContainer||(n.push(i.referenceNode),i.referenceNode!==e.endContainer)););const s=[],o=t.createRange();for(const t of n)t.nodeType===t.TEXT_NODE&&(o.selectNode(t),t===e.startContainer?o.setStart(t,e.startOffset):t===e.endContainer&&o.setEnd(t,e.endOffset),s.push(...Array.from(o.getClientRects())));let r=!0;for(const e of s)if(e.top!==s[0].top||e.height!==s[0].height){r=!1;break}if(r&&s.length>0){return[s.reduce(((e,t)=>new DOMRect(Math.min(e.left,t.left),e.top,Math.max(e.right,t.right)-Math.min(e.left,t.left),e.height)))]}return s}(e),e),r=[];if(o)for(const e of o){const t=(s.right-s.left)/n,i=e.left-s.left,o=Math.min(e.right-s.left,t),a={top:e.top-s.top,left:i,bottom:e.bottom-s.top,right:o,width:o-i,height:e.height,visible:!K(e,s)};r.push(a)}return r}function K(e,t){return e.bottom>t.bottom+e.height/4||e.left>t.right||e.right<t.left||e.bottom<t.top}class $ extends u.z{get isAutoCorrectionOnly(){let e=!1;for(const t of this.squigglesMap.values())for(const i of t.values())for(const t of i.values()){if(!(0,G.k)(t.squiggleKind)||!this.autoCorrectionCache)return!1;e=!0}return e}get squiggles(){const e=[];return this.forEachCritique((t=>{const i=t.squiggles.filter((e=>{var t;return e.isVisible&&this.anchorElement&&(null===(t=this.hostElement)||void 0===t?void 0:t.shouldRenderSquiggle(e.data.range.startContainer,this.anchorElement))}));e.push(...i)})),e}get isRelativePositionEnabled(){return this.isRelativePositionEnabledValue?this.isRelativePositionEnabledValue:this.calculateRelativePosition()}calculateRelativePosition(){if(this.parentToRenderTo){return"static"===(""!==this.parentToRenderTo.style.position?this.parentToRenderTo.style.position:getComputedStyle(this.parentToRenderTo).position)}return!1}get isEmpty(){return 0===this.proofedElements.length}get theme(){return this._squiggleThemeStore}get squiggleStyleType(){var e;return null===(e=this.options)||void 0===e?void 0:e.squiggleStyleType}get reactOnComponentUpdate(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.reactOnComponentUpdate)&&void 0!==t&&t}get disableAutoBrowserVirtualizationOfSquiggles(){var e,t,i;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.disableAutoBrowserVirtualizationOfSquiggles)&&void 0!==t&&t||null!==(i=this.hostSettings.enableCSSHighlightApiSquiggleRendering)&&void 0!==i&&i}get ariaEnabled(){return this.isAriaFeatureEnabled(S.j.none)}get ariaLineNavUpdatesEnabled(){return this.isAriaFeatureEnabled(S.j.lineNavigation)}get forcedHighContrast(){var e,t;return null!==(t=null===(e=this.getIsHighContrastTheme)||void 0===e?void 0:e.call(this))&&void 0!==t&&t}get autoCorrectionEnabled(){var e;return!!(null===(e=this.options)||void 0===e?void 0:e.autoCorrectionEnabled)&&!!this.autoCorrectionCache}get squigglerIdForCssHighlights(){var e;return this.id+(null===(e=this.anchorElement)||void 0===e?void 0:e.id)}get squiggleVerticalAdjustment(){var e,t;return null!==(t=null===(e=this.options)||void 0===e?void 0:e.squiggleVerticalAdjustment)&&void 0!==t?t:0}constructor(e,t,i,n,s,u,p,m,f,A,F,q){var P,O,k,H,K,$,J,Z;super(),this.tileContent=t,this.hostSettings=i,this.proofingDom=n,this._squiggleThemeStore=s,this.critiqueApplicationHandler=u,this.critiqueRangeBuilder=p,this.autoCorrectionBroker=m,this.getIsHighContrastTheme=f,this.logger=A,this.upsellStore=F,this.editorSettingsState=q,this.diffPrecision=.01,this.isTooltipShown=!1,this.squigglesMap=new a.ObservableMap,this.autoCorrectDisabledLanguages=[],this.proofedElements=[],this.proofedElementDomRects=[],this.calloutOpenedForCritique=void 0,this.mouseHoveredElement=void 0,this.mouseIndirectlyHoveredElement=void 0,this.disabledCritiqueIdToShowTooltip=void 0,this.caretHoveredElement=void 0,this.scaleTransformValue=1,this.top=0,this.left=0,this.hadUpdateWithoutAnyValidSquiggles=!1,this.recalculateRelativePosition=()=>{this.isRelativePositionEnabledValue=this.calculateRelativePosition()},this.isVisible=!1,this.onCalloutPositionUpdated=(e,t)=>{this.isUndoCalloutAlignedRight=e,this.undoCalloutRect=t},this.setAutoCorrectLanguages=e=>{this.autoCorrectDisabledLanguages=e},this.setCritiques=async(e,t=!1)=>{var i;const n=this.proofedElements.find((t=>t.id===e.id));let s=!0;if(n){if(t){const t=e.critiques.length!==n.critiques.length||!e.critiques.every(((e,t)=>(0,b.gS)(e,n.critiques[t]))),o=(null===(i=this.squigglesMap.get(e.id))||void 0===i?void 0:i.size)!==e.critiques.length;s=t||o||this.hadUpdateWithoutAnyValidSquiggles,this.hadUpdateWithoutAnyValidSquiggles=!1}n.critiques=e.critiques}else this.proofedElements.push(e);s&&await this.updateRanges([e.id])},this.removeCritiques=async e=>{const t=this.proofedElements.findIndex((t=>t.id===e));-1!==t&&(this.squigglesMap.delete(e),this.proofedElements.splice(t,1),await this.updateRanges())},this.updateRanges=async e=>{var t;this.throttledUpdateRanges?(this.throttledUpdateRangesProofedElementsToCheck=e?[...null!==(t=this.throttledUpdateRangesProofedElementsToCheck)&&void 0!==t?t:[],...e]:void 0,await this.throttledUpdateRanges()):await this.updateRangesImmediately(e)},this.updateSquiggles=()=>{this.throttledUpdateSquiggles?this.throttledUpdateSquiggles():this.innerUpdateSquiggles()},this.setVisible=e=>{this.isVisible=e,e&&(this.cancelSetVisibleFrame(),this.setVisibleFrameRequestId=this.safeWindow.requestAnimationFrame((async()=>{await this.updateRanges()}),this.targetWindowRef))},this.setLastMousePosition=e=>{this.lastMousePosition=e},this.disconnectVisibilityTracker=()=>{var e;null===(e=this._visibilityTracker)||void 0===e||e.disconnect()},this.getCritiques=()=>this.proofedElements.reduce(((e,t)=>e.concat(t.critiques)),[]),this.showCallout=(e,t)=>{var i,n;const s=null===(i=this.targetWindowRef)||void 0===i?void 0:i.deref();if(!e.traceId||!s)return;const o=this.findSquiggle(e.traceId);if(o){const i=null!==(n=o.data.range.startContainer.parentElement)&&void 0!==n?n:o.element;this.cancelShowCalloutFrame(),this.showCalloutFrameRequestId=this.safeWindow.requestAnimationFrame((()=>{i.scrollIntoView({behavior:"auto"}),this.clearOnCalloutShownCallbackTimeout(),this.onCalloutShownCallbackTimeout=s.setTimeout((()=>{var i,n;this.hasSquigglerRefOrIsCSSHighlightSquiggle(o)&&(this.onShowCallout(null!==(n=null===(i=o.squiggleRef)||void 0===i?void 0:i.current)&&void 0!==n?n:null,e,o.data.range.toString(),!0,(()=>{}),o.element,"critique",o.data.range),null==t||t())}),100)}),s)}},this.updateSelectionHighlightState=e=>{let t,i=0;this.forEachCritique((n=>{var s,o,r;for(const a of n.squiggles){if(!a.isVisible)continue;let l=y.none;this.ariaLineNavUpdatesEnabled?l=I(a.data.range,e):C(a.data.range,e)&&(l=y.direct),l===y.direct?(this.caretHoveredCritiqueId=a.critique.traceId,(1===n.squiggles.length||this.checkSquiggleSelection(a,e))&&(this.caretHoveredElement=a.id,this.hasSquigglerRefOrIsCSSHighlightSquiggle(a)&&this.showTooltipAt(a.squiggleKind,null===(s=a.squiggleRef)||void 0===s?void 0:s.current,a.critique,"keyboard")),t=a,this.caretPosition={node:e.focusNode,offset:e.focusOffset},null===(o=this.cssHighlightRegistry)||void 0===o||o.updateHighlight(this.squigglerIdForCssHighlights,n.squiggles,"caret")):(this.caretHoveredElement===a.id&&(this.caretPosition=void 0,null===(r=this.critiqueCalloutHandler)||void 0===r||r.hideCallout()),l===y.line&&(i+=1),this.trivializeSquiggle(a,"caret"))}})),this.updateAriaStatus(i,t)},this.updateSelectionHighlightStateFromCoordinates=e=>{let t,i=0;this.forEachCritique((n=>{var s,o,r;for(const a of n.squiggles){if(!a.isVisible)continue;const l=_(a.data.clientRect,e.x,e.y);l===y.direct?(this.caretHoveredCritiqueId=a.critique.traceId,this.caretHoveredElement=a.id,this.hasSquigglerRefOrIsCSSHighlightSquiggle(a)&&this.showTooltipAt(a.squiggleKind,null===(s=a.squiggleRef)||void 0===s?void 0:s.current,a.critique,"keyboard",e),t=a,null===(o=this.cssHighlightRegistry)||void 0===o||o.updateHighlight(this.squigglerIdForCssHighlights,n.squiggles,"caret")):(l===y.line&&(i+=1),this.caretHoveredElement===a.id&&(this.caretPosition=void 0,null===(r=this.critiqueCalloutHandler)||void 0===r||r.hideCallout()),this.trivializeSquiggle(a,"caret"))}})),this.updateAriaStatus(i,t)},this.startUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=t.setTimeout((()=>{this.lastMousePosition?this.setMouseIndirectlyHoveredElement(void 0):this.clearUndoCardTimeout()}),2e3))},this.clearUndoCardTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.indirectTimer),this.indirectTimer=void 0)},this.isMouseWithinUndoCallout=()=>{if(!this.undoCalloutRect||!this.lastMousePosition||!this.anchorElement)return!1;const e=(e,t,i)=>e>=t&&e<=t+i;return e(this.lastMousePosition.x,this.undoCalloutRect.x,this.undoCalloutRect.width)&&e(this.lastMousePosition.y,this.undoCalloutRect.y,this.undoCalloutRect.height)},this.calculateSquiggleClientRectInGlobalCoordinates=e=>{if(!this.anchorElement)return;const t=e.data.clientRect,i=this.anchorElement.getBoundingClientRect();return{left:t.left+i.left,top:t.top+i.top,right:t.right+i.left,bottom:t.bottom+i.top,width:t.width,height:t.height}},this.getCritiqueAtPosition=e=>{if(this.anchorElement)for(const t of this.squigglesMap){const i=t[1];for(const t of i){const i=t[1];for(const t of i){if(!t.isVisible)continue;const i=this.calculateSquiggleClientRectInGlobalCoordinates(t);if(!i)continue;if(_(i,e.x,e.y)===y.direct)return t.critique}}}},this.getCritiqueAtSelection=e=>{if(!this.anchorElement||e.rangeCount<1)return;const t=e.getRangeAt(0);for(const e of this.squigglesMap){const i=e[1];for(const e of i){const i=e[1];for(const e of i){if(!e.isVisible)continue;const i=this.calculateSquiggleClientRectInGlobalCoordinates(e);if(!i)continue;const n=t.getBoundingClientRect();if(n.top>=i.top&&n.left>=i.left&&n.bottom<=i.bottom&&n.right<=i.right)return e.critique}}}},this.updateCursorHighlightState=()=>{var e;if(this.lastMousePosition&&this.anchorElement)if(null===(e=this.options)||void 0===e?void 0:e.enableCursorIntersectionObserver){const e=new IntersectionObserver((t=>{(0,a.runInAction)((()=>{this.updateCursorHighlightStateWithAnchorBoundingBox(t[0].boundingClientRect),e.disconnect()}))}));e.observe(this.anchorElement)}else{const e=this.anchorElement.getBoundingClientRect();this.updateCursorHighlightStateWithAnchorBoundingBox(e)}},this.updateCursorHighlightStateWithAnchorBoundingBox=e=>{if(!this.lastMousePosition)return;const{x:t,y:i}=this.lastMousePosition;let n,s=0;this.forEachCritique((o=>{var r,a,l,d,c;for(const u of o.squiggles){if(!u.isVisible||!this.anchorElement)continue;const g=this.mouseIndirectlyHoveredElement===u.id?null===(r=this.undoCalloutRect)||void 0===r?void 0:r.width:void 0;let h=_({left:u.data.clientRect.left+e.left,top:u.data.clientRect.top+e.top,right:u.data.clientRect.right+e.left,bottom:u.data.clientRect.bottom+e.top,width:u.data.clientRect.width,height:u.data.clientRect.height},t,i,g);const p=(0,G.k)(u.squiggleKind);if(this.ariaLineNavUpdatesEnabled||h!==y.line||(h=y.none),p)if(this.mouseIndirectlyHoveredElement===u.id)if(h===y.indirect){if(void 0!==this.indirectTimer)continue;this.startUndoCardTimeout()}else this.setMouseIndirectlyHoveredElement(void 0),this.clearUndoCardTimeout();else(null===(a=this.options)||void 0===a?void 0:a.disableOpenAutoCorrectCalloutOnHover)||this.calloutOpenedForCritique!==u.critique.traceId||h!==y.none||this.isMouseWithinUndoCallout()||(null===(l=this.critiqueCalloutHandler)||void 0===l||l.hideCallout(),this.undoCalloutRect=void 0);if(h===y.direct)return n=u,null===(d=this.cssHighlightRegistry)||void 0===d||d.updateHighlight(this.squigglerIdForCssHighlights,o.squiggles,"cursor"),this.mouseHoveredCritiqueId=u.critique.traceId,this.mouseHoveredElement=u.id,this.isUndoCalloutAlignedRight&&this.setMouseIndirectlyHoveredElement(u.id),void("critique"===u.squiggleKind&&this.hasSquigglerRefOrIsCSSHighlightSquiggle(u)&&this.showTooltipAt(u.squiggleKind,null===(c=u.squiggleRef)||void 0===c?void 0:c.current,u.critique,"mouse"));h===y.line&&(s+=1),this.trivializeSquiggle(u,"cursor")}})),this.updateAriaStatus(s,n),n||this.trivializeCursorSquiggle()},this.trivializeAllSquiggles=e=>{"caret"===e?this.trivializeCaretSquiggle():this.trivializeCursorSquiggle()},this.trivializeSquiggle=(e,t,i=!1)=>{var n,s;"caret"===t?this.caretHoveredCritiqueId===e.critique.traceId&&(this.trivializeCaretSquiggle(),null===(n=this.cssHighlightRegistry)||void 0===n||n.updateHighlight(this.squigglerIdForCssHighlights,[],"caret")):this.mouseHoveredCritiqueId!==e.critique.traceId||i&&(0,G.k)(e.squiggleKind)||(this.trivializeCursorSquiggle(),this.trivializeDisabledCritiqueIdToShowTooltip(),null===(s=this.cssHighlightRegistry)||void 0===s||s.updateHighlight(this.squigglerIdForCssHighlights,[],"cursor"))},this.trivializeDisabledCritiqueIdToShowTooltip=()=>{this.disabledCritiqueIdToShowTooltip=void 0},this.trivializeCursorSquiggle=()=>{this.mouseHoveredCritiqueId=void 0,this.mouseHoveredElement=void 0},this.trivializeCaretSquiggle=()=>{this.caretHoveredCritiqueId=void 0,this.caretHoveredElement=void 0},this.flagShowFeedback=(e,t)=>{var i,n;this.proofedElements.find((t=>t.element===e))&&((null==t?void 0:t.typeId)===g.L9.CIQFlag_Topic?this.publishEvent("showFeedback",{flag:t}):this.publishEvent("feedbackIconClicked",{suggestionText:null!==(i=null==t?void 0:t.textInContext)&&void 0!==i?i:"",mode:null!==(n=null==t?void 0:t.typeId)&&void 0!==n?n:""}))},this.scaleTransform=e=>{this.scaleTransformValue=e,this.innerUpdateSquiggles()},this.updateAriaStatus=(e,t)=>{t&&this.isAriaFeatureEnabled(S.j.highlight)?this.isAriaFeatureEnabled(S.j.highlight)?this.publishEvent("ariaStatusUpdated",{eventKind:"status",statusText:this.getAriaStatusString(t),severity:"assertive",preserve:!1,id:t.critique.traceId,messageKind:"critique"===t.squiggleKind?"KeepOriginal":"AutoCorrectHover",squiggleKind:t.squiggleKind}):this.publishEvent("ariaStatusUpdated",{eventKind:"status",statusText:"",severity:"assertive",preserve:!1,id:void 0}):this.ariaLineNavUpdatesEnabled&&this.publishEvent("ariaStatusUpdated",{eventKind:"lineNav",issuesCount:e,severity:"polite",preserve:!1})},this.updateRangesImmediately=async e=>{var t,i,n,s,o,r;if(!this.isVisible)return;const l=new Set(this.squigglesMap.keys());let d=!1;const c=new Map;for(const u of this.proofedElements){if(e&&!e.includes(u.id)){l.delete(u.id);continue}const g=[],h=this.squigglesMap.has(u.id),p=null!==(t=this.squigglesMap.get(u.id))&&void 0!==t?t:new a.ObservableMap,m=new Set(p.keys());for(const e of u.critiques)e.traceId&&m.delete(e.traceId),g.push(e);const f=await this.critiqueRangeBuilder.getCritiqueRanges(g,u.element);let v=[];if(g.length>0){const e=this.determineValidSquiggles(f);v=e.validRanges;for(const t of e.critiquesInInvalidRanges)m.add(t)}if(m.size>0&&this.removeCritiquesFromCache(m,p),v.length>0){this.hadUpdateWithoutAnyValidSquiggles=!1;const e=await this.buildSquigglesForCritiques(u.element,v,p),t=[];if(this.autoCorrectionBroker){for(let a=e.length-1;a>=0;a-=1){const l=e[a];if(!(null===(i=this.autoCorrectionCache)||void 0===i?void 0:i.process(l.critique.traceId)))continue;const d=null!==(n=l.critique.nodeId)&&void 0!==n?n:null===(s=l.critique.tileId)||void 0===s?void 0:s.nodeId,c=d?this.proofingDom.findNode(d):null;if(!c){null===(o=this.logger)||void 0===o||o.error(508146701,"Unable to find node while applying autocorrection");continue}this.autoCorrectionBroker.setIsApplyingAutoCorrection(l.critique);const g=await this.tileContent.autoCorrect(c,u.element,l.critique.start,l.critique.length,l.suggestion.text,l.range,null===(r=this.options)||void 0===r?void 0:r.autoCorrectionInputCacheEnabled);if(g){t.push({replacedText:g,critique:l.critique});const e=(0,j.dP)(l.suggestion);this.publishEvent("autoCorrectionTriggered",{critique:l.critique,isPersonalized:e})}else this.autoCorrectionBroker.convertToNormalSquiggle(l.critique)}let a=0;for(let e=t.length-1;e>=0;e-=1)a+=this.autoCorrectionBroker.setIsFinishedApplyingAutoCorrection(t[e].critique,a),d=!0}}else this.hadUpdateWithoutAnyValidSquiggles=g.length>0;h||c.set(u.id,p),l.delete(u.id)}l.size>0&&this.removeMissingElements(l),this.updatePosition(this.isRelativePositionEnabled),c.size>0&&this.squigglesMap.merge(c),this.updateCssHighlightsRegistry(),d&&await this.updateRangesImmediately(e)},this.updateCssHighlightsRegistry=()=>{var e;null===(e=this.cssHighlightRegistry)||void 0===e||e.update(this.squigglerIdForCssHighlights,this.squigglesMap,this.getHighlightedCritiqueIds())},this.getValidCritiques=async e=>{const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.critiques,e.element);return this.determineValidSquiggles(t).validRanges.map((e=>e.critique))},this.removeCritiquesFromCache=(e,t)=>{var i;for(const n of e.keys())t.delete(n),this.calloutOpenedForCritique===n&&(null===(i=this.critiqueCalloutHandler)||void 0===i||i.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.mouseHoveredCritiqueId!==n&&this.caretHoveredCritiqueId!==n||(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle())},this.removeMissingElements=e=>{var t;for(const i of e){const e=this.squigglesMap.get(i);if(e)for(const i of e.values())for(const e of i)null===(t=this._visibilityTracker)||void 0===t||t.unTrackSquiggle(e.data.range.startContainer);this.squigglesMap.delete(i)}},this.buildSquigglesForCritiques=async(e,t,i,n="critique")=>{var s,o,r,a,l,d;const c=[];if(this.anchorElement){const u=this.anchorElement.getBoundingClientRect(),g=null===(s=this.anchorElement.ownerDocument.activeElement)||void 0===s?void 0:s.contains(e),h=null===(o=this.targetWindowRef)||void 0===o?void 0:o.deref(),p=h&&(null===(r=this.hostElement)||void 0===r?void 0:r.getForbiddenRects(h)),m=(e,t)=>{var i;return null===(i=this.hostElement)||void 0===i?void 0:i.transformSquiggleRects(e,t,p)},f=[];for(const s of t){if(!s.range||!s.critique.traceId)continue;const t=i.get(s.critique.traceId);let o=null!==(a=null==t?void 0:t[0].squiggleKind)&&void 0!==a?a:n;if(this.autoCorrectionEnabled&&!t&&g){const e=(0,j.MG)(s.critique);if(e){const t=s.critique;if(this.autoCorrectionBroker&&!this.autoCorrectionBroker.getHasAutoCorrectionBeenConvertedToNormalSquiggle(t))if(this.autoCorrectionBroker.getHasAutoCorrectionBeenApplied(t))o=(null===(d=this.options)||void 0===d?void 0:d.personalizedAutoCorrectionEnabled)&&(0,j.dP)(e)?"personalized-autocorrection":"autocorrection";else{if(this.enableAutoCorrectionForLanguages(e.languages)&&await(null===(l=this._visibilityTracker)||void 0===l?void 0:l.checkImmediateVisibility(s.range.startContainer))&&this.isAutoCorrectApplicable(s.range)){c.push({critique:t,suggestion:e,range:s.range});continue}this.autoCorrectionBroker.convertToNormalSquiggle(t)}}}this.createOrUpdateSquiggleStates(s.critique,s.range,e,i,o,u,t,m).shouldAnnounce&&f.push({critique:s.critique,squiggleKind:o})}f.length&&this.setAriaStatuses(f)}return c},this.isAutoCorrectApplicable=e=>{var t;const i=null===(t=this.targetWindowRef)||void 0===t?void 0:t.deref();if(!i)return!1;const n=i.document.getSelection();if(!(null==n?void 0:n.focusNode)||!n.isCollapsed)return!1;const s=e.comparePoint(n.focusNode,n.focusOffset);if(0===s)return!1;const o=i.document.createRange();return 1===s?(o.setStart(e.endContainer,e.endOffset),o.setEnd(n.focusNode,n.focusOffset)):(o.setStart(n.focusNode,n.focusOffset),o.setEnd(e.startContainer,e.startOffset)),o.toString().length<=r.t},this.createOrUpdateSquiggleStates=(e,t,i,n,s,o,r,a)=>e.traceId&&this.anchorElement&&this.hostElement?this.updateSquiggle(r,t,e,i,s,o,a,n,e.traceId):{shouldAnnounce:!1},this.setAriaStatuses=e=>{const t=e.map((e=>{if(!this.isAriaFeatureEnabled(S.j.appearance))return;const{critique:t,squiggleKind:i}=e,n=t.textInContext;if(!n)return;const s="critique"===i?"KeepOriginal":"AutoCorrectAppearance";return{text:"critique"===i?`${t.categoryTitle} ${n}`:n,id:t.traceId,messageKind:s}}));this.publishEvent("ariaStatusUpdated",{eventKind:"statusList",statuses:t.filter((e=>!!e)),severity:"assertive"})},this.findSquiggle=e=>{const t=this.findSquiggleByCritiqueId(e);return t&&t.length>0?t[0]:void 0},this.findSquiggleByCritiqueId=e=>{let t;for(const i of this.squigglesMap.values()){const n=i.get(e);if(null==n?void 0:n.length){t=n;break}}return t},this.onShowCallout=(e,t,i,n,s,o,r,a,l)=>{var d,c,u,g,p;if(!this.isVisible)return;if(this.calloutOpenedForCritique===t.traceId)return;this.calloutOpenedForCritique&&this.onCalloutClosed(s,!1,this.calloutOpenedForCritique),this.closeTooltip(),this.setCalloutOpenedForCritique(t.traceId);const m=this.proofedElements.find((e=>e.element===o));let f=null===(d=null==m?void 0:m.graphNode)||void 0===d?void 0:d.element;if(!f&&t.nodeId){const e=this.proofingDom.findNode(t.nodeId);(0,W.l)(e)?f=e.parent.element:e&&(f=e.element)}if(!f)return void(null===(c=this.logger)||void 0===c||c.error(508146700,"Unable to find graph node while showing callout"));const v=null!=e?e:a;if(!v)return void(null===(u=this.logger)||void 0===u||u.error(507562183,"Unable to find target location while showing callout"));const y=e&&(0,T.C)(e,"HTMLElement")?e.ownerDocument:null===(g=this.anchorElement)||void 0===g?void 0:g.ownerDocument;null===(p=this.critiqueCalloutHandler)||void 0===p||p.showCallout({critique:t,issueText:i,setInitialFocus:n,target:v,gapSpace:l,targetDocumentRef:y&&new h.O(y),squiggleKind:r,onDismiss:e=>{this.onCalloutClosed(s,e,t.traceId)},onApplySuggestion:async(e,t)=>{var i,n;this.caretPosition=void 0,await this.critiqueApplicationHandler.applyCritiqueSuggestion(f,o,null!==(i=e.nodeId)&&void 0!==i?i:null==m?void 0:m.id,e,t,(null===(n=this.options)||void 0===n?void 0:n.disableRangeWhenApplyingCritiqueSuggestions)?void 0:a,r)},onApplyFlag:async(e,t,i)=>{await this.critiqueApplicationHandler.applyFlagSuggestion(f,o,e.nodeId,e,t,i)},onIgnoreOnce:e=>{var t,i,n;this.critiqueApplicationHandler.ignoreCritiqueOnce(f,o,null!==(n=null!==(t=e.nodeId)&&void 0!==t?t:null===(i=e.tileId)||void 0===i?void 0:i.nodeId)&&void 0!==n?n:null==m?void 0:m.id,e)},onIgnoreAll:e=>{var t;this.critiqueApplicationHandler.ignoreAllOfCritique(f,o,null!==(t=e.nodeId)&&void 0!==t?t:null==m?void 0:m.id,e)},onFlagIgnoreOnce:e=>{this.critiqueApplicationHandler.ignoreFlagOnce(f,o,e.nodeId,e)},onFlagIgnoreAll:e=>{this.critiqueApplicationHandler.ignoreAllOfFlag(f,o,e)},onDisableFlag:e=>{this.critiqueApplicationHandler.disableFlagType(f,o,e.nodeId,e)},onShowFeedback:e=>{this.flagShowFeedback(o,e)},onDisableCritiqueType:async e=>{var t;await this.critiqueApplicationHandler.disableCritiqueType(f,o,null!==(t=e.nodeId)&&void 0!==t?t:null==m?void 0:m.id,e)},onCalloutPositionUpdated:this.onCalloutPositionUpdated})},this.setCalloutOpenedForCritique=e=>{if(this.calloutOpenedForCritique=e,this.cssHighlightRegistry){let t=[];if(e){const i=this.findSquiggleByCritiqueId(e);i&&(t=i)}this.cssHighlightRegistry.updateHighlight(this.squigglerIdForCssHighlights,t,"callout")}},this.setMouseIndirectlyHoveredElement=e=>{this.mouseIndirectlyHoveredElement=e},this.innerUpdateSquiggles=async()=>{const e=[];if(this.forEachCritique((t=>{if(t.squiggles.length)for(const i of t.squiggles)i.data.isRangeInValidState()||e.push(i)})),e.length){const t=await this.critiqueRangeBuilder.getCritiqueRanges(e.map((e=>e.critique)));if(t.length===e.length)for(let i=0;i<e.length;i++)e[i].data.updateRange(t[i].range)}this.innerUpdateSquigglesWithValidRanges()},this.innerUpdateSquigglesWithValidRanges=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();if(!(this.isVisible&&this.anchorElement&&t&&this.hostElement))return;const i=this.anchorElement.getBoundingClientRect(),n=this.hostElement.getForbiddenRects(t),s=(e,t)=>{var i;return null===(i=this.hostElement)||void 0===i?void 0:i.transformSquiggleRects(e,t,n)},o=[];(0,a.transaction)((()=>{this.forEachCritique((e=>{if(!e.squiggles.length)return;const t=e.squiggles[0];this.updateSquiggle(e.squiggles,t.data.range,t.critique,t.element,t.squiggleKind,i,s,e.elementCritiques,e.key).shouldAnnounce&&o.push(t)}))})),o.length&&this.setAriaStatuses(o)},this.updateSquiggle=(e,t,i,n,s,r,a,l,u)=>{var g,h,p,m,f,v;let y=!0;e?y=null===(p=null===(h=this._visibilityTracker)||void 0===h?void 0:h.isSquiggleVisible(t.startContainer))||void 0===p||p:null===(g=this._visibilityTracker)||void 0===g||g.trackSquiggle(t.startContainer);let _=!1;if(y&&this.anchorElement){const g=Q(t,a,r,this.scaleTransformValue);if(e&&g.length===e.length)for(let n=0;n<g.length;n+=1){const s=this.adjustVerticalPosition(g[n]),o=e[n];s.visible===o.isVisible&&(0,E.a)(s,o.data.clientRect)||e[n].updateFromRect(s,t),o.critique.start!==i.start&&(o.critique.start=i.start),o.stealth!==(null!==(m=o.critique.isStealth)&&void 0!==m&&m)&&(o.stealth=null!==(f=o.critique.isStealth)&&void 0!==f&&f)}else{const r=[];for(const e of g){const a=new c((0,z.h)(),n,s,i,e.visible,null!==(v=i.isStealth)&&void 0!==v&&v,new d(t,this.adjustVerticalPosition(e),this.zIndex),o.createRef());r.push(a)}r.length>0&&(e||(_=!0),l.set(u,r))}}else if(e)for(const t of e)t.isVisible&&(t.isVisible=!1);return{shouldAnnounce:_}},this.adjustVerticalPosition=e=>{var t;return void 0!==(null===(t=this.options)||void 0===t?void 0:t.squiggleVerticalAdjustment)&&(e.bottom+=this.options.squiggleVerticalAdjustment,e.height+=this.options.squiggleVerticalAdjustment),e},this.forEachCritique=e=>{this.forEachCritiqueInCache(this.squigglesMap,e)},this.forEachCritiqueInCache=(e,t)=>{const i=new Map;for(const n of e){const e=n[0],s=n[1],o=[];for(const i of s){const n=i[0],r=i[1];r.length>0&&o.push(r[0].critique),t({squiggles:r,key:n,elementCritiques:s,elementId:e})}i.set(e,o)}return i},this.showTooltipAt=(e,t,i,n,s)=>{var o,r,a,l,d,c;if(!(null===(o=this.options)||void 0===o?void 0:o.tooltipEnabled)||(null===(r=this.upsellStore)||void 0===r?void 0:r.isSquiggleBeingPreviewed(i)))return;if(this.calloutOpenedForCritique||(null===(a=this.editorSettingsState)||void 0===a?void 0:a.currentlyOpen))return void this.closeTooltip();const u=(null==t?void 0:t.ownerDocument)||(null===(l=this.anchorElement)||void 0===l?void 0:l.ownerDocument)||document;let g;if("keyboard"===n)if(s)g=this.getTooltipCoordinatesFromLocalPosition(s);else{const e=u.getSelection();if(!(e&&e.rangeCount>0))return;{const t=e.getRangeAt(0);let i;i=t.collapsed&&t.getClientRects().length?t.getClientRects()[0]:t.getBoundingClientRect(),g={x:i.left,y:i.bottom}}}else{if(this.mouseHoveredCritiqueId===this.disabledCritiqueIdToShowTooltip)return;if(!this.lastMousePosition)return;if(this.options.disableSquiggleTooltipOnTextSelection){const e=u.getSelection();if(e&&0!==e.toString().length)return}g=this.getTooltipCoordinatesFromGlobalPoint(this.lastMousePosition)}this.clearTooltipTimeout();const h=(0,U.m)(u.activeElement);this.tooltipTimeout=null===(c=null===(d=this.targetWindowRef)||void 0===d?void 0:d.deref())||void 0===c?void 0:c.setTimeout((()=>{var s;if("keyboard"===n){const e=(0,U.m)(u.activeElement);if(h!==e)return}this.isTooltipShown=!0,null===(s=this.tooltipHandler)||void 0===s||s.showTooltip({squiggleKind:e,critique:i,position:g,origin:null!=t?t:void 0,isAbsolute:void 0,targetDocument:u})}),1e3)},this.getTooltipCoordinatesFromGlobalPoint=e=>({x:e.x+6,y:e.y+16}),this.getTooltipCoordinatesFromLocalPosition=e=>{var t,i,n;const s=null===(t=this.anchorElement)||void 0===t?void 0:t.getBoundingClientRect();return this.getTooltipCoordinatesFromGlobalPoint({x:e.x+(null!==(i=null==s?void 0:s.left)&&void 0!==i?i:0),y:e.y+(null!==(n=null==s?void 0:s.top)&&void 0!==n?n:0)})},this.closeTooltip=(e,t)=>{var i;this.clearTooltipTimeout(),this.isTooltipShown&&(this.isTooltipShown=!1,null===(i=this.tooltipHandler)||void 0===i||i.hideTooltip()),t&&(this.disabledCritiqueIdToShowTooltip=e)},this.onSquigglerVisibilityChange=e=>{this.setVisible(e)},this.onSquigglesVisibilityChange=()=>{this.updateSquiggles()},this.submitTelemetryEvent=e=>{this.publishEvent("telemetryLogEvent",e)},this.isAriaFeatureEnabled=e=>{var t,i;const n=null!==(i=null===(t=this.options)||void 0===t?void 0:t.ariaFeatures)&&void 0!==i?i:S.j.none;return e===S.j.none?n===e:(n&e)===e},this.restoreCaretOnCalloutClose=()=>{var e,t,i,n,s;if((null===(e=this.options)||void 0===e?void 0:e.restoreCaretPosition)&&void 0!==this.caretPosition){const{node:e,offset:o}=this.caretPosition;if(void 0!==e){const r=((null===(t=this.anchorElement)||void 0===t?void 0:t.ownerDocument)||document).getSelection();if(!r||!e)return;const a=null!==(n=null===(i=e.textContent)||void 0===i?void 0:i.length)&&void 0!==n?n:0,l=Math.min(o,a);try{r.removeAllRanges(),r.setPosition(e,l)}catch(e){null===(s=this.logger)||void 0===s||s.error(539824961,"Error while restoring the IP on callout dismissed",e)}}}},this.checkSquiggleSelection=(e,t)=>{var i,n,s;if(!this.hasSquigglerRefOrIsCSSHighlightSquiggle(e)||t.rangeCount<1)return!1;const o=t.getRangeAt(0);let r;r=o.collapsed&&o.getClientRects().length?o.getClientRects()[0]:o.getBoundingClientRect();const a=null!==(s=null===(n=null===(i=e.squiggleRef)||void 0===i?void 0:i.current)||void 0===n?void 0:n.getBoundingClientRect())&&void 0!==s?s:e.data.range.getBoundingClientRect();return!(a.left>r.right||a.right<r.left||a.top>r.bottom||a.bottom<r.top)},this.onCalloutClosed=(e,t,i)=>{e(),this.calloutOpenedForCritique===i&&this.setCalloutOpenedForCritique(void 0),t?this.restoreCaretOnCalloutClose():this.caretPosition=void 0},this.getAriaStatusString=e=>{const t=e.data.range.toString();return"critique"===e.squiggleKind?`${e.critique.categoryTitle} ${t}`:t},this.closeCalloutCallback=e=>{var t;e&&this.calloutOpenedForCritique===e&&(null===(t=this.critiqueCalloutHandler)||void 0===t||t.hideCallout())},this.getHighlightedCritiqueIds=()=>{const e=new Map;return this.caretHoveredCritiqueId&&e.set(this.caretHoveredCritiqueId,"caret"),this.mouseHoveredCritiqueId&&e.set(this.mouseHoveredCritiqueId,"cursor"),this.calloutOpenedForCritique&&e.set(this.calloutOpenedForCritique,"callout"),e},this.getSquiggleProps=e=>{var t;const i=this.anchorElement;if(!i)return[];const n=!this.isAriaFeatureEnabled(S.j.none),s=n?"none presentation":"status",o=n?"off":"assertive",r=(null===(t=this.options)||void 0===t?void 0:t.squiggleStyleType)===N.N.SVG;return e.map((e=>{var t,a,l;const{critique:d,id:c}=e,u=d.traceId===this.caretHoveredCritiqueId||d.traceId===this.mouseHoveredCritiqueId||d.traceId===this.calloutOpenedForCritique;let g=c===this.mouseHoveredElement;(0,G.k)(e.squiggleKind)&&(g=g||c===this.mouseIndirectlyHoveredElement);const h=Object.assign(Object.assign({},e),{isHighlighted:u,isCaretOver:c===this.caretHoveredElement,isMouseOver:g,isCalloutOpened:d.traceId===this.calloutOpenedForCritique,useSvgUnderline:r,squiggleVerticalAdjustment:null===(t=this.options)||void 0===t?void 0:t.squiggleVerticalAdjustment,contextualCardTriggers:this.contextualCardTriggers.critique,disableCalloutOnDoubleClick:(null===(a=this.options)||void 0===a?void 0:a.disableCalloutOnDoubleClick)&&(null===(l=this.hostElement)||void 0===l?void 0:l.disableCalloutOnDoubleClick),role:s,ariaLive:o,ariaLabel:n?"":this.getAriaStatusString(e),describedBy:w.y,anchor:i,onCallOut:this.onShowCallout,closeCallout:this.closeCalloutCallback,showTooltip:this.showTooltipAt,closeTooltip:this.closeTooltip,submitTelemetryEvent:this.submitTelemetryEvent});return(0,G.k)(e.squiggleKind)&&this.autoCorrectionCache?Object.assign(Object.assign({},h),{squiggleKind:e.squiggleKind,contextualCardTriggers:this.contextualCardTriggers.autoCorrection,initializationProgress:this.autoCorrectionCache.getSquiggleInitializationProgress(e.critique.traceId),setInitializationProgress:this.autoCorrectionCache.setInitializationProgress}):Object.assign(Object.assign({},h),{squiggleKind:"critique",contextualCardTriggers:this.contextualCardTriggers.critique})}))},this.clearTooltipTimeout=()=>{var e;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();this.tooltipTimeout&&t&&(t.clearTimeout(this.tooltipTimeout),this.tooltipTimeout=void 0)},this.clearOnCalloutShownCallbackTimeout=()=>{var e;if(!this.onCalloutShownCallbackTimeout)return;const t=null===(e=this.targetWindowRef)||void 0===e?void 0:e.deref();t&&(t.clearTimeout(this.onCalloutShownCallbackTimeout),this.onCalloutShownCallbackTimeout=void 0)},this.cancelSetVisibleFrame=()=>{this.setVisibleFrameRequestId&&(this.safeWindow.cancelAnimationFrame(this.setVisibleFrameRequestId),this.setVisibleFrameRequestId=void 0)},this.cancelShowCalloutFrame=()=>{this.showCalloutFrameRequestId&&(this.safeWindow.cancelAnimationFrame(this.showCalloutFrameRequestId),this.showCalloutFrameRequestId=void 0)},this.hasSquigglerRefOrIsCSSHighlightSquiggle=e=>{var t;return!!(null===(t=e.squiggleRef)||void 0===t?void 0:t.current)||!!this.hostSettings.enableCSSHighlightApiSquiggleRendering};const{anchorElement:Y,anchorId:X,proofedItem:ee,critiqueCalloutHandler:te,tooltipHandler:ie,options:ne,contextualCardTriggers:se}=e;this.contextualCardTriggers=se,this.critiqueCalloutHandler=te,this.tooltipHandler=ie,this.id=X,this.options=ne,this.anchorElement=Y,this.proofedElements.push(ee),this.targetWindowRef=new h.O((0,T.e)(this.anchorElement)),this.safeWindow=new x.c(i),this.throttleManager=new L._(null!==(P=this.targetWindowRef)&&void 0!==P?P:new h.O(window)),this.squigglerEventManager=new R,this.autoCorrectionCache=new r.Q;const oe=function(e,t){if(!e.enableCSSHighlightApiSquiggleRendering)return;const i=(0,B.b)(t);return i||void 0}(this.hostSettings,this.anchorElement);let re;oe&&(this.cssHighlightRegistry=new v(oe,this.targetWindowRef,this.autoCorrectionEnabled,this.autoCorrectionCache));const ae=()=>re||(re=getComputedStyle(Y));this.hostElement=V(Y,(()=>ae().position),null!==(O=null==ne?void 0:ne.edgeCases)&&void 0!==O?O:[],ee,!1),(null===(k=this.hostElement.element)||void 0===k?void 0:k.parentElement)===this.anchorElement&&(this.anchorElement.firstElementChild===this.hostElement.element?this.top=0:this.top=-1*this.hostElement.getTopOffset(this.anchorElement)),this.zIndex=this.hostElement.zIndex?M(this.hostElement.zIndex.toString()):M(ae().zIndex),this.parentToRenderTo=this.hostElement.element,this._visibilityTracker=null!==(H=null==ne?void 0:ne.visibilityTracker)&&void 0!==H?H:D.Y,this.isVisible=this._visibilityTracker===D.Y,this._visibilityTracker.connect({trackSquiggler:!0,trackSquiggles:null===($=null===(K=this.options)||void 0===K?void 0:K.visibilityTrackerShouldTrackSquiggles)||void 0===$||$,anchorElement:Y,onSquigglerVisibilityChange:this.onSquigglerVisibilityChange,onSquigglesVisibilityChange:this.onSquigglesVisibilityChange}),(null===(J=this.options)||void 0===J?void 0:J.mutationObserverBasedRelativePosition)&&(this.recalculateRelativePosition(),this._relativePositionMutationObserver=new MutationObserver((e=>this.recalculateRelativePosition())),this._relativePositionMutationObserver.observe(this.parentToRenderTo,{attributeFilter:["class","style"]})),(null==ne?void 0:ne.throttleUpdates)&&(this.throttledUpdateSquiggles=this.throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this.safeWindow,this.innerUpdateSquiggles,16,"After"),this.throttledUpdateRanges=this.throttleManager.throttleUntilNextAnimationFrameAndAdditionalTime(this.safeWindow,(()=>{const e=this.throttledUpdateRangesProofedElementsToCheck;return this.throttledUpdateRangesProofedElementsToCheck=void 0,this.updateRangesImmediately(e)}),16,"After")),this.autoCorrectDisabledLanguages=null!==(Z=null==ne?void 0:ne.autoCorrectDisabledLanguages)&&void 0!==Z?Z:[],(0,l.Gn)(this)}setSquigglerRef(e){this._squigglerElement=e}checkProofingElementsPosition(){let e=this.proofedElementDomRects.length!==this.proofedElements.length;const t=[];return this.proofedElements.forEach(((i,n)=>{const s=i.element.getBoundingClientRect();t.push(s);const o=this.proofedElementDomRects[n],r=!o||!(s.x===o.x&&s.y===o.y&&s.width===o.width&&s.height===o.height);e=e||r})),e&&(this.proofedElementDomRects=t),e}updatePosition(e){var t,i,n,s,o;if(e){if(this._squigglerElement&&this.anchorElement){if((null===(i=null===(t=this.hostElement)||void 0===t?void 0:t.element)||void 0===i?void 0:i.parentElement)===this.anchorElement&&this.anchorElement.firstElementChild===this.hostElement.element&&0===this.top&&0===this.left)return!1;let e=!1;const r=this._squigglerElement.getBoundingClientRect(),a=this.anchorElement.getBoundingClientRect(),l=a.top-r.top-this.top,d=a.left-r.left-this.left;return Math.abs(l)>(null!==(n=this.diffPrecision)&&void 0!==n?n:.01)&&(this.top+=l,e=!0),Math.abs(d)>(null!==(s=this.diffPrecision)&&void 0!==s?s:.01)&&(this.left+=d,e=!0),!e&&(null===(o=this.options)||void 0===o?void 0:o.trackProofingElementsPositionEnabled)&&(e=this.checkProofingElementsPosition()),e}}else if(this.anchorElement)if(this.anchorElement===this.parentToRenderTo)if(["body","html"].includes(this.anchorElement.nodeName.toLowerCase())){const e=function(e){const t=getComputedStyle(e),i=k(t.marginTop);return{x:k(t.marginLeft),y:i}}(this.anchorElement);this.left=this.anchorElement.offsetLeft+e.x,this.top=this.anchorElement.offsetTop+e.y}else this.left=0,this.top=0;else["tbody"].includes(this.anchorElement.nodeName.toLowerCase())?(this.left=0,this.top=0):(this.left=this.anchorElement.offsetLeft,this.top=this.anchorElement.offsetTop);return!1}dispose(){var e,t,i,n,s,o;this.clearUndoCardTimeout(),this.anchorElement&&(null===(e=this.cssHighlightRegistry)||void 0===e||e.clear(this.squigglerIdForCssHighlights),null===(t=this.cssHighlightRegistry)||void 0===t||t.dispose(),this.cssHighlightRegistry=void 0,this.cancelSetVisibleFrame(),this.cancelShowCalloutFrame(),this.clearOnCalloutShownCallbackTimeout(),this.clearTooltipTimeout(),this.squigglesMap.clear(),null===(i=this._visibilityTracker)||void 0===i||i.disconnect(),this._visibilityTracker=void 0,null===(n=this._relativePositionMutationObserver)||void 0===n||n.disconnect(),this._relativePositionMutationObserver=void 0,this.proofedElements=[],this.anchorElement=void 0,this.parentToRenderTo=void 0,this.hostElement=void 0,this._squigglerElement=void 0,this.targetWindowRef=void 0,this.throttledUpdateSquiggles=void 0,this.throttledUpdateRanges=void 0,null===(s=this.throttleManager)||void 0===s||s.dispose(),(this.caretHoveredCritiqueId||this.mouseHoveredCritiqueId)&&(this.closeTooltip(),this.trivializeCaretSquiggle(),this.trivializeCursorSquiggle()),this.calloutOpenedForCritique&&(null===(o=this.critiqueCalloutHandler)||void 0===o||o.hideCallout(),this.setCalloutOpenedForCritique(void 0)),this.critiqueCalloutHandler=void 0,this.tooltipHandler=void 0,this.contextualCardTriggers={autoCorrection:{mouse:[],keyboard:[]},critique:{mouse:[],keyboard:[]}})}determineValidSquiggles(e){var t,i,n,s,o,r,a,l,d,c;const u=[],g=[],h=new Map;for(const p of e){if(!p.range)continue;const e=p.range.commonAncestorContainer.nodeType!==Node.TEXT_NODE&&(0,T.C)(p.range.commonAncestorContainer,"HTMLElement")?p.range.commonAncestorContainer:p.range.commonAncestorContainer.parentElement;if(!e)continue;let m=!0;const f=h.get(e);if(void 0!==f)m=f;else{("a"===e.nodeName.toLowerCase()||!0===(null===(n=null===(i=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.squigglerSettings)||void 0===i?void 0:i.checkSquigglePositionValidity)||void 0===n?void 0:n.call(i,p.critique,p.range))||(null===(o=null===(s=this.hostSettings.serviceSettings)||void 0===s?void 0:s.squigglerSettings)||void 0===o?void 0:o.invalidSquiggleParentSelectors)&&e.closest(this.hostSettings.serviceSettings.squigglerSettings.invalidSquiggleParentSelectors.join(", ")))&&(m=!1);const u=[...null!==(l=null===(a=null===(r=this.hostSettings.serviceSettings)||void 0===r?void 0:r.squigglerSettings)||void 0===a?void 0:a.invalidSquiggleSelectors)&&void 0!==l?l:[],".ms-prediction","a"].join(", ");let g=p.range.startContainer;if((0,T.C)(g,"HTMLElement")?g.closest(u):null===(d=null==g?void 0:g.parentElement)||void 0===d?void 0:d.closest(u))m=!1;else for(;g=this.getNextNode(p.range.startContainer,!1,p.range.endContainer);){((0,T.C)(g,"HTMLElement")?g.closest(u):null===(c=null==g?void 0:g.parentElement)||void 0===c?void 0:c.closest(u))&&(m=!1);break}h.set(e,m)}m?u.push(p):p.critique.traceId&&g.push(p.critique.traceId)}return{validRanges:u,critiquesInInvalidRanges:g}}getNextNode(e,t,i){var n;if(i!==e){if(e.firstChild&&!t)return e.firstChild;if(e.parentNode)return null!==(n=e.nextSibling)&&void 0!==n?n:this.getNextNode(e.parentNode,!0,i)}}enableAutoCorrectionForLanguages(e=[]){return 0===this.autoCorrectDisabledLanguages.length||e.some((e=>!this.autoCorrectDisabledLanguages.includes(e)))}}(0,n.__decorate)([a.observable],$.prototype,"squigglesMap",void 0),(0,n.__decorate)([a.observable],$.prototype,"calloutOpenedForCritique",void 0),(0,n.__decorate)([a.observable],$.prototype,"mouseHoveredElement",void 0),(0,n.__decorate)([a.observable],$.prototype,"mouseIndirectlyHoveredElement",void 0),(0,n.__decorate)([a.observable],$.prototype,"caretHoveredElement",void 0),(0,n.__decorate)([a.observable],$.prototype,"scaleTransformValue",void 0),(0,n.__decorate)([a.observable],$.prototype,"top",void 0),(0,n.__decorate)([a.observable],$.prototype,"left",void 0),(0,n.__decorate)([a.computed],$.prototype,"squiggles",null),(0,n.__decorate)([a.observable],$.prototype,"isVisible",void 0),(0,n.__decorate)([a.action],$.prototype,"removeCritiques",void 0),(0,n.__decorate)([a.action],$.prototype,"setVisible",void 0),(0,n.__decorate)([a.action],$.prototype,"updatePosition",null),(0,n.__decorate)([a.action],$.prototype,"updateSelectionHighlightState",void 0),(0,n.__decorate)([a.action],$.prototype,"updateSelectionHighlightStateFromCoordinates",void 0),(0,n.__decorate)([a.action],$.prototype,"updateCursorHighlightState",void 0),(0,n.__decorate)([a.action],$.prototype,"trivializeCursorSquiggle",void 0),(0,n.__decorate)([a.action],$.prototype,"trivializeCaretSquiggle",void 0),(0,n.__decorate)([a.action],$.prototype,"scaleTransform",void 0),(0,n.__decorate)([a.action],$.prototype,"dispose",null),(0,n.__decorate)([a.action],$.prototype,"updateRangesImmediately",void 0),(0,n.__decorate)([a.action],$.prototype,"removeCritiquesFromCache",void 0),(0,n.__decorate)([a.action],$.prototype,"removeMissingElements",void 0),(0,n.__decorate)([a.action],$.prototype,"setCalloutOpenedForCritique",void 0),(0,n.__decorate)([a.action],$.prototype,"setMouseIndirectlyHoveredElement",void 0),(0,n.__decorate)([a.action],$.prototype,"innerUpdateSquigglesWithValidRanges",void 0),(0,n.__decorate)([a.action],$.prototype,"updateSquiggle",void 0);var J=i(268402),Z=i(868038),Y=i(575024),X=i(731808),ee=i(537969),te=i(937126),ie=i(589445),ne=i(769263),se=i(279e3),oe=i(997601),re=i(826663),ae=i(781729),le=i(961641),de=i(438343),ce=i(104072),ue=i(538045),ge=i(83605),he=i(761799),pe=i(166137),me=i(955377),fe=i(745133),ve=i(163573),ye=i(877931),_e=i(613543),Ie=i(12870),Ce=i(495488),Se=i(668952),be=i(229906),Te=i(83010),Ee=i(66008),Ne=i(427603);const we=(0,Se.f)("SquigglerV2StateStoreOptionsToken");let xe=class{get squigglesMap(){return this._squigglerCore.squigglesMap}get proofedElements(){return this._squigglerCore.proofedElements}get calloutOpenedForCritique(){return this._squigglerCore.calloutOpenedForCritique}get mouseHoveredElement(){return this._squigglerCore.mouseHoveredElement}get mouseIndirectlyHoveredElement(){return this._squigglerCore.mouseIndirectlyHoveredElement}get mouseHoveredCritiqueId(){return this._squigglerCore.mouseHoveredCritiqueId}get disabledCritiqueIdToShowTooltip(){return this._squigglerCore.disabledCritiqueIdToShowTooltip}get id(){return this._squigglerCore.id}get caretHoveredElement(){return this._squigglerCore.caretHoveredElement}get caretHoveredCritiqueId(){return this._squigglerCore.caretHoveredCritiqueId}get scaleTransformValue(){return this._squigglerCore.scaleTransformValue}get top(){return this._squigglerCore.top}get left(){return this._squigglerCore.left}get isAutoCorrectionOnly(){return this._squigglerCore.isAutoCorrectionOnly}get squiggles(){return this._squigglerCore.squiggles}get parentToRenderTo(){return this._squigglerCore.parentToRenderTo}get hostElement(){return this._squigglerCore.hostElement}get isRelativePositionEnabled(){return this._squigglerCore.isRelativePositionEnabled}get isEmpty(){return this._squigglerCore.isEmpty}get theme(){return this._squigglerCore.theme}get isVisible(){return this._squigglerCore.isVisible}get squiggleStyleType(){return this._squigglerCore.squiggleStyleType}get reactOnComponentUpdate(){return this._squigglerCore.reactOnComponentUpdate}get disableAutoBrowserVirtualizationOfSquiggles(){return this._squigglerCore.disableAutoBrowserVirtualizationOfSquiggles}get ariaEnabled(){return this._squigglerCore.ariaEnabled}get ariaLineNavUpdatesEnabled(){return this._squigglerCore.ariaLineNavUpdatesEnabled}get forcedHighContrast(){return this._squigglerCore.forcedHighContrast}get autoCorrectionEnabled(){return this._squigglerCore.autoCorrectionEnabled}get squiggleVerticalAdjustment(){return this._squigglerCore.squiggleVerticalAdjustment}get anchorElement(){return this._squigglerCore.anchorElement}get squigglerEventManager(){return this._squigglerCore.squigglerEventManager}constructor(e,t,i,n,o,r,a,l,d,c,u,g,h,p,m,f,v,y,_,I,C,S,b,T){var E,N;this.tileContent=t,this.instrumentationProcessor=i,this._hostEmitters=n,this.hostEmitter=o,this.hostSettings=r,this.proofingDom=a,this._squiggleThemeStore=l,this.logger=d,this._tileNodeTraverser=c,this.upsellStore=u,this.editorSettingsState=h,this.feedbackStore=p,this._disableCritiqueHandler=m,this.critiqueStore=f,this.applyCritiqueSuggestionHandler=v,this.applyFlagHandler=y,this.wordDictionary=_,this.editorSettingsManager=I,this._formElementAutoCorrectionCache=C,this.autoCorrectionBroker=S,this.getIsHighContrastTheme=b,this.squiggleTooltipMessageBuilder=T,this.onFeedbackIconClicked=async e=>{var t;null===(t=this.feedbackStore)||void 0===t||t.feedbackIconClicked(e.suggestionText,e.mode)},this.onShowFeedback=async e=>{var t,i;const n=e.flag;(0,X.z)((0,Ce.S)({topicIds:(null===(t=n.suggestionItems)||void 0===t?void 0:t.map((e=>e.entities.map((e=>e.TopicId)))).join(","))||"",topicNames:(null===(i=n.suggestionItems)||void 0===i?void 0:i.map((e=>e.entities.map((e=>e.DisplayName)))).join(","))||"",highlightedText:n.textInContext||"",hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),requestId:n.nodeId,source:"EditorFlag",traceId:n.traceId||""}))},this.onAutoCorrectionTriggered=e=>{this.hostEmitter.emit(ee.pD.autoCorrectionTriggered);const t={isPersonalized:e.isPersonalized.toString()};this.instrumentationProcessor.process({critique:e.critique,eventId:15,customProperties:t})},this.onAriaStatusUpdated=e=>{if(this.ariaStatusStateStore)switch(e.eventKind){case"status":this.ariaStatusStateStore.setStatus(this.getAriaStatusText(e.statusText,e.squiggleKind),e.severity,e.preserve,e.id,e.messageKind);break;case"statusList":this.ariaStatusStateStore.addPreservedStatuses(e.statuses,e.severity);break;case"lineNav":this.ariaStatusStateStore.setLineNavStatus(e.issuesCount,e.severity,e.preserve)}},this.getAriaStatusText=(e,t)=>this.hostSettings.ariaStatusTooltipAnnouncement&&this.squiggleTooltipMessageBuilder?this.squiggleTooltipMessageBuilder.combineSentences(e,this.squiggleTooltipMessageBuilder.getInteractionExplanationAriaLabel(t)):e,this.autoCorrectLanguagesUpdated=async e=>{this._squigglerCore.setAutoCorrectLanguages(e.message)},this.setCritiques=async(e,t=!1)=>this._squigglerCore.setCritiques(e,t),this.removeCritiques=async e=>this._squigglerCore.removeCritiques(e),this.updateRanges=async e=>this._squigglerCore.updateRanges(e),this.updateSquiggles=()=>this._squigglerCore.updateSquiggles(),this.setVisible=e=>this._squigglerCore.setVisible(e),this.setLastMousePosition=e=>{this._squigglerCore.setLastMousePosition(e)},this.disconnectVisibilityTracker=()=>{this._squigglerCore.disconnectVisibilityTracker()},this.getCritiques=()=>this._squigglerCore.getCritiques(),this.showCallout=(e,t)=>{this._squigglerCore.showCallout(e,t)},this.updateSelectionHighlightState=e=>{this._squigglerCore.updateSelectionHighlightState(e)},this.updateSelectionHighlightStateFromCoordinates=e=>{this._squigglerCore.updateSelectionHighlightStateFromCoordinates(e)},this.updateCursorHighlightState=()=>{this._squigglerCore.updateCursorHighlightState()},this.trivializeAllSquiggles=e=>{this._squigglerCore.trivializeAllSquiggles(e)},this.flagShowFeedback=(e,t)=>{this._squigglerCore.flagShowFeedback(e,t)},this.scaleTransform=e=>{this._squigglerCore.scaleTransform(e)},this.updateRangesImmediately=async e=>this._squigglerCore.updateRangesImmediately(e),this.getValidCritiques=async e=>this._squigglerCore.getValidCritiques(e),this.onShowCallout=(e,t,i,n,s,o,r,a,l)=>{this._squigglerCore.onShowCallout(e,t,i,n,s,o,r,a,l)},this.closeTooltip=(e,t)=>{this._squigglerCore.closeTooltip(e,t)},this.getSquiggleProps=e=>this._squigglerCore.getSquiggleProps(e),this.options=e.options,this.ariaStatusStateStore=(null===(E=this.options)||void 0===E?void 0:E.ariaFeatures)?g:void 0,this.critiqueRangeBuilder=new Z.$(this.tileContent,this.proofingDom,this._tileNodeTraverser),this.safeWindow=new x.c(r),this.critiqueApplicationHandler=new s.n(this._hostEmitters,this.tileContent,this.critiqueRangeBuilder,this.proofingDom,this.safeWindow,this._disableCritiqueHandler,this.logger,this.critiqueStore,this.applyCritiqueSuggestionHandler,this.applyFlagHandler,this.wordDictionary,this.editorSettingsManager,this._formElementAutoCorrectionCache),this._squigglerCore=new $(Object.assign(Object.assign({},e),{contextualCardTriggers:{critique:{keyboard:[this.hostSettings.useAlternativeSquiggleHotkey?J.KM:J.S1],mouse:[J.Kc]},autoCorrection:{keyboard:[J.tu],mouse:[!0===(null===(N=this.options)||void 0===N?void 0:N.disableOpenAutoCorrectCalloutOnHover)?J.Kc:J.Nz]}}}),this.tileContent,this.hostSettings,this.proofingDom,this._squiggleThemeStore,this.critiqueApplicationHandler,this.critiqueRangeBuilder,this.autoCorrectionBroker,this.getIsHighContrastTheme,this.logger,this.upsellStore,this.editorSettingsState),this.hostEmitter.on(ee.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated),this._squigglerCore.subscribe("ariaStatusUpdated",this.onAriaStatusUpdated),this._squigglerCore.subscribe("autoCorrectionTriggered",this.onAutoCorrectionTriggered),this._squigglerCore.subscribe("feedbackIconClicked",this.onFeedbackIconClicked),this._squigglerCore.subscribe("showFeedback",this.onShowFeedback)}setSquigglerRef(e){this._squigglerCore.setSquigglerRef(e)}updatePosition(e){return this._squigglerCore.updatePosition(e)}dispose(){this._squigglerCore.unsubscribe("ariaStatusUpdated",this.onAriaStatusUpdated),this._squigglerCore.unsubscribe("autoCorrectionTriggered",this.onAutoCorrectionTriggered),this._squigglerCore.unsubscribe("feedbackIconClicked",this.onFeedbackIconClicked),this._squigglerCore.unsubscribe("showFeedback",this.onShowFeedback),this._squigglerCore.dispose(),this.hostEmitter.off(ee.pD.autoCorrectLanguagesUpdated,this.autoCorrectLanguagesUpdated)}};xe=(0,n.__decorate)([(0,be._)(),(0,n.__param)(0,(0,Te.W)(we)),(0,n.__param)(1,(0,Te.W)(ce.d)),(0,n.__param)(2,(0,Te.W)(te.f)),(0,n.__param)(3,(0,Ee.t)(ee.zJ)),(0,n.__param)(4,(0,Te.W)(ee.M5)),(0,n.__param)(5,(0,Te.W)(ve.n)),(0,n.__param)(6,(0,Te.W)(ue.w)),(0,n.__param)(7,(0,Te.W)(_e.y)),(0,n.__param)(8,(0,Ne.l)()),(0,n.__param)(8,(0,Te.W)(ye.g)),(0,n.__param)(9,(0,Ne.l)()),(0,n.__param)(9,(0,Te.W)(ge.M)),(0,n.__param)(10,(0,Ne.l)()),(0,n.__param)(10,(0,Te.W)(he.Ey)),(0,n.__param)(11,(0,Ne.l)()),(0,n.__param)(11,(0,Te.W)(ie.m)),(0,n.__param)(12,(0,Ne.l)()),(0,n.__param)(12,(0,Te.W)(ne.z)),(0,n.__param)(13,(0,Ne.l)()),(0,n.__param)(13,(0,Te.W)(pe.M)),(0,n.__param)(14,(0,Ne.l)()),(0,n.__param)(14,(0,Te.W)(me.W)),(0,n.__param)(15,(0,Ne.l)()),(0,n.__param)(15,(0,Te.W)(se.$)),(0,n.__param)(16,(0,Ne.l)()),(0,n.__param)(16,(0,Te.W)(oe.a)),(0,n.__param)(17,(0,Ne.l)()),(0,n.__param)(17,(0,Te.W)(re.K)),(0,n.__param)(18,(0,Ne.l)()),(0,n.__param)(18,(0,Te.W)(ae.s)),(0,n.__param)(19,(0,Ne.l)()),(0,n.__param)(19,(0,Te.W)(le.rI)),(0,n.__param)(20,(0,Ne.l)()),(0,n.__param)(20,(0,Te.W)(fe.PF)),(0,n.__param)(21,(0,Ne.l)()),(0,n.__param)(21,(0,Te.W)(de.m)),(0,n.__param)(22,(0,Ne.l)()),(0,n.__param)(22,(0,Te.W)(Y.$)),(0,n.__param)(23,(0,Ne.l)()),(0,n.__param)(23,(0,Te.W)(Ie.U))],xe)},878790:(e,t,i)=>{i.d(t,{j:()=>o});var n=i(379490),s=i(229906);let o=class{constructor(){this._contexts=[]}get rootNodes(){return this._contexts}addRootNode(e){this._contexts.push(e)}clear(){this._contexts=[]}};o=(0,n.__decorate)([(0,s._)()],o)},879190:(e,t,i)=>{i.d(t,{D:()=>n});const n=(0,i(668952).f)("ITextUnitChunker")},883984:(e,t,i)=>{i.d(t,{C:()=>x,f:()=>L});var n=i(379490),s=i(67573),o=i(823325),r=i(537969),a=i(756857),l=i(279e3),d=i(937126),c=i(826663);if(0!=i.j)var u=i(392632);var g=i(331408),h=i(163573),p=i(877931),m=i(856697),f=i(251737),v=i(576516),y=i(142748),_=i(538045),I=i(104072),C=i(955377),S=i(965285),b=i(229906),T=i(66008),E=i(83010),N=i(427603),w=i(710266);let x=class extends S.H{constructor(e,t,i,n,r,a,l,d,c,u){super(e,t,i,n,l,d,c,u),this._tileContent=r,this._localizer=a,this.onFlagAnnotationUpdate=e=>{const t=e.message.messageType,i=e.message.data;if(t===o.G.NewData&&i.results.length>0){const t=[];for(const e of i.results){if(!m.uH.typeGuard(e))continue;if(0===e.results.length)continue;const n=e.results[0];if(!f.f.typeGuard(n))continue;const o=[{entities:[{entityType:v.c.Text,text:n.context+n.hint,subtitle:void 0,icon:{iconName:D()},confidence:1}],entityType:v.c.Text,groupTitle:this._localizer.getMessage("ebx_CIQFlagTimeTitle"),groupSubtitle:this._localizer.getMessage("ebx_CIQFlagTimeSubtitle")}];t.push({annotationId:i.annotationId,traceId:i.annotationId,languageId:e.language,nodeId:i.tileId,nodeVersion:i.tileVersion,textInContext:n.context,start:e.range.start,length:e.range.length,supportedActions:s.lb.Ignore,supportedEntityTypes:[v.c.Text],suggestionItems:o,additionalData:n,tooltipTitle:this._localizer.getMessage("ebx_CIQFlagTimeTooltipTitle"),categoryTitle:this._localizer.getMessage("ebx_CIQFlagTimeCategoryTitle")})}this.addFlags(e.address,t)}else t===o.G.RemoveData&&this.removeFlag(e.address,i.annotationId)},this.onApplyFlag=(e,t,i,n)=>{if(!t.annotationId)return;this._annotationMap.get(t.annotationId)&&(this._annotationMap.delete(t.annotationId),this._tileContent.replace(e.parent,void 0,t.start,t.length,i.text.trim(),n))},this.onIgnoreFlag=(e,t)=>{},this.onDisableFlag=()=>{}}flagHandlerInitialize(){var e,t;if(null===(t=null===(e=this._hostSettings.serviceSettings)||void 0===e?void 0:e.flagAnnotationSettings)||void 0===t?void 0:t.enabled)for(const e of this._hostEmitters)e.on(r.pD.oaFlagAnnotationsTriggered,this.onFlagAnnotationUpdate)}flagHandlerShutdown(){}getCritiqueType(){return g.L9.CIQFlag_Time}};function L(e){var t,i;return(0,u.f1)(e.flightsToTrack,null===(i=null===(t=e.serviceSettings)||void 0===t?void 0:t.flagAnnotationSettings)||void 0===i?void 0:i.entityConfigs,v.c.Time,"mc-unified-text-prediction-timezone-perspectives")}function D(){const e="TimeFlag";return(0,w.Z)(e,{regular:y.EEN,filled:y.Aig}),e}x=(0,n.__decorate)([(0,b._)(),(0,n.__param)(0,(0,T.t)(r.zJ)),(0,n.__param)(1,(0,E.W)(h.n)),(0,n.__param)(2,(0,E.W)(_.w)),(0,n.__param)(3,(0,E.W)(p.g)),(0,n.__param)(4,(0,E.W)(I.d)),(0,n.__param)(5,(0,E.W)(a.H)),(0,n.__param)(6,(0,E.W)(l.$)),(0,n.__param)(7,(0,E.W)(C.W)),(0,n.__param)(7,(0,N.l)()),(0,n.__param)(8,(0,E.W)(d.f)),(0,n.__param)(9,(0,N.l)()),(0,n.__param)(9,(0,E.W)(c.K))],x)},886569:(e,t,i)=>{i.d(t,{p:()=>f});var n=i(379490),s=i(537969),o=i(105244),r=i(420821),a=i(233653),l=i(922630),d=i(229906),c=i(83010),u=i(442316);const g="19a112ec-21fd-432a-9d1f-195e5e94a00b";let h=class{constructor(e,t,i){this._hostEmitter=e,this._logger=t,this._proofingPersistedStore=i,this._hasSpellingBeenDisabled=!1,this._spellingSettings=new Set,this._readSpellingSettings=async e=>{const t=new Set;for(const i of e)i.id===g&&"0"===i.value&&(i.languageId?t.add(i.languageId):this._logger.error(545067014,"Undefined languageId in Spelling overriddenCritiqueTypeOption"));this._spellingSettings=t},this._updateSpellingSettings=async e=>{const t=e.message;await this._readSpellingSettings(t)}}async initialize(){const e=await this._proofingPersistedStore.read(o.l.OverriddenCritiqueTypeOptions);await this._readSpellingSettings(e),this._hostEmitter.on(s.pD.critiqueSettingsChange,this._updateSpellingSettings)}shutDown(){}isSpellingDisabledForAnyLanguage(){const e=this._spellingSettings.size>0;return e&&(this._hasSpellingBeenDisabled=!0),this._hasSpellingBeenDisabled||e}isSpellingEnabledForLanguage(e){return!this._spellingSettings.has(e)}};h=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(s.M5)),(0,n.__param)(1,(0,c.W)(u.g)),(0,n.__param)(2,(0,c.W)(a.K))],h);var p=i(294965);function m(e,t,i,n){var s,o,a;e.set(r.L9.ContextualSpelling,1),e.set(r.L9.WrongSpelling,1),(null===(s=null==n?void 0:n.taskRecognition)||void 0===s?void 0:s.enabled)&&e.set(r.L9.CIQFlag_TaskRecognition,1),(null===(o=null==n?void 0:n.headingDetection)||void 0===o?void 0:o.enabled)&&e.set(r.L9.HeadingDetection,1),(null===(a=null==n?void 0:n.flagAnnotationSettings)||void 0===a?void 0:a.enabled)&&(e.set(r.L9.CIQFlag_Location,1),e.set(r.L9.CIQFlag_File,1),e.set(r.L9.CIQFlag_Time,1),e.set(r.L9.CIQFlag_LocalBusiness,1),e.set(r.L9.CIQFlag_Topic,1),e.set(r.L9.CIQFlag_SatoriEntityRecognition,1),e.set(r.L9.CIQFlag_DateEntityRecognition,1),e.set(r.L9.CIQFlag_PersonEntityRecognition,1));for(const n of t){const t=n.toLowerCase();"mc-officeeditortonalenabled"===t&&i===p.G_.Subscription?e.set(r.L9.TonalRewrite,1):"csi-editor-topicsuggestions"===t&&e.set(r.L9.TopicSuggestion,1)}}let f=class{constructor(e,t,i){var n;this._proofingPersistedStore=e,this._hostSettings=t,this._hostEmitter=i,this._availableCritiqueTypes=new Map,this._overriddenCritiqueTypes=new Map,this._premiumCritiqueTypes=new Map,this._ciqFlagsEnabled=!0,this.critiqueSettingsChange=e=>{this.setOverriddenCritiqueTypes(e.message)},this.ciqSettingsChange=e=>{this._ciqFlagsEnabled=e.message.ciqFlagsEnabled};const s=this._proofingPersistedStore.getCachedEntry(o.l.OverriddenCritiqueTypeOptions);m(this._availableCritiqueTypes,null!==(n=this._hostSettings.flightsToTrack)&&void 0!==n?n:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this.setOverriddenCritiqueTypes(s.storeEntryValue),s.isSynced||this.readOverriddenCritiqueTypesFromStorage()}async initialize(){this._hostEmitter.on(s.pD.critiqueSettingsChange,this.critiqueSettingsChange),this._hostEmitter.on(s.pD.ciqSettingsChange,this.ciqSettingsChange)}shutDown(){}async readOverriddenCritiqueTypesFromStorage(){const e=await this._proofingPersistedStore.read(o.l.OverriddenCritiqueTypeOptions);this.setOverriddenCritiqueTypes(e)}isCritiqueTypeEnabled(e,t){if((0,r.oe)(e)&&!this._ciqFlagsEnabled)return!1;const i=this._availableCritiqueTypes.get(e);let n=this._overriddenCritiqueTypes.get(e);if(this._critiqueToCategoryIdMap){const i=t===r.bx.High?g:this._critiqueToCategoryIdMap.get(e);if(i){0===this._overriddenCritiqueTypes.get(i)&&(n=0)}}return void 0===n?1===i:1===n}isCritiqueTypePremium(e){return e===r.L9.TonalRewrite||(this._hostSettings.enableOrchestration?1===this._premiumCritiqueTypes.get(e):1!==this._availableCritiqueTypes.get(e))}setOverriddenCritiqueTypes(e){if(e){this._overriddenCritiqueTypes.clear();for(const t of e)this._overriddenCritiqueTypes.set(t.id,parseInt(t.value,10))}}setAvailableCritiqueTypes(e,t){var i;if(e){this._availableCritiqueTypes.clear(),m(this._availableCritiqueTypes,null!==(i=this._hostSettings.flightsToTrack)&&void 0!==i?i:[],this._hostSettings.licenseType,this._hostSettings.serviceSettings),this._critiqueToCategoryIdMap=t;for(const t of e)this._availableCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}setPremiumCritiqueTypes(e){if(e){this._premiumCritiqueTypes.clear();for(const t of e)this._premiumCritiqueTypes.set(t.id,t.defaultCritiqueValue)}}};f=(0,n.__decorate)([(0,d._)(),(0,n.__param)(0,(0,c.W)(a.K)),(0,n.__param)(1,(0,c.W)(l.n)),(0,n.__param)(2,(0,c.W)(s.M5))],f)},890928:(e,t,i)=>{if(i.d(t,{Q:()=>u}),0!=i.j)var n=i(934116);if(0!=i.j)var s=i(939178);if(0!=i.j)var o=i(642810);if(0!=i.j)var r=i(415301);if(0!=i.j)var a=i(928452);if(0!=i.j)var l=i(177822);if(0!=i.j)var d=i(251439);if(0!=i.j)var c=i(386675);class u{constructor(){this.imports=[o.d,l.J,n.w]}get uniqueId(){return(0,d.z)(507918280)}configureRootServices(e){e.bind(r.K).toSelf(),e.bind(c.S).toExisting(r.K),e.bind(a.Y).to(a.h),e.bind(s.V).to(s.S),e.bind(c.S).toExisting(s.V)}}},893533:(e,t,i)=>{i.d(t,{b:()=>de});var n,s,o=i(379490),r=i(280767),a=i(270793),l=i(668952);!function(e){e[e.CritiqueClicked=0]="CritiqueClicked",e[e.UpsellButtonClicked=1]="UpsellButtonClicked",e[e.ShowPage=2]="ShowPage",e[e.TryPremiumPreviewButtonClicked=3]="TryPremiumPreviewButtonClicked"}(n||(n={})),function(e){e[e.ShowCritiqueCallout=0]="ShowCritiqueCallout",e[e.SettingsPage=1]="SettingsPage",e[e.Outlook=2]="Outlook"}(s||(s={}));const d=(0,l.f)("IUpsellFeature");var c=i(731808),u=i(909113);const g=(e,t)=>{const i=e.length,n=t.length;let s=0,o=0;for(let r=0;r<Math.min(i,n)&&e.charAt(r)===t.charAt(r);r+=1)s+=1,(0,u.Yv)(e.charCodeAt(r))&&(o=s);return o},h=(e,t)=>{const i=e.length,n=t.length;let s=0,o=0;for(let r=0;r<Math.min(i,n)&&e.charAt(i-r-1)===t.charAt(n-r-1);r+=1)s+=1,(0,u.Yv)(e.charCodeAt(i-r-1))&&(o=s);return o},p=(e,t,i)=>{let n,s;const o=e/2;return t<o&&i<o?(n=t,s=i):t<o?(n=t,s=Math.min(i,e-n)):i<o?(s=i,n=Math.min(t,e-s)):(n=o,s=o),{actualLeftContextLength:n,actualRightContextLength:s}},m=(e,t,i,n)=>{if(n){let n=t;for(;" "!==e.charAt(n)&&n<i;)n+=1;return n}{let n=i;const s=i;for(;" "!==e.charAt(n)&&n>t;)n-=1;return n+1<=s&&(n+=1),n}};var f=i(122107),v=i(756857),y=i(781729),_=i(937126),I=i(536906),C=i(592568),S=i(438343),b=i(39183),T=i(829088),E=i(976333),N=i(331408),w=i(920117),x=i(754270),L=i(647879),D=i(825948),A=i(163573),F=i(877931),q=i(494888),R=i(46692),P=i(186438),O=i(761799),k=i(538045),M=i(104072),z=i(166137);const j=(0,l.f)("ITonalFreStore");var W=i(281795),B=i(627736),U=i(637224),H=i(495488),V=i(195305),G=i(17384),Q=i(429712),K=i(305507),$=i(672933),J=i(486138),Z=i(111791),Y=i(700509),X=i(419728),ee=i(229906),te=i(83010),ie=i(427603),ne=i(28543),se=i(747393),oe=i(524812),re=i(122794),ae=i(955146),le=i(989344);let de=class{get roamingDictionaryEnabled(){var e,t;return this.hostSettings.enableV2RoamingDictionary?!!(null===(e=this._roamingDictionaryBroker)||void 0===e?void 0:e.isRoamingDictionaryReady):!!(null===(t=this._roamingDictionaryFeature)||void 0===t?void 0:t.isReady())}get cloudIconEnabled(){return this.hostSettings.inferenceCritiqueCloudIconEnabled&&!this.isRewrite}get shouldShowAddToDictionary(){return!!this.critique&&(this.roamingDictionaryEnabled&&this.isSpelling&&!(0,P.dt)(this.critique))}get isUpsell(){return this.enableUpsell}get setInitialFocus(){return this._setInitialFocus}get isVisible(){return this._isVisible}get targetDocumentRef(){var e;return null!==(e=this._targetDocumentRef)&&void 0!==e?e:new T.O(document)}getParentElement(){var e,t;if(null===(e=this.critique)||void 0===e?void 0:e.nodeId){const e=this._proofingDom.findParagraphNode(this.critique.nodeId);if(!e)return;const i=this._tileContent.getContainingElement(e);if(i)return null!==(t=(0,ae.m)(i))&&void 0!==t?t:i}}get target(){return this._target}get isSynonymsEnabled(){return this._showSynonymsFeature.emitAndEvaluate({eventId:r.OV.GetMoreCommands,sender:r.xr.CritiqueCallout})}get showSynonyms(){return this.showSynonymsState||this.isTopicSuggestionCritique}get brandingMode(){return this.hostSettings.brandingMode}get suggestionsToRender(){return this._suggestionsToRender}get noSuggestionLabel(){var e;return(null===(e=this.critique)||void 0===e?void 0:e.suggestions.length)&&(0,E.gA)(this.critique.suggestions[0].action)?this.critique.suggestions[0].text:""}get calloutTitle(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}return(0,P.dt)(this.critique)?this.localizer.getMessage("ebx_repeatedWordsExplanationTitle"):(0,P.r)(this.critique)?this.localizer.getMessage("ebx_spellingExplanationTitle"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionExplanationTitle"):this.validator.validate(this.critique.explanationTitle)}get text(){var e,t,i;return null!==(i=null===(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)||void 0===t?void 0:t.substring(this.critique.start,this.critique.start+this.critique.length))&&void 0!==i?i:""}get textInContext(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&void 0!==t?t:""}get calloutCategory(){if(!this.critique)return"";if(this.isAutoCorrection){const e=this.critique.suggestions[0].text,t=this.localizer.getMessage("ebx_autoCorrectRevertTo",e);return this.validator.validate(t)}const e=this.critique.categoryTitle?this._categoryLocalization.toUiLocale(this.critique.categoryTitle):void 0,t=this.isRewrite?this.localizer.getMessage("ebx_toneLabel"):this.isTopicSuggestionCritique?this.localizer.getMessage("ebx_topicSuggestionLabel"):e;return this.validator.validate(t)}get explanation(){var e;return this.hostSettings.critiqueCalloutExplanationFlyout&&this.critique&&null!==(e=this.critique.explanation)&&void 0!==e?e:""}get explanationTitle(){var e,t;return null!==(t=null===(e=this.critique)||void 0===e?void 0:e.explanationLabel)&&void 0!==t?t:""}get localizer(){return this.localizerService}get styles(){return this.styleDefinitions.critiqueCallout}get ariaLabelToReadWhenCardIsOpened(){return this.localizer.getMessage("ebx_critiqueCalloutAriaLabel",[this.calloutCategory,this.explanationTitle,this.calloutTitle,this.textInContext])}get isSpelling(){return(0,P.r)(this.critique)}get isRepeatedWords(){return(0,P.dt)(this.critique)}get isRewrite(){return(0,P.r6)(this.critique)}get isTopicSuggestionCritique(){return(0,P.W)(this.critique)}get isAutoCorrection(){var e;return!!(this.hostSettings.enableAutoCorrect&&this.critique&&(0,P.MG)(this.critique)&&(null===(e=this._autoCorrectionBroker)||void 0===e?void 0:e.getHasAutoCorrectionBeenApplied(this.critique)))}get isSpellingDeletion(){return!!this.critique&&(0,P.ht)(this.critique)}get shouldShowTonalFre(){return this.isRewrite&&!!this.hostSettings.tonalFreEnabledForUser&&!!this._tonalFreStore&&!this._tonalFreStore.isTonalFreAccepted}get settings(){const e={RenderFooterIcons:"true"};return this.hostSettings.isFeedbackEnabled&&this.isRewrite&&(e.EnableFeedback="true"),this.hostSettings.ignoreAllEnabled&&(e.EnableIgnoreAll="true"),e}get gapSpace(){var e;return null!==(e=this._gapSpace)&&void 0!==e?e:4}get critiqueType(){return this.critique&&(0,P.dt)(this.critique)?ne.L9.RepeatedWord:(0,P.r)(this.critique)?ne.L9.Spelling:(0,P.W)(this.critique)?ne.L9.Topic:this.critique&&this.critique.priority===N.bx.Medium?ne.L9.Grammar:this.isRewrite?ne.L9.TonalRewrite:ne.L9.Refinement}get critiqueSource(){if(this.critique&&this.cloudIconEnabled){const e=this.critique.metadata;if(e&&e.length>0)for(const t of e)if("CritiqueSource"===t.name&&"Inference"===t.value)return se.U.Inference}return se.U.Unknown}get isSynonymsAvailable(){var e;const t=null===(e=this.critique)||void 0===e?void 0:e.suggestions.find((e=>!!e.description&&!e.description.match(/\[(.*)\]/g)));return(this.isSpelling||this.isTopicSuggestionCritique)&&!this.isAutoCorrection&&!!t}get showDisableCritiqueTypeMenuItem(){return!!this.hostSettings.enableStopCheckingForThis&&!!this.critique&&this.critique.priority!==N.bx.High&&!this.isTopicSuggestionCritique}get unsignedInEditorFeatureEnabled(){return this._unsignedInEditorFeatureEnabled}constructor(e,t,i,o,r,l,d,u,v,y,_,I,C,S,b,T,D,A,F,q,k,M,z,j,W,G,Q){var K;this.proofingStore=e,this.localizerService=t,this.hostSettings=i,this.wordDictionary=o,this.instrumentationProcessor=r,this.logger=l,this.validator=d,this._showSynonymsFeature=u,this._proofingDom=v,this._tileContent=y,this._upsellFeature=_,this.styleDefinitions=I,this._roamingDictionaryBroker=C,this._upsellStore=S,this._featureFlagsReader=b,this._unSignedInEditorFeature=T,this._ariaStatusStateStore=D,this._feedbackStore=A,this._tonalFreStore=F,this._categoryLocalization=q,this._paneOpenState=k,this._externalSettingsFeature=M,this._roamingDictionaryFeature=z,this._indicatorStore=j,this._multilingualFreStore=W,this._autoCorrectionBroker=G,this._languageInfoProvider=Q,this.wasMarkedAsShown=!1,this.enableUpsell=!1,this._setInitialFocus=!1,this._isVisible=!1,this._target=void 0,this.showSynonymsState=!1,this._suggestionsToRender=[],this.isApplyingCritiqueAction=!1,this.navInfo=void 0,this._gapSpace=void 0,this._unsignedInEditorFeatureEnabled=!1,this.show=async e=>{var t,i,o,r,l,d,c,u,g;const{critique:h,setInitialFocus:p,target:m,onDismiss:f,onApplySuggestion:v,onIgnoreOnce:y,onIgnoreAll:_,onDisableCritiqueType:I,onShowFeedback:C,targetDocumentRef:S,gapSpace:b}=e,T=null!==(i=null===(t=this._upsellStore)||void 0===t?void 0:t.reducePreviewCount(h))&&void 0!==i?i:O.nz.Visible,N=null===(o=this._upsellStore)||void 0===o?void 0:o.isSquiggleBeingPreviewed(h);if(T!==O.nz.Hidden&&!N){if(this._unsignedInEditorFeatureEnabled=await this._unSignedInEditorFeature.emitAndEvaluateAsync({eventId:a.o9.CalloutShown,sender:a.v$.CritiqueCallout}),this.setSynonymsState(await this.proofingStore.read(w.l.ShowSynonyms)),this._suggestionsToRender=[],this._setInitialFocus=p,this.critique=h,this._targetDocumentRef=S,this.enableUpsell=!!(null===(r=this._upsellFeature)||void 0===r?void 0:r.emitAndEvaluate({eventId:n.CritiqueClicked,sender:s.ShowCritiqueCallout,critique:this.critique})),h.suggestions.length>0)for(const[e,t]of h.suggestions.entries()){if((0,E.gA)(t.action))continue;const i=[],n=this.proofingStore.getCachedEntry(w.l.ProofingLanguages).storeEntryValue;if(this.hostSettings.isMultilingualProofingEnabled&&(null!==(l=null==n?void 0:n.length)&&void 0!==l?l:0)>=2)for(const e of null!==(d=t.languages)&&void 0!==d?d:[]){const t=null===(c=this._languageInfoProvider)||void 0===c?void 0:c.getLanguageInfo(e);t&&i.push(t.languageName)}let s={id:e.toString(),title:this.getSuggestionTitle(t),subtitle:this.getSuggestionDescription(t),tag:this.getLanguageTags(t),actions:[ne._R.Accept],tagAccessibilityLabel:i.join(", ")};this.isRewrite&&(s=Object.assign(Object.assign({},s),this.getSuggestionTitleWithDecorations(t))),this.suggestionsToRender.push(s)}this.critique.shouldShowMultilingualFre?null===(u=this._multilingualFreStore)||void 0===u||u.addMultilingualProofingFre():null===(g=this._multilingualFreStore)||void 0===g||g.removeMultilingualProofingFre(),this.onAfterShownCallback=()=>{this._setInitialFocus&&(0,le.Fy)(!0),this.onAfterShownCallback=void 0},this._gapSpace=b,(0,X.runInAction)((()=>{this._target=m})),this.onApplySuggestion=v,this.onIgnoreOnce=y,this.onIgnoreAll=_,this.onDisableCritiqueType=I,this.onShowFeedback=C,this.setIsVisible(!0),this.onShown(h,f)}},this.setSynonymsState=e=>{this.showSynonymsState=e},this.setIsVisible=e=>{this._isVisible=e,this.wasMarkedAsShown=!1},this.hide=()=>{var e;(this._isVisible||this.wasMarkedAsShown)&&void 0!==this.instrumentationEventId&&this.instrumentCallout(this.instrumentationEventId),this.isRewrite&&(null===(e=this._tonalFreStore)||void 0===e||e.checkIfDisableTonalCritiqueInitiatedAndCompleteIt()),this._isVisible=!1,this.wasMarkedAsShown=!1,this.instrumentationEventId=void 0,this.critique=void 0,this._target=void 0,this._targetDocumentRef=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onDisableCritiqueType=void 0,this.footerAction=void 0,this._gapSpace=void 0,this._suggestionsToRender=[],this.onDismiss()},this.onDismiss=()=>{var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this),this.onDismissCallback=void 0},this.afterRender=()=>{var e;null===(e=this.onAfterShownCallback)||void 0===e||e.call(this)},this.onCalloutAction=(e,t,i)=>{this.isApplyingCritiqueAction=!0;try{this.isCritiqueAction(e)?this.onCritiqueAction(e,t):this.onCardAction(e)}finally{this.isApplyingCritiqueAction=!1}},this.onTonalFreAction=e=>{var t;if(this._tonalFreStore){this.isApplyingCritiqueAction=!0;try{let i=!1;switch(e){case re.h.Accept:this._tonalFreStore.acceptTonalRewriteCritique();break;case re.h.Ignore:this.ignoreOnce(),i=!0,this._tonalFreStore.logTonalFreIgnored();break;case re.h.Reject:void 0!==(null===(t=this.critique)||void 0===t?void 0:t.typeId)&&this._tonalFreStore.disableTonalRewriteCritique(this.critique.typeId);break;case re.h.OpenEditorSettings:this._tonalFreStore.showEditorSettings(),i=!0;break;case re.h.DismissRejectMessage:i=!0}i&&this.hide()}finally{this.isApplyingCritiqueAction=!1}}},this.changeShowSynonymsState=()=>{const e=!this.showSynonymsState;this.proofingStore.write(w.l.ShowSynonyms,e).then((()=>{this.updateShowSynonyms(e)}))},this.updateShowSynonyms=e=>{this.showSynonymsState=e;const t=this.logger.getNewActivity(e?x.n.ActionShowSynonymsFromCallout:x.n.ActionHideSynonymsFromCallout,R.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())},this.goPremium=e=>{var t;null===(t=this._upsellFeature)||void 0===t||t.goPremium(s.ShowCritiqueCallout,this.critique,e)},this.tryPremiumPreview=()=>{var e;null===(e=this._upsellStore)||void 0===e||e.tryPremiumPreview(this.critique)},this.signIn=()=>{chrome.runtime.sendMessage({activity:"authentication",type:"msidUserService"});const e=this.logger.getNewActivity(x.n.SignInInitialized,R.o.SamplingPolicy.CriticalExperimentation);e&&(e.dataFields.push((0,L.n)("Entry","CritiqueCallout")),e.success=!0,e.endNow())},this.clickNoActionHide=()=>{const e=this.shouldShowTonalFre;!this.isVisible&&!this.wasMarkedAsShown||e||this.recordInstrumentationEventId(Y.xp.ClickNoAction),this.hide()},this.notifyAriaStatusChange=e=>{this._featureFlagsReader.flags.enableAriaStatusElement&&this._ariaStatusStateStore.setStatus(e,"assertive")},this.applySuggestion=(e,t)=>{var i;this.critique&&this.onApplySuggestion&&(null===(i=this._upsellStore)||void 0===i||i.removePremiumCritique(this.critique),this.onApplySuggestion(this.critique,e))},this.ignoreOnce=()=>{var e,t;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&(null===(t=this.onIgnoreOnce)||void 0===t||t.call(this,this.critique))},this.ignoreAll=()=>{var e;this.critique&&(null===(e=this.onIgnoreAll)||void 0===e||e.call(this,this.critique))},this.addToDictionary=()=>{var e;(null===(e=this.critique)||void 0===e?void 0:e.textInContext)&&this.wordDictionary.addWordToCustomDictionary(this.critique.textInContext)},this.disableCritiqueType=async()=>{var e;const t=this.critique;if(void 0===(null==t?void 0:t.typeId))return void this.logger.error(571326788,"Undefined critique or typeId while trying to disable a critique type");await(null===(e=this.onDisableCritiqueType)||void 0===e?void 0:e.call(this,t));const i=this.logger.getNewActivity(x.n.ActionDisableCritique,R.o.SamplingPolicy.CriticalExperimentation);i&&(i.dataFields.push((0,L.n)("CritiqueTypeId",t.typeId)),t.typeId===N.L9.TopicSuggestion&&i.dataFields.push((0,L.n)("CritiqueMetadataJSON",JSON.stringify(t.metadata))),i.success=!0,i.endNow()),this.recordInstrumentationEventId(Y.xp.DoNotCheckThisIssue),this.notifyAriaStatusChange(t.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",t.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel")),this.hide()},this.onRewriteFeedback=()=>{if(this.isRewrite){const e=this.suggestionsToRender.length>0?this.suggestionsToRender[0].title:"";this._feedbackStore.feedbackIconClicked(e,"tonal"),this.hide()}},this.isCritiqueAction=e=>{switch(e){case ne._R.Accept:case ne._R.IgnoreOnce:case ne._R.IgnoreAll:case ne._R.AddToDictionary:case ne._R.IgnoreRule:return!0;default:return!1}},this.onCritiqueAction=(e,t)=>{var i;if(!this.critique)return void this.logger.error(562438878,`Undefined critique on action: ${e}`);const n=void 0!==t?this.critique.suggestions[t]:void 0;let s,o;switch(e){case ne._R.Accept:n&&void 0!==t?(this.applySuggestion(n,t),s=this.localizer.getMessage("ebx_SuggestionAppliedMessage",n.text),o=this.isSpellingDeletion?Y.xp.Delete:Math.min(t+Y.xp.ChangeSugg0,Y.xp.ChangeSuggOther)):this.logger.error(543495585,`Undefined suggestionIndex or suggestion on Accept: ${t}, ${n}`);break;case ne._R.IgnoreOnce:this.ignoreOnce(),s=this.localizer.getMessage("ebx_GrammarIgnored"),o=Y.xp.Ignore;break;case ne._R.IgnoreAll:this.ignoreAll(),s=this.localizer.getMessage("ebx_SpellingIgnored"),o=Y.xp.IgnoreAll;break;case ne._R.AddToDictionary:this.addToDictionary(),s=this.localizer.getMessage("ebx_AddedToDictionary",this.critique.textInContext),o=Y.xp.AddToDictionary;break;case ne._R.IgnoreRule:this.disableCritiqueType(),s=this.critique.explanationLabel?this.localizer.getMessage("ebx_RuleIgnored",this.critique.explanationLabel):this.localizer.getMessage("ebx_RuleIgnoredNoLabel"),o=Y.xp.DoNotCheckThisIssue}void 0!==o?this.recordInstrumentationEventId(o):this.logger.error(562438879,`Undefined actionInstrumentationEventId on action: ${e}`),void 0!==s?this.notifyAriaStatusChange(s):this.logger.error(562438880,`Undefined actionAriaNotification on action: ${e}`),this.hide(),null===(i=this.navInfo)||void 0===i||i.onNavSuggestionApplied()},this.executeActionIfDefined=(e,t)=>{t?t():this.logger.error(561853783,`Undefined action clicked: ${e}`)},this.onCardAction=e=>{var t,i;switch(e){case ne._R.Options:this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide();break;case ne._R.ManageLanguages:this.executeActionIfDefined("manageLanguagesAction",this.manageLanguagesAction),this.hide();break;case ne._R.ShowExplanation:break;case ne._R.Feedback:if(this.isRewrite)this.onRewriteFeedback();else if(this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback){let e;try{e=this.critique.suggestions.map((e=>{var t;return JSON.parse(null!==(t=e.metadataJSON)&&void 0!==t?t:"{}")}))}catch(e){this.logger.error(537778203,"Error parsing topic metadata json.")}(0,c.z)((0,H.S)({topicIds:(null==e?void 0:e.map((e=>e.id)).join(", "))||"",topicNames:(null==e?void 0:e.map((e=>e.displayName)).join(", "))||"",highlightedText:this.critique.textInContext||"",requestId:this.critique.metadata[0].value,hostMetadata:JSON.stringify(this.hostSettings.hostMetadata),source:"EditorFlag",traceId:this.critique.traceId||""}))}else this.executeActionIfDefined("onShowFeedback",this.onShowFeedback);break;case ne._R.ToggleDescription:this.changeShowSynonymsState();break;case ne._R.AddOnFooterAction:this.executeActionIfDefined("footerAction",this.footerAction);break;case ne._R.Next:this.navigate(1);break;case ne._R.Previous:this.navigate(-1);break;case ne._R.OpenEditorPane:this._indicatorStore?null===(i=(t=this._indicatorStore).onOpenEditorPane)||void 0===i||i.call(t,B.k.ContextualCard):this.executeActionIfDefined("showOptionsAction",this.showOptionsAction),this.hide()}},this.getSuggestionTitle=e=>!(0,P.qB)(e)&&this.critique&&(0,P.ht)(this.critique)?this.localizer.getMessage("ebx_deleteRepeatedWord"):this.validator.validate(e.text),this.getSuggestionTitleWithDecorations=e=>{var t;if(null===(t=this.critique)||void 0===t?void 0:t.textInContext){const{truncatedPrefix:t,truncatedSubstring:i,truncatedSuffix:n}=((e,t)=>{const i=t.length,n=g(e,t),s=Math.min(h(e,t),Math.min(i,e.length)-n),o=n+s,r=i-o,a=Math.min(130,r),l=Math.min(150-a,o),d=Math.min(l,n),c=Math.min(l,s),{actualLeftContextLength:u,actualRightContextLength:f}=p(l,d,c),v=t.substring(n-u,n),y=t.substring(n,i-s),_=t.substring(i-s,i-s+f);let I=v,C=y,S=_;if(n>u){const e=m(v,0,v.length,!0);I=`...${v.substring(e,v.length)}`}if(y.length>a){const e=m(y,0,a/2,!1),t=m(y,a/2,y.length,!0);C=`${y.substring(0,e)}...${y.substring(t,y.length)}`}if(s>f){const e=m(_,0,_.length,!1);S=`${_.substring(0,e)}...`}return{truncatedPrefix:I,truncatedSubstring:C,truncatedSuffix:S}})(this.critique.textInContext,e.text);return{title:t+i+n,titleDecorations:[{start:e.text.indexOf(i),length:i.length,decorationType:ne.vr.Rewrite}]}}return{title:this.getSuggestionTitle(e),titleDecorations:void 0}},this.getSuggestionDescription=e=>{if(!this.isSynonymsEnabled)return;if(!this.isSynonymsAvailable)return;let t=this.validator.validate(e.description);return this.isTopicSuggestionCritique&&(t=t.slice(0,125),e.description&&e.description.length>t.length&&(t+="...")),t||this.localizer.getMessage("ebx_synonymsNotAvailable")},this.getNeutralLanguageCode=e=>{const t=e.indexOf("-");return(t<0?e:e.slice(0,t)).toUpperCase()},this.getLanguageTags=e=>{const t=this.proofingStore.getCachedEntry(w.l.ProofingLanguages).storeEntryValue;if(!t||t.length<2||!e.languages)return"";const i=[];for(const t of e.languages){const e=this.getNeutralLanguageCode(t);i.includes(e)||i.push(e)}return i.join(", ")},this.setNavInfo=e=>{this.navInfo=e},this.navigate=(e=0)=>{const t=(0,V.v)(this.navInfo),i=t.length;if(!this.navInfo||0===i)return this.resetNavigation(),this.clickNoActionHide(),!1;const n=((this.navInfo.currentIndex+e)%i+i)%i,s=t[n];return this.navInfo=Object.assign(Object.assign({},this.navInfo),{currentIndex:n}),this.hide(),"contenteditable"===this.navInfo.ctr?this.navigateCe(s.store,s.critique):this.navigateV2(s.store,s.critique),!0},this.navigateCe=(e,t)=>{const i=this.navInfo;e.showCallout(t,(()=>{this.setNavInfo(i)}))},this.navigateV2=(e,t)=>{const i=e.messageItem.anchor.element,n=this.navInfo;e.showCallout(t,i,i.innerText,!0,(()=>{this.setNavInfo(n)}),"critique")},this.resetNavigation=()=>{var e;null===(e=this.navInfo)||void 0===e||e.onCloseNavigation(),this.navInfo=void 0},this.recordInstrumentationEventId=e=>{var t;this.critique&&void 0===this.instrumentationEventId&&(this.instrumentationEventId=e),e===Y.xp.ClickNoAction&&this.resetNavigation(),null===(t=this._indicatorStore)||void 0===t||t.userInputEvent()},this.instrumentCallout=e=>{this.critique&&!this.unsignedInEditorFeatureEnabled&&this.instrumentationProcessor.process({critique:(0,X.toJS)(this.critique),eventId:e})},(0,U.Gn)(this),(null===(K=this._externalSettingsFeature)||void 0===K?void 0:K.openSettings)&&(this.showOptionsAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(f.kY.dropdown)},this.manageLanguagesAction=()=>{var e;null===(e=this._externalSettingsFeature)||void 0===e||e.openSettings(f.kY.manageLanguages)})}async initialize(){}shutDown(){this._target=void 0,this._targetDocumentRef=void 0,this.onDisableCritiqueType=void 0,this.onDismissCallback=void 0,this.onApplySuggestion=void 0,this.onIgnoreOnce=void 0,this.onIgnoreAll=void 0,this.onAfterShownCallback=void 0,this.onShowFeedback=void 0,this.showOptionsAction=void 0,this.manageLanguagesAction=void 0,this.footerAction=void 0}markAsShown(e,t){this.wasMarkedAsShown=!0,this.onShown(e,t)}onShown(e,t){var i;this.shouldShowTonalFre&&(null===(i=this._tonalFreStore)||void 0===i||i.logTonalFreShown());const n=this.logger.getNewActivity(x.n.ActionShowCallout,R.o.SamplingPolicy.CriticalExperimentation);n&&(n.dataFields.push((0,L.n)("CritiqueTypeId",e.typeId)),e.typeId===N.L9.TopicSuggestion&&n.dataFields.push((0,L.n)("CritiqueMetadataJSON",JSON.stringify(e.metadata))),n.success=!0,n.endNow()),this.onDismiss(),this.onDismissCallback=t}get dropDownActions(){var e;const t=[];return this.isAutoCorrection?t.push(ne._R.AutoCorrectOptions):this.isSpelling&&!this.isSpellingDeletion?(this.hostSettings.ignoreAllEnabled&&t.push(ne._R.IgnoreAll),this.hostSettings.isMultilingualProofingEnabled&&this.hostSettings.enableManageLanguagesInCritiqueCallout&&t.push(ne._R.ManageLanguages)):this.hostSettings.ignoreOnceEnabled&&t.push(ne._R.IgnoreOnce),this.isTopicSuggestionCritique&&this.hostSettings.ignoreAllEnabled&&t.push(ne._R.IgnoreAll),this.isSynonymsAvailable&&this.isSynonymsEnabled&&!this.isTopicSuggestionCritique&&t.push(ne._R.ToggleDescription),this.hostSettings.showOptionsButton&&t.push(ne._R.Options),(this._featureFlagsReader.flags.enableOcvFeedbackUi||this.hostSettings.isFeedbackEnabled&&this.isRewrite||this.isTopicSuggestionCritique&&this.hostSettings.enableTopicsMailtoFeedback)&&t.push(ne._R.Feedback),this.showDisableCritiqueTypeMenuItem&&t.push(ne._R.IgnoreRule),!this.isAutoCorrection&&this.shouldShowAddToDictionary&&t.push(ne._R.AddToDictionary),this.navInfo&&(t.push(ne._R.Next),t.push(ne._R.Previous)),(null===(e=this._paneOpenState)||void 0===e?void 0:e.isPaneOpen)||this.brandingMode!==oe.nH.IconButton&&this.brandingMode!==oe.nH.IconAndTextButton||t.push(ne._R.OpenEditorPane),t}get addOnFooterData(){var e,t;if(this.unsignedInEditorFeatureEnabled)return this.footerAction=this.signIn,{actionText:this.localizer.getMessage("ebx_signIntoEditor"),message:`${this.localizer.getMessage("ebx_addGrammarChecking")}${this.localizer.getMessage("ebx_enhancedUpsellCategoriesComma")}`};if(!this.enableUpsell)return;if(!(this.hostSettings.areAdditionalPaneEntryPointsEnabled&&this._indicatorStore))return this.premiumPreviewFooter;this.footerAction=()=>{var e,t;null===(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.onOpenEditorPane)||void 0===t||t.call(e,B.k.ContextualCard),this.hide()};const i=null!==(t=null===(e=this._indicatorStore)||void 0===e?void 0:e.getPremiumCritiquesCount())&&void 0!==t?t:0;return{actionText:this.localizer.getMessage("ebx_openEditorLabel"),message:i>0?this.localizer.getMessage("ebx_editorAdvancedCritiquesLabel",i.toString()):this.localizer.getMessage("ebx_tryEditorLabel"),icon:"Editor"}}get premiumPreviewFooter(){if(!this.hostSettings.enhancedUpsellEnabled||!this._upsellStore)return this.footerAction=()=>this.goPremium("Regular_CCard"),{actionText:this.localizer.getMessage("ebx_goPremiumLinkText"),message:this.localizer.getMessage("ebx_goPremiumLine"),icon:"PremiumDiamond"};const e=this._upsellStore.previewModeActive,t=this.hostSettings.premiumPreviewEnabled,i=this._upsellStore.previewUnit,n=e?this._upsellStore.previewCount:this._upsellStore.premiumCount,s=t&&!e&&n>0;let o="ebx_premiumPreviewGeneralLine";const r=1===n;e&&i===O.mq.Suggestions?o=r?"ebx_premiumPreviewSuggestionsSingular":"ebx_premiumPreviewSuggestionsPlural":e&&i===O.mq.Days?o=r?"ebx_premiumPreviewDaysSingular":"ebx_premiumPreviewDaysPlural":n>0&&(o=r?"ebx_enhancedUpsellLineSingular":"ebx_enhancedUpsellLinePlural");const a=n.toLocaleString(),l=this.localizer.getMessage(o,a);return this.footerAction=s?()=>{var e;return null===(e=this._upsellStore)||void 0===e?void 0:e.tryPremiumPreview(this.critique)}:()=>this.goPremium("ContextualUpsell_CCard"),{actionText:s?this.localizer.getMessage("ebx_tryPremiumPreviewLink"):this.localizer.getMessage("ebx_goPremiumLinkText"),footerDecorations:n>0||e?[{decorationType:ne.vr.PremiumEmphasis,length:a.length,start:l.indexOf(a)}]:void 0,message:l,icon:"PremiumDiamond"}}restoreCaretToPreviousPosition(){var e;null===(e=this.onDismissCallback)||void 0===e||e.call(this,!0)}};(0,o.__decorate)([X.observable],de.prototype,"enableUpsell",void 0),(0,o.__decorate)([X.computed],de.prototype,"isUpsell",null),(0,o.__decorate)([X.observable],de.prototype,"_setInitialFocus",void 0),(0,o.__decorate)([X.computed],de.prototype,"setInitialFocus",null),(0,o.__decorate)([X.observable],de.prototype,"_isVisible",void 0),(0,o.__decorate)([X.computed],de.prototype,"isVisible",null),(0,o.__decorate)([X.observable],de.prototype,"_target",void 0),(0,o.__decorate)([X.computed],de.prototype,"target",null),(0,o.__decorate)([X.observable],de.prototype,"showSynonymsState",void 0),(0,o.__decorate)([X.computed],de.prototype,"showSynonyms",null),(0,o.__decorate)([X.computed],de.prototype,"brandingMode",null),(0,o.__decorate)([X.observable],de.prototype,"_suggestionsToRender",void 0),(0,o.__decorate)([X.computed],de.prototype,"suggestionsToRender",null),(0,o.__decorate)([X.computed],de.prototype,"noSuggestionLabel",null),(0,o.__decorate)([X.observable],de.prototype,"navInfo",void 0),(0,o.__decorate)([X.computed],de.prototype,"calloutTitle",null),(0,o.__decorate)([X.computed],de.prototype,"text",null),(0,o.__decorate)([X.computed],de.prototype,"textInContext",null),(0,o.__decorate)([X.computed],de.prototype,"calloutCategory",null),(0,o.__decorate)([X.computed],de.prototype,"explanation",null),(0,o.__decorate)([X.computed],de.prototype,"explanationTitle",null),(0,o.__decorate)([X.computed],de.prototype,"styles",null),(0,o.__decorate)([X.computed],de.prototype,"ariaLabelToReadWhenCardIsOpened",null),(0,o.__decorate)([X.computed],de.prototype,"shouldShowTonalFre",null),(0,o.__decorate)([X.computed],de.prototype,"settings",null),(0,o.__decorate)([X.observable],de.prototype,"_gapSpace",void 0),(0,o.__decorate)([X.computed],de.prototype,"gapSpace",null),(0,o.__decorate)([X.computed],de.prototype,"critiqueType",null),(0,o.__decorate)([X.computed],de.prototype,"critiqueSource",null),(0,o.__decorate)([X.action],de.prototype,"show",void 0),(0,o.__decorate)([X.action],de.prototype,"setSynonymsState",void 0),(0,o.__decorate)([X.action],de.prototype,"setIsVisible",void 0),(0,o.__decorate)([X.action],de.prototype,"hide",void 0),(0,o.__decorate)([X.action],de.prototype,"onDismiss",void 0),(0,o.__decorate)([X.action],de.prototype,"afterRender",void 0),(0,o.__decorate)([X.action],de.prototype,"onCalloutAction",void 0),(0,o.__decorate)([X.action],de.prototype,"onTonalFreAction",void 0),(0,o.__decorate)([X.computed],de.prototype,"dropDownActions",null),(0,o.__decorate)([X.action],de.prototype,"updateShowSynonyms",void 0),(0,o.__decorate)([X.computed],de.prototype,"addOnFooterData",null),(0,o.__decorate)([X.action],de.prototype,"setNavInfo",void 0),(0,o.__decorate)([X.action],de.prototype,"navigate",void 0),(0,o.__decorate)([X.action],de.prototype,"resetNavigation",void 0),de=(0,o.__decorate)([(0,ee._)(),(0,o.__param)(0,(0,te.W)(D.K)),(0,o.__param)(1,(0,te.W)(v.H)),(0,o.__param)(2,(0,te.W)(A.n)),(0,o.__param)(3,(0,te.W)(y.s)),(0,o.__param)(4,(0,te.W)(_.f)),(0,o.__param)(5,(0,te.W)(F.g)),(0,o.__param)(6,(0,te.W)(J.$)),(0,o.__param)(7,(0,te.W)(r.DS)),(0,o.__param)(8,(0,te.W)(k.w)),(0,o.__param)(9,(0,te.W)(M.d)),(0,o.__param)(10,(0,te.W)(d)),(0,o.__param)(10,(0,ie.l)()),(0,o.__param)(11,(0,te.W)(G.$)),(0,o.__param)(12,(0,te.W)(I.C)),(0,o.__param)(12,(0,ie.l)()),(0,o.__param)(13,(0,te.W)(O.Ey)),(0,o.__param)(13,(0,ie.l)()),(0,o.__param)(14,(0,te.W)(q.c)),(0,o.__param)(15,(0,te.W)(a.tq)),(0,o.__param)(16,(0,te.W)(Q.QV)),(0,o.__param)(17,(0,te.W)(z.M)),(0,o.__param)(18,(0,te.W)(j)),(0,o.__param)(18,(0,ie.l)()),(0,o.__param)(19,(0,te.W)($.C)),(0,o.__param)(20,(0,ie.l)()),(0,o.__param)(20,(0,te.W)(Z.F)),(0,o.__param)(21,(0,ie.l)()),(0,o.__param)(21,(0,te.W)(f.In)),(0,o.__param)(22,(0,ie.l)()),(0,o.__param)(22,(0,te.W)(C.Zp)),(0,o.__param)(23,(0,ie.l)()),(0,o.__param)(23,(0,te.W)(W.y)),(0,o.__param)(24,(0,ie.l)()),(0,o.__param)(24,(0,te.W)(K.j)),(0,o.__param)(25,(0,ie.l)()),(0,o.__param)(25,(0,te.W)(S.m)),(0,o.__param)(26,(0,ie.l)()),(0,o.__param)(26,(0,te.W)(b.d))],de)},894771:(e,t,i)=>{if(i.d(t,{f:()=>c}),0!=i.j)var n=i(251439);if(0!=i.j)var s=i(852748);if(0!=i.j)var o=i(163573);if(0!=i.j)var r=i(645461);if(0!=i.j)var a=i(651961);if(0!=i.j)var l=i(522674);if(0!=i.j)var d=i(12163);class c{constructor(){this.imports=[]}get uniqueId(){return(0,n.z)(507918277)}configureRootServices(e){e.getOptional(l.qy)||e.bind(l.qy).toDynamicValue((e=>{var t;const i=e.get(o.n),{sessionId:n=e.get(s.G).generate(),appPlatform:l="DefaultAppPlatform",appName:c="DefaultAppName",appScenario:u="",releaseAudienceGroup:g="",clientVersion:h=""}=null!==(t=i.hostMetadata)&&void 0!==t?t:{},p=[(0,d.m9)("Session.Id",n),(0,d.m9)("App.Platform",l),(0,d.m9)("App.Name",c),(0,d.m9)("App.Scenario",u),(0,d.m9)("Release.AudienceGroup",g),(0,d.m9)("App.Version",h)],m=new r.r(p,{endpointUrl:a.d.PUBLIC});return m.setFullEventsEnabled(!1),m}))}}},894904:(e,t,i)=>{if(i.d(t,{m:()=>l}),0!=i.j)var n=i(100966);if(0!=i.j)var s=i(696767);if(0!=i.j)var o=i(152746);var r;!function(e){e[e.AuthorName=0]="AuthorName",e[e.EmailSenderName=1]="EmailSenderName",e[e.FallbackValue=2]="FallbackValue",e[e.LastModifiedByUser=3]="LastModifiedByUser",e[e.LastModifiedByContact=4]="LastModifiedByContact",e[e.LastAccessedByUser=5]="LastAccessedByUser",e[e.SentByUser=6]="SentByUser",e[e.DateCreatedByUser=7]="DateCreatedByUser",e[e.UserCreatedBy=8]="UserCreatedBy"}(r||(r={}));const a=e=>{if(!e)return"";const t=e.includes("Z")?e:`${e}Z`;return(0,o.Z)(new Date(t),new Date)},l=(e,t,i,o)=>{var l,d,c,u;const g=(0,s.$)().getStringsFor("FileTidbitStrings"),h=(e,...t)=>{let i=g(e);return t.filter(Boolean).forEach(((e,t)=>{i=i.replace(`{${t}}`,e)})),i},p=((e,t,i,s)=>{var o;const{Author:a,From:l,DateAccessed:d,DateCreated:c,DateModified:u,SharedDateTime:g,propertyHits:h,UserRelationshipType:p}=e;if(i&&s&&p!==n.b.Uploaded)return r.LastAccessedByUser;const m=(a||(null===(o=null==l?void 0:l.EmailAddress)||void 0===o?void 0:o.Name)||"").trim(),f=m===t;if(i){const e=(null==h?void 0:h.includes("EmailSenderName"))||(null==h?void 0:h.includes("EmailSenderAddress")),t=(null==h?void 0:h.includes("Author"))||(null==h?void 0:h.includes("AuthorEmail"));if(p===n.b.Uploaded)return t?r.UserCreatedBy:r.DateCreatedByUser;if(e)return f?r.SentByUser:r.EmailSenderName;if(t)return r.AuthorName;if(p===n.b.None&&(null==l?void 0:l.EmailAddress)&&g)return r.EmailSenderName;if(d){const e=d.includes("Z")?d:`${d}Z`,t=new Date(e),i=new Date;if(Math.floor((i.getTime()-t.getTime())/864e5)<10)return r.LastAccessedByUser;if((null==l?void 0:l.EmailAddress)&&g){const e=g.includes("Z")?g:`${g}Z`;if(new Date(e)>t)return f?r.SentByUser:r.EmailSenderName}return r.LastAccessedByUser}}return(null==l?void 0:l.EmailAddress)&&g?f?r.SentByUser:r.EmailSenderName:u&&m?f?r.LastModifiedByUser:r.LastModifiedByContact:f&&d?r.LastAccessedByUser:m&&c?r.AuthorName:r.FallbackValue})(e,t,i,o),m=e.Author||(null===(d=null===(l=e.From)||void 0===l?void 0:l.EmailAddress)||void 0===d?void 0:d.Name)||"",f=(null===(u=null===(c=e.From)||void 0===c?void 0:c.EmailAddress)||void 0===u?void 0:u.Name)||"";switch(p){case r.AuthorName:return h("userCreatedOnDate",m,a(e.DateCreated));case r.DateCreatedByUser:return h("youCreatedOnDate",a(e.DateCreated));case r.UserCreatedBy:return h("userCreatedBy",m);case r.LastAccessedByUser:return h("youOpenedOnDate",a(e.DateAccessed));case r.LastModifiedByUser:return h("youModifiedOnDate",a(e.DateModified));case r.LastModifiedByContact:return h("userModifiedOnDate",m,a(e.DateModified));case r.EmailSenderName:return h("userSentOnDate",f,a(e.SharedDateTime));case r.SentByUser:return h("youSentOnDate",a(e.SharedDateTime));case r.FallbackValue:return void 0!==e.SecondaryText?e.SecondaryText:h("weFoundThisFile")}}},895463:(e,t,i)=>{var n;i.d(t,{j:()=>n}),function(e){e[e.none=0]="none",e[e.appearance=1]="appearance",e[e.highlight=2]="highlight",e[e.lineNavigation=4]="lineNavigation",e[e.cssHighlightsAPIAnnouncement=8]="cssHighlightsAPIAnnouncement"}(n||(n={}))},896761:(e,t,i)=>{i.d(t,{V:()=>E});var n=i(208520);if(0!=i.j)var s=i(576516);if(0!=i.j)var o=i(323283);if(0!=i.j)var r=i(599649);if(0!=i.j)var a=i(783900);if(0!=i.j)var l=i(647620);if(0!=i.j)var d=i(496174);if(0!=i.j)var c=i(2111);if(0!=i.j)var u=i(577059);if(0!=i.j)var g=i(525429);if(0!=i.j)var h=i(243879);if(0!=i.j)var p=i(175602);if(0!=i.j)var m=i(522775);if(0!=i.j)var f=i(115055);if(0!=i.j)var v=i(62876);if(0!=i.j)var y=i(180994);if(0!=i.j)var _=i(138552);if(0!=i.j)var I=i(822521);if(0!=i.j)var C=i(399795);if(0!=i.j)var S=i(499278);function b(e,t,i){var n;return i?i.message:null!==(n=null==e?void 0:e.customizedEmptyECCSuggestionsString)&&void 0!==n?n:t("suggestionsGroupNoSuggestionsText")}function T(e,t,i,n){const s={clearSearchLabel:t("clearSearchLabel"),showAvailableSuggestionsLabel:t("showAvailableSuggestionsLabel"),somethingWentWrongLabel:t("somethingWentWrongLabel"),tryAgainLabel:t("tryAgainLabel"),suggestionsGroupSearchResultAccessibilityLabel:t("suggestionsGroupSearchResultAccessibilityLabel"),combineSentences:t("combineSentences"),newTagText:t("newTagText"),discoveryPromoFooterText:t("discoveryPromoFooterText"),emailSentBy:t("emailSentBy"),feedbackText:t("feedbackText"),meetingSeries:t("meetingSeries"),recordText:t("recordText"),tabAriaLabel:t("allTabAriaLabel"),overflowTabAriaLabel:t("overflowTabAriaLabel"),expandedInlineSuggestionsSearchBarPlaceholder:t("expandedInlineSuggestionsSearchBarPlaceholder"),startTypingToSearch:t("startTypingToSearch"),moreButtonQuantityText:t("moreButtonQuantityText")},o={ignoreAll:i("ebx_ignoreAllButtonLabel"),ignoreOnce:i("ebx_ignoreOnceButtonLabel"),ignoreRule:i("ebx_disableCritiqueButton"),options:i("ebx_changeSettingsCommandLabel"),giveFeedbackButtonText:i("ebx_giveFeedback"),editorButtonTooltipContent:i("ebx_settingsButtonTooltip"),editorButtonText:i("editorButtonText"),footerSeeMoreActionsAccessibilityLabel:i("ebx_moreButtonArialLabel")},r={suggestionsGroupNoSuggestionsText:b(e,t,n)};return Object.assign(Object.assign({},function(){const e=Array(),t={};for(const i of e)t[i]=e=>"";return t}()),{inlineSuggestions:e=>s[e]||"",common:e=>r[e]||"",critique:e=>o[e]||""})}const E=e=>{var t,i,I,b,E,w,x,L,D,A,F,q,R,P,O,k,M,z,j,W;const B=n.useContext(v.O),U=(0,n.useContext)(f.D),H=(0,n.useContext)(v.b),{calloutProps:V,layerHostId:G,isRtl:Q,styles:K}=e,{calloutStrings:$,currentScope:J,enableExpandedECC:Z,enableScopedHeader:Y,expandedEccSearchBarConfig:X,getLocale:ee,expandedECCHeader:te,inlineSuggestionsStrings:ie,isDividerShown:ne,isFeedbackEnabled:se,isFeedbackButtonEnabled:oe,onFeedbackButtonClicked:re,isFlightEnabled:ae,isLoading:le,oaSettings:de,onGroupSelected:ce,onItemSelected:ue,onProcessedResults:ge,onUserInteraction:he,resultReset:pe,suggestions:me,style:fe,theme:ve,handleKeyDown:ye,triggerMethod:_e,appGptConfig:Ie,unsupportedEntities:Ce,removeComposingBoxQuery:Se}=V,be=V.searchBoxQueryString.length>0?V.searchBoxQueryString:V.queryString,Te=null==Ce?void 0:Ce.find((e=>e.entityType===(null==J?void 0:J.entityType))),Ee=null===(t=null==de?void 0:de.bestMatchConfig)||void 0===t?void 0:t.enabled,Ne=null==de?void 0:de.enablePrefixHighlighting,we=new Map,xe=n.useRef([]),Le=[],De=n.useRef(te),[Ae,Fe]=n.useState(null);Z&&(De.current=De.current.map((e=>{var t,i,n;return Object.assign(Object.assign({},e),{isSelected:!(null==J?void 0:J.entityType)&&!(null===(t=e.scopeInfo)||void 0===t?void 0:t.entityType)||(null==J?void 0:J.entityType)===(null===(i=e.scopeInfo)||void 0===i?void 0:i.entityType)||!J&&e.isSelected&&1===(null===(n=null==de?void 0:de.entitiesEnabled)||void 0===n?void 0:n.length)})})),De.current.length&&!De.current.some((e=>e.isSelected))&&(De.current=[Object.assign(Object.assign({},De.current[0]),{isSelected:!0}),...De.current.slice(1)]));let qe=!1;if(!le){const e=me.slice().sort(((e,t)=>{var i,n;return(null!==(i=e.priority)&&void 0!==i?i:0)-(null!==(n=t.priority)&&void 0!==n?n:0)}));let t;for(const n of e)for(const[,o]of n.entities.entries()){qe=qe||o.entityType===s.c.PIM;const r=Ee&&o.isBestMatch,a=r?"":null!==(i=n.groupTitle)&&void 0!==i?i:o.entityType===s.c.PIM?(0,c.X)(o.type,o.IntentId):(0,c.X)(o.type);if(o.icon&&(o.icon.iconName=(0,u.S)(o.icon.iconName)),o.entityType===s.c.People&&N(o,Q),o.entityType===s.c.Scope&&(null===(I=o.scopeInfo)||void 0===I?void 0:I.entityType)&&o.scopeInfo.entityType!==s.c.External&&(o.title=(0,c.X)(o.scopeInfo.entityType)),Ne&&!o.hitHighlightIndexes){const e=o[null!==(b=o.titleHitHighlightProperty)&&void 0!==b?b:"title"],t=o[null!==(E=o.subtitleHitHighlightProperty)&&void 0!==E?E:"subtitle"];o.hitHighlightIndexes=(0,g.J)([be],e,"title").concat(t?(0,g.J)([be],t,"subTitle"):[])}let l=we.get(a);if(!l)if(l=Object.assign(Object.assign(Object.assign({title:a,subtitle:n.groupSubtitle,suggestions:[]},(null==J?void 0:J.entityType)===e[0].entityType&&{isScoped:!0}),o.entityType===s.c.Scope&&{isScopingEnabled:!1,showSeparator:!0}),ne&&{showSeparator:!0}),we.set(a,l),r)Le.unshift(l);else if(n.entityType===s.c.Scope)t=l;else{if(J&&J.entityType!==n.entityType)continue;if(!J&&(null==Ce?void 0:Ce.some((e=>e.entityType===n.entityType))))continue;Le.push(l)}l.suggestions.push(o)}if(t&&Le.push(t),null==de?void 0:de.preventAllTabBackfill){const e=!J,t=(null===(w=Le[0])||void 0===w?void 0:w.suggestions.length)>0;Z&&e&&t&&Le.splice(1)}if(null==de?void 0:de.gptResultsLengthCap){"App"===(null===(x=Le[0])||void 0===x?void 0:x.title)&&(null===(L=Le[0])||void 0===L||L.suggestions.splice(de.gptResultsLengthCap))}Le.length&&(Le[0].showSeparator=!1),ge()}const Re=n.useCallback((()=>{he()}),[he]),Pe=n.useCallback((e=>{if(Ae){if(X&&_e!==h.P.AttachFile&&_e!==h.P.Fre){const t=Ae.querySelectorAll("input[type=search]")[0];0===(null==t?void 0:t.value.length)&&e.target===t&&setTimeout((()=>{t.value=be||""}),100)}if(!Z&&(0,p.mU)(e.target)&&"BUTTON"!==e.target.nodeName&&"INPUT"!==e.target.nodeName){e.preventDefault();const t=e.relatedTarget;null==t||t.focus()}}}),[Ae,Z,X,be,_e]),[Oe,ke]=n.useState(!1),[Me,ze]=n.useState(!1),je=n.useRef(!0);n.useEffect((()=>{if(!Ae)return;const e=Ae.ownerDocument,t=Ae.querySelectorAll("input[type=search]")[0],i=e.querySelectorAll('[data-ms-editor="true"]')[0];X&&t&&(_e===h.P.AttachFile||i&&e.activeElement===i)&&je.current&&(je.current=!1,_e===h.P.AttachFile||_e===h.P.Fre?null==Se||Se(""!==be):t.setAttribute("placeholder",""!==be?be:ie("expandedInlineSuggestionsSearchBarPlaceholder")))}),[Ae,X,ie,be,Se,_e]),n.useEffect((()=>{var e;if(!Ae)return;const t=null!==(e=Ae.ownerDocument.defaultView)&&void 0!==e?e:window;function i(){ke(t.matchMedia("(max-width: 480px)").matches),ze(t.matchMedia("(max-height: 480px)").matches)}i();const n=new o.J(t);n.addListener("resize",i);const s=Ae.closest(".ms-ecc-callout"),r=s&&new o.J(s);return null==r||r.addListener("keydown",ye),()=>{n.removeAllListeners(),null==r||r.removeAllListeners()}}),[Ae,ye]);const We=ae("mc-editor-expanded-ecc-responsive"),Be=ae("mc-editor-enable-meeting-banner");(pe||!le||Le.length)&&(xe.current=Y?(0,S.k)(Le):Le);const Ue=ie("managePersonalInfoLinkText"),He=ie("managePersonalInfoLinkUrl"),Ve=ie("meetingBannerText"),Ge=null!==(D=null==ee?void 0:ee())&&void 0!==D?D:"en-US",Qe={results:xe.current,queryString:be,onItemSelected:ue,onGroupSelected:ce,theme:ve,style:fe,styles:K,isError:V.isError,strings:T(de,ie,$,Te),onAction:V.onAction,isLoading:V.isLoading,keyboardHandlerTarget:Z?void 0:V.keyboardHandlerTarget,expandedKeyboardHandlerTarget:Z?V.keyboardHandlerTarget:void 0,menuType:V.menuType,onFooterAction:V.onFooterAction,enablePrefixHighlighting:Ne,showMoreEntitiesConfig:V.showMoreEntitiesConfig,browseThisComputerConfig:V.browseThisComputerConfig,layerHostId:G,showDiscoveryPromoFooter:null==de?void 0:de.enableDiscoveryPromoFooter,noSuggestionsHeaderInfo:V.noSuggestionsHeaderInfo,locale:Ge,appGptConfig:Ie,enableMeetingBanner:Be,showMeetingBanner:Be&&(null==J?void 0:J.entityType)===s.c.Event,meetingBannerText:Ve,isUnsupported:!!Te},Ke=n.useMemo((()=>(0,_.jI)()?"rtl":"ltr"),[]),$e=(0,C.Z)(V.menuParentElement,null!==(A=V.enableExpandedECC)&&void 0!==A&&A,V.accessibilitySettings),Je=null!==(q=null!==(F=e.fluentV9Theme)&&void 0!==F?F:U)&&void 0!==q?q:V.fluentTheme,Ze=(0,y.U)(Je,e.themeType,H);return n.createElement("div",{ref:Fe,onMouseEnter:Re,onFocus:Pe},Z?n.createElement(l.q,{theme:Ze,dir:Ke,id:"inline-suggestions-fluent-provider",style:H?{backgroundColor:Ze.colorNeutralBackground3}:void 0},n.createElement(r._,Object.assign({},Qe,{listID:"ms-ecc-expanded-inline-suggestions-results",scopes:{title:"",isScopingEnabled:!1,suggestions:De.current},useFURNTabList:B,onItemFocused:$e,disableTooltips:!0,isFeedbackEnabledForEcc:se,isFeedbackButtonEnabled:oe,onFeedbackButtonClicked:re,enableResponsiveLayout:We,isSmallWindow:We&&Oe,isSmallHeight:We&&Me,expandedEccSearchBarConfig:X}))):n.createElement(a.x,Object.assign({},Qe,{onFocus:$e,enableScopedHeader:Y,disableTooltips:null==de?void 0:de.disableInlineSuggestionTooltips})),qe?n.createElement("div",{style:{height:"32px",padding:"4px 12px"}},n.createElement("a",{href:He,target:"_blank",rel:"noreferrer","aria-label":Ue,style:{textDecoration:"unset",color:"#0078D4",fontSize:12,lineHeight:"16px"}},Ue)):null,n.createElement(d.b,{target:m.Y.inlineSuggestions,styles:{container:{borderRadius:{topStart:0,topEnd:0,bottomStart:null!==(P=null===(R=null==K?void 0:K.containerStyles)||void 0===R?void 0:R.borderRadius)&&void 0!==P?P:8,bottomEnd:null!==(k=null===(O=null==K?void 0:K.containerStyles)||void 0===O?void 0:O.borderRadius)&&void 0!==k?k:8},minWidth:null!==(z=null===(M=null==K?void 0:K.containerStyles)||void 0===M?void 0:M.minWidth)&&void 0!==z?z:300,maxWidth:null!==(W=null===(j=null==K?void 0:K.containerStyles)||void 0===j?void 0:j.maxWidth)&&void 0!==W?W:420}}}))};function N(e,t){e.initials=(0,I.I)(e.displayName,t)}},897253:(e,t,i)=>{i.d(t,{q:()=>y});var n=i(208520),s=i(252723),o=i(108520);if(0!=i.j)var r=i(897578);var a=i(341755);if(0!=i.j)var l=i(647620);var d=i(852748),c=i(184226),u=i(615930),g=i(163573),h=i(77127);if(0!=i.j)var p=i(867583);if(0!=i.j)var m=i(151421);if(0!=i.j)var f=i(728178);const v=(0,s.F5)({editorCanvasInjectableComponents:o.A.onAll(a.i).optional(),guidGenerator:o.A.on(d.G),languageScriptDirectionDetector:o.A.on(c.iw).optional(),targetWindowRef:o.A.on(u.sh),hostSettings:o.A.on(g.n),themeStore:o.A.on(h.YQ)}),y=()=>{const{editorCanvasInjectableComponents:e,guidGenerator:t,hostSettings:i,languageScriptDirectionDetector:o,targetWindowRef:a,themeStore:d}=(0,s.KN)(v),c=n.useRef(t.generate()),[u,g]=n.useState(null==o?void 0:o.uxLanguageDir),[y,_]=n.useState(d.getFluentActiveTheme());n.useEffect((()=>{if(o){const e=e=>{g(e.uxLanguageDir)};return o.subscribe("stateUpdated",e),()=>{o.unsubscribe("stateUpdated",e)}}return()=>{}}),[o]),n.useEffect((()=>{const e=()=>{_(d.getFluentActiveTheme())};return d.subscribe("currentThemeUpdated",e),d.subscribe("defaultThemeUpdated",e),d.subscribe("fluentThemesUpdated",e),()=>{d.unsubscribe("currentThemeUpdated",e),d.unsubscribe("defaultThemeUpdated",e),d.unsubscribe("fluentThemesUpdated",e)}}),[d]);const I=()=>{const t=null==e?void 0:e.map(((e,t)=>n.createElement(e,{key:"injectableComponent"+t})));return n.createElement(l.q,{theme:y},n.createElement(h.O1.Provider,{value:!!i.useFluentV9},n.createElement(m.Q,null,t)))},C=a.deref();return n.createElement("div",{dir:u,style:{all:"initial"}},n.createElement(f.IF,{window:null!=C?C:window},i.renderWithinShadowDOM||!i.useFluentV9&&i.renderWithinSeparateLayer?n.createElement(n.Fragment,null,n.createElement(p.U,{id:c.current,style:{position:"fixed",zIndex:null!==(S=i.editorCardZIndex)&&void 0!==S?S:1e6,inset:0,visibility:"hidden"}}),n.createElement(r.d.Provider,{value:c.current},I())):I()));var S}},897578:(e,t,i)=>{if(i.d(t,{U:()=>h,d:()=>u}),0!=i.j)var n=i(217626);var s=i(252723),o=i(108520),r=i(163573),a=i(184226),l=i(615930);if(0!=i.j)var d=i(579990);var c=i(208520);const u=c.createContext(void 0),g=(0,s.F5)({languageScriptDirectionDetector:o.A.on(a.iw).optional(),targetWindowRef:o.A.on(l.sh).optional(),hostSettings:o.A.on(r.n).optional()}),h=e=>{const{hostSettings:t,languageScriptDirectionDetector:i,targetWindowRef:o}=(0,s.SM)(g),r=c.useContext(u),a=null==o?void 0:o.deref();c.useEffect((()=>{var e;return null===(e=null==t?void 0:t.onCalloutOpened)||void 0===e||e.call(t,null,void 0,r),()=>{var e;null===(e=null==t?void 0:t.onCalloutClosed)||void 0===e||e.call(t,null,void 0,r)}}),[t,r,e.target,a]);const l={hostId:r,eventBubblingEnabled:!0};return c.createElement(n.P,Object.assign({dir:null==i?void 0:i.dir(),layerProps:l},e,{target:e.target,doNotLayer:!r&&e.doNotLayer}),void 0===i?e.children:c.createElement(d.K,{rtl:i.isRtl()},e.children))}},900045:(e,t,i)=>{i.d(t,{Y:()=>v});var n=i(379490),s=i(576516),o=i(537969),r=i(823325),a=i(39952),l=i(163573),d=i(877931),c=i(671303),u=i(857132),g=i(753031),h=i(203390),p=i(229906),m=i(66008),f=i(83010);let v=class{constructor(e,t,i,n,s,o){this._hostEmitters=e,this._hostSettings=t,this._logger=i,this._oaLogger=n,this._predictionStore=s,this._compositionEventHandler=o,this.onPredictionEvent=e=>{if(this.isDisabledOrComposing())return;if(!e.message.data.tileId)return void this._logger.log(510248457,g.q.Error,"IPrediction message: Received undefined args.");const t=e.message.data,i={eventType:e.message.messageType,tileId:t.tileId,tileVersion:t.tileVersion,prediction:t};this.onEvent(i)}}async initialize(){if(this._hostSettings.enableOrchestration)for(const e of this._hostEmitters)e.on(o.pD.predictionTriggered,this.onPredictionEvent)}shutDown(){}isDisabledOrComposing(){return!this._hostSettings.isTextPredictionEnabled||this._compositionEventHandler.isComposing}async onEvent(e){this.isDisabledOrComposing()||(e.eventType===r.G.NewData?(this._oaLogger.logActivity(h.$,{predictionText:e.prediction.entityType!==s.c.Text?e.prediction.entityType.toString():e.prediction.text,entityType:e.prediction.entityType,replacingExistingPrediction:void 0!==this._predictionStore.getCurrentPrediction()}),e.prediction.isFromAugLoop=!0,await this._predictionStore.updatePrediction(e.prediction)):await this._predictionStore.clearPrediction())}};v=(0,n.__decorate)([(0,p._)(),(0,n.__param)(0,(0,m.t)(o.zJ)),(0,n.__param)(1,(0,f.W)(l.n)),(0,n.__param)(2,(0,f.W)(d.g)),(0,n.__param)(3,(0,f.W)(c.m)),(0,n.__param)(4,(0,f.W)(u.o)),(0,n.__param)(5,(0,f.W)(a.q))],v)},901163:(e,t,i)=>{i.d(t,{M:()=>l});var n=i(713792),s=i(786132),o=i(323283);const r="createUndoCheckpoint",a=(e,t)=>new Promise((i=>t.requestAnimationFrame(i,e)));class l extends n.e{get targetWindow(){return this.element?(0,s.e)(this.element):window}constructor(e,t,i){super(),this.textNodeRangeBuilder=e,this._safeWindow=t,this._logger=i,this._textInterceptionMaxTimeoutMs=2e3,this._keysCache="",this._disposed=!1,this.documentKeyboardEventHandler=e=>("keydown"!==e.type||1!==e.key.length||e.altKey||e.ctrlKey||e.metaKey||(this._keysCache+=e.key),e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),this.inputInterceptionTimeoutHandler=e=>{this._logger&&this._logger.warn(507248854,`Input interception is shutting down on timeout after ${this._textInterceptionMaxTimeoutMs}ms`),this.stopInputInterception(e)},this.getRange=async(e,t)=>{if(this.element&&this.ownerDocument)return this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)},this.selectRange=(e,t)=>{const i=e.getSelection();if(!i)return;const n=[];for(let e=0;e<i.rangeCount;e++)n.push(i.getRangeAt(e));return i.removeAllRanges(),i.addRange(t),i.setBaseAndExtent(t.startContainer,t.startOffset,t.endContainer,t.endOffset),n},this.selectRanges=(e,t)=>{const i=e.getSelection();if(!i)return!1;if(i.removeAllRanges(),t)for(const e of t)i.addRange(e);return!0},this.focusElementAndPrepareRange=async(e,t,i,n)=>(i.focus(),this.prepareRange(e,t,n)),this.prepareRange=async(e,t,i)=>(await a(this.targetWindow,this._safeWindow),!i||i.collapsed?this.getRange(e,t):i)}get disposed(){return this._disposed}async dispose(){var e;this.stopInputInterception(null!==(e=this.ownerDocument)&&void 0!==e?e:this.targetWindow.document),this._disposed=!0}async insert(e,t,i,n,s,o=!0){if(!this.element||!this.ownerDocument)return;const r=this.ownerDocument;o&&await a(this.targetWindow,this._safeWindow);let l=n;if(l||(l=await this.textNodeRangeBuilder.getNodeInsertionPosition(this.element,e,i)),l){const e=this.selectRange(r,l);await this.doReplacement(r,t),s&&this.selectRanges(r,e)}}async replace(e,t,i,n){if(!this.element||!this.ownerDocument)return;const{ownerDocument:s,element:o}=this,r=await this.focusElementAndPrepareRange(e,t,o,n);r&&(this.selectRange(s,r),await this.doReplacement(s,i))}async remove(e,t,i,n,s=!0,o){if(!this.element||!this.ownerDocument)return;const{ownerDocument:r}=this;s&&await a(this.targetWindow,this._safeWindow);let l=i;if(l&&!l.collapsed||(l=await this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t)),l){o&&this.textNodeRangeBuilder.includePrecedingSpace(this.element,l);const i=this.selectRange(r,l);await this.doRemoval(r,(async()=>this.textNodeRangeBuilder.getRangeOfNode(this.element,e,t))),n&&this.selectRanges(r,i)}return l}async autoCorrect(e,t,i,n,s){if(!this.element||!this.ownerDocument)return;let o,r=null;r=this.ownerDocument.getSelection(),r&&r.rangeCount>0&&(o={node:r.focusNode,offset:r.focusOffset}),s&&(this.startInputInterception(this.ownerDocument),this._interceptStartTime=Date.now(),this._logger&&this._logger.debug(507248859,`Starting text input interception ${this._interceptStartTime}`));let a=0;const l=this.ownerDocument;try{const s=await this.prepareRange(e,t,n);if(s){const e=s.toString();return this.selectRange(l,s),await this.doReplacement(l,i),a=i.length-t,e}}catch(e){throw s&&this._logger&&this._logger.error(507248858,"An error occurred during the auto correction text replacement while text interception is ON",e),e}finally{await this.restoreTextAndPosition(l,a,r,o,s)}}async restoreTextAndPosition(e,t,i,n,s){try{i&&n&&this.restorePosition(i,t,n)}catch(e){throw s&&this._logger&&this._logger.error(507248857,"An error occurred while trying to restore the cursor position after the auto correction and text interception is ON",e),e}finally{s&&await this.restoreText(e)}}restorePosition(e,t,i){var n,s,o;const r=i.offset+t,a=null!==(o=null===(s=null===(n=i.node)||void 0===n?void 0:n.textContent)||void 0===s?void 0:s.length)&&void 0!==o?o:r,l=Math.min(a,r);e.removeAllRanges(),e.setPosition(i.node,l)}async restoreText(e){try{await this.doReplacement(e,this._keysCache)}catch(e){throw this._logger&&this._logger.error(507248856,"An error occurred while trying to restore the cached text after the auto correction.",e),e}finally{if(this.stopInputInterception(e),this._interceptStartTime){const e=Date.now()-this._interceptStartTime;this._logger&&this._logger.debug(507248855,`Stop text input interception. Time take ${e} ms.`),this._interceptStartTime=void 0}}}startInputInterception(e){var t;this._keysCache="",this._textInterceptionTimeout=this.targetWindow.setTimeout((()=>this.inputInterceptionTimeoutHandler(e)),this._textInterceptionMaxTimeoutMs),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=new o.J(e),this._textInterceptionEventListener.addListener("keyup",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keydown",this.documentKeyboardEventHandler,{capture:!0}),this._textInterceptionEventListener.addListener("keypress",this.documentKeyboardEventHandler,{capture:!0})}stopInputInterception(e){var t;this._textInterceptionTimeout&&(this.targetWindow.clearTimeout(this._textInterceptionTimeout),this._textInterceptionTimeout=void 0),null===(t=this._textInterceptionEventListener)||void 0===t||t.removeAllListeners(),this._textInterceptionEventListener=void 0,this._keysCache=""}doReplacement(e,t){const i=new Event(r);return e.dispatchEvent(i),this.innerDoReplacement(e,t),e.dispatchEvent(i),Promise.resolve()}async doRemoval(e,t){const i=new Event(r);e.dispatchEvent(i),await this.innerDoRemoval(e,t),e.dispatchEvent(i)}innerDoReplacement(e,t){e.execCommand("insertText",!1,t),this.dispatchInputEvent()}async innerDoRemoval(e,t){var i,n,s,o;const r=e.getSelection();if(r&&r.anchorNode===r.focusNode&&(null===(i=r.anchorNode)||void 0===i?void 0:i.textContent)){const i=r.anchorNode,a=null===(n=i.textContent)||void 0===n?void 0:n.length;e.execCommand("delete",!1),i.isConnected&&(null===(s=i.textContent)||void 0===s?void 0:s.length)===a&&(null===(o=await t())||void 0===o||o.deleteContents())}else e.execCommand("delete",!1);this.dispatchInputEvent()}}},904196:(e,t,i)=>{i.d(t,{n:()=>o});var n,s=i(668952);!function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email",e[e.EditorLandingPage=3]="EditorLandingPage"}(n||(n={}));const o=(0,s.f)("IHostSettings")},904923:(e,t,i)=>{i.d(t,{o:()=>S});var n=i(379490),s=i(700509),o=i(260566),r=i(753031),a=i(46692),l=i(852748),d=i(326323),c=i(496814),u=i(226331),g=i(383714),h=i(304274),p=i(404983),m=i(229906),f=i(83010),v=i(838641),y=i(245645),_=i(439550);function I(e){const t={value:JSON.stringify(e),lastUpdated:Date.now(),manualOverride:!1};return JSON.stringify(t)}function C(e){return{descriptors:I(e.descriptors),disabledWebSites:I(e.disabledWebSites),allowedUrls:I(e.allowedUrls),disabledGrammars:I(e.disabledGrammars),editorClientState:I(e.editorClientState),configurationId:I(e.configurationId),featureFlags:I(e.featureFlags),dynamicSettings:I(e.dynamicSettings),intervalForActivityCleanup:I(e.intervalForActivityCleanup),conflictingElements:I(e.conflictingElements)}}let S=class extends y.b{constructor(e,t,i,n,s,o,r,a){super(e),this._editorService=t,this._proofingStore=i,this._logger=n,this._userInfoStrategy=s,this._sessionContextProvider=o,this._guidGenerator=r,this._timer=a,this._timerName="RemoteSettingsSyncerTimer"}async initialize(){}shutDown(){this._timer.clearTimer(this._timerName)}schedule(e,t){this._timer.setIntervalWithDelay(this._timerName,(async()=>this.sync()),t,e)}async sync(){this._logger.debug(537518984,"Starting remote settings sync");const e=await this.buildRequest();if(e){const t=await this.fetchRemoteSettings(e);if(t&&t.responseStatus===s.ED.Success){this.logTelemetry(e);const i=C(t),n=await this.removeManualOverrides(i);if(n)return this._logger.debug(537518985,"Writing remote settings to local storage"),this.writeSettings(n)}}return this._logger.debug(537518986,"No remote settings were synced"),!1}async writeSettings(e){try{return await this._extensionStorage.set(e),!0}catch(e){this._logger.logEvent(537518987,v.s.SettingsSyncWriteError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}return!1}async fetchClientId(){try{const e=await this._proofingStore.read(c.l.ClientId);if(!e||""===e){const e=this._guidGenerator.generate();return await this._proofingStore.write(c.l.ClientId,e),e}return e}catch(e){return""}}async buildRequest(){var e;try{const t=await this._sessionContextProvider();let i,n;const s=await this.fetchClientId(),o=await this._userInfoStrategy.executeAsync(!1);(null==o?void 0:o.userId)?(this._editorService.xUserId=o.userId,i=o.tenantId,n=o.email):this._editorService.xUserId=s;return{appId:await this._proofingStore.read(c.l.AppId),browser:t.browserType,browserVersion:null!==(e=t.browserVersion)&&void 0!==e?e:"",email:n,extensionId:t.extensionVersion,languageUxId:t.languageUxId,storeId:t.extensionStoreId,tenantId:i,firstInstallVersion:void 0}}catch(e){this._logger.logEvent(537518988,v.s.SettingsSyncEditorRequestBuildError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}logTelemetry(e){if(this._lastConfigRequestUserId&&this._lastConfigRequestUserId===this._editorService.xUserId&&this._lastConfigRequest&&this._lastConfigRequest.browserVersion===e.browserVersion&&this._lastConfigRequest.email===e.email&&this._lastConfigRequest.languageUxId===e.languageUxId&&this._lastConfigRequest.tenantId===e.tenantId)return;this._lastConfigRequest=e,this._lastConfigRequestUserId=this._editorService.xUserId;const t=this._logger.getNewActivity(v.M.RemoteSettingSync,a.o.SamplingPolicy.CriticalExperimentation);t&&(t.success=!0,t.endNow())}async fetchRemoteSettings(e){var t;try{return await this._editorService.browserextension(e,{requestOptions:{customHeaders:{"X-UserId":null!==(t=this._editorService.xUserId)&&void 0!==t?t:""}}})}catch(e){this._logger.logEvent(537518989,v.s.SettingsSyncEditorServiceError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),this.setLastError(e)}}async removeManualOverrides(e){const t={};try{const i=await this._extensionStorage.get(e);for(const n of Object.keys(i)){JSON.parse(i[n]).manualOverride?this._logger.debug(537518990,"Manual override for remote setting",n):t[n]=e[n]}}catch(e){return this._logger.logEvent(537518991,v.s.SettingsSyncReadOverrideError,r.q.Error,void 0,a.o.SamplingPolicy.CriticalBusinessImpact,e),void this.setLastError(e)}return t}async removePersistentKeys(){const e=Object.keys(C({}));e.length&&await this._extensionStorage.remove(e)}};S=(0,n.__decorate)([(0,m._)(),(0,n.__param)(0,(0,f.W)(_.D)),(0,n.__param)(1,(0,f.W)(o.qq)),(0,n.__param)(2,(0,f.W)(u.K)),(0,n.__param)(3,(0,f.W)(g.g)),(0,n.__param)(4,(0,f.W)(h.e)),(0,n.__param)(5,(0,f.W)(p.a)),(0,n.__param)(6,(0,f.W)(l.G)),(0,n.__param)(7,(0,f.W)(d.J))],S)},906686:(e,t,i)=>{i.d(t,{z:()=>a});var n=i(208520);if(0!=i.j)var s=i(323283);if(0!=i.j)var o=i(924083);if(0!=i.j)var r=i(838145);const a=e=>{const{anchor:t,isCalloutOpened:i,disableCalloutOnDoubleClick:a,element:l,isCaretOver:d,isMouseOver:c,handleContextMenuEvent:u,onClick:g,onEscapePress:h,onKeyboardEvent:p,closeCalloutOnNonLeftClick:m,onRightClickEvent:f,openCalloutPredicate:v}=e,y=e=>(e.preventDefault(),e.stopImmediatePropagation(),e.stopPropagation(),!1),_=n.useRef(null),I=()=>{var e;const t=(null!==(e=l.ownerDocument.defaultView)&&void 0!==e?e:window).getSelection();return!(!t||t.focusNode!==t.anchorNode||t.focusOffset!==t.anchorOffset)};return n.useEffect((()=>{var n;const r=t=>{var n;null===(n=e.onContextMenuClick)||void 0===n||n.call(e),u&&(c||d)&&!i&&I()&&(y(t),null==f||f())},h=e=>{c&&!i&&I()&&(null==g||g())},p=e=>{i&&(e.button===o.c.MainButtonPressed||u||null==m||m())};if(a){const e=null!==(n=l.ownerDocument.defaultView)&&void 0!==n?n:window,i=t=>{const i=t;i.button===o.c.MainButtonPressed?1===i.detail&&(_.current=e.setTimeout(h,200)):null==m||m()},a=()=>{_.current&&(e.clearTimeout(_.current),_.current=null)},d=e=>a(),c=new s.J(t);return c.addListener("contextmenu",r),c.addListener("click",i),c.addListener("dblclick",d),c.addListener("mouseup",p),()=>{c.removeAllListeners(),a()}}{const e=new s.J(t);return e.addListener("contextmenu",r),e.addListener("click",h),e.addListener("mouseup",p),()=>{e.removeAllListeners()}}}),[t,a,l,m,c,i,g]),n.useEffect((()=>{if(d||c||i){const e=(0,r.a)(t),n=new s.J(e),o=e=>{const t=e;d&&!i&&(null==v?void 0:v(t))?"keyup"===t.type?(null==p||p(),t.preventDefault()):y(e):"Escape"===t.key&&"keyup"===t.type&&(null==h||h())};return n.addListener("keyup",o,{capture:!0}),i||(n.addListener("focus",y),n.addListener("blur",y),n.addListener("keydown",o,{capture:!0})),()=>{n.removeAllListeners()}}}),[c,d,i,t,v,p,h]),null}},907142:(e,t,i)=>{i.d(t,{r:()=>d});var n=i(379490),s=i(229906),o=i(83010),r=i(738550),a=i(818955),l=i(436672);let d=class extends l.t{constructor(e){super(e)}checkUserInfo(){return this._expiry?Date.now()<=this._expiry:this.licenseType===r.G_.Subscription}setGracePeriodUntil(e){this._expiry=e}};d=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(a.e))],d)},907212:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":"The goal of these suggestions is to express an idea clearly, without extra words."},"Conciseness":{"IsImplemented":true,"LocalizedName":"Conciseness"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Consistent Written Forms"},"Sentence Inspire Me":{"LocalizedName":"Different phrasing","IsImplemented":false},"Fluency":{"LocalizedName":"Improves flow","IsImplemented":false},"Uncommon Words":{"LocalizedName":"Uncommon Words","IsImplemented":true},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"Inclusiveness"},"Typing errors":{"IsImplemented":false,"LocalizedName":"Typing Errors"},"Clarity":{"LocalizedName":"Clarity","IsImplemented":true},"Simpler Language":{"IsImplemented":false,"LocalizedName":"Improves readability"},"Inspire Me":{"IsImplemented":false,"LocalizedName":"Different phrasing"},"Acronyms":{"IsImplemented":true,"LocalizedName":"Acronyms"},"Rewrite":{"LocalizedName":"Rewrite","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Error Corrections"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions help make your writing more formal by reducing casual wording."},"Vocabulary":{"IsImplemented":true,"LocalizedName":"Vocabulary"},"Grammar":{"IsImplemented":true,"LocalizedName":"Grammar"},"SimplerFullExplanation":{"LocalizedName":"The goal of these suggestions is to make the writing easier to read for people with different reading abilities. In general, suggestions will include shorter, simpler wording.","IsImplemented":false},"Perspectives":{"IsImplemented":true,"LocalizedName":"Perspectives"},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions aim to improve the flow of the wording, including mechanics like grammar and spelling."},"Formality":{"LocalizedName":"Formality","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":"These suggestions provide alternative ways of wording a phrase or sentence."},"Punctuation Conventions":{"IsImplemented":true,"LocalizedName":"Punctuation Conventions"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":"More concise"},"RewriteFormality":{"IsImplemented":false,"LocalizedName":"More formal"},"Writing Conventions":{"LocalizedName":"Writing Conventions","IsImplemented":false},"Spelling":{"LocalizedName":"Spelling","IsImplemented":true},"Resume":{"IsImplemented":true,"LocalizedName":"Resume"},"Sensitive Geopolitical References":{"LocalizedName":"Sensitive Geopolitical References","IsImplemented":true}}')},909113:(e,t,i)=>{function n(e,t){let i,n,o={firstDiffLeft:0,firstDiffRight:t.length};e.length<t.length?(i=e,n=t):(i=t,n=e),i=i.replace(" "," "),n=n.replace(" "," "),n.startsWith(i)?(o.firstDiffLeft=i.length,o.firstDiffRight=0):n.endsWith(i)?(o.firstDiffLeft=0,o.firstDiffRight=i.length):(o=function(e,t){const i={firstDiffLeft:0,firstDiffRight:t.length};return i.firstDiffLeft=s(e,t,!0),i.firstDiffRight=s(e,t,!1),i}(e,t),o.firstDiffLeft+o.firstDiffRight>i.length&&(o.firstDiffRight=i.length-o.firstDiffLeft)),function(e,t,i){if(e.firstDiffLeft>0){const n=e.firstDiffLeft<t.length&&u(t,e.firstDiffLeft),s=e.firstDiffLeft<i.length&&u(i,e.firstDiffLeft);(n||s)&&(e.firstDiffLeft-=1)}if(e.firstDiffRight<=1)return;const n=e.firstDiffRight<t.length&&u(t,t.length-e.firstDiffRight),s=e.firstDiffRight<i.length&&u(i,i.length-e.firstDiffRight);(n||s)&&(e.firstDiffRight-=1)}(o,e,t);o.firstDiffLeft<e.length&&u(e,o.firstDiffLeft)||o.firstDiffLeft<t.length&&u(t,o.firstDiffLeft),o.firstDiffRight>0&&(o.firstDiffRight<e.length&&u(e,e.length-o.firstDiffRight)||o.firstDiffRight<t.length&&u(t,t.length-o.firstDiffRight));return o}function s(e,t,i){let n;for(n=0;n<e.length&&n<t.length;n+=1){const s=e.charCodeAt(i?n:e.length-n-1),o=t.charCodeAt(i?n:t.length-n-1);if(s!==o&&!(l(s,!0)&&l(o,!0)||c(s)&&c(o)))break}return n}let o;function r(e){try{return o||(o=new RegExp("[\\p{Extended_Pictographic}\\u{1F3FB}-\\u{1F3FF}\\u{1F9B0}-\\u{1F9B3}]","u")),o.test(e)}catch(e){return!1}}function a(e){return!!e&&/[\u0E81-\u0EDF\u0f00-\u0FFF\u1000-\u109F\u1780-\u17F9\u1980-\u19DF\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\u0E00-\u0E7F\uff66-\uff9f]/g.test(e)}function l(e,t=!1){if(c(e))return!t;if(d(e))return!0;switch(e){case 11:case 9:return!0}return!1}function d(e){switch(e){case 12288:case 8194:case 8195:case 8197:case 32:case 160:return!0}return!1}function c(e){switch(e){case 13:case 10:case 65532:return!0}return!1}function u(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343}i.d(t,{CC:()=>n,Fc:()=>h,Yv:()=>l,_1:()=>r,tF:()=>a,xC:()=>d});const g="0123456789";function h(e){return function(e){const t=e.toString();return t.toLowerCase()!==t.toUpperCase()}(e)||function(e){return g.includes(e)}(e)}},918770:(e,t,i)=>{i.d(t,{n:()=>m});var n=i(379490),s=i(105244),o=i(609062),r=i(233653),a=i(442316),l=i(335009),d=i(538045),c=i(355495),u=i(823325),g=i(118673),h=i(229906),p=i(83010);let m=class{constructor(e,t,i,n,o){this._proofingStore=e,this._emitter=t,this.nodePoller=i,this.proofingDom=n,this._logger=o,this._proofingLanguages=new c.z(this._proofingStore.getDefaultValue(s.l.ProofingLanguages))}async initialize(){this._proofingLanguages=new c.z(await this._proofingStore.read(s.l.ProofingLanguages)),this._emitter.on("proofingLanguageChanged",(async e=>{this.switchProofingLanguage(e.data)}))}shutDown(){}switchProofingLanguage(e){this._proofingLanguages.equalsTo(e.codesList)||(this._proofingLanguages=e,this._logger.debug(536978383,`Proofing languages list switched to ${e.codesList}`),this.proofingDom.tileNodes.map((e=>e.resetState())),this.nodePoller.pollNodes(u.G.NewData,this.proofingDom.tileNodes,o.Q0.Code,void 0,!0))}};m=(0,n.__decorate)([(0,h._)(),(0,n.__param)(0,(0,p.W)(r.K)),(0,n.__param)(1,(0,p.W)(g.o)),(0,n.__param)(2,(0,p.W)(l.G)),(0,n.__param)(3,(0,p.W)(d.w)),(0,n.__param)(4,(0,p.W)(a.g))],m)},920117:(e,t,i)=>{var n;i.d(t,{l:()=>n}),function(e){e.AppId="appId",e.EnableCopilotInsert="enableCopilotInsert",e.EnableCopilotRewrite="enableCopilotRewrite",e.EnableSpelling="enableSpelling",e.EnableGrammar="enableGrammar",e.EnableRefinements="enableRefinements",e.EnableSynonymsToggle="enableSynonymsToggle",e.Descriptors="descriptors",e.ProofingLanguages="proofingLanguages",e.DefaultProofingLanguageInitialized="defaultProofingLanguageInitialized",e.ProofingLanguageListInitialized="proofingLanguageListInitialized",e.HashedUserDictionary="hashedUserDictionary",e.EnableEditor="enableEditor",e.OverriddenCritiqueTypeOptions="overriddenCritiqueTypeOptions",e.OverriddenInlineEditingSettings="overriddenInlineEditingSettings",e.PaneOverriddenCritiqueTypeOptions="paneOverriddenCritiqueTypeOptions",e.StealthOverriddenCritiqueTypeOptions="stealthOverriddenCritiqueTypeOptions",e.ShowSynonyms="showSynonyms",e.DefaultLoggingLevel="defaultLoggingLevel",e.DebugMode="debugMode",e.EnableTelemetry="enableTelemetry",e.ConfigurationId="configurationId",e.ClientId="clientId",e.CritiqueValuePerLanguage="critiqueValuePerLanguage",e.EnableTextPrediction="enableTextPrediction",e.EnableCIQFlags="enableCIQFlags",e.EnableCIQMenu="enableCIQMenu",e.IsLanguageAutoDetectEnabled="isLanguageAutoDetectEnabled",e.TonalFREAccepted="tonalFREAccepted"}(n||(n={}))},921976:(e,t,i)=>{if(i.d(t,{C:()=>r}),0!=i.j)var n=i(753031);var s=i(758651);const o=(e,t,i,n)=>{const s={eventName:e,tagID:`0x${`00000000${t.toString(16)}`.slice(-8)}`,message:i,data:n};return JSON.stringify(s)};class r{async initialize(){}addCorrelationID(e){s.log(`CorrelationID is: ${e}`)}log(e,t,i,n){this.dispatchLog(null,e,t,i,n)}debug(e,t,i){this.dispatchLog(null,e,n.q.Debug,t,i)}error(e,t,i){this.dispatchLog(null,e,n.q.Error,t,i)}warn(e,t,i){this.dispatchLog(null,e,n.q.Warn,t,i)}info(e,t,i){this.dispatchLog(null,e,n.q.Info,t,i)}logEvent(e,t,i,n,s,o){this.dispatchLog(t,e,i,n,o)}dispatchLog(e,t,i,r,a){switch(i){case n.q.Debug:s.log(o(e,t,r,a));break;case n.q.Error:s.error(o(e,t,r,a));break;case n.q.Info:s.info(o(e,t,r,a));break;case n.q.Warn:s.warn(o(e,t,r,a));break;default:throw new Error("Invalid logging level")}}getNewActivity(e,t,i){s.log(e)}}},922630:(e,t,i)=>{i.d(t,{n:()=>o});var n,s=i(668952);!function(e){e[e.Extension=0]="Extension",e[e.OWA_New_Email=1]="OWA_New_Email",e[e.OWA_Draft_Email=2]="OWA_Draft_Email",e[e.EditorLandingPage=3]="EditorLandingPage"}(n||(n={}));const o=(0,s.f)("IHostSettings")},923256:(e,t,i)=>{if(i.d(t,{g:()=>s}),0!=i.j)var n=i(800737);function s(e,t){return!!e.enableCSSHighlightApiSquiggleRendering&&void 0!==(0,n.b)(t)}},923277:(e,t,i)=>{if(i.d(t,{r:()=>f}),0!=i.j)var n=i(294890);if(0!=i.j)var s=i(993584);if(0!=i.j)var o=i(997601);if(0!=i.j)var r=i(192590);if(0!=i.j)var a=i(868038);if(0!=i.j)var l=i(370666);if(0!=i.j)var d=i(166137);if(0!=i.j)var c=i(955377);if(0!=i.j)var u=i(287364);if(0!=i.j)var g=i(584223);if(0!=i.j)var h=i(251439);if(0!=i.j)var p=i(386675);if(0!=i.j)var m=i(61176);class f{constructor(){this.imports=[n.v]}get uniqueId(){return(0,h.z)(507918354)}configureRootServices(e){e.bind(d.g).toDynamicValue((e=>()=>e.getOptional(d.M))),e.bind(p.S).to(s.l),e.bind(o.a).to(r.R),e.bind(c.W).to(u.p),e.bind(g.n).to(l.I),e.bind(a.s).to(a.$),e.bind(p.S).to(m.B)}}},924083:(e,t,i)=>{i.d(t,{c:()=>n,v:()=>s});const n={MainButtonPressed:0,AuxiliaryButtonPressed:1,SecondaryButtonPressed:2,FourthButton:3,FifthButton:4},s={MainButtonPressed:n.MainButtonPressed,SecondaryButtonPressed:n.SecondaryButtonPressed,Hover:100}},927154:(e,t,i)=>{var n;i.d(t,{_:()=>n}),function(e){e[e.Remote=0]="Remote",e[e.System=1]="System",e[e.User=2]="User"}(n||(n={}))},928452:(e,t,i)=>{i.d(t,{Y:()=>r,h:()=>a});var n=i(379490),s=i(668952),o=i(229906);const r=(0,s.f)("INudgeStore");let a=class{constructor(){this.updateNudge=async e=>{this._currentNudge=e,this._onUpdate&&await this._onUpdate()},this.clearNudge=async()=>{this._currentNudge=void 0,this._onUpdate&&await this._onUpdate()},this.getCurrentNudge=()=>this._currentNudge,this.setOnUpdatedNudge=e=>{this._onUpdate=e}}};a=(0,n.__decorate)([(0,o._)()],a)},929240:(e,t,i)=>{i.d(t,{D:()=>O});var n=i(379490),s=i(630501),o=i(797214),r=i(829088),a=i(877931),l=i(150099),d=i(163573),c=i(427405);class u{constructor(e,t,i,n,s,o,r){this.hostSettings=e,this.calloutStateStore=t,this.undoCalloutStateStore=i,this.squiggleTooltipStateStore=n,this.critiqueStore=r,this.squigglerFlagCritiqueHandler=new c.G(t,s,i,o)}hideCallout(){var e;this.calloutStateStore.isVisible&&!this.calloutStateStore.isApplyingCritiqueAction&&(this.calloutStateStore.recordInstrumentationEventId(12),this.calloutStateStore.hide()),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide()}async showCallout(e){var t,i,n,s;null===(t=this.squiggleTooltipStateStore)||void 0===t||t.hide();const r=null===(i=this.critiqueStore)||void 0===i?void 0:i.getCritique(e.critique.traceId,e.critique.nodeId),a=Object.assign(Object.assign({},e),{critique:r?(0,o.OE)(r):e.critique});if(!(null===(s=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.squigglerSettings)||void 0===s?void 0:s.onSquiggleClicked)||this.hostSettings.serviceSettings.squigglerSettings.onSquiggleClicked(a.critique))if((0,o.r3)(a.critique))await this.squigglerFlagCritiqueHandler.showFlagCritique(a);else{if(this.undoCalloutStateStore&&"autocorrection"===e.squiggleKind)return this.undoCalloutStateStore.show(a);await this.calloutStateStore.show(a)}}}class g{constructor(e,t,i,n){this.squiggleTooltipStateStore=e,this.calloutStateStore=t,this.undoCalloutStateStore=i,this.hostSettings=n}showTooltip(e){var t,i,n,s,o;const{squiggleKind:r,critique:a,position:l,origin:d,targetDocument:c}=e;if(!(null===(t=this.calloutStateStore)||void 0===t?void 0:t.isVisible)&&!(null===(i=this.undoCalloutStateStore)||void 0===i?void 0:i.isVisible)){if(!d&&!(null===(n=this.hostSettings)||void 0===n?void 0:n.enableCSSHighlightApiSquiggleRendering))return;(null===(s=this.squiggleTooltipStateStore)||void 0===s?void 0:s.isVisible)&&this.squiggleTooltipStateStore.hide(),null===(o=this.squiggleTooltipStateStore)||void 0===o||o.show(r,a,l,d,c)}}hideTooltip(){var e;null===(e=this.squiggleTooltipStateStore)||void 0===e||e.hide()}}var h=i(248401),p=i(74372),m=i(61971),f=i(395109),v=i(584223),y=i(243879),_=i(961147),I=i(138697),C=i(668952);const S=(0,C.f)("ICritiqueCardNativeApi");(0,C.f)("IECCNativeApi");var b=i(279e3),T=i(823325),E=i(786132),N=i(118673),w=i(852748),x=i(1144),L=i(551268),D=i(538045),A=i(104072),F=i(229906),q=i(83010),R=i(427603),P=i(419728);let O=class extends s.z{constructor(e,t,i,n,s,a,l,d,c,h,p,m,f,v,y,_,I,C){super(),this.proofingEventListener=e,this.squigglerStateStoreFactory=t,this.inputControlsStateStoreFactory=i,this.calloutStateStore=n,this.settings=s,this.guidGenerator=a,this.squiggleTooltipStateStore=l,this._logger=d,this.critiqueApplicationHandler=c,this.proofingDom=h,this.safeWindow=p,this.tileContent=m,this.hostSettings=f,this.inlineSuggestionsRenderer=v,this.squigglePositioningEdgeCases=y,this.undoCalloutStateStore=_,this.nativeApi=I,this.critiqueStore=C,this.anchorElements=new Map,this.squigglers=new Map,this.visible=!0,this.tileVisibility=new Map,this.inputControlsProxyList=[],this._inputControlsProxyListCache=[],this.setVisibility=e=>{this.visible=e,this.publishStateChange()},this.setVisibilityForTile=(e,t)=>{var i,n,s,o,r,a,l,d;if(this.tileVisibility.set(e,t),!t){e===(null===(n=null===(i=this.inlineSuggestionsRenderer)||void 0===i?void 0:i.getCurrentMenuInfo())||void 0===n?void 0:n.parentTileId)&&this.inlineSuggestionsRenderer.dismissMenu();const t=null===(s=this.calloutStateStore.critique)||void 0===s?void 0:s.nodeId,c=this.proofingDom.findParagraphNode(null!=t?t:"");e===(null===(o=null==c?void 0:c.parent)||void 0===o?void 0:o.id)&&this.calloutStateStore.hide();const u=null===(a=null===(r=this.undoCalloutStateStore)||void 0===r?void 0:r.critique)||void 0===a?void 0:a.nodeId,g=this.proofingDom.findParagraphNode(null!=u?u:"");e===(null===(l=null==g?void 0:g.parent)||void 0===l?void 0:l.id)&&(null===(d=this.undoCalloutStateStore)||void 0===d||d.hide())}this.publishStateChange()},this.getTileVisibility=e=>{var t;return null===(t=this.tileVisibility.get(e))||void 0===t||t},this.getSquigglerForTile=e=>{const t=this.anchorElements.get(e);return t?this.squigglers.get(t.id):void 0},this.getCritiqueCount=e=>{var t;return!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null!==(t=null==e?void 0:e.getCritiques().length)&&void 0!==t?t:0},this.update=e=>(!e&&this.squigglers.size>0&&(e=this.squigglers.values().next().value),null==e?void 0:e.updateSquiggles()),this.updateSquiggleRanges=e=>{if(e)return void e.updateRanges();if(0===this.squigglers.size)return;const t=new Set(this.squigglers.values());for(const e of t)e.updateRanges()},this.navigate=(e,t)=>{!t&&this.squigglers.size>0&&(t=Array.from(this.squigglers.values())),t&&(this.calloutStateStore.setNavInfo({stores:t,ctr:"contenteditable",currentIndex:0,category:"category",onCloseNavigation:()=>{e()},onNavSuggestionApplied:()=>{this.calloutStateStore.navigate(0)}}),this.calloutStateStore.navigate(0))},this.clearSquiggles=(e,t,i)=>{1===e.proofedElements.length&&e.proofedElements[0].id===t?(this.anchorElements.delete(t),this.squigglers.delete(i),this.publishStateChange(),e.dispose()):e.removeCritiques(t).then((()=>{e.isEmpty&&(this.squigglers.delete(i),this.anchorElements.delete(t),e.dispose()),this.publishStateChange()}))},this.displayFlag=async e=>{const t={critique:e,issueText:"",setInitialFocus:!1,onDismiss(e){},onIgnoreOnce:this.onIgnoreOnce,onIgnoreAll:this.onIgnoreAll,onApplyFlag:this.onApplyFlag};await this.critiqueCalloutHandler.showCallout(t)},this.onApplyFlag=async(e,t,i)=>{await this.applyChange(e,(async(n,s)=>{await n.applyFlagSuggestion(s,void 0,e.nodeId,e,t,i)}))},this.applyChange=(e,t)=>{const i=this.proofingDom.findParagraphNode(e.nodeId);return(0,x.l)(i)&&i.parent.element?t(this.critiqueApplicationHandler,i.parent.element):Promise.resolve()},this.onIgnoreOnce=e=>{(0,o.r3)(e)&&this.applyChange(e,((t,i)=>{t.ignoreFlagOnce(i,void 0,e.nodeId,e)}))},this.onIgnoreAll=e=>{(0,o.r3)(e)&&this.applyChange(e,((t,i)=>{t.ignoreAllOfCritique(i,void 0,e.nodeId,e)}))},this.setSquiggler=(e,t)=>{this.squigglers.set(e,t),this.publishStateChange()},this.notifyHost=e=>{var t,i;const n=e.data.critiquesToElementsMap;if(e.messageType===T.G.NewData)for(const e of n)null===(t=this.nativeApi)||void 0===t||t.critiqueCountChanged(e.critiques.length);else if(e.messageType===T.G.RemoveData)for(const e of n){this.anchorElements.get(e.elementId)&&(null===(i=this.nativeApi)||void 0===i||i.critiqueCountChanged(e.critiques.length))}},this.getAnchorElement=(e,t)=>{var i;let n=this.anchorElements.get(e);if(n){const t=n.elementRef.deref();if(null==t?void 0:t.isConnected)return n;this.clearSquiggler(e),this.anchorElements.delete(e)}let s=t;const o=null===(i=this.squigglePositioningEdgeCases)||void 0===i?void 0:i.getEdgeCases(),a=null==o?void 0:o.find((e=>e.match(t)));if(null==a?void 0:a.getAnchorElement){let i;s=a.getAnchorElement(t);for(const t of this.anchorElements.values())t.elementRef.deref()===s&&(this.anchorElements.set(e,t),i=t);n=i}else{if(t.parentElement){const e=t.parentElement.closest("[contenteditable=true]");e&&(s=e)}if("true"===s.getAttribute(this.settings.editorSpellcheckAttribute)){let t;for(const i of this.anchorElements.values())i.elementRef.deref()===s&&(this.anchorElements.set(e,i),t=i);n=t}}return n||(n={id:this.guidGenerator.generate(),elementRef:new r.O(s)},this.anchorElements.set(e,n)),n},this._zoomScale=1,this.updateInputControlsProxyListCache=e=>{0===this._inputControlsProxyListCache.length&&0===e.length||(this._inputControlsProxyListCache=e,this.safeWindow.requestAnimationFrame((()=>{0===this.inputControlsProxyList.length&&0===this._inputControlsProxyListCache.length||(this.inputControlsProxyList=this._inputControlsProxyListCache,this.publishStateChange())})))},this.buildInputAndTextAreaList=e=>{if(!this.inputControlsStateStoreFactory)return;this._inputControlsProxyListCache=this._inputControlsProxyListCache.map((e=>(e.messageItem.changed=!1,e)));const t=e.data.critiquesToElementsMap;for(const e of t){if(!e.element)continue;const t=this.tileContent.getContainingElement(e.element);if(!t)continue;if(!(0,E.C)(t,"HTMLInputElement")&&!(0,E.C)(t,"HTMLTextAreaElement"))continue;const i=this.getAnchorElement(e.elementId,t);if(i){this._inputControlsProxyListCache=this._inputControlsProxyListCache.filter((e=>e.messageItem.anchor.id!==i.id));const t={entry:{elementId:e.elementId,element:e.element,critiques:e.critiques},anchor:{element:i.elementRef.deref(),id:i.id},changed:!0};this._inputControlsProxyListCache.push(this.inputControlsStateStoreFactory({messageItem:t,critiqueCalloutHandler:this.critiqueCalloutHandler,tooltipHandler:this.tooltipHandler,disableClearOnFocusFix:!1}))}}this.updateInputControlsProxyListCache(this._inputControlsProxyListCache)},this.buildContentEditableList=async e=>{if(!this.squigglerStateStoreFactory)return;const t=e.data.critiquesToElementsMap;if(e.messageType===T.G.NewData||e.messageType===T.G.ChangeData)await(0,P.transaction)((async()=>{if(this.squigglerStateStoreFactory)for(const i of t){if(!i.element)continue;const t=this.proofingDom.findTileNode(i.elementId);if(!t)continue;const n=this.tileContent.getContainingElement(i.element);if(!n)continue;if((0,E.C)(n,"HTMLInputElement")||(0,E.C)(n,"HTMLTextAreaElement")||!(0,E.C)(n,"HTMLElement"))continue;const s=this.getAnchorElement(i.elementId,n);let o;if(s&&(o=this.squigglers.get(s.id)),!s||!i.critiques.length){s&&o&&!i.critiques.length&&this.clearSquiggles(o,i.elementId,s.id);continue}const r={id:i.elementId,graphNode:t,element:n,critiques:i.critiques};o?await o.setCritiques(r,e.data.isVisualStateChange):(o=this.squigglerStateStoreFactory(r,s.elementRef.deref(),s.id,this.critiqueCalloutHandler,this.tooltipHandler),1!==this._zoomScale&&o.scaleTransform(this._zoomScale),this.setSquiggler(s.id,o))}}));else if(e.messageType===T.G.RemoveData)for(const e of t)this.clearSquiggler(e.elementId)},this.critiqueCalloutHandler=new u(this.hostSettings,this.calloutStateStore,this.undoCalloutStateStore,this.squiggleTooltipStateStore,this.inlineSuggestionsRenderer,this._logger,this.critiqueStore),this.tooltipHandler=new g(this.squiggleTooltipStateStore,this.calloutStateStore,this.undoCalloutStateStore,this.hostSettings)}async initialize(){this.proofingEventListener.emit("squiggleUXReadyEvent",{messageType:T.G.NewData})}shutDown(){var e;if(this.squigglers.size)for(const e of this.squigglers.values())e.dispose();this.squigglers.clear(),this.anchorElements.clear(),this.calloutStateStore.hide(),null===(e=this.undoCalloutStateStore)||void 0===e||e.hide(),this.publishStateChange()}publishStateChange(){this.publishEvent("stateUpdated",{squigglers:this.squigglers,inputControlsProxyList:this.inputControlsProxyList,visible:this.visible})}clearSquiggler(e){const t=this.anchorElements.get(e);if(!t)return;const i=this.squigglers.get(t.id);i&&this.clearSquiggles(i,e,t.id)}async onCritiqueForUiEvent(e){this.buildInputAndTextAreaList(e),await this.buildContentEditableList(e),this.notifyHost(e)}setZoomScale(e){this._zoomScale=e;for(const[,t]of this.squigglers)t.scaleTransform(e)}};O=(0,n.__decorate)([(0,F._)(),(0,n.__param)(0,(0,q.W)(N.o)),(0,n.__param)(1,(0,R.l)()),(0,n.__param)(1,(0,q.W)(h.f)),(0,n.__param)(2,(0,R.l)()),(0,n.__param)(2,(0,q.W)(p.tp)),(0,n.__param)(3,(0,q.W)(m.v)),(0,n.__param)(4,(0,q.W)(L.k)),(0,n.__param)(5,(0,q.W)(w.G)),(0,n.__param)(6,(0,q.W)(f.A)),(0,n.__param)(6,(0,R.l)()),(0,n.__param)(7,(0,q.W)(a.g)),(0,n.__param)(8,(0,q.W)(v.n)),(0,n.__param)(9,(0,q.W)(D.w)),(0,n.__param)(10,(0,q.W)(l.j)),(0,n.__param)(11,(0,q.W)(A.d)),(0,n.__param)(12,(0,q.W)(d.n)),(0,n.__param)(13,(0,R.l)()),(0,n.__param)(13,(0,q.W)(y.V)),(0,n.__param)(14,(0,R.l)()),(0,n.__param)(14,(0,q.W)(_.p)),(0,n.__param)(15,(0,R.l)()),(0,n.__param)(15,(0,q.W)(I.x)),(0,n.__param)(16,(0,R.l)()),(0,n.__param)(16,(0,q.W)(S)),(0,n.__param)(17,(0,R.l)()),(0,n.__param)(17,(0,q.W)(b.$))],O)},934116:(e,t,i)=>{if(i.d(t,{w:()=>o}),0!=i.j)var n=i(429712);if(0!=i.j)var s=i(251439);class o{constructor(){this.imports=[]}get uniqueId(){return(0,s.z)(507918369)}configureRootServices(e){e.bind(n.Th).toDynamicValue((()=>()=>e.getOptional(n.QV)))}}},937126:(e,t,i)=>{i.d(t,{f:()=>n});const n=(0,i(668952).f)("IInstrumentationMessageProcessor")},937229:(e,t,i)=>{i.d(t,{Bc:()=>s,RW:()=>o});var n=i(668952);const s=(0,n.f)("IGrammarTerminalSymbol"),o=(0,n.f)("IGrammarNonTerminalSymbolExpanded");(0,n.f)("IGrammarRules")},938351:(e,t,i)=>{i.d(t,{l:()=>s});var n=i(829088);class s extends n.O{constructor(e,t,i){super(e),this.logger=t,this.derefFailedLogMessage=i}deref(){const e=super.deref();return e||this.logger.error(505680985,this.derefFailedLogMessage,new Error(this.derefFailedLogMessage)),e}}},939074:(e,t,i)=>{if(i.d(t,{A:()=>v}),0!=i.j)var n=i(643513);if(0!=i.j)var s=i(386675);if(0!=i.j)var o=i(493077);if(0!=i.j)var r=i(150099);if(0!=i.j)var a=i(660458);if(0!=i.j)var l=i(46183);if(0!=i.j)var d=i(862732);if(0!=i.j)var c=i(139052);if(0!=i.j)var u=i(280767);if(0!=i.j)var g=i(240874);if(0!=i.j)var h=i(234979);if(0!=i.j)var p=i(774592);if(0!=i.j)var m=i(615930);if(0!=i.j)var f=i(251439);class v{constructor(){this.imports=[c.u]}get uniqueId(){return(0,f.z)(505680994)}configureRootServices(e){e.bind(o.n).to(d.y),e.bind(g.v).to(l.O),e.bind("OAMetricEventName").toValue("OASuggestionLoadTime"),e.bind(r.j).to(a.c),e.bind(s.S).toExisting(r.j),e.bind(m.oA).toDynamicValue((e=>()=>e.getOptional(m.q4))),e.bind(m.Ze).toDynamicValue((e=>()=>e.getOptional(m.jh))),e.bind(m.cg).toDynamicValue((e=>()=>e.getOptional(m.sh))),e.bind(n.m).to(n.r),e.bind(p.H).toSelf(),e.bind(h.W).toSelf(),e.bind(u.DS).to(u.KW)}}},939178:(e,t,i)=>{i.d(t,{V:()=>L,S:()=>D});var n=i(379490),s=i(630501),o=i(647879),r=i(829088),a=i(728671),l=i(163573),d=i(671303),c=i(821003),u=i(494888),g=i(429712),h=i(537969),p=i(823325),m=i(909113),f=i(756857),v=i(243879),y=i(928452),_=i(857132),I=i(1144),C=i(538045),S=i(104072),b=i(157698);var T=i(418876),E=i(668952),N=i(229906),w=i(83010),x=i(427603);const L=(0,E.f)("INudgeStateStore");let D=class extends s.z{get nudge(){return this._nudge}get nudgeDisplayLocation(){return this._nudgeDisplayLocation}get nudgeTargetDocumentRef(){return this._nudgeTargetDocumentRef}get insertionCharacter(){var e,t,i;return null!==(i=null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.insertionCharacter)&&void 0!==i?i:"@"}constructor(e,t,i,n,s,l,d,c,u,g,m,f,v){super(),this.localizer=e,this.hostSettings=t,this.hostEmitter=i,this.oaLogger=n,this.proofingDom=s,this.nudgeStore=l,this.tileContent=d,this._queryDetection=c,this.paragraphTextExtractor=u,this._ariaStatusStateStoreFactory=g,this._featureFlagsReader=m,this.inlineSuggestionsRenderer=f,this.predictionStore=v,this._nudgeDisplayTime=void 0,this._nudge=void 0,this._nudgeDisplayLocation=void 0,this._nudgeTargetDocumentRef=void 0,this.enableInlineNudge=!1,this.initialize=async()=>{var e,t;this.hostEmitter.on(h.pD.hostModelDelta,this.handleDelta),this.hostEmitter.on(h.pD.hostModelTextTile,this.handleTextTile),this.enableInlineNudge=!!(null===(t=null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge)||void 0===t?void 0:t.enableInlineNudge)},this.shutDown=()=>{},this.onNudgeUpdated=async()=>{var e,t,i,n,s,r,a,l,d,c,u,g,h,p,m;const f=this.nudgeStore.getCurrentNudge();if(f){if(this.oaLogger.logActivity("OANudgeReceived",void 0,[(0,o.n)("entityType",f.entityType.toString())],void 0),this.isNudgeDisabledForEntityType(null===(e=this.hostSettings.serviceSettings)||void 0===e?void 0:e.nudge,f.entityType))return void await this.nudgeStore.clearNudge();if((null===(i=null===(t=this.hostSettings.serviceSettings)||void 0===t?void 0:t.nudge)||void 0===i?void 0:i.shouldRenderNudge)&&!this.hostSettings.serviceSettings.nudge.shouldRenderNudge(f))return void await this.nudgeStore.clearNudge();if(f.entityResults&&!(null===(s=null===(n=this.hostSettings.serviceSettings)||void 0===n?void 0:n.nudge)||void 0===s?void 0:s.entityNudgeClicked))return void await this.nudgeStore.clearNudge();if(f.entityResults&&(null===(l=null===(a=null===(r=this.inlineSuggestionsRenderer)||void 0===r?void 0:r.getCurrentMenuInfo())||void 0===a?void 0:a.wasOpenedViaNudgeInfo)||void 0===l?void 0:l.hasEntityResults))return void await this.nudgeStore.clearNudge();if(null===(d=this.predictionStore)||void 0===d?void 0:d.getCurrentPrediction())return void await this.nudgeStore.clearNudge();if(this._nudge&&this._nudge.text===f.text&&this._nudge.tileId===f.tileId&&this._nudge.entityType===f.entityType)return;const v=this.proofingDom.findParagraphNode(f.tileId);if(!(0,I.l)(v))return void await this.nudgeStore.clearNudge();const y=this.paragraphTextExtractor.getTextBetween(v,v,v.element.span-2,v.element.span);if(y&&""!==y){if(" :"===y)return void await this.onNudgeDismiss("space character precedes :");if(y.includes("@"))return void await this.onNudgeDismiss("@ character detected");if(y.includes("/"))return void await this.onNudgeDismiss("/ character detected")}const _=await this.tileContent.getNodeInsertionPosition(v.parent,v.element.offset+f.startIndex,!0);if(!_)return void await this.nudgeStore.clearNudge();if(!await this.isInputPointerAtNudge(f))return void await this.nudgeStore.clearNudge();const C=_.endContainer.parentElement;if(C&&this.containsInvalidNudgeSelector(C,null===(u=null===(c=this.hostSettings.serviceSettings)||void 0===c?void 0:c.nudge)||void 0===u?void 0:u.invalidNudgeSelectors))return void await this.nudgeStore.clearNudge();const S=_.getBoundingClientRect();this.updateNudge(f,null!==(g=null==C?void 0:C.ownerDocument)&&void 0!==g?g:document,S),this.oaLogger.logActivity("OANudgeDisplayed",void 0,[(0,o.n)("entityType",f.entityType.toString())],void 0),null===(m=null===(p=null===(h=this.hostSettings.serviceSettings)||void 0===h?void 0:h.nudge)||void 0===p?void 0:p.onNudgeDisplayed)||void 0===m||m.call(p,f),this.setAriaStatus("ebx_CIQNudgeDisplayed",f.text)}else this.clearNudge()},this.isInputPointerAtNudge=async e=>{var t;const i=await this.tileContent.getTextSelection();return!!i&&(i.startPosition===i.endPosition&&(null===(t=i.startParagraphNode)||void 0===t?void 0:t.id)===e.tileId&&i.endPositionInParagraphNode===e.startIndex)},this.updateNudge=(e,t,i)=>{this._nudge=e,this._nudgeTargetDocumentRef=new r.O(t),this._nudgeDisplayLocation=i,this._nudgeDisplayTime=Date.now(),this.publishStateChange()},this.clearNudge=()=>{this._nudge=void 0,this._nudgeTargetDocumentRef=void 0,this._nudgeDisplayLocation=void 0,this._nudgeDisplayTime=void 0,this.publishStateChange()},this.handleTextTile=e=>{if(this.nudge&&e.message.messageType===p.G.RemoveData){const t=e.message.data.tileId;this.nudge.tileId!==t&&this.proofingDom.findParagraphNode(this.nudge.tileId)||this.onNudgeDismiss("tile removed")}},this.handleDelta=async e=>{var t;const i=e.message;if(i.sourceType===a.pf.TileNode)return;if(!this.nudge)return;const n=await this.tileContent.getTextSelection();if(!this.nudge)return;let s;if((null==n?void 0:n.isCollapsed)&&n.startParagraphNode&&n.startParagraphNode.id===this.nudge.tileId&&n.startPositionInParagraphNode){if(s=await this.tileContent.getNodeInsertionPosition(n.startParentElement,n.startParagraphNode.element.offset+n.startPositionInParagraphNode,!0),!s)return this.oaLogger.logDiagnostics("Nudge text update: could not determine range for nudge insertion"),void await this.onNudgeDismiss("could not determine position");if(i.delta.deltaType===T.WI.Add&&(null===(t=i.delta.content)||void 0===t?void 0:t.includes(":"))&&" "===this.paragraphTextExtractor.getTextBetween(n.startParagraphNode,n.startParagraphNode,i.delta.position-1,i.delta.position))return void await this.onNudgeDismiss(": was proceeded with a space");const e=s.getBoundingClientRect();this._nudgeDisplayLocation&&(this._nudgeDisplayLocation=e,this.publishStateChange())}else(null==n?void 0:n.startParagraphNode)&&n.startPositionInParagraphNode?(n.isCollapsed||await this.onNudgeDismiss("Text range was selected"),0===n.startPositionInParagraphNode?await this.onNudgeDismiss("A new sentence was started"):await this.onNudgeDismiss("Text selection moved to another sentence")):await this.onNudgeDismiss("Unable to determine text selection")},this.nudgeStore.setOnUpdatedNudge(this.onNudgeUpdated)}async onNudgeDismiss(e,t){var i,n,s;const r=this.nudgeStore.getCurrentNudge();if(!r)return;const a=this.proofingDom.findParagraphNode(r.tileId);if(!(0,I.l)(a))return void await this.nudgeStore.clearNudge();let l="";if(t){const e=this.paragraphTextExtractor.getTextBetween(a,a,a.element.span-2,a.element.span);l=": "===e?'user pasted text after ": "':(null==e?void 0:e.includes(":"))?'user pasted text after ":"':"user pasted text"}const d=Date.now()-this._nudgeDisplayTime;this.oaLogger.logActivity("OANudgeDismissed",void 0,(0,o.W)(["entityType",r.entityType.toString()],["dismissTrigger",t?l:e],["persistTime",d])),await this.nudgeStore.clearNudge(),null===(s=null===(n=null===(i=this.hostSettings.serviceSettings)||void 0===i?void 0:i.nudge)||void 0===n?void 0:n.onNudgeDismissed)||void 0===s||s.call(n,r,d,t?l:e)}async onNudgeAccepted(e,t){var i,n,s,r,a,l,d,c,u,g;const f=this.nudgeStore.getCurrentNudge();if(!f)return void this.oaLogger.logDiagnostics("Nudge click: could not find nudge in store");const v=Date.now()-this._nudgeDisplayTime;if(this.oaLogger.logActivity("OANudgeClicked",void 0,(0,o.W)(["entityType",f.entityType.toString()],["persistTime",v],["userAction",e])),null===(s=null===(n=null===(i=this.hostSettings.serviceSettings)||void 0===i?void 0:i.nudge)||void 0===n?void 0:n.onNudgeAccepted)||void 0===s||s.call(n,f,v,e,t),await this.nudgeStore.clearNudge(),t)if(null===(r=this.hostSettings.oaSettings)||void 0===r?void 0:r.isContextualCardEnabled){const e=this.proofingDom.findParagraphNode(f.tileId);if(!(0,I.l)(e))return void this.oaLogger.logDiagnostics("Nudge click: could not find paragraph node");const i=await this.tileContent.getTextSelection();let n;i||this.oaLogger.logDiagnostics("Nudge click: could not determine text selection");let s=0,o=!1;if((null==i?void 0:i.isCollapsed)&&i.startParagraphNode&&i.startParagraphNode.id===e.id&&i.startPositionInParagraphNode){const t=this.paragraphTextExtractor.getParagraphText(i.startParagraphNode);t&&!m.Yv(t.charCodeAt(i.startPositionInParagraphNode-1))&&(o=!0),s=e.element.offset+i.startPositionInParagraphNode,n=await this.tileContent.getNodeInsertionPosition(i.startParentElement,s,!0)}if(n||(s=e.element.offset+f.startIndex,n=await this.tileContent.getNodeInsertionPosition(e.parent,s,!0)),!n)return void this.oaLogger.logDiagnostics("Nudge click: could not determine range for nudge insertion");if(this.hostEmitter.emit(h.pD.nudgeAccepted,{message:{data:{nudge:f,fromUserAction:t},messageType:p.G.NewData},address:void 0}),f.entityResults){if(!(null===(l=null===(a=this.hostSettings.serviceSettings)||void 0===a?void 0:a.nudge)||void 0===l?void 0:l.entityNudgeClicked))return void this.oaLogger.logDiagnostics("Nudge click: entity nudge was clicked, but no callback was provided");if(f.entityResults.entities.length>1&&this.inlineSuggestionsRenderer){const t=[],i=f.entityResults.entities;t.push({entities:i,intent:f.entityResults.intent,entityType:f.entityResults.entityType});const n=s-e.element.offset,o=t=>{this.hostSettings.serviceSettings.nudge.entityNudgeClicked(t,e.parent.element,e.id,n)};await this.inlineSuggestionsRenderer.showExistingMenu(e.id,n,0,null!==(d=this.hostSettings.serviceSettings.nudge.insertionCharacter)&&void 0!==d?d:"@",!0,!1,void 0,o,t)}else this.hostSettings.serviceSettings.nudge.entityNudgeClicked(f.entityResults.entities[0],e.parent.element,e.id,s-e.element.offset)}else this._queryDetection.setNextDeltaProgramaticallyInserted("Nudge"),await this.tileContent.insert(e.parent,void 0,s,(o?" ":"")+(null!==(g=null===(u=null===(c=this.hostSettings.serviceSettings)||void 0===c?void 0:c.nudge)||void 0===u?void 0:u.insertionCharacter)&&void 0!==g?g:"@"),!0,n,!1)}else this.oaLogger.logDiagnostics("Nudge click: ECC was not enabled");else this.hostEmitter.emit(h.pD.nudgeAccepted,{message:{data:{nudge:f,fromUserAction:t},messageType:p.G.NewData},address:void 0})}isNudgeDisabledForEntityType(e,t){return(null==e?void 0:e.entityConfigs)&&!e.entityConfigs.some((e=>e.enabled&&e.entityType===t))}containsInvalidNudgeSelector(e,t){var i;let n=!1;if(t)for(const s of t)(e.matches(s)||(null===(i=e.nextElementSibling)||void 0===i?void 0:i.matches(s)))&&(n=!0);return n}setAriaStatus(e,t){var i;this._featureFlagsReader.flags.enableAriaStatusElement&&(null===(i=this._ariaStatusStateStoreFactory())||void 0===i||i.setStatus(this.localizer.getMessage(e,t),"assertive",!1))}publishStateChange(){this.publishEvent("stateUpdated",{nudge:this._nudge,nudgeTargetDocumentRef:this._nudgeTargetDocumentRef,nudgeDisplayLocation:this._nudgeDisplayLocation})}};D=(0,n.__decorate)([(0,N._)(),(0,n.__param)(0,(0,w.W)(f.H)),(0,n.__param)(1,(0,w.W)(l.n)),(0,n.__param)(2,(0,w.W)(h.M5)),(0,n.__param)(3,(0,w.W)(d.m)),(0,n.__param)(4,(0,w.W)(C.w)),(0,n.__param)(5,(0,w.W)(y.Y)),(0,n.__param)(6,(0,w.W)(S.d)),(0,n.__param)(7,(0,w.W)(c.J)),(0,n.__param)(8,(0,w.W)(b.b)),(0,n.__param)(9,(0,w.W)(g.Th)),(0,n.__param)(10,(0,w.W)(u.c)),(0,n.__param)(11,(0,x.l)()),(0,n.__param)(11,(0,w.W)(v.V)),(0,n.__param)(12,(0,x.l)()),(0,n.__param)(12,(0,w.W)(_.o))],D)},941862:(e,t,i)=>{i.d(t,{D:()=>u});var n=i(834426),s=i(477543),o=i(496439),r=i(630501),a=i(753031),l=i(893801),d=i(852278),c=i(168492);class u extends r.z{constructor(){super(),this._isDisconnected=!1,this._previousAuthState=null,this._disposed=!1,this._sessionCallbackTokenList=[],this._initCurrentSession=()=>{this._session&&(this._resolveSessionPromise(this._session),this._sessionCallbackTokenList.push(this._session.setConnectCallback(this._handleSessionConnect)),this._sessionCallbackTokenList.push(this._session.setDisconnectCallback(this._handleSessionDisconnect)),this._sessionCallbackTokenList.push(this._session.setReconnectCallback(this._handleSessionReconnect)),this._sessionCallbackTokenList.push(this._session.setSessionCloseCallback(this._handleSessionClosed)),this._session.setServerAuthenticationStateChangeCallback(this._handleAuthenticationChange))},this._handleSessionConnect=async e=>{this.emitSessionStateLog({eventName:"alSessionConnect",data:{isSeedingRequired:e}},"AugLoop session connected"),e&&(await this._seedSessionWithDocumentRoot(),this._isDisconnected&&(this._isDisconnected=!1,this.publishEvent("reset")))},this._createSession=async(e,t)=>{var i,n,s,o;const r=null!==(n=null===(i=e.docSessionId)||void 0===i?void 0:i.toString())&&void 0!==n?n:"test_session_id";return this.emitInfoEvent({eventName:"startCreateSession"},"Creating a new AugLoop session."),this._session=await t.createSession({docSessionId:r}),this._initCurrentSession(),(null===(s=e.callbacks)||void 0===s?void 0:s.augLoopAuthTokenCallback)||(null===(o=e.callbacks)||void 0===o?void 0:o.substrateAuthTokenCallback)||(this.emitSessionStateLog({eventName:"createSession"},"No auth callbacks provided, continue in not authenticated mode."),this._resolveAuthPromise(l.f.NotAuthenticated)),this.emitInfoEvent({eventName:"finishCreateSession"},"Finished creating a new AugLoop session."),this._session},this._handleSessionDisconnect=e=>{this.emitSessionStateLog({eventName:"alSessionDisconnect",data:{error:e}},"AugLoop session disconnected"),this._isDisconnected=!0},this._handleSessionReconnect=()=>{this.emitSessionStateLog({eventName:"alSessionReconnect"},"AugLoop session reconnected")},this._handleSessionClosed=e=>{let t="No reason provided.";e.reason&&"reasonDescription"in e.reason&&(t=`Reason: ${e.reason.reasonDescription}`),this.emitSessionStateLog({eventName:"alSessionClosed",data:{reason:t,reconnectAllowed:e.reconnectAllowed}},"AugLoop session closed")},this.emitSessionStateLog=(e,t)=>{this.publishEvent("telemetryLog",Object.assign(Object.assign({},e),{logType:"Event",level:a.q.Info,message:t,timestamp:(new Date).toISOString()}))},this.emitError=(e,t)=>{this.publishEvent("telemetryLog",Object.assign(Object.assign({},e),{logType:"Event",level:a.q.Error,message:t,timestamp:(new Date).toISOString()}))},this.emitInfoEvent=(e,t)=>{this.publishEvent("telemetryLog",Object.assign(Object.assign({},e),{logType:"Event",level:a.q.Info,message:t,timestamp:(new Date).toISOString()}))},this.generateReconnectionErrorMessage=e=>this._session?"Existing session has not been closed yet. Call closeSession first.":this._lastSessionSettings?this._runtime||e?"Error was encountered but the error message is not defined for the current state.":"Runtime is not available. Set reCreateRuntime to true or call create method directly.":"Previous session settings are not found. Use create method to pass valid settings and create a session.",this.generateMessageAndEmitReconnectionError=e=>{const t=this.generateReconnectionErrorMessage(e);this.emitError({eventName:"canReconnectSession"},t)},this._handleAuthenticationChange=e=>{this._previousAuthState===l.f.Pending&&this._resolveAuthPromise(e),this._previousAuthState=e},this._seedSessionWithDocumentRoot=async()=>{var e;const t=new n.yo({isReadonly:!1}),i=new s.Xr({parentPath:["session"],items:[{id:"documentRoot",body:t}]});this.emitInfoEvent({eventName:"startSeedingSession"},"Seeding the Session.");try{null===(e=this._session)||void 0===e||e.submitSeedGroupOperations([i],!0)}catch(e){this.emitSessionStateLog({eventName:"createSession"},"Host is already seeded, continuing.")}this.emitInfoEvent({eventName:"finishSeedingSession"},"Finished seeding the session.")},this.onAugLoopTelemetryEvent=(e,t,i,n,s,o,r,l)=>{this.publishEvent("augloopTelemetry",{eventName:t,logType:"Event",level:a.q.Info,timestamp:(new Date).toISOString(),data:{tenant:e,data:i,contract:n,contractData:s,critical:o,dataCategories:r,diagnosticLevel:l}})};const[e]=(0,c.vP)();this._resolveSessionPromise=e;const[t]=(0,c.vP)();this._resolveAuthPromise=t}async getSession(){return this._session}getServerAuthenticationState(){return this._session?(this._resolveSessionPromise(this._session),this._session.getServerAuthenticationState()):l.f.NotAuthenticated}isConnected(){return!!this._session&&(this._resolveSessionPromise(this._session),this._session.isConnected)}async create(e){if(this._session)return null;this.emitInfoEvent({eventName:"startCreateRuntime"},"Initializing AugLoop runtime."),this._lastSessionSettings=e,this._runtime=(0,d.xB)();const t={isFeatureEnabled:(e,t)=>Promise.resolve(!0),requestAuthToken:async t=>{var i,n;return(async e=>{let t;try{t=await(null==e?void 0:e())}catch(e){this.emitError({eventName:"authCallbackError"},"Auth callback threw unhandled error, continuing in not authenticated mode."),this._resolveAuthPromise(l.f.NotAuthenticated),t=void 0}return{Token:t}})(t.TokenType===o.OY.Substrate?null===(i=e.callbacks)||void 0===i?void 0:i.substrateAuthTokenCallback:null===(n=e.callbacks)||void 0===n?void 0:n.augLoopAuthTokenCallback)},sendTelemetryEvent:this.onAugLoopTelemetryEvent,areLicenseFeaturesEnabled:async()=>Promise.resolve(!1)};return await this._runtime.init(e.url,e.metadata,t,e.runtimeOptions),this.emitInfoEvent({eventName:"finishCreateRuntime"},"Finished initializing AugLoop runtime."),this._createSession(e,this._runtime)}async attach(e,t=!1){this._session||(t&&await this._seedSessionWithDocumentRoot(),this._session=e,this._initCurrentSession())}async closeSession(){var e,t;for(const t of this._sessionCallbackTokenList)null===(e=this._session)||void 0===e||e.removeSessionStateCallback(t);this._sessionCallbackTokenList=[],null===(t=this._session)||void 0===t||t.close(),this._session=void 0;const[i]=(0,c.vP)();this._resolveSessionPromise=i;const[n]=(0,c.vP)();this._resolveAuthPromise=n}async reconnectSession(e=!1){!this._session&&this._lastSessionSettings&&(this._runtime||e)?(this._isDisconnected=!1,this.publishEvent("reset"),this._runtime?await this._createSession(this._lastSessionSettings,this._runtime):await this.create(this._lastSessionSettings)):this.generateMessageAndEmitReconnectionError(e)}async dispose(){var e;this._disposed||(this._disposed=!0,await this.closeSession(),null===(e=this._runtime)||void 0===e||e.uninitialize(),this._runtime=void 0)}}},944163:(e,t,i)=>{i.d(t,{R:()=>d});var n=i(208520),s=i(252723),o=i(108520),r=i(150099);if(0!=i.j)var a=i(281769);const l=(0,s.F5)({safeWindow:o.A.on(r.j)}),d=e=>{const{safeWindow:t}=(0,s.KN)(l),{store:i}=e,o=i.anchor,r=n.useRef(!1),d=n.useRef(null),c=n.useRef(null),u=n.useRef({top:0,left:0}),g=n.useRef([]),[h,p]=n.useState({container:{display:"none"},overlay:{display:"none"},anchorStyle:{position:"static"}}),m=(0,a.uE)(o,h.overlay.paddingBottom),f=Object.assign({},h.overlay),v=()=>{const e=(0,a.dB)(o,c.current,u),t=(0,a.Cf)(o);u.current={top:e.top,left:e.left},p((()=>((()=>{const e=o.scrollLeft,t=o.scrollTop;d.current&&(d.current.scrollLeft=e,d.current.scrollTop=t)})(),{container:e,overlay:t.overlay,anchorStyle:t.anchor}))),i.setShadowElement(c.current,d.current)},y=()=>{var e;e=v,t.requestAnimationFrame((()=>{r.current||e()}))},_=()=>new Promise((e=>{y(),g.current.push(e)}));return n.useEffect((()=>(y(),i.setUpdateOverlay(_),()=>{r.current=!0})),[]),n.useEffect((()=>{for(const e of g.current)e();g.current=[]}),[h]),o.isConnected?n.createElement("div",{ref:c,style:h.container},n.createElement("div",{style:f,className:"hc-noadjust"},n.createElement("div",{style:m,ref:d},n.createElement("span",{"aria-hidden":"true"},o.value)))):null}},944749:(e,t,i)=>{if(i.d(t,{$:()=>s}),0!=i.j)var n=i(553164);function s(e){return(null==e?void 0:e.nodeType)===n.Z.TileNode&&!!e.element&&!!e.children&&e.children.every((e=>e.nodeType===n.Z.ParagraphNode&&void 0!==e.element&&"offset"in e.element&&"span"in e.element))}},947463:(e,t,i)=>{var n,s,o,r,a,l;i.d(t,{G_:()=>a,UW:()=>s}),function(e){e.O365="o365UserService",e.MSA="msaUserService",e.NONE="noneUserService"}(n||(n={})),function(e){e[e.MSA=0]="MSA",e[e.AAD=1]="AAD"}(s||(s={})),function(e){e.AAD="aad",e.MSA="msa",e.NONE="none"}(o||(o={})),function(e){e.GCC="GCC",e.Worldwide="WW"}(r||(r={})),function(e){e.NoLicense="NoLicense",e.Perpetual="Perpetual",e.Subscription="Subscription",e.SubscriptionPreview="SubscriptionPreview"}(a||(a={})),function(e){e[e.Unknown=0]="Unknown",e[e.MinorWithoutParentalConsent=1]="MinorWithoutParentalConsent",e[e.MinorWithParentalConsent=2]="MinorWithParentalConsent",e[e.Adult=3]="Adult",e[e.NotAdult=4]="NotAdult",e[e.MinorNoParentalConsentRequired=5]="MinorNoParentalConsentRequired"}(l||(l={}))},947511:(e,t,i)=>{var n,s;i.d(t,{f:()=>s,n:()=>n}),function(e){e.ActionHideSynonymsFromCallout="ActionHideSynonymsFromCallout",e.ActionShowCallout="ActionShowCallout",e.ActionShowSynonymsFromCallout="ActionShowSynonymsFromCallout",e.ActionUpsellButtonClicked="ActionUpsellButtonClicked",e.SignInInitialized="SignInInitialized",e.ActionDisableCritique="ActionDisableCritique",e.OverflowMenuClicked="OverflowMenuClicked",e.UndoCalloutShown="UndoCalloutShown",e.PersonalizedUndoCalloutShown="PersonalizedUndoCalloutShown",e.SquiggleTooltipShown="SquiggleTooltipShown",e.CritiquesShown="CritiquesShown"}(n||(n={})),function(e){e.AriaError="RunTimeErrors.AriaError",e.GetNewActivityError="RunTimeErrors.GetNewActivityError",e.EnvelopeFormatError="RunTimeErrors.EnvelopeFormatError",e.TelemetryError="RunTimeErrors.TelemetryError",e.RoamingDictionarySaveError="RunTimeErrors.RoamingDictionarySaveError",e.RoamingDictionaryInitError="RunTimeErrors.RoamingDictionaryInitError"}(s||(s={}))},950650:(e,t,i)=>{i.d(t,{P:()=>m});var n=i(398746),s=i(495980),o=i(55386),r=i(863307),a=i(997235),l=i(56745),d=i(977487);class c{constructor(e){var t;this.params=e,this._targetElement=null,this._clientCorrelationId="",this.isNextDeltaProgrammaticallyInserted=!1,this.targetElement=null!==(t=e.targetElement)&&void 0!==t?t:null}init(){var e;this._queryCache=null!==(e=this.params.queryCache)&&void 0!==e?e:new s.$;const{queryDetectorConfig:t,intentDetectorActivatorConfig:i}=this.params.eventsConfig;(0,a.TT)(t)?this._queryDetector=t:this._queryDetector=new o.P(t),this.queryDetector.init(),i&&((0,a.Mt)(i)?this.intentDetectionActivator=i:this.intentDetectionActivator=new n.T(i,this.targetElement),this.intentDetectionActivator.init((e=>{(0,l.Fj)(e),this.triggerIntentDetection({intentText:e})})))}dispose(){var e;this.queryDetector.dispose(),this.queryCache.clear(),null===(e=this.intentDetectionActivator)||void 0===e||e.dispose(),this._queryDetector=void 0,this._queryCache=void 0,this.intentDetectionActivator=void 0}get targetElement(){return this._targetElement}set targetElement(e){this._targetElement=e}get currentQuery(){return this.queryCache.currentQuery}get currentScope(){return this._currentScope}set currentScope(e){this._currentScope=e}get clientCorrelationId(){return this._clientCorrelationId}set clientCorrelationId(e){this._clientCorrelationId=e}setNextDeltaProgrammaticallyInserted(e){this.isNextDeltaProgrammaticallyInserted=!0,this.programmaticallyInsertedSource=e}resetNextDeltaProgrammaticallyInserted(){this.isNextDeltaProgrammaticallyInserted=!1,this.programmaticallyInsertedSource=void 0}get queryDetector(){if(!this._queryDetector)throw new Error("No QueryDetector provided");return this._queryDetector}get queryCache(){if(!this._queryCache)throw new Error("No QueryCache provided");return this._queryCache}handleNode(e){var t;const{shouldProceed:i,shouldDismiss:n}=this.shouldProceedWithQueryDetection(e);if(!i)return void(n&&this.dismissQuery());const s=this.getText(e),o=(0,r._v)();o.debug(505471759,"data text: ",s);const a=this.queryCache.currentQuery;a||null===(t=this.intentDetectionActivator)||void 0===t||t.processText(s);const{cursorPosition:l,delta:c}=this.getCursorPositionAndDelta(e),u=this.queryDetector.detectQuery(s,Math.min(l,s.length),c,a);if(!u)return o.debug(505471758,"query not detected",{text:s,cursorPosition:l,delta:c}),void this.dismissQuery();o.debug(505471757,"detectedQuery",u);const g=this.convertToEntitiesRequest(u,this.getTileId(e),s);(0,d.z)(g),this.onQueryDetected(g)}convertToEntitiesRequest(e,t,i){e.tileId=t,this.queryCache.addQuery(e);return(0,r._v)().debug(505471756,"query detected",e),{targetId:e.tileId,query:{start:e.queryRange.start,text:i.substring(e.queryRange.start+1,e.queryRange.start+e.queryRange.length)},conversationId:e.additionalData.conversationId,logicalId:e.additionalData.logicalId,triggerKey:e.additionalData.triggerKey,additionalData:Object.assign(Object.assign({},e.additionalData),{clientCorrelationId:this.clientCorrelationId,scopeInfo:this.currentScope,isUserInsertion:!this.isNextDeltaProgrammaticallyInserted,source:this.programmaticallyInsertedSource}),prefix:i.substring(0,e.queryRange.start)}}dismissQuery(){const e=this.queryCache.currentQuery,t=(0,r._v)();e&&(0,d.k)(e),t.debug(505471755,"query dismissed",e),this.currentScope=void 0,this.resetNextDeltaProgrammaticallyInserted(),this.queryCache.clear()}}var u=i(728671),g=i(823325),h=i(418876),p=i(93469);class m extends c{constructor(e,t){super(e),this.editor=t}init(){super.init(),this.editor.subscribe("tilingEvent",this.handleNode.bind(this)),this.editor.subscribe("entitiesRequestDismissed",this.dismissQuery.bind(this,!1))}dispose(){super.dispose(),this.editor.unsubscribe("tilingEvent",this.handleNode.bind(this)),this.editor.unsubscribe("entitiesRequestDismissed",this.dismissQuery.bind(this,!1))}dismissQuery(e=!0){super.dismissQuery(),e&&this.editor.queryDismissed()}triggerIntentDetection(e){(0,r._v)().debug(505246792,"triggerIntentDetection called in EditorSdkInputAdapter",{textStats:(0,p.ZX)(e.intentText)}),this.editor.triggerIntentDetection(e)}onQueryDetected(e){this.editor.queryDetected(e)}shouldProceedWithQueryDetection(e){var t;return"hostModelTextTile"===e.messageName&&e.messageType===g.G.RemoveData&&(null===(t=this.queryCache.currentQuery)||void 0===t?void 0:t.tileId)===e.data.tileId?{shouldProceed:!1,shouldDismiss:!0}:this.shouldProcessMessage(e)?{shouldProceed:!0,shouldDismiss:!1}:{shouldProceed:!1,shouldDismiss:!1}}getText(e){return e.tileText}getCursorPositionAndDelta(e){const{delta:{deltaType:t,length:i,content:n,position:s},tileText:o}=e;(0,r._v)().debug(505439682,"data text: ",o);const a=this.getPositionDelta(i,n||"",t);return{cursorPosition:this.calculatePosition(o,a,s),delta:a}}getTileId(e){return e.tileId}shouldProcessMessage(e){const t=(0,r._v)();return"hostModelDelta"!==e.messageName?(t.debug(505471753,"Exiting tiling event handler without processing",e.messageName),!1):(t.debug(505471752,"handling hostModelDelta message"),e.sourceType===u.pf.TileNode?(t.debug(505471751,"Ignoring tile node"),!1):e.changeType!==u.Q0.Code&&(e.tileText?this.shouldProcessDelta(e.delta):(t.debug(505471750,"Ignoring tiling event because tileText is not defined"),!1)))}shouldProcessDelta(e){return!(e.deltaType===h.WI.Update&&0===e.length&&!e.content)&&(void 0!==e.position&&void 0!==e.length&&!(e.deltaType===h.WI.Delete&&!this.queryCache.currentQuery))}getPositionDelta(e,t,i){switch(i){case h.WI.Update:return e;case h.WI.Delete:return-e;default:return t.length}}calculatePosition(e,t,i){if(t<=0)return i;const n=e.substring(i,i+t);let s=i;for(;s>0&&(0,p.WL)(e.substring(s-t,s),n);)s-=t;return s+t}}},950781:(e,t,i)=>{var n;i.d(t,{s:()=>n}),function(e){e.Clarity="Clarity",e.Conciseness="Conciseness",e.Formality="Formality",e.Grammar="Grammar",e.Inclusiveness="Inclusiveness",e.Perspectives="Perspectives",e.PunctuationConventions="Punctuation Conventions",e.Resume="Resume",e.SensitiveGeopoliticalReferences="Sensitive Geopolitical References",e.Spelling="Spelling",e.Vocabulary="Vocabulary",e.TonalRewrite="Tone",e.Synonyms="Synonyms",e.DistinctWords="DistinctWords",e.Readability="Readability",e.TimeToRead="TimeToRead",e.TimeToSpeak="TimeToSpeak",e.Similarity="SimilarityCategoryLevel",e.Goals="GoalsCard"}(n||(n={}))},951546:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"LocalizedName":"","IsImplemented":false},"Spelling":{"LocalizedName":"Nsupe","IsImplemented":true}}')},952071:(e,t,i)=>{function n(e){if(null===o&&function(){o={};for(const e in r)o[e]=new RegExp("["+r[e]+"]","g")}(),e&&!function(e){null===s&&function(){let e="[";for(const t in r)e+=r[t];e+="]",s=new RegExp(e)}();const t=null==s?void 0:s.test(e.toLowerCase());return!t}(e))for(const t in o)e=e.replace(o[t],t);return e}i.d(t,{S:()=>n});let s=null,o=null;const r={a:"AÀÁÂÃÄÅàáâãäåĀāĂăĄąǍǎǞǟǠǡǺǻȀȁȂȃȦȧᴀḀḁẠạẢảẤấẦầẨẩẪẫẬậẮắẰằẲẳẴẵẶặÅⒶⓐＡ",b:"BƀƁƂƃɃʙḂḃḄḅḆḇⒷⓑＢ",c:"CÇçĆćĈĉĊċČčƇƈᴄḈḉⒸⓒＣ",d:"DÐðĎďĐđƉƊƋƌȡᴅḊḋḌḍḎḏḐḑḒḓⒹⓓＤ",e:"EÈÉÊËèéêëĒēĔĕĖėĘęĚěȄȅȆȇȨȩᴇḔḕḖḗḘḙḚḛḜḝẸẹẺẻẼẽẾếỀềỂểỄễỆệⒺⓔＥ",f:"FƑƒḞḟⒻⓕＦ",g:"GĜĝĞğĠġĢģƓǤǥǦǧǴǵɢḠḡⒼⓖＧ",h:"HĤĥĦħȞȟʜʰḢḣḤḥḨḩḪḫẖⒽⓗＨ",i:"IÌÍÎÏìíîïĨĩĪīĬĭĮįİıƗǏǐȈȉȊȋɪḬḭḮḯỈỉỊịⒾⓘＩ",j:"JĴĵǰʲᴊⒿⓙＪ",k:"KĶķƘƙǨǩᴋḰḱḲḳḴḵKⓀⓚＫ",l:"LĹĺĻļĽľŁłƚȴȽʟḶḷḸḹḺḻḼḽⓁⓛＬ",m:"MᴍḾḿṀṁṂṃⓂⓜＭ",n:"NÑñŃńŅņŇňƝƞǸǹȠȵɴṄṅṆṇṈṉṊṋⓃⓝＮ",o:"OÒÓÔÕÖØòóôõöøŌōŎŏŐőƟƠơǑǒǪǫǬǭǾǿȌȍȎȏȪȫȬȭȮȯȰȱᴏṌṍṎṏṐṑṒṓỌọỎỏỐốỒồỔổỖỗỘộỚớỜờỞởỠỡỢợⓄⓞＯ",p:"PƤƥᴘṔṕṖṗⓅⓟＰ",q:"QⓆⓠＱ",r:"RŔŕŖŗŘřȐȑȒȓʀʳṘṙṚṛṜṝṞṟⓇⓡＲ",s:"SŚśŜŝŞşŠšſȘșṠṡṢṣṤṥṦṧṨṩẛⓈⓢＳ",t:"TŢţŤťŦŧƫƬƭƮȚțᴛṪṫṬṭṮṯṰṱⓉⓣＴ",u:"UÙÚÛÜùúûüŨũŪūŬŭŮůŰűŲųƯưǓǔǕǖǗǘǙǚǛǜȔȕȖȗᴜṲṳṴṵṶṷṸṹṺṻỤụỦủỨứỪừỬửỮữỰựⓊⓤＵ",v:"VƲᴠṼṽṾṿⓋⓥＶ",w:"WŴŵʷᴡẀẁẂẃẆẇẈẉⓌⓦＷ",x:"XƳƴẊẋⓍⓧＸ",y:"YÝýÿŶŷŸƵƶȲȳʏʸẎẏỲỳỴỵỶỷỸỹⓎⓨＹ",z:"ZŹźŻżŽžȤȥᴢẐẑẒẓẔẕⓏⓩＺ",2:"²②",3:"³③",μ:"µΜ",1:"¹①",ae:"ÆæǢǣǼǽ",th:"Þþ",ss:"ßẞ",ŋ:"Ŋ",oe:"Œœ",ƅ:"Ƅ",ɔ:"Ɔᴐ",ǝ:"Ǝ",ə:"Ə",ɛ:"Ɛ",ɣ:"Ɣ",ɩ:"Ɩ",ɯ:"Ɯ",ƣ:"Ƣ",ʀ:"Ʀ",ƨ:"Ƨ",ʃ:"Ʃ",ʊ:"Ʊ",ʒ:"ƷǮǯᴣ",ƹ:"Ƹ",ƽ:"Ƽ",ƕ:"Ƕ",ƿ:"Ƿ",ȝ:"Ȝ",ȣ:"Ȣ",ⱥ:"Ⱥ",ȼ:"Ȼ",ⱦ:"Ⱦ",ʔ:"Ɂɂ",ʉ:"Ʉ",ʌ:"Ʌ",ɇ:"Ɇ",ɉ:"Ɉ",ɋ:"Ɋ",ɍ:"Ɍ",ɏ:"Ɏ",œ:"ɶ",ɠ:"ʛ",ɦ:"ʱ",ɹ:"ʴ",ɻ:"ʵ",ʁ:"ʶ",ͱ:"Ͱ",ͳ:"Ͳ",ͷ:"Ͷ",α:"ΆΑάἀἁἂἃἄἅἆἇἈἉἊἋἌἍἎἏὰάᾀᾁᾂᾃᾄᾅᾆᾇᾈᾉᾊᾋᾌᾍᾎᾏᾰᾱᾲᾳᾴᾶᾷᾸᾹᾺΆᾼ",ε:"ΈΕέϵἐἑἒἓἔἕἘἙἚἛἜἝὲέῈΈ",η:"ΉΗήἠἡἢἣἤἥἦἧἨἩἪἫἬἭἮἯὴήᾐᾑᾒᾓᾔᾕᾖᾗᾘᾙᾚᾛᾜᾝᾞᾟῂῃῄῆῇῊΉῌ",ι:"ΊΙίἰἱἲἳἴἵἶἷἸἹἺἻἼἽἾἿὶίιῐῑῖῘῙῚΊ",ο:"ΌΟόὀὁὂὃὄὅὈὉὊὋὌὍὸόῸΌ",υ:"ΎΥύϒϓϔὐὑὒὓὔὕὖὗὙὛὝὟὺύῠῡῦῨῩῪΎ",ω:"ΏΩώὠὡὢὣὤὥὦὧὨὩὪὫὬὭὮὯὼώᾠᾡᾢᾣᾤᾥᾦᾧᾨᾩᾪᾫᾬᾭᾮᾯῲῳῴῶῷῺΏῼΩ",ϊ:"ΐΪῒΐῗ",β:"Βϐ",γ:"Γᴦ",δ:"Δ",ζ:"Ζ",θ:"Θϑϴ",κ:"Κϰ",λ:"Λᴧ",ν:"Ν",ξ:"Ξ",π:"Πϖᴨ",ρ:"ΡϱᴩῤῥῬ",σ:"ΣςϹ",τ:"Τ",φ:"Φϕ",χ:"Χ",ψ:"Ψᴪ",ϋ:"Ϋΰῢΰῧ",ϙ:"Ϙ",ϛ:"Ϛ",ϝ:"Ϝ",ϟ:"Ϟ",ϡ:"Ϡ",ϣ:"Ϣ",ϥ:"Ϥ",ϧ:"Ϧ",ϩ:"Ϩ",ϫ:"Ϫ",ϭ:"Ϭ",ϯ:"Ϯ",ς:"ϲ",ϸ:"Ϸ",ϻ:"Ϻ",е:"ЀЁЕѐёӖӗ",ђ:"Ђ",г:"ЃГѓ",є:"Є",ѕ:"Ѕ",і:"І",ї:"Ї",ј:"Ј",љ:"Љ",њ:"Њ",ћ:"Ћ",к:"ЌКќ",и:"ЍИЙйѝӢӣ",у:"ЎУўӮӯӲӳ",џ:"Џ",а:"АӐӑ",б:"Б",в:"В",д:"Д",ж:"ЖӁӂ",з:"З",л:"Лᴫ",м:"М",н:"Н",о:"О",п:"П",р:"Р",с:"С",т:"Т",ф:"Ф",х:"Х",ц:"Ц",ч:"Ч",ш:"Ш",щ:"Щ",ъ:"Ъ",ы:"Ы",ь:"Ь",э:"Э",ю:"Ю",я:"Я",ѡ:"Ѡ",ѣ:"Ѣ",ѥ:"Ѥ",ѧ:"Ѧ",ѩ:"Ѩ",ѫ:"Ѫ",ѭ:"Ѭ",ѯ:"Ѯ",ѱ:"Ѱ",ѳ:"Ѳ",ѵ:"ѴѶѷ",ѹ:"Ѹ",ѻ:"Ѻ",ѽ:"Ѽ",ѿ:"Ѿ",ҁ:"Ҁ",ҋ:"Ҋ",ҍ:"Ҍ",ҏ:"Ҏ",ґ:"Ґ",ғ:"Ғ",ҕ:"Ҕ",җ:"Җ",ҙ:"Ҙ",қ:"Қ",ҝ:"Ҝ",ҟ:"Ҟ",ҡ:"Ҡ",ң:"Ң",ҥ:"Ҥ",ҧ:"Ҧ",ҩ:"Ҩ",ҫ:"Ҫ",ҭ:"Ҭ",ү:"Ү",ұ:"Ұ",ҳ:"Ҳ",ҵ:"Ҵ",ҷ:"Ҷ",ҹ:"Ҹ",һ:"Һ",ҽ:"Ҽ",ҿ:"Ҿ",ӄ:"Ӄ",ӆ:"Ӆ",ӈ:"Ӈ",ӊ:"Ӊ",ӌ:"Ӌ",ӎ:"Ӎ",ӓ:"Ӓ",ӕ:"Ӕ",ә:"Ә",ӛ:"Ӛ",ӝ:"Ӝ",ӟ:"Ӟ",ӡ:"Ӡ",ӥ:"Ӥ",ӧ:"Ӧ",ө:"Ө",ӫ:"Ӫ",ӭ:"Ӭ",ӱ:"Ӱ",ӵ:"Ӵ",ӷ:"Ӷ",ӹ:"Ӹ",ӻ:"Ӻ",ӽ:"Ӽ",ӿ:"Ӿ",ԁ:"Ԁ",ԃ:"Ԃ",ԅ:"Ԅ",ԇ:"Ԇ",ԉ:"Ԉ",ԋ:"Ԋ",ԍ:"Ԍ",ԏ:"Ԏ",ԑ:"Ԑ",ԓ:"Ԓ",ԕ:"Ԕ",ԗ:"Ԗ",ԙ:"Ԙ",ԛ:"Ԛ",ԝ:"Ԝ",ԟ:"Ԟ",ԡ:"Ԡ",ԣ:"Ԣ",ԥ:"Ԥ",ԧ:"Ԧ",ա:"Ա",բ:"Բ",գ:"Գ",դ:"Դ",ե:"Ե",զ:"Զ",է:"Է",ը:"Ը",թ:"Թ",ժ:"Ժ",ի:"Ի",լ:"Լ",խ:"Խ",ծ:"Ծ",կ:"Կ",հ:"Հ",ձ:"Ձ",ղ:"Ղ",ճ:"Ճ",մ:"Մ",յ:"Յ",ն:"Ն",շ:"Շ",ո:"Ո",չ:"Չ",պ:"Պ",ջ:"Ջ",ռ:"Ռ",ս:"Ս",վ:"Վ",տ:"Տ",ր:"Ր",ց:"Ց",ւ:"Ւ",փ:"Փ",ք:"Ք",օ:"Օ",ֆ:"Ֆ",ا:"آأإ",و:"ؤ",ي:"ئى",ه:"ة",ە:"ۀ",ہ:"ۂ",ے:"ۓ",न:"ऩ",र:"ऱ",ळ:"ऴ",क:"क़",ख:"ख़",ग:"ग़",ज:"ज़",ड:"ड़",ढ:"ढ़",फ:"फ़",य:"य़",ড:"ড়",ঢ:"ঢ়",য:"য়",ਲ:"ਲ਼",ਸ:"ਸ਼",ਖ:"ਖ਼",ਗ:"ਗ਼",ਜ:"ਜ਼",ਫ:"ਫ਼",ଡ:"ଡ଼",ଢ:"ଢ଼",ஒ:"ஔ",ག:"གྷ",ཌ:"ཌྷ",ད:"དྷ",བ:"བྷ",ཛ:"ཛྷ",ཀ:"ཀྵ",ဥ:"ဦ",ⴀ:"Ⴀ",ⴁ:"Ⴁ",ⴂ:"Ⴂ",ⴃ:"Ⴃ",ⴄ:"Ⴄ",ⴅ:"Ⴅ",ⴆ:"Ⴆ",ⴇ:"Ⴇ",ⴈ:"Ⴈ",ⴉ:"Ⴉ",ⴊ:"Ⴊ",ⴋ:"Ⴋ",ⴌ:"Ⴌ",ⴍ:"Ⴍ",ⴎ:"Ⴎ",ⴏ:"Ⴏ",ⴐ:"Ⴐ",ⴑ:"Ⴑ",ⴒ:"Ⴒ",ⴓ:"Ⴓ",ⴔ:"Ⴔ",ⴕ:"Ⴕ",ⴖ:"Ⴖ",ⴗ:"Ⴗ",ⴘ:"Ⴘ",ⴙ:"Ⴙ",ⴚ:"Ⴚ",ⴛ:"Ⴛ",ⴜ:"Ⴜ",ⴝ:"Ⴝ",ⴞ:"Ⴞ",ⴟ:"Ⴟ",ⴠ:"Ⴠ",ⴡ:"Ⴡ",ⴢ:"Ⴢ",ⴣ:"Ⴣ",ⴤ:"Ⴤ",ⴥ:"Ⴥ",æ:"ᴁ",ð:"ᴆ",ł:"ᴌ",ḧ:"Ḧ",ẅ:"Ẅ",ẍ:"Ẍ",ỻ:"Ỻ",ỽ:"Ỽ",ỿ:"Ỿ",pts:"₧",tm:"™",ⅎ:"Ⅎ",4:"④",5:"⑤",6:"⑥",7:"⑦",8:"⑧",9:"⑨",10:"⑩",11:"⑪",12:"⑫",13:"⑬",14:"⑭",15:"⑮",16:"⑯",17:"⑰",18:"⑱",19:"⑲",20:"⑳",0:"⓪",ⰰ:"Ⰰ",ⰱ:"Ⰱ",ⰲ:"Ⰲ",ⰳ:"Ⰳ",ⰴ:"Ⰴ",ⰵ:"Ⰵ",ⰶ:"Ⰶ",ⰷ:"Ⰷ",ⰸ:"Ⰸ",ⰹ:"Ⰹ",ⰺ:"Ⰺ",ⰻ:"Ⰻ",ⰼ:"Ⰼ",ⰽ:"Ⰽ",ⰾ:"Ⰾ",ⰿ:"Ⰿ",ⱀ:"Ⱀ",ⱁ:"Ⱁ",ⱂ:"Ⱂ",ⱃ:"Ⱃ",ⱄ:"Ⱄ",ⱅ:"Ⱅ",ⱆ:"Ⱆ",ⱇ:"Ⱇ",ⱈ:"Ⱈ",ⱉ:"Ⱉ",ⱊ:"Ⱊ",ⱋ:"Ⱋ",ⱌ:"Ⱌ",ⱍ:"Ⱍ",ⱎ:"Ⱎ",ⱏ:"Ⱏ",ⱐ:"Ⱐ",ⱑ:"Ⱑ",ⱒ:"Ⱒ",ⱓ:"Ⱓ",ⱔ:"Ⱔ",ⱕ:"Ⱕ",ⱖ:"Ⱖ",ⱗ:"Ⱗ",ⱘ:"Ⱘ",ⱙ:"Ⱙ",ⱚ:"Ⱚ",ⱛ:"Ⱛ",ⱜ:"Ⱜ",ⱝ:"Ⱝ",ⱞ:"Ⱞ",ⱡ:"Ⱡ",ɫ:"Ɫ",ᵽ:"Ᵽ",ɽ:"Ɽ",ⱨ:"Ⱨ",ⱪ:"Ⱪ",ⱬ:"Ⱬ",ɑ:"Ɑ",ɱ:"Ɱ",ɐ:"Ɐ",ⱳ:"Ⱳ",ⱶ:"Ⱶ",ȿ:"Ȿ",ɀ:"Ɀ",ⲁ:"Ⲁ",ⲃ:"Ⲃ",ⲅ:"Ⲅ",ⲇ:"Ⲇ",ⲉ:"Ⲉ",ⲋ:"Ⲋ",ⲍ:"Ⲍ",ⲏ:"Ⲏ",ⲑ:"Ⲑ",ⲓ:"Ⲓ",ⲕ:"Ⲕ",ⲗ:"Ⲗ",ⲙ:"Ⲙ",ⲛ:"Ⲛ",ⲝ:"Ⲝ",ⲟ:"Ⲟ",ⲡ:"Ⲡ",ⲣ:"Ⲣ",ⲥ:"Ⲥ",ⲧ:"Ⲧ",ⲩ:"Ⲩ",ⲫ:"Ⲫ",ⲭ:"Ⲭ",ⲯ:"Ⲯ",ⲱ:"Ⲱ",ⲳ:"Ⲳ",ⲵ:"Ⲵ",ⲷ:"Ⲷ",ⲹ:"Ⲹ",ⲻ:"Ⲻ",ⲽ:"Ⲽ",ⲿ:"Ⲿ",ⳁ:"Ⳁ",ⳃ:"Ⳃ",ⳅ:"Ⳅ",ⳇ:"Ⳇ",ⳉ:"Ⳉ",ⳋ:"Ⳋ",ⳍ:"Ⳍ",ⳏ:"Ⳏ",ⳑ:"Ⳑ",ⳓ:"Ⳓ",ⳕ:"Ⳕ",ⳗ:"Ⳗ",ⳙ:"Ⳙ",ⳛ:"Ⳛ",ⳝ:"Ⳝ",ⳟ:"Ⳟ",ⳡ:"Ⳡ",ⳣ:"Ⳣ",ブ:"ヴ",21:"㉑",22:"㉒",23:"㉓",24:"㉔",25:"㉕",26:"㉖",27:"㉗",28:"㉘",29:"㉙",30:"㉚",31:"㉛",32:"㉜",33:"㉝",34:"㉞",35:"㉟",ㄱ:"㉠",ㄴ:"㉡",ㄷ:"㉢",ㄹ:"㉣",ㅁ:"㉤",ㅂ:"㉥",ㅅ:"㉦",ㅇ:"㉧",ㅈ:"㉨",ㅊ:"㉩",ㅋ:"㉪",ㅌ:"㉫",ㅍ:"㉬",ㅎ:"㉭",가:"㉮",나:"㉯",다:"㉰",라:"㉱",마:"㉲",바:"㉳",사:"㉴",아:"㉵",자:"㉶",차:"㉷",카:"㉸",타:"㉹",파:"㉺",하:"㉻",참고:"㉼",주의:"㉽",우:"㉾",一:"㊀",二:"㊁",三:"㊂",四:"㊃",五:"㊄",六:"㊅",七:"㊆",八:"㊇",九:"㊈",十:"㊉",月:"㊊",火:"㊋",水:"㊌",木:"㊍",金:"㊎",土:"㊏",日:"㊐",株:"㊑",有:"㊒",社:"㊓",名:"㊔",特:"㊕",財:"㊖",祝:"㊗",労:"㊘",秘:"㊙",男:"㊚",女:"㊛",適:"㊜",優:"㊝",印:"㊞",注:"㊟",項:"㊠",休:"㊡",写:"㊢",正:"㊣",上:"㊤",中:"㊥",下:"㊦",左:"㊧",右:"㊨",医:"㊩",宗:"㊪",学:"㊫",監:"㊬",企:"㊭",資:"㊮",協:"㊯",夜:"㊰",36:"㊱",37:"㊲",38:"㊳",39:"㊴",40:"㊵",41:"㊶",42:"㊷",43:"㊸",44:"㊹",45:"㊺",46:"㊻",47:"㊼",48:"㊽",49:"㊾",50:"㊿","1月":"㋀","2月":"㋁","3月":"㋂","4月":"㋃","5月":"㋄","6月":"㋅","7月":"㋆","8月":"㋇","9月":"㋈","10月":"㋉","11月":"㋊","12月":"㋋",hg:"㋌",erg:"㋍",ev:"㋎",ltd:"㋏",ア:"㋐",イ:"㋑",ウ:"㋒",エ:"㋓",オ:"㋔",カ:"㋕",キ:"㋖",ク:"㋗",ケ:"㋘",コ:"㋙",サ:"㋚",シ:"㋛",ス:"㋜",セ:"㋝",ソ:"㋞",タ:"㋟",チ:"㋠",ツ:"㋡",テ:"㋢",ト:"㋣",ナ:"㋤",ニ:"㋥",ヌ:"㋦",ネ:"㋧",ノ:"㋨",ハ:"㋩",ヒ:"㋪",フ:"㋫",ヘ:"㋬",ホ:"㋭",マ:"㋮",ミ:"㋯",ム:"㋰",メ:"㋱",モ:"㋲",ヤ:"㋳",ユ:"㋴",ヨ:"㋵",ラ:"㋶",リ:"㋷",ル:"㋸",レ:"㋹",ロ:"㋺",ワ:"㋻",ヰ:"㋼",ヱ:"㋽",ヲ:"㋾",アパート:"㌀",アルファ:"㌁",アンペア:"㌂",アール:"㌃",イニング:"㌄",インチ:"㌅",ウォン:"㌆",エスクード:"㌇",エーカー:"㌈",オンス:"㌉",オーム:"㌊",カイリ:"㌋",カラット:"㌌",カロリー:"㌍",ガロン:"㌎",ガンマ:"㌏",ギガ:"㌐",ギニー:"㌑",キュリー:"㌒",ギルダー:"㌓",キロ:"㌔",キログラム:"㌕",キロメートル:"㌖",キロワット:"㌗",グラム:"㌘",グラムトン:"㌙",クルゼイロ:"㌚",クローネ:"㌛",ケース:"㌜",コルナ:"㌝",コーポ:"㌞",サイクル:"㌟",サンチーム:"㌠",シリング:"㌡",センチ:"㌢",セント:"㌣",ダース:"㌤",デシ:"㌥",ドル:"㌦",トン:"㌧",ナノ:"㌨",ノット:"㌩",ハイツ:"㌪",パーセント:"㌫",パーツ:"㌬",バーレル:"㌭",ピアストル:"㌮",ピクル:"㌯",ピコ:"㌰",ビル:"㌱",ファラッド:"㌲",フィート:"㌳",ブッシェル:"㌴",フラン:"㌵",ヘクタール:"㌶",ペソ:"㌷",ペニヒ:"㌸",ヘルツ:"㌹",ペンス:"㌺",ページ:"㌻",ベータ:"㌼",ポイント:"㌽",ボルト:"㌾",ホン:"㌿",ポンド:"㍀",ホール:"㍁",ホーン:"㍂",マイクロ:"㍃",マイル:"㍄",マッハ:"㍅",マルク:"㍆",マンション:"㍇",ミクロン:"㍈",ミリ:"㍉",ミリバール:"㍊",メガ:"㍋",メガトン:"㍌",メートル:"㍍",ヤード:"㍎",ヤール:"㍏",ユアン:"㍐",リットル:"㍑",リラ:"㍒",ルピー:"㍓",ルーブル:"㍔",レム:"㍕",レントゲン:"㍖",ワット:"㍗","0点":"㍘","1点":"㍙","2点":"㍚","3点":"㍛","4点":"㍜","5点":"㍝","6点":"㍞","7点":"㍟","8点":"㍠","9点":"㍡","10点":"㍢","11点":"㍣","12点":"㍤","13点":"㍥","14点":"㍦","15点":"㍧","16点":"㍨","17点":"㍩","18点":"㍪","19点":"㍫","20点":"㍬","21点":"㍭","22点":"㍮","23点":"㍯","24点":"㍰",hpa:"㍱",da:"㍲",au:"㍳",bar:"㍴",ov:"㍵",pc:"㍶",dm:"㍷",dm2:"㍸",dm3:"㍹",iu:"㍺",平成:"㍻",昭和:"㍼",大正:"㍽",明治:"㍾",株式会社:"㍿",pa:"㎀㎩",na:"㎁",μa:"㎂",ma:"㎃",ka:"㎄",kb:"㎅",mb:"㎆㏔",gb:"㎇",cal:"㎈",kcal:"㎉",pf:"㎊",nf:"㎋",μf:"㎌",μg:"㎍",mg:"㎎",kg:"㎏",hz:"㎐",khz:"㎑",mhz:"㎒",ghz:"㎓",thz:"㎔",μℓ:"㎕",mℓ:"㎖",dℓ:"㎗",kℓ:"㎘",fm:"㎙",nm:"㎚",μm:"㎛",mm:"㎜",cm:"㎝",km:"㎞㏎",mm2:"㎟",cm2:"㎠",m2:"㎡",km2:"㎢",mm3:"㎣",cm3:"㎤",m3:"㎥",km3:"㎦",ms:"㎧㎳",ms2:"㎨",kpa:"㎪",mpa:"㎫",gpa:"㎬",rad:"㎭",rads:"㎮",rads2:"㎯",ps:"㎰",ns:"㎱",μs:"㎲",pv:"㎴",nv:"㎵",μv:"㎶",mv:"㎷㎹",kv:"㎸",pw:"㎺",nw:"㎻",μw:"㎼",mw:"㎽㎿",kw:"㎾",kω:"㏀",mω:"㏁",am:"㏂",bq:"㏃",cc:"㏄",cd:"㏅",ckg:"㏆",co:"㏇",db:"㏈",gy:"㏉",ha:"㏊",hp:"㏋",in:"㏌",kk:"㏍",kt:"㏏",lm:"㏐",ln:"㏑",log:"㏒",lx:"㏓",mil:"㏕",mol:"㏖",ph:"㏗",pm:"㏘",ppm:"㏙",pr:"㏚",sr:"㏛",sv:"㏜",wb:"㏝","1日":"㏠","2日":"㏡","3日":"㏢","4日":"㏣","5日":"㏤","6日":"㏥","7日":"㏦","8日":"㏧","9日":"㏨","10日":"㏩","11日":"㏪","12日":"㏫","13日":"㏬","14日":"㏭","15日":"㏮","16日":"㏯","17日":"㏰","18日":"㏱","19日":"㏲","20日":"㏳","21日":"㏴","22日":"㏵","23日":"㏶","24日":"㏷","25日":"㏸","26日":"㏹","27日":"㏺","28日":"㏻","29日":"㏼","30日":"㏽","31日":"㏾",ꙁ:"Ꙁ",ꙃ:"Ꙃ",ꙅ:"Ꙅ",ꙇ:"Ꙇ",ꙉ:"Ꙉ",ꙋ:"Ꙋ",ꙍ:"Ꙍ",ꙏ:"Ꙏ",ꙑ:"Ꙑ",ꙓ:"Ꙓ",ꙕ:"Ꙕ",ꙗ:"Ꙗ",ꙙ:"Ꙙ",ꙛ:"Ꙛ",ꙝ:"Ꙝ",ꙟ:"Ꙟ",ꙣ:"Ꙣ",ꙥ:"Ꙥ",ꙧ:"Ꙧ",ꙩ:"Ꙩ",ꙫ:"Ꙫ",ꙭ:"Ꙭ",ꚁ:"Ꚁ",ꚃ:"Ꚃ",ꚅ:"Ꚅ",ꚇ:"Ꚇ",ꚉ:"Ꚉ",ꚋ:"Ꚋ",ꚍ:"Ꚍ",ꚏ:"Ꚏ",ꚑ:"Ꚑ",ꚓ:"Ꚓ",ꚕ:"Ꚕ",ꚗ:"Ꚗ",ꜣ:"Ꜣ",ꜥ:"Ꜥ",ꜧ:"Ꜧ",ꜩ:"Ꜩ",ꜫ:"Ꜫ",ꜭ:"Ꜭ",ꜯ:"Ꜯ",ꜳ:"Ꜳ",ꜵ:"Ꜵ",ꜷ:"Ꜷ",ꜹ:"Ꜹ",ꜻ:"Ꜻ",ꜽ:"Ꜽ",ꜿ:"Ꜿ",ꝁ:"Ꝁ",ꝃ:"Ꝃ",ꝅ:"Ꝅ",ꝇ:"Ꝇ",ꝉ:"Ꝉ",ꝋ:"Ꝋ",ꝍ:"Ꝍ",ꝏ:"Ꝏ",ꝑ:"Ꝑ",ꝓ:"Ꝓ",ꝕ:"Ꝕ",ꝗ:"Ꝗ",ꝙ:"Ꝙ",ꝛ:"Ꝛ",ꝝ:"Ꝝ",ꝟ:"Ꝟ",ꝡ:"Ꝡ",ꝣ:"Ꝣ",ꝥ:"Ꝥ",ꝧ:"Ꝧ",ꝩ:"Ꝩ",ꝫ:"Ꝫ",ꝭ:"Ꝭ",ꝯ:"Ꝯ",ꝺ:"Ꝺ",ꝼ:"Ꝼ",ᵹ:"Ᵹ",ꝿ:"Ꝿ",ꞁ:"Ꞁ",ꞃ:"Ꞃ",ꞅ:"Ꞅ",ꞇ:"Ꞇ",ꞌ:"Ꞌ",ꞑ:"Ꞑ",ꞡ:"Ꞡ",ꞣ:"Ꞣ",ꞥ:"Ꞥ",ꞧ:"Ꞧ",ꞩ:"Ꞩ",י:"יִיּ",ײ:"ײַ",ש:"שׁשׂשּׁשּׂשּ",א:"אַאָאּ",ב:"בּבֿ",ג:"גּ",ד:"דּ",ה:"הּ",ו:"וּוֹ",ז:"זּ",ט:"טּ",ך:"ךּ",כ:"כּכֿ",ל:"לּ",מ:"מּ",נ:"נּ",ס:"סּ",ף:"ףּ",פ:"פּפֿ",צ:"צּ",ק:"קּ",ר:"רּ",ת:"תּ"}},952153:(e,t,i)=>{i.d(t,{B:()=>v});var n=i(379490),s=i(833801),o=i(298070),r=i(838630),a=i(689878),l=i(691474),d=i(920117),c=i(163573),u=i(753031),g=i(229906),h=i(83010);const p=new Map([[d.l.EnableCopilotInsert,!0],[d.l.EnableCopilotRewrite,!0],[d.l.EnableSpelling,!0],[d.l.EnableGrammar,!0],[d.l.EnableRefinements,!0],[d.l.EnableTelemetry,!0]]),m=new Map([[d.l.AppId,"EditorBX_Online"],[d.l.Descriptors,JSON.stringify([{name:"FlightIds",value:"Wac-WordEditorServiceSuggestionDescriptionsNoReferenceInformation-Treatment;Wac-WordEditorServiceMultipleGrammarCritiquesPerSentence-Treatment"}])],[d.l.ProofingLanguages,[]],[d.l.CritiqueValuePerLanguage,JSON.stringify([])],[d.l.DefaultProofingLanguageInitialized,!1],[d.l.ProofingLanguageListInitialized,!1],[d.l.IsLanguageAutoDetectEnabled,!0],[d.l.TonalFREAccepted,!1],[d.l.EnableEditor,!0],[d.l.EnableTextPrediction,!0],[d.l.EnableCIQFlags,!0],[d.l.EnableCIQMenu,!0],[d.l.OverriddenCritiqueTypeOptions,[]],[d.l.OverriddenInlineEditingSettings,[]],[d.l.PaneOverriddenCritiqueTypeOptions,[]],[d.l.StealthOverriddenCritiqueTypeOptions,[]],[d.l.ShowSynonyms,!1],[d.l.EnableSynonymsToggle,!1],[d.l.ConfigurationId,""],[d.l.ClientId,""],[d.l.HashedUserDictionary,[]]]),f=new Map([[d.l.DefaultLoggingLevel,u.q.Info],[d.l.DebugMode,!1]]);let v=class extends s.u{populateStoreEntryMap(){const e=new Map;return p.forEach(((t,i)=>{e.set(i,{storeEntry:(0,o.EM)(i,t),isSynced:!0})})),m.forEach(((t,i)=>{e.set(i,{storeEntry:(0,o.EM)(i,t)})})),f.forEach(((t,i)=>{e.set(i,{storeEntry:(0,o.EM)(i,t,!0)})})),e}constructor(e,t,i,n){super(e,t),this.storeEntryReader=e,this.storeEntryWriter=t,this._emitter=i,this._hostSettings=n,this.write(d.l.AppId,this._hostSettings.appId)}async initialize(){for(const e of p.keys())await this.read(e);await this.read(d.l.ConfigurationId);const e=Array.from(p.keys());e.push(...Array.from(m.keys())),e.push(...Array.from(f.keys()));for(const t of e)this._emitter.on(t,(()=>this.read(t)))}shutDown(){}async read(e){return e===d.l.AppId?Promise.resolve(this._hostSettings.appId):super.read(e)}async removePersistentKeys(){const e=Array.from(p.keys());e.push(...Array.from(m.keys())),e.push(...Array.from(f.keys())),e.length&&await this.storeEntryWriter.remove(e)}};v=(0,n.__decorate)([(0,g._)(),(0,n.__param)(0,(0,h.W)(r.A)),(0,n.__param)(1,(0,h.W)(a.a)),(0,n.__param)(2,(0,h.W)(l.E)),(0,n.__param)(3,(0,h.W)(c.n))],v)},955146:(e,t,i)=>{function n(e){var t;if(e)return"true"===(null===(t=e.contentEditable)||void 0===t?void 0:t.toLowerCase())?e:n(e.parentElement)}i.d(t,{m:()=>n})},955377:(e,t,i)=>{i.d(t,{W:()=>n});const n=(0,i(668952).f)("IDisableCritiqueHandler")},955637:(e,t,i)=>{i.d(t,{C:()=>c});var n=i(541647),s=i(248401),o=i(74372),r=i(252723),a=i(108520),l=i(208520);const d=(0,r.F5)({squigglerCanvasRenderingState:a.A.on(n.C),contentEditableSquigglerComponent:a.A.on(s.u).optional(),inputControlsSquigglerComponent:a.A.on(o.$K).optional()}),c=()=>{const{contentEditableSquigglerComponent:e,inputControlsSquigglerComponent:t,squigglerCanvasRenderingState:i}=(0,r.KN)(d),n=[],s=[],[o,a]=l.useState(i);if(l.useEffect((()=>(i.subscribe("stateUpdated",a),()=>{i.unsubscribe("stateUpdated",a)})),[i]),!o.visible)return null;if(e)for(const[t,s]of o.squigglers)i.getTileVisibility(s.proofedElements[0].id)&&n.push(e(t,s));if(t)for(const e of o.inputControlsProxyList)s.push(t(e));return l.createElement(l.Fragment,null,...s,...n)}},956844:(e,t,i)=>{if(i.d(t,{n:()=>o}),0!=i.j)var n=i(772649);if(0!=i.j)var s=i(11353);function o(){const e=new n.m(s.g);return new s.K(e)}},957242:(e,t,i)=>{if(i.d(t,{A:()=>l,o:()=>d}),0!=i.j)var n=i(329423);var s=i(766535);if(0!=i.j)var o=i(611256);if(0!=i.j)var r=i(718385);const a=[s.L9.TopicSuggestion,s.L9.CIQFlag_Topic];function l(e){return e.some((e=>e.critiqueDiffType!==n.K.Move&&a.includes(e.critique.typeId)))}function d(e,t){const i=[];for(const t of e.values())for(const e of t)a.includes(e.typeId)&&i.push(e);const n=(0,o.k)(i);return(0,r.Y)(n,3,!0,t)}},960118:(e,t,i)=>{i.d(t,{U:()=>n,f:()=>s});const n=10;function s(e){return e.replace(/\s+/g," ").trim().split(" ").slice(0,n).join(" ")}},960469:(e,t,i)=>{if(i.d(t,{V:()=>r}),0!=i.j)var n=i(589551);var s=i(208520);const o="light";function r(){const{theme:e}=(0,n.I)({},s.createRef());if(!(null==e?void 0:e.colorNeutralBackground1)||!e.colorNeutralForeground1)return o;const t=a(e.colorNeutralBackground1),i=a(e.colorNeutralForeground1);return t.lightness<i.lightness?"dark":"light"}function a(e){const t=e.replace(/^#/,""),i=parseInt(t.substring(0,2),16)/255,n=parseInt(t.substring(2,4),16)/255,s=parseInt(t.substring(4,6),16)/255,o=Math.max(i,n,s),r=Math.min(i,n,s),a=(o+r)/2;let l=0,d=0;if(o===r)l=d=0;else{const e=o-r;switch(d=a>.5?e/(2-o-r):e/(o+r),o){case i:l=(n-s)/e+(n<s?6:0);break;case n:l=(s-i)/e+2;break;case s:l=(i-n)/e+4}l/=6}return{hue:Math.round(360*l),saturation:Math.round(100*d),lightness:Math.round(100*a)}}},961147:(e,t,i)=>{i.d(t,{p:()=>n});const n=(0,i(668952).f)("ISquigglePositioningEdgeCases")},961223:(e,t,i)=>{i.d(t,{v:()=>g});var n=i(379490),s=i(537969),o=i(823325),r=i(163573),a=i(821003),l=i(229906),d=i(66008),c=i(83010),u=i(347601);let g=class{constructor(e,t,i,n){this._hostEmitters=e,this._hostSettings=t,this._oaResultsStore=i,this._queryDetection=n,this.onOARankedAnnotationsEvent=e=>{const t=e.message.data,i=Object.assign(Object.assign({},t),{eventType:e.message.messageType,isLoading:!1});this.onEvent(i)},this.oaAnnotationsTriggeredEvent=e=>{this._oaResultsStore.updateLoadingStatus(!0)}}async initialize(){var e;if(this._hostSettings.enableOrchestration&&(null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.isContextualCardEnabled))for(const e of this._hostEmitters)e.on(s.pD.oaAnnotationsTriggered,this.oaAnnotationsTriggeredEvent),e.on(s.pD.oaRankedAnnotations,this.onOARankedAnnotationsEvent)}shutDown(){}onEvent(e){const{results:t,tileId:i,latency:n,resultStatus:s,queryCorrelationKeys:r,resultSummary:a}=e;switch(e.eventType){case o.G.NewData:case o.G.ChangeData:this._oaResultsStore.updateResults(t,i,s,r?Object.assign(Object.assign({},r),{scopeInfo:this._queryDetection.getCurrentScope()}):void 0,n,a);break;case o.G.RemoveData:this._oaResultsStore.clearResults()}}};g=(0,n.__decorate)([(0,l._)(),(0,n.__param)(0,(0,d.t)(s.zJ)),(0,n.__param)(1,(0,c.W)(r.n)),(0,n.__param)(2,(0,c.W)(u.C)),(0,n.__param)(3,(0,c.W)(a.J))],g)},961641:(e,t,i)=>{i.d(t,{e:()=>s,rI:()=>o});var n=i(668952);const s=(0,n.f)("ILanguageListStateStore"),o=((0,n.f)("SupportsIndividualCIQFlagDisabling"),(0,n.f)("IEditorSettingsManager"))},962015:e=>{e.exports={r:"49.106.0"}},963116:(e,t,i)=>{i.d(t,{C:()=>b});var n=i(379490),s=i(229906),o=i(83010),r=i(668952);const a=(0,r.f)("ISelectedCritiqueCategory");let l=class{constructor(e){this._selectedCritiqueCategory=e}filter(e){return!!e&&(!this._selectedCritiqueCategory.isAnyCategorySelected()||void 0!==e.categoryTitle&&this._selectedCritiqueCategory.isCritiqueCategorySelected(e.categoryTitle))}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(a))],l);var d=i(636234),c=i(611103),u=i(922630),g=i(18233);(0,r.f)("StealthSquiggleEnabledCritiqueTypesArray");const h=(0,r.f)("IStealthSquiggleEnabledCritiqueTypes");var p=i(37741),m=i(427603),f=i(78827),v=i(761799);let y=class{constructor(e,t,i){this._enabledCritiqueTypes=e,this._upsellStore=t,this._hostSettings=i}filter(e){var t,i;let n=!0;if(null===(t=this._upsellStore)||void 0===t?void 0:t.isUpsellUser){const t=null!==(i=e.typeId)&&void 0!==i?i:"";this._enabledCritiqueTypes.isCritiqueTypePremium(t)&&(this._hostSettings.enableOrchestration&&this._upsellStore.addPremiumCritique((0,p.OE)(e)),n=this._upsellStore.previewPremiumSquiggles)}return n}};y=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(f.g)),(0,n.__param)(1,(0,m.l)()),(0,n.__param)(1,(0,o.W)(v.Ey)),(0,n.__param)(2,(0,o.W)(u.n))],y);var _=i(420821);const I=(0,r.f)("ISpellingSettingsStore");let C=class{constructor(e){this._spellingSettingsStore=e}filter(e){var t;if(!e)return!1;if(e.priority!==_.bx.High||!this._spellingSettingsStore.isSpellingDisabledForAnyLanguage())return!0;const i=[];for(const n of e.suggestions){const e=null!==(t=n.languages)&&void 0!==t?t:[];n.languages=e.filter((e=>this._spellingSettingsStore.isSpellingEnabledForLanguage(e))),n.languages.length&&i.push(n)}return e.suggestions=i,!!i.length}};C=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(I))],C);var S=i(66008);let b=class{constructor(e,t,i,n,s,o,r,a){this._dictionaryCritiqueFilter=e,this._basicCritiqueFilters=t,this._hostSettings=i,this._featureFlagsReader=n,this._premiumCritiqueFilter=s,this._spellingCritiqueFilter=o,this._categoryCritiqueFilter=r,this._stealthSquiggleEnabledCritiqueTypes=a,this._critiqueFilters=[]}async initialize(){this._critiqueFilters.push(this._dictionaryCritiqueFilter),!this._hostSettings.enableOrchestration&&this._featureFlagsReader.flags.enableCritiqueSettings&&this._spellingCritiqueFilter&&this._critiqueFilters.push(this._spellingCritiqueFilter),this._critiqueFilters.push(...this._basicCritiqueFilters),this._hostSettings.enhancedUpsellEnabled&&this._premiumCritiqueFilter&&this._critiqueFilters.push(this._premiumCritiqueFilter),this._categoryCritiqueFilter&&this._critiqueFilters.push(this._categoryCritiqueFilter)}shutDown(){this._critiqueFilters.splice(0,this._critiqueFilters.length)}applyFilters(e){if(!e)return[];return e.filter((e=>{var t,i,n;const s=e.isVisible,o=e.isStealth;let r=!0;const a=null!==(n=null===(t=this._stealthSquiggleEnabledCritiqueTypes)||void 0===t?void 0:t.isCritiqueTypeEnabled(null!==(i=e.typeId)&&void 0!==i?i:"",e.priority))&&void 0!==n&&n;for(const t of this._critiqueFilters)if(r=t.filter(e),!r)break;return e.isVisible=r,e.isStealth=a,e.isVisible!==s||e.isStealth!==o}))}};b=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(d.v)),(0,n.__param)(1,(0,S.t)(c.D)),(0,n.__param)(1,(0,m.l)()),(0,n.__param)(2,(0,o.W)(u.n)),(0,n.__param)(3,(0,o.W)(g.c)),(0,n.__param)(4,(0,m.l)()),(0,n.__param)(4,(0,o.W)(y)),(0,n.__param)(5,(0,m.l)()),(0,n.__param)(5,(0,o.W)(C)),(0,n.__param)(6,(0,m.l)()),(0,n.__param)(6,(0,o.W)(l)),(0,n.__param)(7,(0,m.l)()),(0,n.__param)(7,(0,o.W)(h))],b)},963804:(e,t,i)=>{if(i.d(t,{N:()=>l}),0!=i.j)var n=i(818935);if(0!=i.j)var s=i(207340);if(0!=i.j)var o=i(332688);if(0!=i.j)var r=i(120733);var a=i(208520);const l=({onButtonClick:e})=>{const t=(0,r.E)("requestEntitiesParams");return a.createElement(n.$,{"data-automation-id":"upload-cloud-files","aria-label":"cloudUpload",icon:a.createElement(s.MJH,null),appearance:"subtle",onClick:()=>{(0,o.jt)(t,"cloud"),null==e||e()}})}},964549:(e,t,i)=>{i.d(t,{_:()=>r});var n=i(999358),s=i(808326),o=i(955146);class r extends n.x{constructor(e){super(e),this.parentContentEditable=(0,o.m)(e)}retrieve(){const e=super.retrieve();return Object.assign(Object.assign(Object.assign({},e),{isInsideTable:this.getIsInsideTable()}),this.getListTypeAndIndentation())}getIsInsideTable(){if(!this.parentContentEditable)return;let e=this.element;for(;e&&e!==this.parentContentEditable;){if("TABLE"===e.nodeName)return!0;e=e.parentElement}return!1}getListTypeAndIndentation(){if(!this.parentContentEditable)return;let e,t,i=this.element;for(;i&&i!==this.parentContentEditable;)"OL"===i.nodeName&&(e||(e=s.pc.Numbered),t=(null!=t?t:-1)+1),"UL"===i.nodeName&&(e||(e=s.pc.Bullet),t=(null!=t?t:-1)+1),i=i.parentElement;return{listType:null!=e?e:s.pc.NoList,indentation:t}}}},965285:(e,t,i)=>{i.d(t,{H:()=>g});var n=i(379490),s=i(823325),o=i(537969),r=i(700509),a=i(67573),l=i(229906),d=i(1144),c=i(419728),u=i(797214);let g=class{constructor(e,t,i,n,o,a,l,u){this._hostEmitters=e,this._hostSettings=t,this._proofingDom=i,this._logger=n,this._critiqueStore=o,this._disableCritiqueHandler=a,this._instrumentationProcessor=l,this._applyFlagHandler=u,this._annotationMap=new Map,this._isDisabled=!1,this.shutDownCallbacks=[],this.ignoredStrings=[],this.shutDown=()=>{for(const e of this.shutDownCallbacks)e();this.flagHandlerShutdown()},this.getFlagData=e=>this._annotationMap.get(e),this.onIgnoreAllOfFlag=(e,t)=>{},this.removeFlag=(e,t)=>{const i=this._annotationMap.get(t);if(!i)return;const n=this.getCommonCritiqueById(i.critique.annotationId);n&&n.isIgnored||(this.emitEvent(s.G.RemoveData,[i.critique],i.critique.nodeId,e),this._annotationMap.delete(t))},this.onHostModelCritiques=e=>{for(const t of e.message.data.critiqueIdsRemoved)this._annotationMap.delete(t)},this.getCommonCritiqueById=e=>{let t;for(const i of this._critiqueStore.getAllCritiques())for(const n of i.critiques)n.annotationId===e&&(t=n);return t},this.onApplyFlag_Internal=(e,t,i,n)=>{if(!t.annotationId)return!0;const o=this._annotationMap.get(t.annotationId);if(o){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,d.l)(e))return this._logger.error(508146688,"Unable to find paragraph node while applying flag"),!1;this.onApplyFlag(e,t,i,n),this._annotationMap.delete(t.annotationId),this.emitEvent(s.G.RemoveData,[o.critique],o.critique.nodeId),this._instrumentationProcessor.process({critique:(0,c.toJS)(t),eventId:r.xp.ChangeAllSuggOther})}else this._logger.error(508146659,"Unable to find flag data while applying flag");return!1},this.onIgnoreFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const i=this._annotationMap.get(t.annotationId);if(i){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,d.l)(e))return this._logger.error(508146658,"Unable to find paragraph node while ignoring flag"),!1;i.critique.isIgnored=!0,this.onIgnoreFlag(e,t),this._annotationMap.delete(t.annotationId),this._instrumentationProcessor.process({critique:(0,c.toJS)(t),eventId:r.xp.Ignore})}else this._logger.error(508146657,"Unable to find flag data while ignoring flag");return!1},this.onIgnoreAllOfFlag_Internal=(e,t)=>{if(!t.annotationId)return!1;const i=this._annotationMap.get(t.annotationId);if(i){const e=t.nodeId?this._proofingDom.findParagraphNode(t.nodeId):void 0;if(!(0,d.l)(e))return this._logger.error(507574145,"Unable to find paragraph node while ignoring all of flag"),!1;if(!t.textInContext)return this._logger.error(507574097,"Unable to find flag textInContext while ignoring all of flag"),!1;this.ignoredStrings.push(t.textInContext),i.critique.isIgnored=!0,this.onIgnoreAllOfFlag(e,t),this._instrumentationProcessor.process({critique:(0,c.toJS)(t),eventId:r.xp.IgnoreAll})}else this._logger.error(507574096,"Unable to find flag data while ignoring all of flag");return!1},this.onDisableFlag_Internal=(e,t)=>{var i;if(!t.annotationId)return!1;this._isDisabled=!0,this.onDisableFlag();for(const e of this._annotationMap.values())this.removeFlag(void 0,e.critique.annotationId);return null===(i=this._disableCritiqueHandler)||void 0===i||i.disableCritique(t),this._instrumentationProcessor.process({critique:(0,c.toJS)(t),eventId:r.xp.DoNotCheckThisIssue}),!1}}async initialize(){if(this._hostSettings.enableOrchestration){for(const e of this._hostEmitters)e.on(o.pD.hostModelCritiques,this.onHostModelCritiques);this._applyFlagHandler&&(this.shutDownCallbacks.push(this._applyFlagHandler.handleApplyFlag(this.getCritiqueType(),this.onApplyFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreFlag(this.getCritiqueType(),this.onIgnoreFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleIgnoreAllOfFlag(this.getCritiqueType(),this.onIgnoreAllOfFlag_Internal)),this.shutDownCallbacks.push(this._applyFlagHandler.handleDisableFlag(this.getCritiqueType(),this.onDisableFlag_Internal))),this.flagHandlerInitialize()}}addFlags(e,t){const i=new Map;for(const e of t){const t=i.get(e.nodeId);t?t.push(e):i.set(e.nodeId,[e])}for(const[t,n]of i)this.addFlagsInSameTile(e,t,n[0].nodeVersion,n)}addFlagsInSameTile(e,t,i,n){if(this._isDisabled)return;const o=n.map((e=>Object.assign(Object.assign({isFlagCritique:!0},e),{nodeId:t,nodeVersion:i,priority:a.bx.Informational,suggestions:[],typeId:this.getCritiqueType(),isIgnored:!1}))).filter((e=>{var t,i,n,s,o;if(e.annotationId&&this._annotationMap.get(e.annotationId))return!1;if(e.textInContext&&this.ignoredStrings.includes(e.textInContext))return!1;const r=this._proofingDom.findParagraphNode(e.nodeId);return!!(null===(t=null==r?void 0:r.parent)||void 0===t?void 0:t.element)&&(null===(o=null===(s=null===(n=null===(i=this._hostSettings.serviceSettings)||void 0===i?void 0:i.flagAnnotationSettings)||void 0===n?void 0:n.shouldRenderFlag)||void 0===s?void 0:s.call(n,(0,u.OE)(e),r.parent.element,e.nodeId,e.start,length))||void 0===o||o)}));this.emitEvent(s.G.NewData,o,t,e,i);for(const e of o)this._annotationMap.set(e.annotationId,{tileId:t,critique:e,additionalData:e.additionalData})}addFlag(e,t,i,n,s,o,r,a,l,d,c,u,g,h,p,m,f){this.addFlagsInSameTile(e,s,o,[{annotationId:t,textInContext:r,length:l,start:a,languageId:n,traceId:i,supportedActions:d,supportedEntityTypes:c,suggestionItems:u,groupTitle:h,groupSubtitle:p,tooltipTitle:m,categoryTitle:f,additionalData:g}])}emitEvent(e,t,i,n=void 0,r=0){for(const a of this._hostEmitters)a.emit(o.pD.hostModelFlags,{address:n,message:{messageType:s.G.ChangeData,data:{critiquesAdded:e===s.G.NewData?t:[],critiqueIdsRemoved:e===s.G.RemoveData?t.map((e=>e.annotationId)):[],tileId:i,tileVersion:r,source:"Local"}}})}};g=(0,n.__decorate)([(0,l._)()],g)},966727:(e,t,i)=>{i.d(t,{Bn:()=>n,K3:()=>o,fQ:()=>s});const n={SpellingSquiggle:"SpellingSquiggle",GrammarSquiggle:"GrammarSquiggle",AdvancedSquiggle:"AdvancedSquiggle",CIQFlagSquiggle:"CIQFlagSquiggle",HeadingDetectionSquiggle:"HeadingDetectionSquiggle",AutoCorrectSquiggle:"AutoCorrectSquiggle",UnknownSquiggle:"UnknownSquiggle"},s={SpellingSquiggle:4,GrammarSquiggle:3,AdvancedSquiggle:2,CIQFlagSquiggle:3,HeadingDetectionSquiggle:2,AutoCorrectSquiggle:1,UnknownSquiggle:0},o={SpellingSquiggle:0,GrammarSquiggle:0,AdvancedSquiggle:0,CIQFlagSquiggle:1,HeadingDetectionSquiggle:0,AutoCorrectSquiggle:0,UnknownSquiggle:0}},972113:(e,t,i)=>{i.d(t,{kK:()=>b});var n=i(379490),s=i(537969),o=i(823325),r=i(433858),a=i(118673),l=i(774592),d=i(781729),c=i(37741),u=i(18233),g=i(922630),h=i(401322),p=i(551268),m=i(538045),f=i(772830),v=i(668952),y=i(229906),_=i(83010),I=i(66008),C=i(427603),S=i(799873);const b=(0,v.f)("ITextProcessingControllerFactory"),T=(0,v.f)("ITextAugmentationProcessingControllerFactory");(0,v.f)("ITextProcessingControllerLegacyWrapper");let E=class{constructor(e,t,i,n,a,l,d,u,g,h,p,m){this.proofingEmitter=e,this.proofingDom=t,this._textProcessorCoreFactory=i,this._textAugmentationCoreFactory=n,this._hostModelSettings=a,this._textEventPublisher=l,this._hostEmitters=d,this._featureFlagsReader=u,this._hostSettings=g,this._paragraphDeltasEnabled=h,this._queryDetection=p,this._wordDictionary=m,this.handleTextChangeEvent=e=>{this.textProcessingController.pushText(e.data,e.messageType)},this.handleTextStyleChangeEvent=()=>{this.proofingEmitter.emit("recomputeSquiggles")},this.initializeTextProcessingController=()=>{const e=this._textProcessorCoreFactory();return e.subscribe("critiquesAvailable",this._critiquesAvailableHandler),e.subscribe("clearTiles",this._clearTilesHandler),e.subscribe("tilesAvailable",this._tilesAvailableHandler),e.subscribe("stateReset",this._tileStateResetHandler),e.subscribe("tilingEvent",this._tilingEventHandler),e.subscribe("handleRemovedNodes",this._handleRemovedNodesHandler),this.proofingDom.setTextProcessingParagraphFinder(e.getParagraphFinder()),e},this.initializeTextAugmentationCore=()=>{const e=this.textProcessingController.getParagraphFinder(),t=this._textAugmentationCoreFactory(e);return t.subscribe("critiquesReceived",this._onCritiquesReceived),t.subscribe("clearTiles",this._handleOnRemoveTiles),t.subscribe("userRevertedAutoCorrection",this._handleUserRevertedAutoCorrection),t},this._tilingEventHandler=async e=>this.textAugmentationController.processTilingMessage(e),this._tileStateResetHandler=e=>{for(const t of this._hostEmitters)t.emit(s.pD.hostModelTileStateReset,{address:void 0,message:e.tileNodeId})},this._handleOnRemoveTiles=e=>{const t=e.tiles.map((e=>({tileId:e.header,supportedActions:0,suggestions:[],start:0,length:0,priority:0,languageId:""})));this.proofingEmitter.emit("critiqueEvent",{data:t,messageType:o.G.RemoveData})},this._onCritiquesReceived=e=>{if(e.tileId)return void this.textProcessingController.processTileCritiques({tileNodeId:e.tileId,critiques:e.critiques,messageType:0===e.critiques.length?o.G.RemoveData:o.G.ChangeData});const t=(0,r.PD)(e.critiques);for(const e of t.keys()){const i=t.get(e);this.textProcessingController.processTileCritiques({tileNodeId:e,critiques:null!=i?i:[],messageType:0===(null==i?void 0:i.length)?o.G.RemoveData:o.G.ChangeData})}},this._critiquesAvailableHandler=e=>{const t=this.proofingDom.findNode(e.tileNodeId);t&&this.proofingEmitter.emit("squiggleDataEvent",{messageType:e.messageType,data:{critiquesToElementsMap:[{elementId:e.tileNodeId,element:t.element,critiques:e.critiques.map(c.OE)}]}})},this._clearTilesHandler=e=>{this._handleOnRemoveTiles({tiles:e})},this._handleUserRevertedAutoCorrection=e=>{(0,S.yf)(e.critique,this._wordDictionary)},this._tilesAvailableHandler=async e=>{const{schedulerDefaultWaitingTime:t,schedulerDefaultWaitingTimeIncrement:i,schedulerDefaultMaxTime:n}=this._hostModelSettings;this._proofingTimeout&&(window.clearTimeout(this._proofingTimeout),this._proofingTimeout=void 0,this._timeoutLength||(this._timeoutLength=t),this._timeoutLength=Math.min(this._timeoutLength+i,n)),this._proofingTimeout=window.setTimeout((async()=>{this._timeoutLength=t,await this.textAugmentationController.processTilingMessage(Object.assign({messageName:"textTilesMessage"},e)),this._proofingTimeout=void 0}),this._timeoutLength)},this._onFeatureFlagsChanged=e=>{const t=Object.assign(Object.assign(Object.assign(Object.assign({},e),this._hostModelSettings),this._hostSettings),{paragraphDeltasEnabled:this._paragraphDeltasEnabled.check()});this.textProcessingController.updateSettings(t)},this._handleRemovedNodesHandler=e=>{if(this._queryDetection)for(const t of e.nodesToRetire)this._queryDetection.handleTileRemoved(t)}}async initialize(){this._textEventPublisher.subscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.subscribe("styleChange",this.handleTextStyleChangeEvent),this._featureFlagsReader.subscribe("flagsChanged",this._onFeatureFlagsChanged)}shutDown(){var e,t,i,n,s,o,r,a,l;this._textEventPublisher.unsubscribe("textChange",this.handleTextChangeEvent),this._textEventPublisher.unsubscribe("styleChange",this.handleTextStyleChangeEvent),this._featureFlagsReader.unsubscribe("flagsChanged",this._onFeatureFlagsChanged),null===(e=this._textAugmentationController)||void 0===e||e.unsubscribe("critiquesReceived",this._onCritiquesReceived),null===(t=this._textAugmentationController)||void 0===t||t.unsubscribe("clearTiles",this._handleOnRemoveTiles),null===(i=this._textAugmentationController)||void 0===i||i.unsubscribe("userRevertedAutoCorrection",this._handleUserRevertedAutoCorrection),null===(n=this._textProcessingController)||void 0===n||n.unsubscribe("critiquesAvailable",this._critiquesAvailableHandler),null===(s=this._textProcessingController)||void 0===s||s.unsubscribe("clearTiles",this._clearTilesHandler),null===(o=this._textProcessingController)||void 0===o||o.unsubscribe("tilesAvailable",this._tilesAvailableHandler),null===(r=this._textProcessingController)||void 0===r||r.unsubscribe("stateReset",this._tileStateResetHandler),null===(a=this._textProcessingController)||void 0===a||a.unsubscribe("tilingEvent",this._tilingEventHandler),null===(l=this._textProcessingController)||void 0===l||l.unsubscribe("handleRemovedNodes",this._handleRemovedNodesHandler)}setProofingLanguages(e){this.textProcessingController.setProofingLanguages(e)}async pushText(e,t){return this.textProcessingController.pushText(e,t)}get textProcessingController(){return this._textProcessingController||(this._textProcessingController=this.initializeTextProcessingController()),this._textProcessingController}get textAugmentationController(){return this._textAugmentationController||(this._textAugmentationController=this.initializeTextAugmentationCore()),this._textAugmentationController}};E=(0,n.__decorate)([(0,y._)(),(0,n.__param)(0,(0,_.W)(a.o)),(0,n.__param)(1,(0,_.W)(m.w)),(0,n.__param)(2,(0,_.W)(b)),(0,n.__param)(3,(0,_.W)(T)),(0,n.__param)(4,(0,_.W)(p.k)),(0,n.__param)(5,(0,_.W)(f.n)),(0,n.__param)(6,(0,I.t)(s.zJ)),(0,n.__param)(7,(0,_.W)(u.c)),(0,n.__param)(8,(0,_.W)(g.n)),(0,n.__param)(9,(0,_.W)(l.H)),(0,n.__param)(10,(0,C.l)()),(0,n.__param)(10,(0,_.W)(h.J)),(0,n.__param)(11,(0,C.l)()),(0,n.__param)(11,(0,_.W)(d.s))],E)},972660:e=>{e.exports=JSON.parse('{"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Acronyms":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"Ortografía","IsImplemented":true}}')},974943:(e,t,i)=>{i.d(t,{o:()=>r});var n=i(379490),s=i(229906);const o=String.fromCharCode(65532);let r=class{constructor(){}filter(e){var t;return!(null===(t=e.textInContext)||void 0===t?void 0:t.includes(o))}};r=(0,n.__decorate)([(0,s._)()],r)},976333:(e,t,i)=>{if(i.d(t,{BJ:()=>s,fO:()=>o,gA:()=>r}),0!=i.j)var n=i(67573);function s(e){let t=0;return e.changeOnce&&(t|=n.xv.ChangeOnce),e.changeAll&&(t|=n.xv.ChangeAll),e.autoCorrect&&(t|=n.xv.AutoCorrect),e.readAloud&&(t|=n.xv.ReadAloud),e.personalizedAutoCorrect&&(t|=n.xv.PersonalizedAutoCorrect),t}function o(e){return{changeOnce:(e&n.xv.ChangeOnce)===n.xv.ChangeOnce,changeAll:(e&n.xv.ChangeAll)===n.xv.ChangeAll,autoCorrect:(e&n.xv.AutoCorrect)===n.xv.AutoCorrect,readAloud:(e&n.xv.ReadAloud)===n.xv.ReadAloud,personalizedAutoCorrect:(e&n.xv.PersonalizedAutoCorrect)===n.xv.PersonalizedAutoCorrect}}function r(e){return!(e.changeOnce||e.changeAll||e.autoCorrect||e.readAloud||e.personalizedAutoCorrect)}},977487:(e,t,i)=>{if(i.d(t,{k:()=>r,z:()=>o}),0!=i.j)var n=i(863307);if(0!=i.j)var s=i(647879);function o(e){(0,n._v)().logActivity("CiqQueryDetected",void 0,(0,s.W)(["conversationId",e.conversationId],["logicalId",e.logicalId],["triggerKey",e.triggerKey]))}function r(e){(0,n._v)().logActivity("CiqCurrentQueryDismissed",void 0,[...(0,s.W)(["conversationId",e.additionalData.conversationId],["logicalId",e.additionalData.logicalId],["triggerKey",e.additionalData.triggerKey])])}},978129:(e,t,i)=>{i.d(t,{k:()=>L});var n=i(379490),s=i(387815),o=i(786132);const r=e=>{var t,i,n,s;return(null===(t=null==e?void 0:e.oaSettings)||void 0===t?void 0:t.isContextualCardEnabled)||(null===(i=null==e?void 0:e.oaSettings)||void 0===i?void 0:i.enablePredictions)||(null===(s=null===(n=null==e?void 0:e.serviceSettings)||void 0===n?void 0:n.flagAnnotationSettings)||void 0===s?void 0:s.enabled)};var a=i(537969),l=i(323283),d=i(615930),c=i(668952);const u=(0,c.f)("IOaMetric");var g=i(383714),h=i(904196);const p=(0,c.f)("IQueryDetection");var m=i(538045),f=i(959994),v=i(477543);class y{constructor(e,t){this._hostEmitter=e,this._logger=t,this._activationTokens=[]}async activateAnnotationsBase(e,t,i){if(e)if(this._activationTokens.length)this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation which is already initialized.`);else{this._session=e,this._sessionId=t;try{const e=await Promise.all(i());this._activationTokens=e.map((e=>e.token))}catch(e){this._logger.error(508044171,`Trying to activate ${this.annotationListenerType} failed due to an exception.`,e)}}else this._logger.logDiagnostics(`Trying to activate ${this.annotationListenerType} annotation with no session.`)}async deactivateAnnotations(e){if(!e||!this._activationTokens.length)return!1;try{const t=await Promise.all(this._activationTokens.map((t=>e.releaseAnnotation(t))));return this._activationTokens=[],t.every(Boolean)}catch(e){return this._logger.error(508044170,`Trying to deactivate ${this.annotationListenerType} failed due to an exception.`,e),!1}}async updateAnnotationActivationConfig(e){this._session?this._activationTokens.length?e&&this._activationTokens.map((t=>{var i;return null===(i=this._session)||void 0===i?void 0:i.updateAnnotationConfig(t,e)})):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid token.`):this._logger.logDiagnostics(`${this.annotationListenerType}: Trying to update annotation config without a valid session object.`)}}var _=i(4989),I=i(856697),C=i(576516),S=i(823325),b=i(299501);const T={[b.i.Success]:"200",[b.i.NoResults]:"200",[b.i.Cancelled]:"400",[b.i.Timeout]:"408",[b.i.UnexpectedError]:"500",[b.i.EarlyExit]:"200"};class E extends y{constructor(e,t,i,n,s){super(e,t),this._hostEmitter=e,this._logger=t,this._e2eMetric=i,this._queryDetection=n,this._hostSettings=s,this.annotationListenerType="OAAnnotationListener",this._onAnnotationResult=e=>{var t,i,n,s,o,r,l,d,c,u,g,h,p,m,y,b,E,N,w,x,L,D,A;const F=null===(t=e.items[0])||void 0===t?void 0:t.body;if(!F)return;let q;const R=f.h.getTypeNameFor(e);switch(R){case v.Xr.getTypeName():q=S.G.NewData;break;case v.fZ.getTypeName():q=S.G.ChangeData;break;case v.n4.getTypeName():q=S.G.RemoveData;break;default:return void this._logger.logDiagnostics("[OAAnnotationListener]: Unexpected annotation operation",{opType:R})}const P=null!==(i=e.parentPath[e.parentPath.length-1])&&void 0!==i?i:"",O=Number.parseInt(null!==(n=e.parentRevId)&&void 0!==n?n:"0",10);if(_.gh.typeGuard(F)){if(I.Yd.typeGuard(F.result)){if(null===(r=null===(o=null===(s=this._hostSettings)||void 0===s?void 0:s.serviceSettings)||void 0===o?void 0:o.predictions)||void 0===r?void 0:r.augloopPredictionsDisabled)return;const t=F.result;if(this.isValidSuggestionType(t.entityType)){let i=t.entityType;(i===C.c.People&&!t.entityResults||i===C.c.External)&&(i=C.c.PIM);const n=Object.assign(Object.assign({tileId:P,tileVersion:O,annotationId:e.items[0].id},t),{entityType:i,startIndex:t.startIndex>0?t.startIndex:(null!==(d=null===(l=t.context)||void 0===l?void 0:l.length)&&void 0!==d?d:0)+t.startIndex});this._hostEmitter.emit(a.pD.predictionTriggered,{address:this._sessionId,message:{messageType:q,data:n}})}}else if(I.aO.typeGuard(F.result)){const t=F.result;this.isValidSuggestionType(t.entityType)&&this._hostEmitter.emit(a.pD.nudgeTriggered,{address:this._sessionId,message:{messageType:q,data:Object.assign(Object.assign({},t),{tileId:P,tileVersion:O,annotationId:e.items[0].id,entityType:t.entityType})}})}}else if(_.Zx.typeGuard(F)||_.$g.typeGuard(F)){const t=null===(u=null===(c=this._queryDetection)||void 0===c?void 0:c.getCurrentQuery())||void 0===u?void 0:u.queryRange,i={logicalId:F.logicalId||(null===(g=this._queryDetection)||void 0===g?void 0:g.getCurrentQueryLogicalId())||"",conversationId:F.conversationId||(null===(h=this._queryDetection)||void 0===h?void 0:h.getCurrentQueryConversationId())||"",isEmptyQuery:!t||t.length===(null!==(m=null===(p=t.prefix)||void 0===p?void 0:p.length)&&void 0!==m?m:1),isTimeout:!1,queryLength:(null==t?void 0:t.length)?t.length-(null!==(b=null===(y=t.prefix)||void 0===y?void 0:y.length)&&void 0!==b?b:1):0},n=(e=>{if(_.$g.typeGuard(e)){const t=e;if(t.instrumentation&&t.instrumentation.length>0)return t.instrumentation[0].TraceId}})(F),s=n?Object.assign({TraceId:n||""},"number"==typeof F.status?{status:(k=F.status,T[k])}:{}):void 0;let o,r,l;if(this._e2eMetric.addMeasure(i.logicalId,"OAAnnotationResultsReceived",s),_.$g.typeGuard(F)){l=F.resultSummary;const e=F;for(const t of e.entityResults)if((null===(w=null===(N=null===(E=this._hostSettings)||void 0===E?void 0:E.oaSettings)||void 0===N?void 0:N.bestMatchConfig)||void 0===w?void 0:w.enabled)&&(null===(x=e.treatments)||void 0===x?void 0:x.bestMatchEntries))for(const i of e.treatments.bestMatchEntries)for(const e of t.entities)e.entityId===i.entityId&&(e.isBestMatch=!0);o=e.entityResults,r=e.entityResults.map((e=>e.modelInfo.elapsedTime)).filter(Number.isInteger).reduce(((e,t)=>e>t?e:t),0)}else{let e=[];try{(null===(A=null===(D=null===(L=this._hostSettings)||void 0===L?void 0:L.oaSettings)||void 0===D?void 0:D.bestMatchConfig)||void 0===A?void 0:A.enabled)&&(e=>{const t=e.results.findIndex((e=>e.bestMatchEntries&&e.bestMatchEntries.length>0));if(t>-1){const i=e.results[t],n=i.bestMatchEntries;n&&n.length>0&&i.results.forEach((e=>{e.isBestMatch=n.findIndex((t=>t.entityId===e.ReferenceId))>-1}))}})(F);for(const t of F.results)e=e.concat(t.results)}catch(e){this._logger.logDiagnostics("[OAAnnotationListener] unexpected annotation item format")}const t=new Map;for(const i of e){const e=t.get(i.entityType);e?e.entities.push(i):t.set(i.entityType,{entities:[i],entityType:i.entityType})}o=Array.from(t.values())}this._hostEmitter.emit(a.pD.oaRankedAnnotations,{address:this._sessionId,message:{messageType:q,data:{tileId:P,tileVersion:O,annotationId:e.items[0].id,results:o,resultStatus:F.status,resultSummary:l,queryCorrelationKeys:i,latency:r}}})}else _.Vn.typeGuard(F)&&this._hostEmitter.emit(a.pD.oaFlagAnnotationsTriggered,{address:this._sessionId,message:{messageType:q,data:{tileId:P,tileVersion:O,annotationId:e.items[0].id,results:F.results}}});var k},this.isValidSuggestionType=e=>Object.values(C.c).includes(e)}async activateAnnotations(e,t){await super.activateAnnotationsBase(e,t,(()=>{var t,i,n,s;if(!e)return[];const o=[_.Zx];return(null===(i=null===(t=this._hostSettings)||void 0===t?void 0:t.oaSettings)||void 0===i?void 0:i.enableOaClient)?o.push(_.c$):o.push(_.os),(null===(s=null===(n=this._hostSettings)||void 0===n?void 0:n.oaSettings)||void 0===s?void 0:s.enableOaClientPredictions)?o.push(_.Nh):o.push(_.Vm),o.push(_.Vn),o.map((t=>e.activateAnnotation(t.getTypeName(),{callback:this._onAnnotationResult})))}))}}var N=i(95749),w=i(229906),x=i(83010);let L=class{constructor(e,t,i,n,r,a,l){this._hostEmitter=e,this._logger=t,this._hostSettings=i,this._oaMetric=n,this._queryDetection=r,this._proofingDom=a,this.targetDocumentFactory=l,this._oaStartupSignalSeq=0,this._startSignalIntervalId=null,this._lastStartSignalTime=0,this._elementsToProof=[],this._targetWindow=window,this._oaSendALMenuControlSignal=async e=>{if(!this._sessionsProvider)return;const t=await this._sessionsProvider.getOrCreateSession(e.address);this._oaStartupSignalSeq=this._oaStartupSignalSeq+1,null==t||t.submitSignal(new s.I9(e.message),this._oaStartupSignalSeq.toString(),e.message.documentModel)},this._isSameOrDescendantElement=(e,t)=>e===t||(0,o.C)(e,"HTMLDivElement")&&e.contains(t),this._handleDocumentFocusIn=e=>{const t=e.target;if(!(0,o.C)(t,"HTMLElement"))return;this._elementsToProof.some((e=>this._isSameOrDescendantElement(t,e)))&&(this._submitStartupSignal(),this._initStartupSignalTimer())},this._handleDocumentFocusOut=e=>{this._clearStartupSignalTimer()},this._attachFocusEventToProofedElements=async e=>{var t,i;const n=null===(t=this._proofingDom.findNode(e.message))||void 0===t?void 0:t.element;if(!n||!(0,o.C)(n,"HTMLElement"))return;this._elementsToProof.push(n);const s=(null===(i=this.targetDocumentFactory())||void 0===i?void 0:i.deref())||document;(0,o.C)(s.activeElement,"HTMLElement")&&this._isSameOrDescendantElement(s.activeElement,n)&&(this._submitStartupSignal(),this._initStartupSignalTimer())}}register(e,t){var i;if(!r(this._hostSettings))return;this._sessionsProvider=e,this._augloopDocumentSerializer=t,this._hostEmitter.on(a.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.on(a.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements);const n=(null===(i=this.targetDocumentFactory())||void 0===i?void 0:i.deref())||document;this._focusInListener=new l.J(n),this._focusInListener.addListener("focusin",this._handleDocumentFocusIn),this._focusOutListener=new l.J(n),this._focusOutListener.addListener("focusout",this._handleDocumentFocusOut),n.defaultView&&(this._targetWindow=n.defaultView)}unregister(){var e,t;this._elementsToProof=[],r(this._hostSettings)&&(this._hostEmitter.off(a.pD.oaMenuControlSignal,this._oaSendALMenuControlSignal),this._hostEmitter.off(a.pD.hostModelAddedRootNode,this._attachFocusEventToProofedElements),null===(e=this._focusInListener)||void 0===e||e.removeListener("focusin"),this._focusInListener=void 0,null===(t=this._focusOutListener)||void 0===t||t.removeListener("focusout"),this._focusOutListener=void 0),this._clearStartupSignalTimer()}createAnnotationListener(){return new E(this._hostEmitter,this._logger,this._oaMetric,this._queryDetection,this._hostSettings)}onInitialize(e){this._initStartupSignal(e)}onSessionReconnected(e){this._initStartupSignal(e)}onDocumentCreated(e,t){var i,n,o;if(!r(this._hostSettings))return;this._oaStartupSignalSeq=this._oaStartupSignalSeq+1;const a=null===(i=this._hostSettings.oaSettings)||void 0===i?void 0:i.tokenOverride,l=this.getClientConfig(),d=null===(n=l.metadata)||void 0===n?void 0:n.appScenario;this._hostSettings.appId.startsWith("PowerPoint")&&"Copilot"!==d&&this._logger.logDiagnostics(`[OAClientSubscriber] client config for PowerPoint doesn't have correct appScenario: ${d}`),e.submitSignal(new s.c7({sessionConfig:{clientConfig:l,debugConfig:{tokenOverride:a}},parentPath:null===(o=this._augloopDocumentSerializer)||void 0===o?void 0:o.getParentPath(e,t).join("\\")}),this._oaStartupSignalSeq.toString(),t)}get isEnabled(){return!0}getClientConfig(){return(0,N.e)(this._hostSettings)}_submitStartupSignal(){var e;if(!r(this._hostSettings)||!this._currentSession)return;if(!(Date.now()-this._lastStartSignalTime>9800))return;this._oaStartupSignalSeq++;const t=null===(e=this._hostSettings.oaSettings)||void 0===e?void 0:e.tokenOverride;this._lastStartSignalTime=Date.now(),this._currentSession.submitSignal(new s.ep({debugOptions:{tokenOverride:t}}),this._oaStartupSignalSeq.toString())}_initStartupSignal(e){this._clearStartupSignalTimer(),this._currentSession=e,this._submitStartupSignal()}_initStartupSignalTimer(){this._startSignalIntervalId||(this._startSignalIntervalId=this._targetWindow.setInterval((()=>{this._submitStartupSignal()}),1e4))}_clearStartupSignalTimer(){this._startSignalIntervalId&&(this._targetWindow.clearInterval(this._startSignalIntervalId),this._startSignalIntervalId=null)}};L=(0,n.__decorate)([(0,w._)(),(0,n.__param)(0,(0,x.W)(a.M5)),(0,n.__param)(1,(0,x.W)(g.g)),(0,n.__param)(2,(0,x.W)(h.n)),(0,n.__param)(3,(0,x.W)(u)),(0,n.__param)(4,(0,x.W)(p)),(0,n.__param)(5,(0,x.W)(m.w)),(0,n.__param)(6,(0,x.W)(d.Ze))],L)},978407:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":true,"LocalizedName":"Ytimekkyys"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"Yhtenäinen kirjoitusasu"},"Sentence Inspire Me":{"LocalizedName":"","IsImplemented":false},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Inclusiveness":{"LocalizedName":"Syrjivä kielenkäyttö","IsImplemented":true},"Typing errors":{"IsImplemented":false,"LocalizedName":"Lyöntivirheet"},"Clarity":{"IsImplemented":true,"LocalizedName":"Selkeys"},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Uudelleenkirjoitus"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Virheen korjaukset"},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"LocalizedName":"Sanasto","IsImplemented":false},"Grammar":{"LocalizedName":"Kielioppi","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Virallinen kieli","IsImplemented":false},"DiversityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Punctuation Conventions":{"IsImplemented":false,"LocalizedName":"Välimerkit"},"RewriteConciseness":{"IsImplemented":false,"LocalizedName":""},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Kirjoitustyyli"},"Spelling":{"IsImplemented":true,"LocalizedName":"Oikeinkirjoituksen tarkistus"},"Resume":{"LocalizedName":"Ansioluettelo","IsImplemented":false},"Sensitive Geopolitical References":{"IsImplemented":false,"LocalizedName":"Ongelmalliset geopoliittiset viittaukset"}}')},979075:(e,t,i)=>{i.d(t,{v:()=>n});const n=(0,i(668952).f)("IAggregateLogger")},980495:(e,t,i)=>{i.d(t,{C:()=>s,V:()=>o});var n=i(668952);const s=(0,n.f)("INodeObserverFactory"),o=(0,n.f)("IMutationObserverFactory")},980703:(e,t,i)=>{if(i.d(t,{V:()=>o}),0!=i.j)var n=i(611441);if(0!=i.j)var s=i(826834);class o{constructor(e){const{dataAggregator:t,ranker:i,intentDetector:n}=e.services;this.params=Object.assign(Object.assign({},e),{services:{dataAggregator:null!=t?t:(0,s.T)(e.settings.hostAppCiqConfig),ranker:null!=i?i:(0,s.v)(e.settings.hostAppCiqConfig),intentDetector:n}})}create(e){const{settings:t,services:i}=this.params;return new n.D({settings:t,services:Object.assign(Object.assign({},i),e)})}}},985500:(e,t,i)=>{i.d(t,{j:()=>n});const n=(0,i(668952).f)("ITileNodeReader")},992271:(e,t,i)=>{i.d(t,{Nt:()=>d,cu:()=>c});var n=i(11653),s=i(62876),o=i(829088),r=i(817596),a=i(208520),l=i(794329);function d(e,t,i){return new g(e,t,i)}function c(e,t){const i=new u(e);return{element:a.createElement(h,{eccUxReplacement:i,commonOptions:t}),eccUxReplacement:i}}class u{constructor(e){this.iframeElement=e,this.eccStateChanged=e=>{var t;null===(t=this.listener)||void 0===t||t.call(this,e)},this.setListener=e=>{this.listener=e}}dispose(){this.listener&&(this.listener(void 0),this.listener=void 0)}}class g extends u{constructor(e,t,i){super(t),this.editorCard=document.createElement("external-editor-card"),this.editorCard.setAttribute("style","position:absolute;top:0px;left:0px;z-index:auto;display: block !important"),e.appendChild(this.editorCard),(0,r.d)(this.editorCard,a.createElement(h,{eccUxReplacement:this,commonOptions:i}))}dispose(){this.editorCard&&(l.unmountComponentAtNode(this.editorCard),this.editorCard.remove(),this.editorCard=void 0),super.dispose()}}const h=e=>{var t;const{iframeElement:i,setListener:r}=e.eccUxReplacement,[l,d]=a.useState(),c=a.useCallback((e=>{d(e)}),[d]);if(a.useEffect((()=>(r(c),()=>{r(void 0)})),[c,r]),!l)return null;const u=function(e,t){var i,n;if(!e||!t||"string"==typeof t)return t;let s=e.getBoundingClientRect();const o=getComputedStyle(e),r=parseFloat(o.borderWidth.replace("px",""));if(s=new DOMRect(s.left+r,s.top+r,s.width-r-r,s.height-r-r),"left"in t&&"top"in t&&t.left&&t.top)return"width"in t&&"height"in t?{left:t.left+s.left,right:t.left+s.left+t.width,top:t.top+s.top,bottom:t.top+s.top+t.height,width:t.width,height:t.height}:{x:(null!==(i=t.left)&&void 0!==i?i:0)+s.left,y:(null!==(n=t.top)&&void 0!==n?n:0)+s.top};if("x"in t&&"y"in t)return{x:t.x+s.left,y:t.y+s.top};return t}(i,l.targetLocation);return u?a.createElement(s.O.Provider,{value:!!(null===(t=e.commonOptions)||void 0===t?void 0:t.useFluentV9)},a.createElement("div",{dir:l.calloutProps.isRtl?"rtl":"ltr",style:{all:"initial"}},a.createElement(n.$,Object.assign({},l,{targetWindow:new o.O(window),targetLocation:u,isMobile:!1,isRtl:l.calloutProps.isRtl})))):null}},993584:(e,t,i)=>{i.d(t,{l:()=>p});var n=i(379490),s=i(331408),o=i(877931),r=i(537969),a=i(279e3),l=i(538045),d=i(753031),c=i(229906),u=i(66008),g=i(427603),h=i(83010);let p=class{constructor(e,t,i,n){this._hostEmitters=e,this._critiqueStore=t,this._proofingDom=i,this._logger=n,this.initialize=async()=>{for(const e of this._hostEmitters)e.on(r.pD.hostModelCritiqueAction,this.onHostModelCritiqueActionEvent)},this.shutDown=()=>{},this.onHostModelCritiqueActionEvent=e=>{if(!e.message.critiqueInfo.nodeId)return void this._logger.log(523871251,d.q.Error,`IHostModelCritiqueAction message: Received undefined args. ActionType:${e.message.actionType}`);let t=this._proofingDom.findTileNode(e.message.critiqueInfo.nodeId);if(!t){const i=this._proofingDom.findParagraphNode(e.message.critiqueInfo.nodeId);if(!(null==i?void 0:i.parent))return void this._logger.log(523896789,d.q.Error,"CritiqueActionEventHandler: Received event args with unknown node id.");t=i.parent}if(this._critiqueStore)switch(e.message.actionType){case s.$w.IgnoreOnce:case s.$w.ApplySuggestion:this._critiqueStore.removeCritique(e.message.critiqueInfo.traceId,e.message.critiqueInfo.nodeId);break;case s.$w.DisableCritiqueType:break;case s.$w.IgnoreAll:if(!e.message.critiqueInfo.typeId){this._logger.log(507574115,d.q.Error,"critique is missing typeId");break}if(!e.message.critiqueInfo.textInContext){this._logger.log(507574098,d.q.Error,"critique is missing textInContext");break}this._critiqueStore.removeAllCritiquesOfTypeAndText(e.message.critiqueInfo.typeId,e.message.critiqueInfo.textInContext);break;default:this._logger.log(523896792,d.q.Error,"CritiqueActionEventHandler: Received unexpected actionType.")}else this._logger.log(523896791,d.q.Error,"CritiqueActionEventHandler: No critique store is available.")}}};p=(0,n.__decorate)([(0,c._)(),(0,n.__param)(0,(0,u.t)(r.zJ)),(0,n.__param)(1,(0,g.l)()),(0,n.__param)(1,(0,h.W)(a.$)),(0,n.__param)(2,(0,h.W)(l.w)),(0,n.__param)(3,(0,h.W)(o.g))],p)},996054:(e,t,i)=>{i.d(t,{z:()=>v});var n=i(856697),s=i(434998),o=i(660947),r=i(387815),a=i(477543),l=i(70058),d=i(535912),c=i(863307);const u="Editor";class g{constructor(e){this.sessionPromise=e,this.onEccAnnotationReceived=e=>{if(!this.latestAnnotationRequest)return;if(!e.items[0].body)return;const t=e.items[0].body;this.latestAnnotationRequest.logicalId===t.logicalId&&this.latestAnnotationRequest.resolve(t)},this.onConfigurationReceived=e=>{this.pendingConfigResolve&&this.pendingConfigResolve.resolve()}}async enableCiq(e){const t=(0,c._v)(),i=await this.sessionPromise;if(!i)throw t.error(505274387,"Session is not available in AugloopCiqApi: enableCiq"),new Error("Session is not available in AugloopCiqApi: enableCiq");await Promise.all([i.activateAnnotation(n.dV.getTypeName(),{callback:this.onEccAnnotationReceived}),i.activateAnnotation(s.Pv.getTypeName(),{callback:this.onConfigurationReceived}),i.activateAnnotation(s.vp.getTypeName(),{callback:this.onConfigurationReceived})]).then((()=>this.setClientConfig(e)))}async sendCiqStartupSignal({clientId:e}){const t=(0,c._v)(),i=await this.sessionPromise;if(!i)throw t.error(505274386,"Session is not available in AugloopCiqApi: sendCiqStartupSignal"),new Error("Session is not available in AugloopCiqApi: sendCiqStartupSignal");const n=new a.g0({parentPath:this.getParentPath(e,o.Qo.getTypeName()),items:[{id:"SessionStartRequest",body:new o.Qo}]});i.submitOperation(n)}async getEntities({clientId:e,context:t,query:i,triggerKey:s,logicalId:r,conversationId:l}){var u;const h=(0,c._v)();try{const c=await this.sessionPromise;if(!c)throw h.error(505274385,"Session is not available in AugloopCiqApi: getEntities"),new Error("Session is not available in AugloopCiqApi: getEntities");this.latestAnnotationRequest&&this.latestAnnotationRequest.reject(new Error("request overwritten by a new request"));const p=new Promise(((e,t)=>{this.latestAnnotationRequest={logicalId:r,resolve:e,reject:t}})),m=(0,d.D)(),f=this.normalizeQueryCharInText(null!==(u=null==t?void 0:t.text)&&void 0!==u?u:"",i.start,s),v=null!=f?f:`${s}${i.text}`,y={prefix:s,start:f?i.start:0,length:i.text.length+s.length},_=this.createQueryInfo(y,v),I=++g.sequenceCounter,C=new o.sr({content:v,logicalId:r,conversationId:l,clientSessionId:"",scope:void 0,seq:I,query:_.query,queryChar:_.queryChar,queryCharIndex:_.queryCharIndex}),S=new a.g0({parentPath:this.getParentPath(e,n.dV.getTypeName()),items:[{id:m,body:C}]});c.submitOperation(S);const b=await p;return{results:b.entityResults.map((e=>({entityType:e.entityType,entities:e.entities}))),status:b.status}}catch(e){throw h.error(505274384,"Error while getting entities from Augloop",e),e}finally{this.latestAnnotationRequest=void 0}}createQueryInfo({length:e,start:t,prefix:i},n){return{query:this.sanitizeText(n.substring(t+i.length,t+e)),queryChar:i,queryCharIndex:t}}sanitizeText(e,t){if(!e)return"";let i=e.endsWith("\n")?e.slice(0,-1):e;return i=i.replace(/\s/g," "),t?i.trim():i}async setClientConfig({clientId:e,enabledEntityTypes:t,scopes:i,enableTextPrediction:n,metadata:s}){const o=(0,c._v)(),l=await this.sessionPromise;if(!l)throw o.error(505274383,"Session is not available in AugloopCiqApi: setClientConfig"),new Error("Session is not available in AugloopCiqApi: setClientConfig");const d=new Promise((e=>{this.pendingConfigResolve={resolve:e}})),g=new a.g0({parentPath:this.getParentPath(e,r.c7.getTypeName()),items:[{id:"ClientConfigSignal",body:new r.c7({timestamp:Date.now(),sessionConfig:{clientConfig:{ecc:{enabled:!0,entities:t,bestMatch:{enabled:!0},scopes:{enabled:i.enabled,maxResults:i.maxResults},sendExactQuery:!0},prediction:{enabled:null!=n&&n},metadata:s}},parentPath:[u,e].join("\\")})}]});l.submitOperation(g),await d}normalizeQueryCharInText(e,t,i){if(!e[t])return;const n=e.split("");return n[t]=i,n.join("")}getParentPath(e,t){return[u,e,l.HN.getTypeName(),t]}}g.sequenceCounter=0;var h=i(299501),p=i(93469),m=i(893801);const f={File:e=>({type:"File",author:e.Author,from:e.From,accessUrl:e.AccessUrl,fileName:e.FileName,spoId:e.SpoId,spoUniqueId:e.SpoUniqueId,dateAccessed:e.DateAccessed,dateCreated:e.DateCreated,dateModified:e.DateModified,referenceId:e.ReferenceId,fileSize:e.FileSize,modifiedByDisplayName:e.ModifiedByDisplayName,alternateAccessUrl:e.AlternateAccessUrl,sharedDateTime:e.SharedDateTime,userRelationshipType:e.UserRelationshipType,fileExtension:e.FileExtension,secondaryText:e.SecondaryText}),People:e=>({type:"People",name:e.text,displayName:e.DisplayName,referenceId:e.ReferenceId,emailAddresses:e.EmailAddresses}),Message:e=>({type:"Message",from:e.From,immutableId:e.ImmutableId.Id,subject:e.Subject}),Event:e=>{var t;return{type:"Event",start:e.Start,end:e.End,subject:e.Subject,originalId:e.OriginalId,webLink:e.WebLink,eventId:null===(t=e.EventId)||void 0===t?void 0:t.Id,referenceId:e.ReferenceId,skypeTeamsMeetingUrl:e.SkypeTeamsMeetingUrl,organizerName:e.OrganizerName,organizerAddress:e.OrganizerAddress,isAllDay:e.IsAllDay,hasRecording:e.HasRecording,isSeries:!!e.SeriesMasterId,attendees:e.Attendees}},Command:e=>({description:e.text,type:"Command",callback:()=>{}}),App:e=>({type:"App",name:e.text,iconUrl:e.IconAnonymousUrl,description:e.Description})};class v{get sourceName(){return v.SourceName}constructor(e,t){this.sessionManager=e,this.hostAppCiqConfig=t,this.initialized=!1,this._ciqApi=new g(e.getSession())}getAuthStatus(){return function(e){if(!e)return"NotAuthenticated";switch(e){case m.f.Authenticated:return"Authenticated";case m.f.Pending:return"Pending";case m.f.TokenMissingInteractionRequired:return"TokenMissingInteractionRequired";case m.f.WacUserInfoAuthenticated:return"WacUserInfoAuthenticated";default:return"NotAuthenticated"}}(this.sessionManager.getServerAuthenticationState())}getConnectionStatus(){return this.sessionManager.isConnected()?"Connected":"Disconnected"}async init(){if(this.initialized)return;const e=(0,c._v)();try{await this._ciqApi.enableCiq({enabledEntityTypes:this.toCiqEccConfig(this.hostAppCiqConfig.triggerConfigs),scopes:{enabled:this.hostAppCiqConfig.enableEntityScopes},clientId:this.hostAppCiqConfig.clientId,metadata:this.hostAppCiqConfig.metadata}),await this._ciqApi.sendCiqStartupSignal({clientId:this.hostAppCiqConfig.clientId})}catch(t){throw e.error(505274382,"Error initializing AugloopSource:",t),t}this.initialized=!0}async getEntities({query:e,triggerKey:t,logicalId:i,conversationId:n}){const s={query:e,triggerKey:t,clientId:this.hostAppCiqConfig.clientId,conversationId:n,logicalId:i},o=await this._ciqApi.getEntities(s),r=this.toSuggestionGroups(o.results);return{sourceName:this.sourceName,suggestionGroups:r,resultStatus:this.toResultStatus(o.status)}}toResultStatus(e){switch(e){case h.i.Success:case h.i.NoResults:return"Success";case h.i.Cancelled:return"Cancelled";case h.i.EarlyExit:return"EarlyExit";case h.i.Timeout:return"ServiceTimeout";default:return"UnexpectedError"}}toSuggestionDetails(e){return f[e.entityType](e)}toSuggestionGroups(e){return e.map((e=>({entityType:e.entityType,entities:e.entities.map((e=>({type:e.entityType,id:e.entityId||(0,d.D)(),name:e.text,details:this.toSuggestionDetails(e)})))})))}toCiqEccConfig(e){return e.reduce(((e,t)=>{const i=t.entityTypes.filter((e=>e.sources.includes(this.sourceName))).map((e=>({queryPrefix:[(0,p.DH)(t.trigger)],enabled:!0,maxResults:e.maxResults,entityType:e.entityType,customProps:this.getCustomProps(e)})));return e.concat(i)}),[])}getCustomProps(e){return"File"===e.entityType?[{name:"Filter",value:JSON.stringify({And:[{Or:e.fileTypes.map((e=>({Term:{FileType:e}})))}]})}]:"App"===e.entityType?[{name:"Filter",value:'{"Or":[{"Term":{"AppType":"GPT"}}]}'}]:[]}async dispose(){return!0}get isInitialized(){return this.initialized}}v.SourceName="Augloop"},996585:e=>{e.exports=JSON.parse('{"Uncommon Words":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"Spelling":{"LocalizedName":"","IsImplemented":true}}')},997041:(e,t,i)=>{i.d(t,{z:()=>l});var n=i(379490),s=i(229906),o=i(83010),r=i(243879),a=i(538045);let l=class{constructor(e,t){this._inlineSuggestionsRenderer=e,this._proofingDom=t}filter(e){const t=this._inlineSuggestionsRenderer.getCurrentMenuInfo();if(!t||"InlineSuggestionsResultsUserInitiatedMenuType"!==t.menuType.menuType)return!0;if(e.nodeId===t.tileId){const i=this._proofingDom.findParagraphNode(t.tileId);if((null==i?void 0:i.element)&&"offset"in i.element)return!this.intersects(e.start,e.start+e.length,i.element.offset+t.queryRange.start,i.element.offset+t.queryRange.start+t.queryRange.length)}return!0}intersects(e,t,i,n){return e<=n&&i<=t}};l=(0,n.__decorate)([(0,s._)(),(0,n.__param)(0,(0,o.W)(r.V)),(0,n.__param)(1,(0,o.W)(a.w))],l)},997235:(e,t,i)=>{function n(e){return!!e&&["processText","init","dispose"].every((t=>t in e))}function s(e){return!!e&&["init","dispose","detectQuery","registeredTriggers","registerTriggers","unregisterAllTriggers"].every((t=>t in e))}i.d(t,{Mt:()=>n,TT:()=>s})},997567:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"LocalizedName":"","IsImplemented":false},"Conciseness":{"IsImplemented":true,"LocalizedName":"Tömörség"},"Consistent Written Forms":{"LocalizedName":"Konzisztens írott alak","IsImplemented":false},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"IsImplemented":false,"LocalizedName":""},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"LocalizedName":"Politikailag korrekt nyelvhasználat","IsImplemented":true},"Typing errors":{"LocalizedName":"Gépelési hibák","IsImplemented":false},"Clarity":{"IsImplemented":false,"LocalizedName":"Érthetőség"},"Simpler Language":{"IsImplemented":false,"LocalizedName":""},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"IsImplemented":false,"LocalizedName":"Átírás"},"Error Corrections":{"IsImplemented":false,"LocalizedName":"Hiba javítás"},"FormalityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Vocabulary":{"IsImplemented":false,"LocalizedName":"Szóválasztás"},"Grammar":{"IsImplemented":true,"LocalizedName":"Nyelvtan"},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"LocalizedName":"","IsImplemented":false},"FluencyFullExplanation":{"LocalizedName":"","IsImplemented":false},"Formality":{"LocalizedName":"Nyelvhasználat","IsImplemented":true},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"Központozási szokások","IsImplemented":false},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"IsImplemented":false,"LocalizedName":""},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"Helyesírási szokások"},"Spelling":{"IsImplemented":true,"LocalizedName":"Helyesírás"},"Resume":{"LocalizedName":"Önéletrajz","IsImplemented":false},"Sensitive Geopolitical References":{"LocalizedName":"Érzékeny geopolitikai kifejezése","IsImplemented":false}}')},997601:(e,t,i)=>{i.d(t,{a:()=>n});const n=(0,i(668952).f)("IApplyCritiqueSuggestionHandler")},998753:e=>{e.exports=JSON.parse('{"ConcisenessFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Conciseness":{"IsImplemented":false,"LocalizedName":"שפה תמציתית"},"Consistent Written Forms":{"IsImplemented":false,"LocalizedName":"עקביות בכתיבה"},"Sentence Inspire Me":{"IsImplemented":false,"LocalizedName":""},"Fluency":{"LocalizedName":"","IsImplemented":false},"Uncommon Words":{"IsImplemented":false,"LocalizedName":""},"Inclusiveness":{"IsImplemented":true,"LocalizedName":"שפה מכילה"},"Typing errors":{"IsImplemented":false,"LocalizedName":"טעויות הקלדה"},"Clarity":{"LocalizedName":"שפה ברורה","IsImplemented":false},"Simpler Language":{"LocalizedName":"","IsImplemented":false},"Inspire Me":{"LocalizedName":"","IsImplemented":false},"Acronyms":{"IsImplemented":false,"LocalizedName":""},"Rewrite":{"LocalizedName":"שכתוב","IsImplemented":false},"Error Corrections":{"IsImplemented":false,"LocalizedName":"תיקון שגיאות"},"FormalityFullExplanation":{"LocalizedName":"","IsImplemented":false},"Vocabulary":{"IsImplemented":false,"LocalizedName":"בחירת אוצר מילים"},"Grammar":{"LocalizedName":"דקדוק","IsImplemented":true},"SimplerFullExplanation":{"LocalizedName":"","IsImplemented":false},"Perspectives":{"IsImplemented":false,"LocalizedName":""},"FluencyFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Formality":{"IsImplemented":true,"LocalizedName":"שפה תקנית"},"DiversityFullExplanation":{"IsImplemented":false,"LocalizedName":""},"Punctuation Conventions":{"LocalizedName":"מוסכמות פיסוק","IsImplemented":true},"RewriteConciseness":{"LocalizedName":"","IsImplemented":false},"RewriteFormality":{"LocalizedName":"","IsImplemented":false},"Writing Conventions":{"IsImplemented":false,"LocalizedName":"מוסכמות כתיבה"},"Spelling":{"IsImplemented":true,"LocalizedName":"בדיקת איות"},"Resume":{"IsImplemented":false,"LocalizedName":"קורות חיים"},"Sensitive Geopolitical References":{"LocalizedName":"הקשרים גיאו-פוליטיים רגישים","IsImplemented":false}}')},999358:(e,t,i)=>{i.d(t,{x:()=>n});class n{constructor(e){this.element=e}retrieve(){return{content:this.element?s(this.element.innerText):""}}}function s(e){if(!e.includes("​‌"))return e;const t=e.split("​‌");let i="";return t.forEach(((e,t)=>{t%2==0&&(i+=e)})),i}}}]);
//# sourceMappingURL=editor.js.map